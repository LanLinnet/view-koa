/*
 * client.js - v0.3.10
 * Compiled Fri Aug 27 2021 13:52:23 GMT+0800 (中国标准时间)
 * Copyright (c) 2021 www.hightopo.com
 */

var hteditor=function(){"use strict";function i(i,H,R){R.style.cursor="ew-resize";var M=R.innerHTML.charAt(0),I=H.querySelector("input.color_"+M),p=function(H){H.preventDefault();var R=("A"===M?parseFloat(I.value):parseInt(I.value))||0,p=ht.Default.getClientPoint(H).x,h=function(H){H.preventDefault();var h=ht.Default.getClientPoint(H).x-p,z=void 0;"A"===M?(z=R+.01*h,z>1&&(z=1),z<0&&(z=0),I.value=z.toFixed(2)):(z=R+1*h,z>255&&(z=255),z<0&&(z=0),I.value=z),i.updateInputChange()};window.addEventListener("mousemove",h,!1),window.addEventListener("touchmove",h,!1);var z=function(i){i.preventDefault(),window.removeEventListener("mousemove",h,!1),window.removeEventListener("touchmove",h,!1),window.removeEventListener("mouseup",z,!1),window.removeEventListener("touchend",z,!1)};window.addEventListener("mouseup",z,!1),window.addEventListener("touchend",z,!1)};R.addEventListener("mousedown",p,!1),R.addEventListener("touchstart",p,!1)}function H(i){if(i){return new Function("return "+i.trim())()}}function R(i){var H=new RegExp("(^|&)"+i+"=([^&]*)(&|$)"),R=window.location.search.substr(1).match(H);return null!=R?decodeURIComponent(R[2]):null}function M(i){return ht.Default.clone(i)}function I(i){return parseFloat(i.toFixed(ht.Default.numberDigits))}function p(i,H){if(null!=i)return H||!KR.config.traceMissingI18n||KR.customStrings[i]||KR.strings[i]||console.log("i18n missing:["+i+"]"),H?KR.customStrings[i]||KR.strings[i]:KR.customStrings[i]||KR.strings[i]||i}function h(i,H){return i&&i.rowHeight?i.rowHeight:H&&H.rowHeight?H.rowHeight:void 0}function z(i,H){return i&&i.widths?i.widths:H&&H.widths?H.widths:void 0}function d(i,H){return H?H.map(function(i){return p(i)}):i}function C(i,H){var R=i.indexOf(H);R>=0&&i.splice(R,1)}function y(i){return ht.Default.isEmptyObject(i)}function b(i){return i?ti(i)?i:i.__ht__||i.toString():""}function U(i){var H=b(i),R=H.indexOf("{")+1,M=H.lastIndexOf("}");for(H=H.substring(R,M);H.startsWith("\n");)H=H.substr(1);for(;H.endsWith("\n");)H=H.substring(0,H.length-1);return H}function K(i){var H=i.indexOf("function");if(i&&!(H<0)){var R=void 0,M=i.indexOf("{")+1,I=i.lastIndexOf("}"),p=i.indexOf("(")+1,h=i.indexOf(")");return M&&I&&p&&h&&(R=new Function(i.substring(p,h),i.substring(M,I)),R.__ht__=i.substr(H)),R}}function q(i,H,R){if(R)return R;if("s"===i)return function(i){return i.s(H)};if("a"===i)return function(i){return i.a(H)};if("p"===i){var M=ht.Default.getter(H);return function(i){if(i[M])return i[M]()}}}function Q(i,H,R){if(void 0!==R)return R;if("s"===i)return function(i,R){return i.s(H,R)};if("a"===i)return function(i,R){return i.a(H,R)};if("p"===i){var M=ht.Default.setter(H);return function(i,H){if(i[M])return i[M](H)}}}function m(i){return 37===i.keyCode}function X(i){return 38===i.keyCode}function o(i){return 39===i.keyCode}function J(i){return 40===i.keyCode}function O(i){return 13===i.keyCode}function c(i){return 27===i.keyCode}function t(i){return ht.Default.isDelete(i)}function T(i){return ht.Default.isLeftButton(i)}function N(i){return ht.Default.isDoubleClick(i)}function D(i,H){ht.Default.startDragging(i,H)}function f(i){return ht.Default.getClientPoint(i)}function n(i){return ht.Default.getTargetElement(i)}function G(i){return ht.Default.getPagePoint(i)}function k(){return ht.Default.getWindowInfo()}function P(i,H){return ht.Default.getDistance.apply(this,arguments)}function Z(){return ht.Default.unionPoint.apply(this,arguments)}function v(i){return ht.Default.getImageMap()[i]?(delete ht.Default.getImageMap()[i],!0):ht.Default.getCompTypeMap()[i]?(delete ht.Default.getCompTypeMap()[i],!0):!!ht.Default.getShape3dModelMap()[i]&&(delete ht.Default.getShape3dModelMap()[i],!0)}function a(i,H,R){return ht.Default.getPosition(i,H,R)}function F(i,H){var R=arguments.length>2&&void 0!==arguments[2]?arguments[2]:LH.encodeJSON;return ht.Default.stringify(i,H,R)}function w(i,H){return ht.Default.parse(i,H)}function B(i){if(!i)return"";var H=i.lastIndexOf(".");return-1===H?i:i.substr(0,H)}function E(i){return i=i.replace(/^.*[\\\/]/,""),B(i)}function _(i){if(!i)return"";var H=i.lastIndexOf(".");return-1===H?"":i.substr(H,i.length)}function x(i,H,R,M,I){ht.Default.layout(i,H,R,M,I)}function j(i,H,R,M){ht.Default.setCanvas(i,H,R,M)}function Y(i){ht.Default.removeHTML(i)}function r(i,H,R){ht.Default.xhrLoad(i,H,R)}function e(i){return ht.Default.isShiftDown(i)}function s(i){return ht.Default.isCtrlDown(i)}function W(i,H){return ht.Default.createView(i,H)}function l(i){return ht.Default.createCanvas(i)}function V(i,H){return ht.Default.createDiv(H,i)}function A(i,H){return ht.Default.unionRect(i,H)}function g(i,H,R,M,I,p,h,z,d,C){return ht.Default.drawText(i,H,R,M,I,p,h,z,d,C)}function S(i,H,R,M,I,p,h,z,d,C){ht.Default.drawStretchImage(i,H,R,M,I,p,h,z,d,C)}function L(i,H,R,M,I,p,h){ht.Default.drawBorder(i,H,R,M,I,p,h)}function u(i,H,R,M,I,p){var h=i.getContext("2d");return h.save(),H=H||0,R=R||0,M=M||1,p=p||ht.Default.devicePixelRatio,h.translate(H*p,R*p),M*=p,1!==M&&h.scale(M,M),I&&(h.beginPath(),h.rect(I.x,I.y,I.width,I.height),h.clip(),h.clearRect(I.x,I.y,I.width,I.height)),h}function ii(i,H){ht.Default.extendClass(i,H)}function Hi(i,H){H[i._id]=i,i.eachChild(function(i){H[i._id]=i,Hi(i,H)})}function Ri(i){ht.Default.preventDefault(i)}function Mi(i){return/^displays/.test(i)}function Ii(i){return/^symbols/.test(i)}function pi(i){return/^components/.test(i)}function hi(i){return/^scenes/.test(i)}function zi(i){return/^models/.test(i)}function di(i){return/^uis/.test(i)}function Ci(i){return/^assets/.test(i)}function yi(i){return/\.(png|jpg|gif|jpeg|bmp|svg)$/i.test(i)}function bi(i){return/\.json$/i.test(i)}function Ui(i){return/\.mp3$/i.test(i)}function Ki(i){return/\.mp4$/i.test(i)}function qi(i){return/\.svg$/i.test(i)}function Qi(i){return/\.dxf$/i.test(i)}function mi(i){return/\.obj$/i.test(i)}function Xi(i){return/\.mtl$/i.test(i)}function oi(i){return/\.ttf$/i.test(i)}function Ji(i){return/\.otf$/i.test(i)}function Oi(i){return/\.js$/i.test(i)}function ci(i){return i.substring(0,i.length-5)+".png"}function ti(i){return"string"==typeof i||i instanceof String}function Ti(i){return"number"==typeof i}function Ni(i){return i&&"object"==typeof i}function Di(i){return"function"==typeof i}function fi(i){return i instanceof Array}function ni(i,H){var R=i.getPosition().x,M=i.getPosition().y,I=i.getWidth(),p=i.getHeight(),h=[R-I*i.getAnchor().x,M-p*i.getAnchor().y,I,p];Bi(H,"rect",i.a("rect"),h,void 0)}function Gi(i,H){var R=i.getRotation();Bi(H,"rotation",i.a("rotation"),R,0)}function ki(i,H){var R=i.getAnchor().x,M=i.a("anchorX");Bi(H,"anchorX",M,R,.5),R=i.getAnchor().y,M=i.a("anchorY"),Bi(H,"anchorY",M,R,.5)}function Pi(i,H){var R=i.getScale().x,M=i.a("scaleX");Bi(H,"scaleX",M,R,1),R=i.getScale().y,M=i.a("scaleY"),Bi(H,"scaleY",M,R,1)}function Zi(i,H){var R=i.isClosePath();Bi(H,"closePath",i.a("closePath"),R,!1)}function vi(i,H,R,I,p){4===arguments.length&&(p=ht.Style[R]);var h=M(i.s(R)),z=i.getAttrObject();Bi(H,I,z&&z[R],h,p)}function ai(i,H){var R=i.getDisplayName();Bi(H,"displayName",i.a("displayName"),R,void 0)}function Fi(i,H){if(fi(i)&&fi(H)){if(i.length===H.length){for(var R=0;R<i.length;R++)if(!Fi(i[R],H[R]))return!1;return!0}return!1}if(Ni(i)&&Ni(H)){var M=Object.keys(i);if(M.length===Object.keys(H).length){for(var I=0;I<M.length;I++){var p=M[I];if(!Fi(i[p],H[p]))return!1}return!0}return!1}return i===H}function wi(i){return i instanceof ht.DataModel?DR+i.serialize(0):i}function Bi(i,H,R,M,I){var p=Fi(M,I);if(R){var h=i[H]={func:R};p||(h.value=wi(M))}else p||void 0===M||(i[H]=wi(M))}function Ei(i,H,R,M){xi(i,"2d.visible",H.visible),xi(i,"2d.selectable",H.selectable),xi(i,"2d.movable",H.movable),xi(i,"2d.editable",H.editable),xi(i,"pixelPerfect",H.pixelPerfect,!1),xi(i,"opacity",H.opacity,1),xi(i,"clip.percentage",H.clipPercentage,1),xi(i,"clip.direction",H.clipDirection,"top"),xi(i,"layout.h",H.layoutH),xi(i,"layout.v",H.layoutV),xi(i,"prefix",H.prefix),xi(i,"state",H.state),i instanceof ht.Text||(xi(i,"shadow",H.shadow,!1),xi(i,"select.color",H.shadowColor,ht.Color.highlight),xi(i,"shadow.blur",H.shadowBlur,6),xi(i,"shadow.offset.x",H.shadowOffsetX,3),xi(i,"shadow.offset.y",H.shadowOffsetY,3)),ji(i,H),ri(i,H),ei(i,H),Yi(i,H),i instanceof ht.Shape&&!H.rect||Wi(i,H,R,M);var I=LH.customProperties.comp;I&&I.length&&I.forEach(function(R){xi(i,R.property,H[R.property],R.defaultValue)}),qR.forEach(function(R){i.a(R,H[R])}),i.a("renderHTML",H.renderHTML)}function _i(i,H){vi(i,H,"2d.visible","visible"),vi(i,H,"2d.selectable","selectable"),vi(i,H,"2d.movable","movable"),vi(i,H,"2d.editable","editable"),vi(i,H,"pixelPerfect","pixelPerfect",!1),vi(i,H,"opacity","opacity",1),vi(i,H,"clip.percentage","clipPercentage",1),vi(i,H,"clip.direction","clipDirection","top"),vi(i,H,"layout.h","layoutH"),vi(i,H,"layout.v","layoutV"),vi(i,H,"prefix","prefix"),vi(i,H,"state","state"),i instanceof ht.Text||(vi(i,H,"shadow","shadow",!1),vi(i,H,"select.color","shadowColor",ht.Color.highlight),vi(i,H,"shadow.blur","shadowBlur",6),vi(i,H,"shadow.offset.x","shadowOffsetX",3),vi(i,H,"shadow.offset.y","shadowOffsetY",3)),ai(i,H),ki(i,H),Pi(i,H),Gi(i,H),i instanceof ht.Shape&&!i.a("rect")||ni(i,H);var R=LH.customProperties.comp,M=!!LH.saveCompCustomPropertyDefaultValue;R&&R.length&&R.forEach(function(R){M?vi(i,H,R.property,R.property):vi(i,H,R.property,R.property,R.defaultValue)}),qR.forEach(function(R){i.a(R)&&(H[R]=i.a(R))}),i.a("renderHTML")&&(H.renderHTML=i.a("renderHTML"))}function xi(i,H,R,I){3===arguments.length&&(I=ht.Style[H]);var p=$i(R,I);if(ti(p)&&p.substring(0,15)===DR){var h=new ht.DataModel;h.deserialize(w(p.substr(15))),p=h}i.s(H,M(p)),i.a(H,li(R))}function ji(i,H){i.setDisplayName($i(H.displayName),void 0),i.a("displayName",li(H.displayName))}function Yi(i,H){i.setRotation($i(H.rotation,0)),i.a("rotation",li(H.rotation))}function ri(i,H){var R=$i(H.anchorX,.5),M=$i(H.anchorY,.5);.5===R&&.5===M||i.setAnchor(R,M),i.a("anchorX",li(H.anchorX)),i.a("anchorY",li(H.anchorY))}function ei(i,H){var R=$i(H.scaleX,1),M=$i(H.scaleY,1);i.setScale(R,M),i.a("scaleX",li(H.scaleX)),i.a("scaleY",li(H.scaleY))}function si(i,H){i.setClosePath($i(H.closePath,!1)),i.a("closePath",li(H.closePath))}function Wi(i,H,R,M){var I=$i(H.rect),p=$i(H.relative);I||(I=[0,0,R,M],p=!1);var h=I.length;if(4===h)I={x:I[0],y:I[1],width:I[2],height:I[3]},p&&(I.x*=R,I.y*=M,I.width*=R,I.height*=M);else if(3===h){var z=I[0];I={width:I[1],height:I[2]},p&&(I.width*=R,I.height*=M),"object"==typeof z?z.length&&(z={x:z[0],y:z[1]}):z=a(z,{x:0,y:0,width:R,height:M},I),I.x=z.x-I.width*i.getAnchor().x,I.y=z.y-I.height*i.getAnchor().y}var d=$i(H.offsetX);d&&(I.x+=d),d=$i(H.offsetY),d&&(I.y+=d),I.width<0||I.height<0?i.p(I.x,I.y):i.setRect(I),i.a("rect",li(H.rect))}function $i(i,H){var R=void 0;return R=Ni(i)&&i.func?i.value:i,void 0===R&&(R=H),R}function li(i){if(Ni(i)&&i.func)return i.func}function Vi(i){if(fi(i)){for(var H=new ht.List,R=i.length,M=0;M<R;M+=2)H.add({x:i[M],y:i[M+1]});i=H}return i}function Ai(i){if(i instanceof ht.List&&(i=i.toArray()),fi(i)){for(var H=[],R=0;R<i.length;R++){var M=i[R];H.push(M.x,M.y)}i=H}return i}function gi(i){return{width:16,height:16,comps:[{type:function(H,R,M,I,p){var h=i.graphView,z=ht.Default.getImage(h.getImage(I));if(z&&z.snapshotURL)(z=ht.Default.getImage(z.snapshotURL))&&S(H,z,"uniform",R.x,R.y,R.width,R.height,I,p);else{var d=ht.Default.clone(z&&z.boundExtend?I.getRect():h.getDataUIBounds(I));if(d&&d.width&&d.height){H.save();var C=Math.min(1,16/Math.max(d.width,d.height));H.translate(-d.x*C+(16-d.width*C)/2,-d.y*C+(16-d.height*C)/2),H.scale(C,C);var y=h._zoom;h._zoom=C,h.drawData(H,I),h._zoom=y,H.restore()}}}}]}}function Si(i,H){var R=i.graphView.getEdgeInfo(H);if(!R)return kR;var M=R.edgeTypeInfo,I=void 0,p=void 0;if(!R.type||R.points){R.sourcePoint.x,R.sourcePoint.y,R.targetPoint.x,R.targetPoint.y;R.type?(I=new ht.List(R.sourcePoint),I.addAll(R.points),I.add(R.targetPoint),p=R.segments):R.looped?(I=ZR,p=vR):I=R.center?[R.c1,R.sourcePoint,R.targetPoint,R.c2]:[R.sourcePoint,R.targetPoint]}else M&&(I=M.points,p=M.segments);var h=Z(I);if(h&&(h.width||h.height)){var z=Math.max(1,Math.max(h.width,h.height)/16),d=[],C=(16-h.width/z)/2,y=(16-h.height/z)/2;I instanceof ht.List&&(I=I.toArray()),I.forEach(function(i){d.push((i.x-h.x)/z+C,(i.y-h.y)/z+y)});var b=p?p.toArray():null;return{width:16,height:16,comps:[{type:"shape",points:d,segments:b,borderWidth:1,borderColor:R.color,borderCap:R.cap,borderJoin:R.join}]}}return kR}function Li(i){var H=Z(i.getPoints());if(H&&(H.width||H.height)){var R=Math.max(1,Math.max(H.width,H.height)/16),M=[],I=(16-H.width/R)/2,p=(16-H.height/R)/2;i.getPoints().each(function(i){M.push((i.x-H.x)/R+I,(i.y-H.y)/R+p)});var h=i.getSegments()?i.getSegments().toArray():null;return{width:16,height:16,comps:[{type:"shape",points:M,segments:h,rotation:i.getRotation(),background:i.s("shape.background"),repeatImage:i.s("shape.repeat.image"),borderWidth:i.s("shape.border.width")?1:0,borderColor:i.s("shape.border.color"),borderCap:i.s("shape.border.cap"),borderJoin:i.s("shape.border.join"),gradient:i.s("shape.gradient"),gradientColor:i.s("shape.gradient.color"),closePath:i.isClosePath()}]}}return kR}function ui(i){return ht.Default.isInput(i)}function iH(i,H){var R=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},M=R.nullable,I=void 0===M||M,h=R.trim,z=void 0!==h&&h,d=R.cancellable,C=void 0===d||d,y=R.width,b=void 0===y?300:y,U=R.height,K=void 0===U?120:U,q=R.maxLength,Q=void 0===q?-1:q,m=R.checkFunc,X=void 0===m?void 0:m,o=R.$38$,J=void 0===o?void 0:o,O=arguments[3],c=new bR;c.addRow([{id:"input",textField:{text:H}}],[.1]);var t=new yR,T=[],N=null,D=null;N=function(){var i=c.v("input");return z&&i&&i.trim(),!1!==I||i?Q>0&&i&&i.length>Q?void HH(null,p("editor.inputmax"),function(){}):X&&!(i=X(i))?void HH(null,p("editor.invalidinput"),function(){}):(O(i,"ok"),void t.hide()):void HH(null,p("editor.inputempty"),function(){})},T.push({label:p("editor.ok"),action:N}),C&&(D=function(){O(H,"cancel"),t.hide()},T.push({label:p("editor.cancel"),action:D})),t.setConfig({title:i,draggable:!0,width:b,height:K,contentPadding:10,content:c,buttons:T,buttonsAlign:"right"}),t.$48$=D,t.$47$=N,t.show(J),c.getViewById("input").getElement()._ignore=!0,c.getViewById("input").setFocus()}function HH(i,H,R,M){var I=arguments.length>4&&void 0!==arguments[4]?arguments[4]:300,h=[],z=void 0,d=void 0;R&&(z=function(){y.hide(),R()},h.push({label:p("editor.ok"),action:z})),M&&(d=function(){y.hide(),M()},h.push({label:p("editor.cancel"),action:d}));var C=document.createElement("p");C.style.color=ht.Default.labelColor,C.style.marginBlockStart="0px",C.style.marginBlockEnd="0px",C.innerText=H;var y=new yR({title:i||p("editor.prompt"),contentPadding:20,width:I,draggable:!0,content:C,buttons:h});y.$48$=d||z,y.$47$=z,y.setModal(!0),y.show()}function RH(i,H,R,M){var I={unfocusable:!0,id:i,toolTip:H},p=ht.Default.getImage(R),h=p?p.width:16,z=p?p.height:16;return I.icon={width:h+8,height:z+8,fitSize:!!p&&p.fitSize,comps:[{type:"rect",background:{func:function(i,H){return H.getCurrentItem()===I?KR.config.color_hover:null}},rect:[0,0,h+8,z+8]},{type:"image",name:R,color:{func:function(i,H){return M&&M()?KR.config.color_select:KR.config.color_dark}},rect:[4,4,h,z]}]},I}function MH(i,H,R){R||(R=ht.Default.labelFont);var M=ht.Default.textExtraWidth/2,I=ht.Default.formPaneLabelHPadding+M,p=ht.Default.formPaneLabelVPadding,h=ht.Default.createDiv(!0);return h.style.font=R,h.style.color=ht.Default.labelColor,h.style.padding=p+"px "+I+"px",h.style.whiteSpace="nowrap",h.style.verticalAlign="middle",h.innerHTML=i,H&&(h.style.textAlign=H),h.onLayouted=function(i,H,R,M){h.style.lineHeight=M+"px"},h}function IH(i,H,R,M){var I=new ht.widget.Button;return I.setLabel(i),I.setLabelColor(ht.Default.labelColor),I.setLabelSelectColor(KR.config.color_select),I.setIcon(R),I.setBackground(null),I.setBorderColor(null),M&&(I.onClicked=M),H&&(I.setToolTip(H),I.enableToolTip()),I.getCurrentBackground=function(){return this._hover||this.isPressed()?KR.config.color_hover:null},I.getCurrentBorderColor=function(){return this.isSelected()?KR.config.color_select:null},I.getView().addEventListener("mouseenter",function(){I.isDisabled()||(I._hover=!0,I.iv())},!1),I.getView().addEventListener("mouseleave",function(){I.isDisabled()||(I._hover=!1,I.iv())},!1),I}function pH(i,H){var R=ht.Default.getImage(i);if(!R)throw i;var M={width:R.width,height:R.height,fitSize:R.fitSize,comps:[{type:"image",name:i,color:{func:function(){return H&&H()?KR.config.color_select:KR.config.color_dark}}}]},I=i+".state";return ht.Default.setImage(I,M),I}function hH(i,H,R){var M=new FileReader;M.onloadend=function(i){H(i.target.result)},R?M.readAsDataURL(i):M.readAsText(i)}function zH(i,H){if(H){H===document.body&&(document.title=p("editor.title"),document.body.style.overflow="hidden"),H.appendChild(i.getView());var R=i.getView().style;R.left="0px",R.top="0px",setInterval(function(){if(i.getView()!==(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)){var M=void 0,I=void 0;H===document.body?(M=document.documentElement.clientWidth,window.innerWidth&&window.innerWidth<M&&(M=window.innerWidth),I=document.documentElement.clientHeight,window.innerHeight&&window.innerHeight<I&&(I=window.innerHeight)):(M=H.clientWidth,I=H.clientHeight),M===i._oldWidth&&I===i._oldHeight||(i._oldWidth=M,i._oldHeight=I,R.width=M+"px",R.height=I+"px",i.iv())}},500)}}function dH(i){if(i)for(var H=0;H<i.length;H++)null==i[H]&&(i[H]=0)}function CH(i){if(i)for(var H=ht.Color.chart,R=0;R<i.length;R++)null==i[R]&&(i[R]=H[R%H.length])}function yH(i,H){H=void 0===H?i?i.length:0:H;for(var R=new Array(H),M=0;M<H;M++)R[M]=i?i[M]:void 0;return R}function bH(i){if(i instanceof ht.graph.GraphView){var H=i.getContentRect(),R=Math.max(H.width,H.height),M=Math.min(H.width,H.height),I=Math.max(1/M,KR.config.imageSize/R);return i.toDataURL(void 0,void 0,I)}if(i instanceof ht.graph3d.Graph3dView){var p=i.getWidth(),h=i.getHeight(),z=Math.max(p,h),d=Math.min(1,KR.config.imageSize/z);z<3&&(d=KR.config.imageSize/z),p=Math.floor(p*d),h=Math.floor(h*d);return i.toCanvas(i.dm().getBackground(),p,h).toDataURL("image/png",1)}if(ht.ui&&i instanceof ht.ui.View){var C=i.getWidth(),y=i.getHeight(),b=C,U=y,K=Math.max(b,U),q=Math.min(1,KR.config.imageSize/K);K<3&&(q=KR.config.imageSize/K),b=Math.floor(b*q),U=Math.floor(U*q);var Q=i.getRootCanvas(),m=(Q||i.getView()).getBoundingClientRect(),X=document.createElement("canvas");X.width=b,X.height=U;var o=X.getContext("2d"),J=function(H){for(var R=0;R<H.size();R++){var M=H.get(R);if(M===i)Q&&o.drawImage(Q,0,0,C,y,0,0,b,U);else{var I=M.getRootCanvas();if(I){var p=I.getBoundingClientRect();o.drawImage(I,0,0,I.width,I.height,(p.left-m.left)/C*b,(p.top-m.top)/y*U,I.width/C*b,I.height/y*U)}}if(M instanceof ht.ui.UIGraphView||M instanceof ht.ui.UIGraph3dView||M instanceof ht.ui.UIVectorView){var h=M.getContent(),z=h.toCanvas();if(z){var d=h._canvas.getBoundingClientRect();o.drawImage(z,0,0,z.width,z.height,(d.left-m.left)/C*b,(d.top-m.top)/y*U,z.width/C*b,z.height/y*U)}}M.getChildren&&M.getChildren().size()>0&&J(M.getChildren())}},O=new ht.List;return O.add(i),J(O),X.toDataURL("image/png",1)}var c=ht.Default.getImage(i),t=Math.max(c.width,c.height),T=Math.min(1,KR.config.imageSize/t);return ht.Default.toCanvas(i,c.width*T,c.height*T).toDataURL("image/png",1)}function UH(i,H,R){if(i instanceof Array)for(var M=0,I=i.length;M<I;M++)UH(i[M],H,R);else if(i instanceof Object&&!(i instanceof ht.DataModel))for(var p in i)if(i.hasOwnProperty(p)){var h=i[p];if(!Ni(h))continue;if(ti(h.func)&&fR.test(h.func)){var z=h.func.slice(5);H&&void 0===H[z]&&(H[z]=p),R&&void 0===R[z]&&(R[z]=h.value)}else UH(h,H,R)}}function KH(i){return new(ht.Default.getClass(KR.config.codeEditorClass)||UR)(i)}function qH(){var i=arguments[0];if(!i)return"";for(var H=1;H<arguments.length;H++)i=i.replace("{"+(H-1)+"}",arguments[H]);return i}function QH(i,H,R){var M=new ht.Math.Matrix2d,I=i.getPosition(),p=i.getScale(),h=i.getRotation();return M.translate(-I.x,-I.y).scale(p.x,p.y).rotate(h).translate(I.x,I.y),M.apply({x:H,y:R})}function mH(i){i.forEach(function(i){i.getPoints().reverse();var H=i.getSegments();if(H){var R=H.size(),M=H.get(R-1);5===M&&H.pop(),H.shift(),H.reverse(),H.unshift(1),5===M&&H.push(M)}})}function XH(i){var H=void 0,R=void 0,I=void 0,p=void 0,h=void 0,z=void 0,d=[],C=[],y=void 0;if(i.forEach(function(i){y||(y=i.getClass());var b=i.getPoints().toArray().map(function(H){return QH(i,H.x,H.y)});d=d.concat(b);var U=i.getSegments();if(U)U=U.toArray();else{U=[1];for(var K=1,q=i.getPoints().size();K<q;K++)U.push(2)}i.isClosePath()&&U.push(5),C.push.apply(C,U),H||(H=i.dm(),R=i.getThickness(),I=i.getElevation(),p=i.getTall(),h=M(i.getStyleMap()),z=M(i.getAnchor3d())),i.removeFromDataModel()}),y){var b=[];C.forEach(function(i){5===i&&1===b[b.length-1]||b.push(i)});var U=new y;U.setPoints(d),U.setSegments(b),U.setThickness(R),U.setElevation(I),U.setTall(p),U.setAnchor3d(z),U.s(h),H.add(U),H.sm().ss(U)}}function oH(i){var H=i.dm(),R=i.getSegments();if(R){var I=[],p=i.getPoints(),h=void 0,z=void 0,d=0;R.forEach(function(i){switch(i){case 1:h=[i],z=[M(p.get(d++))],I.push({segments:h,points:z});break;case 2:h.push(i),z.push(M(p.get(d++)));break;case 3:h.push(i),z.push(M(p.get(d++))),z.push(M(p.get(d++)));break;case 4:h.push(i),z.push(M(p.get(d++))),z.push(M(p.get(d++))),z.push(M(p.get(d++)));break;case 5:h.push(i)}});var C=i.getThickness(),y=i.getElevation(),b=i.getTall(),U=M(i.getStyleMap()),K=M(i.getAnchor3d()),q=[];I.forEach(function(R){var M=new(i.getClass());M.setPoints(R.points),M.setSegments(R.segments),M.setThickness(C),M.setElevation(y),M.setTall(b),M.setAnchor3d(K),M.s(U),H.add(M),q.push(M)}),H.sm().ss(q),i.removeFromDataModel()}}function JH(i,H){for(var R=0,M=i.length;R<M;R++){var I=i.get(R);if(!(I instanceof ht.Shape))return!1;if(!H&&I instanceof ht.CSGShape)return!1}return!0}function OH(i,H,R,M){var I=i.getRowIndex(H),p=i.tx(),h=i.ty(),z=i.getRowHeight(),d={x:p,y:z*I+h,width:R.getWidth(),height:z};i.beginEditing({column:R,data:H,view:i,editorRect:d,value:M})}function cH(i,H){i.vectorDataBindingDisabled=!0,i.enableToolTip(),i.getToolTip=function(){var i=ht.Default.getImage(this.getIcon()),H=ht.Default.getInternal().getImageWidth(i),R=ht.Default.getInternal().getImageHeight(i);return H&&R?H+", "+R:void 0},i.setExtraInfo=function(H){var R=H&&H.url||H;i.actionURL=H&&H.actionURL||H,i.setIconColor(H&&H.iconColor||void 0);var M=ht.Default.getImage(R);M&&M.snapshotURL?i.setIcon(M.snapshotURL):i.setIcon(R)};var R=i.getView();R.style.cursor="pointer";var M=function(R){R.preventDefault(),N(R)?H.open(i.actionURL):H.selectFileNode(i.actionURL)};R.addEventListener("mousedown",M,!1),R.addEventListener("touchstart",M,!1)}function tH(i,H,R){var M=i.getElement?i.getElement():i.getView?i.getView():i,I=void 0;i.isDroppable=H,i.handleCrossDrag=function(H,p,h){"enter"===p?(I=M.style.border,M.style.border="solid "+KR.config.color_select_dark+" 2px"):"exit"===p||"cancel"===p?M.style.border=I:"over"===p||"drop"===p&&(R(h.view.draggingData),M.style.border=I,i.setFocus&&i.setFocus())}}function TH(i,H){for(var R=H.getParent();R;)H=R,R=H.getParent();return i.getRoots().indexOf(H)}function NH(i){var H={clazz:this.getClass(),name:this.getName(),displayName:this.getDisplayName(),toolTip:this.getToolTip(),tag:this.getTag(),icon:this.getIcon(),layer:this.getLayer(),parent:i.$57$(this.getParent()),a:{},s:{},dataBindings:this.getDataBindings()?F(this.getDataBindings(),null,!1):null},R=this.getStyleMap();for(var I in R)H.s[I]=M(this.s(I));var p=this.getAttrObject();for(var h in p)H.a[h]=M(this.a(h));return H}function DH(i,H){var R=new i.clazz,I=H.dm();if(KR.config.cloneName&&R.setName(i.name),KR.config.cloneDisplayName&&R.setDisplayName(i.displayName),KR.config.cloneToolTip&&R.setToolTip(i.toolTip),KR.config.cloneTag&&!I.getDataByTag(i.tag)&&R.setTag(i.tag),KR.config.cloneIcon&&R.setIcon(i.icon),KR.config.cloneLayer&&R.setLayer(i.layer),KR.config.cloneStyle)for(var p in i.s)R.s(p,M(i.s[p]));if(KR.config.cloneAttr)for(var h in i.a)R.a(h,M(i.a[h]));return KR.config.cloneDataBindings&&i.dataBindings&&R.setDataBindings(w(i.dataBindings)),R}function fH(i,H,R){var M=KR.config.cloneParent?H.$49$(i.parent,R):void 0;this.setParent(M||H.getCurrentSubGraph())}function nH(i){var H=NH.call(this,i);return H.r3=this.r3(),H.rotationMode=this.getRotationMode(),H.p3=this.p3(),H.s3=this.s3(),H.scale3d=this.getScale3d(),H.anchor3d=this.getAnchor3d(),H.image=this.getImage(),H.host=i.$57$(this.getHost()),H.renderLayer=this.getRenderLayer(),H}function GH(i,H){var R=DH(i,H);return R.setRenderLayer(i.renderLayer),KR.config.cloneRotation&&(R.r3(i.r3),R.setRotationMode(i.rotationMode)),KR.config.clonePosition&&R.p3(i.p3),KR.config.cloneSize&&R.s3(i.s3),KR.config.cloneScale&&R.setScale3d(i.scale3d),KR.config.cloneAnchor&&R.setAnchor3d(i.anchor3d),KR.config.cloneImage&&R.setImage(i.image),R}function kH(i,H,R){fH.call(this,i,H,R),KR.config.cloneHost&&this.setHost(H.$49$(i.host,R))}function PH(i){var H=NH.call(this,i);return H.source=i.$57$(this.getSource()),H.target=i.$57$(this.getTarget()),H}function ZH(i,H){return DH(i,H)}function vH(i,H,R){fH.call(this,i,H,R),KR.config.cloneSource&&this.setSource(H.$49$(i.source,R)),KR.config.cloneTarget&&this.setTarget(H.$49$(i.target,R))}function aH(i){var H=nH.call(this,i);return H.expanded=this.isExpanded(),H}function FH(i,H){var R=GH(i,H);return KR.config.cloneExpanded&&R.setExpanded(i.expanded),R}function wH(i){var H=nH.call(this,i);return H.points=M(this.getPoints()),H.segments=M(this.getSegments()),H.thickness=this.getThickness(),H.closePath=this.isClosePath(),H}function BH(i,H){var R=GH(i,H);return KR.config.clonePoints&&R.setPoints(M(i.points)),KR.config.cloneSegments&&R.setSegments(M(i.segments)),KR.config.cloneThickness&&R.setThickness(i.thickness),KR.config.cloneClosePath&&R.setClosePath(i.closePath),R}function EH(i){var H=nH.call(this,i);return H.clickThroughEnabled=this.isClickThroughEnabled(),H.syncSize=this.isSyncSize(),H}function _H(i,H){var R=GH(i,H);return KR.config.cloneClickThroughEnabled&&R.setClickThroughEnabled(i.clickThroughEnabled),KR.config.cloneSyncSize&&R.setSyncSize(i.syncSize),R}function xH(i){var H=EH.call(this,i);return H.ref=this.getRef(),H}function jH(i,H){var R=_H(i,H);return KR.config.cloneRef&&R.setRef(i.ref),R}function YH(i){var H=nH.call(this,i);return H.points=M(this.getPoints()),H.colors=M(this.getColors()),H.sizes=M(this.getSizes()),H.uvoffsets=M(this.getUvoffsets()),H}function rH(i,H){var R=GH(i,H);if(R instanceof ht.Points)i.points&&R.setPoints(M(i.points)),i.colors&&R.setColors(M(i.colors)),i.sizes&&R.setSizes(M(i.sizes)),i.uvoffsets&&R.setUvoffsets(M(i.uvoffsets));else{var I=R.getStyleMap();for(var p in I)0===p.indexOf("points")&&R.s(p,void 0)}return R}function eH(i){if(!(i instanceof ht.Node))return null;if(i instanceof ht.Group||i instanceof ht.Grid||i instanceof ht.Block)return null;var H=void 0;if(i instanceof _R)H={type:"clip",points:M(i.getPoints()),segments:M(i.getSegments()),closePath:i.isClosePath()};else if(i instanceof xR)H={type:"restore"};else if(i instanceof ht.Shape)H={type:"shape",points:M(i.getPoints()),segments:M(i.getSegments()),closePath:i.isClosePath()};else if(i instanceof ht.Text)H={type:"text",text:i.s("text"),align:i.s("text.align"),vAlign:i.s("text.vAlign"),color:i.s("text.color"),gradientPack:i.s("text.gradient.pack"),font:i.s("text.font"),shadow:i.s("text.shadow"),shadowColor:i.s("text.shadow.color"),shadowBlur:i.s("text.shadow.blur"),shadowOffsetX:i.s("text.shadow.offset.x"),shadowOffsetY:i.s("text.shadow.offset.y")};else if(i instanceof ht.Node){var R=i.s("shape");R?(H={type:"node_shape",shape:i.s("shape")},"rect"===R?H.depth=i.s("shape.depth"):"roundRect"===R?H.polygonSide=i.s("shape.corner.radius"):"polygon"===R?H.polygonSide=i.s("shape.polygon.side"):"arc"===R&&(H.arcFrom=i.s("shape.arc.from"),H.arcTo=i.s("shape.arc.to"),H.arcClose=i.s("shape.arc.close"),H.arcOval=i.s("shape.arc.oval"))):i.getImage()&&(H={type:"node_image",image:i.getImage(),stretch:i.s("image.stretch"),color:i.s("body.color")})}return H&&(H.visible=i.s("2d.visible"),H.displayName=i.getDisplayName(),H.x=i.getPosition().x,H.y=i.getPosition().y,H.anchorX=i.getAnchor().x,H.anchorY=i.getAnchor().y,H.scaleX=i.getScale().x,H.scaleY=i.getScale().y,H.rotation=i.getRotation(),H.width=i._width,H.height=i._height,H.opacity=i.s("opacity"),H.renderLayer=i.getRenderLayer(),"shape"!==H.type&&"node_shape"!==H.type||(H.background=i.s("shape.background"),H.repeatImage=i.s("shape.repeat.image"),H.borderWidth=i.s("shape.border.width"),H.borderColor=i.s("shape.border.color"),H.border3d=i.s("shape.border.3d"),H.border3dColor=i.s("shape.border.3d.color"),H.border3dAccuracy=i.s("shape.border.3d.accuracy"),H.borderCap=i.s("shape.border.cap"),H.borderJoin=i.s("shape.border.join"),H.borderPattern=i.s("shape.border.pattern"),H.gradient=i.s("shape.gradient"),H.gradientColor=i.s("shape.gradient.color"),H.dash=i.s("shape.dash"),H.dashPattern=i.s("shape.dash.pattern"),H.dashOffset=i.s("shape.dash.offset"),H.dashColor=i.s("shape.dash.color"),H.dashWidth=i.s("shape.dash.width"),H.dash3d=i.s("shape.dash.3d"),H.dash3dColor=i.s("shape.dash.3d.color"),H.dash3dAccuracy=i.s("shape.dash.3d.accuracy"),H.fillRule=i.s("shape.fill.rule"),H.fillClipDirection=i.s("shape.fill.clip.direction"),H.fillClipPercentage=i.s("shape.fill.clip.percentage"),H.gradientPack=M(i.s("shape.gradient.pack")),H.borderGradientPack=M(i.s("shape.border.gradient.pack")),H.borderWidthAbsolute=i.s("shape.border.width.absolute"))),H}function sH(i,H){var R=void 0;if("clip"===i.type)H&&(R=new _R,R.s("type","clip"),R.setPoints(i.points),R.setSegments(i.segments));else if("restore"===i.type)H&&(R=new xR,R.s("type","restore"));else if("shape"===i.type)R=H?new wR:new ht.Shape,R.s("type","shape"),R.setPoints(i.points),R.setSegments(i.segments),R.setClosePath(i.closePath);else if("node_shape"===i.type){R=H?new FR:new ht.Node;var I=i.shape;R.s("shape",I),"rect"===I?R.s("shape.depth",i.depth):"roundRect"===I?R.s("shape.corner.radius",i.polygonSide):"polygon"===I?R.s("shape.polygon.side",i.polygonSide):"arc"===I&&(R.s("shape.arc.from",i.arcFrom),R.s("shape.arc.to",i.arcTo),R.s("shape.arc.close",i.arcClose),R.s("shape.arc.oval",i.arcOval))}else"node_image"===i.type?(H?(R=new BR,R.s("type","image"),R.s("image",i.image)):(R=new ht.Node,R.setImage(i.image)),R.s("body.color",i.color)):"text"===i.type&&(R=H?new ER:new ht.Text,R.s("type","text"),R.s("text",i.text),R.s("text.align",i.align),R.s("text.vAlign",i.vAlign),R.s("text.color",i.color),R.s("text.gradient.pack",i.gradientPack),R.s("text.font",i.font),R.s("text.shadow",i.shadow),R.s("text.shadow.color",i.shadowColor),R.s("text.shadow.blur",i.shadowBlur),R.s("text.shadow.offset.x",i.shadowOffsetX),R.s("text.shadow.offset.y",i.shadowOffsetY),R.s("text.decoration",i.decoration),R.s("text.vertical",i.vertical));return R?(R.s("2d.visible",i.visible),R.setDisplayName(i.displayName),R.setPosition(i.x,i.y),.5===i.anchorX&&.5===i.anchorY||R.setAnchor(i.anchorX,i.anchorY),R.setScale(i.scaleX,i.scaleY),R.setRotation(i.rotation),R.setSize(i.width,i.height),R.s("opacity",i.opacity),R.setRenderLayer(i.renderLayer),"shape"!==i.type&&"node_shape"!==i.type||(R.s("shape.background",i.background),R.s("shape.repeat.image",i.repeatImage),R.s("shape.border.width",i.borderWidth),R.s("shape.border.color",i.borderColor),R.s("shape.border.3d",i.border3d),R.s("shape.border.3d.color",i.border3dColor),R.s("shape.border.3d.accuracy",i.border3dAccuracy),R.s("shape.border.cap",i.borderCap),R.s("shape.border.join",i.borderJoin),R.s("shape.border.pattern",i.borderPattern),R.s("shape.gradient",i.gradient),R.s("shape.gradient.color",i.gradientColor),R.s("shape.dash",i.dash),R.s("shape.dash.pattern",i.dashPattern),R.s("shape.dash.offset",i.dashOffset),R.s("shape.dash.color",i.dashColor),R.s("shape.dash.width",i.dashWidth),R.s("shape.dash.3d",i.dash3d),
R.s("shape.dash.3d.color",i.dash3dColor),R.s("shape.dash.3d.accuracy",i.dash3dAccuracy),R.s("shape.fill.rule",i.fillRule),R.s("shape.fill.clip.direction",i.fillClipDirection),R.s("shape.fill.clip.percentage",i.fillClipPercentage),R.s("shape.gradient.pack",M(i.gradientPack)),R.s("shape.border.gradient.pack",M(i.borderGradientPack)),R.s("shape.border.width.absolute",i.borderWidthAbsolute)),R):null}function WH(i,H){var R=void 0,M=H?H.dm:null,I=M?M.a("width"):100,p=M?M.a("height"):100,h=$i(i.type);if(ti(h)){var z=_M[h];z?R=new z(i,I,p):bi(h)&&(R=new aM(i,I,p))}else R=new vM(i,I,p);return R&&H&&H.addData(R,!0),R}function $H(i,H){i.s("chart.series")||i.s("chart.series",[]);var R=i.s("chart.series");R[0]||(R[0]={});var M=R[0];return M.values||(M.values=[]),M.colors||(M.colors=[]),M[H]}function lH(i,H){return $i($H(i,H))}function VH(i,H){return li($H(i,H))}function AH(){var i=KR.config.customProperties.display;i&&i.length&&i.forEach(function(i){var H=(i.accessType||"a")+":"+i.property;PR.display[H]=!0}),i=KR.config.customProperties.data,i&&i.length&&i.forEach(function(i){var H=(i.accessType||"a")+":"+i.property;PR.data[H]=!0}),i=KR.config.customProperties.symbol,i&&i.length&&i.forEach(function(i){PR.symbol[i.property]=!0}),i=KR.config.customProperties.comp,i&&i.length&&i.forEach(function(i){PR.comp[i.property]=!0}),i=KR.config.customProperties.scene,i&&i.length&&i.forEach(function(i){var H=(i.accessType||"a")+":"+i.property;PR.scene[H]=!0}),(i=KR.config.customProperties.data3d)&&i.length&&i.forEach(function(i){var H=(i.accessType||"a")+":"+i.property;PR.data3d[H]=!0})}function gH(){var i=KR.config,H=KR.consts,R=function(H,R){void 0===i.valueTypes[H]&&(R.name="editor.valuetype."+H.toLowerCase(),i.valueTypes[H]=R)};R("String",{type:"string"}),R("Image",{type:"image"}),R("URL",{type:"url"}),R("Multiline",{type:"multiline"}),R("Font",{type:"font"}),R("Angle",{type:"number",angle:!0}),R("Int",{type:"int",step:1}),R("PositiveNumber",{type:"number",step:1,min:0}),R("Number",{type:"number",step:1}),R("Color",{type:"color"}),KR.SceneView&&(R("GradientPack",{type:"gradientPack"}),R("DataModel",{type:"dataModel"})),R("Boolean",{type:"boolean"}),R("Function",{type:"function"}),R("Object",{type:"object"}),R("ObjectArray",{type:"objectArray",rowHeight:60}),R("StringArray",{type:"stringArray",rowHeight:60}),R("NumberArray",{type:"numberArray",rowHeight:60}),R("ColorArray",{type:"colorArray",rowHeight:60}),R("Opacity",{type:"number",min:0,max:1,step:.01}),R("Percentage",{type:"number",min:0,max:1,step:.01}),R("Gradient",{type:"enum",values:i.gradients,icons:i.gradientIcons,dropDownWidth:140}),R("FillRule",{type:"enum",values:H.fillRules,labels:H.fillRuleLabels}),R("ClipDirection",{type:"enum",values:H.clipDirections,labels:H.clipDirectionLabels}),R("CapStyle",{type:"enum",values:H.caps,labels:H.capLabels}),R("JoinStyle",{type:"enum",values:H.joins,labels:H.joinLabels}),R("Align",{type:"enum",values:H.aligns,labels:H.alignLabels}),R("VAlign",{type:"enum",values:H.vAligns,labels:H.vAlignLabels}),R("Stretch",{type:"enum",values:H.stretchs,labels:H.stretchLabels}),R("Direction",{type:"enum",values:H.directions,labels:H.directionLabels}),R("Orientation",{type:"enum",values:H.orientations,labels:H.orientationLabels}),R("ColumnChart",{type:"enum",values:H.columnChartTypes,labels:H.columnChartTypeLabels}),H.valueTypes=[],H.valueTypeLabels=[];for(var M in KR.config.valueTypes)!function(i){var R=KR.config.valueTypes[i];R.type&&(H.valueTypes.push(i),H.valueTypeLabels.push(p(R.name)||p(i)),"enum"===R.type&&R.i18nLabels&&!R.labels&&(R.labels=[],R.i18nLabels.forEach(function(i){R.labels.push(p(i))})))}(M)}function SH(){var i=KR.consts={};i.edgeTypes=KR.config.edgeTypes,i.edgeTypeLabels=KR.config.edgeTypes.map(function(i){var H=p("edgeType."+i,!0);return H||i}),i.aligns=["left","center","right"],i.alignLabels=[p("editor.align.left"),p("editor.align.center"),p("editor.align.right")],i.vAligns=["top","middle","bottom"],i.vAlignLabels=[p("editor.valign.top"),p("editor.valign.middle"),p("editor.valign.bottom")],i.stretchs=["fill","uniform","centerUniform"],i.stretchLabels=[p("editor.stretch.fill"),p("editor.stretch.uniform"),p("editor.stretch.centeruniform")],i.fillRules=["nonzero","evenodd"],i.fillRuleLabels=[p("editor.nonzero"),p("editor.evenodd")],i.clipDirections=["top","bottom","left","right"],i.clipDirectionLabels=[p("editor.clipdirection.top"),p("editor.clipdirection.bottom"),p("editor.clipdirection.left"),p("editor.clipdirection.right")],i.caps=["butt","round","square"],i.capLabels=[p("editor.cap.butt"),p("editor.cap.round"),p("editor.cap.square")],i.joins=["bevel","round","miter"],i.joinLabels=[p("editor.join.bevel"),p("editor.join.round"),p("editor.join.miter")],i.directions=["h","v"],i.directionLabels=[p("editor.direction.h"),p("editor.direction.v")],i.orientations=["top","right","bottom","left"],i.orientationLabels=[p("editor.orientation.top"),p("editor.orientation.right"),p("editor.orientation.bottom"),p("editor.orientation.left")],i.columnChartTypes=["columnChart","stackedColumnChart","percentageColumnChart"],i.columnChartTypeLabels=[p("editor.columncharttype.columnchart"),p("editor.columncharttype.stackedcolumnchart"),p("editor.columncharttype.percentagecolumnchart")],i.gradients=KR.config.gradients,i.shapes=[void 0,"rect","circle","oval","roundRect","star","pentagram","triangle","hexagon","pentagon","diamond","rightTriangle","parallelogram","trapezoid","polygon","arc"],i.shapeLabels=[],i.shapeIcons=[],i.shapes.forEach(function(H){H?(i.shapeLabels.push(p("editor.comptype."+H.toLowerCase())),i.shapeIcons.push({width:16,height:16,comps:[{type:H,rect:[2,4,12,8],borderWidth:1,borderColor:KR.config.color_dark}]})):(i.shapeLabels.push(""),i.shapeIcons.push({width:16,height:16,comps:[]}))}),i.selectTypes=["shadow","rect","circle","oval","roundRect"],i.selectTypeLabels=[],i.selectTypeIcons=[],i.selectTypes.forEach(function(H){"shadow"===H?(i.selectTypeLabels.push(p("editor.shadow")),i.selectTypeIcons.push({width:16,height:16,comps:[]})):(i.selectTypeLabels.push(p("editor.comptype."+H.toLowerCase())),i.selectTypeIcons.push({width:16,height:16,comps:[{type:H,rect:[2,4,12,8],borderWidth:1,borderColor:KR.config.color_dark}]}))}),i.displayConnectActionTypes=KR.config.displayConnectActionTypes,i.displayConnectActionTypeLabels=[],i.displayConnectActionTypes.forEach(function(H){var R=H?H.toLowerCase():"none";i.displayConnectActionTypeLabels.push(p("editor.connectactiontype."+R,!0)||p(H))}),i.symbolConnectActionTypes=KR.config.symbolConnectActionTypes,i.symbolConnectActionTypeLabels=[],i.symbolConnectActionTypes.forEach(function(H){var R=H?H.toLowerCase():"none";i.symbolConnectActionTypeLabels.push(p("editor.connectactiontype."+R,!0)||p(H))}),i.vLayoutValues=[void 0,"top","bottom","topbottom","center","scale"],i.vLayoutLabels=[p("editor.layout.none"),p("editor.layout.top"),p("editor.layout.bottom"),p("editor.layout.topbottom"),p("editor.layout.center"),p("editor.layout.scale")],i.hLayoutValues=[void 0,"left","right","leftright","center","scale"],i.hLayoutLabels=[p("editor.layout.none"),p("editor.layout.left"),p("editor.layout.right"),p("editor.layout.leftright"),p("editor.layout.center"),p("editor.layout.scale")],i.fullscreenValues=[void 0,"fill","uniform"],i.fullscreenLabels=[p("editor.layout.none"),p("editor.stretch.fill"),p("editor.stretch.uniform")],i.fullscreenLockValues=[!1,"h","v"],i.fullscreenLockLabels=[p("editor.layout.none"),p("editor.direction.h"),p("editor.direction.v")]}String.prototype.startsWith||(String.prototype.startsWith=function(i,H){return H=H||0,this.substr(H,i.length)===i}),String.prototype.endsWith||(String.prototype.endsWith=function(i,H){var R=this.toString();("number"!=typeof H||!isFinite(H)||Math.floor(H)!==H||H>R.length)&&(H=R.length),H-=i.length;var M=R.lastIndexOf(i,H);return-1!==M&&M===H});var LH=window.hteditor_config||{},uH=function(i,H){void 0===LH[i]&&(LH[i]=H)};uH("color_select","#45C4F9"),uH("color_select_dark","#39B0E4"),uH("color_pane","#FFFFFF"),uH("color_pane_dark","#F7F7F7"),uH("color_line","#E4E4E4"),uH("color_dark","#2C2C2C"),uH("color_light","white"),uH("color_data_border","#979797"),uH("color_data_background","#D8D8D8"),uH("color_transparent","rgba(156,156,156,0.4)"),uH("color_disabled","#8C8C8C"),uH("color_guide","red"),uH("color_hover","rgba(184,184,184,0.18)"),uH("color_mask","rgba(84,110,125,0.30)");var iR=function(){var i=navigator.userAgent;return i.indexOf("compatible")>-1&&i.indexOf("MSIE")>-1||i.indexOf("Trident")>-1&&i.indexOf("rv:11.0")>-1}();if(uH("logEditorInfo",!0),uH("host",window.location.hostname),uH("port",window.location.port),uH("locale","en"),uH("serviceClass",void 0),uH("maxUndoRedoSteps",200),uH("inspectorTitleHeight",void 0),uH("inspectorTitleBackground",void 0),uH("smallFont","10px arial, sans-serif"),uH("boldFont","bold 12px arial, sans-serif"),uH("leftSplitViewPosition",240),uH("rightSplitViewPosition",-300),uH("mainSplitViewPosition",-360),uH("explorerSplitViewPosition",.4),uH("requestDelay",100),uH("imageSize",256),uH("fileSize",50),uH("maxFileSize",200),uH("dragImageSize",50),uH("dragImageOpacity",.7),uH("animate",!0),uH("fitPadding",20),uH("fitContentForDisplayView",!0),uH("fitContentForSymbolView",!0),uH("rulerSize",16),uH("edgeLoop",!0),uH("pasteOffset",0),uH("pasteToLastSelectedIndex",!1),uH("continuousLayout",!0),uH("maxZoom",50),uH("minZoom",.01),uH("detailFilter",{}),uH("compactFilter",{}),uH("customProperties",{}),uH("displayRulerEnabled",!0),uH("displayGridEnabled",!1),uH("displayGridBlockSize",40),uH("displayGridThickLinesEvery",10),uH("displayGridThickColor","rgb(191, 191, 191)"),uH("displayGridLightColor","rgba(191, 191, 191, 0.4)"),uH("displayGridAngle",Math.PI/2),uH("displayGridRotation",0),uH("displayGridZoomThreshold",.25),uH("displayGridAlignmentGuideColor",LH.color_guide),uH("displayGridAlignmentGuideEnabled",!0),uH("displayAnchorEnabled",!0),uH("displayGuideLineEnabled",!0),uH("displayHighlightEnabled",!0),uH("displayHighlightColor",LH.color_select),uH("displayHighlightBorderWidth",1),uH("displayHighlightBorderPattern",[1,4]),uH("symbolRulerEnabled",!0),uH("symbolGridEnabled",!1),uH("symbolGridBlockSize",1),uH("symbolGridThickLinesEvery",20),uH("symbolGridThickColor","rgb(191, 191, 191)"),uH("symbolGridLightColor","rgba(191, 191, 191, 0.2)"),uH("symbolGridAngle",Math.PI/2),uH("symbolGridRotation",0),uH("symbolGridZoomThreshold",.25),uH("symbolGridAlignmentGuideColor",LH.color_guide),uH("symbolGridAlignmentGuideEnabled",!0),uH("symbolAnchorEnabled",!0),uH("symbolGuideLineEnabled",!0),uH("symbolHighlightEnabled",!0),uH("symbolHighlightColor",LH.color_select),uH("symbolHighlightBorderWidth",1),uH("symbolHighlightBorderPattern",[1,4]),uH("maxStringLength",1e6),uH("maxFileNameLength",100),uH("traceMissingI18n",!1),uH("container",void 0),uH("continuousCreating",!1),uH("valueTypes",{}),uH("indent",94),uH("indent2",68),uH("clearDataBindingsBeforeImporting",!0),uH("insertDisplayViewAsRefGraph",!1),uH("displayPreviewURL","display.html"),uH("symbolPreviewURL","symbol.html"),uH("removeFileByKeyboardEnabled",!1),uH("locateFileEnabled",!0),uH("promptBeforeClosing",!0),uH("displaysVisible",!0),uH("symbolsVisible",!0),uH("componentsVisible",!0),uH("scenesVisible",!1),uH("modelsVisible",!1),uH("uisVisible",!1),uH("assetsVisible",!0),uH("displaysEditable",!0),uH("symbolsEditable",!0),uH("componentsEditable",!0),uH("scenesEditable",!0),uH("modelsEditable",!0),uH("assetsEditable",!0),uH("settingDefaultValueBeforeSaving",!1),uH("svgSegments",20),uH("svgMinimumFontSize",12),uH("svgWaitingTime",600),uH("importConfirm",!0),uH("newIfFailToOpen",!0),uH("dataBindings",{}),uH("dataBindingsForSymbol",{}),uH("useCodeEditor",!iR),uH("codeEditorClass",void 0),uH("convertCodeEditorOption",void 0),uH("fontPreview","Hightopo"),uH("checkForFileChanges",!0),uH("checkForFileChangesInterval",3e3),uH("cloneAttr",!0),uH("cloneStyle",!0),uH("cloneName",!0),uH("cloneDisplayName",!0),uH("cloneToolTip",!0),uH("cloneTag",!0),uH("cloneIcon",!0),uH("cloneLayer",!0),uH("cloneParent",!0),uH("cloneDataBindings",!0),uH("cloneSource",!0),uH("cloneTarget",!0),uH("cloneExpanded",!0),uH("cloneClickThroughEnabled",!0),uH("cloneSyncSize",!0),uH("cloneRef",!0),uH("clonePoints",!0),uH("cloneSegments",!0),uH("cloneThickness",!0),uH("cloneClosePath",!0),uH("cloneRotation",!0),uH("clonePosition",!0),uH("cloneSize",!0),uH("cloneScale",!0),uH("cloneAnchor",!0),uH("cloneImage",!0),uH("cloneHost",!0),uH("isOpenable",null),uH("dialogTitleBackground",null),uH("componentViewSize",{width:900,height:600}),uH("eventViewSize",{width:600,height:600}),uH("fontViewSize",{width:500,height:400}),uH("functionViewSize",{width:700,height:600}),uH("objectViewSize",{width:500,height:400}),uH("textViewSize",{width:500,height:400}),uH("attachPointsViewSize",{width:700,height:500}),uH("drawAccordionTitle",null),uH("accordionMutex",!1),uH("importDataBindingsButtonVisible",!0),uH("saveSymbolCustomPropertyDefaultValue",!1),uH("saveCompCustomPropertyDefaultValue",!1),uH("deleteFileConfirm",!0),uH("mixMaskAndBackground",!0),uH("moveDummyThreshold",32),uH("smartGuideThreshold",8),uH("cadToDisplayBoundingType","Standard"),uH("cadToSymbolBoundingType","Reset"),uH("promptForMovingFile",!1),uH("displayTreeVisibleFunc",null),uH("symbolListVisibleFunc",null),uH("onElementCreated",null),uH("commonAndAdvancedFilterMode",!1),uH("edgeTypes",[void 0,"points","boundary","flex2","ortho2","h.v2","v.h2","extend.north2","extend.south2","extend.west2","extend.east2"]),uH("fileOpeners",{}),uH("paramHandlers",{}),uH("getToolTip",function(i,H){return null}),uH("createFileTreeSortFunc",function(i){var H=i.explorer.rootDir,R=H+"/ht",M=H+"/htdesign";return function(H,I){var p=H.url,h=I.url;return p===h?0:p===R?-1:h===R?1:p===M?-1:h===M?1:ht.Default.sortFunc(i.getLabel(H),i.getLabel(I))}}),uH("explorerMode","treeList"),uH("filterDisplayViewEnabled",!1),uH("filterSymbolViewEnabled",!1),uH("customAttachPointsColumns",null),uH("isCopyCompsWhenNewState",!0),uH("codeEditorTheme",null),uH("accordionListIndent",0),uH("copyFileByServer",!0),uH("isDataBound",function(i,H,R){var M=i.getDataBindings();return M&&M[H]&&M[H][R]}),uH("checkFileName",function(i,H){return!!i&&(!!(i=i.trim())&&(!/[!@?#$%^&*/]/.test(i)&&i))}),uH("handleDefaultVauleColumnEdit",null),uH("paletteColors",[["rgb(51,153,255)","#60ACFC","#32D3EB","rgb(93,217,174)","rgb(125,195,125)","rgb(255,235,195)","rgb(226,250,87)"],["#FEB64D","#FF7C7C","rgb(241,125,164)","rgb(204,104,166)","rgb(135,144,204)","rgb(145,115,205)","rgb(124,145,155)"],["rgb(48,242,120)","rgb(0,199,7)","rgb(242,83,75)","rgb(212,0,0)","rgb(240,225,19)","rgb(247,247,247)","rgb(61,61,61)"]]),uH("gradients",[null,"linear.southwest","linear.southeast","linear.northwest","linear.northeast","linear.north","linear.south","linear.west","linear.east","radial.center","radial.southwest","radial.southeast","radial.northwest","radial.northeast","radial.north","radial.south","radial.west","radial.east","spread.horizontal","spread.vertical","spread.diagonal","spread.antidiagonal","spread.north","spread.south","spread.west","spread.east"]),LH.gradientIcons||(LH.gradientIcons=[],LH.gradients.forEach(function(i){i?LH.gradientIcons.push({width:20,height:14,comps:[{type:"rect",rect:[0,0,20,14],gradient:i,gradientColor:LH.color_line,background:LH.color_dark}]}):LH.gradientIcons.push({width:20,height:14,comps:[]})})),uH("fontList",["SimSun","NSimSun","FangSong","KaiTi","FangSong_GB2312","Microsoft YaHei","cursive","monospace","serif","sans-serif","fantasy","Arial","Arial Black","Arial Narrow","Arial Rounded MT Bold","Bookman Old Style","Bradley Hand ITC","Century","Century Gothic","Comic Sans MS","Courier","Courier New","Georgia","Gentium","Impact","King","Lucida Console","Lalit","Modena","Monotype Corsiva","Papyrus","Tahoma","TeX","Times","Times New Roman","Trebuchet MS","Verdana","Verona","PingFangSC-Thin"]),uH("ignoreFontDetection",!1),uH("symbolStateEnabled",!1),uH("layerEnabled",!0),uH("layoutEnabled",!0),uH("overviewEnabled",!0),uH("dataViewEnabled",!0),uH("gridAlignmentGuideEnabled",!1),uH("lineDashPatterns",[[16,16],[32,32],[16,16,4,16]]),uH("expandedTitles",{}),["TitleBasic","TitleCustom","TitleBackground","TitleBorder","TitleText","TitleImage","TitleGroupBasic","TitleEdgeBasic","TitleArc","TitleDataBinding","TitleComponent","TitleShapeBackground","TitleShapeBorder","TitleGroupTitle","TitleEditingPoint","TitleChart"].forEach(function(i){null==LH.expandedTitles[i]&&(LH.expandedTitles[i]=!0)}),ht.Default.handleUnfoundImage=function(i,H){return ht.Default.getImage("editor.unknown")},uH("displayConnectActionType",null),uH("symbolConnectActionType",null),uH("displayConnectActionTypes",[null,"copyStyle","host","parent"]),uH("symbolConnectActionTypes",[null,"copyStyle"]),uH("appendDisplayConnectActionTypes",null),uH("appendSymbolConnectActionTypes",null),uH("appendConnectActions",null),uH("connectActions",{copyStyle:{action:function(i,H,R){if(R){var I=R.getStyleMap();for(var p in I)"shape"!==p&&"label"!==p&&"label2"!==p&&"note"!==p&&"note2"!==p&&"text"!==p&&H.s(p,M(I[p]))}},extraInfo:{visible:function(i){return!0}}},host:{action:function(i,H,R){H instanceof ht.Node&&R instanceof ht.Node&&!H.s("fullscreen")&&H.setHost(R)},extraInfo:{delete:{visible:function(i){return i.sm().ld()instanceof ht.Node&&i.sm().ld().getHost()},action:function(i,H){H instanceof ht.Node&&H.setHost(void 0)}},visible:function(i){return i.sm().ld()instanceof ht.Node}}},parent:{action:function(i,H,R){R&&H.setParent(R)},extraInfo:{delete:{visible:function(i){return i.sm().ld().getParent()},action:function(i,H){H.setParent(void 0)}},visible:function(i){return!0}}}}),LH.appendDisplayConnectActionTypes&&LH.appendDisplayConnectActionTypes.forEach(function(i){LH.displayConnectActionTypes.push(i)}),LH.appendSymbolConnectActionTypes&&LH.appendSymbolConnectActionTypes.forEach(function(i){LH.symbolConnectActionTypes.push(i)}),LH.appendConnectActions)for(var HR in LH.appendConnectActions)LH.connectActions[HR]=LH.appendConnectActions[HR];for(var RR in LH.connectActions){var MR=LH.connectActions[RR];ht.Default.setConnectAction(RR,MR.action,MR.extraInfo)}var IR=ht.Default.getToolTipDiv();IR.style.color=LH.color_dark,IR.style.background=LH.color_pane,ht.widget.ColorPicker.prototype._paletteColors=LH.paletteColors,ht.graph.GraphView.prototype._scrollBarColor=LH.color_transparent,ht.graph.GraphView.prototype._rectSelectBackground=LH.color_transparent,ht.graph.GraphView.prototype._rectSelectBorderColor=LH.color_select,ht.graph.GraphView.prototype.isLabelVisible=function(){return!0},ht.widget.ListView.prototype._scrollBarColor=LH.color_transparent,ht.widget.TreeView.prototype._scrollBarColor=LH.color_transparent,ht.widget.TableView.prototype._scrollBarColor=LH.color_transparent,ht.widget.TreeTableView.prototype._scrollBarColor=LH.color_transparent,ht.widget.PropertyView.prototype._scrollBarColor=LH.color_transparent,ht.widget.FormPane.prototype._scrollBarColor=LH.color_transparent,ht.widget.SplitView.prototype._dividerBackground=LH.color_line,ht.widget.SplitView.prototype._continuousLayout=LH.continuousLayout,ht.widget.ListView.prototype._selectBackground=LH.color_select,ht.widget.TreeView.prototype._selectBackground=LH.color_select,ht.widget.TableView.prototype._selectBackground=LH.color_select,ht.widget.TreeTableView.prototype._selectBackground=LH.color_select,ht.widget.TableHeader.prototype._columnLineColor=LH.color_line,ht.widget.TableHeader.prototype._insertColor=LH.color_select_dark,ht.widget.TableView.prototype._columnLineColor=LH.color_line,ht.widget.Toolbar.prototype._separatorColor=LH.color_line,ht.widget.Toolbar.prototype._itemGap=4,ht.widget.Button.prototype._labelColor=LH.color_light,ht.widget.Button.prototype._borderColor=null,ht.widget.Button.prototype._background=LH.color_select,ht.widget.Button.prototype._selectBackground=LH.color_select_dark,ht.widget.CheckBox.prototype._pressBackground=LH.color_pane_dark,ht.widget.ComboBox.prototype._selectBackground=LH.color_select,ht.widget.TabView.prototype._insertColor=LH.color_select_dark,ht.widget.TabView.prototype._selectWidth=0,ht.widget.TabView.prototype._selectBackground=LH.color_select,ht.widget.TabView.prototype._tabBackground=LH.color_dark,ht.widget.TabView.prototype.getTabBackground=function(i){return i==this.getCurrentTab()?LH.color_select:LH.color_dark},ht.widget.FormPane.prototype._hPadding=4,ht.widget.FormPane.prototype._vPadding=4,ht.widget.FormPane.prototype._hGap=4,ht.widget.FormPane.prototype._vGap=4,ht.widget.Slider.prototype._background=LH.color_dark,ht.widget.Slider.prototype._leftBackground=LH.color_select,ht.widget.Slider.prototype._button={width:14,height:14,comps:[{type:"circle",rect:[0,0,14,14],borderWidth:1,borderColor:LH.color_dark,background:LH.color_pane_dark}]},ht.widget.ComboBox.prototype._dropDownIcon=ht.widget.MultiComboBox.prototype._dropDownIcon={width:16,height:16,comps:[{type:"shape",points:[13,6,8,12,3,6],segments:[1,2,2],borderWidth:1,borderColor:LH.color_dark}]},ht.Default.comboBoxBorderColor=LH.color_line,ht.Default.textFieldBorderColor=LH.color_line,ht.Default.contextMenuHoverBackground=LH.color_select,ht.Default.contextMenuSeparatorColor=LH.color_line,ht.Default.dialogTitleBackground=LH.dialogTitleBackground||LH.color_dark,ht.Default.dialogButtonBackground=LH.color_select,ht.Default.dialogButtonSelectBackground=LH.color_select_dark,ht.Default.dialogHeaderBackground=LH.color_pane_dark,ht.Default.toolbarBackground=LH.color_pane_dark,ht.Default.tableHeaderBackground=LH.color_pane_dark,ht.Default.contextMenuLabelFont=ht.Default.labelFont,ht.Default.contextMenuBorderRadius=0,ht.Default.contextMenuBorderColor=LH.color_line,ht.Default.contextMenuSubmenuMark=">&nbsp;",ht.Default.contextMenuCheckIcon={width:16,height:16,comps:[{type:"shape",points:[13,3,7,12,4,8],borderWidth:1,borderColor:LH.color_dark}]},ht.Default.setImage("radioOn",{width:16,height:16,comps:[{type:"circle",rect:[2,2,12,12],borderWidth:1,borderColor:ht.Color.widgetIconBorder,background:"#FFF"},{type:"circle",rect:[4,4,8,8],background:LH.color_select}]}),ht.Default.setImage("expandIcon",{width:16,height:16,comps:[{type:"shape",points:[13,6,8,12,3,6],segments:[1,2,2],borderWidth:1,borderColor:LH.color_dark}]}),ht.Default.setImage("collapseIcon",{width:16,height:16,comps:[{type:"shape",points:[6,3,12,8,6,13],segments:[1,2,2],borderWidth:1,borderColor:LH.color_dark}]}),ht.widget.TreeView.prototype._expandIcon="expandIcon",ht.widget.TreeView.prototype._collapseIcon="collapseIcon",ht.widget.TreeTableView.prototype._expandIcon="expandIcon",ht.widget.TreeTableView.prototype._collapseIcon="collapseIcon";var pR=ht.widget.TextArea.prototype.setEditable;ht.widget.TextField.prototype.setEditable=ht.widget.TextArea.prototype.setEditable=function(i){pR.call(this,i);var H=this._element;H.style.color=i?ht.Default.labelColor:LH.color_disabled},ht.Default.onElementCreated=function(i){("INPUT"===i.tagName&&"button"!==i.type||"TEXTAREA"===i.tagName)&&(i.style.border=LH.color_line+" solid 1px",i.style.outline=0,i.style.padding="2px","TEXTAREA"===i.tagName&&(i.style.whiteSpace="pre",i.setAttribute("spellcheck","false")),i.addEventListener("focus",function(H){i.oldBorder=i.style.border,i.style.border=LH.color_select+" solid 1px","INPUT"===i.tagName&&requestAnimationFrame(function(){i.select()}),"TEXTAREA"===i.tagName&&(i.style.zIndex="1")},!1),i.addEventListener("blur",function(H){i.style.border=i.oldBorder,"TEXTAREA"===i.tagName&&(i.style.zIndex="")},!1),LH.onElementCreated&&LH.onElementCreated(i))},ht.Default.onWidgetColorPickerCreated=function(H){for(var R=LH.color_line+" solid 1px",M=H.getView(),I=M.querySelectorAll(".colorPalette"),p=0;p<I.length;p++)I[p].style.border=R;M.querySelector(".satval").style.border=R,M.querySelector(".hue_image").style.border=R,M.querySelector(".preview").style.border=R,I=M.querySelectorAll('input[type="button"]');for(var h=0;h<I.length;h++){var z=I[h];z.style.border=R,z.style.background="none",z.style.outline="none",z.style.width="30px",z.addEventListener("mouseover",function(i){i.target.style.background=LH.color_hover},!1),z.addEventListener("mouseout",function(i){i.target.style.background="none"},!1)}I=M.querySelectorAll("span");for(var d=0;d<I.length;d++)i(H,M,I[d])},ht.Default.handleUnfoundImage=function(i,H){return ht.Default.getImage("editor.unknown")},LH.configStudio&&LH.configStudio();var hR=(function(){function i(i){this.value=i}function H(H){function R(i,H){return new Promise(function(R,I){var z={key:i,arg:H,resolve:R,reject:I,next:null};h?h=h.next=z:(p=h=z,M(i,H))})}function M(R,p){try{var h=H[R](p),z=h.value;z instanceof i?Promise.resolve(z.value).then(function(i){M("next",i)},function(i){M("throw",i)}):I(h.done?"return":"normal",h.value)}catch(i){I("throw",i)}}function I(i,H){switch(i){case"return":p.resolve({value:H,done:!0});break;case"throw":p.reject(H);break;default:p.resolve({value:H,done:!1})}p=p.next,p?M(p.key,p.arg):h=null}var p,h;this._invoke=R,"function"!=typeof H.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(H.prototype[Symbol.asyncIterator]=function(){return this}),H.prototype.next=function(i){return this._invoke("next",i)},H.prototype.throw=function(i){return this._invoke("throw",i)},H.prototype.return=function(i){return this._invoke("return",i)}}(),function(i,H){if(!(i instanceof H))throw new TypeError("Cannot call a class as a function")}),zR=function(){function i(i,H){for(var R=0;R<H.length;R++){var M=H[R];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(i,M.key,M)}}return function(H,R,M){return R&&i(H.prototype,R),M&&i(H,M),H}}(),dR=function(i,H){if("function"!=typeof H&&null!==H)throw new TypeError("Super expression must either be null or a function, not "+typeof H);i.prototype=Object.create(H&&H.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),H&&(Object.setPrototypeOf?Object.setPrototypeOf(i,H):i.__proto__=H)},CR=function(i,H){if(!i)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!H||"object"!=typeof H&&"function"!=typeof H?i:H},yR=function(i){function H(R){hR(this,H);var M=CR(this,i.call(this,R));return M.callback=void 0,M}return dR(H,i),H.prototype.onShown=function(){GR.indexOf(this)>=0||GR.push(this)},H.prototype.onHidden=function(){C(GR,this)},H.prototype.hide=function(){i.prototype.hide.call(this),this.callback&&this.callback()},H}(ht.widget.Dialog),bR=function(i){function H(R){hR(this,H);var M=CR(this,i.call(this,R));return M.getView().style.background=KR.config.color_pane,M}return dR(H,i),H.prototype.addLine=function(){this.addRow([],[.1],1.01,{background:KR.config.color_line})},H.prototype.addTitle=function(i){var H=[{element:i,font:KR.config.boldFont}],R={background:KR.config.color_pane_dark};this.addRow(H,[.1],null,R)},H.prototype.getRowIndex=function(i){return this.getRows().indexOf(i)},H}(ht.widget.FormPane),UR=function(){function i(H){if(hR(this,i),this.config=H,this._editable=!0,KR.config.useCodeEditor){(this._view=document.createElement("div")).style.position="absolute"}else this._monacoEditor=new ht.widget.TextArea,this._view=this._monacoEditor.getView(),H&&H.value&&this._monacoEditor.setValue(H.value)}return i.prototype.getView=function(){return this._view},i.prototype.setValue=function(i){void 0!==i&&null!==i||(i=""),this.monacoEditor&&this.monacoEditor.setValue(i)},i.prototype.getValue=function(){return this.monacoEditor&&this.monacoEditor.getValue()},i.prototype.layout=function(){this.monacoEditor&&(this.monacoEditor.layout(),this.isEditable()||this._monacoEditor instanceof ht.widget.TextArea||this.getView().appendChild(this._editableLayer))},i.prototype.invalidate=function(){this.layoutLater()},i.prototype.iv=function(){this.invalidate()},i.prototype.layoutLater=function(i){var H=this;setTimeout(function(){H.layout()},i||300)},i.prototype.setEditable=function(i){var H=this;if(this._monacoEditor instanceof ht.widget.TextArea)return void this._monacoEditor.setEditable(i);if(this._editable!==i){this._timer&&(clearTimeout(this._timer),delete this._timer);var R=this._editableLayer;i?R.parentNode&&R.parentNode.removeChild(R):this._timer=setTimeout(function(){delete H._timer,H.getView().appendChild(R)},10),this._editable=i,this._monacoEditor&&this._monacoEditor.updateOptions({readOnly:!i})}},i.prototype.isEditable=function(){return this._monacoEditor instanceof ht.widget.TextArea?this._monacoEditor.isEditable():this._editable},zR(i,[{key:"monacoEditor",get:function(){if(!this._monacoEditor&&window.monaco){var i=KR.config.convertCodeEditorOption,H=this.config||{value:"",language:"javascript",theme:KR.config.codeEditorTheme,readOnly:!this._editable,minimap:{enabled:!1}};i&&i(H),this._monacoEditor=monaco.editor.create(this._view,H)}return this._monacoEditor}},{key:"_editableLayer",get:function(){if(this.__editableLayer)return this.__editableLayer;var i=this.__editableLayer=document.createElement("div"),H=i.style;return H.backgroundColor=ht.Default.disabledBackground||"rgba( 255, 255, 255, 0.3)",H.position="absolute",H.cursor="not-allow",H.top=0,H.right=0,H.bottom=0,H.left=0,H.pointerEvents="none",i}}]),i}(),KR={strings:{},customStrings:{},config:LH},qR=["onClick","onDoubleClick","onContextMenu","onDown","onUp","onMove","onEnter","onHover","onLeave","onBeginDrag","onDrag","onEndDrag","onScroll"],QR="unknow",mR="root",XR="dir",oR="asset",JR="symbol",OR="display",cR="component",tR="model",TR="scene",NR="ui",DR="__ht__dataModel",fR=/^attr@/,nR=/firefox/.test(window.navigator.userAgent.toLowerCase()),GR=[],kR={width:16,height:16,comps:[]},PR={display:{},symbol:{},data:{},comp:{},scene:{},data3d:{}},ZR=new ht.List([{x:50,y:75},{x:25,y:75},{x:25,y:25},{x:75,y:25},{x:75,y:75},{x:65,y:60},{x:75,y:75},{x:85,y:60}]),vR=new ht.List([1,2,2,2,2,2,1,2]);ht.Default.setImage("check",{width:16,height:16,comps:[{type:"border",rect:[1,1,14,14],width:1,color:KR.config.color_line},{type:"shape",points:[13,3,7,12,4,8],borderWidth:2,borderColor:{func:function(i,H){if(i&&H&&H.getRowSize&&H.isSelected){var R=H.isSelected(i);if(H.isCheckMode&&H.getFocusData){var M=H.isCheckMode();R=R&&!M||i===H.getFocusData()&&M}if(R)return KR.config.color_line}return KR.config.color_select}}}]}),ht.Default.setImage("uncheck",{width:16,height:16,comps:[{type:"border",rect:[1,1,14,14],width:1,color:KR.config.color_line}]}),ht.Default.setImage("text_icon",{width:16,height:16,comps:[{type:"shape",points:[3,14,8,2,13,14,5,9,11,9],segments:[1,2,2,1,2],borderColor:KR.config.color_dark,borderWidth:1}]}),ht.Default.setImage("refGraph_icon",{width:16,height:16,comps:[{type:"shape",borderWidth:1,borderColor:KR.config.color_dark,rotation:.7854,points:[12.90381,7.59615,12.90381,7.59615,12.90381,4.61619,12.90381,3.59619,12.90381,2.57619,11.72047,1.59619,10.40381,1.59619,9.08714,1.59619,7.90381,2.61619,7.90381,3.59619,7.90381,4.35799,7.90381,7.59615,7.90381,7.59615,7.90381,7.59615,7.90381,9.59619,10.40381,9.59619],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:KR.config.color_dark,rotation:-2.35619,points:[8.21091,12.28904,8.21091,12.28904,8.21091,9.30909,8.21091,8.28909,8.21091,7.26909,7.02758,6.28909,5.71091,6.28909,4.39425,6.28909,3.21091,7.30909,3.21091,8.28909,3.21091,9.05088,3.21091,12.28904,3.21091,12.28904,3.21091,12.28904,3.21091,14.28909,5.71091,14.28909],segments:[1,4,4,4,4,4]}]}),ht.Default.setImage("editor.unknown",{width:200,height:200,textureCache:!0,comps:[{type:"roundRect",background:"rgb(247,247,247)",borderColor:"#979797",cornerRadius:20,selectable:!1,rect:[0,0,200,200]},{type:"shape",background:"rgba(255,170,79,0.63)",borderColor:"rgb(124,145,155)",points:[35.92101,125.8927,70.22338,97.87611,96.05685,117.16025,108.79166,106.08902,115.70485,111.45559,92.40971,145.02116,35.92101,145.02116,35.92101,130.19911]},{type:"shape",background:"rgba(255,170,79,0.63)",borderColor:"rgb(124,145,155)",points:[143.94195,74.95345,121.52647,95.32915,136.08054,112.06633,115.341,146.63224,166.86461,146.63224,166.86461,103.69774]},{type:"shape",borderWidth:4,
borderColor:"rgb(124,145,155)",displayName:"\u4e0d\u89c4\u5219\u56fe\u5f62",closePath:!0,points:[86.52393,81.40417,110.5868,43.51795,35.32634,43.51795,35.32634,146.93709,93.17962,146.93709,117.24248,111.09877,86.52393,81.40417]},{type:"shape",borderWidth:4,borderColor:"rgb(124,145,155)",closePath:!0,points:[105.77896,81.40417,129.84183,43.51795,168.08039,43.51795,168.08039,146.93709,112.43465,146.93709,136.49752,111.09877,105.77896,81.40417]},{type:"shape",borderWidth:4,borderColor:"rgb(124,145,155)",points:[35.92101,126.00861,70.52846,96.60621,95.13328,116.95012,108.45973,104.311]},{type:"shape",borderWidth:4,borderColor:"rgb(124,145,155)",points:[122.25418,94.2376,144.08528,74.22575,168.32002,106.08902]},{type:"oval",background:"#FF7C7C",borderWidth:4,borderColor:"rgb(124,145,155)",rect:[56.57448,66.67972,14,14]}]}),ht.Default.setImage("editor.root",{width:30,height:30,fitSize:!0,comps:[{type:"shape",points:[23,8,8,23],segments:[1,2],borderWidth:1,borderColor:"white"}]}),ht.Default.setImage("editor.display",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"circle",borderWidth:1,borderColor:KR.config.color_light,rect:[6,1,4,4.00837]},{type:"circle",borderWidth:1,borderColor:KR.config.color_light,rect:[11,10.99163,4,4.00837]},{type:"shape",borderWidth:1,borderColor:KR.config.color_light,points:[2.98235,11.0795,2.98235,8,7.89475,8,7.89475,5.00837,7.89475,8,13,8,13,11]},{type:"circle",borderWidth:1,borderColor:KR.config.color_light,rect:[1,10.99163,4,4.00837]}]}),ht.Default.setImage("editor.symbol",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"circle",borderWidth:1,borderColor:KR.config.color_light,rect:[0,2,10,8]},{type:"rect",borderWidth:1,borderColor:KR.config.color_light,rect:[5,6,10,8]}]}),ht.Default.setImage("editor.filter",{background:"rgb(130,130,130)",width:16,height:16,comps:[{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",closePath:!0,points:[2,1.5,14,1.5,9.50949,5.5,9.50949,9.5,13,9.5,9.50949,9.5,9.50949,11.5,12,11.5,9.50949,11.5,9.50949,14.5,6.5335,12.5,6.5335,5.5,2,1.5]}]}),ht.Default.setImage("editor.bind",{width:16,height:16,comps:[{type:"shape",borderWidth:1,borderColor:"white",borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:"white",borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}]}),ht.Default.setImage("editor.unbind",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",rotation:.7854,points:[13.49999,7.03553,13.49999,7.03553,13.49999,5.05554,13.49999,4.03553,13.49999,3.01553,12.31666,2.03553,10.99999,2.03553,9.68333,2.03553,8.49999,3.05553,8.49999,4.03553,8.49999,5.01553,8.49999,7.03553,8.49999,7.03553],segments:[1,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",rotation:3.92699,points:[7.28554,13.25761,7.28554,13.25761,7.28554,11.27761,7.28554,10.2576,7.28554,9.23761,6.1022,8.25761,4.78554,8.25761,3.46887,8.25761,2.28554,9.2776,2.28554,10.2576,2.28554,11.2376,2.28554,13.25761,2.28554,13.25761],segments:[1,4,4,4,4]}]}),ht.Default.setImage("editor.dircollapsed",{background:"rgb(179,179,179)",width:16,height:16,comps:[{type:"shape",background:"rgb(255,204,153)",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[14.5,14.5,.5,14.5,.5,1.50001,6.5,1.50001,7.5,3.50001,14.5,3.50001,14.5,14.5]},{type:"shape",background:"rgb(255,227,199)",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[.5,5.50001,14.5,5.50001,14.5,14.50001,.5,14.50001,.5,5.50001]}]}),ht.Default.setImage("editor.direxpanded",{background:"rgb(179,179,179)",width:16,height:16,comps:[{type:"shape",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(51,153,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[2.35891,10.47175,3.3125,6.30284,15.5,6.30284,13.625,14.5,.5,14.5,.5,1.5,6.125,1.5,7.0625,3.2289,12.6875,3.2289,12.6875,6.30284]}]}),ht.Default.setImage("editor.dir",{background:"rgb(227,227,227)",width:20,height:20,fitSize:!0,cacheRule:!0,comps:[{type:"shape",background:"#FFCC99",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",points:[19,4,19,18,1,18,1,2,8.71429,2,10,4,19,4]},{type:"rect",shadow:!0,shadowColor:"rgba(0,0,0,0.4)",shadowBlur:2,shadowOffsetX:0,shadowOffsetY:1,background:"rgb(255,255,255)",borderColor:"#979797",rotation:6.28319,rect:[2.98273,5.998,13.98346,9.99004]},{type:"shape",background:"rgba(255,255,153,0.3)",borderColor:"rgb(255,255,255)",borderCap:"round",points:[18,9,18,17,2,17,2,9,18,9]},{type:"rect",shadowColor:"rgb(0,0,0)",shadowBlur:2,shadowOffsetX:0,shadowOffsetY:1,background:"rgb(232,230,230)",borderColor:"#979797",rotation:6.28319,rect:[4,7,11.98532,1.06039]}]}),ht.Default.setImage("editor.dxf",{width:64,height:64,fitSize:!0,comps:[{type:"shape",shadowColor:"#1ABC9C",background:"#000000",points:[25.13334,60.62742,20.38001,60.62742,20.11302,60.62742,19.89504,60.41688,19.89504,60.15453,19.89504,43.31796,19.89504,43.05561,20.11302,42.84507,20.38001,42.84507,25.13334,42.84507,30.66329,42.84507,33.35167,45.67873,33.35167,51.50916,33.35167,57.47593,30.51009,60.62742,25.13334,60.62742,25.13334,60.62742,23.32783,57.5939,25.03463,57.5939,28.43349,57.5939,29.82018,55.90554,29.82018,51.77117,29.82018,47.64415,28.35946,45.88193,24.93627,45.88193,23.32783,45.88193,23.32783,57.5939,23.32783,57.5939],segments:[1,2,4,2,4,2,4,4,2,1,2,4,4,2,2,2]},{type:"shape",shadowColor:"#1ABC9C",background:"#000000",points:[48.10416,60.62742,45.1488,60.62742,44.97846,60.62742,44.82286,60.54254,44.73581,60.40217,40.95446,54.3465,37.26771,60.39482,37.1786,60.53886,37.01957,60.62776,36.84889,60.62776,34.01657,60.62776,33.84041,60.62776,33.67761,60.53552,33.59227,60.38379,33.50693,60.2324,33.51275,60.04759,33.60735,59.89987,39.05608,51.53522,33.90312,43.56961,33.80853,43.42557,33.8027,43.24076,33.88804,43.08937,33.97338,42.93797,34.13618,42.8454,34.31235,42.8454,37.31706,42.8454,37.4874,42.8454,37.64677,42.93396,37.73382,43.078,41.14399,48.68284,44.48219,43.08168,44.56924,42.93396,44.72861,42.84507,44.90272,42.84507,47.73299,42.84507,47.91121,42.84507,48.074,42.93731,48.15729,43.08903,48.24434,43.24042,48.2368,43.42524,48.14221,43.56928,43.03826,51.48342,48.51339,59.89987,48.60798,60.04759,48.61552,60.2324,48.52847,60.38379,48.44518,60.53485,48.28238,60.62742,48.10416,60.62742,48.10416,60.62742],segments:[1,2,4,2,2,4,2,4,4,2,2,4,4,2,4,2,2,4,2,4,4,2,2,4,4,2]},{type:"shape",shadowColor:"#1ABC9C",background:"#000000",points:[53.17006,60.62742,50.68081,60.62742,50.41177,60.62742,50.19585,60.41688,50.19585,60.15453,50.19585,43.31796,50.19585,43.05561,50.41177,42.84507,50.68081,42.84507,60.09288,42.84507,60.36192,42.84507,60.57784,43.05561,60.57784,43.31796,60.57784,45.40904,60.57784,45.67138,60.36192,45.88193,60.09288,45.88193,53.65537,45.88193,53.65537,50.62587,59.22886,50.62587,59.4979,50.62587,59.71382,50.83642,59.71382,51.09876,59.71382,53.18984,59.71382,53.45219,59.4979,53.66273,59.22886,53.66273,53.65537,53.66273,53.65537,60.1542,53.65537,60.41688,53.43911,60.62742,53.17006,60.62742,53.17006,60.62742],segments:[1,2,4,2,4,2,4,2,4,2,2,2,4,2,4,2,2,4,2]},{type:"shape",shadowColor:"#1ABC9C",background:"#000000",points:[56.21111,19.11398,40.59837,2.34525,40.23096,1.94622,39.70418,1.92216,39.15478,1.92216,8.11505,1.92216,7.04265,1.92216,6.07649,2.35795,6.07649,3.40366,6.07649,60.1542,6.07649,61.1999,7.04299,62.07784,8.11505,62.07784,13.93496,62.07784,15.00736,62.07784,15.87481,61.28546,15.87481,60.23975,15.87481,59.19405,15.00702,58.40166,13.93496,58.40166,9.84618,58.40166,9.84618,5.59867,35.20824,5.59867,35.20824,21.86677,35.20824,22.91248,36.27174,23.64538,37.3438,23.64538,52.6875,23.64538,52.6875,35.56255,52.6875,36.60826,53.67148,37.45412,54.74388,37.45412,55.81629,37.45412,56.80027,36.60793,56.80027,35.56255,56.80027,20.28301,56.80027,19.81747,56.52917,19.46155,56.21111,19.11398,56.21111,19.11398,39.32101,6.67546,51.68947,19.9692,39.32101,19.9692,39.32101,6.67546,39.32101,6.67546],segments:[1,2,4,2,4,2,4,2,4,4,2,2,2,2,4,2,2,4,4,2,4,2,1,2,2,2,2]}]}),ht.Default.setImage("editor.obj",{width:64,height:64,fitSize:!0,attachStyle:"close",comps:[{type:"shape",background:"rgb(0,0,0)",points:[56.21111,19.11398,40.59837,2.34525,40.23096,1.94622,39.70418,1.92216,39.15478,1.92216,8.11505,1.92216,7.04265,1.92216,6.07649,2.35795,6.07649,3.40366,6.07649,60.1542,6.07649,61.1999,7.04299,62.07784,8.11505,62.07784,13.93496,62.07784,15.00736,62.07784,15.87481,61.28546,15.87481,60.23975,15.87481,59.19405,15.00702,58.40166,13.93496,58.40166,9.84618,58.40166,9.84618,5.59867,35.20824,5.59867,35.20824,21.86677,35.20824,22.91248,36.27174,23.64538,37.3438,23.64538,52.6875,23.64538,52.6875,35.56255,52.6875,36.60826,53.67148,37.45412,54.74388,37.45412,55.81629,37.45412,56.80027,36.60793,56.80027,35.56255,56.80027,20.28301,56.80027,19.81747,56.52917,19.46155,56.21111,19.11398,56.21111,19.11398,39.32101,6.67546,51.68947,19.9692,39.32101,19.9692,39.32101,6.67546,39.32101,6.67546],segments:[1,2,4,2,4,2,4,2,4,4,2,2,2,2,4,2,2,4,4,2,4,2,1,2,2,2,2]},{type:"shape",background:"#000000",borderWidth:.5,borderColor:"rgb(0,0,0)",pixelPerfect:!0,points:[31.21904,47.49025,32.38182,48.81914,33.04627,50.64637,33.04627,52.80583,33.04627,54.96528,32.38182,56.79251,31.21904,58.12141,29.89014,59.4503,28.22903,60.28086,26.06957,60.28086,23.91012,60.28086,22.249,59.61642,20.9201,58.12141,19.75732,56.79251,19.09287,54.96528,19.09287,52.80583,19.09287,50.64637,19.59121,48.81914,20.9201,47.49025,22.08289,45.99524,23.91012,45.33079,26.06957,45.33079,28.22903,45.33079,30.05626,45.99524,31.21904,47.49025,22.58122,48.81914,21.75066,49.81582,21.41844,51.14471,21.41844,52.80583,21.41844,54.46695,21.75066,55.79584,22.58122,56.79251,23.41178,57.78919,24.57456,58.28752,26.06957,58.28752,27.56458,58.28752,28.72736,57.78919,29.55792,56.79251,30.38848,55.79584,30.7207,54.46695,30.7207,52.80583,30.7207,51.14471,30.22237,49.81582,29.55792,48.81914,28.72736,47.82247,27.56458,47.32414,26.06957,47.32414,24.57456,47.32414,23.41178,47.82247,22.58122,48.81914],segments:[1,4,4,4,4,4,4,4,4,5,1,4,4,4,4,4,4,4,4,5]},{type:"shape",background:"#000000",borderWidth:.5,borderColor:"rgb(0,0,0)",pixelPerfect:!0,points:[41.68409,45.66302,43.01298,45.66302,44.17577,45.99524,45.00633,46.65969,45.83689,47.32414,46.16911,48.1547,46.16911,49.31748,46.16911,50.14804,46.003,50.81249,45.50466,51.31082,45.17244,51.80916,44.50799,52.30749,43.84354,52.47361,44.84021,52.63972,45.50466,52.97194,46.003,53.63639,46.50133,54.13472,46.66745,54.96528,46.66745,55.96195,46.66745,57.45696,46.16911,58.45363,45.17244,59.11808,44.34188,59.61642,43.1791,59.94864,41.68409,59.94864,35.20573,59.94864,35.20573,45.66302,41.68409,45.66302,37.36518,51.64305,41.18575,51.64305,42.18242,51.64305,42.84687,51.47693,43.34521,51.14471,43.84354,50.81249,44.00966,50.14804,44.00966,49.48359,44.00966,48.81914,43.84354,48.32081,43.34521,47.98858,42.84687,47.65636,42.18242,47.49025,41.18575,47.49025,37.36518,47.49025,37.36518,51.64305,37.36518,58.12141,41.35186,58.12141,42.34854,58.12141,43.01298,57.9553,43.51132,57.62307,44.17577,57.29085,44.50799,56.6264,44.50799,55.79584,44.50799,54.96528,44.17577,54.30084,43.67743,53.96861,43.1791,53.63639,42.34854,53.47028,41.35186,53.47028,37.19907,53.47028,37.19907,58.12141],segments:[1,4,4,4,4,4,4,4,4,2,2,2,5,1,2,4,4,4,4,2,2,5,1,2,4,4,4,4,2,2,5]},{type:"shape",background:"#000000",borderWidth:.5,borderColor:"rgb(0,0,0)",pixelPerfect:!0,points:[56.80027,45.66302,56.80027,55.29751,56.80027,56.95863,56.46805,58.12141,55.8036,58.95197,54.97304,59.78253,53.81026,60.28086,52.14914,60.28086,50.65413,60.28086,49.65746,59.94864,48.99301,59.11808,48.16245,58.28752,47.83023,57.29085,47.83023,55.79584,47.83023,55.29751,49.98968,55.29751,49.98968,55.79584,49.98968,57.45696,50.65413,58.28752,52.14914,58.28752,52.9797,58.28752,53.64414,57.9553,53.97637,57.62307,54.30859,57.12474,54.4747,56.46029,54.4747,55.29751,54.4747,45.66302,56.80027,45.66302],segments:[1,2,4,4,4,4,2,2,2,4,4,4,2,2,5]}]}),ht.Default.setImage("editor.mtl",{width:64,height:64,fitSize:!0,attachStyle:"close",comps:[{type:"shape",background:"rgb(0,0,0)",points:[56.21111,19.11398,40.59837,2.34525,40.23096,1.94622,39.70418,1.92216,39.15478,1.92216,8.11505,1.92216,7.04265,1.92216,6.07649,2.35795,6.07649,3.40366,6.07649,60.1542,6.07649,61.1999,7.04299,62.07784,8.11505,62.07784,13.93496,62.07784,15.00736,62.07784,15.87481,61.28546,15.87481,60.23975,15.87481,59.19405,15.00702,58.40166,13.93496,58.40166,9.84618,58.40166,9.84618,5.59867,35.20824,5.59867,35.20824,21.86677,35.20824,22.91248,36.27174,23.64538,37.3438,23.64538,52.6875,23.64538,52.6875,35.56255,52.6875,36.60826,53.67148,37.45412,54.74388,37.45412,55.81629,37.45412,56.80027,36.60793,56.80027,35.56255,56.80027,20.28301,56.80027,19.81747,56.52917,19.46155,56.21111,19.11398,56.21111,19.11398,39.32101,6.67546,51.68947,19.9692,39.32101,19.9692,39.32101,6.67546,39.32101,6.67546],segments:[1,2,4,2,4,2,4,2,4,4,2,2,2,2,4,2,2,4,4,2,4,2,1,2,2,2,2]},{type:"shape",background:"#000000",borderWidth:.5,borderColor:"rgb(0,0,0)",pixelPerfect:!0,points:[21.55794,45.99697,26.66087,57.7337,26.66087,57.7337,31.7638,45.99697,34.31526,45.99697,34.31526,60.62536,32.10399,60.62536,32.10399,50.24941,32.10399,50.24941,27.68146,60.62536,25.81038,60.62536,21.38785,50.24941,21.38785,50.24941,21.38785,60.62536,19.00648,60.62536,19.00648,45.99697,21.55794,45.99697],segments:[1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,5]},{type:"shape",background:"#000000",borderWidth:.5,borderColor:"rgb(0,0,0)",pixelPerfect:!0,points:[48.09317,45.99697,48.09317,47.86804,43.16034,47.86804,43.16034,60.45527,40.94907,60.45527,40.94907,47.86804,36.01624,47.86804,36.01624,45.99697,48.09317,45.99697],segments:[1,2,2,2,2,2,2,2,2,5]},{type:"shape",background:"#000000",borderWidth:.5,borderColor:"rgb(0,0,0)",pixelPerfect:!0,points:[52.00541,45.99697,52.00541,58.58419,60,58.58419,60,60.45527,49.79414,60.45527,49.79414,45.82687,52.00541,45.82687],segments:[1,2,2,2,2,2,2,5]}]}),ht.Default.setImage("editor.ui",{modified:"Thu Jun 04 2020 09:40:36 GMT+0800 (China Standard Time)",width:16,height:16,fitSize:!0,attachStyle:"close",comps:[{type:"shape",background:"rgb(0,0,0)",points:[14.84148,4.57262,10.64058,.11253,10.54173,.0064,10.39999,0,10.25216,0,1.90035,0,1.61181,0,1.35184,.11591,1.35184,.39404,1.35184,15.48836,1.35184,15.76649,1.6119,16,1.90035,16,6.28421,16,6.57276,16,7.02587,15.76649,7.02587,15.48836,7.02587,15.21023,6.57267,15.02222,6.28421,15.02222,2.36615,15.02222,2.36615,.97787,9.19027,.97787,9.19027,5.3048,9.19027,5.58293,9.47642,5.77787,9.76488,5.77787,13.89338,5.77787,13.89338,8.94755,13.89338,9.22569,14.15814,9.45067,14.44669,9.45067,14.73524,9.45067,15,9.2256,15,8.94755,15,4.88356,15,4.75973,14.92706,4.66507,14.84148,4.57262,14.84148,4.57262,10.29689,1.26427,13.62485,4.80009,10.29689,4.80009,10.29689,1.26427,10.29689,1.26427],segments:[1,2,4,2,4,2,4,2,4,4,2,2,2,2,4,2,2,4,4,2,4,2,1,2,2,2,2]},{type:"shape",background:"#000000",borderWidth:.2,borderColor:"rgb(0,0,0)",pixelPerfect:!0,points:[10.74059,12.112,10.74059,14.67455,10.74059,15.11636,10.6512,15.42564,10.47242,15.64655,10.24894,15.86746,9.93607,16,9.48912,16,9.08686,16,8.81868,15.91164,8.6399,15.69073,8.41643,15.46982,8.32704,15.20473,8.32704,14.80709,8.32704,12.112,8.90807,12.112,8.90807,14.80709,8.90807,15.24891,9.08686,15.46982,9.48912,15.46982,9.71259,15.46982,9.89137,15.38146,9.98077,15.29309,10.07016,15.16055,10.11485,14.98382,10.11485,14.67455,10.11485,12.112,10.74059,12.112,10.74059,12.112],segments:[1,2,4,4,4,4,2,2,2,4,4,4,2,2,2]},{type:"rect",background:"rgb(0,0,0)",borderColor:"#979797",rect:[11.65679,12.112,.82321,3.888]}]}),ht.Default.setImage("editor.ui-tab",{modified:"Thu Jun 04 2020 09:40:36 GMT+0800 (China Standard Time)",width:16,height:16,fitSize:!0,attachStyle:"close",comps:[{type:"shape",background:"rgb(255,255,255)",points:[14.84148,4.57262,10.64058,.11253,10.54173,.0064,10.39999,0,10.25216,0,1.90035,0,1.61181,0,1.35184,.11591,1.35184,.39404,1.35184,15.48836,1.35184,15.76649,1.6119,16,1.90035,16,6.28421,16,6.57276,16,7.02587,15.76649,7.02587,15.48836,7.02587,15.21023,6.57267,15.02222,6.28421,15.02222,2.36615,15.02222,2.36615,.97787,9.19027,.97787,9.19027,5.3048,9.19027,5.58293,9.47642,5.77787,9.76488,5.77787,13.89338,5.77787,13.89338,8.94755,13.89338,9.22569,14.15814,9.45067,14.44669,9.45067,14.73524,9.45067,15,9.2256,15,8.94755,15,4.88356,15,4.75973,14.92706,4.66507,14.84148,4.57262,14.84148,4.57262,10.29689,1.26427,13.62485,4.80009,10.29689,4.80009,10.29689,1.26427,10.29689,1.26427],segments:[1,2,4,2,4,2,4,2,4,4,2,2,2,2,4,2,2,4,4,2,4,2,1,2,2,2,2]},{type:"shape",background:"rgb(255,255,255)",borderWidth:.2,borderColor:"rgb(255,255,255)",pixelPerfect:!0,points:[10.74059,12.112,10.74059,14.67455,10.74059,15.11636,10.6512,15.42564,10.47242,15.64655,10.24894,15.86746,9.93607,16,9.48912,16,9.08686,16,8.81868,15.91164,8.6399,15.69073,8.41643,15.46982,8.32704,15.20473,8.32704,14.80709,8.32704,12.112,8.90807,12.112,8.90807,14.80709,8.90807,15.24891,9.08686,15.46982,9.48912,15.46982,9.71259,15.46982,9.89137,15.38146,9.98077,15.29309,10.07016,15.16055,10.11485,14.98382,10.11485,14.67455,10.11485,12.112,10.74059,12.112,10.74059,12.112],segments:[1,2,4,4,4,4,2,2,2,4,4,4,2,2,2]},{type:"rect",background:"rgb(255,255,255)",rect:[11.65679,12.112,.82321,3.888]}]}),ht.Default.setImage("editor.ttf",{width:64,height:64,fitSize:!0,comps:[{type:"shape",background:"#000000",points:[53.17006,60.62742,50.68081,60.62742,50.41177,60.62742,50.19585,60.41688,50.19585,60.15453,50.19585,43.31796,50.19585,43.05561,50.41177,42.84507,50.68081,42.84507,60.09288,42.84507,60.36192,42.84507,60.57784,43.05561,60.57784,43.31796,60.57784,45.40904,60.57784,45.67138,60.36192,45.88193,60.09288,45.88193,53.65537,45.88193,53.65537,50.62587,59.22886,50.62587,59.4979,50.62587,59.71382,50.83642,59.71382,51.09876,59.71382,53.18984,59.71382,53.45219,59.4979,53.66273,59.22886,53.66273,53.65537,53.66273,53.65537,60.1542,53.65537,60.41688,53.43911,60.62742,53.17006,60.62742,53.17006,60.62742],segments:[1,2,4,2,4,2,4,2,4,2,2,2,4,2,4,2,2,4,2]},{type:"shape",background:"#000000",points:[56.21111,19.11398,40.59837,2.34525,40.23096,1.94622,39.70418,1.92216,39.15478,1.92216,8.11505,1.92216,7.04265,1.92216,6.07649,2.35795,6.07649,3.40366,6.07649,60.1542,6.07649,61.1999,7.04299,62.07784,8.11505,62.07784,13.93496,62.07784,15.00736,62.07784,15.87481,61.28546,15.87481,60.23975,15.87481,59.19405,15.00702,58.40166,13.93496,58.40166,9.84618,58.40166,9.84618,5.59867,35.20824,5.59867,35.20824,21.86677,35.20824,22.91248,36.27174,23.64538,37.3438,23.64538,52.6875,23.64538,52.6875,35.56255,52.6875,36.60826,53.67148,37.45412,54.74388,37.45412,55.81629,37.45412,56.80027,36.60793,56.80027,35.56255,56.80027,20.28301,56.80027,19.81747,56.52917,19.46155,56.21111,19.11398,56.21111,19.11398,39.32101,6.67546,51.68947,19.9692,39.32101,19.9692,39.32101,6.67546,39.32101,6.67546],segments:[1,2,4,2,4,2,4,2,4,4,2,2,2,2,4,2,2,4,4,2,4,2,1,2,2,2,2]},{type:"shape",background:"#000000",points:[41.52931,60.62742,39.04006,60.62742,38.77102,60.62742,38.5551,60.41688,38.5551,60.15453,38.5551,42.84507,46.88507,42.84507,47.15411,42.84507,47.37003,43.05561,47.37003,43.31796,47.37003,45.40904,47.37003,45.67138,47.15411,45.88193,46.88507,45.88193,42.01462,45.88193,42.01462,60.1542,42.01462,60.41688,41.79836,60.62742,41.52931,60.62742,41.52931,60.62742],segments:[1,2,4,2,2,4,2,4,2,2,4,2]},{type:"shape",background:"#000000",rotation:3.14159,points:[33.91988,42.84507,39.07014,42.84507,39.33918,42.84507,39.5551,43.05561,39.5551,43.31796,39.5551,45.40904,39.5551,45.67138,39.33918,45.88193,39.07014,45.88193,33.91988,45.88193],segments:[1,2,4,2,4,2]},{type:"shape",background:"#000000",points:[25.11617,60.62742,22.62692,60.62742,22.35788,60.62742,22.14196,60.41688,22.14196,60.15453,22.14196,42.84507,30.47192,42.84507,30.74096,42.84507,30.95688,43.05561,30.95688,43.31796,30.95688,45.40904,30.95688,45.67138,30.74096,45.88193,30.47192,45.88193,25.60148,45.88193,25.60148,60.1542,25.60148,60.41688,25.38522,60.62742,25.11617,60.62742,25.11617,60.62742],segments:[1,2,4,2,2,4,2,4,2,2,4,2]},{type:"shape",background:"#000000",rotation:3.14159,points:[17.50673,42.84507,22.657,42.84507,22.92604,42.84507,23.14196,43.05561,23.14196,43.31796,23.14196,45.40904,23.14196,45.67138,22.92604,45.88193,22.657,45.88193,17.50673,45.88193],segments:[1,2,4,2,4,2]}]}),ht.Default.setImage("editor.otf",{width:64,height:64,fitSize:!0,comps:[{type:"shape",background:"#000000",points:[53.17006,60.62742,50.68081,60.62742,50.41177,60.62742,50.19585,60.41688,50.19585,60.15453,50.19585,43.31796,50.19585,43.05561,50.41177,42.84507,50.68081,42.84507,60.09288,42.84507,60.36192,42.84507,60.57784,43.05561,60.57784,43.31796,60.57784,45.40904,60.57784,45.67138,60.36192,45.88193,60.09288,45.88193,53.65537,45.88193,53.65537,50.62587,59.22886,50.62587,59.4979,50.62587,59.71382,50.83642,59.71382,51.09876,59.71382,53.18984,59.71382,53.45219,59.4979,53.66273,59.22886,53.66273,53.65537,53.66273,53.65537,60.1542,53.65537,60.41688,53.43911,60.62742,53.17006,60.62742,53.17006,60.62742],segments:[1,2,4,2,4,2,4,2,4,2,2,2,4,2,4,2,2,4,2]},{type:"shape",background:"#000000",points:[56.21111,19.11398,40.59837,2.34525,40.23096,1.94622,39.70418,1.92216,39.15478,1.92216,8.11505,1.92216,7.04265,1.92216,6.07649,2.35795,6.07649,3.40366,6.07649,60.1542,6.07649,61.1999,7.04299,62.07784,8.11505,62.07784,13.93496,62.07784,15.00736,62.07784,15.87481,61.28546,15.87481,60.23975,15.87481,59.19405,15.00702,58.40166,13.93496,58.40166,9.84618,58.40166,9.84618,5.59867,35.20824,5.59867,35.20824,21.86677,35.20824,22.91248,36.27174,23.64538,37.3438,23.64538,52.6875,23.64538,52.6875,35.56255,52.6875,36.60826,53.67148,37.45412,54.74388,37.45412,55.81629,37.45412,56.80027,36.60793,56.80027,35.56255,56.80027,20.28301,56.80027,19.81747,56.52917,19.46155,56.21111,19.11398,56.21111,19.11398,39.32101,6.67546,51.68947,19.9692,39.32101,19.9692,39.32101,6.67546,39.32101,6.67546],segments:[1,2,4,2,4,2,4,2,4,4,2,2,2,2,4,2,2,4,4,2,4,2,1,2,2,2,2]},{type:"shape",background:"#000000",points:[41.52931,60.62742,39.04006,60.62742,38.77102,60.62742,38.5551,60.41688,38.5551,60.15453,38.5551,42.84507,46.88507,42.84507,47.15411,42.84507,47.37003,43.05561,47.37003,43.31796,47.37003,45.40904,47.37003,45.67138,47.15411,45.88193,46.88507,45.88193,42.01462,45.88193,42.01462,60.1542,42.01462,60.41688,41.79836,60.62742,41.52931,60.62742,41.52931,60.62742],segments:[1,2,4,2,2,4,2,4,2,2,4,2]},{type:"shape",background:"#000000",rotation:3.14159,points:[33.91988,42.84507,39.07014,42.84507,39.33918,42.84507,39.5551,43.05561,39.5551,43.31796,39.5551,45.40904,39.5551,45.67138,39.33918,45.88193,39.07014,45.88193,33.91988,45.88193],segments:[1,2,4,2,4,2]},{type:"oval",borderWidth:3.3,borderColor:"rgb(0,0,0)",rect:[18.97543,44.76232,11.82189,13.94784]}]}),ht.Default.setImage("editor.js",{width:64,height:64,fitSize:!0,comps:[{type:"shape",background:"#000000",points:[56.21111,19.11398,40.59837,2.34525,40.23096,1.94622,39.70418,1.92216,39.15478,1.92216,8.11505,1.92216,7.04265,1.92216,6.07649,2.35795,6.07649,3.40366,6.07649,60.1542,6.07649,61.1999,7.04299,62.07784,8.11505,62.07784,13.93496,62.07784,15.00736,62.07784,15.87481,61.28546,15.87481,60.23975,15.87481,59.19405,15.00702,58.40166,13.93496,58.40166,9.84618,58.40166,9.84618,5.59867,35.20824,5.59867,35.20824,21.86677,35.20824,22.91248,36.27174,23.64538,37.3438,23.64538,52.6875,23.64538,52.6875,35.56255,52.6875,36.60826,53.67148,37.45412,54.74388,37.45412,55.81629,37.45412,56.80027,36.60793,56.80027,35.56255,56.80027,20.28301,56.80027,19.81747,56.52917,19.46155,56.21111,19.11398,56.21111,19.11398,39.32101,6.67546,51.68947,19.9692,39.32101,19.9692,39.32101,6.67546,39.32101,6.67546],segments:[1,2,4,2,4,2,4,2,4,4,2,2,2,2,4,2,2,4,4,2,4,2,1,2,2,2,2]},{type:"text",text:{func:"attr@name",value:"JS"},align:"center",font:"bold 24px Arial Rounded MT Bold",rect:[17.50673,40.58187,46.49327,23.41813]}]}),ht.Default.setImage("editor.sound",{width:64,height:64,fitSize:!0,comps:[{type:"shape",background:"#000000",points:[56.21111,19.11398,40.59837,2.34525,40.23096,1.94622,39.70418,1.92216,39.15478,1.92216,8.11505,1.92216,7.04265,1.92216,6.07649,2.35795,6.07649,3.40366,6.07649,60.1542,6.07649,61.1999,7.04299,62.07784,8.11505,62.07784,13.93496,62.07784,15.00736,62.07784,15.87481,61.28546,15.87481,60.23975,15.87481,59.19405,15.00702,58.40166,13.93496,58.40166,9.84618,58.40166,9.84618,5.59867,35.20824,5.59867,35.20824,21.86677,35.20824,22.91248,36.27174,23.64538,37.3438,23.64538,52.6875,23.64538,52.6875,35.56255,52.6875,36.60826,53.67148,37.45412,54.74388,37.45412,55.81629,37.45412,56.80027,36.60793,56.80027,35.56255,56.80027,20.28301,56.80027,19.81747,56.52917,19.46155,56.21111,19.11398,56.21111,19.11398,39.32101,6.67546,51.68947,19.9692,39.32101,19.9692,39.32101,6.67546,39.32101,6.67546],segments:[1,2,4,2,4,2,4,2,4,4,2,2,2,2,4,2,2,4,4,2,4,2,1,2,2,2,2]},{type:"shape",background:"#231815",points:[29.93506,40.65719,29.93506,52.11129,29.99768,52.17391,38.01482,58.31199,38.01482,53.06642,38.01482,39.70982,38.01482,34.45641,29.93506,40.65719,29.93506,40.65719,29.93506,40.65719,29.93506,40.65719,44.44257,36.03797,44.44257,36.03797,43.87107,35.70912,43.69881,34.9732,44.02766,34.40163,44.37211,33.84573,45.10803,33.65787,45.66393,33.99448,47.80131,35.26287,49.59417,37.09491,50.81553,39.2714,52.01338,41.37743,52.71019,43.80448,52.71019,46.38028,52.71019,48.95608,52.01338,51.38313,50.81553,53.48924,49.59417,55.65789,47.80131,57.49777,45.66393,58.77392,45.10803,59.1262,44.37211,58.93834,44.02766,58.35901,43.69881,57.79528,43.87107,57.05152,44.44257,56.7305,46.24326,55.65789,47.71518,54.13119,48.7486,52.32266,49.73508,50.57675,50.30665,48.55685,50.30665,46.38812,50.30665,44.23514,49.72724,42.19948,48.7486,40.46141,47.71518,38.63721,46.23542,37.10275,44.44257,36.03797,44.44257,36.03797,44.44257,36.03797,28.49449,40.89991,28.49449,40.89991,23.62472,40.89991,23.62472,51.86073,28.49449,51.86073,28.49449,40.89991,28.49449,40.89991,28.49449,40.89991,28.80767,38.51197,28.80767,38.51197,38.42189,31.14469,38.64118,30.96459,38.91517,30.86286,39.21267,30.86286,39.88597,30.86286,40.41052,31.38741,40.41052,32.05287,40.41052,39.70982,40.41052,39.97605,41.53008,40.43014,42.47745,41.16606,43.21337,42.09776,44.14506,43.28777,44.7088,44.76753,44.7088,46.38812,44.7088,48.00879,44.1529,49.50414,43.21337,50.67856,42.50096,51.61017,41.53008,52.33834,40.41052,52.80027,40.41052,53.07426,40.41052,60.72336,40.41052,60.99743,40.32439,61.24015,40.1678,61.45936,39.76073,61.97607,39.01698,62.07788,38.50019,61.67073,28.82334,54.25651,22.46606,54.25651,22.43471,54.25651,21.77708,54.25651,21.23686,53.72412,21.23686,53.06642,21.23686,39.73333,21.23686,39.70982,21.23686,39.04435,21.76924,38.51197,22.43471,38.51197,28.80767,38.51197,28.80767,38.51197,28.80767,38.51197,40.40269,41.5497,40.40269,41.5497,40.40269,51.21878,41.06823,50.85858,41.62405,50.37322,42.08598,49.79381,42.8219,48.86219,43.26039,47.6721,43.26039,46.38812,43.26039,45.11197,42.81414,43.92196,42.08598,42.98243,41.62405,42.39526,41.06039,41.90982,40.40269,41.5497,40.40269,41.5497,40.40269,41.5497],segments:[1,2,2,2,2,2,2,2,2,2,2,1,2,4,4,4,4,4,4,4,4,4,4,4,4,2,2,1,2,2,2,2,2,2,2,1,2,2,4,4,2,2,4,4,4,4,2,2,4,4,2,2,2,4,2,2,4,2,2,2,1,2,2,4,4,4,4,2,2]}]}),ht.Default.setImage("editor.video",{width:64,height:64,fitSize:!0,comps:[{type:"shape",background:"#000000",points:[56.21111,19.11398,40.59837,2.34525,40.23096,1.94622,39.70418,1.92216,39.15478,1.92216,8.11505,1.92216,7.04265,1.92216,6.07649,2.35795,6.07649,3.40366,6.07649,60.1542,6.07649,61.1999,7.04299,62.07784,8.11505,62.07784,13.93496,62.07784,15.00736,62.07784,15.87481,61.28546,15.87481,60.23975,15.87481,59.19405,15.00702,58.40166,13.93496,58.40166,9.84618,58.40166,9.84618,5.59867,35.20824,5.59867,35.20824,21.86677,35.20824,22.91248,36.27174,23.64538,37.3438,23.64538,52.6875,23.64538,52.6875,35.56255,52.6875,36.60826,53.67148,37.45412,54.74388,37.45412,55.81629,37.45412,56.80027,36.60793,56.80027,35.56255,56.80027,20.28301,56.80027,19.81747,56.52917,19.46155,56.21111,19.11398,56.21111,19.11398,39.32101,6.67546,51.68947,19.9692,39.32101,19.9692,39.32101,6.67546,39.32101,6.67546],segments:[1,2,4,2,4,2,4,2,4,4,2,2,2,2,4,2,2,4,4,2,4,2,1,2,2,2,2]},{type:"shape",background:"#231815",
points:[34.79567,39.50193,35.8771,39.50193,36.86394,39.06777,37.56645,38.36518,38.28485,37.63888,38.7269,36.65212,38.7269,35.57851,38.7269,34.497,38.28485,33.51024,37.56645,32.80765,36.86394,32.08933,35.86927,31.6472,34.79567,31.6472,33.70626,31.6472,32.7274,32.08933,32.0169,32.80765,31.30641,33.51024,30.86435,34.497,30.86435,35.57851,30.86435,36.65212,31.30641,37.63888,32.0169,38.36518,32.7274,39.05987,33.71416,39.50193,34.79567,39.50193,34.79567,39.50193,34.79567,39.50193,33.03527,33.81021,33.03527,33.81021,33.47733,33.36816,34.10098,33.08399,34.79567,33.08399,35.48246,33.08399,36.0982,33.36816,36.54816,33.81021,36.99022,34.26807,37.27438,34.88382,37.27438,35.57061,37.27438,36.2574,36.99022,36.87315,36.54816,37.33101,36.0982,37.76524,35.48246,38.0494,34.79567,38.0494,34.10098,38.0494,33.47733,37.76524,33.03527,37.33101,32.59314,36.87315,32.31687,36.2574,32.31687,35.57061,32.31687,34.88382,32.59314,34.27598,33.03527,33.81021,33.03527,33.81021,33.03527,33.81021,38.719,42.35963,38.719,42.35963,39.05848,43.38583,39.77688,44.19107,40.6768,44.64103,42.60298,45.61989,44.97913,44.84625,45.95008,42.92007,46.40794,42.02015,46.53422,40.94655,46.17901,39.92027,45.86323,38.89408,45.14484,38.08884,44.23702,37.63888,43.33711,37.18892,42.2714,37.06264,41.24513,37.40995,40.21894,37.74943,39.39789,38.46775,38.95583,39.35984,38.49007,40.25185,38.3796,41.32546,38.719,42.35963,38.719,42.35963,38.719,42.35963,40.24257,40.02292,40.24257,40.02292,40.53471,39.44669,41.04781,38.99665,41.68726,38.77563,42.33454,38.5704,43.02923,38.64144,43.58184,38.93351,44.15808,39.22558,44.60803,39.72295,44.82124,40.38604,45.03436,41.03339,44.96332,41.70438,44.67907,42.28851,44.06341,43.50428,42.55557,43.98577,41.33198,43.3543,40.77937,43.07005,40.30578,42.56486,40.10048,41.9175,39.87945,41.25442,39.9663,40.58343,40.24257,40.02292,40.24257,40.02292,40.24257,40.02292,40.13209,46.26716,40.13209,46.26716,39.16114,46.10935,38.09543,46.33828,37.21915,46.96976,36.34286,47.61711,35.80606,48.54073,35.65607,49.5354,35.65607,49.5354,35.50608,50.53006,35.71929,51.57996,36.35076,52.46415,36.98231,53.33245,37.89803,53.86926,38.89269,54.02714,38.9243,54.02714,41.04781,54.38235,43.08447,52.8904,43.42395,50.76689,43.42395,50.75899,43.56604,49.76433,43.34501,48.71435,42.71346,47.84604,42.06618,46.96976,41.14256,46.42505,40.13209,46.26716,40.13209,46.26716,40.13209,46.26716,39.14533,52.60623,39.14533,52.60623,39.12953,52.59833,38.49797,52.49568,37.91384,52.1641,37.51912,51.61157,37.1244,51.05896,36.97441,50.38798,37.07706,49.75642,37.17181,49.13278,37.51912,48.54073,38.07172,48.13021,38.62433,47.73549,39.30322,47.60131,39.93469,47.69606,40.55044,47.79081,41.15046,48.13021,41.5451,48.69072,41.94772,49.24333,42.08981,49.91431,41.98724,50.53796,41.77403,51.87993,40.4794,52.81936,39.14533,52.60623,39.14533,52.60623,39.14533,52.60623,49.24984,57.84791,49.24984,57.84791,41.37939,57.84791,46.82629,55.31388,50.46553,49.76433,50.46553,43.63056,50.46553,39.30453,48.70514,35.38909,45.86323,32.54719,43.03714,29.72109,39.12162,27.9607,34.79567,27.9607,26.1594,27.9607,19.12572,34.99437,19.12572,43.63056,19.12572,47.94079,20.88612,51.87993,23.71222,54.69813,26.54622,57.54003,30.46963,59.30043,34.79567,59.30043,35.20611,59.30043,35.29296,59.30043,49.24984,59.30043,49.64456,59.30043,49.96816,58.96893,49.96816,58.57421,49.96816,58.17158,49.64456,57.84791,49.24984,57.84791,49.24984,57.84791,49.24984,57.84791,34.79567,56.88485,34.79567,56.88485,31.13271,56.88485,27.81723,55.39282,25.42528,53.00087,23.01761,50.5853,21.54138,47.28553,21.54138,43.62266,21.54138,36.34425,27.51725,30.36837,34.79567,30.36837,38.45064,30.36837,41.77403,31.8525,44.15808,34.25227,46.56583,36.64422,48.04206,39.96769,48.04206,43.62266,48.04206,47.28553,46.55793,50.6011,44.16598,53.00087,41.68726,55.48757,38.30856,56.88485,34.79567,56.88485,34.79567,56.88485,34.79567,56.88485,28.91446,44.64103,28.91446,44.64103,29.80655,44.18317,30.54067,43.38583,30.86435,42.35173,31.19593,41.32546,31.08538,40.25976,30.63542,39.35984,29.67237,37.44156,27.25672,36.66002,25.35424,37.63888,23.42015,38.62564,22.64651,41.00178,23.62545,42.92007,24.07541,43.81998,24.88057,44.53838,25.90684,44.86206,26.94884,45.20146,28.02245,45.09889,28.91446,44.64103,28.91446,44.64103,28.91446,44.64103,26.3647,43.51211,26.3647,43.51211,25.71735,43.29108,25.20425,42.82532,24.91218,42.28069,24.29643,41.0492,24.79373,39.54136,26.00942,38.92561,27.22519,38.30986,28.73294,38.79143,29.34869,40.02292,29.63286,40.59134,29.7118,41.25442,29.50658,41.90178,29.28555,42.54905,28.81979,43.06215,28.27509,43.34639,27.69877,43.63056,27.01198,43.71741,26.3647,43.51211,26.3647,43.51211,26.3647,43.51211,29.44344,46.26716,29.44344,46.26716,27.31195,46.59874,25.85153,48.61178,26.17521,50.72738,26.17521,50.75899,26.33309,51.75365,26.8778,52.69308,27.73828,53.32455,28.59876,53.9561,29.66447,54.17713,30.62752,54.02714,30.66703,54.01924,32.80634,53.67194,34.25886,51.66681,33.92728,49.52749,33.60361,47.39609,31.58275,45.94356,29.44344,46.26716,29.44344,46.26716,29.44344,46.26716,32.50637,49.75642,32.50637,49.75642,32.7274,51.1063,31.80378,52.39303,30.44593,52.60623,30.4223,52.61413,29.79865,52.7009,29.13557,52.55091,28.59086,52.14837,28.04616,51.75365,27.69877,51.15371,27.5962,50.53006,27.5962,50.50635,27.3909,49.17229,28.33032,47.90128,29.66447,47.69606,31.00644,47.48293,32.29317,48.40655,32.50637,49.75642,32.50637,49.75642,32.50637,49.75642,32.50637,49.75642,37.44808,43.63056,37.44808,43.63056,37.44808,42.89644,37.1481,42.22537,36.67444,41.75171,36.18497,41.27022,35.52189,40.96235,34.79567,40.96235,34.06147,40.96235,33.39048,41.27022,32.90891,41.75171,32.43525,42.23328,32.14318,42.89644,32.14318,43.63056,32.14318,44.36469,32.43525,45.02785,32.90891,45.50933,33.39838,45.983,34.06147,46.28297,34.79567,46.28297,36.25609,46.28297,37.44808,45.08308,37.44808,43.63056,37.44808,43.63056,37.44808,43.63056,34.79567,44.83835,34.79567,44.83835,34.45619,44.83835,34.14831,44.71207,33.93519,44.49104,33.71416,44.28574,33.5878,43.96997,33.5878,43.63846,33.5878,43.31479,33.71416,42.99901,33.93519,42.77798,34.14831,42.56486,34.45619,42.42277,34.79567,42.42277,35.11927,42.42277,35.42714,42.55695,35.64817,42.77798,35.86927,42.99901,36.01136,43.31479,36.01136,43.63846,36.01136,44.30155,35.46665,44.83835,34.79567,44.83835,34.79567,44.83835,34.79567,44.83835],segments:[1,4,4,4,4,4,4,4,4,2,2,1,2,4,4,4,4,4,4,4,4,2,2,1,2,4,4,4,4,4,4,4,2,2,1,2,4,4,4,4,4,4,4,2,2,1,2,4,4,2,4,4,2,4,2,4,4,2,2,1,2,2,4,4,4,4,4,4,4,2,2,1,2,2,4,4,4,4,4,4,2,2,2,4,4,2,2,1,2,4,4,4,4,4,4,4,2,2,1,2,4,4,4,4,4,4,2,2,1,2,4,4,4,4,4,4,2,2,1,2,4,2,4,4,2,4,4,2,2,1,2,4,2,4,4,2,4,4,2,2,2,1,2,4,4,4,4,4,4,4,2,2,1,2,4,4,4,4,4,4,4,2,2]}]}),ht.Default.setImage("editor.flipx",{width:16,height:16,comps:[{type:"shape",points:[8,1,8,14],segments:[1,2],borderWidth:1,borderColor:KR.config.color_dark},{type:"shape",points:[6,3,6,13,2,13],background:KR.config.color_dark},{type:"shape",points:[10,3,10,13,14,13],background:KR.config.color_select}]}),ht.Default.setImage("editor.flipy",{width:16,height:16,comps:[{type:"shape",points:[2,8,15,8],segments:[1,2],borderWidth:1,borderColor:KR.config.color_dark},{type:"shape",points:[3,6,13,6,3,2],background:KR.config.color_dark},{type:"shape",points:[3,10,13,10,3,14],background:KR.config.color_select}]}),ht.Default.setImage("editor.resetsize",{width:16,height:16,comps:[{type:"shape",borderWidth:1,borderColor:"white",points:[8,1,8,6,6,3,8,1,10,3,8,10,8,15,6,13,8,15,10,13,1,8,6,8,3,6,1,8,3,10,10,8,15,8,13,6,15,8,13,10],segments:[1,2,1,2,2,1,2,1,2,2,1,2,1,2,2,1,2,1,2,2]}]}),ht.Default.setImage("editor.func",{width:16,height:16,comps:[{type:"border",rect:[0,0,16,16],width:1,color:"#E4E4E4"},{type:"text",rect:[0,0,16,16],text:"F",align:"center",color:"black"}]}),ht.Default.setImage("editor.comp",{fitSize:!0,comps:[{type:{func:function(i){return i.compType},isSafeFunc:!0}}]}),ht.Default.setImage("editor.oops",{width:128,height:128,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:2,borderColor:"rgb(61,61,61)",rect:[21.53429,22.96531,88.8981,74.69064]},{type:"shape",background:"rgb(237,237,237)",borderColor:"#979797",points:[34.08079,87.52544,34.08079,87.52544,59.57908,97.75645,77.79215,90.58303,96.00522,83.40961,106.8249,68.87436,109.71641,51.69689,109.71641,51.69689,117.89865,74.48774,101.34821,87.52544,84.79777,100.56314,59.50721,102.27801,46.42474,94.29524],segments:[1,4,4,4,4]},{type:"arc",background:"rgb(196,185,185)",borderColor:"rgb(61,61,61)",arcTo:0,arcOval:!0,rotation:3.14159,rect:[32.3979,36.49467,28.49791,18.12387]},{type:"arc",background:"rgb(196,185,185)",borderColor:"rgb(61,61,61)",arcTo:0,arcOval:!0,rotation:3.14159,rect:[68.95508,36.49467,28.49791,18.12387]},{type:"shape",background:"rgb(149,224,245)",borderColor:"#979797",points:[39.9814,51.13901,39.9814,51.13901,32.00842,57.90113,30.56723,66.4088,29.12604,74.91647,34.21664,85.16969,34.21664,85.16969,39.0516,89.44677,39.0516,89.44677,36.05169,79.68945,37.3999,70.48443,38.74811,61.27941,44.44444,52.62669,44.44444,52.62669,39.9814,51.13901,39.9814,51.13901],segments:[1,4,4,2,4,4,2,2]},{type:"shape",background:"rgb(149,224,245)",borderColor:"#979797",scaleX:-1,points:[97.67259,49.56003,97.67259,49.56003,89.6996,57.90113,88.25841,66.4088,86.81722,74.91647,91.8398,85.99598,91.8398,85.99598,96.74279,89.44677,96.74279,89.44677,93.74288,79.68945,95.09109,70.48443,96.4393,61.27941,102.44264,50.50641,102.44264,50.50641,97.67259,49.56003],segments:[1,4,4,2,4,4,2]},{type:"shape",borderWidth:2,borderColor:"rgb(61,61,61)",borderCap:"round",points:[59.61377,32.055,59.61377,32.055,61.61221,36.91182,59.19747,38.71578,56.78274,40.51974,34.08079,42.18493,34.08079,42.18493],segments:[1,4,4]},{type:"shape",borderWidth:2,borderColor:"rgb(61,61,61)",borderCap:"round",scaleX:-1,points:[94.48806,32.055,94.48806,32.055,96.4865,36.91182,94.07177,38.71578,91.65703,40.51974,68.95508,42.18493,68.95508,42.18493],segments:[1,4,4]},{type:"shape",borderWidth:2,borderColor:"rgb(61,61,61)",borderCap:"round",points:[67.02409,33.58143,67.02409,33.58143,64.9426,37.74441,67.02409,39.68714],segments:[1,4]},{type:"arc",background:"rgb(255,255,255)",borderWidth:2,borderColor:"rgb(61,61,61)",arcTo:0,arcOval:!0,rotation:3.14159,rect:[68.95508,40.07324,28.49791,11.89121]},{type:"arc",background:"rgb(255,255,255)",borderWidth:2,borderColor:"rgb(61,61,61)",arcTo:0,arcOval:!0,rotation:3.14159,rect:[32.3979,40.07323,28.49791,11.89121]},{type:"shape",borderWidth:2,borderColor:"rgb(61,61,61)",borderCap:"round",points:[60.89581,46.6003,56.70566,57.66949,39.6779,55.58118,39.6779,55.58118],segments:[1,4]},{type:"shape",borderWidth:2,borderColor:"rgb(61,61,61)",borderCap:"round",scaleX:-1,points:[90.173,46.6003,85.98284,57.66949,68.95508,55.58118,68.95508,55.58118],segments:[1,4]},{type:"shape",background:"rgb(61,61,61)",borderColor:"#979797",points:[40.88134,45.66533,40.88134,50.44931,49.68823,51.31913,49.03586,45.66533,40.99007,45.5566]},{type:"shape",background:"rgb(61,61,61)",borderColor:"#979797",points:[78.31735,45.66533,78.31735,50.44931,87.12423,51.31913,86.47187,45.66533,78.42607,45.5566]},{type:"shape",borderWidth:2,borderColor:"rgb(61,61,61)",borderCap:"round",points:[36.81151,80.08117,46.71402,84.60188,54.03326,76.42155,61.35251,85.46297,73.83828,76.20628,86.96987,83.95607,93.85858,76.85209,99.24038,80.08117]},{type:"shape",background:"rgb(237,237,237)",borderColor:"rgb(61,61,61)",borderCap:"round",points:[95.58345,31.98512,95.58345,31.98512,104.33563,25.53184,105.97087,18.7394,107.6061,11.94695,113.65647,33.63444,105.97087,42.39888],segments:[1,4,4]},{type:"shape",background:"rgb(237,237,237)",borderColor:"rgb(61,61,61)",borderCap:"round",rotation:.2618,points:[44.41276,23.77714,38.68944,23.77714,33.30496,20.23699,28.88983,14.5401,24.47469,8.84321,22.55729,35.68983,32.04166,40.72938],segments:[1,4,4]},{type:"oval",borderWidth:2,borderColor:"rgb(61,61,61)",rect:[21.53429,22.96531,88.8981,74.69064]},{type:"shape",borderWidth:2,borderColor:"rgb(61,61,61)",borderCap:"round",points:[93.19422,30.5138,93.19422,30.5138,96.32695,28.82985,99.04364,25.51534,100.63358,23.57553,102.08422,21.24706,102.68792,18.7394,104.32316,11.94695,112.13179,31.92062,104.44618,40.68506],segments:[1,4,4,4]},{type:"shape",borderWidth:2,borderColor:"rgb(61,61,61)",borderCap:"round",rotation:.2618,points:[40.62881,26.14647,34.90549,26.14647,32.31798,22.75803,27.90285,17.06114,23.48771,11.36426,18.41848,35.24736,27.90285,40.28692],segments:[1,4,4]},{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",anchorX:.41176,anchorY:.88889,rect:[91.52207,49.98659,1.67215,3.35736]},{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",anchorX:.41176,anchorY:.88889,rect:[39.44815,49.46033,2.86639,3.35736]}]}),ht.Default.setImage("editor.block",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",background:"rgb(255,227,199)",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[15,14.5,1,14.5,1,1.50001,7,1.50001,8,3.50001,15,3.50001,15,14.5]},{type:"rect",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[5.5,7.22625,6,5]},{type:"circle",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[2.5,4.72625,6,5]}]}),ht.Default.setImage("editor.group",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",background:"rgb(255,227,199)",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[15.5,15.5,.5,15.5,.5,.5,6.92857,.5,8.00001,2.80769,15.5,2.80769,15.5,15.5]},{type:"shape",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[2.82964,11.54111,13.17036,11.54111,13.17036,13.12467,13.17036,5.20688,2.82964,5.20688,2.82964,13.12467,13.17036,13.12467,7.26137,13.12467,5.78413,15.5,10.21588,15.5,8.84426,13.12467,13.17036,13.12467,13.17036,11.54111]}]}),ht.Default.setImage("editor.subgraph",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",background:"rgb(255,227,199)",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[15.5,15.5,.5,15.5,.5,.5,6.92857,.5,8.00001,2.80769,15.5,2.80769,15.5,15.5]},{type:"shape",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",closePath:!0,points:[4.90316,8.05737,4.90316,8.05737,4.30121,6.50546,5.25104,5.82166,6.20086,5.13787,7.09165,5.82166,7.09165,5.82166,7.09165,5.82166,7.76857,4.36921,9.6391,4.91013,11.50964,5.45106,11.09684,8.05737,11.09684,8.05737,11.09684,8.05737,12.482,8.53031,12.482,9.79106,12.482,10.86629,11.67411,11.63079,11.09684,11.63079,4.90316,11.63079,4.31315,11.63079,3.518,10.84732,3.518,9.79106,3.518,8.56402,4.90316,8.05737,4.90316,8.05737],segments:[1,4,4,4,4,4,4,2,4,4]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderJoin:"miter",points:[13,13.5,8.02409,13.5,8,9,8.02409,13.5,3,13.5]}]}),ht.Default.setImage("editor.restore",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"triangle",background:"rgb(138,138,138)",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:1.5708,rect:[7.5,1.71892,3,2]},{type:"arc",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",arcFrom:0,arcTo:4.7124,arcClose:!1,shadowColor:"#1ABC9C",rect:[2,2.78108,12,12]}]}),ht.Default.setImage("editor.add",{background:"rgb(150,150,150)",width:16,height:16,comps:[{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",rotation:3.14159,points:[9.47991,2.5,13.48953,7.4,9.47991,7.4,9.47991,2.5,2.48953,2.5,2.48953,13.5,13.48953,13.5,13.48953,7.4]}]}),ht.Default.setImage("editor.delete",{background:"rgb(89,89,89)",width:16,height:16,comps:[{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[5.5,5.57173,5.5,12.45709]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[8.05685,5.57173,8.05685,12.45709]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[10.5,5.57173,10.5,12.45709]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[1,3.18902,15,3.16996,5.32652,3.16021,6.32652,1.16021,9.32652,1.16021,10.32652,3.16021]},{type:"rect",borderWidth:1,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[3.33333,3.18902,9.33334,11.65078]}]}),ht.Default.setImage("editor.import",{background:"rgb(179,179,179)",width:16,height:16,comps:[{type:"triangle",borderColor:"rgb(255,255,255)",borderWidth:1,rotation:1.5708,rect:[7.5,1.71892,3,2]},{type:"arc",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",arcFrom:0,arcTo:4.7124,arcClose:!1,rect:[2,2.78108,12,12]}]}),ht.Default.setImage("editor.top",{background:"rgb(145,145,145)",width:16,height:16,comps:[{type:"rightTriangle",borderWidth:1,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rotation:2.35619,rect:[3.86035,6.44002,8.20153,8.2581]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",rotation:3.14159,points:[2.14176,4.58061,13.85824,4.51881]}]}),ht.Default.setImage("editor.up",{background:"rgb(145,145,145)",width:16,height:16,comps:[{type:"rightTriangle",borderWidth:1,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rotation:2.35619,rect:[3.89924,6.05159,8.20153,8.2581]}]}),ht.Default.setImage("editor.down",{background:"rgb(145,145,145)",width:16,height:16,comps:[{type:"rightTriangle",borderWidth:1,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rotation:5.49779,rect:[3.89924,.69031,8.20153,8.2581]}]}),ht.Default.setImage("editor.bottom",{background:"rgb(145,145,145)",width:16,height:16,comps:[{type:"rightTriangle",borderWidth:1,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rotation:5.49779,rect:[3.93812,.69031,8.20153,8.2581]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",rotation:3.14159,points:[2.14176,10.85024,13.85824,10.78844]}]}),ht.Default.setImage("editor.menu",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[.93729,4,14.93729,4]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[1.06271,8,15.06271,8]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[1.06271,12,15.06271,12]}]}),ht.Default.setImage("editor.undo",{background:"rgb(191,191,191)",width:16,height:16,comps:[{type:"shape",background:"rgb(255,255,255)",points:[9.9945,5.006,6.0345,5.006,6.0345,3.527,6.0345,3.336,5.9255,3.162,5.7545,3.078,5.5825,2.994,5.3785,3.015,5.2275,3.132,2.4795,5.264,2.3575,5.359,2.2865,5.505,2.2865,5.659,2.2865,5.813,2.3575,5.959,2.4795,6.054,5.2275,8.186,5.3175,8.256,5.4255,8.292,5.5345,8.292,5.6095,8.292,5.6845,8.275,5.7545,8.241,5.9255,8.157,6.0345,7.983,6.0345,7.792,6.0345,6.006,9.9945,6.006,11.5445,6.006,12.7135,7.296,12.7135,9.006,12.7135,10.689,11.4815,12.006,9.9085,12.006,5.0345,12.006,4.7585,12.006,4.5345,12.23,4.5345,12.506,4.5345,12.782,4.7585,13.006,5.0345,13.006,9.9085,13.006,12.0425,13.006,13.7135,11.249,13.7135,9.006,13.7135,6.763,12.0795,5.006,9.9945,5.006,9.9945,5.006],segments:[1,2,2,4,4,2,4,4,2,4,4,4,2,2,4,4,2,4,4,2,4,4,2]}]}),ht.Default.setImage("editor.redo",{background:"rgb(191,191,191)",width:16,height:16,comps:[{type:"shape",background:"rgb(255,255,255)",shadowColor:"#1ABC9C",scaleX:-1,points:[9.9945,5.006,6.0345,5.006,6.0345,3.527,6.0345,3.336,5.9255,3.162,5.7545,3.078,5.5825,2.994,5.3785,3.015,5.2275,3.132,2.4795,5.264,2.3575,5.359,2.2865,5.505,2.2865,5.659,2.2865,5.813,2.3575,5.959,2.4795,6.054,5.2275,8.186,5.3175,8.256,5.4255,8.292,5.5345,8.292,5.6095,8.292,5.6845,8.275,5.7545,8.241,5.9255,8.157,6.0345,7.983,6.0345,7.792,6.0345,6.006,9.9945,6.006,11.5445,6.006,12.7135,7.296,12.7135,9.006,12.7135,10.689,11.4815,12.006,9.9085,12.006,5.0345,12.006,4.7585,12.006,4.5345,12.23,4.5345,12.506,4.5345,12.782,4.7585,13.006,5.0345,13.006,9.9085,13.006,12.0425,13.006,13.7135,11.249,13.7135,9.006,13.7135,6.763,12.0795,5.006,9.9945,5.006,9.9945,5.006],segments:[1,2,2,4,4,2,4,4,2,4,4,4,2,2,4,4,2,4,4,2,4,4,2]}]}),ht.Default.setImage("editor.edit",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(51,153,255)",shadowColor:"#1ABC9C",rotation:5.49779,closePath:!0,points:[6,-.83884,.5,13.16116,6.04966,10.58206,11.5,13.16116,6,-.83884]}]}),ht.Default.setImage("editor.rulers",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",rotation:1.5708,points:[1.50517,1.5,1.5,4.49799,2.47337,4.49798,1.5,4.49799,1.50003,14.5,11.23413,14.48019,11.23413,13.48171,11.23413,14.47896,14.5,14.47897,4.00002,14.47899,4.00001,12.00001,1.50521,12.00002]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[14,6,14,14,6,14]}]}),ht.Default.setImage("editor.grid",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.49468,1.49999,4.5,14.49999,4.49468,11.53541,1.5,11.51432,14.5,11.51432,11.52105,11.53541,11.52105,14.49999,11.52105,1.49999,11.5,4.50429,14.5,4.50429,1.5,4.50429]}]}),ht.Default.setImage("editor.save",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",points:[3.66183,14.5,14.5,14.5,14.5,4.83454,10.71984,1.5,3.66183,1.5,3.66183,6.18654,10.71984,6.18654,10.71984,1.5,1.5,1.5,1.5,14.5,3.66183,14.5,3.66183,9.03168,12.17213,9.03168,12.17213,14.5]}]}),ht.Default.setImage("editor.preview",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",points:[1.9869,6.489,2,2,14,8,1.9869,14,2,9.555]}]}),ht.Default.setImage("editor.reload",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"triangle",background:"rgb(138,138,138)",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:1.5708,rect:[7.5,1.71892,3,2]},{type:"arc",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",arcFrom:0,arcTo:4.7124,arcClose:!1,shadowColor:"#1ABC9C",rect:[2,2.78108,12,12]}]}),ht.Default.setImage("editor.zoomout",{width:16,height:16,comps:[{type:"shape",borderWidth:1,borderColor:"white",points:[2,8,14,8]}]}),ht.Default.setImage("editor.zoomin",{width:16,height:16,comps:[{type:"shape",borderWidth:1,borderColor:"white",points:[2,8,14,8,8,2,8,14],segments:[1,2,1,2]}]}),ht.Default.setImage("editor.zoomtofit",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[8.00001,11.91764,8.00001,15]},{type:"triangle",background:"rgb(138,138,138)",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:-1.5708,rect:[9.75,7.24608,2,1.5]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",rotation:-1.5708,points:[13.516,6.484,13.516,9.51599]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",rotation:-3.14159,points:[8.00001,.99999,8.00001,4.08236]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",rotation:1.5708,points:[2.516,6.4801,2.516,9.51209]},{type:"triangle",background:"rgb(138,138,138)",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:1.5708,rect:[4.25,7.24608,2,1.5]},{type:"triangle",background:"rgb(138,138,138)",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:3.14159,rect:[7.00001,4.5,2,1.5]},{type:"triangle",background:"rgb(138,138,138)",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:6.28319,rect:[7,10,2,1.5]}]}),ht.Default.setImage("editor.toggleleft",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:1.5708,rect:[2.50002,1.00002,10.99995,13.99996]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[3.49001,5.50001,3.51001,10.49999]}]}),ht.Default.setImage("editor.toggleboth",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:1.5708,rect:[2.5,1,11,14]}]}),ht.Default.setImage("editor.toggleright",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:1.5708,rect:[2.50002,1.00002,10.99995,13.99996]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[12.49999,5.50001,12.51999,10.49999]}]}),ht.Default.setImage("editor.layout.helper",ht.Default.parse(JSON.stringify({modified:"Mon Oct 29 2018 09:55:40 GMT+0800 (\u4e2d\u56fd\u6807\u51c6\u65f6\u95f4)",dataBindings:[{attr:"selectColor",valueType:"Color",defaultValue:"#60ACFC"},{attr:"layout.h",valueType:"String"},{attr:"layout.v",valueType:"String"}],width:100,height:100,interactive:!0,disableSelectedBorder:!0,pixelPerfect:!1,comps:[{type:"rect",borderColor:"#979797",displayName:"\u5de6\u4fa7\u4ea4\u4e92",rect:[5.51795,27.5,20.9641,44.5],onDown:"__ht__function(event, data, view, point, width, height) {\nif (ht.Default.isShiftDown()) {\n    data.a('layout.h', 'leftright');\n}\nelse {\n    data.a('layout.h', 'left');\n}\n}"},{type:"rect",borderColor:"#979797",displayName:"\u53f3\u4fa7\u4ea4\u4e92",rect:[74.0359,27.5,20.9641,45],onDown:"__ht__function(event, data, view, point, width, height) {\nif (ht.Default.isShiftDown()) {\n    data.a('layout.h', 'leftright');\n}\nelse {\n    data.a('layout.h', 'right');\n}\n}"},{type:"rect",borderColor:"#979797",displayName:"\u4e0a\u4fa7\u4ea4\u4e92",rect:[27.5,6,45,20],onDown:"__ht__function(event, data, view, point, width, height) {\nif (ht.Default.isShiftDown()) {\n    data.a('layout.v', 'topbottom');\n}\nelse {\n    data.a('layout.v', 'top');\n}\n}"},{type:"rect",borderColor:"#979797",displayName:"\u4e0b\u4fa7\u4ea4\u4e92",rect:[27.5,74,45,20],onDown:"__ht__function(event, data, view, point, width, height) {\nif (ht.Default.isShiftDown()) {\n    data.a('layout.v', 'topbottom');\n}\nelse {\n    data.a('layout.v', 'bottom');\n}\n}"},{type:"rect",borderColor:"#979797",displayName:"\u6a2a\u5411\u4e2d\u5fc3\u4ea4\u4e92",rect:[28.22051,44,16,12],onDown:"__ht__function(event, data, view, point, width, height) {\ndata.a('layout.h', 'center');\n}"},{type:"rect",borderColor:"#979797",displayName:"\u6a2a\u5411\u4e2d\u5fc3\u4ea4\u4e92",rect:[55.77949,44,16,12],onDown:"__ht__function(event, data, view, point, width, height) {\ndata.a('layout.h', 'center');\n}"},{type:"rect",borderColor:"#979797",displayName:"\u7eb5\u5411\u4e2d\u5fc3\u4ea4\u4e92",rect:[44.22051,28,11.55897,16],onDown:"__ht__function(event, data, view, point, width, height) {\ndata.a('layout.v', 'center');\n}"},{type:"rect",borderColor:"#979797",displayName:"\u7eb5\u5411\u4e2d\u5fc3\u4ea4\u4e92",rect:[44.22051,56,11.55897,16],onDown:"__ht__function(event, data, view, point, width, height) {\ndata.a('layout.v', 'center');\n}"},{type:"rect",borderWidth:1,borderColor:"#d4d4d4",rect:[5,5,90,90]},{type:"rect",borderWidth:1,borderColor:"#d4d4d4",borderPattern:[6,6],rect:[27.5,27.5,45,45]},{type:"rect",background:{func:"__ht__function(data, view) {\nvar layoutH = data.a('layout.h');\nif (layoutH === 'left' || layoutH === 'leftright') {\n    return data.a('selectColor');\n}\nreturn '#d4d4d4';\n}",value:"#D4D4D4"},borderColor:"#979797",rect:[8,48,16,4]},{type:"rect",background:{func:"__ht__function(data, view) {\nvar layoutH = data.a('layout.h');\nif (layoutH === 'right' || layoutH === 'leftright') {\n    return data.a('selectColor');\n}\nreturn '#d4d4d4';\n}",value:"#D8D8D8"},borderColor:"#979797",rect:[76,48,16,4]},{type:"rect",background:{func:"__ht__function(data, view) {\nvar layoutH = data.a('layout.h');\nif (layoutH === 'center') {\n    return data.a('selectColor');\n}\nreturn '#d4d4d4';\n}",value:"#D8D8D8"},borderColor:"#979797",rect:[34,48,32,4],onDown:"__ht__function(event, data, view, point, width, height) {\ndata.a('layout.h', 'center');\n}"},{type:"rect",background:{func:"__ht__function(data, view) {\nvar layoutV = data.a('layout.v');\nif (layoutV === 'bottom' || layoutV === 'topbottom') {\n    return data.a('selectColor');\n}\nreturn '#d4d4d4';\n}",value:"#D8D8D8"},borderColor:"#979797",rect:[48,76,4,16]},{type:"rect",background:{func:"__ht__function(data, view) {\nvar layoutV = data.a('layout.v');\nif (layoutV === 'top' || layoutV === 'topbottom') {\n    return data.a('selectColor');\n}\nreturn '#d4d4d4';\n}",value:"#D8D8D8"},borderColor:"#979797",rect:[48,8,4,16]},{type:"rect",background:{func:"__ht__function(data, view) {\nvar layoutV = data.a('layout.v');\nif (layoutV === 'center') {\n    return data.a('selectColor');\n}\nreturn '#d4d4d4';\n}",value:"#D8D8D8"},borderColor:"#979797",rect:[48,34,4,32],onDown:"__ht__function(event, data, view, point, width, height) {\ndata.a('layout.v', 'center');\n}"},{type:"rect",background:{func:"__ht__function(data, view) {\nif (data.a('layout.h') === 'center' || data.a('layout.v')  === 'center') {\n    return data.a('selectColor');\n}\nreturn '#d4d4d4';\n}",value:"#D8D8D8"},borderColor:"#979797",rect:[48,48,4,4]}]}))),ht.Default.setImage("editor.attachPoint",{width:10,height:10,boundExtend:1,comps:[{type:"shape",borderWidth:1,background:{func:"attr@selectColor",value:"rgb(51,153,255)"},borderColor:{func:"attr@selectColor",value:"rgb(51,153,255)"},closePath:!0,points:[5,0,0,5,5,10,10,5]}]}),ht.Default.setImage("editor.debug",{width:16,height:16,comps:[{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",pixelPerfect:!0,points:[7.94786,14.04023,7.94786,14.04023,5.74115,14.04023,3.96501,12.19542,3.96501,9.90337,3.96501,5.76652,11.98452,5.76652,11.98452,9.90337,11.9307,12.19542,10.15457,14.04023,7.94786,14.04023,12.60426,13.98532,12.60426,13.11086,12.16217,12.33113,11.46956,11.86165,11.95932,6.90006,12.73466,6.45216,13.26319,5.60927,13.26319,4.65313,13.26319,4.65313,3.34528,13.98532,3.34528,13.13137,3.76687,12.36776,4.43165,11.8952,1.94907,9.37134,3.96309,9.37134,3.93694,6.8475,3.19558,6.38817,2.74126,5.57307,2.74126,4.65313,2.74126,4.65313,10.93997,4.92497,5.00957,4.92497,5.00957,3.27764,6.32743,1.95977,7.97477,1.95977,9.6221,1.95977,10.93997,3.27764,10.93997,4.92497,10.93997,4.92497,7.97477,13.98532,7.97477,7.94509,12.03691,9.37134,14.05093,9.37134],segments:[1,2,4,2,2,2,4,5,1,4,1,4,2,1,4,1,2,1,4,2,1,2,4,4,2,5,1,2,1,2]}]}),ht.Default.setImage("editor.display.rect",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rect:[2.5,1.5,11,13]}]}),ht.Default.setImage("editor.display.oval",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"circle",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rect:[1,1,14,14]}]}),ht.Default.setImage("editor.display.roundrect",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"roundRect",borderWidth:1,borderColor:"rgb(138,138,138)",cornerRadius:2.5,shadowColor:"#1ABC9C",rect:[2.5,1,11,14]}]}),ht.Default.setImage("editor.display.triangle",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,
borderColor:"rgb(138,138,138)",borderCap:"round",rotation:4.71239,points:[1.00872,1,14.99345,8,.99345,15,1.00872,1]}]}),ht.Default.setImage("editor.display.polygon",{width:16,height:16,comps:[{type:"polygon",rect:[1,1,14,14],borderColor:"white",borderWidth:1}]}),ht.Default.setImage("editor.display.star",{width:16,height:16,comps:[{type:"star",rect:[1,1,14,14],borderColor:"white",borderWidth:1}]}),ht.Default.setImage("editor.display.arc",{width:16,height:16,comps:[{type:"arc",rect:[1,1,14,14],arcFrom:0,arcTo:4.1888,borderColor:"white",borderWidth:1}]}),ht.Default.setImage("editor.display.shape",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"arc",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:-2.35619,rect:[6.45666,.50222,10,8]},{type:"oval",background:"rgb(138,138,138)",borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:-2.35619,rect:[4.92983,8.48004,2.48323,2.47136]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",rotation:-2.35619,points:[.71918,15.84031,-.26373,13.78,4.61411,6.85806,4.66212,13.2497,4.61411,6.85806,9.56535,13.77996,8.58245,15.84028]}]}),ht.Default.setImage("editor.display.node",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[1.5,9.38462,14.5,9.38462,14.5,11.23077,14.5,2,1.5,2,1.5,11.23077,14.5,11.23077,7.07143,11.23077,5,15,11,15,8.92857,11.23077]}]}),ht.Default.setImage("editor.display.group",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[13,12.5,13,10.54,3,10.54,13,10.54,13,5.5,3,5.5,3,12.5,13,12.5,7,12.5,5.85714,15.5,10.14287,15.5,9,12.5]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[15.5,15.5,.5,15.5,.5,.5,6.92857,.5,8,2.19286,15.5,2.19286,15.5,15.5]}]}),ht.Default.setImage("editor.display.edge",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"circle",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rect:[.69044,.97071,4,4.00837]},{type:"circle",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rect:[11.27696,10.99163,4,4.00837]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",points:[4.35933,3.02819,7.84441,2.9749,7.84441,12.99581,11.64067,12.99581]}]}),ht.Default.setImage("editor.display.text",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[1,15,8.06501,1,15,15,12.38059,9.8,4.10171,9.8]}]}),ht.Default.setImage("editor.display.subgraph",{gridThickColor:"rgb(191,191,191)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(207,207,207)",visible:!1,closePath:!0,points:[2.81788,9.09381,2.81788,9.09381,1.38027,6.92868,3.20223,5.43826,5.02418,3.94784,6.51488,5.43826,6.51488,5.43826,6.51488,5.43826,7.61273,3.06338,10.74281,3.94784,13.87289,4.8323,13.18212,9.09381,13.18212,9.09381,13.18212,9.09381,15.5,9.8671,15.5,11.92851,15.5,13.6866,14.14811,14.93662,13.18212,14.93662,2.81788,14.93662,1.83057,14.93662,.5,13.65558,.5,11.92851,.5,9.92221,2.81788,9.09381,2.81788,9.09381],segments:[1,4,4,4,4,4,4,2,4,4]},{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rect:[4.99379,5.52777,6,4.47223]},{type:"circle",background:"rgb(138,138,138)",borderColor:"rgb(138,138,138)",visible:!1,shadowColor:"#1ABC9C",rect:[4,6.43826,2,2]},{type:"arc",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",arcFrom:3.15905,arcTo:5.5676,arcClose:!1,visible:!1,shadowColor:"#1ABC9C",rect:[2.5,3.11794,5,5]},{type:"arc",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",arcFrom:3.57792,arcTo:6.6497,arcClose:!1,visible:!1,shadowColor:"#1ABC9C",rect:[5.63862,1.53868,9.36138,7.15852]},{type:"arc",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",arcFrom:1.5708,arcTo:3.87463,arcClose:!1,visible:!1,shadowColor:"#1ABC9C",rect:[-1,6.56338,8.99379,5.93662]},{type:"arc",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",arcFrom:5.00909,arcTo:1.5708,arcClose:!1,visible:!1,shadowColor:"#1ABC9C",rect:[8.00621,6.56338,8.99379,5.93662]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",visible:!1,points:[3.4969,12.5,12.5031,12.5]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",points:[9.72,12.5,8,10,6.34,12.5]},{type:"circle",background:"rgb(138,138,138)",borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",displayName:"\u5706\u5f62",rect:[0,0,2,2]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderJoin:"miter",points:[15,15.5,8.02409,15.5,8.02409,14,8.02409,15.5,1,15.5]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",closePath:!0,points:[2.81167,6.59481,2.81167,6.59481,1.80439,4.03022,3.39379,2.90023,4.98319,1.77025,6.47379,2.90023,6.47379,2.90023,6.47379,2.90023,7.60652,.5,10.7366,1.3939,13.86668,2.28781,13.17591,6.59481,13.17591,6.59481,13.17591,6.59481,15.49379,7.37636,15.49379,9.45978,15.49379,11.23663,14.1419,12.5,13.17591,12.5,2.81167,12.5,1.82436,12.5,.49379,11.20528,.49379,9.45978,.49379,7.43206,2.81167,6.59481,2.81167,6.59481],segments:[1,4,4,4,4,4,4,2,4,4]}]}),ht.Default.setImage("editor.symbol.rect",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rect:[2.5,1.5,11,13]}]}),ht.Default.setImage("editor.symbol.oval",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"circle",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rect:[1,1,14,14]}]}),ht.Default.setImage("editor.symbol.roundrect",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"roundRect",borderWidth:1,borderColor:"rgb(138,138,138)",cornerRadius:2.5,shadowColor:"#1ABC9C",rect:[2.5,1,11,14]}]}),ht.Default.setImage("editor.symbol.triangle",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",rotation:4.71239,points:[1.00872,1,14.99345,8,.99345,15,1.00872,1]}]}),ht.Default.setImage("editor.symbol.polygon",{width:16,height:16,comps:[{type:"polygon",rect:[1,1,14,14],borderColor:"white",borderWidth:1}]}),ht.Default.setImage("editor.symbol.star",{width:16,height:16,comps:[{type:"star",rect:[1,1,14,14],borderColor:"white",borderWidth:1}]}),ht.Default.setImage("editor.symbol.arc",{width:16,height:16,comps:[{type:"arc",rect:[1,1,14,14],arcFrom:0,arcTo:4.1888,borderColor:"white",borderWidth:1}]}),ht.Default.setImage("editor.symbol.image",{background:"rgb(156,156,156)",width:16,height:16,comps:[{type:"rect",borderWidth:1,borderColor:"rgb(255,255,255)",rect:[.5,1.96,15,12]},{type:"circle",background:"rgb(255,255,255)",borderColor:"rgb(255,255,255)",rect:[3.32103,4.48721,1.5,1.5]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",points:[2.18757,9.112,6.11684,9.112,7.77072,10.39241,9.50807,13.68975,9.69338,14.04145,9.04982,12.34611,7.45717,10.69236,7.45717,10.69236,8.72728,5.98721,14.05092,5.98721],segments:[1,4,4,4]}]}),ht.Default.setImage("editor.symbol.shape",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"arc",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:-2.35619,rect:[6.45666,.50222,10,8]},{type:"oval",background:"rgb(138,138,138)",borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:-2.35619,rect:[4.92983,8.48004,2.48323,2.47136]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",rotation:-2.35619,points:[.71918,15.84031,-.26373,13.78,4.61411,6.85806,4.66212,13.2497,4.61411,6.85806,9.56535,13.77996,8.58245,15.84028]}]}),ht.Default.setImage("editor.symbol.border",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",points:[.5,6.01503,.5,2,15.48868,2,15.5,14,.5,14,.5,10]}]}),ht.Default.setImage("editor.symbol.text",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[1,15,8.06501,1,15,15,12.38059,9.8,4.10171,9.8]}]}),ht.Default.setImage("editor.symbol.piechart",{background:"rgb(97,97,97)",width:16,height:16,comps:[{type:"arc",borderWidth:1,borderColor:"rgb(255,255,255)",arcFrom:.5236,arcTo:4.71239,rect:[.53628,2.06928,13.08634,13.08634]},{type:"arc",borderWidth:1,borderColor:"rgb(255,255,255)",arcFrom:4.71239,arcTo:.5236,rect:[2.37737,1,13.08634,13.08634]}]}),ht.Default.setImage("editor.symbol.onedimensionalcolumnchart",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[3.42625,5.95042,3,9.04958]},{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[10.00543,1,3,14]}]}),ht.Default.setImage("editor.symbol.columnchart",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[1,9,3,6]},{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[4,5.95042,3,9.04958]},{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[9,1,3,14]},{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[12,10.93747,3,4.06253]}]}),ht.Default.setImage("editor.symbol.linechart",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",points:[1,14,5,7,11,8,15,2]}]}),ht.Default.setImage("editor.point.mirrored",{width:30,height:30,fitSize:!1,comps:[{type:"arc",background:"rgb(202,235,248)",borderWidth:2,borderColor:"rgb(17,158,216)",arcClose:!1,rect:[3.5,10.30081203536023,23,25.3726296254234]},{type:"oval",background:"rgb(255,255,255)",borderWidth:2,borderColor:"rgb(51,51,51)",rect:[12,7.300812035360231,6,6]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[17.842265898626422,9.310233818119592,9.826713258365732,2]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[24.713262902082427,8.310233818119592,3,4]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[2.4018068742542837,9.30081203536023,9.826713258365732,2]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[2.286737097917573,8.310233818119592,3,4]}]}),ht.Default.setImage("editor.point.straight",{width:30,height:30,fitSize:!1,comps:[{type:"shape",background:"rgb(200,234,247)",borderWidth:2,borderColor:"rgb(17,160,217)",points:[26.974999999999998,23.185840967335317,15.133692185007973,10.275109094255685,3.0250000000000004,23.185840967335317]},{type:"oval",background:"rgb(255,255,255)",borderWidth:2,borderColor:"rgb(51,51,51)",rect:[12,7.561327956066684,6,6]}]}),ht.Default.setImage("editor.point.disconnected",{width:30,height:30,fitSize:!1,comps:[{type:"shape",background:"rgb(200,234,247)",borderWidth:2,borderColor:"rgb(17,160,217)",points:[3.1940148593724587,22.95774078992803,3.1940148593724587,18.139874123261343,7.6015038461565965,10.497740789928038,14.542032480517832,10.497740789928038,26.80598514062754,22.95774078992803],segments:[1,4,2]},{type:"oval",background:"rgb(255,255,255)",borderWidth:2,borderColor:"rgb(51,51,51)",rect:[12.093814401372779,7.5391087731804305,6,6]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rotation:.7853981633974483,rect:[16.36973009802768,14.555043156001322,9.826713258365732,2]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rotation:.7853981633974483,rect:[22.831111406474626,16.51363217953681,3,4]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[2.2671011430070465,9.53910877318043,9.826713258365732,2]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[2.152031366670336,8.548530555939791,3,4]}]}),ht.Default.setImage("editor.point.asymmetric",{width:30,height:30,fitSize:!1,comps:[{type:"shape",background:"rgb(200,234,247)",borderWidth:2,borderColor:"rgb(17,160,217)",points:[3.5000000000000027,22.974997694265234,3.5000000000000027,17.50768540873153,5.131816608669447,11.637417102180905,12.400695544362113,11.637417102180905,22.516641067164265,11.637417102180905,26.5,22.974997694265234,26.5,22.974997694265234],segments:[1,4,4]},{type:"oval",background:"rgb(255,255,255)",borderWidth:2,borderColor:"rgb(51,51,51)",rect:[9.324670579660944,7.637417102180905,6,6]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[3.405482351035767,9.637417102180905,6.540642002660807,2]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[2.7221578598514142,8.637417102180905,3,4]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[15.278596259040164,9.637417102180905,11.965262549245955,2]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[24.731262324024406,8.637417102180905,3,4]}]}),ht.Default.setImage("editor.layout.circular",{width:16,height:16,comps:[{type:"shape",background:"white",points:[7,2,7,4,9,4,9,2,2,7,2,9,4,9,4,7,12,7,12,9,14,9,14,7,4,12,4,14,6,14,6,12,10,12,10,14,12,14,12,12],segments:[1,2,2,2,1,2,2,2,1,2,2,2,1,2,2,2,1,2,2,2]},{type:"shape",borderColor:"white",borderWidth:1,points:[8,3,3,8,5,13,11,13,13,8],segments:[1,2,2,2,2,5]}]}),ht.Default.setImage("editor.layout.symmetric",{width:16,height:16,comps:[{type:"shape",background:"white",points:[7,2,7,4,9,4,9,2,2,7,2,9,4,9,4,7,12,7,12,9,14,9,14,7,4,12,4,14,6,14,6,12,10,12,10,14,12,14,12,12],segments:[1,2,2,2,1,2,2,2,1,2,2,2,1,2,2,2,1,2,2,2]},{type:"shape",borderWidth:1,borderColor:"white",points:[8,8,8,3,8,8,3,8,8,8,5,13,8,8,11,13,8,8,13,8],segments:[1,2,1,2,1,2,1,2,1,2]}]}),ht.Default.setImage("editor.layout.hierarchical",{width:16,height:16,comps:[{type:"shape",background:"white",points:[4,3,4,5,6,5,6,3,10,3,10,5,12,5,12,3,1,11,1,13,3,13,3,11,7,11,7,13,9,13,9,11,13,11,13,13,15,13,15,11],segments:[1,2,2,2,1,2,2,2,1,2,2,2,1,2,2,2,1,2,2,2]},{type:"shape",borderColor:"white",borderWidth:1,points:[5,4,2,12,5,4,8,12,5,4,14,12,11,4,2,12,11,4,8,12,11,4,14,12],segments:[1,2,1,2,1,2,1,2,1,2,1,2]}]}),ht.Default.setImage("editor.layout.towardnorth",{width:16,height:16,comps:[{type:"image",name:"editor.layout.towardsouth",rotation:Math.PI,rect:[0,0,16,16]}]}),ht.Default.setImage("editor.layout.towardsouth",{width:16,height:16,comps:[{type:"shape",background:"white",points:[7,3,7,5,9,5,9,3,1,11,1,13,3,13,3,11,7,11,7,13,9,13,9,11,13,11,13,13,15,13,15,11],segments:[1,2,2,2,1,2,2,2,1,2,2,2,1,2,2,2]},{type:"shape",borderColor:"white",borderWidth:1,points:[8,4,2,12,8,4,8,12,8,4,14,12],segments:[1,2,1,2,1,2]}]}),ht.Default.setImage("editor.layout.towardeast",{width:16,height:16,comps:[{type:"image",name:"editor.layout.towardsouth",rotation:.5*-Math.PI,rect:[0,0,16,16]}]}),ht.Default.setImage("editor.layout.towardwest",{width:16,height:16,comps:[{type:"image",name:"editor.layout.towardsouth",rotation:.5*Math.PI,rect:[0,0,16,16]}]}),ht.Default.setImage("editor.align.distributehorizontal",{background:"rgb(150,150,150)",width:16,height:16,comps:[{type:"shape",points:[2,2,2,14,14,2,14,14],segments:[1,2,1,2],borderWidth:1,borderCap:"round",borderColor:{func:function(){return KR.config.color_dark}}},{type:"shape",points:[8,5,8,11],borderWidth:3,borderCap:"round",borderColor:{func:function(){return KR.config.color_select}}}]}),ht.Default.setImage("editor.align.distributevertical",{background:"rgb(150,150,150)",width:16,height:16,comps:[{type:"shape",points:[2,2,14,2,2,14,14,14],segments:[1,2,1,2],borderWidth:1,borderCap:"round",borderColor:{func:function(){return KR.config.color_dark}}},{type:"shape",points:[5,8,11,8],borderWidth:3,borderCap:"round",borderColor:{func:function(){return KR.config.color_select}}}]}),ht.Default.setImage("editor.align.alignleft",{background:"rgb(150,150,150)",width:16,height:16,comps:[{type:"shape",points:[2,2,2,14],segments:[1,2],borderWidth:1,borderCap:"round",borderColor:{func:function(){return KR.config.color_dark}}},{type:"shape",points:[5,5,13,5,5,11,8,11],segments:[1,2,1,2],borderWidth:3,borderCap:"round",borderColor:{func:function(){return KR.config.color_select}}}]}),ht.Default.setImage("editor.align.alignhorizontal",{background:"rgb(150,150,150)",width:16,height:16,comps:[{type:"shape",points:[8,2,8,14],segments:[1,2],borderWidth:1,borderCap:"round",borderColor:{func:function(){return KR.config.color_dark}}},{type:"shape",points:[3,5,13,5,6,11,10,11],segments:[1,2,1,2],borderWidth:3,borderCap:"round",borderColor:{func:function(){return KR.config.color_select}}}]}),ht.Default.setImage("editor.align.alignright",{background:"rgb(150,150,150)",width:16,height:16,comps:[{type:"shape",points:[14,2,14,14],segments:[1,2],borderWidth:1,borderCap:"round",borderColor:{func:function(){return KR.config.color_dark}}},{type:"shape",points:[3,5,11,5,11,11,8,11],segments:[1,2,1,2],borderWidth:3,borderCap:"round",borderColor:{func:function(){return KR.config.color_select}}}]}),ht.Default.setImage("editor.align.aligntop",{background:"rgb(150,150,150)",width:16,height:16,comps:[{type:"shape",points:[2,2,14,2],segments:[1,2],borderWidth:1,borderCap:"round",borderColor:{func:function(){return KR.config.color_dark}}},{type:"shape",points:[5,5,5,13,11,5,11,8],segments:[1,2,1,2],borderWidth:3,borderCap:"round",borderColor:{func:function(){return KR.config.color_select}}}]}),ht.Default.setImage("editor.align.alignvertical",{background:"rgb(150,150,150)",width:16,height:16,comps:[{type:"shape",points:[2,8,14,8],segments:[1,2],borderWidth:1,borderCap:"round",borderColor:{func:function(){return KR.config.color_dark}}},{type:"shape",points:[5,3,5,13,11,6,11,10],segments:[1,2,1,2],borderWidth:3,borderCap:"round",borderColor:{func:function(){return KR.config.color_select}}}]}),ht.Default.setImage("editor.align.alignbottom",{background:"rgb(150,150,150)",width:16,height:16,comps:[{type:"shape",points:[2,14,14,14],segments:[1,2],borderWidth:1,borderCap:"round",borderColor:{func:function(){return KR.config.color_dark}}},{type:"shape",points:[5,3,5,11,11,11,11,8],segments:[1,2,1,2],borderWidth:3,borderCap:"round",borderColor:{func:function(){return KR.config.color_select}}}]});var aR=function(){return!0};pH("editor.layout.circular"),pH("editor.layout.symmetric"),pH("editor.layout.hierarchical"),pH("editor.layout.towardnorth"),pH("editor.layout.towardsouth"),pH("editor.layout.towardeast"),pH("editor.layout.towardwest"),pH("editor.root"),pH("editor.bind",aR),pH("editor.unbind"),pH("editor.dir"),pH("editor.dxf"),pH("editor.obj"),pH("editor.mtl"),pH("editor.ui-tab"),pH("editor.ttf"),pH("editor.otf"),pH("editor.sound"),pH("editor.video"),pH("editor.resetsize"),pH("editor.restore"),pH("editor.js"),ht.Data.prototype.$49$=fH,ht.Data.prototype.$50$=function(i){return this._refGraph?[]:[NH.call(this,i),DH]},ht.Node.prototype.$49$=kH,ht.Node.prototype.$50$=function(i){return this._refGraph?[]:[nH.call(this,i),GH]},ht.Edge.prototype.$49$=vH,ht.Edge.prototype.$50$=function(i){return this._refGraph?[]:[PH.call(this,i),ZH]},ht.Group.prototype.$50$=function(i){return this._refGraph?[]:[aH.call(this,i),FH]},ht.Shape.prototype.$50$=function(i){return this._refGraph?[]:[wH.call(this,i),BH]},ht.Block.prototype.$50$=function(i){return this._refGraph?[]:[EH.call(this,i),_H]},ht.RefGraph.prototype.$50$=function(i){return this._refGraph?[]:[xH.call(this,i),jH]},ht.Points.prototype.$50$=function(i){return this._refGraph?[]:[YH.call(this,i),rH]};var FR=function(i){function H(R,M,I){hR(this,H);var p=CR(this,i.call(this));return p.parse(R,M,I),p}return dR(H,i),H.prototype.getClass=function(){return H},H.prototype.toLabel=function(){return this.getDisplayName()||p("editor.comptype."+this.s("shape").toLowerCase())},H.prototype.parse=function(i,H,R){i&&(xi(this,"shape",i.type,"rect"),xi(this,"shape.background",i.background,null),xi(this,"shape.repeat.image",i.repeatImage),xi(this,"shape.border.width",i.borderWidth),xi(this,"shape.border.color",i.borderColor,null),xi(this,"shape.border.3d",i.border3d),xi(this,"shape.border.3d.color",i.border3dColor),xi(this,"shape.border.3d.accuracy",i.border3dAccuracy),xi(this,"shape.border.cap",i.borderCap),xi(this,"shape.border.join",i.borderJoin),xi(this,"shape.border.pattern",i.borderPattern),xi(this,"shape.gradient",i.gradient),xi(this,"shape.gradient.color",i.gradientColor),xi(this,"shape.dash",i.dash),xi(this,"shape.dash.pattern",i.dashPattern),xi(this,"shape.dash.offset",i.dashOffset),xi(this,"shape.dash.color",i.dashColor),xi(this,"shape.dash.width",i.dashWidth),xi(this,"shape.dash.3d",i.dash3d),xi(this,"shape.dash.3d.color",i.dash3dColor),xi(this,"shape.dash.3d.accuracy",i.dash3dAccuracy),xi(this,"shape.border.width.absolute",i.borderWidthAbsolute),xi(this,"shape.gradient.pack",i.gradientPack),xi(this,"shape.border.gradient.pack",i.borderGradientPack),xi(this,"shape.fill.clip.direction",i.fillClipDirection),xi(this,"shape.fill.clip.percentage",i.fillClipPercentage),"rect"===this.compType?xi(this,"shape.depth",i.depth):"roundRect"===this.compType?xi(this,"shape.corner.radius",i.cornerRadius):"polygon"===this.compType?xi(this,"shape.polygon.side",i.polygonSide):"arc"===this.compType&&(xi(this,"shape.arc.from",i.arcFrom),xi(this,"shape.arc.to",i.arcTo),xi(this,"shape.arc.close",i.arcClose),xi(this,"shape.arc.oval",i.arcOval)),Ei(this,i,H,R))},H.prototype.toJSON=function(){var i={};return vi(this,i,"shape","type",void 0),vi(this,i,"shape.background","background",null),vi(this,i,"shape.repeat.image","repeatImage"),vi(this,i,"shape.border.width","borderWidth"),vi(this,i,"shape.border.color","borderColor",null),vi(this,i,"shape.border.3d","border3d"),vi(this,i,"shape.border.3d.color","border3dColor"),vi(this,i,"shape.border.3d.accuracy","border3dAccuracy"),vi(this,i,"shape.border.cap","borderCap"),vi(this,i,"shape.border.join","borderJoin"),vi(this,i,"shape.border.pattern","borderPattern"),vi(this,i,"shape.gradient","gradient"),vi(this,i,"shape.gradient.color","gradientColor"),vi(this,i,"shape.dash","dash"),vi(this,i,"shape.dash.pattern","dashPattern"),vi(this,i,"shape.dash.offset","dashOffset"),vi(this,i,"shape.dash.color","dashColor"),vi(this,i,"shape.dash.width","dashWidth"),vi(this,i,"shape.dash.3d","dash3d"),vi(this,i,"shape.dash.3d.color","dash3dColor"),vi(this,i,"shape.dash.3d.accuracy","dash3dAccuracy"),vi(this,i,"shape.gradient.pack","gradientPack"),vi(this,i,"shape.border.gradient.pack","borderGradientPack"),vi(this,i,"shape.border.width.absolute","borderWidthAbsolute"),vi(this,i,"shape.fill.clip.direction","fillClipDirection"),vi(this,i,"shape.fill.clip.percentage","fillClipPercentage"),"rect"===this.compType?vi(this,i,"shape.depth","depth"):"roundRect"===this.compType?vi(this,i,"shape.corner.radius","cornerRadius"):"polygon"===this.compType?vi(this,i,"shape.polygon.side","polygonSide"):"arc"===this.compType&&(vi(this,i,"shape.arc.from","arcFrom"),vi(this,i,"shape.arc.to","arcTo"),vi(this,i,"shape.arc.close","arcClose"),vi(this,i,"shape.arc.oval","arcOval")),_i(this,i),i},zR(H,[{key:"compType",get:function(){return this.s("shape")}}]),H}(ht.Node),wR=function(i){function H(R,M,I){hR(this,H);var p=CR(this,i.call(this));return p.parse(R,M,I),p}return dR(H,i),H.prototype.getClass=function(){return H},H.prototype.toLabel=function(){return this.getDisplayName()||p("editor.comptype.shape")},H.prototype.parse=function(i,H,R){i&&(xi(this,"type",i.type,"shape"),xi(this,"shape.background",i.background,null),xi(this,"shape.repeat.image",i.repeatImage),xi(this,"shape.border.width",i.borderWidth),xi(this,"shape.border.color",i.borderColor,null),xi(this,"shape.border.3d",i.border3d),xi(this,"shape.border.3d.color",i.border3dColor),xi(this,"shape.border.3d.accuracy",i.border3dAccuracy),xi(this,"shape.border.cap",i.borderCap),xi(this,"shape.border.join",i.borderJoin),xi(this,"shape.border.pattern",i.borderPattern),xi(this,"shape.gradient",i.gradient),xi(this,"shape.gradient.color",i.gradientColor),xi(this,"shape.dash",i.dash),xi(this,"shape.dash.pattern",i.dashPattern),xi(this,"shape.dash.offset",i.dashOffset),xi(this,"shape.dash.color",i.dashColor),xi(this,"shape.dash.width",i.dashWidth),xi(this,"shape.dash.3d",i.dash3d),xi(this,"shape.dash.3d.color",i.dash3dColor),xi(this,"shape.dash.3d.accuracy",i.dash3dAccuracy),xi(this,"shape.fill.rule",i.fillRule),xi(this,"shape.fill.clip.direction",i.fillClipDirection),xi(this,"shape.fill.clip.percentage",i.fillClipPercentage),xi(this,"shape.gradient.pack",i.gradientPack),xi(this,"shape.border.gradient.pack",i.borderGradientPack),xi(this,"shape.border.width.absolute",i.borderWidthAbsolute),Ei(this,i,H,R),si(this,i),this.setPoints(Vi($i(i.points))),this.setSegments($i(i.segments)))},H.prototype.toJSON=function(){var i={};if(vi(this,i,"type","type",void 0),vi(this,i,"shape.background","background",null),vi(this,i,"shape.repeat.image","repeatImage"),vi(this,i,"shape.border.width","borderWidth"),vi(this,i,"shape.border.color","borderColor",null),vi(this,i,"shape.border.3d","border3d"),vi(this,i,"shape.border.3d.color","border3dColor"),vi(this,i,"shape.border.3d.accuracy","border3dAccuracy"),vi(this,i,"shape.border.cap","borderCap"),vi(this,i,"shape.border.join","borderJoin"),vi(this,i,"shape.border.pattern","borderPattern"),vi(this,i,"shape.gradient","gradient"),vi(this,i,"shape.gradient.color","gradientColor"),vi(this,i,"shape.dash","dash"),vi(this,i,"shape.dash.pattern","dashPattern"),vi(this,i,"shape.dash.offset","dashOffset"),vi(this,i,"shape.dash.color","dashColor"),vi(this,i,"shape.dash.width","dashWidth"),vi(this,i,"shape.dash.3d","dash3d"),vi(this,i,"shape.dash.3d.color","dash3dColor"),vi(this,i,"shape.dash.3d.accuracy","dash3dAccuracy"),vi(this,i,"shape.fill.rule","fillRule"),vi(this,i,"shape.fill.clip.direction","fillClipDirection"),vi(this,i,"shape.fill.clip.percentage","fillClipPercentage"),vi(this,i,"shape.gradient.pack","gradientPack"),vi(this,i,"shape.border.gradient.pack","borderGradientPack"),vi(this,i,"shape.border.width.absolute","borderWidthAbsolute"),_i(this,i),Zi(this,i),Bi(i,"points",this.a("points"),Ai(this.getPoints())),this.getSegments()){var H=this.getSegments().toArray();if(H.length){var R=1===H[0];if(R)for(var M=1;M<H.length;M++)if(2!==H[M]){R=!1;break}R||Bi(i,"segments",this.a("segments"),H)}}return i},zR(H,[{key:"compType",get:function(){return this.s("type")}}]),H}(ht.Shape),BR=function(i){function H(R,M,I){hR(this,H);var p=CR(this,i.call(this));return p.parse(R,M,I),p}return dR(H,i),H.prototype.getClass=function(){return H},H.prototype.toLabel=function(){if(this.getDisplayName())return this.getDisplayName();var i=this.s("image");return i&&i.length<100?i:p("editor.comptype.image")},H.prototype.onStyleChanged=function(H,R,M){i.prototype.onStyleChanged.call(this,H,R,M),"image"===H&&this.setImage(M)},H.prototype.parse=function(i,H,R){i&&(xi(this,"type",i.type,"image"),xi(this,"body.color",i.color),xi(this,"image.stretch",i.stretch),xi(this,"image",i.name,"node_image"),Ei(this,i,H,R))},H.prototype.toJSON=function(){var i={};return vi(this,i,"type","type",void 0),vi(this,i,"body.color","color"),vi(this,i,"image.stretch","stretch"),vi(this,i,"image","name"),_i(this,i),i},zR(H,[{key:"compType",get:function(){return this.s("type")}}]),H}(ht.Node),ER=function(i){function H(R,M,I){hR(this,H);var p=CR(this,i.call(this));return p.parse(R,M,I),p}return dR(H,i),H.prototype.getClass=function(){return H},H.prototype.toLabel=function(){return this.getDisplayName()||this.s("text")||p("editor.comptype.text")},H.prototype.parse=function(i,H,R){i&&(xi(this,"type",i.type,"text"),xi(this,"text",i.text),xi(this,"text.align",i.align),xi(this,"text.vAlign",i.vAlign),xi(this,"text.color",i.color),xi(this,"text.gradient",i.gradient),xi(this,"text.gradient.color",i.gradientColor),xi(this,"text.gradient.pack",i.gradientPack),xi(this,"text.font",i.font),xi(this,"text.shadow",i.shadow),xi(this,"text.shadow.color",i.shadowColor),xi(this,"text.shadow.blur",i.shadowBlur),xi(this,"text.shadow.offset.x",i.shadowOffsetX),xi(this,"text.shadow.offset.y",i.shadowOffsetY),xi(this,"text.vertical",i.vertical),xi(this,"text.vertical.gap",i.verticalGap),xi(this,"text.decoration",i.textDecoration),Ei(this,i,H,R))},H.prototype.toJSON=function(){var i={};return vi(this,i,"type","type",void 0),vi(this,i,"text","text"),vi(this,i,"text.align","align"),vi(this,i,"text.vAlign","vAlign"),vi(this,i,"text.color","color"),vi(this,i,"text.gradient","gradient"),vi(this,i,"text.gradient.color","gradientColor"),vi(this,i,"text.gradient.pack","gradientPack"),vi(this,i,"text.font","font"),vi(this,i,"text.shadow","shadow"),vi(this,i,"text.shadow.color","shadowColor"),vi(this,i,"text.shadow.blur","shadowBlur"),vi(this,i,"text.shadow.offset.x","shadowOffsetX"),vi(this,i,"text.shadow.offset.y","shadowOffsetY"),vi(this,i,"text.vertical","vertical"),vi(this,i,"text.vertical.gap","verticalGap"),vi(this,i,"text.decoration","textDecoration"),_i(this,i),i},zR(H,[{key:"compType",get:function(){return this.s("type")}}]),H}(ht.Text),_R=function(i){function H(R,M,I){hR(this,H);var p=CR(this,i.call(this));return p.s({"shape.border.color":"red","shape.border.width":1,"shape.background":null}),p.parse(R,M,I),p.setClosePath(!0),p}return dR(H,i),H.prototype.getClass=function(){return H},H.prototype.toLabel=function(){return this.getDisplayName()||p("editor.comptype.clip")},H.prototype.parse=function(i,H,R){i&&(xi(this,"type",i.type,"clip"),Ei(this,i,H,R),this.setPoints(Vi($i(i.points))),this.setSegments($i(i.segments)))},H.prototype.toJSON=function(){var i={};if(vi(this,i,"type","type",void 0),_i(this,i),Bi(i,"points",this.a("points"),Ai(this.getPoints())),this.getSegments()){var H=this.getSegments().toArray();if(H.length){var R=1===H[0];if(R)for(var M=1;M<H.length;M++)if(2!==H[M]){R=!1;break}R||Bi(i,"segments",this.a("segments"),H)}}return i},zR(H,[{key:"compType",get:function(){return this.s("type")}}]),H}(ht.Shape),xR=function(i){function H(R,M,I){hR(this,H);var p=CR(this,i.call(this));return p.parse(R,M,I),p}return dR(H,i),H.prototype.getClass=function(){return H},H.prototype.toLabel=function(){return this.getDisplayName()||p("editor.comptype.restore")},H.prototype.parse=function(i,H,R){i&&xi(this,"type",i.type,"restore")},H.prototype.toJSON=function(){var i={};return vi(this,i,"type","type",void 0),i},zR(H,[{key:"compType",get:function(){return this.s("type")}}]),H}(ht.Node),jR=function(i){function H(){return hR(this,H),CR(this,i.call(this))}return dR(H,i),H}(ht.widget.BorderPane),YR=function(i){function H(R){return hR(this,H),CR(this,i.call(this,R))}return dR(H,i),H}(ht.widget.ContextMenu),rR=function(i){function H(R){return hR(this,H),CR(this,i.call(this,R))}return dR(H,i),H.prototype.adjustZoom=function(i){return i>KR.config.maxZoom?KR.config.maxZoom:i<KR.config.minZoom?KR.config.minZoom:i},H.prototype.getUnionNodeRect=function(i){var H=this,R=void 0;return i=i._as||i,i.forEach(function(i){i instanceof ht.Node&&(R=A(R,H.getNodeRect(i)))}),R},H.prototype.$63$=function(i){this.validate();var H=this.getViewRect(),R=this.getUnionNodeRect(i);if(!H||!R||ht.Default.intersectsRect(H,R))return null;var M=H.x+H.width/2-R.x-R.width/2,I=H.y+H.height/2-R.y-R.height/2;return this.moveDatas(i,M,I),{x:M,y:I}},H.prototype.getFullscreenDatas=function(){return null},H}(ht.graph.GraphView),eR=function(i){function H(R){return hR(this,H),CR(this,i.call(this,R))}return dR(H,i),H}(ht.widget.ListView),sR=function(i){function H(R){hR(this,H);var M=CR(this,i.call(this,R));return M.getView().style.background=KR.config.color_pane_dark,M.setMaskBackground(null),M.setContentBorderColor(null),M.setContentBackground("white"),M.getMask().style.border=KR.config.color_select+" solid 1px",M}
return dR(H,i),H}(ht.graph.Overview),WR=function(i){function H(R,M,I,p){hR(this,H);var h=CR(this,i.call(this,R,M,I,p));return h.setTogglable(!1),h}return dR(H,i),H}(ht.widget.SplitView),$R=function(i){function H(R){return hR(this,H),CR(this,i.call(this,R))}return dR(H,i),H}(ht.widget.TablePane),lR=function(i){function H(){return hR(this,H),CR(this,i.call(this))}return dR(H,i),H.prototype.add=function(H,R,M){var I=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],p=i.prototype.add.call(this,H,R,M);return p.setVisible(I),p},H}(ht.widget.TabView),VR=function(i){function H(R){return hR(this,H),CR(this,i.call(this,R))}return dR(H,i),H}(ht.widget.Toolbar),AR=function(i){function H(R){hR(this,H);var M=CR(this,i.call(this,R));return M.setDoubleClickToToggle(!1),M}return dR(H,i),H.prototype.getToggleIcon=function(i){if(this._loader&&!this._loader.isLoaded(i))return this._collapseIcon;var H=i.getChildren(),R=H.size();if(R){for(var M=!1,I=0;I<R;I++)if(this.isVisible(H.get(I))){M=!0;break}if(M)return this.isExpanded(i)?this._expandIcon:this._collapseIcon}},H.prototype.hasExpandedChild=function(i){if(!this.isExpanded(i))return!1;var H=i.getChildren(),R=H.size();if(R)for(var M=0;M<R;M++)if(this.isVisible(H.get(M)))return!0;return!1},zR(H,[{key:"expandIds",get:function(){return Object.keys(this._expandMap)},set:function(i){var H=this;i.forEach(function(i){var R=H.dm().getDataById(i);R&&H.expand(R)})}},{key:"selectionIds",get:function(){var i=[];return this.sm().each(function(H){i.push(H.$33$||H._id)}),i},set:function(i){var H=this,R=[];i.forEach(function(i){var M=H.dm().getDataById(i);M&&R.push(M)}),this.sm().ss(R)}}]),H}(ht.widget.TreeView),gR=function(i){8===i.keyCode&&i.preventDefault()},SR=ht.widget.TextField.prototype.setEditable;ht.widget.TextField.prototype.setEditable=ht.widget.TextArea.prototype.setEditable=function(i){SR.call(this,i);var H=this._element;i?H.removeEventListener("keydown",gR):H.addEventListener("keydown",gR)},function(i,H,R){var M=i.ht,I=M.Default;I.getInternal().addMethod(I,{svgToShape:function(i,H){var R=new M.SvgConverter(H);return{converter:R,output:R.toShape(i)}}});var p=M.Context2dProxy=function(i,H,R){var M=this;M.ctx=i,M.writer=H,M._currentContext={a:1,b:0,c:0,d:1,tx:0,ty:0},M._emptyPath(),M._forceSplitEllipse=!0,M._splitToBezier=R.splitToBezier,M._ellipseSegments=R.segments,M._minimumFontSize=R.minimumFontSize,M._contextStack=[];for(var I in CanvasRenderingContext2D.prototype)if("webkitImageSmoothingEnabled"!==I){var p=i[I];"function"==typeof p&&(i[I]=function(H,R){return function(){try{var I=R.apply(i,arguments);return M.handleFunc(H,I,arguments),I}catch(i){}}}(I,p))}};p.prototype={},p.prototype.constructor=p,p.prototype.handleFunc=function(i,H,R){var M=this;switch(i){case"save":M._ctxSave();break;case"restore":M._ctxRestore();break;case"translate":M._ctxTranslate.apply(M,R);break;case"rotate":M._ctxRotate.apply(M,R);break;case"scale":M._ctxScale.apply(M,R);break;case"setTransform":M._ctxSetTransform.apply(M,R);break;case"transform":M._ctxTransform.apply(M,R);break;case"fillText":case"strokeText":M._ctxText(R[0],R[1],R[2],"fillText"===i);break;case"rect":M._ctxRect.apply(M,R);break;case"fill":M._ctxFill(R[0]);break;case"fillRect":M._ctxRect.apply(M,R),M._ctxDraw("fill");break;case"stroke":M._ctxDraw("stroke");break;case"moveTo":M._ctxMoveTo(R[0],R[1]);break;case"lineTo":M._ctxLineTo(R[0],R[1]);break;case"beginPath":M._ctxBeginPath();break;case"closePath":M._ctxClosePath();break;case"arc":M._ctxArc.apply(M,R);break;case"ellipse":M._ctxEllipse.apply(M,R);break;case"quadraticCurveTo":M._ctxBezier([{x:R[0],y:R[1]}],R[2],R[3]);break;case"bezierCurveTo":M._ctxBezier([{x:R[0],y:R[1]},{x:R[2],y:R[3]}],R[4],R[5]);break;case"createLinearGradient":M._ctxCreateGradient(H,!0,R);break;case"createRadialGradient":M._ctxCreateGradient(H,!1,R);break;case"createPattern":M._ctxCreatePattern(H,R[0],R[1]);break;case"drawImage":M._ctxDrawImage.apply(M,R);break;case"clip":M._ctxClip()}},p.prototype.handleSetter=function(i,H){},p.prototype._ctxSave=function(){var i=this,H={},R=i._currentContext;for(var M in R)H[M]=R[M],"clip"===M&&R[M]&&delete R[M];i._contextStack.push(H)},p.prototype._ctxRestore=function(){var i=this;i._currentContext.clip&&i.writer.addRestore(),i._currentContext=i._contextStack.pop(),i._transformUpdated()},p.prototype._ctxTranslate=function(i,H){if(i=i||0,H=H||0,0!==i||0!==H){var R=this,M=R._currentContext,I=M.a,p=M.b,h=M.c,z=M.d;M.tx=I*i+h*H+M.tx,M.ty=p*i+z*H+M.ty,R._transformUpdated()}},p.prototype._ctxScale=function(i,H){if(i=i||1,H=H||1,1!==i||1!==H){var R=this,M=R._currentContext;M.a*=i,M.b*=i,M.c*=H,M.d*=H,R._transformUpdated()}},p.prototype._ctxRotate=function(i){var H=Math.cos(i),R=Math.sin(i),M=this,I=M._currentContext,p=I.a,h=I.b,z=I.c,d=I.d;I.a=p*H+z*R,I.b=h*H+d*R,I.c=-p*R+z*H,I.d=-h*R+d*H,M._transformUpdated()},p.prototype._ctxSetTransform=function(i,H,R,M,I,p){var h=this,z=h._currentContext;z.a=i,z.b=H,z.c=R,z.d=M,z.tx=I,z.ty=p,h._transformUpdated()},p.prototype._ctxTransform=function(i,H,R,M,I,p){var h=this,z=h._currentContext,d=z.a,C=z.b,y=z.c,b=z.d;z.a=d*i+y*H,z.b=C*i+b*H,z.c=d*R+y*M,z.d=C*R+b*M,z.tx=d*I+y*p+z.tx,z.ty=C*I+b*p+z.ty,h._transformUpdated()},p.prototype._transformUpdated=function(){},p.prototype._calcCurrentRotation=function(){var i=this._currentContext;return 0===i.b&&0===i.c?0:Math.atan2(i.b,i.a)},p.prototype._calcCurrentScale=function(){var i=this._currentContext;return{x:Math.sqrt(i.a*i.a+i.c*i.c),y:Math.sqrt(i.b*i.b+i.d*i.d)}},p.prototype._transformPoint=function(i){var H=this._currentContext,R=i.x,M=i.y;return{x:H.a*R+H.c*M+H.tx,y:H.b*R+H.d*M+H.ty}},p.prototype._transformPoints=function(i){for(var H=this,R=new Array(i.length),M=0,I=i.length;M<I;M++)R[M]=H._transformPoint(i[M]);return R},p.prototype._transformSize=function(i){var H=this._currentContext;return i*Math.max(Math.sqrt(H.c*H.c+H.d*H.d),Math.sqrt(H.a*H.a+H.b*H.b))},p.prototype._equal=function(i,H){var R=i-H;return R>-1e-5&&R<1e-5},p.prototype._getTextFirstPixelLine=function(i,H){var R,M=this._measureTextCanvas;M?R=this._measureTextContext:(M=this._measureTextCanvas=document.createElement("canvas"),R=this._measureTextContext=M.getContext("2d")),R.font=i;var I=Math.ceil(R.measureText("H").width),p=4*I;if(M.width=I,M.height=p,R.fillStyle="#f00",R.fillRect(0,0,I,p),R.textBaseline=H,R.fillStyle="#000",R.font=i,R.fillText("H",0,p/2),!R.getImageData(0,0,I,p))return 0;var h,z,d=R.getImageData(0,0,I,p).data,C=4*I;for(h=0;h<p;h++)for(z=0;z<C;z+=4)if(255!==d[C*h+z])return h;return 0},p.prototype._calcShift=function(i,H,R){var M=this._fontBaselineShiftCache;M||(M=this._fontBaselineShiftCache={});var I=i+H+R,p=M[I];if(p)return p;var h=this._getTextFirstPixelLine(i,H),z=this._getTextFirstPixelLine(i,R);return M[I]=h-z},p.prototype._ctxText=function(i,H,R,M){var I=this,p=I.ctx,h=p.font,z=M?p.fillStyle:p.strokeStyle,d=p.textAlign,C=p.textBaseline;"middle"!==C&&"top"!==C&&"bottom"!==C&&(R-=I._calcShift(h,"middle",C),C="middle");var y,b,U=1,K=I._minimumFontSize;if("string"==typeof h&&(b=h.match(/[\d\.]+/))){y=1*b[0];var q=I._transformSize(y);q<K&&(U=q/K,q=K),h=h.replace(b[0],q)}var Q=I._calcCurrentRotation();"string"==typeof z&&"rgba(0,0,0,0)"===z.replace(/ /g,"")||i.trim().length&&(z={color:z},I._tryConvertAndRecordGradient(z),I.writer.addText(i,I._transformPoint({x:H,y:R}),h,Q,d,C,z,U))},p.prototype._ctxDrawImage=function(i,H,M,I,p,h,z,d,C){if(i.width&&i.height){I===R&&p===R?(h=H,z=M,H=0,M=0,I=d=i.width,p=C=i.height):h===R&&z===R&&(h=H,z=M,d=I,C=p,H=0,M=0,I=i.width,p=i.height);var y=this,b=y._currentContext,U=d/I,K=C/p,q=h-U*H,Q=z-K*M,m=b.a,X=b.b,o=b.c,J=b.d;b.tx,b.ty}},p.prototype._ctxClip=function(){var i=this;i._currentContext.clip=!0,i._ctxDraw("clip")},p.prototype._ctxCreateGradient=function(i,H,R){i.isLinear=H,i.points=H?[R[0],R[1],R[2],R[3]]:[R[0],R[1],R[2],R[3],R[4],R[5]];var M=this._currentContext;i.trans=[M.a,M.b,M.c,M.d,M.tx,M.ty];var I=i.addColorStop;i.addColorStop=function(H,R){I.apply(this,arguments),i.colorStops||(i.colorStops=[]),i.colorStops.push(H,R)}},p.prototype._ctxCreatePattern=function(i,H,R){},p.prototype._ctxRect=function(i,H,R,M){var I=this,p=I._transformPoints([{x:i,y:H},{x:i+R,y:H},{x:i+R,y:H+M},{x:i,y:H+M}]);I._path.push({type:"rect",points:p})},p.prototype._ctxMoveTo=function(i,H){var R=this,M=R._transformPoint({x:i,y:H});R._headPoint=M,R._path.push({type:"moveTo",x:M.x,y:M.y})},p.prototype._ctxLineTo=function(i,H){var R=this,M=R._transformPoint({x:i,y:H});R._path.push({type:"lineTo",x:M.x,y:M.y})},p.prototype._ctxArc=function(i,H,R,M,I,p){M=M||0,I=I||2*Math.PI,R&&this._ctxEllipse(i,H,R,R,0,M,I,p)},p.prototype._ctxEllipse=function(i,H,R,M,I,p,h,z){var d,C,y,b,U,K,q,Q,m,X,o,J,O,c,t=this,T=t._calcCurrentScale(),N=t._transformPoint({x:i,y:H});U=Math.sin(I),K=Math.cos(I);var D=function(i){return f(Math.cos(-i),Math.sin(-i))},f=function(I,p){var h=R*I,z=M*p;return{x:i+(K*h-U*z),y:H+(U*h+K*z)}},n=[],G=h;if(z)for(;G>=p;)G-=2*Math.PI;else for(;G<=p;)G+=2*Math.PI;for(m=(G-p)/t._ellipseSegments,o=0;o<=t._ellipseSegments;o++)X=p+m*o,J=t._transformPoint(D(-X)),n.push(J);var k=p,P=G;if(n[0],b=n[n.length-1],d=t._calcaEllipseAngle(p,h,z),p=d.start,h=d.end,q=t._equal(T.x,T.y),Q=t._equal(R,M),!t._forceSplitEllipse&&q&&Q&&t._equal(Math.abs(p-h),2*Math.PI))t._path.push({type:"circle",x:N.x,y:N.y,end:b,keyPoints:n,radius:R*T.x});else if(!t._forceSplitEllipse&&q&&Q)C=t._calcCurrentRotation(),y=Math.cos(C),O=t._currentContext.a*y<0,c=t._currentContext.d*y<0,d=t._transformStartEndAngle(p,h,O,c),p=d.start-C,h=d.end-C,t._path.push({type:"arc",x:N.x,y:N.y,end:b,radius:R*T.x,startAngle:p,endAngle:h,keyPoints:n});else{if(t._forceSplitEllipse||!q){if(t._path.length||t._path.push({type:"moveTo",x:n[0].x,y:n[0].y}),t._splitToBezier){var Z,v,a,F=P-k,w=Math.max(Math.ceil(Math.abs(F)/Math.PI*2),1),B=F/w,E=Math.tan(.5*B),_=Math.sin(B)*(Math.sqrt(4+3*E*E)-1)/3,x=Math.cos(k),j=Math.sin(k);for(o=0;o<w;o++){a=k+(o+1)*B,Z=Math.cos(a),v=Math.sin(a);var Y=f(Z,v);t._ctxBezier([f(x-j*_,j+x*_),f(Z+v*_,v-Z*_)],Y.x,Y.y),x=Z,j=v,a}return}for(o=1;o<=t._ellipseSegments;o++)J=n[o],t._path.push({type:"lineTo",x:J.x,y:J.y});return}var r,e,s=t._transformPoint(D(0)),W=t._transformPoint(D(Math.PI/2)),$=function(i,H){var R=i.x-H.x,M=i.y-H.y;return Math.sqrt(R*R+M*M)},l=$(s,N),V=$(W,N);V>l?(e=l,l=V,V=e,r=W):r=s,C=t._calcCurrentRotation(),y=Math.cos(C),O=t._currentContext.a*y<0,c=t._currentContext.d*y<0,d=t._transformStartEndAngle(p-Math.PI/2,h-Math.PI/2,O,c),p=d.start,h=d.end,t._path.push({type:"ellipse",x:N.x,y:N.y,end:b,major:{x:r.x-N.x,y:r.y-N.y},ratio:V/l,startAngle:p,endAngle:h,keyPoints:n})}},p.prototype._ctxBezier=function(i,H,R){var M=this,I=M._transformPoint({x:H,y:R});this._path.push({type:"bezier",x:I.x,y:I.y,ctrl:M._transformPoints(i)})},p.prototype._ctxBeginPath=function(){this._emptyPath()},p.prototype._ctxClosePath=function(){var i=this,H=i._headPoint;H&&(i._path.push({type:"lineTo",x:H.x,y:H.y,subType:"closePath"}),i._headPoint=null,i._lastPoint=null)},p.prototype._calcaEllipseAngle=function(i,H,R){i=-i,H=-H;var M,I=i%(2*Math.PI),p=H%(2*Math.PI);for(I<0&&(I+=2*Math.PI),p<0&&(p+=2*Math.PI),R||(M=I,I=p,p=M);p<=I;)p+=2*Math.PI;return{start:I,end:p}},p.prototype._transformStartEndAngle=function(i,H,R,M){var I;return(M||R)&&(R&&M?(i=Math.PI+i,H=Math.PI+H):(I=Math.PI*(R?1:2)-H,H=Math.PI*(R?1:2)-i,i=I)),{start:i,end:H}},p.prototype._ctxFill=function(i){var H=this;return H._fillRule=i||"nonzero",H._ctxDraw("fill")},p.prototype._tryConvertAndRecordGradient=function(i){if("string"!=typeof i.color){var H=this;if(i.color instanceof CanvasGradient){var R=i.color,M=[R.isLinear?"L":"R"];M=M.concat(R.points);var I=H._currentContext;M=M.concat([I.a,I.b,I.c,I.d,I.tx,I.ty]),M=M.concat(R.colorStops),i.gradientPack=M}else if(i.color instanceof CanvasPattern&&i.color.gradient){var p=i.color,R=p.gradient,M=[R.isLinear?"L":"R"];M=M.concat(R.points);var h=p.trans,I=H._currentContext,z=I.a,d=I.b,C=I.c,y=I.d,b=I.tx,U=I.ty,K=h[0],q=h[1],Q=h[2],m=h[3],X=h[4],o=h[5];M=M.concat([z*K+C*q,d*K+y*q,z*Q+C*m,d*Q+y*m,z*X+C*o+b,d*X+y*o+U]),M=M.concat(R.colorStops),i.gradientPack=M}else i.trans=[H._currentContext.a,H._currentContext.b,H._currentContext.c,H._currentContext.d,H._currentContext.tx,H._currentContext.ty],i.color=i.color.image?i.color.image:i.color,i.isPattern=!0}},p.prototype._ctxDraw=function(i){var H=this,R=H._path;if(R.length){var M,I,p,h,z,d=[],C=[];if("clip"===i)z={clip:!0};else{if("stroke"===i){z={stroke:!0,lineWidth:H._transformSize(H.ctx.lineWidth),color:H.ctx.strokeStyle};var y=H.ctx.lineCap;"butt"!==y&&(z.lineCap=y);var b=H.ctx.getLineDash();if(b&&b.length){z.dash=!0;for(var U=0,K=b.length;U<K;U++)b[U]=H._transformSize(b[U]);z.dashPattern=b,z.dashOffset=H._transformSize(H.ctx.lineDashOffset)}}else z={stroke:!1,color:H.ctx.fillStyle},"nonzero"!==H._fillRule&&(z.fillRule=H._fillRule);if(H.ctx.globalAlpha<1&&(z.opacity=H.ctx.globalAlpha),H._tryConvertAndRecordGradient(z),"string"==typeof z.color&&"rgba(0,0,0,0)"===z.color.replace(/ /g,""))return}for(I=0,M=R.length;I<M;I++)switch(p=R[I],p.type){case"moveTo":H._lastPoint={x:p.x,y:p.y},d.push(H._lastPoint),C.push(1);break;case"lineTo":"closePath"===p.subType?C.push(5):(d.push({x:p.x,y:p.y}),C.push(2)),H._lastPoint={x:p.x,y:p.y};break;case"rect":h=p.points,d.push({x:h[0].x,y:h[0].y},{x:h[1].x,y:h[1].y},{x:h[2].x,y:h[2].y},{x:h[3].x,y:h[3].y},{x:h[0].x,y:h[0].y}),C.push(2,2,2,2,2),H._lastPoint=p.points[0];break;case"circle":case"arc":case"ellipse":console.log("split to line",p.type);break;case"arcBegin":d.length&&C.length&&H.writer.addShape(d,C,z),d=[],C=[];break;case"arcClose":H.writer.addShape(d,C,z),d=[],C=[];break;case"bezier":if(!H._lastPoint)break;1===p.ctrl.length?(d.push({x:p.ctrl[0].x,y:p.ctrl[0].y},{x:p.x,y:p.y}),C.push(3)):(d.push({x:p.ctrl[0].x,y:p.ctrl[0].y},{x:p.ctrl[1].x,y:p.ctrl[1].y},{x:p.x,y:p.y}),C.push(4)),H._lastPoint={x:p.x,y:p.y};break;default:d.push({x:p.x,y:p.y}),C.push(2)}H.writer.addShape(d,C,z)}},p.prototype._emptyPath=function(){var i=this;i._path=[],i._lastPoint=null,i._headPoint=null};var h=M.SvgConverter=function(i){var H=this;H.initConfig(i||{}),H.initCanvas()};h.prototype={},h.prototype.constructor=h,h.prototype.initConfig=function(i){var H,M=this;H=M.options={},H.size=i.size||512,H.segments=i.segments||16,H.splitToBezier=i.splitToBezier===R||i.splitToBezier,H.minimumFontSize=i.minimumFontSize==R?12:i.minimumFontSize},h.prototype.initCanvas=function(){var i=this,H=document.createElement("canvas");H.width=H.height=i.options.size,H.style.width=H.style.height=i.options.size;var R=H.getContext;H.getContext=function(H){return function(R){var M=H.apply(this,arguments);return"2d"===R&&i.wrapContext2d(M),M}}(R),i._canvas=H,i._segments=[]},h.prototype.toShape=function(i){var H=this;H._canvas;return H._segments=[],canvg(H._canvas,i,{ignoreMouse:!0,ignoreAnimation:!0}),H.write()},h.prototype.wrapContext2d=function(i){var H=this;return new M.Context2dProxy(i,H,H.options)},h.prototype.write=function(){var i=this;return{width:i._canvas.width,height:i._canvas.height,comps:i._segments}},h.prototype.addComponent=function(i){this._segments.push(i)},h.prototype.addText=function(i,H,R,M,I,p,h,z){I=I||"left","start"===I?I="left":"end"===I&&(I="right");var d=this,C={type:"text",text:i,rotation:M,rect:[H.x,H.y,.01,.01],align:I,vAlign:p,font:R};h.gradientPack?C.gradientPack=d._fixGraidentPack(h.gradientPack):C.color=h.color,z&&1!==z&&(C.scaleX=z,C.scaleY=z),d.addComponent(C)},h.prototype._fixGraidentPack=function(i){var H="L"===i[0]?[i[5],i[6],i[7],i[8],i[9],i[10]]:[i[7],i[8],i[9],i[10],i[11],i[12]];if(Math.abs(H[4])>1e8||Math.abs(H[5])>1e8){var R=H[0],M=H[1],I=H[2],p=H[3],h=H[4],z=H[5],d=Math.floor((h*p-z*I)/(R*p-M*I)),C=Math.floor((h*M-z*R)/(I*M-R*p));h=-(R*d+I*C),z=-(M*d+p*C),"L"===i[0]?(i[9]+=h,i[10]+=z,i[1]+=d,i[2]+=C,i[3]+=d,i[4]+=C):(i[11]+=h,i[12]+=z,i[1]+=d,i[2]+=C,i[4]+=d,i[5]+=C)}return i},h.prototype.addShape=function(i,H,M){for(var I=this,p=[],h=0,z=i.length;h<z;h++){var d=i[h];p.push(d.x,d.y)}if(M.clip)return void I.addComponent({type:"clip",points:p,segments:H});var C={type:"shape",points:p,segments:H};M.opacity!=R&&(C.opacity=M.opacity),M.stroke?(M.dash?(C.dash=M.dash,C.dashPattern=M.dashPattern,C.dashOffset=M.dashOffset,C.dashColor=M.color,C.dashWidth=M.lineWidth,C.borderColor=null,C.borderWidth=0,C.background=null):(C.borderColor=M.color,C.borderWidth=M.lineWidth,C.background=null,M.gradientPack&&(C.borderGradientPack=I._fixGraidentPack(M.gradientPack),C.borderColor=null)),M.lineCap&&(C.borderCap=M.lineCap)):(C.borderColor=null,C.borderWidth=0,M.isPattern?(C.repeatImage=M.color,C.trans=M.trans,C.background=null):M.gradientPack?(C.gradientPack=I._fixGraidentPack(M.gradientPack),C.background=null):C.background=M.color,M.gradient&&(C.gradient=M.gradient,C.gradientColor=M.gradientColor),M.fillRule&&(C.fillRule=M.fillRule)),I.addComponent(C)},h.prototype.addRestore=function(){this.addComponent({type:"restore"})},function(i){function H(i){this.ok=!1,"#"==i.charAt(0)&&(i=i.substr(1,6)),i=i.replace(/ /g,""),i=i.toLowerCase();var R={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};for(var M in R)i==M&&(i=R[M]);for(var I=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(i){return[parseInt(i[1]),parseInt(i[2]),parseInt(i[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(i){return[parseInt(i[1],16),parseInt(i[2],16),parseInt(i[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(i){return[parseInt(i[1]+i[1],16),parseInt(i[2]+i[2],16),parseInt(i[3]+i[3],16)]}}],p=0;p<I.length;p++){var h=I[p].re,z=I[p].process,d=h.exec(i);if(d){var C=z(d);this.r=C[0],this.g=C[1],this.b=C[2],this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var i=this.r.toString(16),H=this.g.toString(16),R=this.b.toString(16);return 1==i.length&&(i="0"+i),1==H.length&&(H="0"+H),1==R.length&&(R="0"+R),"#"+i+H+R},this.getHelpXML=function(){for(var i=new Array,M=0;M<I.length;M++)for(var p=I[M].example,h=0;h<p.length;h++)i[i.length]=p[h];for(var z in R)i[i.length]=z;var d=document.createElement("ul");d.setAttribute("id","rgbcolor-examples");for(var M=0;M<i.length;M++)try{var C=document.createElement("li"),y=new H(i[M]),b=document.createElement("div");b.style.cssText="margin: 3px; border: 1px solid black; background:"+y.toHex()+"; color:"+y.toHex(),b.appendChild(document.createTextNode("test"));var U=document.createTextNode(" "+i[M]+" -> "+y.toRGB()+" -> "+y.toHex());C.appendChild(b),C.appendChild(U),d.appendChild(C)}catch(i){}return d}}i.RGBColor=H}(void 0!==i?i:this),function(i){function H(i){for(var H=i.data,R=i.width*i.height*4,M=0;M<R;M+=4){var I=H[M+3]/255;H[M]*=I,H[M+1]*=I,H[M+2]*=I}}function R(i){for(var H=i.data,R=i.width*i.height*4,M=0;M<R;M+=4){var I=H[M+3];0!=I&&(I=255/I,H[M]*=I,H[M+1]*=I,H[M+2]*=I)}}function M(i,H,R,M){var h=document.getElementById(i),z=h.naturalWidth,d=h.naturalHeight,C=document.getElementById(H);C.style.width=z+"px",C.style.height=d+"px",C.width=z,C.height=d;var y=C.getContext("2d");y.clearRect(0,0,z,d),y.drawImage(h,0,0),isNaN(R)||R<1||(M?I(H,0,0,z,d,R):p(H,0,0,z,d,R))}function I(i,M,I,p,C,y){if(!(isNaN(y)||y<1)){y|=0;var b,U=document.getElementById(i),K=U.getContext("2d");try{try{b=K.getImageData(M,I,p,C)}catch(i){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead"),b=K.getImageData(M,I,p,C)}catch(i){throw alert("Cannot access local image"),new Error("unable to access local image data: "+i)}}}catch(i){throw alert("Cannot access image"),new Error("unable to access image data: "+i)}H(b);var q,Q,m,X,o,J,O,c,t,T,N,D,f,n,G,k,P,Z,v,a,F,w,B,E,_=b.data,x=y+y+1,j=p-1,Y=C-1,r=y+1,e=r*(r+1)/2,s=new h,W=s;for(m=1;m<x;m++)if(W=W.next=new h,m==r)var $=W;W.next=s;var l=null,V=null;O=J=0;var A=z[y],g=d[y];for(Q=0;Q<C;Q++){for(k=P=Z=v=c=t=T=N=0,D=r*(a=_[J]),f=r*(F=_[J+1]),n=r*(w=_[J+2]),G=r*(B=_[J+3]),c+=e*a,t+=e*F,T+=e*w,N+=e*B,W=s,m=0;m<r;m++)W.r=a,W.g=F,W.b=w,W.a=B,W=W.next;for(m=1;m<r;m++)X=J+((j<m?j:m)<<2),c+=(W.r=a=_[X])*(E=r-m),t+=(W.g=F=_[X+1])*E,T+=(W.b=w=_[X+2])*E,N+=(W.a=B=_[X+3])*E,k+=a,P+=F,Z+=w,v+=B,W=W.next;for(l=s,V=$,q=0;q<p;q++)_[J]=c*A>>g,_[J+1]=t*A>>g,_[J+2]=T*A>>g,_[J+3]=N*A>>g,c-=D,t-=f,T-=n,N-=G,D-=l.r,f-=l.g,n-=l.b,G-=l.a,X=O+((X=q+y+1)<j?X:j)<<2,k+=l.r=_[X],P+=l.g=_[X+1],Z+=l.b=_[X+2],v+=l.a=_[X+3],c+=k,t+=P,T+=Z,N+=v,l=l.next,D+=a=V.r,f+=F=V.g,n+=w=V.b,G+=B=V.a,k-=a,P-=F,Z-=w,v-=B,V=V.next,J+=4;O+=p}for(q=0;q<p;q++){for(P=Z=v=k=t=T=N=c=0,J=q<<2,D=r*(a=_[J]),f=r*(F=_[J+1]),n=r*(w=_[J+2]),G=r*(B=_[J+3]),c+=e*a,t+=e*F,T+=e*w,N+=e*B,W=s,m=0;m<r;m++)W.r=a,W.g=F,W.b=w,W.a=B,W=W.next;for(o=p,m=1;m<=y;m++)J=o+q<<2,c+=(W.r=a=_[J])*(E=r-m),t+=(W.g=F=_[J+1])*E,T+=(W.b=w=_[J+2])*E,N+=(W.a=B=_[J+3])*E,k+=a,P+=F,Z+=w,v+=B,W=W.next,m<Y&&(o+=p);for(J=q,l=s,V=$,Q=0;Q<C;Q++)X=J<<2,_[X]=c*A>>g,_[X+1]=t*A>>g,_[X+2]=T*A>>g,_[X+3]=N*A>>g,c-=D,t-=f,T-=n,N-=G,D-=l.r,f-=l.g,n-=l.b,G-=l.a,X=q+((X=Q+r)<Y?X:Y)*p<<2,c+=k+=l.r=_[X],t+=P+=l.g=_[X+1],T+=Z+=l.b=_[X+2],N+=v+=l.a=_[X+3],l=l.next,D+=a=V.r,f+=F=V.g,n+=w=V.b,G+=B=V.a,k-=a,P-=F,Z-=w,v-=B,V=V.next,J+=p}R(b),K.putImageData(b,M,I)}}function p(i,H,R,M,I,p){if(!(isNaN(p)||p<1)){p|=0;var C,y=document.getElementById(i),b=y.getContext("2d");try{try{C=b.getImageData(H,R,M,I)}catch(i){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead"),C=b.getImageData(H,R,M,I)}catch(i){throw alert("Cannot access local image"),new Error("unable to access local image data: "+i)}}}catch(i){throw alert("Cannot access image"),new Error("unable to access image data: "+i)}var U,K,q,Q,m,X,o,J,O,c,t,T,N,D,f,n,G,k,P,Z,v=C.data,a=p+p+1,F=M-1,w=I-1,B=p+1,E=B*(B+1)/2,_=new h,x=_;for(q=1;q<a;q++)if(x=x.next=new h,q==B)var j=x;x.next=_;var Y=null,r=null;o=X=0;var e=z[p],s=d[p];for(K=0;K<I;K++){for(D=f=n=J=O=c=0,t=B*(G=v[X]),T=B*(k=v[X+1]),N=B*(P=v[X+2]),J+=E*G,O+=E*k,c+=E*P,x=_,q=0;q<B;q++)x.r=G,x.g=k,x.b=P,x=x.next;for(q=1;q<B;q++)Q=X+((F<q?F:q)<<2),J+=(x.r=G=v[Q])*(Z=B-q),O+=(x.g=k=v[Q+1])*Z,c+=(x.b=P=v[Q+2])*Z,D+=G,f+=k,n+=P,x=x.next;for(Y=_,r=j,U=0;U<M;U++)v[X]=J*e>>s,v[X+1]=O*e>>s,v[X+2]=c*e>>s,J-=t,O-=T,c-=N,t-=Y.r,T-=Y.g,N-=Y.b,Q=o+((Q=U+p+1)<F?Q:F)<<2,D+=Y.r=v[Q],f+=Y.g=v[Q+1],n+=Y.b=v[Q+2],J+=D,O+=f,c+=n,Y=Y.next,t+=G=r.r,T+=k=r.g,N+=P=r.b,D-=G,f-=k,n-=P,r=r.next,X+=4;o+=M}for(U=0;U<M;U++){for(f=n=D=O=c=J=0,X=U<<2,t=B*(G=v[X]),T=B*(k=v[X+1]),N=B*(P=v[X+2]),J+=E*G,O+=E*k,c+=E*P,x=_,q=0;q<B;q++)x.r=G,x.g=k,x.b=P,x=x.next;for(m=M,q=1;q<=p;q++)X=m+U<<2,J+=(x.r=G=v[X])*(Z=B-q),O+=(x.g=k=v[X+1])*Z,c+=(x.b=P=v[X+2])*Z,D+=G,f+=k,n+=P,x=x.next,q<w&&(m+=M);for(X=U,Y=_,r=j,K=0;K<I;K++)Q=X<<2,v[Q]=J*e>>s,v[Q+1]=O*e>>s,v[Q+2]=c*e>>s,J-=t,O-=T,c-=N,t-=Y.r,T-=Y.g,N-=Y.b,Q=U+((Q=K+B)<w?Q:w)*M<<2,J+=D+=Y.r=v[Q],O+=f+=Y.g=v[Q+1],c+=n+=Y.b=v[Q+2],Y=Y.next,t+=G=r.r,T+=k=r.g,N+=P=r.b,D-=G,f-=k,n-=P,r=r.next,X+=M}b.putImageData(C,H,R)}}function h(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var z=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],d=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24],C={image:M,canvasRGBA:I,canvasRGB:p};i.stackBlur=C}(void 0!==i?i:this),function(H,I){H.canvg=function(H,I){function p(i){var H=[0,0,0],R=function(R,M){var I=i.match(R);null!=I&&(H[M]+=I.length,i=i.replace(R," "))};return i=i.replace(/:not\(([^\)]*)\)/g,"     $1 "),i=i.replace(/{[\s\S]*/gm," "),R(C,1),R(y,0),R(b,1),R(U,2),R(K,1),R(q,1),i=i.replace(/[\*\s\+>~]/g," "),i=i.replace(/[#\.]/g," "),R(Q,2),H.join("")}function h(h){var d={opts:h};d.FRAMERATE=30,d.MAX_VIRTUAL_PIXELS=3e4,d.log=function(i){},1==d.opts.log&&"undefined"!=typeof console&&(d.log=function(i){console.log(i)}),d.init=function(i){var H=0;d.UniqueId=function(){return"canvg"+ ++H},d.Definitions={},d.Styles={},d.StylesSpecificity={},d.Animations=[],d.Images=[],d.ctx=i,d.ViewPort=new function(){this.viewPorts=[],this.Clear=function(){this.viewPorts=[]},this.SetCurrent=function(i,H){this.viewPorts.push({width:i,height:H})},this.RemoveCurrent=function(){this.viewPorts.pop()},this.Current=function(){return this.viewPorts[this.viewPorts.length-1]},this.width=function(){var i,H=this.Current();return H&&(i=H.width)?i:100},this.height=function(){var i,H=this.Current();return H&&(i=H.height)?i:100},this.ComputeSize=function(i){return null!=i&&"number"==typeof i?i:"x"==i?this.width():"y"==i?this.height():Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}},d.init(),d.ImagesLoaded=function(){for(var i=0;i<d.Images.length;i++)if(!d.Images[i].loaded)return!1;return!0},d.trim=function(i){return i.replace(/^\s+|\s+$/g,"")},d.compressSpaces=function(i){return i.replace(/[\s\r\t\n]+/gm," ")},d.ajax=function(i){i=M.Default.beforeLoadURL(i);var H=new M.Request,R={};return R.url=encodeURI(i),R.sync=!0,H.send(R),H.getResponseText()},d.parseXml=function(H){if("undefined"!=typeof Windows&&void 0!==Windows.Data&&void 0!==Windows.Data.Xml){var R=new Windows.Data.Xml.Dom.XmlDocument,M=new Windows.Data.Xml.Dom.XmlLoadSettings;return M.prohibitDtd=!1,R.loadXml(H,M),R}if(i.DOMParser){return(new DOMParser).parseFromString(H,"text/xml")}H=H.replace(/<!DOCTYPE svg[^>]*>/,"");var R=new ActiveXObject("Microsoft.XMLDOM");return R.async="false",R.loadXML(H),R},d.Property=function(i,H){this.name=i,this.value=H},d.Property.prototype.getValue=function(){return this.value},d.Property.prototype.hasValue=function(){return null!=this.value&&""!==this.value},d.Property.prototype.numValue=function(){if(!this.hasValue())return 0;var i=parseFloat(this.value);return(this.value+"").match(/%$/)&&(i/=100),i},d.Property.prototype.valueOrDefault=function(i){return this.hasValue()?this.value:i},d.Property.prototype.numValueOrDefault=function(i){return this.hasValue()?this.numValue():i},d.Property.prototype.addOpacity=function(i){var R=this.value;if(null!=i.value&&""!=i.value&&"string"==typeof this.value){var M=new H(this.value);M.ok&&(R="rgba("+M.r+", "+M.g+", "+M.b+", "+i.numValue()+")")}return new d.Property(this.name,R)},d.Property.prototype.getDefinition=function(){var i=this.value.match(/#([^\)'"]+)/);return i&&(i=i[1]),i||(i=this.value),d.Definitions[i]},d.Property.prototype.isUrlDefinition=function(){return 0==this.value.indexOf("url(")},d.Property.prototype.getFillStyleDefinition=function(i,H){var R=this.getDefinition();if(null!=R&&R.createGradient)return R.createGradient(d.ctx,i,H);if(null!=R&&R.createPattern){if(R.getHrefAttribute().hasValue()){var M=R.attribute("patternTransform");R=R.getHrefAttribute().getDefinition(),M.hasValue()&&(R.attribute("patternTransform",!0).value=M.value)}return R.createPattern(d.ctx,i)}return null},d.Property.prototype.getDPI=function(i){return 96},d.Property.prototype.getEM=function(i){var H=12,R=new d.Property("fontSize",d.Font.Parse(d.ctx.font).fontSize);return R.hasValue()&&(H=R.toPixels(i)),H},d.Property.prototype.getUnits=function(){return(this.value+"").replace(/[0-9\.\-]/g,"")},d.Property.prototype.toPixels=function(i,H){if(!this.hasValue())return 0;var R=this.value+"";if(R.match(/em$/))return this.numValue()*this.getEM(i);if(R.match(/ex$/))return this.numValue()*this.getEM(i)/2;if(R.match(/px$/))return this.numValue();if(R.match(/pt$/))return this.numValue()*this.getDPI(i)*(1/72);if(R.match(/pc$/))return 15*this.numValue();if(R.match(/cm$/))return this.numValue()*this.getDPI(i)/2.54;if(R.match(/mm$/))return this.numValue()*this.getDPI(i)/25.4;if(R.match(/in$/))return this.numValue()*this.getDPI(i);if(R.match(/%$/))return this.numValue()*d.ViewPort.ComputeSize(i);var M=this.numValue();return H&&M<1?M*d.ViewPort.ComputeSize(i):M},
d.Property.prototype.toMilliseconds=function(){if(!this.hasValue())return 0;var i=this.value+"";return i.match(/s$/)?1e3*this.numValue():(i.match(/ms$/),this.numValue())},d.Property.prototype.toRadians=function(){if(!this.hasValue())return 0;var i=this.value+"";return i.match(/deg$/)?this.numValue()*(Math.PI/180):i.match(/grad$/)?this.numValue()*(Math.PI/200):i.match(/rad$/)?this.numValue():this.numValue()*(Math.PI/180)};var C={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};return d.Property.prototype.toTextBaseline=function(){return this.hasValue()?C[this.value]:null},d.Font=new function(){this.Styles="normal|italic|oblique|inherit",this.Variants="normal|small-caps|inherit",this.Weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit",this.CreateFont=function(i,H,R,M,I,p){var h=null!=p?this.Parse(p):this.CreateFont("","","","","",d.ctx.font);return{fontFamily:I||h.fontFamily,fontSize:M||h.fontSize,fontStyle:i||h.fontStyle,fontWeight:R||h.fontWeight,fontVariant:H||h.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var i=this;this.Parse=function(H){for(var R={},M=d.trim(d.compressSpaces(H||"")).split(" "),I={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1},p="",h=0;h<M.length;h++)I.fontStyle||-1==i.Styles.indexOf(M[h])?I.fontVariant||-1==i.Variants.indexOf(M[h])?I.fontWeight||-1==i.Weights.indexOf(M[h])?I.fontSize?"inherit"!=M[h]&&(p+=M[h]):("inherit"!=M[h]&&(R.fontSize=M[h].split("/")[0]),I.fontStyle=I.fontVariant=I.fontWeight=I.fontSize=!0):("inherit"!=M[h]&&(R.fontWeight=M[h]),I.fontStyle=I.fontVariant=I.fontWeight=!0):("inherit"!=M[h]&&(R.fontVariant=M[h]),I.fontStyle=I.fontVariant=!0):("inherit"!=M[h]&&(R.fontStyle=M[h]),I.fontStyle=!0);return""!=p&&(R.fontFamily=p),R}},d.ToNumberArray=function(i){for(var H=d.trim(d.compressSpaces((i||"").replace(/,/g," "))).split(" "),R=0;R<H.length;R++)H[R]=parseFloat(H[R]);return H},d.Point=function(i,H){this.x=i,this.y=H},d.Point.prototype.angleTo=function(i){return Math.atan2(i.y-this.y,i.x-this.x)},d.Point.prototype.applyTransform=function(i){var H=this.x*i[0]+this.y*i[2]+i[4],R=this.x*i[1]+this.y*i[3]+i[5];this.x=H,this.y=R},d.CreatePoint=function(i){var H=d.ToNumberArray(i);return new d.Point(H[0],H[1])},d.CreatePath=function(i){for(var H=d.ToNumberArray(i),R=[],M=0;M<H.length;M+=2)R.push(new d.Point(H[M],H[M+1]));return R},d.BoundingBox=function(i,H,R,M){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN,this.x=function(){return this.x1},this.y=function(){return this.y1},this.width=function(){return this.x2-this.x1},this.height=function(){return this.y2-this.y1},this.addPoint=function(i,H){null!=i&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=i,this.x2=i),i<this.x1&&(this.x1=i),i>this.x2&&(this.x2=i)),null!=H&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=H,this.y2=H),H<this.y1&&(this.y1=H),H>this.y2&&(this.y2=H))},this.addX=function(i){this.addPoint(i,null)},this.addY=function(i){this.addPoint(null,i)},this.addBoundingBox=function(i){this.addPoint(i.x1,i.y1),this.addPoint(i.x2,i.y2)},this.addQuadraticCurve=function(i,H,R,M,I,p){var h=i+2/3*(R-i),z=H+2/3*(M-H),d=h+1/3*(I-i),C=z+1/3*(p-H);this.addBezierCurve(i,H,h,d,z,C,I,p)},this.addBezierCurve=function(i,H,R,M,I,p,h,z){var d=[i,H],C=[R,M],y=[I,p],b=[h,z];this.addPoint(d[0],d[1]),this.addPoint(b[0],b[1]);for(var U=0;U<=1;U++){var K=function(i){return Math.pow(1-i,3)*d[U]+3*Math.pow(1-i,2)*i*C[U]+3*(1-i)*Math.pow(i,2)*y[U]+Math.pow(i,3)*b[U]},q=6*d[U]-12*C[U]+6*y[U],Q=-3*d[U]+9*C[U]-9*y[U]+3*b[U],m=3*C[U]-3*d[U];if(0!=Q){var X=Math.pow(q,2)-4*m*Q;if(!(X<0)){var o=(-q+Math.sqrt(X))/(2*Q);0<o&&o<1&&(0==U&&this.addX(K(o)),1==U&&this.addY(K(o)));var J=(-q-Math.sqrt(X))/(2*Q);0<J&&J<1&&(0==U&&this.addX(K(J)),1==U&&this.addY(K(J)))}}else{if(0==q)continue;var O=-m/q;0<O&&O<1&&(0==U&&this.addX(K(O)),1==U&&this.addY(K(O)))}}},this.isPointInBox=function(i,H){return this.x1<=i&&i<=this.x2&&this.y1<=H&&H<=this.y2},this.addPoint(i,H),this.addPoint(R,M)},d.Transform=function(i){var H=this;this.Type={},this.Type.translate=function(i){this.p=d.CreatePoint(i),this.getMatrix=function(){return[1,0,0,1,this.p.x||0,this.p.y||0]},this.apply=function(i){i.translate(this.p.x||0,this.p.y||0)},this.unapply=function(i){i.translate(-1*this.p.x||0,-1*this.p.y||0)},this.applyToPoint=function(i){i.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}},this.Type.rotate=function(i){var H=d.ToNumberArray(i);this.angle=new d.Property("angle",H[0]),this.cx=H[1]||0,this.cy=H[2]||0,this.apply=function(i){i.translate(this.cx,this.cy),i.rotate(this.angle.toRadians()),i.translate(-this.cx,-this.cy)},this.getMatrix=function(){var i=this.angle.toRadians(),H=Math.sin(i),R=Math.cos(i),M=this.cx,I=this.cy;return[R,H,-H,R,R*-M+H*I+M,H*-M-R*I+I]},this.unapply=function(i){i.translate(this.cx,this.cy),i.rotate(-1*this.angle.toRadians()),i.translate(-this.cx,-this.cy)},this.applyToPoint=function(i){var H=this.angle.toRadians();i.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]),i.applyTransform([Math.cos(H),Math.sin(H),-Math.sin(H),Math.cos(H),0,0]),i.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}},this.Type.scale=function(i){this.p=d.CreatePoint(i),this.getMatrix=function(){return[this.p.x||1,0,0,this.p.y||this.p.x||1,0,0]},this.apply=function(i){i.scale(this.p.x||1,this.p.y||this.p.x||1)},this.unapply=function(i){i.scale(1/this.p.x||1,1/this.p.y||this.p.x||1)},this.applyToPoint=function(i){i.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}},this.Type.matrix=function(i){this.m=d.ToNumberArray(i),this.getMatrix=function(){return this.m},this.apply=function(i){i.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},this.unapply=function(i){var H=this.m[0],R=this.m[2],M=this.m[4],I=this.m[1],p=this.m[3],h=this.m[5],z=1/(H*(1*p-0*h)-R*(1*I-0*h)+M*(0*I-0*p));i.transform(z*(1*p-0*h),z*(0*h-1*I),z*(0*M-1*R),z*(1*H-0*M),z*(R*h-M*p),z*(M*I-H*h))},this.applyToPoint=function(i){i.applyTransform(this.m)}},this.Type.SkewBase=function(i){this.base=H.Type.matrix,this.base(i),this.angle=new d.Property("angle",i)},this.Type.SkewBase.prototype=new this.Type.matrix,this.Type.skewX=function(i){this.base=H.Type.SkewBase,this.base(i),this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0]},this.Type.skewX.prototype=new this.Type.SkewBase,this.Type.skewY=function(i){this.base=H.Type.SkewBase,this.base(i),this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0]},this.Type.skewY.prototype=new this.Type.SkewBase,this.transforms=[],this.getMatrix=function(){for(var i=1,H=0,R=0,M=1,I=0,p=0,h=0;h<this.transforms.length;h++){var z=this.transforms[h].getMatrix(),d=i,C=H,y=R,b=M,U=I,K=p;i=d*z[0]+y*z[1],H=C*z[0]+b*z[1],R=d*z[2]+y*z[3],M=C*z[2]+b*z[3],I=d*z[4]+y*z[5]+U,p=C*z[4]+b*z[5]+K}return[i,H,R,M,I,p]},this.apply=function(i){for(var H=0;H<this.transforms.length;H++)this.transforms[H].apply(i)},this.unapply=function(i){for(var H=this.transforms.length-1;H>=0;H--)this.transforms[H].unapply(i)},this.applyToPoint=function(i){for(var H=0;H<this.transforms.length;H++)this.transforms[H].applyToPoint(i)};for(var R=d.trim(d.compressSpaces(i)).replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/),M=0;M<R.length;M++){var I=d.trim(R[M].split("(")[0]),p=R[M].split("(")[1].replace(")",""),h=this.Type[I];if(void 0!==h){var z=new h(p);z.type=I,this.transforms.push(z)}}},d.AspectRatio=function(i,H,R,M,I,p,h,z,C,y){H=d.compressSpaces(H),H=H.replace(/^defer\s/,"");var b=H.split(" ")[0]||"xMidYMid",U=H.split(" ")[1]||"meet",K=R/M,q=I/p,Q=Math.min(K,q),m=Math.max(K,q);"meet"==U&&(M*=Q,p*=Q),"slice"==U&&(M*=m,p*=m),C=new d.Property("refX",C),y=new d.Property("refY",y),C.hasValue()&&y.hasValue()?i.translate(-Q*C.toPixels("x"),-Q*y.toPixels("y")):(b.match(/^xMid/)&&("meet"==U&&Q==q||"slice"==U&&m==q)&&i.translate(R/2-M/2,0),b.match(/YMid$/)&&("meet"==U&&Q==K||"slice"==U&&m==K)&&i.translate(0,I/2-p/2),b.match(/^xMax/)&&("meet"==U&&Q==q||"slice"==U&&m==q)&&i.translate(R-M,0),b.match(/YMax$/)&&("meet"==U&&Q==K||"slice"==U&&m==K)&&i.translate(0,I-p)),"none"==b?i.scale(K,q):"meet"==U?i.scale(Q,Q):"slice"==U&&i.scale(m,m),i.translate(null==h?0:-h,null==z?0:-z)},d.Element={},d.EmptyProperty=new d.Property("EMPTY",""),d.Element.ElementBase=function(i){this.attributes={},this.styles={},this.stylesSpecificity={},this.children=[],this.attribute=function(i,H){var R=this.attributes[i];return null!=R?R:(1==H&&(R=new d.Property(i,""),this.attributes[i]=R),R||d.EmptyProperty)},this.getHrefAttribute=function(){for(var i in this.attributes)if("href"==i||i.match(/:href$/))return this.attributes[i];return d.EmptyProperty},this.style=function(i,H,R){var M=this.styles[i];if(null!=M)return M;var I=this.attribute(i);if(null!=I&&I.hasValue())return this.styles[i]=I,I;if(1!=R){var p=this.parent;if(null!=p){var h=p.style(i);if(null!=h&&h.hasValue())return h}}return 1==H&&(M=new d.Property(i,""),this.styles[i]=M),M||d.EmptyProperty},this.render=function(i){if("none"!=this.style("display").value&&"hidden"!=this.style("visibility").value){if(i.save(),this.style("mask").hasValue()){var H=this.style("mask").getDefinition();null!=H&&H.apply(i,this)}else this.setContext(i),this.renderChildren(i),this.clearContext(i);i.restore()}},this.setContext=function(i){},this.clearContext=function(i){},this.renderChildren=function(i){for(var H=0;H<this.children.length;H++)this.children[H].render(i)},this.addChild=function(i,H){var R=i;H&&(R=d.CreateElement(i)),R.parent=this,"title"!=R.type&&this.children.push(R)},this.addStylesFromStyleDefinition=function(){for(var H in d.Styles)if("@"!=H[0]&&z(i,H)){var R=d.Styles[H],M=d.StylesSpecificity[H];if(null!=R)for(var I in R){var p=this.stylesSpecificity[I];void 0===p&&(p="000"),M>p&&(this.styles[I]=R[I],this.stylesSpecificity[I]=M)}}};var H=new RegExp("^[A-Z-]+$");if(null!=i&&1==i.nodeType){for(var R=0;R<i.attributes.length;R++){var M=i.attributes[R],I=function(i){return H.test(i)?i.toLowerCase():i}(M.nodeName);this.attributes[I]=new d.Property(I,M.value)}if(this.addStylesFromStyleDefinition(),this.attribute("style").hasValue())for(var p=this.attribute("style").value.split(";"),R=0;R<p.length;R++)if(""!=d.trim(p[R])){var h=p[R].split(":"),C=d.trim(h[0]),y=d.trim(h[1]);this.styles[C]=new d.Property(C,y)}this.attribute("id").hasValue()&&null==d.Definitions[this.attribute("id").value]&&(d.Definitions[this.attribute("id").value]=this);for(var R=0;R<i.childNodes.length;R++){var b=i.childNodes[R];if(1==b.nodeType&&this.addChild(b,!0),this.captureTextNodes&&(3==b.nodeType||4==b.nodeType)){var U=b.value||b.text||b.textContent||"";""!=d.compressSpaces(U)&&this.addChild(new d.Element.tspan(b),!1)}}}},d.Element.RenderedElementBase=function(i){this.base=d.Element.ElementBase,this.base(i),this.setContext=function(i,H){if(!H){if(this.style("fill").isUrlDefinition()){var R=this.style("fill").getFillStyleDefinition(this,this.style("fill-opacity"));null!=R&&(i.fillStyle=R)}else if(this.style("fill").hasValue()){var M=this.style("fill");"currentColor"==M.value&&(M.value=this.style("color").value),"inherit"!=M.value&&(i.fillStyle="none"==M.value?"rgba(0,0,0,0)":M.value)}if(this.style("fill-opacity").hasValue()){var M=new d.Property("fill",i.fillStyle);M=M.addOpacity(this.style("fill-opacity")),i.fillStyle=M.value}if(this.style("stroke").isUrlDefinition()){var R=this.style("stroke").getFillStyleDefinition(this,this.style("stroke-opacity"));null!=R&&(i.strokeStyle=R)}else if(this.style("stroke").hasValue()){var I=this.style("stroke");"currentColor"==I.value&&(I.value=this.style("color").value),"inherit"!=I.value&&(i.strokeStyle="none"==I.value?"rgba(0,0,0,0)":I.value)}if(this.style("stroke-opacity").hasValue()){var I=new d.Property("stroke",i.strokeStyle);I=I.addOpacity(this.style("stroke-opacity")),i.strokeStyle=I.value}if(this.style("stroke-width").hasValue()){var p=this.style("stroke-width").toPixels();i.lineWidth=0==p?.001:p}if(this.style("stroke-linecap").hasValue()&&(i.lineCap=this.style("stroke-linecap").value),this.style("stroke-linejoin").hasValue()&&(i.lineJoin=this.style("stroke-linejoin").value),this.style("stroke-miterlimit").hasValue()&&(i.miterLimit=this.style("stroke-miterlimit").value),this.style("stroke-dasharray").hasValue()&&"none"!=this.style("stroke-dasharray").value){var h=d.ToNumberArray(this.style("stroke-dasharray").value);void 0!==i.setLineDash?i.setLineDash(h):void 0!==i.webkitLineDash?i.webkitLineDash=h:void 0===i.mozDash||1==h.length&&0==h[0]||(i.mozDash=h);var z=this.style("stroke-dashoffset").numValueOrDefault(1);void 0!==i.lineDashOffset?i.lineDashOffset=z:void 0!==i.webkitLineDashOffset?i.webkitLineDashOffset=z:void 0!==i.mozDashOffset&&(i.mozDashOffset=z)}if(void 0!==i.font){var C=this.style("font-size"),y=d.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,C.hasValue()?C.toPixels()+"px":"",this.style("font-family").value);C!==d.EmptyProperty&&C.value!=y.fontSize&&(this.styles["font-size"]=new d.Property("font-size",y.fontSize)),i.font=y.toString()}this.style("text-align").hasValue()?i.textAlign=this.style("text-align").value:i.textAlign="start"}if(this.style("transform",!1,!0).hasValue()){new d.Transform(this.style("transform",!1,!0).value).apply(i)}if(this.style("clip-path",!1,!0).hasValue()){var b=this.style("clip-path",!1,!0).getDefinition();null!=b&&b.apply(i)}this.style("opacity").hasValue()&&(i.globalAlpha=this.style("opacity").numValue())}},d.Element.RenderedElementBase.prototype=new d.Element.ElementBase,d.Element.PathElementBase=function(i){this.base=d.Element.RenderedElementBase,this.base(i),this.path=function(i){return null!=i&&i.beginPath(),new d.BoundingBox},this.renderChildren=function(i){this.path(i),d.Mouse.checkPath(this,i),""!=i.fillStyle&&("inherit"!=this.style("fill-rule").valueOrDefault("inherit")?i.fill(this.style("fill-rule").value):i.fill()),""!=i.strokeStyle&&i.stroke();var H=this.getMarkers();if(null!=H){if(this.style("marker-start").isUrlDefinition()){var R=this.style("marker-start").getDefinition();if(!R)return;R.render(i,H[0][0],H[0][1],"start")}if(this.style("marker-mid").isUrlDefinition()){var R=this.style("marker-mid").getDefinition();if(!R)return;for(var M=1;M<H.length-1;M++)R.render(i,H[M][0],H[M][1],"mid",H[M-1][1])}if(this.style("marker-end").isUrlDefinition()){var R=this.style("marker-end").getDefinition();if(!R)return;R.render(i,H[H.length-1][0],H[H.length-1][1],"end")}}},this.getBoundingBox=function(){return this.path()},this.getMarkers=function(){return null}},d.Element.PathElementBase.prototype=new d.Element.RenderedElementBase,d.Element.svg=function(H){this.base=d.Element.RenderedElementBase,this.base(H),this.baseClearContext=this.clearContext,this.clearContext=function(i){this.baseClearContext(i),d.ViewPort.RemoveCurrent()},this.baseSetContext=this.setContext,this.setContext=function(H){H.strokeStyle="rgba(0,0,0,0)",H.lineCap="butt",H.lineJoin="miter",H.miterLimit=4,void 0!==H.font&&void 0!==i.getComputedStyle&&(H.font=i.getComputedStyle(H.canvas).getPropertyValue("font")),this.baseSetContext(H),this.attribute("x").hasValue()||(this.attribute("x",!0).value=0),this.attribute("y").hasValue()||(this.attribute("y",!0).value=0),H.translate(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var R=d.ViewPort.width(),M=d.ViewPort.height(),I=0,p=0;if(this.attribute("width").hasValue()||(this.attribute("width",!0).value="100%"),this.attribute("height").hasValue()||(this.attribute("height",!0).value="100%"),void 0===this.root&&(R=this.attribute("width").toPixels("x"),M=this.attribute("height").toPixels("y"),this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()&&(I=-this.attribute("refX").toPixels("x"),p=-this.attribute("refY").toPixels("y")),"visible"!=this.attribute("overflow").valueOrDefault("hidden")&&(H.beginPath(),H.moveTo(I,p),H.lineTo(R,p),H.lineTo(R,M),H.lineTo(I,M),H.closePath(),H.clip())),d.ViewPort.SetCurrent(R,M),this.attribute("viewBox").hasValue()){var h=d.ToNumberArray(this.attribute("viewBox").value),z=h[0],C=h[1];R=h[2],M=h[3],d.AspectRatio(H,this.attribute("preserveAspectRatio").value,d.ViewPort.width(),R,d.ViewPort.height(),M,z,C,this.attribute("refX").value,this.attribute("refY").value),d.ViewPort.RemoveCurrent(),d.ViewPort.SetCurrent(h[2],h[3])}else 0===I&&0===p||H.translate(I,p)}},d.Element.svg.prototype=new d.Element.RenderedElementBase,d.Element.rect=function(i){this.base=d.Element.PathElementBase,this.base(i),this.path=function(i){var H=this.attribute("x").toPixels("x"),R=this.attribute("y").toPixels("y"),M=this.attribute("width").toPixels("x"),I=this.attribute("height").toPixels("y"),p=this.attribute("rx").toPixels("x"),h=this.attribute("ry").toPixels("y");return this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()&&(h=p),this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()&&(p=h),p=Math.min(p,M/2),h=Math.min(h,I/2),null!=i&&(i.beginPath(),i.moveTo(H+p,R),i.lineTo(H+M-p,R),i.quadraticCurveTo(H+M,R,H+M,R+h),i.lineTo(H+M,R+I-h),i.quadraticCurveTo(H+M,R+I,H+M-p,R+I),i.lineTo(H+p,R+I),i.quadraticCurveTo(H,R+I,H,R+I-h),i.lineTo(H,R+h),i.quadraticCurveTo(H,R,H+p,R),i.closePath()),new d.BoundingBox(H,R,H+M,R+I)}},d.Element.rect.prototype=new d.Element.PathElementBase,d.Element.circle=function(i){this.base=d.Element.PathElementBase,this.base(i),this.path=function(i){var H=this.attribute("cx").toPixels("x"),R=this.attribute("cy").toPixels("y"),M=this.attribute("r").toPixels();return null!=i&&(i.beginPath(),i.arc(H,R,M,0,2*Math.PI,!0),i.closePath()),new d.BoundingBox(H-M,R-M,H+M,R+M)}},d.Element.circle.prototype=new d.Element.PathElementBase,d.Element.ellipse=function(i){this.base=d.Element.PathElementBase,this.base(i),this.path=function(i){var H=(Math.sqrt(2)-1)/3*4,R=this.attribute("rx").toPixels("x"),M=this.attribute("ry").toPixels("y"),I=this.attribute("cx").toPixels("x"),p=this.attribute("cy").toPixels("y");return null!=i&&(i.beginPath(),i.moveTo(I,p-M),i.bezierCurveTo(I+H*R,p-M,I+R,p-H*M,I+R,p),i.bezierCurveTo(I+R,p+H*M,I+H*R,p+M,I,p+M),i.bezierCurveTo(I-H*R,p+M,I-R,p+H*M,I-R,p),i.bezierCurveTo(I-R,p-H*M,I-H*R,p-M,I,p-M),i.closePath()),new d.BoundingBox(I-R,p-M,I+R,p+M)}},d.Element.ellipse.prototype=new d.Element.PathElementBase,d.Element.line=function(i){this.base=d.Element.PathElementBase,this.base(i),this.getPoints=function(){return[new d.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new d.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]},this.path=function(i){var H=this.getPoints();return null!=i&&(i.beginPath(),i.moveTo(H[0].x,H[0].y),i.lineTo(H[1].x,H[1].y)),new d.BoundingBox(H[0].x,H[0].y,H[1].x,H[1].y)},this.getMarkers=function(){var i=this.getPoints(),H=i[0].angleTo(i[1]);return[[i[0],H],[i[1],H]]}},d.Element.line.prototype=new d.Element.PathElementBase,d.Element.polyline=function(i){this.base=d.Element.PathElementBase,this.base(i),this.points=d.CreatePath(this.attribute("points").value),this.path=function(i){var H=new d.BoundingBox(this.points[0].x,this.points[0].y);null!=i&&(i.beginPath(),i.moveTo(this.points[0].x,this.points[0].y));for(var R=1;R<this.points.length;R++)H.addPoint(this.points[R].x,this.points[R].y),null!=i&&i.lineTo(this.points[R].x,this.points[R].y);return H},this.getMarkers=function(){for(var i=[],H=0;H<this.points.length-1;H++)i.push([this.points[H],this.points[H].angleTo(this.points[H+1])]);return i.length>0&&i.push([this.points[this.points.length-1],i[i.length-1][1]]),i}},d.Element.polyline.prototype=new d.Element.PathElementBase,d.Element.polygon=function(i){this.base=d.Element.polyline,this.base(i),this.basePath=this.path,this.path=function(i){var H=this.basePath(i);return null!=i&&(i.lineTo(this.points[0].x,this.points[0].y),i.closePath()),H}},d.Element.polygon.prototype=new d.Element.polyline,d.Element.path=function(i){this.base=d.Element.PathElementBase,this.base(i);var H=this.attribute("d").value;H=H.replace(/,/gm," ");for(var R=0;R<2;R++)H=H.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2");H=H.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),H=H.replace(/([0-9])([+\-])/gm,"$1 $2");for(var R=0;R<2;R++)H=H.replace(/(\.[0-9]*)(\.)/gm,"$1 $2");H=H.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 "),H=d.compressSpaces(H),H=d.trim(H),this.PathParser=new function(i){this.tokens=i.split(" "),this.reset=function(){this.i=-1,this.command="",this.previousCommand="",this.start=new d.Point(0,0),this.control=new d.Point(0,0),this.current=new d.Point(0,0),this.points=[],this.angles=[]},this.isEnd=function(){return this.i>=this.tokens.length-1},this.isCommandOrEnd=function(){return!!this.isEnd()||null!=this.tokens[this.i+1].match(/^[A-Za-z]$/)},this.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return!0}return!1},this.getToken=function(){return this.i++,this.tokens[this.i]},this.getScalar=function(){return parseFloat(this.getToken())},this.nextCommand=function(){this.previousCommand=this.command,this.command=this.getToken()},this.getPoint=function(){var i=new d.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(i)},this.getAsControlPoint=function(){var i=this.getPoint();return this.control=i,i},this.getAsCurrentPoint=function(){var i=this.getPoint();return this.current=i,i},this.getReflectedControlPoint=function(){return"c"!=this.previousCommand.toLowerCase()&&"s"!=this.previousCommand.toLowerCase()&&"q"!=this.previousCommand.toLowerCase()&&"t"!=this.previousCommand.toLowerCase()?this.current:new d.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y)},this.makeAbsolute=function(i){return this.isRelativeCommand()&&(i.x+=this.current.x,i.y+=this.current.y),i},this.addMarker=function(i,H,R){null!=R&&this.angles.length>0&&null==this.angles[this.angles.length-1]&&(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(R)),this.addMarkerAngle(i,null==H?null:H.angleTo(i))},this.addMarkerAngle=function(i,H){this.points.push(i),this.angles.push(H)},this.getMarkerPoints=function(){return this.points},this.getMarkerAngles=function(){for(var i=0;i<this.angles.length;i++)if(null==this.angles[i])for(var H=i+1;H<this.angles.length;H++)if(null!=this.angles[H]){this.angles[i]=this.angles[H];break}return this.angles}}(H),this.path=function(i){var H=this.PathParser;H.reset();var R=new d.BoundingBox;for(null!=i&&i.beginPath();!H.isEnd();)switch(H.nextCommand(),H.command){case"M":case"m":var M=H.getAsCurrentPoint();for(H.addMarker(M),R.addPoint(M.x,M.y),null!=i&&i.moveTo(M.x,M.y),H.start=H.current;!H.isCommandOrEnd();){var M=H.getAsCurrentPoint();H.addMarker(M,H.start),R.addPoint(M.x,M.y),null!=i&&i.lineTo(M.x,M.y)}break;case"L":case"l":for(;!H.isCommandOrEnd();){var I=H.current,M=H.getAsCurrentPoint();H.addMarker(M,I),R.addPoint(M.x,M.y),null!=i&&i.lineTo(M.x,M.y)}break;case"H":case"h":for(;!H.isCommandOrEnd();){var p=new d.Point((H.isRelativeCommand()?H.current.x:0)+H.getScalar(),H.current.y);H.addMarker(p,H.current),H.current=p,R.addPoint(H.current.x,H.current.y),null!=i&&i.lineTo(H.current.x,H.current.y)}break;case"V":case"v":for(;!H.isCommandOrEnd();){var p=new d.Point(H.current.x,(H.isRelativeCommand()?H.current.y:0)+H.getScalar());H.addMarker(p,H.current),H.current=p,R.addPoint(H.current.x,H.current.y),null!=i&&i.lineTo(H.current.x,H.current.y)}break;case"C":case"c":for(;!H.isCommandOrEnd();){var h=H.current,z=H.getPoint(),C=H.getAsControlPoint(),y=H.getAsCurrentPoint();H.addMarker(y,C,z),R.addBezierCurve(h.x,h.y,z.x,z.y,C.x,C.y,y.x,y.y),null!=i&&i.bezierCurveTo(z.x,z.y,C.x,C.y,y.x,y.y)}break;case"S":case"s":for(;!H.isCommandOrEnd();){var h=H.current,z=H.getReflectedControlPoint(),C=H.getAsControlPoint(),y=H.getAsCurrentPoint();H.addMarker(y,C,z),R.addBezierCurve(h.x,h.y,z.x,z.y,C.x,C.y,y.x,y.y),null!=i&&i.bezierCurveTo(z.x,z.y,C.x,C.y,y.x,y.y),H.previousCommand=H.command}break;case"Q":case"q":for(;!H.isCommandOrEnd();){var h=H.current,C=H.getAsControlPoint(),y=H.getAsCurrentPoint();H.addMarker(y,C,C),R.addQuadraticCurve(h.x,h.y,C.x,C.y,y.x,y.y),null!=i&&i.quadraticCurveTo(C.x,C.y,y.x,y.y)}break;case"T":case"t":for(;!H.isCommandOrEnd();){var h=H.current,C=H.getReflectedControlPoint();H.control=C;var y=H.getAsCurrentPoint();H.addMarker(y,C,C),R.addQuadraticCurve(h.x,h.y,C.x,C.y,y.x,y.y),null!=i&&i.quadraticCurveTo(C.x,C.y,y.x,y.y),H.previousCommand=H.command}break;case"A":case"a":for(;!H.isCommandOrEnd();){var h=H.current,b=H.getScalar(),U=H.getScalar(),K=H.getScalar()*(Math.PI/180),q=H.getScalar(),Q=H.getScalar(),y=H.getAsCurrentPoint(),m=new d.Point(Math.cos(K)*(h.x-y.x)/2+Math.sin(K)*(h.y-y.y)/2,-Math.sin(K)*(h.x-y.x)/2+Math.cos(K)*(h.y-y.y)/2),X=Math.pow(m.x,2)/Math.pow(b,2)+Math.pow(m.y,2)/Math.pow(U,2);if(X<1e-6)H.addMarker(y,h),R.addPoint(y.x,y.y),null!=i&&i.lineTo(y.x,y.y);else{X>1&&(b*=Math.sqrt(X),U*=Math.sqrt(X));var o=(q==Q?-1:1)*Math.sqrt((Math.pow(b,2)*Math.pow(U,2)-Math.pow(b,2)*Math.pow(m.y,2)-Math.pow(U,2)*Math.pow(m.x,2))/(Math.pow(b,2)*Math.pow(m.y,2)+Math.pow(U,2)*Math.pow(m.x,2)));isNaN(o)&&(o=0);var J=new d.Point(o*b*m.y/U,o*-U*m.x/b),O=new d.Point((h.x+y.x)/2+Math.cos(K)*J.x-Math.sin(K)*J.y,(h.y+y.y)/2+Math.sin(K)*J.x+Math.cos(K)*J.y),c=function(i){return Math.sqrt(Math.pow(i[0],2)+Math.pow(i[1],2))},t=function(i,H){return(i[0]*H[0]+i[1]*H[1])/(c(i)*c(H))},T=function(i,H){return(i[0]*H[1]<i[1]*H[0]?-1:1)*Math.acos(t(i,H))},N=T([1,0],[(m.x-J.x)/b,(m.y-J.y)/U]),D=[(m.x-J.x)/b,(m.y-J.y)/U],f=[(-m.x-J.x)/b,(-m.y-J.y)/U],n=T(D,f);t(D,f)<=-1&&(n=Math.PI),t(D,f)>=1&&(n=0);var G=1-Q?1:-1,k=N+G*(n/2),P=new d.Point(O.x+b*Math.cos(k),O.y+U*Math.sin(k));if(H.addMarkerAngle(P,k-G*Math.PI/2),H.addMarkerAngle(y,k-G*Math.PI),R.addPoint(y.x,y.y),null!=i){var t=b>U?b:U,Z=b>U?1:b/U,v=b>U?U/b:1;i.translate(O.x,O.y),i.rotate(K),i.scale(Z,v),i.arc(0,0,t,N,N+n,1-Q),i.scale(1/Z,1/v),i.rotate(-K),i.translate(-O.x,-O.y)}}}break;case"Z":case"z":null!=i&&i.closePath(),H.current=H.start}return R},this.getMarkers=function(){for(var i=this.PathParser.getMarkerPoints(),H=this.PathParser.getMarkerAngles(),R=[],M=0;M<i.length;M++)R.push([i[M],H[M]]);return R}},d.Element.path.prototype=new d.Element.PathElementBase,d.Element.pattern=function(i){this.base=d.Element.ElementBase,this.base(i),this.createPattern=function(i,H){var R=this.attribute("width").toPixels("x",!0),M=this.attribute("height").toPixels("y",!0),I=new d.Element.svg;I.attributes.viewBox=new d.Property("viewBox",this.attribute("viewBox").value),I.attributes.width=new d.Property("width",R+"px"),I.attributes.height=new d.Property("height",M+"px"),I.attributes.transform=new d.Property("transform",this.attribute("patternTransform").value),I.children=this.children;var p=document.createElement("canvas");p.width=R,p.height=M;var h=p.getContext("2d");this.attribute("x").hasValue()&&this.attribute("y").hasValue()&&h.translate(this.attribute("x").toPixels("x",!0),this.attribute("y").toPixels("y",!0));for(var z=-1;z<=1;z++)for(var C=-1;C<=1;C++)h.save(),I.attributes.x=new d.Property("x",z*p.width),I.attributes.y=new d.Property("y",C*p.height),I.render(h),h.restore();return i.createPattern(p,"repeat")}},d.Element.pattern.prototype=new d.Element.ElementBase,d.Element.marker=function(i){this.base=d.Element.ElementBase,this.base(i),this.baseRender=this.render,this.render=function(i,H,M,I,p){if(p!==R){M=(M+p)/2;var h=(M-p)%(2*Math.PI);Math.abs(h)>Math.PI&&(M+=Math.PI)}if(H){i.save(),i.translate(H.x,H.y);var z=this.attribute("orient").valueOrDefault("auto")||"";"auto"===z?i.rotate(M):"auto-start-reverse"===z?i.rotate("start"===I?M+Math.PI:M):z&&i.rotate(new d.Property("angle",z).toRadians()),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&i.scale(i.lineWidth,i.lineWidth);var C=new d.Element.svg;C.attributes.viewBox=new d.Property("viewBox",this.attribute("viewBox").value),C.attributes.refX=new d.Property("refX",this.attribute("refX").value),C.attributes.refY=new d.Property("refY",this.attribute("refY").value),C.attributes.width=new d.Property("width",this.attribute("markerWidth").value),C.attributes.height=new d.Property("height",this.attribute("markerHeight").value),C.attributes.fill=new d.Property("fill",this.attribute("fill").valueOrDefault("black")),C.attributes.stroke=new d.Property("stroke",this.attribute("stroke").valueOrDefault("none")),C.children=this.children,C.render(i),i.restore()}}},d.Element.marker.prototype=new d.Element.ElementBase,d.Element.defs=function(i){this.base=d.Element.ElementBase,this.base(i),this.render=function(i){}},d.Element.defs.prototype=new d.Element.ElementBase,d.Element.GradientBase=function(i){this.base=d.Element.ElementBase,this.base(i),this.stops=[];for(var H=0;H<this.children.length;H++){var R=this.children[H];"stop"==R.type&&this.stops.push(R)}this.getGradient=function(){},this.gradientUnits=function(){return this.attribute("gradientUnits").valueOrDefault("objectBoundingBox")},this.attributesToInherit=["gradientUnits","gradientTransform"],this.inheritStopContainer=function(i){for(var H=0;H<this.attributesToInherit.length;H++){var R=this.attributesToInherit[H];!this.attribute(R).hasValue()&&i.attribute(R).hasValue()&&(this.attribute(R,!0).value=i.attribute(R).value)}},this.createGradient=function(i,H,R){var I=this;this.getHrefAttribute().hasValue()&&(I=this.getHrefAttribute().getDefinition(),this.inheritStopContainer(I));var p=function(i){if(R.hasValue()){return new d.Property("color",i).addOpacity(R).value}return i},h=this.getGradient(i,H);if(null==h)return p(I.stops[I.stops.length-1].color);for(var z=0;z<I.stops.length;z++)h.addColorStop(I.stops[z].offset,p(I.stops[z].color));if(this.attribute("gradientTransform").hasValue()){var C=d.ViewPort.viewPorts[0],y=new d.Element.rect;y.attributes.x=new d.Property("x",-d.MAX_VIRTUAL_PIXELS/3),y.attributes.y=new d.Property("y",-d.MAX_VIRTUAL_PIXELS/3),y.attributes.width=new d.Property("width",d.MAX_VIRTUAL_PIXELS),y.attributes.height=new d.Property("height",d.MAX_VIRTUAL_PIXELS);var b=new d.Element.g,U=H.getBoundingBox(),K=new M.Math.Matrix2d;"objectBoundingBox"==this.gradientUnits()&&K.appendTranslate(U.x1,U.y1).appendScale(U.x2-U.x1,U.y2-U.y1);var q=K.clone().invert(),Q=(new M.Math.Matrix2d).fromArray(new d.Transform(this.attribute("gradientTransform").value).getMatrix());K.append(Q).append(q),b.attributes.transform=new d.Property("transform","matrix("+K.toArray().join(" ")+")"),b.children=[y];var m=new d.Element.svg;m.attributes.x=new d.Property("x",0),m.attributes.y=new d.Property("y",0),m.attributes.width=new d.Property("width",C.width),m.attributes.height=new d.Property("height",C.height),m.children=[b];var X=document.createElement("canvas");X.width=C.width,X.height=C.height;var o=X.getContext("2d");o.fillStyle=h,m.render(o);var J=o.createPattern(X,"no-repeat");return J.gradient=h,J.gradientTransform=this.attribute("gradientTransform").value,J.trans=K.toArray(),J}return h}},d.Element.GradientBase.prototype=new d.Element.ElementBase,d.Element.linearGradient=function(i){this.base=d.Element.GradientBase,this.base(i),this.attributesToInherit.push("x1"),this.attributesToInherit.push("y1"),this.attributesToInherit.push("x2"),this.attributesToInherit.push("y2"),this.getGradient=function(i,H){var R="objectBoundingBox"==this.gradientUnits()?H.getBoundingBox(i):null;this.attribute("x1").hasValue()||this.attribute("y1").hasValue()||this.attribute("x2").hasValue()||this.attribute("y2").hasValue()||(this.attribute("x1",!0).value=0,this.attribute("y1",!0).value=0,this.attribute("x2",!0).value=1,this.attribute("y2",!0).value=0)
;var M="objectBoundingBox"==this.gradientUnits()?R.x()+R.width()*this.attribute("x1").numValue():this.attribute("x1").toPixels("x"),I="objectBoundingBox"==this.gradientUnits()?R.y()+R.height()*this.attribute("y1").numValue():this.attribute("y1").toPixels("y"),p="objectBoundingBox"==this.gradientUnits()?R.x()+R.width()*this.attribute("x2").numValue():this.attribute("x2").toPixels("x"),h="objectBoundingBox"==this.gradientUnits()?R.y()+R.height()*this.attribute("y2").numValue():this.attribute("y2").toPixels("y");return M==p&&I==h?null:i.createLinearGradient(M,I,p,h)}},d.Element.linearGradient.prototype=new d.Element.GradientBase,d.Element.radialGradient=function(i){this.base=d.Element.GradientBase,this.base(i),this.attributesToInherit.push("cx"),this.attributesToInherit.push("cy"),this.attributesToInherit.push("r"),this.attributesToInherit.push("fx"),this.attributesToInherit.push("fy"),this.getGradient=function(i,H){var R=H.getBoundingBox();this.attribute("cx").hasValue()||(this.attribute("cx",!0).value="50%"),this.attribute("cy").hasValue()||(this.attribute("cy",!0).value="50%"),this.attribute("r").hasValue()||(this.attribute("r",!0).value="50%");var M="objectBoundingBox"==this.gradientUnits()?R.x()+R.width()*this.attribute("cx").numValue():this.attribute("cx").toPixels("x"),I="objectBoundingBox"==this.gradientUnits()?R.y()+R.height()*this.attribute("cy").numValue():this.attribute("cy").toPixels("y"),p=M,h=I;this.attribute("fx").hasValue()&&(p="objectBoundingBox"==this.gradientUnits()?R.x()+R.width()*this.attribute("fx").numValue():this.attribute("fx").toPixels("x")),this.attribute("fy").hasValue()&&(h="objectBoundingBox"==this.gradientUnits()?R.y()+R.height()*this.attribute("fy").numValue():this.attribute("fy").toPixels("y"));var z="objectBoundingBox"==this.gradientUnits()?(R.width()+R.height())/2*this.attribute("r").numValue():this.attribute("r").toPixels();return i.createRadialGradient(p,h,0,M,I,z)}},d.Element.radialGradient.prototype=new d.Element.GradientBase,d.Element.stop=function(i){this.base=d.Element.ElementBase,this.base(i),this.offset=this.attribute("offset").numValue(),this.offset<0&&(this.offset=0),this.offset>1&&(this.offset=1);var H=this.style("stop-color",!0);""===H.value&&(H.value="#000"),this.style("stop-opacity").hasValue()&&(H=H.addOpacity(this.style("stop-opacity"))),this.color=H.value},d.Element.stop.prototype=new d.Element.ElementBase,d.Element.AnimateBase=function(i){this.base=d.Element.ElementBase,this.base(i),d.Animations.push(this),this.duration=0,this.begin=this.attribute("begin").toMilliseconds(),this.maxDuration=this.begin+this.attribute("dur").toMilliseconds(),this.getProperty=function(){var i=this.attribute("attributeType").value,H=this.attribute("attributeName").value;return"CSS"==i?this.parent.style(H,!0):this.parent.attribute(H,!0)},this.initialValue=null,this.initialUnits="",this.removed=!1,this.calcValue=function(){return""},this.update=function(i){if(null==this.initialValue&&(this.initialValue=this.getProperty().value,this.initialUnits=this.getProperty().getUnits()),this.duration>this.maxDuration){if("indefinite"==this.attribute("repeatCount").value||"indefinite"==this.attribute("repeatDur").value)this.duration=0;else if("freeze"!=this.attribute("fill").valueOrDefault("remove")||this.frozen){if("remove"==this.attribute("fill").valueOrDefault("remove")&&!this.removed)return this.removed=!0,this.getProperty().value=this.parent.animationFrozen?this.parent.animationFrozenValue:this.initialValue,!0}else this.frozen=!0,this.parent.animationFrozen=!0,this.parent.animationFrozenValue=this.getProperty().value;return!1}this.duration=this.duration+i;var H=!1;if(this.begin<this.duration){var R=this.calcValue();if(this.attribute("type").hasValue()){R=this.attribute("type").value+"("+R+")"}this.getProperty().value=R,H=!0}return H},this.from=this.attribute("from"),this.to=this.attribute("to"),this.values=this.attribute("values"),this.values.hasValue()&&(this.values.value=this.values.value.split(";")),this.progress=function(){var i={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(this.values.hasValue()){var H=i.progress*(this.values.value.length-1),R=Math.floor(H),M=Math.ceil(H);i.from=new d.Property("from",parseFloat(this.values.value[R])),i.to=new d.Property("to",parseFloat(this.values.value[M])),i.progress=(H-R)/(M-R)}else i.from=this.from,i.to=this.to;return i}},d.Element.AnimateBase.prototype=new d.Element.ElementBase,d.Element.animate=function(i){this.base=d.Element.AnimateBase,this.base(i),this.calcValue=function(){var i=this.progress();return i.from.numValue()+(i.to.numValue()-i.from.numValue())*i.progress+this.initialUnits}},d.Element.animate.prototype=new d.Element.AnimateBase,d.Element.animateColor=function(i){this.base=d.Element.AnimateBase,this.base(i),this.calcValue=function(){var i=this.progress(),R=new H(i.from.value),M=new H(i.to.value);if(R.ok&&M.ok){var I=R.r+(M.r-R.r)*i.progress,p=R.g+(M.g-R.g)*i.progress,h=R.b+(M.b-R.b)*i.progress;return"rgb("+parseInt(I,10)+","+parseInt(p,10)+","+parseInt(h,10)+")"}return this.attribute("from").value}},d.Element.animateColor.prototype=new d.Element.AnimateBase,d.Element.animateTransform=function(i){this.base=d.Element.AnimateBase,this.base(i),this.calcValue=function(){for(var i=this.progress(),H=d.ToNumberArray(i.from.value),R=d.ToNumberArray(i.to.value),M="",I=0;I<H.length;I++)M+=H[I]+(R[I]-H[I])*i.progress+" ";return M}},d.Element.animateTransform.prototype=new d.Element.animate,d.Element.font=function(i){this.base=d.Element.ElementBase,this.base(i),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.isRTL=!1,this.isArabic=!1,this.fontFace=null,this.missingGlyph=null,this.glyphs=[];for(var H=0;H<this.children.length;H++){var R=this.children[H];"font-face"==R.type?(this.fontFace=R,R.style("font-family").hasValue()&&(d.Definitions[R.style("font-family").value]=this)):"missing-glyph"==R.type?this.missingGlyph=R:"glyph"==R.type&&(""!=R.arabicForm?(this.isRTL=!0,this.isArabic=!0,void 0===this.glyphs[R.unicode]&&(this.glyphs[R.unicode]=[]),this.glyphs[R.unicode][R.arabicForm]=R):this.glyphs[R.unicode]=R)}},d.Element.font.prototype=new d.Element.ElementBase,d.Element.fontface=function(i){this.base=d.Element.ElementBase,this.base(i),this.ascent=this.attribute("ascent").value,this.descent=this.attribute("descent").value,this.unitsPerEm=this.attribute("units-per-em").numValue()},d.Element.fontface.prototype=new d.Element.ElementBase,d.Element.missingglyph=function(i){this.base=d.Element.path,this.base(i),this.horizAdvX=0},d.Element.missingglyph.prototype=new d.Element.path,d.Element.glyph=function(i){this.base=d.Element.path,this.base(i),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.unicode=this.attribute("unicode").value,this.arabicForm=this.attribute("arabic-form").value},d.Element.glyph.prototype=new d.Element.path,d.Element.text=function(i){this.captureTextNodes=!0,this.base=d.Element.RenderedElementBase,this.base(i),this.baseSetContext=this.setContext,this.setContext=function(i){this.baseSetContext(i);var H=this.style("dominant-baseline").toTextBaseline();null==H&&(H=this.style("alignment-baseline").toTextBaseline()),null!=H&&(i.textBaseline=H)},this.getBoundingBox=function(){var i=this.attribute("x").toPixels("x"),H=this.attribute("y").toPixels("y"),R=this.parent.style("font-size").numValueOrDefault(d.Font.Parse(d.ctx.font).fontSize);return new d.BoundingBox(i,H-R,i+Math.floor(2*R/3)*this.children[0].getText().length,H)},this.renderChildren=function(i){this.x=this.attribute("x").toPixels("x"),this.y=this.attribute("y").toPixels("y"),this.attribute("dx").hasValue()&&(this.x+=this.attribute("dx").toPixels("x")),this.attribute("dy").hasValue()&&(this.y+=this.attribute("dy").toPixels("y")),this.x+=this.getAnchorDelta(i,this,0);for(var H=0;H<this.children.length;H++)this.renderChild(i,this,this,H)},this.getAnchorDelta=function(i,H,R){var M=this.style("text-anchor").valueOrDefault("start");if("start"!=M){for(var I=0,p=R;p<H.children.length;p++){var h=H.children[p];if(p>R&&h.attribute("x").hasValue())break;h.measureTextRecursive&&(I+=h.measureTextRecursive(i))}return-1*("end"==M?I:I/2)}return 0},this.renderChild=function(i,H,R,M){var I=R.children[M];I.attribute("x").hasValue()?(I.x=I.attribute("x").toPixels("x")+H.getAnchorDelta(i,R,M),I.attribute("dx").hasValue()&&(I.x+=I.attribute("dx").toPixels("x"))):(I.attribute("dx").hasValue()&&(H.x+=I.attribute("dx").toPixels("x")),I.x=H.x),H.x=I.x+(I.measureText?I.measureText(i):0),I.attribute("y").hasValue()?(I.y=I.attribute("y").toPixels("y"),I.attribute("dy").hasValue()&&(I.y+=I.attribute("dy").toPixels("y"))):(I.attribute("dy").hasValue()&&(H.y+=I.attribute("dy").toPixels("y")),I.y=H.y),H.y=I.y,I.render(i);for(var M=0;M<I.children.length;M++)H.renderChild(i,H,I,M)}},d.Element.text.prototype=new d.Element.RenderedElementBase,d.Element.TextElementBase=function(i){this.base=d.Element.RenderedElementBase,this.base(i),this.getGlyph=function(i,H,R){var M=H[R],I=null;if(i.isArabic){var p="isolated";(0==R||" "==H[R-1])&&R<H.length-2&&" "!=H[R+1]&&(p="terminal"),R>0&&" "!=H[R-1]&&R<H.length-2&&" "!=H[R+1]&&(p="medial"),R>0&&" "!=H[R-1]&&(R==H.length-1||" "==H[R+1])&&(p="initial"),void 0!==i.glyphs[M]&&null==(I=i.glyphs[M][p])&&"glyph"==i.glyphs[M].type&&(I=i.glyphs[M])}else I=i.glyphs[M];return null==I&&(I=i.missingGlyph),I},this.renderChildren=function(i){var H=this.parent.style("font-family").getDefinition();if(null==H)""!=i.fillStyle&&i.fillText(d.compressSpaces(this.getText()),this.x,this.y),""!=i.strokeStyle&&i.strokeText(d.compressSpaces(this.getText()),this.x,this.y);else{var R=this.parent.style("font-size").numValueOrDefault(d.Font.Parse(d.ctx.font).fontSize),M=this.parent.style("font-style").valueOrDefault(d.Font.Parse(d.ctx.font).fontStyle),I=this.getText();H.isRTL&&(I=I.split("").reverse().join(""));for(var p=d.ToNumberArray(this.parent.attribute("dx").value),h=0;h<I.length;h++){var z=this.getGlyph(H,I,h),C=R/H.fontFace.unitsPerEm;i.translate(this.x,this.y),i.scale(C,-C);var y=i.lineWidth;i.lineWidth=i.lineWidth*H.fontFace.unitsPerEm/R,"italic"==M&&i.transform(1,0,.4,1,0,0),z.render(i),"italic"==M&&i.transform(1,0,-.4,1,0,0),i.lineWidth=y,i.scale(1/C,-1/C),i.translate(-this.x,-this.y),this.x+=R*(z.horizAdvX||H.horizAdvX)/H.fontFace.unitsPerEm,void 0===p[h]||isNaN(p[h])||(this.x+=p[h])}}},this.getText=function(){},this.measureTextRecursive=function(i){for(var H=this.measureText(i),R=0;R<this.children.length;R++)H+=this.children[R].measureTextRecursive(i);return H},this.measureText=function(i){var H=this.parent.style("font-family").getDefinition();if(null!=H){var R=this.parent.style("font-size").numValueOrDefault(d.Font.Parse(d.ctx.font).fontSize),M=0,I=this.getText();H.isRTL&&(I=I.split("").reverse().join(""));for(var p=d.ToNumberArray(this.parent.attribute("dx").value),h=0;h<I.length;h++){M+=(this.getGlyph(H,I,h).horizAdvX||H.horizAdvX)*R/H.fontFace.unitsPerEm,void 0===p[h]||isNaN(p[h])||(M+=p[h])}return M}var z=d.compressSpaces(this.getText());if(!i.measureText)return 10*z.length;i.save(),this.setContext(i,!0);var C=i.measureText(z).width;return i.restore(),C},this.getBoundingBox=function(i){var H=this.parent.style("font-size").numValueOrDefault(d.Font.Parse(d.ctx.font).fontSize);return new d.BoundingBox(this.x,this.y-H,this.x+this.measureText(i),this.y)}},d.Element.TextElementBase.prototype=new d.Element.RenderedElementBase,d.Element.tspan=function(i){this.captureTextNodes=!0,this.base=d.Element.TextElementBase,this.base(i),this.text=d.compressSpaces(i.value||i.text||i.textContent||""),this.getText=function(){return this.children.length>0?"":this.text}},d.Element.tspan.prototype=new d.Element.TextElementBase,d.Element.tref=function(i){this.base=d.Element.TextElementBase,this.base(i),this.getText=function(){var i=this.getHrefAttribute().getDefinition();if(null!=i)return i.children[0].getText()}},d.Element.tref.prototype=new d.Element.TextElementBase,d.Element.a=function(H){this.base=d.Element.TextElementBase,this.base(H),this.hasText=H.childNodes.length>0;for(var R=0;R<H.childNodes.length;R++)3!=H.childNodes[R].nodeType&&(this.hasText=!1);this.text=this.hasText?H.childNodes[0].value:"",this.getText=function(){return this.text},this.baseRenderChildren=this.renderChildren,this.renderChildren=function(i){if(this.hasText){this.baseRenderChildren(i);var H=new d.Property("fontSize",d.Font.Parse(d.ctx.font).fontSize);d.Mouse.checkBoundingBox(this,new d.BoundingBox(this.x,this.y-H.toPixels("y"),this.x+this.measureText(i),this.y))}else if(this.children.length>0){var R=new d.Element.g;R.children=this.children,R.parent=this,R.render(i)}},this.onclick=function(){i.open(this.getHrefAttribute().value)},this.onmousemove=function(){d.ctx.canvas.style.cursor="pointer"}},d.Element.a.prototype=new d.Element.TextElementBase,d.Element.image=function(i){this.base=d.Element.RenderedElementBase,this.base(i);var H=this.getHrefAttribute().value;if(""!=H){var R=H.match(/\.svg$/);if(d.Images.push(this),this.loaded=!1,R)this.img=d.ajax(H),this.loaded=!0;else{this.img=document.createElement("img"),1==d.opts.useCORS&&(this.img.crossOrigin="Anonymous");var M=this;this.img.onload=function(){M.loaded=!0},this.img.onerror=function(){d.log('ERROR: image "'+H+'" not found'),M.loaded=!0},this.img.src=H}this.renderChildren=function(i){var H=this.attribute("x").toPixels("x"),M=this.attribute("y").toPixels("y"),I=this.attribute("width").toPixels("x"),p=this.attribute("height").toPixels("y");0!=I&&0!=p&&(i.save(),R?i.drawSvg(this.img,H,M,I,p):(i.translate(H,M),d.AspectRatio(i,this.attribute("preserveAspectRatio").value,I,this.img.width,p,this.img.height,0,0),i.drawImage(this.img,0,0)),i.restore())},this.getBoundingBox=function(){var i=this.attribute("x").toPixels("x"),H=this.attribute("y").toPixels("y"),R=this.attribute("width").toPixels("x"),M=this.attribute("height").toPixels("y");return new d.BoundingBox(i,H,i+R,H+M)}}},d.Element.image.prototype=new d.Element.RenderedElementBase,d.Element.g=function(i){this.base=d.Element.RenderedElementBase,this.base(i),this.getBoundingBox=function(){for(var i=new d.BoundingBox,H=0;H<this.children.length;H++)i.addBoundingBox(this.children[H].getBoundingBox());return i}},d.Element.g.prototype=new d.Element.RenderedElementBase,d.Element.symbol=function(i){this.base=d.Element.RenderedElementBase,this.base(i),this.render=function(i){}},d.Element.symbol.prototype=new d.Element.RenderedElementBase,d.Element.switch=function(i){this.base=d.Element.RenderedElementBase,this.base(i)},d.Element.switch.prototype=new d.Element.symbol,d.Element.style=function(i){this.base=d.Element.ElementBase,this.base(i);for(var H="",R=0;R<i.childNodes.length;R++)H+=i.childNodes[R].data;H=H.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,""),H=d.compressSpaces(H);for(var M=H.split("}"),R=0;R<M.length;R++)if(""!=d.trim(M[R]))for(var I=M[R].split("{"),h=I[0].split(","),z=I[1].split(";"),C=0;C<h.length;C++){var y=d.trim(h[C]);if(""!=y){for(var b=d.Styles[y]||{},U=0;U<z.length;U++){var K=z[U].indexOf(":"),q=z[U].substr(0,K),Q=z[U].substr(K+1,z[U].length-K);null!=q&&null!=Q&&(b[d.trim(q)]=new d.Property(d.trim(q),d.trim(Q)))}if(d.Styles[y]=b,d.StylesSpecificity[y]=p(y),"@font-face"==y)for(var m=b["font-family"].value.replace(/"/g,""),X=b.src.value.split(","),o=0;o<X.length;o++)if(X[o].indexOf('format("svg")')>0)for(var J=X[o].indexOf("url"),O=X[o].indexOf(")",J),c=X[o].substr(J+5,O-J-6),t=d.parseXml(d.ajax(c)),T=t.getElementsByTagName("font"),N=0;N<T.length;N++){var D=d.CreateElement(T[N]);d.Definitions[m]=D}}}},d.Element.style.prototype=new d.Element.ElementBase,d.Element.use=function(i){this.base=d.Element.RenderedElementBase,this.base(i),this.baseSetContext=this.setContext,this.setContext=function(i){this.baseSetContext(i),this.attribute("x").hasValue()&&i.translate(this.attribute("x").toPixels("x"),0),this.attribute("y").hasValue()&&i.translate(0,this.attribute("y").toPixels("y"))};var H=this.getHrefAttribute().getDefinition();this.path=function(i){null!=H&&H.path(i)},this.getBoundingBox=function(){if(null!=H)return H.getBoundingBox()},this.renderChildren=function(i){if(null!=H){var R=H;"symbol"==H.type&&(R=new d.Element.svg,R.type="svg",R.attributes.viewBox=new d.Property("viewBox",H.attribute("viewBox").value),R.attributes.preserveAspectRatio=new d.Property("preserveAspectRatio",H.attribute("preserveAspectRatio").value),R.attributes.overflow=new d.Property("overflow",H.attribute("overflow").value),R.children=H.children),"svg"==R.type&&(this.attribute("width").hasValue()&&(R.attributes.width=new d.Property("width",this.attribute("width").value)),this.attribute("height").hasValue()&&(R.attributes.height=new d.Property("height",this.attribute("height").value)));var M=R.parent;R.parent=null,R.render(i),R.parent=M}}},d.Element.use.prototype=new d.Element.RenderedElementBase,d.Element.mask=function(i){this.base=d.Element.ElementBase,this.base(i),this.apply=function(i,H){var R=this.attribute("x").toPixels("x"),M=this.attribute("y").toPixels("y"),I=this.attribute("width").toPixels("x"),p=this.attribute("height").toPixels("y"),h=1;if(0==I&&0==p){for(var z=new d.BoundingBox,C=0;C<this.children.length;C++)this.children[C].getBoundingBox&&z.addBoundingBox(this.children[C].getBoundingBox());R=Math.floor(z.x1),M=Math.floor(z.y1),I=Math.floor(z.width()),p=Math.floor(z.height())}if(I&&p){var y=R+I,b=M+p;(y>2048||b>2048)&&(h=Math.min(2048/y,2048/b),y*=h,b*=h);var U=H.style("mask").value;H.style("mask").value="";var K=document.createElement("canvas");K.width=y,K.height=b;var q=K.getContext("2d");if(q.save(),1!==h&&q.scale(h,h),this.renderChildren(q),q.restore(),K.width&&K.height){var Q=document.createElement("canvas");Q.width=y,Q.height=b;var m=Q.getContext("2d");m.save(),1!==h&&m.scale(h,h),H.render(m),m.restore(),m.globalCompositeOperation="destination-in",m.fillStyle=q.createPattern(K,"no-repeat"),m.fillRect(0,0,y,b),i.save(),1!==h&&i.scale(1/h,1/h),i.fillStyle=m.createPattern(Q,"no-repeat"),i.fillRect(0,0,y,b),i.restore(),H.style("mask").value=U}}},this.render=function(i){}},d.Element.mask.prototype=new d.Element.ElementBase,d.Element.clipPath=function(i){this.base=d.Element.ElementBase,this.base(i),this.apply=function(i){var H=i.beginPath;i.beginPath=function(){};var R=i.closePath;i.closePath=function(){};var M;this.style("transform",!1,!0).hasValue()&&(M=new d.Transform(this.style("transform",!1,!0).value),M.apply(i)),H.call(i);for(var I=0;I<this.children.length;I++){var p=this.children[I];if(void 0!==p.path){var h=null;p.style("transform",!1,!0).hasValue()&&(h=new d.Transform(p.style("transform",!1,!0).value),h.apply(i)),p.path(i),i.closePath=R,h&&h.unapply(i)}}R.call(i),i.clip(),M&&M.unapply(i),i.beginPath=H,i.closePath=R},this.render=function(i){}},d.Element.clipPath.prototype=new d.Element.ElementBase,d.Element.filter=function(i){this.base=d.Element.ElementBase,this.base(i),this.apply=function(i,H){return},this.render=function(i){}},d.Element.filter.prototype=new d.Element.ElementBase,d.Element.feMorphology=function(i){this.base=d.Element.ElementBase,this.base(i),this.apply=function(i,H,R,M,I){}},d.Element.feMorphology.prototype=new d.Element.ElementBase,d.Element.feComposite=function(i){this.base=d.Element.ElementBase,this.base(i),this.apply=function(i,H,R,M,I){}},d.Element.feComposite.prototype=new d.Element.ElementBase,d.Element.feColorMatrix=function(i){function H(i,H,R,M,I,p){return i[R*M*4+4*H+p]}function R(i,H,R,M,I,p,h){i[R*M*4+4*H+p]=h}function M(i,H){var R=I[i];return R*(R<0?H-255:H)}this.base=d.Element.ElementBase,this.base(i);var I=d.ToNumberArray(this.attribute("values").value);switch(this.attribute("type").valueOrDefault("matrix")){case"saturate":var p=I[0];I=[.213+.787*p,.715-.715*p,.072-.072*p,0,0,.213-.213*p,.715+.285*p,.072-.072*p,0,0,.213-.213*p,.715-.715*p,.072+.928*p,0,0,0,0,0,1,0,0,0,0,0,1];break;case"hueRotate":var h=I[0]*Math.PI/180,z=function(i,H,R){return i+Math.cos(h)*H+Math.sin(h)*R};I=[z(.213,.787,-.213),z(.715,-.715,-.715),z(.072,-.072,.928),0,0,z(.213,-.213,.143),z(.715,.285,.14),z(.072,-.072,-.283),0,0,z(.213,-.213,-.787),z(.715,-.715,.715),z(.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break;case"luminanceToAlpha":I=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1]}this.apply=function(i,I,p,h,z){if(h&&z){for(var d=i.getImageData(0,0,h,z),p=0;p<z;p++)for(var I=0;I<h;I++){var C=H(d.data,I,p,h,z,0),y=H(d.data,I,p,h,z,1),b=H(d.data,I,p,h,z,2),U=H(d.data,I,p,h,z,3);R(d.data,I,p,h,z,0,M(0,C)+M(1,y)+M(2,b)+M(3,U)+M(4,1)),R(d.data,I,p,h,z,1,M(5,C)+M(6,y)+M(7,b)+M(8,U)+M(9,1)),R(d.data,I,p,h,z,2,M(10,C)+M(11,y)+M(12,b)+M(13,U)+M(14,1)),R(d.data,I,p,h,z,3,M(15,C)+M(16,y)+M(17,b)+M(18,U)+M(19,1))}i.clearRect(0,0,h,z),i.putImageData(d,0,0)}}},d.Element.feColorMatrix.prototype=new d.Element.ElementBase,d.Element.feGaussianBlur=function(i){this.base=d.Element.ElementBase,this.base(i),this.blurRadius=Math.floor(this.attribute("stdDeviation").numValue()),this.extraFilterDistance=this.blurRadius,this.apply=function(i,H,R,M,p){if(void 0===I.canvasRGBA)return void d.log("ERROR: StackBlur.js must be included for blur to work");i.canvas.id=d.UniqueId(),i.canvas.style.display="none",document.body.appendChild(i.canvas),I.canvasRGBA(i.canvas.id,H,R,M,p,this.blurRadius),document.body.removeChild(i.canvas)}},d.Element.feGaussianBlur.prototype=new d.Element.ElementBase,d.Element.title=function(i){},d.Element.title.prototype=new d.Element.ElementBase,d.Element.desc=function(i){},d.Element.desc.prototype=new d.Element.ElementBase,d.Element.MISSING=function(i){d.log("ERROR: Element '"+i.nodeName+"' not yet implemented.")},d.Element.MISSING.prototype=new d.Element.ElementBase,d.CreateElement=function(i){var H=i.nodeName.replace(/^[^:]+:/,"");H=H.replace(/\-/g,"");var R=null;return R=void 0!==d.Element[H]?new d.Element[H](i):new d.Element.MISSING(i),R.type=i.nodeName,R},d.load=function(i,H){d.loadXml(i,d.ajax(H))},d.loadXml=function(i,H){d.loadXmlDoc(i,d.parseXml(H))},d.loadXmlDoc=function(H,R){d.init(H);var M=function(R){for(var M=H.canvas;M;)R.x-=M.offsetLeft,R.y-=M.offsetTop,M=M.offsetParent;return i.scrollX&&(R.x+=i.scrollX),i.scrollY&&(R.y+=i.scrollY),R};1!=d.opts.ignoreMouse&&(H.canvas.onclick=function(i){var H=M(new d.Point(null!=i?i.clientX:event.clientX,null!=i?i.clientY:event.clientY));d.Mouse.onclick(H.x,H.y)},H.canvas.onmousemove=function(i){var H=M(new d.Point(null!=i?i.clientX:event.clientX,null!=i?i.clientY:event.clientY));d.Mouse.onmousemove(H.x,H.y)});var I=d.CreateElement(R.documentElement);I.root=!0,I.addStylesFromStyleDefinition();var p=!0,h=function(){var i=!1;H.canvas.parentElement||(i=!0,document.body.appendChild(H.canvas)),d.ViewPort.Clear(),H.canvas.parentNode&&d.ViewPort.SetCurrent(H.canvas.parentNode.clientWidth,H.canvas.parentNode.clientHeight),1!=d.opts.ignoreDimensions&&(I.style("width").hasValue()&&(H.canvas.width=I.style("width").toPixels("x"),H.canvas.style.width=H.canvas.width+"px"),I.style("height").hasValue()&&(H.canvas.height=I.style("height").toPixels("y"),H.canvas.style.height=H.canvas.height+"px"));var M=H.canvas.clientWidth||H.canvas.width,h=H.canvas.clientHeight||H.canvas.height;if(1==d.opts.ignoreDimensions&&I.style("width").hasValue()&&I.style("height").hasValue()&&(M=I.style("width").toPixels("x"),h=I.style("height").toPixels("y")),d.ViewPort.SetCurrent(M,h),null!=d.opts.offsetX&&(I.attribute("x",!0).value=d.opts.offsetX),null!=d.opts.offsetY&&(I.attribute("y",!0).value=d.opts.offsetY),null!=d.opts.scaleWidth||null!=d.opts.scaleHeight){var z=null,C=null,y=d.ToNumberArray(I.attribute("viewBox").value);null!=d.opts.scaleWidth&&(I.attribute("width").hasValue()?z=I.attribute("width").toPixels("x")/d.opts.scaleWidth:isNaN(y[2])||(z=y[2]/d.opts.scaleWidth)),null!=d.opts.scaleHeight&&(I.attribute("height").hasValue()?C=I.attribute("height").toPixels("y")/d.opts.scaleHeight:isNaN(y[3])||(C=y[3]/d.opts.scaleHeight)),null==z&&(z=C),null==C&&(C=z),I.attribute("width",!0).value=d.opts.scaleWidth,I.attribute("height",!0).value=d.opts.scaleHeight,I.style("transform",!0,!0).value+=" scale("+1/z+","+1/C+")"}1!=d.opts.ignoreClear&&H.clearRect(0,0,M,h),I.render(H),p&&(p=!1,"function"==typeof d.opts.renderCallback&&d.opts.renderCallback(R)),i&&H.canvas.parentElement&&H.canvas.parentElement.removeChild(H.canvas)},z=!0;d.ImagesLoaded()&&(z=!1,h()),d.intervalID=setInterval(function(){var i=!1;if(z&&d.ImagesLoaded()&&(z=!1,i=!0),1!=d.opts.ignoreMouse&&(i|=d.Mouse.hasEvents()),1!=d.opts.ignoreAnimation)for(var H=0;H<d.Animations.length;H++)i|=d.Animations[H].update(1e3/d.FRAMERATE);"function"==typeof d.opts.forceRedraw&&1==d.opts.forceRedraw()&&(i=!0),i&&(h(),d.Mouse.runEvents())},1e3/d.FRAMERATE)},d.stop=function(){d.intervalID&&clearInterval(d.intervalID)},d.Mouse=new function(){this.events=[],this.hasEvents=function(){return 0!=this.events.length},this.onclick=function(i,H){this.events.push({type:"onclick",x:i,y:H,run:function(i){i.onclick&&i.onclick()}})},this.onmousemove=function(i,H){this.events.push({type:"onmousemove",x:i,y:H,run:function(i){i.onmousemove&&i.onmousemove()}})},this.eventElements=[],this.checkPath=function(i,H){for(var R=0;R<this.events.length;R++){var M=this.events[R];H.isPointInPath&&H.isPointInPath(M.x,M.y)&&(this.eventElements[R]=i)}},this.checkBoundingBox=function(i,H){for(var R=0;R<this.events.length;R++){var M=this.events[R];H.isPointInBox(M.x,M.y)&&(this.eventElements[R]=i)}},this.runEvents=function(){d.ctx.canvas.style.cursor="";for(var i=0;i<this.events.length;i++)for(var H=this.events[i],R=this.eventElements[i];R;)H.run(R),R=R.parent;this.events=[],this.eventElements=[]}},d}var z,d=function(i,H,R){if(null!=i||null!=H||null!=R){"string"==typeof i&&(i=document.getElementById(i)),null!=i.svg&&i.svg.stop();var M=h(R||{});1==i.childNodes.length&&"OBJECT"==i.childNodes[0].nodeName||(i.svg=M);var I=i.getContext("2d");void 0!==H.documentElement?M.loadXmlDoc(I,H):"<"==H.substr(0,1)?M.loadXml(I,H):M.load(I,H)}else for(var p=document.querySelectorAll("svg"),z=0;z<p.length;z++){var C=p[z],y=document.createElement("canvas");y.width=C.clientWidth,y.height=C.clientHeight,C.parentNode.insertBefore(y,C),C.parentNode.removeChild(C);var b=document.createElement("div");b.appendChild(C),d(y,b.innerHTML)}};void 0!==Element.prototype.matches?z=function(i,H){var R;try{R=i.matches(H)}catch(i){R=!1}return R}:void 0!==Element.prototype.webkitMatchesSelector?z=function(i,H){return i.webkitMatchesSelector(H)}:void 0!==Element.prototype.mozMatchesSelector?z=function(i,H){return i.mozMatchesSelector(H)}:void 0!==Element.prototype.msMatchesSelector?z=function(i,H){return i.msMatchesSelector(H)}:void 0!==Element.prototype.oMatchesSelector?z=function(i,H){return i.oMatchesSelector(H)}:("function"!=typeof jQuery&&"function"!=typeof Zepto||(z=function(i,H){return $(i).is(H)}),void 0===z&&(z=Sizzle.matchesSelector));var C=/(\[[^\]]+\])/g,y=/(#[^\s\+>~\.\[:]+)/g,b=/(\.[^\s\+>~\.\[:]+)/g,U=/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi,K=/(:[\w-]+\([^\)]*\))/gi,q=/(:[^\s\+>~\.\[:]+)/g,Q=/([^\s\+>~\.\[:]+)/g;return"undefined"!=typeof CanvasRenderingContext2D&&(CanvasRenderingContext2D.prototype.drawSvg=function(i,H,R,M,I,p){var h={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:H,offsetY:R,scaleWidth:M,scaleHeight:I};for(var z in p)p.hasOwnProperty(z)&&(h[z]=p[z]);d(this.canvas,i,h)}),d}(H.RGBColor,H.stackBlur)}(void 0!==i?i:this)}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object),function(i,H,R){function M(i){this._pointer=0,this._data=i,this._eof=!1}function I(i,H){return i<=9?H:i>=10&&i<=59?parseFloat(H):i>=60&&i<=99?parseInt(H):i>=100&&i<=109?H:i>=110&&i<=149?parseFloat(H):i>=160&&i<=179?parseInt(H):i>=210&&i<=239?parseFloat(H):i>=270&&i<=289?parseInt(H):i>=290&&i<=299?p(H):i>=300&&i<=369?H:i>=370&&i<=389?parseInt(H):i>=390&&i<=399?H:i>=400&&i<=409?parseInt(H):i>=410&&i<=419?H:i>=420&&i<=429?parseInt(H):i>=430&&i<=439?H:i>=440&&i<=459?parseInt(H):i>=460&&i<=469?parseFloat(H):i>=470&&i<=481?H:999===i?H:i>=1e3&&i<=1009?H:i>=1010&&i<=1059?parseFloat(H):i>=1060&&i<=1071?parseInt(H):(console.log("WARNING: Group code does not have a defined type: %j",{code:i,value:H}),H)}function p(i){if("0"===i)return!1;if("1"===i)return!0;throw TypeError("String '"+i+"' cannot be cast to Boolean type")}function h(i){i&&i.sanitize!==R&&(this.sanitize=i.sanitize)}function z(i){K.debug("unhandled group "+d(i))}function d(i){return i.code+":"+i.value}function C(i){return q[i]}var y=i.ht,b=y.Default;b.getInternal().addMethod(b,{cadToShape:function(i,H){return new y.DxfViewer(H).toShape(i)},shapeToCad:function(i,H,R){return new y.DxfWriter(R).toDxf(i,H)}});var U=function(){},K={debug:U,warn:U,error:U},q=[0,16711680,16776960,65280,65535,255,16711935,16777215,8421504,12632256,16711680,16744319,13369344,13395558,10027008,10046540,8323072,8339263,4980736,4990502,16727808,16752511,13382400,13401958,10036736,10051404,8331008,8343359,4985600,4992806,16744192,16760703,13395456,13408614,10046464,10056268,8339200,8347455,4990464,4995366,16760576,16768895,13408512,13415014,10056192,10061132,8347392,8351551,4995328,4997670,16776960,16777087,13421568,13421670,10000384,10000460,8355584,8355647,5000192,5000230,12582656,14679935,10079232,11717734,7510016,8755276,6258432,7307071,3755008,4344870,8388352,12582783,6736896,10079334,5019648,7510092,4161280,6258495,2509824,3755046,4194048,10485631,3394560,8375398,2529280,6264908,2064128,5209919,1264640,3099686,65280,8388479,52224,6736998,38912,5019724,32512,4161343,19456,2509862,65343,8388511,52275,6737023,38950,5019743,32543,4161359,19475,2509871,65407,8388543,52326,6737049,38988,5019762,32575,4161375,19494,2509881,65471,8388575,52377,6737074,39026,5019781,32607,4161391,19513,2509890,65535,8388607,52428,6737100,39064,5019800,32639,4161407,19532,2509900,49151,8380415,39372,6730444,29336,5014936,24447,4157311,14668,2507340,32767,8372223,26316,6724044,19608,5010072,16255,4153215,9804,2505036,16383,8364031,13260,6717388,9880,5005208,8063,4149119,4940,2502476,255,8355839,204,6710988,152,5000344,127,4145023,76,2500172,4129023,10452991,3342540,8349388,2490520,6245528,2031743,5193599,1245260,3089996,8323327,12550143,6684876,10053324,4980888,7490712,4128895,6242175,2490444,3745356,12517631,14647295,10027212,11691724,7471256,8735896,6226047,7290751,3735628,4335180,16711935,16744447,13369548,13395660,9961624,9981080,8323199,8339327,4980812,4990540,16711871,16744415,13369497,13395634,9961586,9981061,8323167,8339311,4980793,4990530,16711807,16744383,13369446,13395609,9961548,9981042,8323135,8339295,4980774,4990521,16711743,16744351,13369395,13395583,9961510,9981023,8323103,8339279,4980755,4990511,3355443,5987163,8684676,11382189,14079702,16777215];M.prototype.next=function(i){var H;if(!this.hasNext())throw this._eof?new Error("Cannot call 'next' after EOF group has been read"):new Error("Unexpected end of input: EOF group not read before end of file. Ended on code "+this._data[this._pointer]);return H={code:parseInt(this._data[this._pointer])},this._pointer++,H.value=I(H.code,this._data[this._pointer].trim()),this._pointer++,i||0!==H.code||"EOF"!==H.value||(this._eof=!0),H},M.prototype.hasNext=function(){return!this._eof&&!(this._pointer>this._data.length-2)},M.prototype.isEOF=function(){return this._eof},h.prototype.parse=function(i,H){throw new Error("read() not implemented. Use readSync()")},h.prototype.parseSync=function(i){return"string"==typeof i?this._parse(i):(console.error("Cannot read dxf source of type `"+typeof i),null)},h.prototype.parseStream=function(i,H){function R(i){p+=i}function M(){try{var i=h._parse(p)}catch(i){return H(i)}H(null,i)}function I(i){H(i)}var p="",h=this;i.on("data",R),i.on("end",M),i.on("error",I)},h.prototype.sanitizeFileName=function(){var i=/[\/\?<>\\:\*\|":]/g,H=/[\x00-\x1f\x80-\x9f]/g,R=/^\.+$/,M=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,I=/[\. ]+$/;return function(p){var h=this.sanitize
;return null==h?p:p.replace(i,h).replace(H,h).replace(R,h).replace(M,h).replace(I,h)}}(),h.prototype._parse=function(i){var I,p,h=this,y={},b=0,U=i.split(/\r\n|\r|\n/g);if(I=new M(U),!I.hasNext())throw Error("Empty file");var q=function(i,H){return p.code===i&&p.value===H},Q=function(){var i=null,H=null,R={};for(p=I.next();;){if(q(0,"ENDSEC")){i&&(R[i]=H);break}9===p.code?(i&&(R[i]=H),i=p.value):10===p.code?H={x:p.value}:20===p.code?H.y=p.value:30===p.code?H.z=p.value:H=p.value,p=I.next()}return p=I.next(),R},m=function(){var i,H={};for(p=I.next();"EOF"!==p.value&&!q(0,"ENDSEC");)q(0,"BLOCK")?(K.debug("block {"),i=X(),K.debug("}"),l(i),i.name?H[i.name]=i:K.error('block with handle "'+i.handle+'" is missing a name.')):(z(p),p=I.next());return H},X=function(){var i={};for(p=I.next();"EOF"!==p.value;){switch(p.code){case 1:i.xrefPath=p.value,p=I.next();break;case 2:i.name=h.sanitizeFileName(p.value),p=I.next();break;case 3:i.name2=h.sanitizeFileName(p.value),p=I.next();break;case 5:i.handle=p.value,p=I.next();break;case 8:i.layer=p.value,p=I.next();break;case 10:i.position=G();break;case 67:i.paperSpace=!(!p.value||1!=p.value),p=I.next();break;case 70:0!=p.value&&(i.type=p.value),p=I.next();break;case 100:p=I.next();break;case 330:i.ownerHandle=p.value,p=I.next();break;case 0:if("ENDBLK"==p.value)break;I._pointer-=2,i.entities=N(!0);break;default:z(p),p=I.next()}if(q(0,"ENDBLK")){p=I.next();break}}return i},o=function(){var i={};for(p=I.next();"EOF"!==p.value&&!q(0,"ENDSEC");)if(q(0,"TABLE")){p=I.next();var H=T[p.value];H?(K.debug(p.value+" Table {"),i[T[p.value].tableName]=J(),K.debug("}")):K.debug("Unhandled Table "+p.value)}else p=I.next();return p=I.next(),i},J=function(){var i,R=T[p.value],M={},h=0;for(p=I.next();!q(0,"ENDTAB");)switch(p.code){case 5:M.handle=p.value,p=I.next();break;case 330:M.ownerHandle=p.value,p=I.next();break;case 100:"AcDbSymbolTable"===p.value?p=I.next():(z(p),p=I.next());break;case 70:h=p.value,p=I.next();break;case 0:p.value===R.dxfSymbolName?M[R.tableRecordsProperty]=R.parseTableRecords():(z(p),p=I.next());break;default:z(p),p=I.next()}var d=M[R.tableRecordsProperty];return d&&(d.constructor===Array?i=d.length:"object"==typeof d&&(i=H.keys(d).length),h!==i&&K.warn("Parsed "+i+" "+R.dxfSymbolName+"'s but expected "+h)),p=I.next(),M},O=function(){var i=[],H={};for(K.debug("ViewPort {"),p=I.next();!q(0,"ENDTAB");)switch(p.code){case 2:H.name=p.value,p=I.next();break;case 10:H.lowerLeftCorner=G();break;case 11:H.upperRightCorner=G();break;case 12:H.center=G();break;case 13:H.snapBasePoint=G();break;case 14:H.snapSpacing=G();break;case 15:H.gridSpacing=G();break;case 16:H.viewDirectionFromTarget=G();break;case 17:H.viewTarget=G();break;case 40:H.viewHeight=p.value,H.aspectRatio!==R&&(H.viewWidth=p.value*H.aspectRatio),p=I.next();break;case 41:H.aspectRatio=p.value,H.viewHeight!==R&&(H.viewWidth=p.value*H.viewHeight),p=I.next();break;case 42:H.lensLength=p.value,p=I.next();break;case 43:H.frontClippingPlane=p.value,p=I.next();break;case 44:H.backClippingPlane=p.value,p=I.next();break;case 45:H.viewHeight=p.value,p=I.next();break;case 50:H.snapRotationAngle=p.value,p=I.next();break;case 51:H.viewTwistAngle=p.value,p=I.next();break;case 79:H.orthographicType=p.value,p=I.next();break;case 110:H.ucsOrigin=G();break;case 111:H.ucsXAxis=G();break;case 112:H.ucsYAxis=G();break;case 110:H.ucsOrigin=G();break;case 281:H.renderMode=p.value,p=I.next();break;case 281:H.defaultLightingType=p.value,p=I.next();break;case 292:H.defaultLightingOn=p.value,p=I.next();break;case 330:H.ownerHandle=p.value,p=I.next();break;case 63:case 421:case 431:H.ambientColor=p.value,p=I.next();break;case 0:"VPORT"===p.value&&(K.debug("}"),i.push(H),K.debug("ViewPort {"),H={},p=I.next());break;default:z(p),p=I.next()}return K.debug("}"),i.push(H),i},c=function(){var i,H,R={},M={};for(K.debug("LType {"),p=I.next();!q(0,"ENDTAB");)switch(p.code){case 2:M.name=p.value,i=p.value,p=I.next();break;case 3:M.description=p.value,p=I.next();break;case 73:H=p.value,H>0&&(M.pattern=[]),p=I.next();break;case 40:M.patternLength=p.value,p=I.next();break;case 49:M.pattern.push(p.value),p=I.next();break;case 0:K.debug("}"),H>0&&H!==M.pattern.length&&K.warn("lengths do not match on LTYPE pattern"),R[i]=M,M={},K.debug("LType {"),p=I.next();break;default:p=I.next()}return K.debug("}"),R[i]=M,R},t=function(){var i,H={},M={};for(K.debug("Layer {"),p=I.next();!q(0,"ENDTAB");)switch(p.code){case 2:M.name=p.value,i=p.value,p=I.next();break;case 62:M.visible=p.value>=0,M.color=C(Math.abs(p.value)),p=I.next();break;case 6:M.lineType=p.value,p=I.next();break;case 0:"LAYER"===p.value&&(K.debug("}"),H[i]=M,K.debug("Layer {"),M={},i=R,p=I.next());break;default:z(p),p=I.next()}return K.debug("}"),H[i]=M,H},T={VPORT:{tableRecordsProperty:"viewPorts",tableName:"viewPort",dxfSymbolName:"VPORT",parseTableRecords:O},LTYPE:{tableRecordsProperty:"lineTypes",tableName:"lineType",dxfSymbolName:"LTYPE",parseTableRecords:c},LAYER:{tableRecordsProperty:"layers",tableName:"layer",dxfSymbolName:"LAYER",parseTableRecords:t}},N=function(i){var H=[],R=i?"ENDBLK":"ENDSEC";for(p=I.next();;)if(0===p.code){if(p.value===R)break;var M;if("LWPOLYLINE"===p.value)K.debug("LWPOLYLINE {"),M=F(),K.debug("}");else if("POLYLINE"===p.value)K.debug("POLYLINE {"),M=w(),K.debug("}");else if("LINE"===p.value)K.debug("LINE {"),M=B(),K.debug("}");else if("CIRCLE"===p.value)K.debug("CIRCLE {"),M=E(),K.debug("}");else if("ARC"===p.value)K.debug("ARC {"),M=E(),K.debug("}");else if("ELLIPSE"===p.value)K.debug("ELLIPSE {"),M=_(),K.debug("}");else if("SPLINE"===p.value)K.debug("SPLINE {"),M=Y(),K.debug("}");else if("TEXT"===p.value)K.debug("TEXT {"),M=r(),K.debug("}");else if("ATTRIB"===p.value)K.debug("ATTRIB {"),M=e(),K.debug("}");else if("DIMENSION"===p.value)K.debug("DIMENSION {"),M=s(),K.debug("}");else if("INSERT"===p.value)K.debug("INSERT {"),M=x(),K.debug("}");else if("HATCH"===p.value)K.debug("HATCH {"),M=j(),K.debug("}");else if("SOLID"===p.value)K.debug("SOLID {"),M=W(),K.debug("}");else if("POINT"===p.value)K.debug("POINT {"),M=$(),K.debug("}");else if("MTEXT"===p.value)K.debug("MTEXT {"),M=v(),K.debug("}");else{if("ATTDEF"!==p.value){K.warn("Unhandled entity "+p.value),p=I.next();continue}K.debug("ATTDEF {"),M=a(),K.debug("}")}M instanceof Array?M.forEach(function(i){l(i),H.push(i)}):(l(M),H.push(M))}else p=I.next();return"ENDSEC"==R&&(p=I.next()),H},D=function(i){switch(p.code){case 0:i.type=p.value,p=I.next();break;case 5:i.handle=p.value,p=I.next();break;case 6:i.lineType=p.value,p=I.next();break;case 8:i.layer=p.value,p=I.next();break;case 48:i.lineTypeScale=p.value,p=I.next();break;case 60:i.visible=0===p.value,p=I.next();break;case 62:i.colorIndex=p.value,i.color=C(Math.abs(p.value)),p=I.next();break;case 67:i.inPaperSpace=0!==p.value,p=I.next();break;case 210:i.extrusionDirection=G();break;case 230:i.extrusionDirection={x:0,y:0,z:p.value},p=I.next();break;case 330:i.ownerHandle=p.value,p=I.next();break;case 347:i.materialObjectHandle=p.value,p=I.next();break;case 370:i.lineweight=p.value,p=I.next();break;case 420:i.color=p.value,p=I.next();break;case 100:if("AcDbEntity"==p.value){p=I.next();break}default:z(p),p=I.next()}},f=function(){var i={type:p.value};for(p=I.next();"EOF"!==p&&0!==p.code;)switch(p.code){case 10:i.x=p.value,p=I.next();break;case 20:i.y=p.value,p=I.next();break;case 30:i.z=p.value,p=I.next();break;case 40:case 41:case 42:p=I.next();break;case 70:i.curveFittingVertex=0!=(1|p.value),i.curveFitTangent=0!=(2|p.value),i.splineVertex=0!=(8|p.value),i.splineControlPoint=0!=(16|p.value),i.ThreeDPolylineVertex=0!=(32|p.value),i.ThreeDPolylineMesh=0!=(64|p.value),i.polyfaceMeshVertex=0!=(128|p.value),p=I.next();break;case 50:case 71:case 72:case 73:case 74:p=I.next();break;default:D(i)}return i},n=function(){var i={type:p.value};for(p=I.next();"EOF"!=p&&0!=p.code;)D(i);return i},G=function(){var i={},H=p.code;if(i.x=p.value,H+=10,p=I.next(),p.code!=H)throw new Error("Expected code for point value to be "+H+" but got "+p.code+".");return i.y=p.value,H+=10,p=I.next(),p.code!=H?i:(i.z=p.value,p=I.next(),i)},k=function(){var i={},H=p.code;return i.x=p.value,H+=1,p=I.next(),p.code!=H?(I._pointer-=2,i.y=1):i.y=p.value,H+=1,p=I.next(),p.code!=H?(I._pointer-=2,i.z=1):i.z=p.value,p=I.next(),i},P=function(i){if(!i||i<=0)throw Error("n must be greater than 0 verticies");var H,R=[],M=!1,h=!1;for(H=0;H<i;H++){for(var z={};"EOF"!==p&&0!==p.code&&!h;){switch(p.code){case 10:if(M){h=!0;continue}z.x=p.value,M=!0;break;case 20:z.y=p.value;break;case 30:z.z=p.value;break;case 40:z.startWidth=p.value;break;case 41:z.endWidth=p.value;break;case 42:0!=p.value&&(z.bulge=p.value);break;default:if(M){h=!0;continue}}p=I.next()}R.push(z),M=!1,h=!1}return R},Z=function(){for(var i=[];"EOF"!==p;)if(0===p.code)if("VERTEX"===p.value)i.push(f());else if("SEQEND"===p.value){n();break}return i},v=function(){var i={type:p.value};for(p=I.next();"EOF"!==p&&0!==p.code;)switch(p.code){case 1:i.text=p.value,p=I.next();break;case 3:i.text+=p.value,p=I.next();break;case 10:i.position=G();break;case 40:i.height=p.value,p=I.next();break;case 41:i.width=p.value,p=I.next();break;case 71:i.attachmentPoint=p.value,p=I.next();break;case 72:i.drawingDirection=p.value,p=I.next();break;case 50:i.angle=2*p.value*Math.PI/360,p=I.next();break;case 11:i.directionX=p.value,p=I.next();break;case 21:i.directionY=p.value,p=I.next();break;case 60:i.hidden=1===p.value,p=I.next();break;default:D(i)}return i},a=function(){var i={type:p.value,scale:1,textStyle:"STANDARD",halign:0,valign:0};for(p=I.next();"EOF"!==p&&0!==p.code;)switch(p.code){case 1:i.text=p.value,p=I.next();break;case 2:i.tag=p.value,p=I.next();break;case 3:i.prompt=p.value,p=I.next();break;case 7:i.textStyle=p.value,p=I.next();break;case 10:i.startPoint=G();break;case 11:i.endPoint=G();break;case 39:i.thickness=p.value,p=I.next();break;case 40:i.textHeight=p.value,p=I.next();break;case 41:i.scale=p.value,p=I.next();break;case 50:i.rotation=p.value/180*Math.PI,p=I.next();break;case 51:i.obliqueAngle=p.value,p=I.next();break;case 70:i.invisible=!!(1&p.value),i.constant=!!(2&p.value),i.verificationRequired=!!(4&p.value),i.preset=!!(8&p.value),p=I.next();break;case 71:i.backwards=!!(2&p.value),i.mirrored=!!(4&p.value),p=I.next();break;case 72:i.halign=p.value,p=I.next();break;case 73:i.fieldLength=p.value,p=I.next();break;case 74:i.valign=p.value,p=I.next();break;case 100:p=I.next();break;case 210:i.extrusionDirectionX=p.value,p=I.next();break;case 220:i.extrusionDirectionY=p.value,p=I.next();break;case 230:i.extrusionDirectionZ=p.value,p=I.next();break;default:D(i)}return i},F=function(){var i={type:p.value,vertices:[]},H=0;for(p=I.next();"EOF"!==p&&0!==p.code;)switch(p.code){case 38:i.elevation=p.value,p=I.next();break;case 39:i.depth=p.value,p=I.next();break;case 70:i.shape=1===p.value,p=I.next();break;case 90:H=p.value,p=I.next();break;case 10:i.vertices=P(H);break;case 40:0!==p.value&&(i.startWidth=p.value),p=I.next();break;case 41:0!==p.value&&(i.endWidth=p.value),p=I.next();break;case 43:0!==p.value&&(i.width=p.value),p=I.next();break;default:D(i)}return i},w=function(){var i={type:p.value,vertices:[]};for(p=I.next();"EOF"!==p&&0!==p.code;)switch(p.code){case 10:case 20:case 30:case 39:p=I.next();break;case 40:0!==p.value&&(i.startWidth=p.value),p=I.next();break;case 41:0!==p.value&&(i.endWidth=p.value),p=I.next();break;case 70:i.shape=1===p.value,p=I.next();break;case 71:case 72:case 73:case 74:case 75:case 100:p=I.next();break;default:D(i)}return i.vertices=Z(),i},B=function(){var i={type:p.value,vertices:[]};for(p=I.next();"EOF"!==p&&0!==p.code;)switch(p.code){case 10:i.vertices.unshift(G());break;case 11:i.vertices.push(G());break;case 100:if("AcDbLine"==p.value){p=I.next();break}default:D(i)}return i},E=function(){var i,H;for(i={type:p.value},p=I.next();"EOF"!==p&&0!==p.code;)switch(p.code){case 10:i.center=G();break;case 40:i.radius=p.value,p=I.next();break;case 50:i.startAngle=Math.PI/180*p.value,p=I.next();break;case 51:H=Math.PI/180*p.value,H<i.startAngle?i.angleLength=H+2*Math.PI-i.startAngle:i.angleLength=H-i.startAngle,i.endAngle=H,p=I.next();break;default:D(i)}return i},_=function(){var i,H;for(i={type:p.value},p=I.next();"EOF"!==p&&0!==p.code;)switch(p.code){case 10:i.center=G();break;case 11:i.major=G();break;case 40:i.ratio=p.value,p=I.next();break;case 41:i.startAngle=p.value,p=I.next();break;case 42:H=p.value,H<i.startAngle?i.angleLength=H+2*Math.PI-i.startAngle:i.angleLength=H-i.startAngle,i.endAngle=H,p=I.next();break;default:D(i)}return i},x=function(){var i,H,R=[];for(i={type:p.value,attribs:R},p=I.next();"EOF"!==p;){if(0===p.code){if(H&&"ATTRIB"===p.value){R.push(e());continue}if(H&&"SEQEND"===p.value){n();continue}break}switch(p.code){case 2:i.block=h.sanitizeFileName(p.value),p=I.next();break;case 10:i.center=G();break;case 41:i.scale=k();break;case 50:i.deg=p.value,p=I.next();break;case 66:H=1===p.value,p=I.next();break;default:D(i)}}var M={},z=y.blocks;if(z){var d=z[i.block];d&&d.entities&&d.entities.forEach(function(i){"ATTDEF"===i.type&&(M[i.tag]=1)})}var C=[i],b=[],U=i.center;return R.forEach(function(i){if(!M[i.attr])return void C.push(i);b.push(i);var H=i.startPoint;H&&(H.x-=U.x,H.y=U.y-H.y),(H=i.endPoint)&&(H.x-=U.x,H.y=U.y-H.y)}),i.attribs=b,C},j=function(){var i;for(i={type:p.value},p=I.next();"EOF"!==p&&0!==p.code;)switch(p.code){case 2:i.block=h.sanitizeFileName(p.value),p=I.next();break;case 10:i.center=G();break;case 41:i.scale=k();break;case 50:i.deg=p.value,p=I.next();break;default:D(i)}return i},Y=function(){var i,H;for(i={type:p.value},p=I.next();"EOF"!==p&&0!==p.code;)switch(p.code){case 10:i.center=G();break;case 11:i.major=G();break;case 40:i.ratio=p.value,p=I.next();break;case 41:i.startAngle=p.value,p=I.next();break;case 42:H=p.value,H<i.startAngle?i.angleLength=H+2*Math.PI-i.startAngle:i.angleLength=H-i.startAngle,i.endAngle=H,p=I.next();break;default:D(i)}return i},r=function(){var i;for(i={type:p.value},p=I.next();"EOF"!==p&&0!==p.code;)switch(p.code){case 10:i.startPoint=G();break;case 11:i.endPoint=G();break;case 40:i.textHeight=p.value,p=I.next();break;case 41:i.xScale=p.value,p=I.next();break;case 1:i.text=p.value,p=I.next();break;case 7:i.font=p.value,p=I.next();break;case 71:i.generationFlags=p.value,p=I.next();break;case 72:i.halign=p.value,p=I.next();break;case 73:i.valign=p.value,p=I.next();break;case 50:i.rotation=2*p.value*Math.PI/360,p=I.next();break;case 60:i.hidden=1===p.value,p=I.next();break;default:D(i)}return i},e=function(){var i;for(i={type:p.value},p=I.next();"EOF"!==p&&0!==p.code;)switch(p.code){case 10:i.startPoint=G();break;case 11:i.endPoint=G();break;case 40:i.textHeight=p.value,p=I.next();break;case 41:i.xScale=p.value,p=I.next();break;case 1:i.text=p.value,p=I.next();break;case 7:i.font=p.value,p=I.next();break;case 71:i.generationFlags=p.value,p=I.next();break;case 72:i.halign=p.value,p=I.next();break;case 74:i.valign=p.value,p=I.next();break;case 50:i.rotation=2*p.value*Math.PI/360,p=I.next();break;case 70:i.hidden=1===p.value,p=I.next();break;case 2:i.attr=p.value,p=I.next();break;default:D(i)}return i},s=function(){var i;for(i={type:p.value},p=I.next();"EOF"!==p&&0!==p.code;)switch(p.code){case 2:i.block=h.sanitizeFileName(p.value),p=I.next();break;case 10:i.anchorPoint=G();break;case 11:i.middleOfText=G();break;case 71:i.attachmentPoint=p.value,p=I.next();break;case 42:i.actualMeasurement=p.value,p=I.next();break;case 1:i.text=p.value,p=I.next();break;case 50:i.angle=p.value,p=I.next();break;default:D(i)}return i},W=function(){var i;for(i={type:p.value},i.points=[],p=I.next();"EOF"!==p&&0!==p.code;)switch(p.code){case 10:i.points[0]=G();break;case 11:i.points[1]=G();break;case 12:i.points[2]=G();break;case 13:i.points[3]=G();break;default:D(i)}return i},$=function(){var i;for(i={type:p.value},p=I.next();"EOF"!==p&&0!==p.code;)switch(p.code){case 10:i.position=G();break;case 39:i.thickness=p.value,p=I.next();break;case 100:if("AcDbPoint"==p.value){p=I.next();break}default:D(i)}return i},l=function(i){if(!i)throw new TypeError("entity cannot be undefined or null");i.handle||(i.handle=b++)};return function(){for(p=I.next();!I.isEOF();)if(0===p.code&&"SECTION"===p.value){if(p=I.next(),2!==p.code){console.error("Unexpected code %s after 0:SECTION",d(p)),p=I.next();continue}"HEADER"===p.value?(K.debug("> HEADER"),y.header=Q(),K.debug("<")):"BLOCKS"===p.value?(K.debug("> BLOCKS"),y.blocks=m(),K.debug("<")):"ENTITIES"===p.value?(K.debug("> ENTITIES"),y.entities=N(!1),K.debug("<")):"TABLES"===p.value?(K.debug("> TABLES"),y.tables=o(),K.debug("<")):"EOF"===p.value?K.debug("EOF"):K.warn("Skipping section '%s'",p.value)}else p=I.next()}(),y};var Q=y.DxfViewer=function(i){this.init(i)};Q.prototype={},Q.prototype.constructor=Q;var m={LINE:["LINE","POLYLINE"],LWLINE:["LWPOLYLINE"],CIRCLE:["CIRCLE","ARC"],ELLIPSE:["ELLIPSE"],TEXT:["TEXT","MTEXT","ATTRIB"],SOLID:["SOLID"],POINT:["POINT"],ATTDEF:["ATTDEF"]};H.defineProperties(Q.prototype,{dxf:{get:function(){return this._dxf}}}),Q.prototype.init=function(i){var H=this,M=H.options={};i=i||{},M.font=i.font||"Standard",M.textScaleRatio=i.textScaleRatio||1,M.size=i.size,M.scale=i.scale,M.blockSize=i.blockSize||256,M.filter=i.filter,M.defaultColor=i.defaultColor||0,M.edgeLayer=i.edgeLayer,i.showText===R&&(i.showText=!0),M.showText=i.showText,M.mapColor=i.mapColor,M.circleSegments=i.circleSegments||72,M.browserMinFontSize=i.browserMinFontSize||12,M.useTextCompScale=i.useTextCompScale===R||i.useTextCompScale,M.boundingType=i.boundingType||"Reset",M.convertArcToBezier=i.convertArcToBezier,!1!==i.sanitize&&(M.sanitize=i.sanitize||"_")},Q.prototype.toShape=function(i){var H=this;H.parseFile(i);var M,I,p,h=H._dxf.blocks,z=H.sortBlocks(h);H._blockDef={};for(var d=z.length-1;d>=0;d--)I=z[d],p=h[I],p.entities&&(H._blockDef[I]||(M=H.entitiesToShape(p.entities,p.position,null,!1,R,!0))&&(M.flag=p.type,H._blockDef[I]=M));return M=H.entitiesToShape(H._dxf.entities,null,H.options.size,!0,H.options.scale),M.sortedBlockName=z,M.blockDef=H._blockDef,M.layers=H._dxf.tables.layer.layers,M},Q.prototype.entitiesToShape=function(i,H,R,M,I,p){var h=this;h._minFontSize=12,h._bound={xMin:1/0,yMin:1/0,xMax:-1/0,yMax:-1/0},H=H||{x:0,y:0,z:0};var z,d,C,y=h._models={},b=h._dxf;for(z=0,d=i.length;z<d;z++)C=i[z],h._groupEntity(y,C,b);if(M)switch(h.options.boundingType){case"Viewport":var U=h._dxfViewport;!U||isNaN(U.x)||isNaN(U.y)||isNaN(U.width)||isNaN(U.height)||(h._bound={xMin:U.x-U.width/2,xMax:U.x+U.width/2,yMin:U.y-U.height/2,yMax:U.y+U.height/2});break;case"Standard":h._bound={xMin:0,xMax:1,yMin:0,yMax:1}}h._shiftX=h._bound.xMin,h._shiftY=h._bound.yMax;var K=h._bound.xMax-h._bound.xMin,q=h._bound.yMax-h._bound.yMin;if(!(K<0||q<0)){if(K=K||1,q=q||1,h._bound.pos=H,I)h._scale=I;else{if(R){var Q=R/K,m=R/q;h._scale=Math.min(Q,m)}else h._scale=1;h.options.useTextCompScale||(h._scale*=Math.max(1,Math.ceil(h.options.browserMinFontSize/h._minFontSize)))}var X={};return h.shapeComps=[],h.drawLine(),h.drawLWLine(),h.drawSolid(),h.drawCircle(),h.drawEllipse(),h.options.showText&&h.drawText(),X.dataBindings=h.drawAttrDef(),h.drawBlock(),X.width=K*h._scale,X.height=q*h._scale,X.comps=h.shapeComps,X.scale=h._scale,X.anchorX=-(h._bound.xMin-H.x)/K,X.anchorY=(h._bound.yMax-H.y)/q,X.bound=h._bound,h._calcBoundExtend(X),X}},Q.prototype._calcBoundExtend=function(i){var H=1,R=!1;i.comps.forEach(function(i){H=Math.max(H,i.borderWidth||0),i.borderWidthAbsolute&&(R=!0)}),i.boundExtend=H,R&&(i.boundExtendAbsolute=!0)},Q.prototype._bulgesAt=function(i,H){return i[H].bulge},Q.prototype._isStraightLine=function(i){return!i||Math.abs(i)<1e-6},Q.prototype._getDistance=function(i,H){var R=i.x-H.x,M=i.y-H.y;return Math.sqrt(R*R+M*M)},Q.prototype._getBulgeSegment=function(i,H,R){var M=this,I=R<0,p=4*Math.atan(R);if(Math.abs(p)>2*Math.PI-1e-6)return[H];var h={x:(i.x+H.x)/2,y:(i.y+H.y)/2},z=M._getDistance(i,H)/2,d=Math.atan2(H.y-i.y,H.x-i.x),C=Math.abs(z/Math.sin(p/2)),y=Math.abs(C*C-z*z),b=Math.sqrt(y);R>0?d+=Math.PI/2:d-=Math.PI/2,Math.abs(p)>Math.PI&&(b*=-1);var U,d,K=b*Math.cos(d)+h.x,q=b*Math.sin(d)+h.y,Q=Math.atan2(i.y-q,i.x-K),m=Math.atan2(H.y-q,H.x-K),X=[];if(U=2*Math.PI/M.options.circleSegments,d=Q,I){for(;m>Q;)m-=2*Math.PI;for(;d>m;)d-=U,d<m&&(d=m),X.push({x:K+C*Math.cos(d),y:q+C*Math.sin(d)})}else{for(;m<Q;)m+=2*Math.PI;for(;d<m;)d+=U,d>m&&(d=m),X.push({x:K+C*Math.cos(d),y:q+C*Math.sin(d)})}return X},Q.prototype.drawLine=function(){var i,H,M,I,p,h,z,d,C,y,b,U,K,q,Q,X,o,J,O,c,t=this,T=t._models;for(i=m.LINE,I=0,p=i.length;I<p;I++){H=i[I],M=T[H];for(d in M)for(C=M[d],h=0,z=C.length;h<z;h++)if(y=C[h],(b=y.vertices)&&b.length){for(Q=t.toLocal(b[0].x,1),X=t.toLocal(b[0].y,2),J={type:"shape",cadType:H,cadLayer:y.layer,maybeEdge:y.layer===t.options.edgeLayer,borderColor:d,borderCap:"round",points:[Q,X],segments:[1]},c=R,y.startWidth?c=(y.startWidth+(y.endWidth?y.endWidth:y.startWidth))/2:y.width&&(c=y.width),c?J.borderWidth=t.toLocal(c):(J.borderWidthAbsolute=!0,J.borderWidth=1),K=1,q=b.length;K<q;K++)U=b[K],o=t._bulgesAt(b,K-1),t._isStraightLine(o)?(J.points.push(t.toLocal(U.x,1),t.toLocal(U.y,2)),J.segments.push(2)):(O=t._getBulgeSegment(b[K-1],U,o),O.forEach(function(i){J.points.push(t.toLocal(i.x,1),t.toLocal(i.y,2)),J.segments.push(2)}));if(y.shape&&(o=t._bulgesAt(b,b.length-1),t._isStraightLine(o)?J.segments.push(5):(O=t._getBulgeSegment(b[b.length-1],b[0],o),O.forEach(function(i){J.points.push(t.toLocal(i.x,1),t.toLocal(i.y,2)),J.segments.push(2)}))),J.dash=["DASHED","HIDDEN"].indexOf(y.lineType)>=0){J.dashColor=d,J.borderColor="rgba(0, 0, 0, 0)";var N=t.toLocal(y.lineTypeScale||1);N&&(J.dashPattern=[10*N,5*N])}y.lineweight&&(J.borderWidth=t.toLocal(y.lineweight)/10),J.handle=y.handle,t.shapeComps.push(J)}}},Q.prototype.drawLWLine=function(){var i,H,M,I,p,h,z,d,C,b,U,K,q,Q,X,o,J,O,c,t,T=this,N=T._models;for(i=m.LWLINE,I=0,p=i.length;I<p;I++){H=i[I],M=N[H];for(d in M){C=M[d];var D=[];for(h=0,z=C.length;h<z;h++)if(b=C[h],(U=b.vertices)&&U.length){X=T.toLocal(U[0].x,1),o=T.toLocal(U[0].y,2),O={type:"shape",cadType:H,cadLayer:b.layer,maybeEdge:b.layer===T.options.edgeLayer,borderColor:d,borderCap:"round",points:[X,o],segments:[1]},t=R,b.startWidth?t=(b.startWidth+(b.endWidth?b.endWidth:b.startWidth))/2:b.width&&(t=b.width),t?O.borderWidth=T.toLocal(t):(O.borderWidthAbsolute=!0,O.borderWidth=1);var f=U[0];for(q=1,Q=U.length;q<Q;q++)K=U[q],J=T._bulgesAt(U,q-1),T._isStraightLine(J)?(O.points.push(T.toLocal(K.x,1),T.toLocal(K.y,2)),f.startWidth!==f.endWidth?(D.push({from:f,to:K}),O.segments.push(1)):O.segments.push(2)):(c=T._getBulgeSegment(U[q-1],K,J),c.forEach(function(i){O.points.push(T.toLocal(i.x,1),T.toLocal(i.y,2)),O.segments.push(2)})),f=K;if(b.shape&&(J=T._bulgesAt(U,U.length-1),T._isStraightLine(J)?O.segments.push(5):(c=T._getBulgeSegment(U[U.length-1],U[0],J),c.forEach(function(i){O.points.push(T.toLocal(i.x,1),T.toLocal(i.y,2)),O.segments.push(2)}))),O.dash=["DASHED","HIDDEN"].indexOf(b.lineType)>=0){O.dashColor=d,O.borderColor="rgba(0, 0, 0, 0)";var n=T.toLocal(b.lineTypeScale||1);n&&(O.dashPattern=[10*n,5*n])}b.lineweight&&(O.borderWidth=T.toLocal(b.lineweight)/10),O.handle=b.handle,T.shapeComps.push(O)}D.forEach(function(i){var H=i.from,R=i.to,M={x:T.toLocal(H.x,1),y:T.toLocal(H.y,2)},I={x:T.toLocal(R.x,1),y:T.toLocal(R.y,2)},p=Math.atan2(I.y-M.y,I.x-M.x)+Math.PI/2;if(H.startWidth<H.endWidth){var h=I;I=M,M=h,p+=Math.PI}var z=Math.max(H.startWidth,H.endWidth);z=T.toLocal(z);var C=y.Default.getDistance(M,I);T.shapeComps.push({type:"triangle",rect:[M.x-z/2,M.y-C,z,C],anchorX:.5,anchorY:1,rotation:p,background:d})})}}},Q.prototype.drawBlock=function(){var i,H,R,M,I,p,h,z,d,C,y,b,U=this,K=U._models.BLOCK;if(K)for(i=0,H=K.length;i<H;i++)R=K[i],M=R.block,I=U._blockDef[M],y=R.transform,p=Math.atan2(y.b,y.a),Math.abs(p-Math.PI)<1e-5||Math.abs(p)<1e-5||Math.abs(p+Math.PI)<1e-5?(d=Math.cos(p),h=y.a/d,z=y.d/d):(C=Math.sin(p),h=y.b/C,z=-y.c/C),b={type:"image",cadType:"block",cadLayer:R.layer,handle:R.handle,name:M,rect:[[U.toLocal(y.tx,1),U.toLocal(y.ty,2)],U.toLocal(I.width/I.scale),U.toLocal(I.height/I.scale)],rotation:p,attribs:R.attribs,color:R.color},1===h&&1===z||(b.scaleX=h,b.scaleY=z),U.shapeComps.push(b)},Q.prototype.drawSolid=function(){var i,H,R,M,I,p,h,z,d,C,y,b=this,U=b._models;for(i=m.SOLID,M=0,I=i.length;M<I;M++){H=i[M],R=U[H];for(z in R)for(d=R[z],p=0,h=d.length;p<h;p++)C=d[p],y=C.points,b.shapeComps.push({type:"shape",cadType:H,cadLayer:C.layer,handle:C.handle,background:z,points:[b.toLocal(y[0].x,1),b.toLocal(y[0].y,2),b.toLocal(y[1].x,1),b.toLocal(y[1].y,2),b.toLocal(y[3].x,1),b.toLocal(y[3].y,2),b.toLocal(y[2].x,1),b.toLocal(y[2].y,2)],segments:[1,2,2,2,5]})}},Q.prototype.extrusionZNagative=function(i){var H=i.extrusionDirection;return!!H&&Math.abs(H.z+1)<1e-5},Q.prototype.drawCircle=function(){var i,H,R,M,I,p,h,z,d,C,y,b,U,K,q,Q,X,o,J,O,c=this,t=c._models;for(i=m.CIRCLE,M=0,I=i.length;M<I;M++){H=i[M],R=t[H];for(z in R)for(d=R[z],p=0,h=d.length;p<h;p++){if(C=d[p],y=C.startAngle||0,b=C.angleLength||2*Math.PI,U=y+b,K=c.toLocal(C.radius),q=C.addonAngle||0,Q=c.toLocal(C.center.x,1),X=c.toLocal(C.center.y,2),O=C.xInvert^c.extrusionZNagative(C),J=C.yInvert,J||O?O&&J?(y=Math.PI+y,U=Math.PI+U,o=!1):(y=Math.PI*(O?1:2)-y,U=Math.PI*(O?1:2)-U,o=!0):o=!1,o=!o,y=2*Math.PI-y-q,U=2*Math.PI-U-q,o){var T=y;y=U,U=T}var N={type:"arc",cadType:H,cadLayer:C.layer,handle:C.handle,borderColor:z,borderWidth:1,borderWidthAbsolute:!0,rect:[Q-K,X-K,2*K,2*K],arcFrom:y,arcTo:U,arcClose:!1};c.options.convertArcToBezier?c.shapeComps.push(c._convertArcToBezier(N)):c.shapeComps.push(N)}}},Q.prototype.drawText=function(){var i,H,R,M,I,p,h,z,d,C,y,b,U,K,q,Q,X,o,J,O,c,t,T,N,D,f=this,n=f._models;i=m.TEXT,D=f.options.textScaleRatio;var G=f.options.useTextCompScale?f.options.browserMinFontSize:0;for(M=0,I=i.length;M<I;M++){H=i[M],R=n[H];for(z in R)for(d=R[z],p=0,h=d.length;p<h;p++)if(C=d[p],(y=C.text||C.tag)&&y.length){if("MTEXT"===H)b=f.toLocal(C.height||12),U=f.toLocal(C.position.x,1),K=f.toLocal(C.position.y,2),c=C.angle?C.angle:C.directionX?Math.atan2(C.directionY,C.directionX):0,c+=C.addonAngle||0,N=1,O=C.attachmentPoint||1,o=O%3,J=Math.floor(O/3),J=1===J?"middle":0===J?"top":"bottom",Q=0===o?"right":2===o?"center":"left";else{b=f.toLocal(C.textHeight||12),c=C.rotation||0,N=C.xScale||1,2===C.generationFlags?c=2*Math.PI-c:4===C.generationFlags?c=Math.PI-c:6===C.generationFlags&&(c=Math.PI+c),o=C.halign,J=C.valign;var k=C.startPoint;(!k||o||J)&&(k=C.endPoint),U=f.toLocal(k.x,1),K=f.toLocal(k.y,2),4===o&&(o=1,J=2),Q=2===o||5===o?"right":1===o||4===o?"center":"left",J=3===J?"top":2===J?"middle":"bottom"}K+=b/6,c=2*Math.PI-c;var P=b*D,Z=1;if(P<G&&(Z=P/G,P=G),5===o){var v=C.startPoint,a=C.endPoint;if(v&&a){var F=a.x-v.x;N=F/y.length/b}}if(E=y.match(/\\H([0-9\.]+)x;/)){var w=parseFloat(E[1]);P*=w,b*=w}var B=1;if((E=y.match(/\\W([0-9\.]+)[x;]/))&&(B=parseFloat(E[1])),q=P+"px "+(C.font||f.options.font),y=y.replace(/%%%/g,"%"),y=y.replace(/%%P/g,"\xb1"),y=y.replace(/%%C/g,"\u0444"),"MTEXT"===H){y=y.replace(/\\{/g,"#@#"),y=y.replace(/\\}/g,"#@@"),y=y.replace(/({|})/g,""),y=y.replace(/#@#/g,"{"),y=y.replace(/#@@/g,"}");var E;for(y=y.replace(/\\[FfLIOoKkNXQHWSACT~][^;]*;/g,""),t=y.split("\\P"),T=0;T<t.length;T++)X={type:"text",cadType:H,cadLayer:C.layer,handle:C.handle,color:z,text:t[T],rotation:c,rect:[U,K+T*b*1.5,0,0],align:Q,vAlign:J,font:q,visible:!C.hidden},1!==Z&&(X.scaleX=X.scaleY=Z),X.scaleX=B*Z,f.shapeComps.push(X)}else X={type:"text",cadType:H,cadLayer:C.layer,handle:C.handle,color:z,text:y,scaleX:N,rotation:c,rect:[U,K,1e-5,1e-5],align:Q,vAlign:J,font:q,visible:!C.hidden},1!==Z&&(X.scaleX*=Z,X.scaleY=Z),f.shapeComps.push(X)}}},Q.prototype.drawAttrDef=function(){var i,H,R,M,I,p,h,z,d,C,y,b,U,K,q,Q,m,X,o,J=this,O=J._models;o=J.options.textScaleRatio;var c=J.options.useTextCompScale?J.options.browserMinFontSize:0,t=O.ATTDEF,T=[],N={};for(R in t)for(M=t[R],i=0,H=M.length;i<H;i++){I=M[i],h=J.toLocal(I.textHeight||12),m=I.rotation||0,2===I.generationFlags?m=2*Math.PI-m:4===I.generationFlags?m=Math.PI-m:6===I.generationFlags&&(m=Math.PI+m),m=2*Math.PI-m,q=I.halign,Q=I.valign;var D=I.startPoint;(!D||q||Q)&&(D=I.endPoint),z=J.toLocal(D.x,1),d=J.toLocal(D.y,2),b=I.tag,p=I.text||b||"";var f=N[b]||0;N[b]=f+1,f>0&&(b=b+"_"+f),U=[z,d,1e-5,1e-5],b&&(U={func:new Function("data","view",["return [",'    (data.ca("x") || 0) + '+(z-D.x)+",",'    (data.ca("y") || 0) + '+(d+D.y)+",","    1e-5, 1e-5","];"].join("\n")),value:U},T.push({attr:b+".text",valueType:"String"},{attr:b+".x",valueType:"Number"},{attr:b+".y",valueType:"Number"})),4===q&&(q=1,Q=2),y=2===q||5===q?"right":1===q||4===q?"center":"left",Q=3===Q?"top":2===Q?"middle":"bottom";var n=h*o,G=1;n<c&&(G=n/c,n=c),C=n+"px "+(I.font||J.options.font),X=I.scale||1,K={type:"text",cadType:"ATTDEF",cadLayer:I.layer,handle:I.handle,color:R,text:p,scaleX:X,scaleY:X,rotation:m,rect:U,align:y,vAlign:Q,font:C,visible:!I.invisible,prefix:b},1!==G&&(K.scaleX*=G,K.scaleY=G),J.shapeComps.push(K)}return T},Q.prototype.drawEllipse=function(){var i,H,R,M,I,p,h,z,d,C,y,b,U,K,q,Q,X,o,J,O,c,t,T=this,N=T._models;for(i=m.ELLIPSE,M=0,I=i.length;M<I;M++){H=i[M],R=N[H];for(z in R)for(d=R[z],p=0,h=d.length;p<h;p++){if(C=d[p],y=C.major,b=Math.atan2(y.y,y.x),U=T.toLocal(Math.sqrt(y.x*y.x+y.y*y.y)),K=U*C.ratio,q=C.startAngle||0,Q=C.angleLength||2*Math.PI,X=q+Q,o=T.toLocal(C.center.x,1),J=T.toLocal(C.center.y,2),O=C.xInvert,c=C.yInvert^T.extrusionZNagative(C),c^=1,c||O?O&&c?(q=Math.PI+q,X=Math.PI+X,t=!1):(q=Math.PI*(O?1:2)-q,X=Math.PI*(O?1:2)-X,t=!0):t=!1,t){var D=q;q=X,X=D}b=2*Math.PI-b;var f={type:"arc",cadType:H,cadLayer:C.layer,handle:C.handle,borderColor:z,borderWidth:1,borderWidthAbsolute:!0,rotation:b,rect:[o-U,J-K,2*U,2*K],arcFrom:q,arcTo:X,arcClose:!1,arcOval:!0};T.options.convertArcToBezier?T.shapeComps.push(T._convertArcToBezier(f)):T.shapeComps.push(f)}}},Q.prototype._convertArcToBezier=function(i){var H=i.arcFrom,R=i.arcTo;if(H===R)return i;H>R&&(R+=2*Math.PI);var M={type:"shape"},I=i.rect,p="type,rect,arcFrom,arcTo,arcClose,arcOval,rotation".split(",");for(var h in i)p.indexOf(h)>=0||(M[h]=i[h]);var z,d,C,y,b,U=M.points=[],K=M.segments=[1],q=R-H,Q=Math.max(Math.ceil(Math.abs(q)/Math.PI*2),1),m=q/Q,X=Math.tan(.5*m),o=Math.sin(m)*(Math.sqrt(4+3*X*X)-1)/3,J=Math.cos(H),O=Math.sin(H),c=I[2]/2,t=I[3]/2,T=I[0]+c,N=I[1]+t,D=Math.sin(i.rotation||0),f=Math.cos(i.rotation||0),n=function(i,H){var R=c*i,M=t*H;return{x:T+(f*R-D*M),y:N+(D*R+f*M)}},G=n(J,O);U.push(G.x,G.y);for(var k=0;k<Q;k++)C=H+(k+1)*m,z=Math.cos(C),d=Math.sin(C),G=n(J-O*o,O+J*o),y=n(z+d*o,d-z*o),b=n(z,d),J=z,O=d,U.push(G.x,G.y,y.x,y.y,b.x,b.y),K.push(4);return M},Q.prototype._transformPoint=function(i,H,R){if(i){var M=i.x,I=i.y;return R=R||1,{x:M*R*H.a+I*H.c+H.tx,y:M*R*H.b+I*H.d+H.ty}}},Q.prototype._groupEntity=function(i,H,R,M,I){var p=this,h=p.getColor(H,R);if(h&&(!p.options.filter||!p.options.filter(H,I))){var z,d,C,y=p._transformPoint,b=H.type;if("DIMENSION"===b||"INSERT"===b){if(!H.block)return;var U=R.blocks[H.block];if(!U||!U.entities)return;if(!(C=p._blockDef[H.block]))return void console.log("no entity ",H.block);var K=M||{a:1,b:0,c:0,d:1,tx:0,ty:0};if("INSERT"===b){var q=H.scale?H.scale.x:1,Q=H.scale?H.scale.y:1,m=0,X=1,o=0;if(H.deg&&(m=H.deg*Math.PI/180,m=2*Math.PI-m,X=Math.cos(m),o=Math.sin(m)),M){var J=q*X,O=q*o,c=-Q*o,t=Q*X,T=H.center.x,N=H.center.y;K={a:M.a*J+M.c*O,b:M.b*J+M.d*O,c:M.a*c+M.c*t,d:M.b*c+M.d*t,tx:M.a*T+M.c*N+M.tx,ty:M.b*T+M.d*N+M.ty}}else K={a:q*X,b:q*o,c:-Q*o,d:Q*X,tx:H.center.x,ty:H.center.y}}p.extrusionZNagative(H)&&(K.a*=-1,K.c*=-1,K.tx*=-1);var D=C.bound,f=(D.pos.x,D.pos.y,y({x:D.xMin,y:D.yMin},K)),n=y({x:D.xMax,y:D.yMax},K),G=y({x:D.xMin,y:D.yMax},K),k=y({x:D.xMax,y:D.yMin},K),P=p._bound;P.xMin=Math.min(P.xMin,f.x,n.x,G.x,k.x),P.yMin=Math.min(P.yMin,f.y,n.y,G.y,k.y),P.xMax=Math.max(P.xMax,f.x,n.x,G.x,k.x),P.yMax=Math.max(P.yMax,f.y,n.y,G.y,k.y);var Z;(Z=p._models.BLOCK)||(p._models.BLOCK=Z=[]);var v={handle:H.handle,block:H.block,transform:K,attribs:H.attribs}
;return parseInt(h.slice(1),16)!==p.options.defaultColor&&(v.color=h),void Z.push(v)}(z=i[b])||(z=i[b]={}),(d=z[h])||(d=z[h]=[]);var a=p.extrusionZNagative(H)&&["POINT","LINE","ELLIPSE"].indexOf(b)<0;if(M||a){M||(M={a:1,b:0,c:0,d:1,tx:0,ty:0});var F={};for(var w in H)F[w]=H[w];F.radius&&(F.radius*=Math.sqrt(M.a*M.a+M.b*M.b)),F.textHeight&&(F.textHeight*=Math.sqrt(M.a*M.a+M.b*M.b));var B=a?-1:1;if(F.position=y(F.position,M,B),F.startPoint=y(F.startPoint,M,B),F.center=y(F.center,M,B),"ELLIPSE"===b){var E;E=y({x:H.major.x+H.center.x,y:H.major.y+H.center.y},M,B),F.major={x:E.x-F.center.x,y:E.y-F.center.y},p.extrusionZNagative(H)&&(F.major.x*=-1)}var _;F.vertices&&(_=[],F.vertices.forEach(function(i){var H=y(i,M,B);i.bulge&&(H.bulge=i.bulge),_.push(H)}),F.vertices=_),F.points&&(_=[],F.points.forEach(function(i){var H=y(i,M,B);i.bulge&&(H.bulge=i.bulge),_.push(H)}),F.points=_);var x=Math.atan2(M.b,M.a),j=Math.cos(x);F.yInvert=M.d*j<0,F.xInvert=M.a*j<0,0!==x&&(F.addonAngle=x),H=F}p.mergeBound(H),d.push(H)}},Q.prototype.getPointsBound=function(i){for(var H=1/0,R=1/0,M=-1/0,I=-1/0,p=0,h=i.length;p<h;p++){var z=i[p];H=Math.min(H,z.x),R=Math.min(R,z.y),M=Math.max(M,z.x),I=Math.max(I,z.y)}return{xMin:H,yMin:R,xMax:M,yMax:I}},Q.prototype.mergeBound=function(i){var H,M,I=this;M=i.type;for(H in m){if(m[H].indexOf(M)>=0)break;H=R}if(H){var p,h,z,d,C,y,b,U,K,q,Q,X,o,J,O,c,t,T,N,D,f,n=I.getPointsBound;switch(H){case"LINE":case"LWLINE":for(p=n(i.vertices),D=i.vertices.length,T=0;T<D;T++)N=i.vertices[T],I._isStraightLine(N.bulge)||(T!==D-1||i.shape)&&(f=n(I._getBulgeSegment(N,i.vertices[(T+1)%D],N.bulge)),p.xMin=Math.min(p.xMin,f.xMin),p.yMin=Math.min(p.yMin,f.yMin),p.xMax=Math.max(p.xMax,f.xMax),p.yMax=Math.max(p.yMax,f.yMax));break;case"SOLID":p=n(i.points);break;case"POINT":if(!i.position)return;h=i.position.x,z=i.position.y,p={xMin:h,yMin:z,xMax:h,yMax:z};break;case"TEXT":case"ATTDEF":var G=i.text||"";if("TEXT"===H&&!G)return;h=i.position?i.position.x:i.startPoint.x,z=i.position?i.position.y:i.startPoint.y,t=i.height||i.textHeight||12,I._minFontSize=Math.min(I._minFontSize,t),p={xMin:h,yMin:z,xMax:h+t*G.length,yMax:z+t};break;case"CIRCLE":for(h=i.center.x,z=i.center.y,d=i.radius,C=[],y=i.startAngle||0,b=y+(i.angleLength||2*Math.PI),U=i.xInvert^I.extrusionZNagative(i),K=i.yInvert,q=U?-1:1,Q=K?-1:1,X=y;X<b+Math.PI/30;X+=Math.PI/30)X=Math.min(X,b),C.push({x:h+q*d*Math.cos(X),y:z+Q*d*Math.sin(X)});p=n(C);break;case"ELLIPSE":for(h=i.center.x,z=i.center.y,C=[],o=Math.sqrt(i.major.x*i.major.x+i.major.y*i.major.y),J=o*i.ratio,d=Math.atan2(i.major.y,i.major.x),O=Math.sin(d),c=Math.cos(d),y=i.startAngle||0,b=y+(i.angleLength||2*Math.PI),U=i.xInvert,K=i.yInvert^I.extrusionZNagative(i),q=U?-1:1,Q=K?-1:1,X=y;X<b+Math.PI/30;X+=Math.PI/30){X=Math.min(X,b);var k=q*o*Math.cos(X),P=Q*J*Math.sin(X);C.push({x:h+(c*k-O*P),y:z+(O*k+c*P)})}p=n(C);break;default:return}var Z=I._bound;Z.xMin=Math.min(Z.xMin,p.xMin),Z.yMin=Math.min(Z.yMin,p.yMin),Z.xMax=Math.max(Z.xMax,p.xMax),Z.yMax=Math.max(Z.yMax,p.yMax)}},Q.prototype.parseFile=function(i){var H=this,R="string"==typeof H.options.sanitize?{sanitize:H.options.sanitize}:null,M=new h(R),I=M.parseSync(i);H._dxf=I,H._isAc2015="AC1015"===I.header.$ACADVER,H._dxfViewport=H.getCameraParametersFromDxf(I)},Q.prototype.toLocal=function(i,H){var R=this;return(2===H?-(i-R._shiftY):1===H?i-R._shiftX:i)*R._scale},Q.prototype.getCameraParametersFromDxf=function(i){var H,R,M,I,p,h,z,d,C,y,b,U;if(!H&&i.tables&&i.tables.viewPort){y=i.tables.viewPort.viewPorts;for(C in y)if(b=y[C],U=b.viewDirectionFromTarget,b.center&&(0===b.renderMode||U&&0===U.x&&0===U.y&&1===U.z)){M=b.center,I=b.upperRightCorner,p=b.lowerLeftCorner,H={x:I.x,y:I.y},R={x:p.x,y:p.y},h=b.viewWidth||0,z=b.viewHeight||0,b.viewTarget&&(M={x:M.x+b.viewTarget.x,y:M.y+b.viewTarget.y});break}}return!H&&i.header&&(d=i.header,d.$EXTMIN&&d.$EXTMAX&&(H=d.$EXTMAX,R=d.$EXTMIN)),h=Math.max(h,H.x-R.x),z=Math.max(z,H.y-R.y),M=M||{x:h/2+R.x,y:z/2+R.y},{width:h,height:z,x:M.x,y:M.y}},Q.prototype.getColor=function(i,H){var M,I=this;if(i||console.log("no entity",i),H.tables&&H.tables.layer&&(M=H.tables.layer.layers[i.layer]),!M||M.visible){var p;i.color!==R?0===(p=i.color)&&(p=I.options.defaultColor):M&&(p=M.color),p&&16777215!==p||(p=I.options.defaultColor);var p="#"+((1<<24)+p).toString(16).slice(1);return I.options.mapColor&&(p=I.options.mapColor(p)),p}},Q.prototype.sortBlocks=function(i){var R,M,I,p,h=H.keys(i),z={};for(R in i)if(M=i[R],M.entities)for(var d=0,C=M.entities.length;d<C;d++)I=M.entities[d],"DIMENSION"!==(p=I.type)&&"INSERT"!==p||I.block&&(z[R]||(z[R]=[]),z[R].push(I.block));for(var y=h.length,b=y,U={},K=new Array(y),q=!1,Q=function(i,H,R){if(R.indexOf(i)>=0)return void(q=!0);if(!U[H]){U[H]=!0;var M=z[i],I=M?M.length:0;if(I){var p=R.concat(i);do{var d=M[--I];if(Q(d,h.indexOf(d),p),q)break}while(I)}K[--y]=i}};b--;)U[b]||Q(h[b],b,[]);return q?[]:K};var X=[0,5,9,13,15,18,20,25,30,35,40,50,53,60,70,80,90,100,106,120,140,158,200,211],o=function(i){for(var H,R,M,I,p=X.length,h=1;h<p;h++)if(H=X[h-1],R=X[h],M=H-i,I=R-i,M<=0&&I>=0)return Math.abs(M)<Math.abs(I)?H:R;return R},J=y.DxfWriter=function(i){this.init(i)};J.prototype={},J.prototype.constructor=J,H.defineProperties(J.prototype,{}),J.prototype.init=function(i){var R=this,M=y.DxfWriter.template;M.converted||(H.keys(M).forEach(function(i){M[i]=M[i].join("\n")}),M.converted=!0),R._transformFunc=i.transformFunc||function(i){return i},R._drawingScale=i.scale||1,R._matchFunc=i.matchFunc||function(){return!0},R._maxHandleId=262128},J.prototype.toDxf=function(i,H){var R=this;return R.dxfContent=i,R.gv=H,R.outputEntityLines=["ENTITIES","  0","ENDSEC"],R._fetchEntityContent(),R._collectGvEntity(),R._insertEntities(),R._write()},J.prototype._collectGvEntity=function(){var i=this;i.gv.dm().toDatas(i._matchFunc).each(function(H){var R=H.a("handle");R&&i._recordMaxHandleId(R)})},J.prototype._fetchEntityContent=function(){var i=this,H=i.dxfContent,R=i.entitiesStartIndex=H.indexOf("ENTITIES"),M=i.entitiesEndIndex=H.indexOf("ENDSEC",R)+"ENDSEC".length;i.entitiesContent=H.slice(R,M),i.dxfEntityLines=i.entitiesContent.split(/\r\n|\n/)},J.prototype._updateEntities=function(){var i=this,H=i.outputEntityLines,M=i.dxfEntityLines,I=i.gvEntities;H.push(M[0]);for(var p,h,z,d,C,y,b,U,K,q,Q,m,X,o,J=1,O=1e5,c=i._findCode,t=i._toFloat;O--;){if("ENDSEC"===(d=M[J+1].trim())){H.push(M[J]),H.push(M[J+1]);break}for(p=J+2;O--&&"0"!==M[p].trim();)p+=2;if(C=M[c("5",M,J,p)],i._recordMaxHandleId(C),y=I[C]){for(h=H.length,Q=J;Q<p;Q++)H.push(M[Q]);if(z=H.length,J=p,"edge"!==y.a("shapeType")){if("image"===y.a("shapeType")){for(b=i._getNodeRealScale(y),K=2*Math.PI-y.getRotation();K>=2*Math.PI;)K-=2*Math.PI;for(;K<0;)K+=2*Math.PI;U=i._transformFunc(y.getPosition()),Math.abs(b.x-1)<1e-5&&Math.abs(b.y+1)<1e-5&&(b.x=-1,b.y=1,K=2*Math.PI-K);var T={};[{key:"10",value:U.x},{key:"20",value:U.y},{key:"42",value:b.y,default:1,before:["50"]},{key:"41",value:b.x,default:1,dependOn:"42",before:["42","50"]},{key:"50",value:180*K/Math.PI,default:0}].forEach(function(i){if(m=i.key,X=i.value,o=i.default!==R&&Math.abs(X-i.default)<1e-5,X=t(X,"10"===m||"20"===m||"50"===m),q=c(m,H,h,z))X!==H[q].trim()&&(H[q]=X);else{if(o&&(!i.dependOn||T[i.dependOn]))return void(T[m]=!0);var M=!1;do{if(!i.before)break;if(q=R,i.before.forEach(function(i){var R=c(i,H,h,z);R&&(!q||R<q)&&(q=R)}),!q)break;H.splice(q-1,0," "+m,X),M=!0}while(!1);M||(H.push(" "+m),H.push(X)),z+=2}})}}else i._tryUpdateEdge(H,h,z,d,y)}else console.log("have no entity with handle "+C+" "+d),J=p}},J.prototype._recordMaxHandleId=function(i){var H=parseInt("0x"+i),R=this;R._maxHandleId=Math.max(R._maxHandleId,H)},J.prototype._nextHandleId=function(){return(++this._maxHandleId).toString(16).toUpperCase()},J.prototype._getNodeRealScale=function(i){var H=this,R=i.getScale(),M=i.getSize(),I=y.Default.getImage(i.getImage());return{x:R.x*M.width*I.scale/(I.width*H._drawingScale),y:R.y*M.height*I.scale/(I.height*H._drawingScale)}},J.template={INSERT:["  0","INSERT","  5","$HANDLE","330","1F","100","AcDbEntity","  8","0","100","AcDbBlockReference","  2","$BLOCK"," 10","$POSITION.X"," 20","$POSITION.Y"," 30","0.0"," 41","$SCALE.X"," 42","$SCALE.Y"," 50","$ROTATION"]},J.prototype._insertEntities=function(){var i,H=this;H.gv.dm().toDatas(H._matchFunc).each(function(R){if(i=null,R.a("addonBlock"))i=H._addonBlock(R);else if(R.a("addonText"))i=H._addonText(R);else if(R.a("addonARC")&&!R.s("shape.arc.oval")){var M=R.s("shape.arc.to"),I=R.s("shape.arc.from")||0;i=!M||Math.abs(M-I)>=2*Math.PI?H._addonCircle(R):H._addonARC(R)}else R.a("addonARC")&&R.s("shape.arc.oval")?i=H._addonEllipse(R):R.a("addonLine")?i=H._addonLine(R):R.a("addonRect")&&(i=H._addonRect(R));if(i){var p=i.length,h=H.outputEntityLines.length,z=h+p;H.outputEntityLines.length=z,H.outputEntityLines[z-1]=H.outputEntityLines[h-1],H.outputEntityLines[z-2]=H.outputEntityLines[h-2];for(var d=0,C=h-2;d<p;++d,++C)H.outputEntityLines[C]=i[d]}})};var O=function(i){if(i instanceof y.Shape){var H=new y.Matrix,R=i.getPosition();return H.translate(-R.x,-R.y).scale(i.getScaleX(),i.getScaleY()).rotate(i.getRotation()).translate(R.x,R.y),H}return i.getMatrix?i.getMatrix():new y.Matrix};J.prototype._addonRect=function(i){var H=this,R=i.getPoints(),M=i.getSegments(),I=!0;M&&(I=5===M.get(M.size()-1));var p=i.s("shape.dash"),h=i.s("shape.dash.pattern"),z=p?h[0]/10:1,d=10*(i.s("shape.border.width")||0);d=o(d);var C,b=i.s("shape.border.color");p&&(b=i.s("shape.dash.color")),b&&(b=y.Default.toColorData(b),parseFloat((b[3]/255).toFixed(2)),b=(b[0]<<16)+(b[1]<<8)+b[2],C=q.indexOf(b));var U=["  0","LWPOLYLINE","  5",i.a("handle")||H._nextHandleId(),"330","1F","100","AcDbEntity","  8","0"];p&&U.push.apply(U,["  6","DASHED"]),b&&(C>=0?U.push.apply(U,[" 62",C]):U.push.apply(U,["420",b])),1!==z&&U.push.apply(U,[" 48",z]),y.Default.isNumber(d)&&U.push.apply(U,["370",d]),U.push.apply(U,["100","AcDbPolyline"," 90","        "+R.size()," 70","     "+(I?1:0)," 43","0.0"]);var K,Q=H._toFloat,m=O(i);return R.each(function(i){K=H._transformFunc(m.tf(i)),U.push.apply(U,[" 10",Q(K.x,!0)," 20",Q(K.y,!0)])}),U},J.prototype._addonCircle=function(i){var H=this,R=["  0","CIRCLE","  5",i.a("handle")||H._nextHandleId(),"330","1F","100","AcDbEntity","  8","0","100","AcDbCircle"],M=H._toFloat,I=H._transformFunc(i.getPosition());R.push.apply(R,[" 10",M(I.x,!0)," 20",M(I.y,!0)," 30","0.0"]);var p=i.getScale(),h=i.getWidth()*p.x,z=i.getHeight()*p.y;return R.push.apply(R,[" 40",.5*Math.min(h,z)/H._drawingScale]),R},J.prototype._addonLine=function(i){var H,R=this,M=[],I=R._toFloat,p=i.getPoints(),h=O(i),z=R._transformFunc(h.tf(p.get(0))),d=i.a("handle")||R._nextHandleId(),C=i.s("shape.dash"),b=i.s("shape.dash.pattern"),U=C?b[0]/10:1,K=10*(i.s("shape.border.width")||0);K=o(K);var Q,m=i.s("shape.border.color");return C&&(m=i.s("shape.dash.color")),m&&(m=y.Default.toColorData(m),parseFloat((m[3]/255).toFixed(2)),m=(m[0]<<16)+(m[1]<<8)+m[2],Q=q.indexOf(m)),p.each(function(i,p){0!==p&&(M.push.apply(M,["  0","LINE","  5",d,"330","1F","100","AcDbEntity","  8","0"]),C&&M.push.apply(M,["  6","DASHED"]),m&&(Q>=0?M.push.apply(M,[" 62",Q]):M.push.apply(M,["420",m])),1!==U&&M.push.apply(M,[" 48",U]),y.Default.isNumber(K)&&M.push.apply(M,["370",K]),M.push.apply(M,["100","AcDbLine"]),M.push.apply(M,[" 10",I(z.x,!0)," 20",I(z.y,!0)," 30","0.0"]),H=R._transformFunc(h.tf(i)),M.push.apply(M,[" 11",I(H.x,!0)," 21",I(H.y,!0)," 31","0.0"]),z=H,d=R._nextHandleId())}),M},J.prototype._addonEllipse=function(i){var H=this,R=["  0","ELLIPSE","  5",i.a("handle")||H._nextHandleId()];R.push.apply(R,["330","1F","100","AcDbEntity","  8","0","100","AcDbEllipse"]);var M=H._toFloat,I=H._transformFunc(i.getPosition());R.push(" 10");R.push(M(I.x,!0));R.push(" 20");R.push(M(I.y,!0)),R.push.apply(R,[" 30","0.0"]);var p,h=i.getScale(),z=i.getWidth()*h.x/H._drawingScale,d=i.getHeight()*h.y/H._drawingScale,C=.5*Math.max(z,d),y=0;z>d?p={x:C,y:0}:(p={x:0,y:C},y=.5*-Math.PI);var b=-i.getRotation(),U=Math.sin(b),K=Math.cos(b),q=K*p.x-U*p.y,Q=U*p.x+K*p.y;R.push.apply(R,[" 11",M(q,!0)," 21",M(Q,!0)," 31","0.0"]),R.push.apply(R,["210","0.0","220","0.0","230","1.0"]);var m=z/d;m>1&&(m=1/m),R.push.apply(R,[" 40",M(m,!0)]);var X=i.s("shape.arc.from"),o=i.s("shape.arc.to"),J=2*Math.PI-o+y,O=(J+o-X)%(2*Math.PI);return R.push.apply(R,[" 41",J," 42",O||2*Math.PI]),R},J.prototype._addonARC=function(i){var H=this,R=["  0","ARC","  5",i.a("handle")||H._nextHandleId()];R.push.apply(R,["330","1F","100","AcDbEntity","  8","0","100","AcDbCircle"]);var M=H._toFloat,I=H._transformFunc(i.getPosition());R.push(" 10");R.push(M(I.x,!0));R.push(" 20");R.push(M(I.y,!0)),R.push.apply(R,[" 30","0.0"]);var p=i.getScale(),h=i.getWidth()*p.x,z=i.getHeight()*p.y,d=.5*Math.min(h,z);R.push.apply(R,[" 40",M(d/H._drawingScale,!0)]),R.push.apply(R,["100","AcDbArc"]);var C=i.getRotation(),y=i.s("shape.arc.from"),b=i.s("shape.arc.to"),U=2*Math.PI,K=(U-b-C)%U,q=(K+b-y)%U;return q=q||2*Math.PI,R.push.apply(R,[" 50",M(180*K/Math.PI,!0)," 51",M(180*q/Math.PI,!0)]),R};var c={left:0,center:1,right:2},t={top:3,middle:2,bottom:1};J.prototype._addonText=function(i){var H=this,R=["  0","TEXT","  5",i.a("handle")||H._nextHandleId()];R.push.apply(R,["330","1F","100","AcDbEntity","  8","0","100","AcDbText"]);var M=i.s("text.font")||"16px Standard",I=i.s("text"),p=y.Default.getTextSize(M,I),h=i.getScale(),z=parseFloat(M)/H._drawingScale*h.y,d=z/p.height*p.width,C=H._toFloat,b=H._transformFunc(i.getPosition());b.y+=z/4;var U=R.push(" 10");R.push(C(b.x,!0));var K=R.push(" 20");R.push(C(b.y,!0)),R.push.apply(R,[" 30","0.0"]),R.push(" 40"),R.push(z),R.push("  1"),R.push(I);var q=2*Math.PI-i.getRotation();R.push(" 50"),R.push(C(180*q/Math.PI%360,!0)),R.push(" 41"),R.push(h.x/h.y),M=M.substr(M.indexOf("px")+3).split(","),R.push("  7"),R.push(M[0]);var Q=i.s("text.align")||"left",m=i.s("text.vAlign")||"bottom";if("left"!==Q&&(R.push(" 72"),R.push("     "+c[Q])),"bottom"!==m||"left"!==Q){R.push(" 11"),R.push(C(b.x,!0)),R.push(" 21"),R.push(C(b.y,!0)),R.push.apply(R,[" 31","0.0"]);var X=0,o=0;"center"===Q?X=.5*d:"right"===Q&&(X=d),X*=h.x,"top"===m?o=z:"middle"===m&&(o=.5*z),o*=h.y;var J=Math.cos(q+Math.PI),O=Math.sin(q+Math.PI);R[U]=J*X-O*o+b.x,R[K]=O*X+J*o+b.y}return R.push.apply(R,["100","AcDbText"]),"bottom"!==m&&(R.push(" 73"),R.push("     "+t[m])),R},J.prototype._addonBlock=function(i){var H=this,R=y.DxfWriter.template.INSERT;R=R.replace("$HANDLE",i.a("handle")||H._nextHandleId()),R=R.replace("$BLOCK",i.getImage());for(var M=H._getNodeRealScale(i),I=2*Math.PI-i.getRotation();I>=2*Math.PI;)I-=2*Math.PI;for(;I<0;)I+=2*Math.PI;var p=H._transformFunc(i.getPosition());Math.abs(M.x-1)<1e-5&&Math.abs(M.y+1)<1e-5&&(M.x=-1,M.y=1,I=2*Math.PI-I);var h=H._toFloat;return R=R.replace("$POSITION.X",h(p.x,!0)),R=R.replace("$POSITION.Y",h(p.y,!0)),R=R.replace("$SCALE.X",h(M.x)),R=R.replace("$SCALE.Y",h(M.y)),R=R.replace("$ROTATION",h(180*I/Math.PI,!0)),R.split(/\r\n|\n/)},J.prototype._tryUpdateEdge=function(i,H,R,M,I){var p=this,h=y.Default.getInternal(),z=h.getEdgeAgentPosition(p.gv,I.getSourceAgent(),I.s("edge.source.position"),I.s("edge.source.offset.x"),I.s("edge.source.offset.y"),I.s("edge.source.anchor.x"),I.s("edge.source.anchor.y")),d=h.getEdgeAgentPosition(p.gv,I.getTargetAgent(),I.s("edge.target.position"),I.s("edge.target.offset.x"),I.s("edge.target.offset.y"),I.s("edge.target.anchor.x"),I.s("edge.target.anchor.y"));z=p._transformFunc(z),d=p._transformFunc(d);var C=p._findCode;if("LINE"===M)i[C("10",i,H,R)]=z.x,i[C("20",i,H,R)]=z.y,i[C("11",i,H,R)]=d.x,i[C("21",i,H,R)]=d.y;else if("LWPOLYLINE"===M){for(var b,U=C("10",i,H,R),K=U;b=C("10",i,K+1,R);)K=b;K=(b=C("30",i,K+1,R))?b:C("20",i,K+1,R),i.splice(U-1,K-U+2);var q=[z];I.s("edge.points").each(function(i){q.push(p._transformFunc(i))}),q.push(d);var Q=U-1;q.forEach(function(H){i.splice(Q,0,"10",H.x,"20",H.y),Q+=4})}},J.prototype._findCode=function(i,H,R,M){for(var I=R,p=!1;I<M;){if(i===H[I].trim()){p=!0;break}I+=2}if(p)return I+1},J.prototype._toFloat=function(i,H){return H||(i=Math.round(1e8*i)/1e8),i=""+i,i.indexOf(".")<0&&(i+=".0"),i},J.prototype._write=function(){var i=this,H=i.dxfContent,R=i.outputEntityLines.join("\n"),M=i.entitiesStartIndex,I=i.entitiesEndIndex;return H.slice(0,M)+R+H.slice(I)}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);var LR=function(){function i(H,R){hR(this,i),this.editor=R,this.handler=H,this.cookie=0,this.callbacks={},this.cmds={};var M=KR.config.host||window.location.hostname,I=KR.config.port||window.location.port,p=this.url=window.location.protocol+"//"+M+":"+I;this.socket=io.connect(p),this.initEventListener()}return i.prototype.request=function(i,H,R){var M=++this.cookie;this.callbacks[M]=R,this.cmds[M]=i;var I=this.editor.sid;this.socket.emit(i,M,H,I?{sid:I}:null);var p=i;H&&(ti(H)?p=i+": "+H:H.path&&(p=i+": "+H.path)),this.handler({type:"request",message:p,cmd:i,data:H})},i.prototype.handleRespone=function(i,H){var R=this.callbacks[i],M=this.cmds[i];delete this.callbacks[i],delete this.cmds[i],this.handler({type:"response",message:M,cmd:M,data:H}),R&&R(H)},i.prototype.initEventListener=function(){var i=this;this.socket.on("connect",function(){i.handler({type:"connected",message:i.url})}),this.socket.on("disconnect",function(){i.handler({type:"disconnected",message:i.url})}),this.socket.on("fileChanged",function(H){i.handler({type:"fileChanged",path:H.path,event:H.event})}),this.socket.on("operationDone",function(H,R){i.handleRespone(H,R)}),this.socket.on("download",function(H){i.handler({type:"download",path:H})}),this.socket.on("confirm",function(H,R){i.handler({type:"confirm",path:H,datas:R})})},i}(),uR=function(i){function H(R,M){var I=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];hR(this,H);var p=CR(this,i.call(this,M));return p.editor=R,p.editable=I,p.dragToIndexEnabled=!0,p.dragToChildEnabled=!0,p.addTopPainter(p.drawDNDState.bind(p)),p}return dR(H,i),H.prototype.getLabelColor=function(H){return H!==this.draggingData||this.isSelected(H)?H.s("2d.visible")&&H.s("3d.visible")?i.prototype.getLabelColor.call(this,H):KR.config.color_disabled:KR.config.color_select},H.prototype.handleDelete=function(){this.editable&&this.removeSelection()},H.prototype.isDroppable=function(i,H){return!1},H.prototype._clearDragInfo=function(){this.editor.dnd.hideTip(),this._dragInfo&&(this._dragInfo=null,this.redraw())},H.prototype._endDrag=function(i,H){},H.prototype._endCrossDrag=function(i,H){},H.prototype.drawDNDState=function(i){KR.config.drawDNDState?i.drawDNDState=!0:(KR.config.texureImage3D&&(i.texureImage3D=!0),i.texureImage2D=!0);var H=void 0;if(this._dragInfo&&this._dragInfo.inView?H=this._dragInfo:this._crossDragInfo&&(H=this._crossDragInfo),H){var R=this.getWidth(),M=this.getRowHeight(),I=H.type,p=H.parent,h=p?this.getRowDatas().indexOf(p):-1,z=KR.config.color_select_dark;if(H.refData){if(this.dragToChildEnabled&&L(i,z,0,h*M,R,M,2),"up"===I||"down"===I){var d=H.x,C=H.y;i.beginPath(),i.arc(d-3,C,3,0,2*Math.PI,!0),i.moveTo(d,C),i.lineTo(R,C),i.lineWidth=2,i.strokeStyle=z,i.stroke()}}else{var y=this.getViewRect();L(i,z,y.x,y.y,y.width,y.height,2)}}},H.prototype._dragging=function(i,H){var R=this.getRowHeight(),M=this.lp(i),I=M.y/R,p=Math.floor(I);if(p>this.getRowSize()-1||p<0)H.refData=null,H.type="parent",H.parent=null;else{var h=M.y-p*R,z=this.dragToChildEnabled?.25:.5,d=this.dragToChildEnabled?.75:.5;this.dragToIndexEnabled?H.type=h<R*z?"up":h>R*d?"down":"parent":H.type="parent";var C=H.refData=this.getRowDatas().get(p);"up"===H.type?(H.parent=C.getParent(),H.x=(this.getLevel(C)+1)*this.getIndent(),H.y=p*R):"down"===H.type?(this.getToggleIcon(C)===this.getExpandIcon()?(H.parent=C,H.x=(this.getLevel(C)+2)*this.getIndent()):(H.parent=C.getParent(),H.x=(this.getLevel(C)+1)*this.getIndent()),H.y=(p+1)*R):H.parent=C}this.autoScroll(i),this.redraw()},H.prototype.$1$=function(){var i="";if(this.draggingData&&(i=this.getLabel(this.draggingData),this.isSelected(this.draggingData))){var H=this.sm().size();i+=H>1?" (+"+H+") ":""}return i},H.prototype.handleDragAndDrop=function(i,H){if(this.editable){if("prepare"===H)return void this._clearDragInfo();"begin"===H&&(this._dragInfo={tip:this.$1$(),view:this});var R=this._dragInfo;if(R){var M=this.editor.dnd;if("begin"===H||"between"===H){return this.getView().contains(n(i))?(R.inView=!0,this._dragging(i,R),M.clearDropView(i,R)):(R.inView&&this.redraw(),R.inView=!1,M.crossDrag(i,R)),void M.showTip(R.tip,i)}return"end"===H?(R.inView?this._endDrag(i,R):M.crossDrop(i,R),void this._clearDragInfo()):"cancel"===H?(R.inView||M.crossCancel(i,R),void this._clearDragInfo()):void 0}}},H.prototype.handleCrossDrag=function(i,H,R){if("exit"===H||"cancel"===H)return this._crossDragInfo=null,void this.redraw();if("enter"===H||"over"===H)return this._crossDragInfo||(this._crossDragInfo={}),void this._dragging(i,this._crossDragInfo);if("drop"===H){if(this.explorer){var M=this._crossDragInfo.parent?this._crossDragInfo.parent.url:this.explorer.currentDir,I={url:M,event:i};this.editor.fireEvent("explorerCrossDrop",I),I.preventDefault||this._endCrossDrag(i,R)}else this._endCrossDrag(i,R);return this._crossDragInfo=null,void this.redraw()}},H.prototype.isEditable=function(i){return this.editable},H.prototype.rename=function(i,H){i.setName(H)},H.prototype.handleDataDoubleSelect=function(i,H){if(this.isEditable(H)){var R=this.getLevel(H);R+=this.getIcon(H)?2:1,this.lp(i).x>R*this.getIndent()&&this.beginEditing(H)}},H.prototype.getEditingLabel=function(i){return this.getLabel(i)},H.prototype.beginEditing=function(i){var H=this;this.cancelEditing(),this.makeVisible(i),this.validate();var R=this.getLevel(i);R+=this.getIcon(i)?2:1;var M=this.getIndent()*R,I=this.ty()+this.getRowIndex(i)*this.getRowHeight(),p=Math.max(1,this.getWidth()-M),h=this.getRowHeight();this._currentEditor=new ht.widget.TextField,this._currentEditor.data=i;var z=this._currentEditor.getElement(),d=this.getEditingLabel(i);z.value=null==d?"":d,z.onblur=function(i){H.endEditing()},z.onkeydown=function(i){O(i)?H.endEditing():c(i)&&H.cancelEditing()},this.getView().appendChild(this._currentEditor.getView()),x(this._currentEditor,M,I,p,h),this._currentEditor.setFocus(),ht.Default.callLater(z.select,z)},H.prototype.endEditing=function(){var i=this._currentEditor;i&&(this.rename(i.data,i.getValue()),delete this._currentEditor,Y(i.getView()),this.redraw())},H.prototype.cancelEditing=function(){var i=this._currentEditor;i&&(delete this._currentEditor,Y(i.getView()),this.redraw())},H.prototype.addBlockItems=function(i){var H=this,R=function(){return H.sm().size()>0},M=function(){for(var i=H.sm(),R=i.getSelection(),M=0,I=i.size();M<I;M++){var p=R.get(M);if(p instanceof ht.Block&&!(p instanceof ht.RefGraph))return!0}return!1};i.push({separator:!0,visible:function(){return H.editable&&(R()||M())}}),i.push({id:"block",label:p("editor.block"),action:function(){H.editor.block()},visible:function(){return H.editable&&R()}}),i.push({id:"unblock",label:p("editor.unblock"),action:function(){H.editor.unblock()},visible:function(){return H.editable&&M()}})},H.prototype.addSelectDescendantItems=function(i){var H=this;i.push({id:"selectDescendant",label:p("editor.selectdescendant"),action:function(){var i=H.sm(),R=i.getSelection().toArray(),M=[];R.forEach(function(i){H.dm().eachByDepthFirst(function(i){R.indexOf(i)>=0||M.push(i)},i)}),i.as(M)},visible:function(){return!!H.sm().size()}})},H}(AR),iM=function(i){function H(R){var M=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];hR(this,H);var I=CR(this,i.call(this,R.editor,R.dataModel,M));return I.explorer=R,I.dragToIndexEnabled=!1,I.setSortFunc(KR.config.createFileTreeSortFunc(I)),I}return dR(H,i),H.prototype.onPropertyChanged=function(H){var R=this;if(i.prototype.onPropertyChanged.call(this,H),"filter"===H.property){var M=H.newValue;if(M){var I=this._fileVisibleMap={};this.dm().eachByDepthFirst(function(i){R.getLabel(i).indexOf(M)>=0&&(I[i.uuid]=!0);var H=i.getParent();H&&I[i.uuid]&&(I[H.uuid]=!0)}),this._cloneExpandMap||(this._cloneExpandMap=ht.Default.clone(this._expandMap)),this.expandAll()}else this._fileVisibleMap=void 0,this._cloneExpandMap&&(this._expandMap=this._cloneExpandMap),this._cloneExpandMap=void 0;this.ivm()}},H.prototype.isVisible=function(i){if(!1===i.a("visible"))return!1;if(this._visibleFunc&&!1===this._visibleFunc(i))return!1;var H=this._fileVisibleMap;return!(H&&!H[i.uuid])&&(i.fileType===XR||i.fileType===mR)},H.prototype.onDataDoubleClicked=function(i,H){this.setFilter(""),this.sm().ss(i),this.makeVisible(i)},H.prototype.getLabel=function(i){return p("url:"+i.url,!0)||this.getEditingLabel(i)},H.prototype.getEditingLabel=function(i){return i.getName()},H.prototype.handleBackgroundClick=function(i){},H.prototype.handleDelete=function(){this.editable&&KR.config.removeFileByKeyboardEnabled&&this.explorer.deleteSelection(this)},H.prototype.isDroppable=function(i,H){return!(!this.editable||H.view!==this.explorer.list)||H.view===this.editor.dndFromOutside},H.prototype._endCrossDrag=function(i,H){var R=this;if(this._crossDragInfo){var M=H.view,I=this._crossDragInfo.parent;if(I||(I=this.explorer.rootNode),M===this.explorer.list){var h=M.draggingData,z=function(){M.isSelected(h)?M.sm().toSelection().each(function(i){R.editor.moveFile(i,I)}):R.editor.moveFile(h,I)};KR.config.promptForMovingFile?HH(p("editor.move"),p("editor.confirmmovefile"),z,function(){}):z()}else M===this.editor.dndFromOutside&&this.editor.dropLocalFileOnDir(i,I)}},H.prototype._endDrag=function(i,H){var R=this,M=H.parent;M||(M=this.explorer.rootNode);var I=this.draggingData,h=function(){if(R.isSelected(I)){R.getTopRowOrderSelection().each(function(i){R.editor.moveFile(i,M)})}else R.editor.moveFile(I,M),R.sm().ss(I);M&&R.expand(M)};KR.config.promptForMovingFile?HH(p("editor.move"),p("editor.confirmmovefile"),h,function(){}):h()},H.prototype.isEditable=function(i){return this.editable&&i&&!1!==i.a("editable")},H.prototype.beginEditing=function(H){var R={data:H,url:H.url};this.editor.fireEvent("fileRenaming",R),R.preventDefault||i.prototype.beginEditing.call(this,H)},H.prototype.rename=function(i,H){this.editor.renameFile(i,H,function(){i.s("label")?i.s("label",H):i.setName(H)})},H.prototype.getIcon=function(i){return void 0!==i.getIcon()?i.getIcon():i.fileType===XR?this.hasExpandedChild(i)?"editor.direxpanded":"editor.dircollapsed":i.fileType===mR?"editor.root.state":null},H}(uR);ii(iM,{ms_ac:["filter"]});var HM=function(i){function H(R){return hR(this,H),CR(this,i.call(this,R))}return dR(H,i),H.prototype.isVScrollable=function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},H.prototype.isV=function(i){var H=this.gv.getViewRect();return this.isVScrollable()&&(H.x+H.width-this.gv.lp(i).x)*this.gv.getZoom()<ht.Default.scrollBarInteractiveSize},H.prototype.clear=function(i){i&&this._dragging&&!this._dragCancel&&this.gv.handleDragAndDrop(i,"end"),this.gv.draggingData&&(this.gv.draggingData.iv(),this.gv.draggingData=null,this.gv.redraw()),this._dragging=this._dragCancel=this._clientPoint=null},H.prototype.handle_mousedown=function(i){this.handle_touchstart(i)},H.prototype.handle_touchstart=function(i){if(!this.isV(i)&&!ui(i.target)){Ri(i),this.clear(i),this._clientPoint=f(i);var H=this.gv.getDataAt(i);T(i)?H?(this.gv.draggingData=H,H.iv(),this.gv.redraw(),this.gv.handleDragAndDrop(i,"prepare"),D(this,i)):this.gv.sm().cs():(H?this.handleSelection(i,H):this._cancelDataDoubleSelect(),this.clear(i))}},H.prototype.handle_mouseup=function(i){this.handle_touchend(i)},H.prototype.handle_touchend=function(i){if(this._clientPoint&&!this._dragging){var H=this.gv.getDataAt(i);H?this.handleSelection(i,H):this._cancelDataDoubleSelect()}this.gv._justDoubleClickData=!1,this.gv._levelChanged=!1,this.clear(i)},H.prototype.handleWindowMouseMove=function(i){this.handleWindowTouchMove(i)},H.prototype.handleWindowMouseUp=function(i){this.handleWindowTouchEnd(i)},H.prototype.handleWindowTouchMove=function(i){Ri(i),this._dragging?this._dragCancel||this.gv.handleDragAndDrop(i,"between"):this._clientPoint&&this.gv.draggingData&&P(f(i),this._clientPoint)>2&&(this._dragging=!0,this.gv.handleDragAndDrop(i,"begin"))},H.prototype.handleWindowTouchEnd=function(i){Ri(i),this.clear(i)},H.prototype.handleSelection=function(i,H){var R=this.gv.sm();if(s(i))this.gv.isSelected(H)?R.removeSelection(H):R.appendSelection(H);else if(e(i)){var M=R.ld();if(M)for(var I=this.gv.nodes,p=I.indexOf(M),h=I.indexOf(H);p!==h;)p+=h>p?1:-1,R.as(I[p]);else R.ss(H)}else T(i)?R.contains(H)?(this._handleDataDoubleSelect(i,H),N(i)&&this._cancelDataDoubleSelect()):(this._cancelDataDoubleSelect(),!0!==this.gv._levelChanged&&R.ss(H)):R.contains(H)||R.ss(H)},H.prototype.handle_keydown=function(i){if(!ui(i.target))if(c(i))this._dragging&&!this._dragCancel&&(this.gv.handleDragAndDrop(i,"cancel"),this._dragCancel=!0);else if(X(i)||J(i)||m(i)||o(i)){var H=this.gv.sm(),R=this.gv.nodes,M=H.ld();if(R.length){var I=void 0;if(M){var p=R.indexOf(M);X(i)||m(i)?0!==p&&(I=R[p-1]):p!==R.length-1&&(I=R[p+1])}else I=R[0];I&&(e(i)?H.as(I):H.ss(I))}}},H.prototype._handleDataDoubleSelect=function(i,H){var R=this;this._cancelDataDoubleSelect(),this._doubleSelectTimer=setTimeout(function(){R.gv.handleDataDoubleSelect(i,H),R._doubleSelectTimer=void 0},ht.Default.doubleClickSpeed)},H.prototype._cancelDataDoubleSelect=function(){this._doubleSelectTimer&&(clearTimeout(this._doubleSelectTimer),this._doubleSelectTimer)},H}(ht.graph.Interactor),RM=function(i){function H(R){hR(this,H);var M=CR(this,i.call(this,R.editor,R.dm));return M.displayView=R,M.graphView=R.graphView,M.nodeIcon=gi(M),M.initMenu(),M.initStudio&&M.initStudio(),R.dm.addDataPropertyChangeListener(function(i){var H=i.data;(H instanceof ht.Shape||H instanceof ht.Edge)&&(H.editorIcon=null)}),KR.SceneView&&M.enableToolTip(),M}return dR(H,i),H.prototype.getToolTip=function(i){return KR.config.getToolTip(i,this)},H.prototype.getBorderColor=function(i){return null},H.prototype.onDataDoubleClicked=function(i,H){this.editor.fitSelection()},H.prototype.onPropertyChanged=function(H){"filter"===H.property&&(this.visibleMap=null,this.ivm()),i.prototype.onPropertyChanged.call(this,H)},H.prototype.handleDataPropertyChange=function(H){!this._filter||"name"!==H.property&&"displayName"!==H.property?i.prototype.handleDataPropertyChange.call(this,H):(this.visibleMap=null,this.ivm())},H.prototype.checkVisible=function(i){if(!this._filter)return!0;if(KR.config.displayTreeVisibleFunc)return KR.config.displayTreeVisibleFunc(i,this._filter);var H=this.getLabel(i),R=(this._filter+"").toLowerCase();return null!=H&&(H=(H+"").toLowerCase(),H.indexOf(R)>=0)},H.prototype.validateModel=function(){var H=this;this._filter&&!this.visibleMap&&(this.visibleMap={},this.getDataModel().each(function(i){if(H.checkVisible(i)){H.visibleMap[i._id]=!0;for(var R=i.getParent();R&&!H.visibleMap[R._id];)H.visibleMap[R._id]=!0,R=R.getParent()}})),i.prototype.validateModel.call(this),KR.config.filterDisplayViewEnabled&&this.graphView.setVisibleFunc(function(i){return H.isVisible(i,!0)})},H.prototype.isVisible=function(i,H){if(!H&&i._refGraph)return!1;var R=this.getVisibleFunc();return!(R&&!R(i))&&(!this._filter||this.visibleMap&&this.visibleMap[i._id])},H.prototype.validate=function(){this.graphView.validate(),i.prototype.validate.call(this)},H.prototype.getLabel=function(i){return null==i.toLabel()&&i.s("editor.folder")?p("ht.Folder"):i.toLabel()||i.s("label")||p(i.getClassName())},H.prototype.getIcon=function(i){return i instanceof ht.SubGraph?"editor.subgraph":i instanceof ht.Group?"editor.group":i instanceof ht.RefGraph||i instanceof ht.Text?i.getIcon():i instanceof ht.Block?"editor.block":i instanceof ht.Shape?(i.editorIcon||(i.editorIcon=Li(i)),i.editorIcon):i instanceof ht.Edge?(i.editorIcon||(i.editorIcon=Si(this,i)),i.editorIcon):i instanceof ht.Node?this.nodeIcon:i.s("editor.folder")?this.hasExpandedChild(i)?"editor.direxpanded":"editor.dircollapsed":null},
H.prototype.isDroppable=function(i,H){return!!this.editor.editable&&(H.view===this.editor.symbols.getFileListView()||(H.view===this.editor.assets.getFileListView()||H.view===this.editor.displays.getFileListView()))},H.prototype._endCrossDrag=function(i,H){var R=this;if(this.editor.editable&&this._crossDragInfo){this.editor.beginTransaction();var M=[],I=H.view,p=this._crossDragInfo.type,h=this._crossDragInfo.parent,z=this._crossDragInfo.refData;I!==this.editor.symbols.getFileListView()&&I!==this.editor.assets.getFileListView()||I.toDraggingDatas("down"===p).forEach(function(i){var H=new ht.Node;H.setImage(i.getFileUUID()),H.setDisplayName(B(i.getName())),M.push(H),R.displayView.addData(H,!0),R.editor.gv.$63$([H]),R._dropData(H,p,h,z)}),I===this.editor.displays.getFileListView()&&I.toDraggingDatas("down"===p).forEach(function(i){if(i.url!==R.editor.url){var H=new ht.RefGraph;H.setRef(i.getFileUUID()),H.setDisplayName(B(i.getName())),M.push(H),R.displayView.addData(H,!0),R._dropData(H,p,h,z)}}),M.length&&this.sm().ss(M),this.editor.endTransaction()}},H.prototype._endDrag=function(i,H){var R=this;if(this.editor.editable){this.editor.beginTransaction();var M=H.type,I=H.parent,p=H.refData;if(this.isSelected(this.draggingData)){var h=this.getTopRowOrderSelection();"down"===M&&h.reverse(),h.each(function(i){R._dropData(i,M,I,p)})}else this._dropData(this.draggingData,M,I,p),this.sm().ss(this.draggingData);I&&this.expand(I),this.editor.endTransaction()}},H.prototype._dropData=function(i,H,R,M){if(this.editor.editable)if(i.setParent(R),"down"===H||"up"===H){var I=R?R.getChildren():this.dm().getRoots(),p=I.indexOf(M);"down"===H&&p++,I.indexOf(i)<p&&p--,this.dm().moveTo(i,p)}else R||this.dm().moveToBottom(i)},H.prototype.rename=function(i,H){i.setDisplayName(H)},H.prototype.initMenu=function(){this.menu=new YR;var i=[];this.initMenuItems(i),this.menu.setItems(i),this.menu.addTo(this.getView()),this.editor.menus.push(this.menu)},H.prototype.onClosed=function(){C(this.editor.menus,this.menu)},H.prototype.initMenuItems=function(i){var H=this,R=function(){for(var i=H.editor.selection,R=0;R<i.length;R++)if(i[R].s("editor.folder"))return!0;return!1};i.push.apply(i,[{id:"folder",label:p("editor.folder"),action:function(){H.editor.folder()},visible:function(){return H.editable&&!!H.editor.ld}},{id:"unfolder",label:p("editor.unfolder"),action:function(){H.editor.unfolder()},visible:function(){return H.editable&&R()}},{separator:!0,visible:function(){return H.editable&&!!H.editor.ld}},{id:"copy",label:p("editor.copy"),action:function(){H.editor.copy()},visible:function(){return H.editable&&!!H.editor.ld}},{id:"paste",label:p("editor.paste"),action:function(){H.editor.paste()},visible:function(){return H.editable&&H.editor.hasCopyInfo()}},{id:"delete",label:p("editor.delete"),action:function(){H.editor.delete()},visible:function(){return H.editable&&!!H.editor.ld}},{separator:!0,visible:function(){return H.editable&&!!H.editor.ld}},{id:"bringToFront",label:p("editor.bringtofront"),action:function(){H.editor.bringToFront()},visible:function(){return H.editable&&!!H.editor.ld}},{id:"bringForward",label:p("editor.bringforward"),action:function(){H.editor.bringForward()},visible:function(){return H.editable&&!!H.editor.ld}},{id:"sendBackward",label:p("editor.sendbackward"),action:function(){H.editor.sendBackward()},visible:function(){return H.editable&&!!H.editor.ld}},{id:"sendToBack",label:p("editor.sendtoback"),action:function(){H.editor.sendToBack()},visible:function(){return H.editable&&!!H.editor.ld}},{separator:!0,visible:function(){return H.editable&&!!H.editor.ld}},{id:"expandAll",label:p("editor.expandall"),action:function(){H.expandAll()}},{id:"collapseAll",label:p("editor.collapseall"),action:function(){H.collapseAll()}}]),this.addSelectDescendantItems(i),this.addBlockItems(i),this.editor.$103$(i)},zR(H,[{key:"editable",get:function(){return this.editor.editable},set:function(i){}}]),H}(uR);ii(RM,{ms_ac:["filter"]});var MM=function(i){function H(R){var M=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];hR(this,H);var I=CR(this,i.call(this,R.dataModel));return I.explorer=R,I.editable=M,I.editor=R.editor,I.getHScrollBar().style.display="none",I.setMaxFileSize(KR.config.imageSize),I.enableToolTip(),I.setPannable(!1),I.setInteractors([new ht.graph.ScrollBarInteractor(I),new HM(I),new ht.graph.DefaultInteractor(I),new ht.graph.TouchInteractor(I,{editable:!1})]),I.mi(function(i){var H=i.kind;"beginScroll"===H?I.disableToolTip():"endScroll"===H&&I.enableToolTip()}),I}return dR(H,i),H.prototype.getToolTip=function(i){var H=this.getDataAt(i);return H?this._filter?H.url:this.getLabel(H):null},H.prototype.getLabel=function(i){return p("url:"+i.url,!0)||this.getEditingLabel(i)},H.prototype.isEditable=function(i){return this.editable&&i&&!1!==i.a("editable")},H.prototype.getEditingLabel=function(i){return i.s("label")||i.getName()},H.prototype.rename=function(i,H){this.editor.renameFile(i,H,function(){i.s("label")?i.s("label",H):i.setName(H)})},H.prototype.handleDelete=function(){this.editable&&KR.config.removeFileByKeyboardEnabled&&this.explorer.deleteSelection(this)},H.prototype.beginEditing=function(i){var H=this,R={data:i,url:i.url};if(this.editor.fireEvent("fileRenaming",R),!R.preventDefault){this.cancelEditing(),this.makeVisible(i),this.validate();var M=this.getDataUI(i),I=!1,p=void 0;if(this.explorer.isAccordionMode()&&i.fileType===XR?(p=i.getRect(),I=!0):M&&M.labelInfo&&(p=M.labelInfo.rect),p){var h=void 0,z=void 0,d=void 0,C=void 0;if(I)h=p.x,z=p.y,d=p.width,C=p.height;else if("list"===this._layoutType)h=this._rowHeight,z=i.p().y-this._rowHeight/2,d=this.getWidth()-h,C=this._rowHeight;else{var y=M.labelInfo.rect||i.getRect();h=i.p().x-i.getWidth()/2,z=y.y,d=i.getWidth(),C=y.height}z+=this.ty(),this._currentEditor=new ht.widget.TextField,this._currentEditor.data=i;var b=this._currentEditor.getElement(),U=this.getEditingLabel(i);i.fileType===oR&&(this._editingExtension=_(U),U=B(U)),b.value=null==U?"":U,b.onblur=function(i){H.endEditing()},b.onkeydown=function(i){O(i)?H.endEditing():c(i)&&H.cancelEditing()},this.getView().appendChild(this._currentEditor.getView()),x(this._currentEditor,h,z,d,C),this._currentEditor.setFocus(),ht.Default.callLater(b.select,b)}}},H.prototype.endEditing=function(){var i=this._currentEditor;i&&(this.rename(i.data,i.getValue()+(this._editingExtension||"")),delete this._currentEditor,delete this._editingExtension,Y(i.getView()),this.redraw())},H.prototype.cancelEditing=function(){var i=this._currentEditor;i&&(delete this._currentEditor,Y(i.getView()),this.redraw())},H.prototype._clearDragInfo=function(){this.editor.dnd.hideTip(),this._dragInfo&&(this._dragInfo=null,this.redraw())},H.prototype.handleDragAndDrop=function(i,H){if("prepare"===H)return void this._clearDragInfo();if("begin"===H){var R=this.draggingData;R.fileType===OR&&ht.ui&&ht.ui.DragHelper.doDrag(this,{"a:clazz":"ht.ui.UIGraphView","a:initProps":{disableInit:!0,url:R.uuid+".json"}},{width:10,height:0,comps:[]},0,0),R.fileType===JR?ht.ui&&ht.ui.DragHelper.doDrag(this,{"a:clazz":"ht.ui.UIVectorView","a:initProps":{url:R.uuid+".json"}},{width:10,height:0,comps:[]},0,0):R.fileType===TR?ht.ui&&ht.ui.DragHelper.doDrag(this,{"a:clazz":"ht.ui.UIGraph3dView","a:initProps":{disableInit:!0,url:R.uuid+".json"}},{width:10,height:0,comps:[]},0,0):R.fileType===NR&&ht.ui&&ht.ui.DragHelper.doDrag(this,{"a:clazz":"ht.ui.RefViewGroup","a:initProps":{url:R.uuid+".json"}},{width:10,height:0,comps:[]},0,0),this._dragInfo={tip:this.$1$(),view:this}}var M=this._dragInfo;if(M){var I=this.editor.dnd;if("begin"===H||"between"===H){return this.getView().contains(n(i))?(M.inView=!0,this._dragging(i,M),I.clearDropView(i,M)):(M.inView&&this.redraw(),M.inView=!1,I.crossDrag(i,M)),void I.showTip(M.tip,i)}return"end"===H?(M.inView?this._endDrag(i,M):I.crossDrop(i,M),void this._clearDragInfo()):"cancel"===H?(M.inView||I.crossCancel(i,M),void this._clearDragInfo()):void 0}},H.prototype._dragging=function(i,H){if(this.editable){var R=this.getDataAt(i);R&&R.fileType===XR?H.targetData=R:H.targetData=null,this.autoScroll(i),this.redraw()}},H.prototype.$1$=function(){var i="";if(this.draggingData&&(i=this.getLabel(this.draggingData),this.isSelected(this.draggingData))){var H=this.sm().size();i+=H>1?" (+"+H+") ":""}return i},H.prototype._endDrag=function(i,H){},H.prototype.handleSelectionChange=function(H){i.prototype.handleSelectionChange.call(this,H),this.redraw()},H.prototype.handleCrossDrag=function(i,H,R){if(this.editable){if("exit"===H||"cancel"===H)return this._crossDragInfo=null,void this.redraw();if("enter"===H||"over"===H)return this._crossDragInfo||(this._crossDragInfo={}),void this._dragging(i,this._crossDragInfo);if("drop"===H){var M=this._crossDragInfo.targetData?this._crossDragInfo.targetData.url:this.explorer.currentDir,I={url:M,event:i};return this.editor.fireEvent("explorerCrossDrop",I),I.preventDefault||this._endCrossDrag(i,R),this._crossDragInfo=null,void this.redraw()}}},H.prototype._endCrossDrag=function(i,H){if(this.editable&&this._crossDragInfo){var R=this._crossDragInfo.targetData;if(R&&R.fileType===XR||(R=this.dm().sm().ld()),R){var M=H.view;"displays"===this.explorer.rootDir&&M instanceof RM&&this.handleDisplayTreeDrop(M,R),M===this.editor.dndFromOutside&&this.editor.dropLocalFileOnDir(i,R)}}},H.prototype.validateImpl=function(){document.body.contains(this.getView())&&i.prototype.validateImpl.call(this)},H}(rR);ii(MM,{ms_ac:["layoutType","fileSize","fileGap","rowHeight","maxFileSize","filter"],_fileRect:{x:0,y:0,width:0,height:0},_layoutType:"tile",_fileSize:50,_fileGap:6,_rowHeight:21,_maxFileSize:200});var IM={filter:!0,layoutType:!0,fileSize:!0,fileGap:!0,rowHeight:!0,visibleFunc:!0},pM=function(i){function H(R){var M=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];hR(this,H);var I=CR(this,i.call(this,R,M));return I.nodes=[],I.doLayoutBind=I.doLayout.bind(I),I.dm().sm().ms(function(i){I.sm().cs(),I.doLayoutLater()}),I.dm().mm(function(){I.doLayoutLater()}),I.addInteractorListener(I.handleInteraction.bind(I)),I.addBottomPainter(I.paintBottom.bind(I)),I.addTopPainter(I.paintTop.bind(I)),I.getCoreInteractor().disabled=!0,I}return dR(H,i),H.prototype.getDataAt=function(H){if("list"===this._layoutType){var R=Math.floor(this.lp(H).y/this._rowHeight);return this.nodes[R]}return i.prototype.getDataAt.call(this,H)},H.prototype.paintBottom=function(i){var H=this,R=this._rowHeight,M=this.getWidth();this.nodes.forEach(function(I){if(H.isSelected(I))if("list"===H._layoutType)i.beginPath(),i.rect(0,I.p().y-R/2,M,R),i.fillStyle=KR.config.color_select,i.fill();else{var p=I.getRect();L(i,KR.config.color_select,p.x-2,p.y-2,p.width+4,p.height+4,1)}})},H.prototype.paintTop=function(i){KR.config.drawDNDState?i.drawDNDState=!0:(KR.config.texureImage3D&&(i.texureImage3D=!0),i.texureImage2D=!0);var H=void 0;if(this._dragInfo&&this._dragInfo.inView?H=this._dragInfo:this._crossDragInfo&&(H=this._crossDragInfo),H){var R=KR.config.color_select_dark,M=H.targetData;if(M)if("list"===this._layoutType){var I=M.p().y-this._rowHeight/2,p=this.getWidth(),h=this._rowHeight;L(i,R,0,I,p,h,2)}else{var z=M.getRect();i.beginPath(),i.rect(z.x,z.y,z.width,z.height),i.lineWidth=2,i.strokeStyle=KR.config.color_select_dark,i.stroke()}else{var d=this.getViewRect();L(i,R,d.x,d.y,d.width,d.height,2)}}},H.prototype.toDraggingDatas=function(i){var H=[];return this.isSelected(this.draggingData)?(this.sm().toSelection().each(function(i){i.fileType!==XR&&H.push(i)}),i&&H.reverse()):this.draggingData.fileType!==XR&&H.push(this.draggingData),H},H.prototype.isDroppable=function(i,H){return"displays"===this.explorer.rootDir&&H.view instanceof RM||H.view===this.editor.dndFromOutside},H.prototype._endDrag=function(i,H){var R=this,M=H.targetData;if(M){var I=this.draggingData,h=function(){R.isSelected(I)?R.sm().toSelection().each(function(i){R.editor.moveFile(i,M)}):R.editor.moveFile(I,M)};KR.config.promptForMovingFile?HH(p("editor.move"),p("editor.confirmmovefile"),h,function(){}):h()}},H.prototype.handleDisplayTreeDrop=function(i,H){var R=this,M=void 0;M=i.isSelected(i.draggingData)?i.getTopRowOrderSelection().toArray():[i.draggingData];var I={};M.forEach(function(i){Hi(i,I)});var h=new ht.JSONSerializer(i.getDataModel(),!0);h.isSerializable=function(i){return I[i._id]};var z=h.serialize();iH(p("editor.inputnewdisplayname")+" ["+H.url+"]",i.getLabel(i.draggingData),{nullable:!1,trim:!0,maxLength:KR.config.maxFileNameLength,checkFunc:KR.config.checkFileName,$38$:this.editor.$38$},function(i,M){if("ok"===M){bi(i)||(i+=".json");var p=H.url+"/"+i,h={path:p,content:z,parent_uuid:H.uuid,root_dir:H.rootDir};R.editor.request("upload",h,function(i){if(!0===i){var M=R.editor.gv,h=M.isVisible;M.isVisible=function(i){return h.call(M,i)&&I[i._id]},R.editor.saveImage(M,p.substr(0,p.length-5)+".png",void 0,i.uuid,i.parent_uuid,H.rootDir),M.isVisible=h,M.redraw()}R.editor.fireEvent("displayViewSaved",{url:p})})}})},H.prototype.handleDataDoubleSelect=function(i,H){if(this.isEditable(H)){var R=this.lp(i);if("list"===this._layoutType)R.x>this._rowHeight&&this.beginEditing(H);else{var M=this.getDataUI(H);M&&M.labelInfo&&M.labelInfo.rect&&ht.Default.containsPoint(M.labelInfo.rect,R)&&this.beginEditing(H)}}},H.prototype.getLabelColor=function(i){return i!==this.draggingData||this.isSelected(i)?"list"===this._layoutType?this.isSelected(i)?KR.config.color_light:ht.Default.labelColor:this.isSelected(i)?KR.config.color_select:ht.Default.labelColor:KR.config.color_select},H.prototype.handleInteraction=function(i){var H=i.kind,R=i.data,M=i.event;if("doubleClickData"===H)1===this.sm().size()&&(this._justDoubleClickData=!0,R.fileType===XR?(this.dm().sm().ss(R),this._levelChanged=!0):this.editor.open(R,e(M),!0));else if("doubleClickBackground"===i.kind&&!this._filter){var I=this.dm().sm().ld();if(I&&I.getParent()){var p={target:this.explorer};if(this.editor.fireEvent("doubleClickBackgroundToUpLevel",p),p.preventDefault)return;this._upLevel=!0,this.dm().sm().ss(I.getParent()),this._levelChanged=!0}}},H.prototype.handleScroll=function(i,H){Ri(i),e(i)?H>0?this.setFileSize(Math.min(this.getFileSize()+2,this.getMaxFileSize())):this.setFileSize(Math.max(this.getFileSize()-2,1)):(nR||i.wheelDelta!==i.wheelDeltaX)&&(H=nR&&i.detail?-i.detail:i.wheelDelta/40,this.translate(0,20*H))},H.prototype.handlePinch=function(i,H,R){R<H?this.setFileSize(Math.min(this.getFileSize()+2,this.getMaxFileSize())):this.setFileSize(Math.max(this.getFileSize()-2,1))},H.prototype.onPropertyChanged=function(i){MM.prototype.onPropertyChanged.apply(this,arguments),IM[i.property]&&this.doLayoutLater()},H.prototype.isVisible=function(i){if(this._layouting){if(!1===i.a("visible"))return!1;if(this._visibleFunc&&!1===this._visibleFunc(i))return!1;var H=this._filter;if(H){var R=this.dm().sm().ld();if(!i.isDescendantOf(R))return!1;if(KR.config.vision&&i.uuid===E(H))return!0;var M=this.getLabel(i);if(!M||M.indexOf(H)<0||i.fileType===XR||i.fileType===mR)return!1}else{var I=this.dm().sm().ld();if(!I||i.getParent()!==I)return!1}if(!(i.fileType!==QR))return!1}else{if(this.nodes.indexOf(i)<0)return!1;if(!this.isNodeInRect(i))return!1}return!0},H.prototype.isNodeInRect=function(i){var H=ht.Default.clone(this.getViewRect());return ht.Default.grow(H,this.getFileSize()),!(!ht.Default.containsPoint(H,i.p())&&!ht.Default.intersectsRect(H,i.getRect()))},H.prototype.isMovable=function(){return!1},H.prototype.onValidated=function(){this._lastWidth===this.getWidth()&&this._lastHeight===this.getHeight()||this.doLayoutLater()},H.prototype.adjustTranslateX=function(){return 0},H.prototype.adjustTranslateY=function(i){var H=this.getHeight()-this._fileRect.height;return i<H&&(i=H),i>0?0:Math.round(i)},H.prototype.getContentRect=function(){return this._fileRect},H.prototype.doLayoutLater=function(){this._doLayoutLater||(this._doLayoutLater=!0,requestAnimationFrame(this.doLayoutBind))},H.prototype.doLayout=function(){var i=this;this._layouting=!0,this._doLayoutLater=!1,this.redraw();var H=this.nodes=[];this.dm().getDatas().each(function(R){i.isVisible(R)&&H.push(R)});var R=this._lastWidth=this.getWidth();this._lastHeight=this.getHeight();var M=this._fileGap;if("list"===this._layoutType){for(var I=this._rowHeight,p=Math.max(I-4,2),h=0;h<H.length;h++)this.updateFileNodeProperties(H[h],M+p/2,I*h+2+p/2,p);this._fileRect={x:0,y:0,width:R,height:I*H.length}}else{for(var z=this._fileSize,d=z+M,C=z+M+16,y=M,b=M,U=0,K=0;K<H.length;K++)this.updateFileNodeProperties(H[K],y+z/2,b+z/2,z),(U+2)*d+M>R?(y=M,K!==H.length-1&&(b+=C),U=0):(y+=d,U++);this._fileRect={x:0,y:0,width:R,height:b+C}}this.tx(this.tx()),this.ty(this.ty()),this.showScrollBar(),this._layouting=!1},H.prototype.updateFileNodeProperties=function(i,H,R,M){"list"===this._layoutType?(i.setPosition(H,R),i.setSize(M,M),i.s({"label.position":20,"label.offset.x":3,"label.offset.y":0,"label.max":void 0})):(i.setPosition(H,R),i.setSize(M,M),i.s({"label.position":31,"label.offset.x":0,"label.offset.y":2,"label.max":M}))},H}(MM),hM=function(i){function H(R,M,I,p){hR(this,H);var h=CR(this,i.call(this));h.setSize(20,20),h.setAnchor(.5,.5),h._id=h.url=M?M+"/"+I:I,h.path=M,h.value=p,h.rootDir=R,h.uuid=Ni(p)&&ti(p.fileType)&&null!=p.uuid?p.uuid:h.url,h.postfix=p?p.postfix:"";var z=QR,d=void 0,C=void 0,y=p&&p.uuid&&h.postfix?h.uuid+"."+h.postfix:h.url,b=I;return p&&p.attrs&&p.attrs.label&&(h.label=b=p.attrs.label),h.s({"select.width":0,pixelPerfect:!1,"image.stretch":"centerUniform","label.position":17}),""===M?(z=mR,C="editor.root.state"):"assets"===R&&(C=h.getFileImage(I))?(z=oR,h.s("label",b)):bi(I)&&"displays"===R?(z=OR,C=ci(y),h.s("label",B(I))):bi(I)&&"symbols"===R?(z=JR,C=ci(y),h.s("label",B(I))):bi(I)&&"components"===R?(z=cR,C=ci(y),h.s("label",B(I))):bi(I)&&"scenes"===R?(z=TR,C=ci(y),h.s("label",B(I))):bi(I)&&"models"===R?(z=tR,C=ci(y),h.s("label",B(I))):bi(I)&&"uis"===R?(z=NR,C=ci(y),h.s("label",B(I))):h.s("label",b),Ni(p)&&(ti(p.fileType)?(z=p.fileType,d=p.fileIcon,C=p.fileImage||C||d,C||p.fileType!==XR||(C="editor.dir"),h.a(p.attrs),h.s(p.styles)):(!0===p.dir||null==p.dir&&null==p.fileType)&&(z=XR,C="editor.dir")),C||(C="editor.unknown"),h.fileType=z,h.setIcon(d),h.setImage(C),h.setName(I),h}return dR(H,i),H.prototype.getFileUUID=function(){return this.postfix?this.uuid+"."+this.postfix:this.uuid},H.prototype.getFileImage=function(i){return yi(i)?this.url:Qi(i)?"editor.dxf.state":mi(i)?"editor.obj.state":Xi(i)?"editor.mtl.state":oi(i)?"editor.ttf.state":Ji(i)?"editor.otf.state":Ui(i)?"editor.sound.state":Ki(i)?"editor.video.state":Oi(i)?"editor.js.state":void 0},H.prototype.setAnchor=function(){for(var H,R=arguments.length,M=Array(R),I=0;I<R;I++)M[I]=arguments[I];var p=(H=i.prototype.setAnchor).call.apply(H,[this].concat(M));return p||(this._anchor=this._anchor),p},H}(ht.Node);ht.Default.setCompType("accordion-title-comp",function(i,H,R,M,I){var p=KR.config.drawAccordionTitle;if(p)return void p(i,H,M,I,{isHover:M.__hover,isExpanded:M.expanded,hoverColor:KR.config.color_hover,selectColor:KR.config.color_select});var h=M.__hover,z=H.x,d=H.y,C=H.width,y=H.height,b=I.getLabel(M),U=I.getFileGap();i.save(),(h||I.isSelected(M))&&(i.fillStyle=KR.config.color_hover,i.fillRect(z,d,C,y)),i.fillStyle=KR.config.color_select,i.fillRect(z+U,d+(y-8)/2,8,8),b&&ht.Default.drawText(i,b,"bold 14px Arial",ht.Default.labelColor,z+U+8+8,d,200,y,"left","middle"),i.restore()}),ht.Default.setImage("accordion-title",{width:160,height:24,fitSize:!0,pixelPerfect:!1,interactive:!0,boundExtend:2,onDown:function(i,H,R,M,I,p){ht.Default.isLeftButton(i)&&(R.getMutex()&&!H.expanded&&R.dirs.forEach(function(i){i!==H&&(i.expanded=!1)}),H.expanded=!H.expanded,R.ivm())},onEnter:function(i,H,R,M,I,p){H.__hover=!0,H.iv()},onLeave:function(i,H,R,M,I,p){H.__hover=!1,H.iv()},comps:[{type:"accordion-title-comp",displayName:"clock-pointer",rect:[0,0,160,24]}]});var zM={layoutType:!0,fileSize:!0,fileGap:!0,rowHeight:!0,filePadding:!0,titleHeight:!0},dM=function(i){function H(R){var M=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];hR(this,H);var I=CR(this,i.call(this,R,M));return I.setFileGap(10),I.setMutex(KR.config.accordionMutex),I.nodes=[],I.dirs=[],I.bottomRects=[],I.addViewListener(function(i){"beginValidate"===i.kind&&I.doLayout()}),I.setSelectionModelShared(!1),I.dm().sm().ms(function(){I.sm().cs()}),I._layouted=!1,I.mi(I.handleInteraction.bind(I)),I.addBottomPainter(I.paintBottom.bind(I)),I.addTopPainter(I.paintTop.bind(I)),I}return dR(H,i),H.prototype.paintBottom=function(i){var H=this,R=this._rowHeight,M=this.getWidth();this.nodes.forEach(function(I){if("list"===H._layoutType)H.isSelected(I)&&(i.beginPath(),i.rect(0,I.p().y-R/2,M,R),i.fillStyle=KR.config.color_select,i.fill());else{var p=H.isSelected(I)?KR.config.color_select:KR.config.color_mask,h=I.getRect(),z=h.x,d=h.y,C=h.width,y=h.height,b=H._filePadding;L(i,p,z-b,d-b,C+2*b,y+2*b,1)}}),i.beginPath(),i.lineWidth=2,i.strokeStyle=KR.config.color_hover,this.bottomRects.forEach(function(H){var R=H.x,M=H.y,I=H.width,p=H.height;i.moveTo(R+10,M+p/2),i.lineTo(R+I-10,M+p/2)}),i.stroke()},H.prototype.isDroppable=function(i,H){return"displays"===this.explorer.rootDir&&H.view instanceof RM||H.view===this.editor.dndFromOutside},H.prototype.handleDragAndDrop=function(H,R){var M=this.draggingData;M&&M.fileType!==XR&&i.prototype.handleDragAndDrop.call(this,H,R)},H.prototype.isLabelVisible=function(i){return i.fileType!==XR},H.prototype.paintTop=function(i){KR.config.drawDNDState?i.drawDNDState=!0:(KR.config.texureImage3D&&(i.texureImage3D=!0),i.texureImage2D=!0);var H=void 0;if(this._dragInfo&&this._dragInfo.inView?H=this._dragInfo:this._crossDragInfo&&(H=this._crossDragInfo),H){var R=KR.config.color_select_dark,M=H.targetData;if(M){var I=M.getRect();i.beginPath(),i.rect(I.x,I.y,I.width,I.height),i.lineWidth=2,i.strokeStyle=KR.config.color_select_dark,i.stroke()}else{var p=this.getViewRect();L(i,R,0,0,p.width,p.height,2)}}},H.prototype.getDataAt=function(H){if("list"!==this._layoutType)return i.prototype.getDataAt.call(this,H);var R=i.prototype.getDataAt.call(this,H);if(R)return R;for(var M=this.lp(H).y,I=0;I<this.nodes.length;I++){var p=this.nodes[I],h=p.getY(),z=this._rowHeight,d=h-z/2,C=h+z/2;if(M>=d&&M<C)return p}},H.prototype.handleInteraction=function(i){var H=i.kind,R=i.data,M=i.event;"doubleClickData"===H&&1===this.sm().size()&&R.fileType!==XR&&(this.setFilter(""),R.getParent().expanded=!0,this.sm().ss(R),this.ivm(),this.editor.open(R,e(M),!0))},H.prototype.handleDataDoubleSelect=function(i,H){if(this.isEditable(H)){var R=this.lp(i);if(H.fileType!==XR)if("list"===this._layoutType)R.x>this._rowHeight&&this.beginEditing(H);else{var M=this.getDataUI(H);M&&M.labelInfo&&M.labelInfo.rect&&ht.Default.containsPoint(M.labelInfo.rect,R)&&this.beginEditing(H)}}},H.prototype.getLabelColor=function(i){return i!==this.draggingData||this.isSelected(i)?"list"===this._layoutType?this.isSelected(i)?KR.config.color_light:ht.Default.labelColor:this.isSelected(i)?KR.config.color_select:ht.Default.labelColor:KR.config.color_select},H.prototype.isVisible=function(i){if(!this._layouted)return!1;if(this._visibleFunc&&!1===this._visibleFunc(i))return!1;var H=this.explorer.rootDir,R=i.getParent();if(!1===i.a("visible"))return!1;if(i.fileType===QR||!R)return!1;if(this._visibleFunc&&!this._visibleFunc(i))return!1;if(this._filter){var M=this.getLabel(i);if(R.url===H&&i.fileType===XR){for(var I=i.getChildren(),p=0;p<I.length;p++){var h=I.get(p);if(this.isVisible(h))return!0}return!1}if(R.getParent()&&R.getParent().url===H&&i.fileType!==XR)return!(!M||M.indexOf(this._filter)<0)}return R.url===H&&i.fileType===XR||!(!R.getParent()||R.getParent().url!==H||i.fileType===XR)&&!!R.expanded},H.prototype.adjustTranslateX=function(i){return 0},H.prototype.adjustTranslateY=function(i){if(!this.contentHeight)return 0;var H=this.getViewRect(),R=H.height-this.contentHeight;return i>=0||R>=0?0:i>R?i:R},H.prototype.getImage=function(i){if(i.getImage)return i.fileType===XR?"accordion-title":i.getImage()},H.prototype.doLayout=function(){var i=this;if(this._lastWidth!==this.getWidth()||this._lastHeight!==this.getHeight()||this._lastFileSize!==this.getFileSize()){this._doLayoutLater=!1,this.redraw();var H=this.dirs=[],R=this.nodes=[],M=this.bottomRects=[];this.dm().each(function(R){i.isVisible(R)&&R.fileType===XR&&H.push(R)});var I=this._lastWidth=this.getWidth(),p=this._titleHeight,h=0;this._lastHeight=this.getHeight(),this._lastFileSize=this._fileSize,this._expandIds&&(this.dirs.forEach(function(H){H.expanded=i._expandIds.indexOf(H.getId())>=0}),delete this._expandIds),H.forEach(function(H){H.setAnchor(0,0),H.p(0,h),H.setSize(I,p),H.s("label",null),h+=p;var z=[];H.getChildren().each(function(H){i.isVisible(H)&&(z.push(H),R.push(H))}),h=i.layoutChildren(z,h),H.expanded&&(M.push({x:0,y:h,width:I,height:16}),h+=16)}),this.contentHeight=h,this._layouted=!0}},H.prototype.layoutChildren=function(i,H){if(!i||0===i.length)return H;var R=this._fileGap;if("list"===this._layoutType){var M=this._rowHeight,I=Math.max(M-4,15);return i.forEach(function(i,p){i.setPosition(R+I/2+KR.config.accordionListIndent,H+2+I/2),i.setSize(I,I),i.s({"label.position":20,"label.offset.x":3,"label.offset.y":0,"label.max":void 0}),H+=M}),H}var p=this.getWidth(),h=this._fileSize,z=this._filePadding,d=h+2*z,C=R,y=H+R,b=0,U=h+R+2*z,K=h+R+16+2*z;return i.forEach(function(H,M){H.setPosition(C+d/2,y+d/2),H.setSize(h,h),H.s({"label.position":31,"label.offset.x":0,"label.offset.y":2+z,"label.max":d}),(b+2)*U+R>p?(C=R,M!==i.length-1&&(y+=K),b=0):(C+=U,b++)}),y+K},H.prototype.handleScroll=function(i){var H=nR&&i.detail?-i.detail:i.wheelDelta/10;(nR||i.wheelDelta!==i.wheelDeltaX)&&this.translate(0,H)},H.prototype.adjustZoom=function(){return 1},H.prototype.onPropertyChanged=function(H){i.prototype.onPropertyChanged.call(this,H);var R=H.property;"dataModel"!==R&&"fileSize"!==R||this.doLayout()},H.prototype._endDrag=function(i,H){var R=this,M=H.targetData;if(M&&M.fileType===XR){var I=this.draggingData,h=function(){R.isSelected(I)?R.sm().toSelection().each(function(i){R.editor.moveFile(i,M)}):R.editor.moveFile(I,M),R.doLayout(),R.redraw()};KR.config.promptForMovingFile?HH(p("editor.move"),p("editor.confirmmovefile"),h,function(){}):h()}},H.prototype.toDraggingDatas=function(i){var H=[];return this.isSelected(this.draggingData)?(this.sm().toSelection().each(function(i){i.fileType!==XR&&H.push(i)}),i&&H.reverse()):this.draggingData.fileType!==XR&&H.push(this.draggingData),H},H.prototype.invalidateModel=function(){this._lastWidth=null,this.iv()},H.prototype.ivm=function(){this.invalidateModel()},H.prototype.getContentRect=function(){return{x:0,y:0,width:this.getWidth(),height:this.contentHeight||0}},H.prototype.onPropertyChanged=function(H){i.prototype.onPropertyChanged.apply(this,arguments),zM[H.property]&&this.ivm()},zR(H,[{key:"expandIds",get:function(){var i=[];return this.dirs.forEach(function(H){H.expanded&&i.push(H.getId())}),i},set:function(i){this._expandIds=i,this._lastWidth=null}}]),H}(MM);ii(dM,{ms_ac:["filePadding","titleHeight","mutex"],_mutex:!1,_filePadding:6,_titleHeight:36});var CM=function(i){function H(R,M){var I=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];hR(this,H);var p=CR(this,i.call(this));return p.editor=R,p.rootDir=M,p.copyFileInfos=[],p.dataModel=new ht.DataModel,p.dataModel.setAutoAdjustIndex(!1),p.urlUUIDMap={},p.uuidURLMap={},p.$6$(I),p}return dR(H,i),H.prototype.$6$=function(i){var H=this,R=this.mode=KR.config.explorerMode;"accordion"===R&&(this.accordion=new dM(this,i)),this.tree=new iM(this,i),this.list=new pM(this,i),this.controlPane=new bR,this.controlPane.addRow([{id:"filter",textField:{}},{id:"url",textField:{editable:!1}},{id:"slider",slider:{min:1,max:this.getFileListView().getMaxFileSize(),step:1,onValueChanged:function(i,R){H.getFileListView().setFileSize(R),H.getFileListView().setLayoutType(R>16?"tile":"list")}}}],[.1,.2,ht.Default.isTouchable?70:50]);var M=this.controlPane.getViewById("filter").getElement(),I=!1,p=function(){if(!I){var i=M.value;if("accordion"===R?(H.accordion.setFilter(i),H.accordion.ivm()):(H.list.setFilter(i),H.tree.setFilter(i)),!i){var p=H.editor._currentTab;if(p){var h=H.editor.getFileNode(p.getTag());h&&h.rootDir===H.rootDir&&H.editor.selectFileNode(p.getTag())}}}};M.onkeyup=function(i){i.isComposing||(c(i)&&(M.value=""),p())},M.addEventListener("compositionstart",function(i){I=!0}),M.addEventListener("compositionend",function(i){I=!1,p()});var h=function(i){"filter"===i.property&&(M.value=i.newValue||"",p(),M.value||H.tree.makeVisible(H.tree.sm().ld()||H.rootNode))};("accordion"===R?this.accordion:this.list).mp(h),this.tree.mp(h);var z=this.controlPane.getItemById("slider").element;z.getToolTip=function(){},this.getFileListView().mp(function(i){"fileSize"===i.property&&z.setValue(i.newValue)}),this.bottomPane=new jR,this.bottomPane.setCenterView(this.getFileListView()),this.bottomPane.setBottomView(this.controlPane),this.bottomPane.setBottomHeight(ht.Default.widgetRowHeight+8),this.setOrientation("vertical"),"accordion"===R?(this.setLeftView(this.bottomPane),this.setPosition(1),this.accordion.sm().ms(function(){H.$51$(H.accordion)}),this.accordion.setFileSize(KR.config.fileSize),this.setDraggable(!1)):(this.setLeftView(this.tree),this.setRightView(this.bottomPane),this.setPosition(KR.config.explorerSplitViewPosition),this.list.setSelectionModelShared(!1),this.list.sm().ms(function(){H.$51$(H.list)}),this.list.setFileSize(KR.config.fileSize)),this.tree.menu=new YR,this.treeMenuItems=[],this.initTreeMenu(this.tree.menu,this.treeMenuItems),this.tree.menu.setItems(this.treeMenuItems),this.tree.menu.addTo(this.tree.getView()),this.editor.menus.push(this.tree.menu),this.list.menu=new YR,this.listMenuItems=[],this.initListMenu(this.list.menu,this.listMenuItems),this.list.menu.setItems(this.listMenuItems),this.list.menu.addTo(this.list.getView()),this.editor.menus.push(this.list.menu),this.isAccordionMode()&&(this.accordion.menu=new YR,this.accordionMenuItems=[],this.initAccordionMenu(this.accordion.menu,this.accordionMenuItems),this.accordion.menu.setItems(this.accordionMenuItems),this.accordion.menu.addTo(this.accordion.getView()),this.editor.menus.push(this.accordion.menu))},H.prototype.$51$=function(i){var H=i.sm().ld();this.controlPane.v("url",H?H.getFileUUID():"")},H.prototype.isAccordionMode=function(){return"accordion"===this.mode},H.prototype.findFileNode=function(i){var H=this.dataModel.getDataById(i);return!H&&this.uuidURLMap[i]&&(H=this.dataModel.getDataById(this.uuidURLMap[i])),H},H.prototype.parse=function(i){var H=this,R=void 0,M=void 0,I=void 0,p=void 0;if("accordion"===this.mode?(M=this.accordion.expandIds,R=this.accordion.ty()):(R=this.tree.ty(),M=this.tree.expandIds,I=this.tree.selectionIds,p=this.tree.dm().size()),this.dataModel.clear(),fi(i))i.forEach(function(i){if(i){var R=i.attrs&&i.attrs.path?i.attrs.path:"",M=H.rootNode=H.addFileNode(H.rootDir,R,i.name,i);H.parseRoot(M,i)}});else{var h=this.rootNode=this.addFileNode(this.rootDir,"",this.rootDir);this.parseRoot(h,i)}var z=this.dataModel.getDatas(),d={};this.urlUUIDMap={},this.uuidURLMap={},z.toArray().forEach(function(i,R){d[i._id]=R,H.uuidURLMap[i.getFileUUID()]=i.url,H.urlUUIDMap[i.url]=i.getFileUUID()}),z.sort(function(i,H){return i.fileType===mR?-1:H.fileType===mR?1:i.fileType===XR&&H.fileType!==XR?-1:i.fileType!==XR&&H.fileType===XR?1:d[i._id]-d[H._id]}),"accordion"===this.mode?(this.accordion.expandIds=M,this.accordion.ty(R)):(this.tree.expandIds=M,this.tree.selectionIds=I,this.tree.ty(R),0===p&&(this.tree.expand(this.rootNode),this.tree.sm().ss(this.rootNode))),this.list.doLayout();var C={explorer:this};this.editor.fireEvent("explorerUpdated",C)},H.prototype.parseRoot=function(i,H){i.a("editable",!1);var R=void 0;H.fileType===XR||H.fileType===mR?(i.a(H.attrs),i.s(H.styles),H.fileIcon&&(i.setIcon(H.fileIcon),i.setImage(H.fileIcon)),R=H.children):R=H;for(var M in R)this.parseChild(i,M,R[M])},H.prototype.parseChild=function(i,H,R){
var M=this.addFileNode(this.rootDir,i.url,H,R);M.setParent(i);var I=void 0;R&&R.fileType===XR?I=R.children:M.fileType===XR&&(I=R);for(var p in I)this.parseChild(M,p,I[p]);return M},H.prototype.deleteSelection=function(i){var H=this,R=[];if(i.sm().getTopSelection().forEach(function(i){var M={data:i,url:i.url};H.editor.fireEvent("fileDeleting",M),M.preventDefault||R.push(i)}),R.length){var M=i.getLabel(R[0])||R[0].getName(),I=p("editor.delete")+" ["+M+"]";R.length>1&&(I+=" ("+R.length+")");var h=function(){H.editor.removeFiles(R)};KR.config.deleteFileConfirm?HH(I,p("editor.deleteselection"),h,function(){}):h()}},H.prototype.addNewItem=function(i,H,R,M){var I=this,h={id:R,label:p("editor."+R.toLowerCase()),action:function(){if(H instanceof pM){var i=I.tree.sm().ld();i&&i.fileType===XR&&(I.editor._rightClickURL=i.url)}I.editor[R](I.editor._rightClickURL),M&&I.editor.save(),delete I.editor._rightClickURL},visible:function(){var i=I.tree.sm().ld();if(!H.editable||KR.config.vision&&i&&2!==i.a("dir_type")&&!i.a("editable"))return!1;if(I.isAccordionMode()){var R=I.accordion.sm().ld();return R&&R.fileType===XR}return!0}};return i.push(h),h},H.prototype.addDeleteItem=function(i,H){var R=this,M={id:"delete",label:p("editor.delete"),action:function(){R.deleteSelection(H)},visible:function(){return!(!H.sm().ld()||!H.isEditable(H.sm().ld()))}};return i.push(M),M},H.prototype.addNewFolderItem=function(i,H){var R=this,M={id:"newFolder",label:p("editor.newfolder"),action:function(){R.editor.newFolder(H)},visible:function(){var i=R.tree.sm().ld();return H.editable&&(H.isEditable(i)||KR.config.vision&&i&&2===i.a("dir_type"))}};return i.push(M),M},H.prototype.addLocateTreeFileItem=function(i){var H=this,R=void 0;return KR.config.locateFileEnabled&&!KR.config.vision&&(R={id:"locateFile",label:p("editor.locatefile"),action:function(){var i=H.tree.sm().ld()||H.rootNode;H.editor.locate(i)}},i.push(R)),R},H.prototype.addLocateListFileItem=function(i){var H=this,R=void 0;return KR.config.locateFileEnabled&&!KR.config.vision&&(R={id:"locateFile",label:p("editor.locatefile"),action:function(){var i=H.ld||H.tree.sm().ld()||H.rootNode;H.editor.locate(i)},visible:function(){return!H.isAccordionMode()||!!H.getFileListView().sm().ld()}},i.push(R)),R},H.prototype.addExportItem=function(i){var H=this,R={id:"export",label:p("editor.export"),action:function(){var i=[],R=H.getFileListView().sm();R.size()>0&&(R.each(function(H){i.push(H.url)}),H.editor.request("export",i))},visible:function(){var i=H.getFileListView().sm().ld();if(!i)return!1;var R=i.fileType;return R===OR||R===JR||R===cR||R===TR||R===tR||R===NR||R===XR}};return i.push(R),R},H.prototype.addRenameItem=function(i,H){var R={id:"rename",label:p("editor.rename"),action:function(){var i=H.sm().ld();i&&!1!==i.a("editable")&&H.beginEditing(i)},visible:function(){var i=H.sm().ld();return!(!i||!H.isEditable(i))}};return i.push(R),R},H.prototype.addCopyItem=function(i){var H=this,R={id:"copy",label:p("editor.copy"),action:function(){H.copyFiles()},visible:function(){if(!H.getFileListView().editable)return!1;var i=H.getFileListView().sm().ld();return!(!i||!1===i.a("editable"))}};return i.push(R),R},H.prototype.addPasteItem=function(i){var H=this,R={id:"paste",label:p("editor.paste"),action:function(){H.pasteFiles()},visible:function(){if(!H.copyFileInfos.length)return!1;var i=H.tree.sm().ld();if(!i)return!1;if(KR.config.vision){if(!1===i.a("editable")&&2!==i.a("dir_type"))return!1}else if(i!==H.rootNode&&!1===i.a("editable"))return!1;return!!H.getFileListView().editable&&(!H.isAccordionMode()||!!H.ld)}};return i.push(R),R},H.prototype.copyFiles=function(){var i=this;this.copyFileInfos.length=0,this.getFileListView().sm().each(function(H){i.prepareCopyFileInfos(H)})},H.prototype.prepareCopyFileInfos=function(i,H){var R=this;if(i.fileType!==mR&&i.fileType!==QR){var M={url:i.url,name:i.getName(),fileNode:i,parentInfo:H,parent_uuid:i.parent_uuid};if(this.copyFileInfos.push(M),this.editor.fireEvent("copyFile",{url:i.url}),!KR.config.copyFileByServer&&i.fileType===XR)return M.isDir=!0,void i.eachChild(function(i){R.prepareCopyFileInfos(i,M)});this.loadFileInfo(M)}},H.prototype.loadFileInfo=function(i){var H=i.url,R=KR.config.copyFileByServer;if(R||this.editor.requestBase64(H,function(H){i.content=H}),bi(H)){var M=ci(H);this.findFileNode(M)&&(R?i.image=!0:this.editor.requestBase64(M,function(H){i.image=H}))}},H.prototype.pasteFiles=function(){var i=this;if(KR.config.copyFileByServer){var H=[],R=this.currentDir;this.copyFileInfos.forEach(function(i){H.push(i.url),i.image&&H.push(ci(i.url))}),this.editor.request("paste",{fileList:H,destDir:R})}else this.copyFileInfos.forEach(function(H){i.pasteFileImpl(H)})},H.prototype.pasteFileImpl=function(i){var H=i.url,R=i.parentInfo,M=void 0,I=2,p=R?R.pasteURL:this.currentDir;if(i.isDir){var h=p+"/"+i.name;for(M=h;this.findFileNode(M);)M=h+" "+I++}else if(i.content){var z=p+"/"+B(i.name),d=H.substring(H.lastIndexOf("."),H.length);for(M=z+d;this.findFileNode(M);)M=z+" "+I+++d}if(M){if(i.content){var C={path:M,content:i.content,parent_uuid:i.uuid,root_dir:i.rootDir};this.editor.request("upload",C),this.editor.fireEvent("pasteFile",{url:M}),i.image&&(C.path=ci(M),C.content=i.image,this.editor.request("upload",C),this.editor.fireEvent("pasteFile",{url:C.path}))}i.isDir&&(i.pasteURL=M,this.editor.request("mkdir",M,function(i){}))}},H.prototype.enableDroppableToSymbolView=function(){var i=this.list;"accordion"===this.mode&&(i=this.accordion),i.isDroppableToSymbolView=!0},H.prototype.enableDroppableToDisplayView=function(){var i=this.list;"accordion"===this.mode&&(i=this.accordion),i.isDroppableToDisplayView=!0},H.prototype.enableDroppableToSceneView=function(){var i=this.list;"accordion"===this.mode&&(i=this.accordion),i.isDroppableToSceneView=!0},H.prototype.enableDroppableToUIView=function(){var i=this.list;"accordion"===this.mode&&(i=this.accordion),i.isDroppableToUIView=!0},H.prototype.enableDroppableToUIImage=function(){var i=this.list;"accordion"===this.mode&&(i=this.accordion),i.isDroppableToUIImage=!0},H.prototype.enableDroppableToUIRenderer=function(){var i=this.list;"accordion"===this.mode&&(i=this.accordion),i.isDroppableToUIRenderer=!0},H.prototype.getFileListView=function(){return"accordion"===this.mode?this.accordion:this.list},H.prototype.getTreeMenuItemKeyList=function(){return[]},H.prototype.initTreeMenu=function(i,H){var R=this,M=this.tree;this.getTreeMenuItemKeyList().forEach(function(i){R.$67$(i,M,H)})},H.prototype.getListMenuItemKeyList=function(){return[]},H.prototype.initListMenu=function(i,H){var R=this,M=this.list;this.getListMenuItemKeyList().forEach(function(i){R.$67$(i,M,H)})},H.prototype.getAccordionMenuItemKeyList=function(){return this.getListMenuItemKeyList()},H.prototype.initAccordionMenu=function(i,H){var R=this,M=this.accordion;this.getAccordionMenuItemKeyList().forEach(function(i){R.$67$(i,M,H)})},H.prototype.addFileNode=function(i,H,R,M){var I=new hM(i,H,R,M);return this.dataModel.add(I),I},H.prototype.$67$=function(i,H,R){var M=void 0;switch(i){case"newComponent":case"newDisplayView":case"newSymbolView":M=this.addNewItem(R,H,i);break;case"delete":M=this.addDeleteItem(R,H);break;case"newFolder":M=this.addNewFolderItem(R,H);break;case"locateFile":M=H===this.tree?this.addLocateTreeFileItem(R):this.addLocateListFileItem(R);break;case"export":M=this.addExportItem(R);break;case"rename":M=this.addRenameItem(R,H);break;case"copy":M=this.addCopyItem(R);break;case"paste":M=this.addPasteItem(R);break;default:R.push(M=i)}return M},zR(H,[{key:"currentDir",get:function(){var i=void 0;return this.isAccordionMode()?(i=this.ld,i&&i.fileType!==XR&&(i=i.getParent()),i?i.url:this.accordion.dirs.length?this.accordion.dirs[this.accordion.dirs.length-1].url:this.rootDir):(i=this.tree.sm().ld(),i?i.url:this.rootDir)}},{key:"ld",get:function(){return this.getFileListView().sm().ld()}}]),H}(WR),yM=function(i){function H(R){var M=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];hR(this,H);var I=CR(this,i.call(this,R,"displays",M));return I.enableDroppableToDisplayView(),I.enableDroppableToUIView(),I}return dR(H,i),H.prototype.getTreeMenuItemKeyList=function(){return["locateFile","newFolder","newDisplayView","rename","delete"]},H.prototype.getListMenuItemKeyList=function(){return["locateFile","newFolder","newDisplayView","copy","paste","rename","delete","export"]},H.prototype.addNewFolderItem=function(H,R){var M=i.prototype.addNewFolderItem.call(this,H,R),I=this.tree;return M.visible=function(){return I.editable&&(I.isEditable(I.sm().ld())||KR.config.vision&&I.sm().ld()&&2===I.sm().ld().a("dir_type"))},M},H.prototype.addNewItem=function(H,R,M){var I=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return i.prototype.addNewItem.call(this,H,R,M,I)},H.prototype.$67$=function(H,R,M){return i.prototype.$67$.call(this,H,R,M)},H}(CM),bM=function(i){function H(R){var M=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];hR(this,H);var I=CR(this,i.call(this,R,"symbols",M));return I.enableDroppableToDisplayView(),I.enableDroppableToSymbolView(),I.enableDroppableToSceneView(),I.enableDroppableToUIImage(),I.enableDroppableToUIRenderer(),I}return dR(H,i),H.prototype.getTreeMenuItemKeyList=function(){return["locateFile","newFolder","newSymbolView","rename","delete"]},H.prototype.getListMenuItemKeyList=function(){return["locateFile","newFolder","newSymbolView","copy","paste","rename","delete","export"]},H.prototype.addNewItem=function(H,R,M){var I=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return i.prototype.addNewItem.call(this,H,R,M,I)},H.prototype.$67$=function(H,R,M){return i.prototype.$67$.call(this,H,R,M)},H}(CM),UM=function(i){function H(R){var M=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];hR(this,H);var I=CR(this,i.call(this,R,"components",M));return I.enableDroppableToSymbolView(),I}return dR(H,i),H.prototype.getTreeMenuItemKeyList=function(){return["locateFile","newFolder","newComponent","rename","delete"]},H.prototype.getListMenuItemKeyList=function(){return["locateFile","newFolder","newComponent","copy","paste","rename","delete","export"]},H.prototype.$67$=function(H,R,M){return i.prototype.$67$.call(this,H,R,M)},H}(CM),KM=function(i){function H(R){var M=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];hR(this,H);var I=CR(this,i.call(this,R,"scenes",M));return I.enableDroppableToDisplayView(),I.enableDroppableToSceneView(),I.enableDroppableToUIView(),I}return dR(H,i),H.prototype.addNewItem=function(H,R,M,I){return i.prototype.addNewItem.call(this,H,R,M,I)},H.prototype.$67$=function(H,R,M){return i.prototype.$67$.call(this,H,R,M)},H}(CM),qM=function(i){function H(R){var M=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];hR(this,H);var I=CR(this,i.call(this,R,"models",M));return I.enableDroppableToDisplayView(),I.enableDroppableToSceneView(),I}return dR(H,i),H.prototype.$67$=function(H,R,M){return i.prototype.$67$.call(this,H,R,M)},H}(CM),QM=function(i){function H(R){var M=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];hR(this,H);var I=CR(this,i.call(this,R,"uis",M));return I.enableDroppableToUIView(),I.enableDroppableToUIRenderer(),I}return dR(H,i),H.prototype.addNewItem=function(H,R,M,I){return i.prototype.addNewItem.call(this,H,R,M,I)},H.prototype.$67$=function(H,R,M){return i.prototype.$67$.call(this,H,R,M)},H}(CM),mM=function(i){function H(R){var M=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];hR(this,H);var I=CR(this,i.call(this,R,"assets",M));return I.enableDroppableToDisplayView(),I.enableDroppableToSymbolView(),I.enableDroppableToSceneView(),I.enableDroppableToUIImage(),I}return dR(H,i),H.prototype.getTreeMenuItemKeyList=function(){return["locateFile","newFolder","rename","delete"]},H.prototype.getListMenuItemKeyList=function(){return["locateFile","newFolder","copy","paste","rename","delete","convert"]},H.prototype.addExportItem=function(H){return i.prototype.addExportItem.call(this,H)},H.prototype.$53$=function(i){var H=this;i.push({id:"convertToDisplay",label:p("editor.converttodisplay"),action:function(){H.editor.open(H.getFileListView().sm().ld(),!1)},visible:function(){var i=H.getFileListView().sm().ld();return!!i&&(qi(i.url)||Qi(i.url))}}),i.push({id:"convertToSymbol",label:p("editor.converttosymbol"),action:function(){H.editor.open(H.getFileListView().sm().ld(),!0)},visible:function(){var i=H.getFileListView().sm().ld();return!!i&&(qi(i.url)||Qi(i.url)||oi(i.url)||Ji(i.url))}}),i.push({id:"batchConvertSVG",label:p("editor.batchconvertsvg"),action:function(){H.editor.batchConvertSVG(H.getFileListView().sm().getSelection().toArray())},visible:function(){var i=H.getFileListView().sm().ld();return!!i&&qi(i.url)}})},H.prototype.$67$=function(H,R,M){return"convert"===H?this.$53$(M):i.prototype.$67$.call(this,H,R,M)},H}(CM),XM=function(i){function H(R){hR(this,H);var M=CR(this,i.call(this));return M.editor=R,M}return dR(H,i),H.prototype.$5$=function(i){this.setGraphView(this.editor.gv)},H}(sR),oM=function(i){function H(R){hR(this,H);var M=CR(this,i.call(this));M.editView=R,M.editor=R.editor,M._topCanvas=l(),M._topDiv=V(),M._view.insertBefore(M._topCanvas,M._scrollBarDiv||null),M._view.insertBefore(M._topDiv,M._scrollBarDiv||null);var I=[];return M.menu=new YR(I),M.menu.beforeShow=function(i){M._rightClickPosition=M.lp(i)},M.initMenuItems(I),M.menu.addTo(M.getView()),M.editor.menus.push(M.menu),M.setResettable(!0),M.addTopPainter(function(i){KR.config.drawDNDState?i.drawDNDState=!0:(KR.config.texureImage3D&&(i.texureImage3D=!0),i.texureImage2D=!0);var H=M.getViewRect(),R=M.editView,I=R.hoverGuideLineX,p=R.hoverGuideLineY,h=ht.Default.brighter(M.dm().a("alignmentGuideColor"));ht.Default.isDragging()||!I&&!p||(i.beginPath(),i.strokeStyle=h,i.lineWidth=1/M.getZoom(),I&&(i.moveTo(I.x,H.y),i.lineTo(I.x,H.y+H.height)),p&&(i.moveTo(H.x,p.y),i.lineTo(H.x+H.width,p.y)),i.stroke())}),M}return dR(H,i),H.prototype.reset=function(){this.fitContent(KR.config.animate,KR.config.fitPadding)},H.prototype.isEditable=function(H){return!!this.editable&&i.prototype.isEditable.call(this,H)},H.prototype.isMovable=function(H){return!!this.editable&&i.prototype.isMovable.call(this,H)},H.prototype.invalidateAll=function(H,R){if("imageLoaded"===R||"modelLoaded"===R){var M=this.editor.inspector;M&&(M.$34$(),M.$85$&&M.$85$())}i.prototype.invalidateAll.call(this,H,R)},H.prototype.handleDelete=function(H){this.editable&&i.prototype.handleDelete.call(this,H)},H.prototype.onGroupDoubleClicked=function(H,R,M){this.editable&&i.prototype.onGroupDoubleClicked.call(this,H,R,M)},H.prototype.onEdgeDoubleClicked=function(H,R,M){this.editable&&i.prototype.onEdgeDoubleClicked.call(this,H,R,M)},H.prototype.checkDoubleClickOnNote=function(H,R){return!!this.editable&&i.prototype.checkDoubleClickOnNote.call(this,H,R)},H.prototype.getToolTip=function(i){return KR.config.getToolTip(i,this)},H.prototype.$56$=function(i){var H=this;i.push({id:"copy",label:p("editor.copy"),action:function(){H.editor.copy()},visible:function(){return!!H.editor.ld}}),i.push({id:"paste",label:p("editor.paste"),action:function(){H.editor.paste(!1,H._rightClickPosition)},visible:function(){return H.editable&&H.editor.hasCopyInfo()}})},H.prototype.$55$=function(i){var H=this;i.push({separator:!0,visible:function(){return H.editable&&!!H.editor.ld}}),i.push({id:"bringToFront",label:p("editor.bringtofront"),action:function(){H.editor.bringToFront()},visible:function(){return H.editable&&!!H.editor.ld}}),i.push({id:"bringForward",label:p("editor.bringforward"),action:function(){H.editor.bringForward()},visible:function(){return H.editable&&!!H.editor.ld}}),i.push({id:"sendBackward",label:p("editor.sendbackward"),action:function(){H.editor.sendBackward()},visible:function(){return H.editable&&!!H.editor.ld}}),i.push({id:"sendToBack",label:p("editor.sendtoback"),action:function(){H.editor.sendToBack()},visible:function(){return H.editable&&!!H.editor.ld}})},H.prototype.initMenuItems=function(i){},H.prototype.onClosed=function(){C(this.editor.menus,this.menu)},H.prototype.$57$=function(i){return i&&this.copyMap[i._id]?i._id:i},H.prototype.$49$=function(i,H){return i instanceof ht.Data?this.dm().contains(i)?i:void 0:H[i]},H.prototype.getSelectWidth=function(i){return!this.isEditable(i)||i instanceof ht.Edge?i.s("select.width"):0},H.prototype.onSelectionChanged=function(i){if(1===this.sm().size()&&("set"===i.kind||"append"===i.kind)){var H=this.sm().ld();H&&document.activeElement===this.getView()&&this._dataModel.isAutoAdjustIndex()&&this.adjustIndex(H)}},H.prototype.getContentRect=function(){var H=i.prototype.getContentRect.call(this);if(!H.width||!H.height){var R=this.dm().a("width")||200,M=this.dm().a("height")||200;H={x:-R/2,y:-M/2,width:R,height:M,empty:!0}}return H},H.prototype.isDroppable=function(i,H){return!1},H.prototype.$58$=function(i){if(this.dragImage){var H=KR.config.dragImageSize,R=G(i);this.dragImage.style.left=R.x-H/2+"px",this.dragImage.style.top=R.y-H/2+"px"}},H.prototype.removeDragImage=function(){this.dragImage&&(Y(this.dragImage),this.dragImage=null)},H.prototype.handleCrossDrag=function(i,H,R){var M=this,I=R.view,p=I.draggingData;if("enter"===H){if(this._topDiv.style.border="solid "+KR.config.color_select_dark+" 2px",!this.dragImage&&p){var h=void 0===p.a("dragImage")?p.getImage():p.a("dragImage");if(ht.Default.getImage(h)!==ht.Default.getImage("editor.unknown")){var z=KR.config.dragImageSize;this.dragImage=ht.Default.toCanvas(h,z,z,"centerUniform",p,R.view,null,ht.Default.devicePixelRatio),this.$58$(i),this.dragImage.style.opacity=KR.config.dragImageOpacity,this.dragImage.className="ht-editor-dnd-image",ht.Default.appendToScreen(this.dragImage)}}}else if("exit"===H||"cancel"===H)this._topDiv.style.border="",this.removeDragImage();else if("over"===H)this.$58$(i);else if("drop"===H)if(this._topDiv.style.border="",p){this.removeDragImage();var d=this.lp(i);I.isSelected(p)?I.sm().toSelection().each(function(H){I.handleDropToEditView?I.handleDropToEditView(M.editView,H,d,i):M.editor.$98$(H,d)}):I.handleDropToEditView?I.handleDropToEditView(this.editView,p,d,i):this.editor.$98$(p,d)}else I===this.editor.dndFromOutside&&this.editor.dropLocalFileOnView(i)},zR(H,[{key:"editable",get:function(){return this.editor.editable},set:function(i){}}]),H}(rR),JM=function(i){function H(R){return hR(this,H),CR(this,i.call(this,R))}return dR(H,i),H.prototype.handleDataModelChange=function(H){i.prototype.handleDataModelChange.call(this,H),this.editor&&this.editor.fireViewEvent(this.editView,"DataModelChanged",{event:H})},H.prototype.handleDataModelPropertyChange=function(H){i.prototype.handleDataModelPropertyChange.call(this,H),this.editor&&this.editor.fireViewEvent(this.editView,"DataModelPropertyChanged",{event:H})},H.prototype.handleDataPropertyChange=function(H){i.prototype.handleDataPropertyChange.call(this,H),this.editor&&this.editor.fireViewEvent(this.editView,"DataPropertyChanged",{event:H})},H.prototype.initMenuItems=function(H){this.$56$(H),this.$55$(H),this.addBlockItems(H),this.editor.$103$(H),i.prototype.initMenuItems.call(this,H)},H.prototype.isDroppable=function(i,H){if(this.editor.editable)return!!H.view.isDroppableToDisplayView},H.prototype.isSelectable=function(H,R){return!H._refGraph&&i.prototype.isSelectable.call(this,H,R)},H.prototype.addBlockItems=function(i){var H=this,R=function(){return H.sm().size()>0},M=function(){for(var i=0;i<H.sm().size();i++){var R=H.sm().getSelection().get(i);if(R instanceof ht.Block&&!(R instanceof ht.RefGraph))return!0}return!1};i.push({separator:!0,visible:function(){return H.editable&&(R()||M())}}),i.push({id:"block",label:p("editor.block"),action:function(){H.editor.block()},visible:function(){return H.editable&&R()}}),i.push({id:"unblock",label:p("editor.unblock"),action:function(){H.editor.unblock()},visible:function(){return H.editable&&M()}})},H}(oM),OM=function(){function i(H,R,M){hR(this,i),this.canvas=H,this.editView=R,this.type=M,this.gv=R.graphView,this.hoverLine=null,this.setUp(),this.garbageImage=ht.Default.toCanvas("Icons.ConnectGuideDeletingImage",24,24)}return i.prototype.getView=function(){return this.canvas},i.prototype.setUp=function(){this.addListeners()},i.prototype.tearDown=function(){this.removeListeners(),this.clear()},i.prototype.clear=function(){},i.prototype.setCursor=function(i){ht.Default.isTouchable||(this.canvas.style.cursor=i)},i.prototype.checkHit=function(i){var H=this.editView,R=this.gv,M=this.existList,I=this.type,p=R.lp(i),h=R.getZoom();if(M.length){var z=1/0,d=p[I],C=void 0;if(M.forEach(function(i){var H=Math.abs(i.value-d);H<z&&(C=i,z=H)}),C&&z<6/h){var y=this.getRoundLogicalPoint(i);return this.setCursor("x"===I?"ew-resize":"ns-resize"),y[I]=C.value,H[this.hoverKey]=y,this.hoverLine=C,H.drawRuler(),H.gv.redraw(),C}}return null},i.prototype.handle_touchmove=function(i){this.handle_mousemove(i)},i.prototype.handle_mousemove=function(i){if(this.editable&&!this.editing&&!ht.Default.isDragging()){var H=this.editView;this.gv;this.checkHit(i)||(delete this.hoverLine,this.setCursor("default"),H[this.hoverKey]=this.getRoundLogicalPoint(i),H.drawRuler(),H.gv.redraw())}},i.prototype.handle_touchstart=function(i){this.handle_mousedown(i)},i.prototype.handle_mousedown=function(i){this.editable&&(ht.Default.preventDefault(i),this.checkHit(i)?(D(this,i),ht.Default.preventDefault(i),this.editing=!0,delete this.editView[this.hoverKey],this.editView.gv.redraw()):this.addGuide(this.getRoundLogicalPoint(i)))},i.prototype.handle_mouseleave=function(i){var H=this.editView,R=this.hoverKey;this.editing||ht.Default.isDragging()||(H[R]&&(delete H[R],H.iv(),this.editView.gv.redraw()),this.setCursor("default"))},i.prototype.handleWindowTouchMove=function(i){this.handleWindowMouseMove(i)},i.prototype.handleWindowMouseMove=function(i){var H=this.hoverLine,R=this.gv,M=this.type,I=this.editView,p=this.grid,h=R.lp(i);if(p){var z=H.id,d=R.getZoom()>5?parseFloat(h[M].toFixed(1)):Math.round(h[M]);this.showGarbageTip(i),(this._garbageAppended||this.editView[this.hoverKey])&&(p.adjustAlignmentGuide(z,d),H.value=d,I.iv())}},i.prototype.handleWindowMouseUp=function(i){this.editing=!1;var H=this.hoverLine,R=this.garbageImage,M=this.grid,I=this.existList;if(!this.containedInGv(i)){M.removeAlignmentGuide(H.id);var p=I.indexOf(H);I.splice(p,1)}R.parentNode&&R.parentNode.removeChild(R),delete this.editView[this.hoverKey],this.editView.iv(),this.update()},i.prototype.showGarbageTip=function(i){var H=this.editView,R=this.hoverKey,M=this.garbageImage,I=ht.Default.getClientPoint(i);this.containedInGv(i)?(M.parentNode&&M.parentNode.removeChild(M),H[R]=this.getRoundLogicalPoint(i)):(M.parentNode?delete this._garbageAppended:(ht.Default.appendToScreen(M),this._garbageAppended=!0),M.style.left=I.x+10+"px",M.style.top=I.y+10+"px",delete H[R])},i.prototype.containedInGv=function(i){var H=this.gv,R=this.type,M=H.getView().getBoundingClientRect(),I=M.x,p=M.y,h=M.width,z=M.height,d={x:I+h/2,y:p+z/2},C=f(i);return"x"===R?C.y=d.y:C.x=d.x,ht.Default.containsPoint(M,C)},i.prototype.addGuide=function(i){var H=(this.editView,this.type),R=this.grid,M=i[H];if(R){var I=R.addAlignmentGuide(H,M);this.editView.alignGuideMap[H].push({id:I,value:M}),this.update()}},i.prototype.getRoundLogicalPoint=function(i){var H=this.gv.lp(i);return this.gv.getZoom()>5?(H.x=parseFloat(H.x.toFixed(1)),H.y=parseFloat(H.y.toFixed(1))):(H.x=Math.round(H.x),H.y=Math.round(H.y)),H},i.prototype.update=function(){this.editView.updateAlignGuide()},zR(i,[{key:"grid",get:function(){return this.gv.getEditInteractor()?this.gv.getEditInteractor().gridGuide:null}},{key:"hoverKey",get:function(){return"hoverGuideLine"+this.type.toUpperCase()}},{key:"existList",get:function(){return this.editView.alignGuideMap[this.type]}},{key:"editable",get:function(){return this.editView.editable&&this.editView.dm.a("alignmentGuideEnabled")}}]),i}();ii(OM,{ms_listener:1});var cM={width:!0,height:!0,position:!0,rotation:!0,anchor:!0,scale:!0,expanded:!0};ht.Default.getMSMap().hteditor_editview=function(i,H){Object.defineProperties(i,{dirty:{get:function(){return this.tab.a("dirty")},set:function(i){ht.Default.loadingRefGraph||this.tab.a("dirty",i)}}}),i.setRulerEnabled=function(i){this.dm.a("rulerEnabled",i)},i.isRulerEnabled=function(){return this.dm.a("rulerEnabled")},i.reload=function(){if(this.url){var i={url:this.url};if(this.editor.fireViewEvent(this,"Reloading",i),i.preventDefault)return!1;this.parse(this.url)}},i.save=function(i,H){var R=this;if(!this.editable)return void(i&&i());var M=function(){i&&i(),R.editor.fireViewEvent(R,"Saved",{url:R.url}),R.editor.makeFileNodeVisible(R.url)};if(H)this._saveAs(M,H);else if(this.url)this._saveImpl(M);else{var I=this.editor._rightClickURL||this.editor[this.type+"s"].currentDir,h=p("editor.inputnew"+this.type+"name"),z=this.editor[this.type+"s"];if(z.isAccordionMode()&&z.rootDir===I)return void this.editor.showMessage(p("editor.createfolderfirst"),"error",2e3);this._saveNew(i,M,h,I)}},i._saveNew=function(i,H,R,M){var I=this,h=function(R,h){if("ok"===h){var z=B(R),d=M+"/"+z+"."+I.extension;I.editor.getFileNode(d)?HH(p("editor.filenameconflict"),d,function(){i&&i()}):(I.tab.setName(z),I.url=d,I.tab.setTag(I.url),I.editor.dataView.updateUrl(),I._saveImpl(H,!0))}else i&&i()},z={name:void 0};if(this.editor.fireViewEvent(this,"NewNameInputing",z),z.preventDefault)return!1;z.name?h(z.name,"ok"):iH(R,this.tab.getName(),{nullable:!1,trim:!0,maxLength:KR.config.maxFileNameLength,checkFunc:KR.config.checkFileName,$38$:this.editor.$38$},h)},i._saveAs=function(i,H){this.tab.setName(E(H)),this.url=H,this.tab.setTag(this.url),this.editor.dataView.updateUrl(),this._saveImpl(i)},i._saveImpl=function(i,H){var R=this,M=this.url,I={url:M};if("display"===this.type&&KR.config.settingDefaultValueBeforeSaving&&this.dm.each(function(i){if(i instanceof ht.Node){var H=ht.Default.getImage(i.getImage());H&&H.dataBindings&&H.dataBindings.forEach(function(H){var R=i.getAttrObject(),M=H.defaultValue;if(void 0!==M){var I=H.attr;R&&void 0!==R[I]||i.a(I,M)}})}}),this.editor.fireViewEvent(this,"Saving",I),I.preventDefault)return H&&(this.tab.setName(p("editor.untitled")),delete this.url,this.tab.setTag(void 0),this.editor.dataView.updateUrl()),!1;var h=this.parent_uuid,z=this.root_dir;I={path:I.url,content:F(this.content),parent_uuid:h,root_dir:z},this.editor.request("upload",I,function(I){I?(H&&R.tab.a("uuid",I.uuid),R.editor.saveImage(R.dm.a("snapshotURL")||R.g3d||R.graphView,M.substr(0,M.length-5)+".png",function(){i&&i(),R.editor.showMessage(p("editor.savedsuccessfully"),"normal",1e3),R.dirty=!1},I.uuid,I.parent_uuid,I.root_dir||I.asset_type)):(R.tab&&R.editor.mainTabView.removeTab(R.tab),delete R.tab,R.editor.showMessage(p("editor.savedfailed"),"error",1e3))})},i.parse=function(i,H){(i||H)&&(this.url=i,H?this.update(H):r(i,this.update.bind(this)))},i.update=function(i,H){var R=this;if(i){if(H){var M=F(this.content),I=i,p={undo:function(){R.updateImpl(M,!0)},redo:function(){R.updateImpl(I,!0)}};this.dm.disableHistoryManager(),this.updateImpl(i,H),this.dm.enableHistoryManager(),this.dm.addHistory(p)}else this.dm.disableHistoryManager(),this.updateImpl(i,H),this.dm.enableHistoryManager(),this.dm.clearHistoryManager();var h=void 0;H?h="Committed":this.isOpened?h="Reloaded":(h="Opened",this.isOpened=!0);var z={url:this.url,json:i};this.editor.fireViewEvent(this,h,z)}},i.$3$=function(){return this._interactionState},i.$4$=function(i,H,R,M){var I=this,p=this._interactionState;p!==i&&(this._interactionState=i,this.editor.pointsEditingMode=!1,[this.graphView,this.g3d].forEach(function(p){if(p){var h=[];if(p.getInteractors().each(function(H){H.keep?H.disabled="edit"!==i:h.push(H)}),h.forEach(function(i){i.tearDown(),p.getInteractors().remove(i)}),"edit"!==i){var z=p===I.g3d?I.create3dInteractor(H,R,M):I.createInteractor(H,R,M);z&&(z.setUp(),p.getInteractors().add(z))}p.invalidateSelection()}}),this.editor.mainToolbar.iv(),this.fp("interactionState",p,i),this.validateCanvas())},i.addData=function(i){var H=arguments.length>1&&void 0!==arguments[1]&&arguments[1],R=arguments.length>2&&void 0!==arguments[2]&&arguments[2],M=arguments.length>3&&void 0!==arguments[3]&&arguments[3],I="symbol"===this.type?"compCreated":"dataCreated",p={data:i};if(R)return void this.editor.fireViewEvent(this,I,p,!1);this.dm.beginTransaction(),H||i.getParent()||i.setParent(this.graphView.getCurrentSubGraph()),this.dm.add(i),H||(M||this.dm.sm().ss(i),this.graphView.setFocus()),this.editor.fireViewEvent(this,I,p,!1),this.dm.endTransaction()},i.skewGrid=function(){this.dm.beginTransaction(),this.dm.a("gridAngle",2*Math.PI/3),this.dm.a("gridRotation",Math.PI/6),this.dm.endTransaction()},i.preview=function(){this.$64$("previews/"+this.type+".json",this.dm.a("previewURL")||KR.config[this.type+"PreviewURL"])},i.$64$=function(i,H){var R=this,M=this.tab.getTag();M&&(H+=(-1===H.indexOf("?")?"?":"&")+"tag="+encodeURI(M));var I={url:H};if(this.editor.fireViewEvent(this,"Previewing",I),I.preventDefault)return!1;H=I.url;var p=this.content;p.title=this.tab.getName();var h=this.parent_uuid,z=this.root_dir;I={path:KR.config.vision&&M?"previews/"+M:i,content:F(p),parent_uuid:h,root_dir:z},this.editor.request("upload",I,function(i){window.open(H,H.replace(/[^\u4E00-\u9FA5A-Za-z0-9]+/g,"_")),R.editor.fireViewEvent(R,"Preview",{url:H})})},i.addInteractorPropertyChangeListener=function(i,H){var R=this.gv,M=R&&R.getEditInteractor();M&&M.mp(i,H)},i.removeInteractorPropertyChangeListener=function(i,H){var R=this.gv,M=R&&R.getEditInteractor();M&&M.ump(i,H)}};var tM=function(){function i(H,R,M,I,p,h,z){var d=this;hR(this,i),this.editor=H,this.tab=R,this.type=I,this.sceneView=p,this.parent_uuid=h,this.root_dir=z,this.extension="json",R.setView(this);var C=this.gv=this.graphView=new M(this);this._view=W(!0,this),C.addViewListener(function(i){"validate"===i.kind&&d.validateCanvas()}),this._hRuler=l(),this._vRuler=l(),this._view.appendChild(C.getView()),this.$4$("edit"),C.isInteractive=function(){return!1},C.addPropertyChangeListener(function(){d.iv()}),C.addInteractorListener(function(i){d.handleInteractorEvent(i)}),this.dm.sm().addSelectionChangeListener(function(i){d.iv()}),this.dm.addDataModelChangeListener(function(i){d.handleDataModelChanged(i)}),this.dm.addDataPropertyChangeListener(function(i){d.handleDataPropertyChanged(i)}),this.dm.addPropertyChangeListener(function(i){d.handleDataModelPropertyChanged(i)}),this.dm.addHierarchyChangeListener(function(i){d.handleHierarchyChanged(i)}),this.dm.layout=function(i,H){d._autoLayout||(d._autoLayout=new ht.layout.AutoLayout(C)),d._autoLayout.options=H||{};var R=C.getZoom(),M=C.tx(),I=C.ty();d.dm.beginTransaction(),d._autoLayout.setAnimate(KR.config.animate);var p=function(){var i=C.getZoom(),H=C.tx(),p=C.ty(),h={undo:function(){C.setZoom(R),C.tx(M),C.ty(I)},redo:function(){C.setZoom(i),C.tx(H),C.ty(p)}};d.dm.addHistory(h),d.dm.endTransaction()};d._autoLayout.layout(i,function(){KR.config.animate?C.fitContent({finishFunc:p}):(C.fitContent(!1,KR.config.fitPadding),p())})},C.setEditable(!0),C.setEditStyle("moveDummyThreshold",KR.config.moveDummyThreshold),C.setEditStyle("smartGuideThreshold",KR.config.smartGuideThreshold),KR.SceneView&&C.setEditStyle("curveTipVisible",!1),C.getInteractors().each(function(i){i.keep=!0}),this.clear(),this.initRuler()}return i.prototype.setGridEnabled=function(i){this.dm.a("gridEnabled",i)},i.prototype.isGridEnabled=function(){return this.dm.a("gridEnabled")},i.prototype.initRuler=function(){var i=this._hRuler,H=this._vRuler,R=this.gv,M=this.type;if(this.alignGuideMap={x:[],y:[]},KR.config.gridAlignmentGuideEnabled){i.style.pointerEvents="auto",H.style.pointerEvents="auto";var I=this.dm.a("alignmentGuideColor");I||(I="symbol"===M?KR.config.symbolGridAlignmentGuideColor:KR.config.displayGridAlignmentGuideColor),R.setEditStyle("gridAlignmentGuideColor",I);new OM(this._hRuler,this,"x"),new OM(this._vRuler,this,"y")}},i.prototype.resetGrid=function(){},i.prototype.clear=function(){this.dm.beginTransaction(),
this.dm.setName(void 0),this.dm.setBackground(void 0),this.dm.setHierarchicalRendering(!1),this.dm.setLayers(void 0),this.dm.clear(),this.dm.setAttrObject(void 0),this.resetGrid(),this.getGridGuide().removeAllAlignmentGuide(),this.dm.endTransaction()},i.prototype.handleInteractorEvent=function(i){var H=i.kind;"prepareMove"!==H&&"prepareEdit"!==H||!i.event.altKey?"selectPoint"===H&&(this.currentEditingPoint=void 0===i.x?null:{x:i.x,y:i.y,e:Ti(i.e)?i.e:0},this.editor.updateInspectorPropertiesLater()):(this.editor.copy(),this.editor.paste(!0),this.editor.gv.validate())},i.prototype.handleDataModelChanged=function(i){this.dirty=!0},i.prototype.handleDataPropertyChanged=function(i){i.data.disableDirty||"*"!==i.property&&(cM[i.property]&&this.iv(),this.dirty=!0)},i.prototype.handleHierarchyChanged=function(i){this.dirty=!0},i.prototype.handleDataModelPropertyChanged=function(i){var H=this,R=i.property,M=i.newValue;if("a:rulerEnabled"===R)this.graphView.getEditInteractor().alignmentGuideEnabled=M,this.iv();else if("a:gridEnabled"===R)this.graphView.getEditInteractor().gridEnabled=M;else if("a:gridBlockSize"===R)this.graphView.setEditStyle("gridBlockSize",M);else if("a:gridThickLinesEvery"===R)this.graphView.setEditStyle("gridThickLinesEvery",M);else if("a:gridThickColor"===R)this.graphView.setEditStyle("gridThickColor",M);else if("a:gridLightColor"===R)this.graphView.setEditStyle("gridLightColor",M);else if("a:gridAngle"===R)this.graphView.setEditStyle("gridAngle",M);else if("a:gridRotation"===R)this.graphView.setEditStyle("gridRotation",M);else if("a:gridZoomThreshold"===R)this.graphView.setEditStyle("gridZoomThreshold",M);else if("a:anchorEnabled"===R)this.graphView.setEditStyle("anchorVisible",M);else if("a:guideLineEnabled"===R)this.graphView.setEditStyle("guideLineVisible",M);else if("a:highlightEnabled"===R)this.graphView.setEditStyle("hoverGuideVisible",M);else if("a:highlightColor"===R)this.graphView.setEditStyle("hoverGuideColor",M);else if("a:highlightBorderWidth"===R)this.graphView.setEditStyle("hoverGuideBorderWidth",M);else if("a:highlightBorderPattern"===R)this.graphView.setEditStyle("hoverGuideBorderPattern",M);else if("a:connectActionType"===R)this.graphView.setCurrentConnectActionType(M);else if("a:xAlignmentGuides"===R){var I=this.getGridGuide();I.removeAllAlignmentGuide("x"),this.alignGuideMap.x=[],M&&M.forEach(function(i){var R=I.addAlignmentGuide("x",i);H.alignGuideMap.x.push({id:R,value:i})}),this.drawRuler()}else if("a:yAlignmentGuides"===R){var p=this.getGridGuide();p.removeAllAlignmentGuide("y"),this.alignGuideMap.y=[],M&&M.forEach(function(i){var R=p.addAlignmentGuide("y",i);H.alignGuideMap.y.push({id:R,value:i})}),this.drawRuler()}else"a:alignmentGuideColor"===R?(this.graphView.setEditStyle("gridAlignmentGuideColor",M),this.drawRuler()):"a:alignmentGuideEnabled"===R&&(this.graphView.getEditInteractor().alignmentGuideEnabled=M,this.drawRuler());this.dirty=!0,this.validateCanvas()},i.prototype.onClosed=function(){this.graphView.onClosed()},i.prototype.validateCanvasLater=function(){var i=this;this._validateCanvasLater||(this._validateCanvasLater=!0,requestAnimationFrame(function(){i.validateCanvas()}))},i.prototype.validateCanvas=function(){this._validateCanvasLater=!1;var i=this.graphView._topCanvas,H=u(i);H.clearRect(0,0,i.clientWidth,i.clientHeight),this.graphView.getInteractors().each(function(i){i.$0$&&i.$0$(H)}),this.$0$(H),H.restore()},i.prototype.redraw=function(){this._lastWidth=this._lastHeight=null,this.iv()},i.prototype.validateImpl=function(){var i=this._rulerSize,H=this.isRulerEnabled(),R=this.getWidth(),M=this.getHeight();if(R!==this._lastWidth||M!==this._lastHeight||i!==this._lastRulerSize||H!==this._lastRulerEnabled){if(this._lastWidth=R,this._lastHeight=M,this._lastRulerSize=i,this._lastRulerEnabled=H,H){this._hRuler.parentNode||(this._view.appendChild(this._hRuler),this._view.appendChild(this._vRuler));var I=Math.max(0,R-i),p=Math.max(0,M-i);x(this._hRuler,i,0,I,i),x(this._vRuler,0,i,i,p),x(this.graphView,i,i,I,p),x(this.graphView._topDiv,0,0,I,p),j(this.graphView._topCanvas,I,p),j(this._hRuler,I,i),j(this._vRuler,i,p)}else this._hRuler.parentNode&&(Y(this._hRuler),Y(this._vRuler)),x(this.graphView,0,0,R,M),x(this.graphView._topDiv,0,0,R,M),j(this.graphView._topCanvas,R,M);this.validateCanvas()}this._hRuler.style.background=this._rulerBackground,this._vRuler.style.background=this._rulerBackground,this.drawRuler()},i.prototype.$0$=function(i){var H=this.graphView.getZoom(),R=this.graphView.tx(),M=this.graphView.ty(),I=Math.round(this.dm.a("width")||0)*H,p=Math.round(this.dm.a("height")||0)*H,h=this.graphView.getWidth(),z=this.graphView.getHeight();!KR.config.mixMaskAndBackground&&this.dm.getBackground()||I>0&&p>0&&h>0&&z>0&&(i.beginPath(),R&&i.rect(0,0,R,z),M&&h-R&&i.rect(R,0,h-R,M),h-R-I&&p&&i.rect(R+I,M,h-R-I,p),h-R&&z-M-p&&i.rect(R,M+p,h-R,z-M-p),i.fillStyle=KR.config.color_mask,i.fill())},i.prototype.drawVerticalText=function(i,H,R){i.save(),i.translate(11,R+11),i.rotate(-Math.PI/2),g(i,H,this._rulerFont,this._rulerColor,11,-11,0,this._rulerSize,"right"),i.restore()},i.prototype.drawRuler=function(){if(this.isRulerEnabled()){var i=this._rulerFont,H=this._rulerSize,R=this._rulerColor,M=this.graphView,I=M.getUnionNodeRect(M.sm().getSelection()),p=M.getZoom(),h=Math.log(p)/Math.log(10),z=Math.floor(h),d=100/Math.pow(10,z)*p,C=d/10,y=z>1?40+10*(z-1):40,b=Math.round(M.tx()),U=Math.round(M.ty()),K={x:-b,y:-U,width:M.getWidth(),height:M.getHeight()},q=Math.floor(K.x/d),Q=Math.ceil((K.x+K.width)/d),m=Math.floor(K.y/d),X=Math.ceil((K.y+K.height)/d),o=this.dm.a("alignmentGuideColor"),J=this.dm.a("alignmentGuideEnabled"),O=ht.Default.getTextSize,c=void 0,t=void 0,T=void 0,N=void 0,D=void 0,f=void 0;for(o||(o="symbol"===this.type?KR.config.symbolGridAlignmentGuideColor:KR.config.displayGridAlignmentGuideColor),u(this._hRuler,0,0,1,{x:0,y:0,width:K.width,height:H}).restore(),N=u(this._hRuler,b,0,1),N.lineWidth=1,N.strokeStyle=R,I&&(N.beginPath(),N.rect(I.x*p,0,I.width*p,H),N.fillStyle=KR.config.color_line,N.fill()),N.beginPath(),c=q;c<=Q;c++)D=c*d,f=z>1?(D/p).toFixed(z-1):Math.round(D/p),D=Math.round(D),N.moveTo(D,H),N.lineTo(D,0),g(N,f,i,R,D,0,1,H,"left");for(N.stroke(),N.beginPath(),c=q;c<=Q;c++)for(T=1;T<10;T++)D=c*d+T*C,f=z>1?(D/p).toFixed(z-1):Math.round(D/p),D=Math.round(D),N.moveTo(D,H),5===T?(N.lineTo(D,H-10),g(N,f,i,R,D,0,1,H,"left")):(N.lineTo(D,H-4),C>y&&g(N,f,i,R,D,0,1,H,"left"));N.stroke(),J&&this.alignGuideMap&&this.alignGuideMap.x.length&&(N.beginPath(),N.strokeStyle=o,this.alignGuideMap.x.forEach(function(i){N.moveTo(p*i.value,0),N.lineTo(p*i.value,H)}),N.stroke());var n=this.hoverGuideLineX;if(J&&n){var G=p*n.x,k=O(i,n.x);N.fillStyle=KR.config.color_pane,N.fillRect(G,0,k.width,H),g(N,n.x,i,o,G,0,k.width,H,"left","middle"),N.beginPath(),N.lineWidth=2,N.moveTo(G,0),N.lineTo(G,H),N.strokeStyle=ht.Default.brighter(o),N.stroke()}for(N.restore(),u(this._vRuler,0,0,1,{x:0,y:0,width:H,height:K.height}).restore(),N=u(this._vRuler,0,U,1),N.lineWidth=1,N.strokeStyle=R,I&&(N.beginPath(),N.rect(0,I.y*p,H,I.height*p),N.fillStyle=KR.config.color_line,N.fill()),N.beginPath(),t=m;t<=X;t++)D=t*d,f=z>1?(D/p).toFixed(z-1):Math.round(D/p),D=Math.round(D),N.moveTo(H,D),N.lineTo(0,D),this.drawVerticalText(N,f,D);for(N.stroke(),N.beginPath(),t=m;t<=X;t++)for(T=1;T<10;T++)D=t*d+T*C,f=z>1?(D/p).toFixed(z-1):Math.round(D/p),D=Math.round(D),N.moveTo(H,D),5===T?(N.lineTo(H-10,D),this.drawVerticalText(N,f,D)):(N.lineTo(H-4,D),C>y&&this.drawVerticalText(N,f,D));N.stroke(),J&&this.alignGuideMap&&this.alignGuideMap.y.length&&(N.beginPath(),N.strokeStyle=o,this.alignGuideMap.y.forEach(function(i){N.moveTo(0,p*i.value),N.lineTo(H,p*i.value)}),N.stroke());var P=this.hoverGuideLineY;if(J&&P){var Z=p*P.y,v=O(i,P.y);N.fillStyle=KR.config.color_pane,N.fillRect(0,Z,H,v.width),N.save(),N.translate(0,Z),N.rotate(-Math.PI/2),g(N,P.y,i,o,-v.width,0,v.width,H,"right"),N.restore(),N.beginPath(),N.lineWidth=2,N.moveTo(0,Z),N.lineTo(H,Z),N.strokeStyle=ht.Default.brighter(o),N.stroke()}N.restore()}},i.prototype.updateAlignGuide=function(){if(this.getGridGuide()){var i=this.dm,H=this.alignGuideMap,R=H.x,M=H.y;i.beginTransaction(),i.a({xAlignmentGuides:R&&R.length?R.map(function(i){return i.value}):void 0,yAlignmentGuides:M&&M.length?M.map(function(i){return i.value}):void 0}),i.endTransaction()}},i.prototype.getGridGuide=function(){return this.gv.getEditInteractor()?this.gv.getEditInteractor().gridGuide:null},zR(i,[{key:"editable",get:function(){return this.sceneView?this.sceneView.editable:this._editable},set:function(i){this.sceneView||i!==this._editable&&(this._editable=i,this.gv.invalidateSelection(),this.editor.mainToolbar.iv())}},{key:"dm",get:function(){return this.graphView.dm()}}]),i}();ii(tM,{ms_v:1,ms_fire:1,ms_ac:["rulerBackground","rulerFont","rulerColor","rulerSize","guideColor"],hteditor_editview:1,_rulerFont:KR.config.smallFont,_rulerBackground:KR.config.color_pane,_rulerColor:KR.config.color_dark,_rulerSize:KR.config.rulerSize,_guideColor:KR.config.color_transparent,_interactionState:void 0});var TM=function(i){function H(R,M,I){hR(this,H);var p=R.getView(),h=CR(this,i.call(this,p.graphView));return h.tab=R,h.editView=p,h.editor=h.editView.editor,h.clazz=M,h.type=I,h._disabled=!1,h}return dR(H,i),H.prototype.beginTransaction=function(){this._isBeginTransaction||(this._isBeginTransaction=!0,this.dm.beginTransaction())},H.prototype.endTransaction=function(){this._isBeginTransaction&&(this._isBeginTransaction=!1,this.dm.endTransaction())},H.prototype.getDataAt=function(i,H){return this.gv.getDataAt(i,H)},H.prototype.getNodeAt=function(i){var H=this.getDataAt(i);return H instanceof ht.Node?H:null},H.prototype.setUp=function(){i.prototype.setUp.call(this),this.sm.cs()},H.prototype.$0$=function(i){},H.prototype.drawDiamond=function(i,H,R,M){var I=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4;H=this.toPoint(H),M&&(i.fillStyle=M),R&&(i.strokeStyle=R);var p=H,h=p.x,z=p.y;i.lineWidth=1,i.beginPath(),i.moveTo(h,z-I),i.lineTo(h+I,z),i.lineTo(h,z+I),i.lineTo(h-I,z),i.closePath(),M&&i.fill(),R&&i.stroke()},H.prototype.drawRect=function(i,H,R,M){H=this.toRect(H),M&&(i.fillStyle=M),R&&(i.strokeStyle=R),i.lineWidth=1,i.beginPath(),i.rect(H.x,H.y,H.width,H.height),i.stroke(),M&&i.fill(),R&&i.stroke()},H.prototype.drawPoint=function(i,H,R,M,I){H=this.toPoint(H),I&&(i.fillStyle=I),M&&(i.strokeStyle=M),i.lineWidth=1,i.beginPath(),i.arc(H.x,H.y,R,0,2*Math.PI,!0),I&&i.fill(),M&&i.stroke()},H.prototype.drawPoints=function(i,H,R,M,I){for(var p=0;p<H.length;p++)this.drawPoint(i,H[p],R,M,I)},H.prototype.drawLine=function(i,H,R,M){H=this.toPoint(H),R=this.toPoint(R),i.lineWidth=1,i.strokeStyle=M,i.beginPath(),i.moveTo(H.x,H.y),i.lineTo(R.x,R.y),i.stroke()},H.prototype.toRect=function(i){var H=this.zoom;return{x:i.x*H+this.tx,y:i.y*H+this.ty,width:i.width*H,height:i.height*H}},H.prototype.toPoint=function(i){return{x:i.x*this.zoom+this.tx,y:i.y*this.zoom+this.ty}},H.prototype.add=function(i){this.editView.addData(i)},H.prototype.remove=function(i){this.dm.remove(i)},H.prototype.lp=function(i){return this.gv.lp(i)},zR(H,[{key:"dm",get:function(){return this.gv.dm()}},{key:"sm",get:function(){return this.gv.dm().sm()}},{key:"zoom",get:function(){return this.gv.getZoom()}},{key:"tx",get:function(){return this.gv.tx()}},{key:"ty",get:function(){return this.gv.ty()}},{key:"disabled",get:function(){return!this.editor.editable||this._disabled},set:function(i){this._disabled=i}}]),H}(ht.graph.Interactor),NM=function(i){function H(R,M,I){return hR(this,H),CR(this,i.call(this,R,M,I))}return dR(H,i),H.prototype.tearDown=function(){i.prototype.tearDown.call(this),this.node=this.p1=this.p2=null},H.prototype.$48$=function(i){this.node?this.remove(this.node):this.editView.$4$("edit")},H.prototype.handle_mousedown=function(i){this.handle_touchstart(i)},H.prototype.handle_touchstart=function(i){Ri(i),T(i)&&(this.gv.setFocus(i),this.p1=this.lp(i),this.startDragging(i))},H.prototype.handleWindowMouseMove=function(i){this.handleWindowTouchMove(i)},H.prototype.handleWindowMouseUp=function(i){this.handleWindowTouchEnd(i)},H.prototype.handleWindowTouchMove=function(i){if(Ri(i),this.p1){this.p2=this.lp(i);var H=Z(this.p1,this.p2);if(ht.Default.isShiftDown(i)){var R=Math.max(H.width,H.height);H.width=H.height=R}if(this.node)this.node.setRect(H);else{if(!H.width||!H.height)return;this.beginTransaction(),this.createNode(H,!1)}}},H.prototype.handleWindowTouchEnd=function(i){if(Ri(i),this.endTransaction(),!this.node&&this.p1&&this.createNode({x:this.p1.x-25,y:this.p1.y-25,width:50,height:50},!0),this.node){var H="symbol"===this.editView.type?"compCreated":"dataCreated",R={data:this.node};this.editor.fireViewEvent(this.editView,H,R,!1)}KR.config.continuousCreating?this.node=this.p1=this.p2=null:this.editView.$4$("edit")},H.prototype.createNode=function(i,H){Di(this.type)?this.node=this.type(i,H):this.node=new this.clazz,H?this.node.setPosition(i.x+i.width/2,i.y+i.height/2):this.node.setRect(i),this.node.setParent(this.editView.graphView.getCurrentSubGraph()),this.dm.add(this.node),this.dm.sm().ss(this.node),this.editView.graphView.setFocus()},H.prototype.$0$=function(i){this.node&&this.drawRect(i,this.node.getRect(),KR.config.color_data_border)},H}(TM),DM=function(i){function H(R,M,I){return hR(this,H),CR(this,i.call(this,R,M,I))}return dR(H,i),H.prototype.tearDown=function(){i.prototype.tearDown.call(this),this.draggingPoint=this.n1=this.n2=null},H.prototype.$48$=function(i){this.n1?(this.draggingPoint=this.n1=this.n2=null,this.editView.validateCanvas()):this.editView.$4$("edit")},H.prototype.drawAttachPoints=function(i,H,R){var M=this,I=this.gv.getAttachPoints(H);I&&I.forEach(function(I,p){var h=I.x,z=I.y,d=I.offsetX,C=I.offsetY;p===R?M.drawDiamond(i,H.getAttachPosition(h,z,d,C),KR.config.color_select,KR.config.color_select,6):M.drawDiamond(i,H.getAttachPosition(h,z,d,C),KR.config.color_select,KR.config.color_light)})},H.prototype.drawCurve=function(i,H,R){var M=this.gv.getEditInteractor();if(!M)return null;var I=M.getSubModule("Curve");if(!I)return null;I.drawEdgeHostHighlight(i,H,R),this.editView.validateCanvasLater()},H.prototype.$0$=function(i){if(this.n1&&(this.n1 instanceof ht.Edge?this.drawCurve(i,this.n1,this.edgePosition1):(this.drawRect(i,this.gv.getNodeRect(this.n1),KR.config.color_data_border),this.drawAttachPoints(i,this.n1,this.attachIndex1)),this.draggingPoint)){var H=void 0,R=void 0;H=this.n1 instanceof ht.Edge?this.edgePosition1.point:this.attachIndex1||0===this.attachIndex1?this.getAttachPosition(this.n1,this.attachIndex1):this.n1.p(),this.n2 instanceof ht.Edge?R=this.edgePosition2.point:this.n2&&(this.attachIndex2||0===this.attachIndex2)&&(R=this.getAttachPosition(this.n2,this.attachIndex2)),this.drawLine(i,H,R||this.draggingPoint,KR.config.color_data_border)}if(this.n2)if(this.n2 instanceof ht.Edge)this.drawCurve(i,this.n2,this.edgePosition2);else{var M=this.gv.getNodeRect(this.n2);this.n1!==this.n2&&(this.drawRect(i,M,KR.config.color_data_border),this.drawAttachPoints(i,this.n2,this.attachIndex2));var I=this.toPoint({x:M.x,y:M.y});i.beginPath(),i.moveTo(I.x,I.y-15-3),i.lineTo(I.x+10,I.y-15-3),i.lineTo(I.x+10,I.y-3),i.lineTo(I.x+5,I.y-7-3),i.moveTo(I.x+10,I.y-3),i.lineTo(I.x+15,I.y-7-3),i.lineWidth=1,i.strokeStyle=KR.config.color_data_border,i.stroke()}},H.prototype.handle_mousemove=function(i){var H=this;if(Ri(i),!this.draggingPoint){var R=this.getDataAt(i,function(i){return H.gv.isSourceTargetEditable(null,i)});if(R instanceof ht.Edge)this.edgePosition1=this.gv.calculateEdgePosition(R,this.lp(i));else{var M=this.attachIndex1;if(R){var I=this.gv.calculateAttachPoint(R,this.lp(i));this.attachIndex1=I?I.index:null}else this.attachIndex1=null;if(R===this.n1&&M===this.attachIndex1)return}this.n1=R,this.editView.validateCanvas()}},H.prototype.handle_mousedown=function(i){this.handle_touchstart(i)},H.prototype.handle_touchstart=function(i){var H=this;Ri(i),T(i)&&(this.gv.setFocus(i),this.draggingPoint||(this.n1=this.getDataAt(i,function(i){return H.gv.isSourceTargetEditable(null,i)}),this.n1&&(this.draggingPoint=this.lp(i),this.startDragging(i))))},H.prototype.handleWindowMouseMove=function(i){this.handleWindowTouchMove(i)},H.prototype.handleWindowMouseUp=function(i){this.handleWindowTouchEnd(i)},H.prototype.handleWindowTouchMove=function(i){var H=this,R=this.getDataAt(i,function(i){return H.gv.isSourceTargetEditable(null,i,!0)});if(this.draggingPoint=this.lp(i),this.autoScroll(i),KR.config.edgeLoop||this.n1!==R){if(this.n2=R,R)if(R instanceof ht.Edge)this.edgePosition2=this.gv.calculateEdgePosition(R,this.lp(i));else{var M=this.gv.calculateAttachPoint(R,this.lp(i));this.attachIndex2=M?M.index:null}}else this.attachIndex2=null,this.edgePosition2=null;this.editView.validateCanvas()},H.prototype.handleWindowTouchEnd=function(i){if(this.n1&&this.n2){var H=void 0;ti(this.type)?(H=new this.clazz(this.n1,this.n2),H.s("edge.type",this.type)):H=Di(this.type)?this.type(this.n1,this.n2):new this.clazz(this.n1,this.n2);var R=void 0,M=void 0;if(this.n1 instanceof ht.Edge)void 0!==this.edgePosition1.index?H.setStyle("edge.source.index",this.edgePosition1.index):void 0!==this.edgePosition1.percent&&H.setStyle("edge.source.percent",this.edgePosition1.percent);else if(R=this.getAttachPoint(this.n1,this.attachIndex1)){var I=R,p=I.x,h=I.y,z=I.offsetX,d=I.offsetY;H.s({"edge.source.anchor.x":p,"edge.source.anchor.y":h,"edge.source.offset.x":z,"edge.source.offset.y":d})}if(this.n2 instanceof ht.Edge)void 0!==this.edgePosition2.index?H.setStyle("edge.target.index",this.edgePosition2.index):void 0!==this.edgePosition2.percent&&H.setStyle("edge.target.percent",this.edgePosition2.percent);else if(M=this.getAttachPoint(this.n2,this.attachIndex2)){var C=M,y=C.x,b=C.y,U=C.offsetX,K=C.offsetY;H.s({"edge.target.anchor.x":y,"edge.target.anchor.y":b,"edge.target.offset.x":U,"edge.target.offset.y":K})}(R||M)&&H.s("edge.offset",0),this.add(H),KR.config.continuousCreating||this.editView.$4$("edit")}this.draggingPoint=this.n1=this.n2=null,this.editView.validateCanvas()},H.prototype.getAttachPoint=function(i,H){if(null===H||void 0===H)return null;var R=this.gv.getAttachPoints(i);return R&&0!==R.length?R[H]:null},H.prototype.getAttachPosition=function(i,H){var R=this.getAttachPoint(i,H),M=R.x,I=R.y,p=R.offsetX,h=R.offsetY;return i.getAttachPosition(M,I,p,h)},H}(TM),fM=function(i){function H(R,M,I,p){hR(this,H);var h=CR(this,i.call(this,R,M,I));return h.fill=p,h}return dR(H,i),H.prototype.setUp=function(){i.prototype.setUp.call(this),this.shapeHelper.reset()},H.prototype.tearDown=function(){i.prototype.tearDown.call(this)},H.prototype.$48$=function(i){var H=this.shapeHelper;H.isEditing3d()||(H.isBreak?this.createShape():(H.preCtrl=null,H.isBreak=!0,this.editView.validateCanvas()))},H.prototype.createShape=function(){var i=this.shapeHelper,H=i.points,R=i.segments,I=i.closePath;if(H.length>1){var p=M(H),h=void 0;Di(this.type)?h=this.type(p,R):(h=new this.clazz,h.setPoints(p),h.setSegments(R)),I&&h.setClosePath&&h.setClosePath(!0),this.add(h)}this.editView.$4$("edit"),this.editor.pointsEditingMode=!0},H.prototype.handle_mousedown=function(i){this.handle_touchstart(i)},H.prototype.isCloseStart=function(i){var H=this.shapeHelper.points,R=H[0];return!!R&&P(R,this.lp(i))<5/this.gv.getZoom()},H.prototype.handle_touchstart=function(i){this.shapeHelper.setEditing3d(!1);var H=this.shapeHelper,R=H.points,M=H.segments,I=H.isBreak,p=H.preCtrl;if(Ri(i),T(i)){if(this.gv.setFocus(i),N(i))this.createShape();else{if(this.isCloseStart(i))return this.shapeHelper.closePath=!0,void this.createShape();var h=this.judgeNextPoint(i,!0);if(R.length){var z=R[R.length-1];if(Math.abs(z.x-h.x)<.01&&Math.abs(z.y-h.y)<.01)return}if(p)R.push(p),R.push(h),R.push(h),M.push(4),this.shapeHelper.preCtrl=null;else{if(I){if(this.shapeHelper.isBreak=!1,P(h,this.shapeHelper.downPoint)<5/this.gv.getZoom())return;M.push(1)}else M.push(R.length>0?2:1);R.push(h)}this.shapeHelper.nextPoint=this.lp(i),this.editView.validateCanvas()}this.shapeHelper.downPoint=this.lp(i),this.startDragging(i),this._dragging=!0}},H.prototype.judgeNextPoint=function(i,H){var R=this.shapeHelper,M=R.points,I=R.isBreak,p=this.lp(i);if(this._dragging||I&&!H)return null;if(ht.Default.isShiftDown()&&M.length>0){var h=M[M.length-1],z=p.x-h.x,d=p.y-h.y,C=Math.atan2(d,z),y=ht.Default.getDistance(h,p),b=C%(Math.PI/4);return C-=b,Math.abs(b)>Math.PI/8&&(b>0?C+=Math.PI/4:C-=Math.PI/4),{x:h.x+Math.cos(C)*y,y:h.y+Math.sin(C)*y}}var U=this.gv.getEditInteractor(),K=U.gridGuide.findClosest(p);return K&&(K.x&&(p.x+=K.x),K.y&&(p.y+=K.y)),p},H.prototype.handle_mousemove=function(i){this.shapeHelper.nextPoint=this.judgeNextPoint(i),this.editView.validateCanvas()},H.prototype.handle_touchend=function(i){},H.prototype.handle_mouseup=function(i){this.handle_touchend(i)},H.prototype.handleWindowTouchMove=function(i){return this.handleWindowMouseMove(i)},H.prototype.updateCtrl=function(i){var H=this.shapeHelper,R=H.points,M=H.segments,I=H.downPoint,p=R.length,h=R[p-1],z=this.lp(i),d=this.gv.getZoom(),C=ht.Default.getDistance(I,z),y=M[M.length-1];if(C*d>5){if(ht.Default.isShiftDown()){var b=Math.abs;b(h.x-z.x)>=b(h.y-z.y)?z.y=h.y:z.x=h.x}else{var U=this.gv.getEditInteractor(),K=U.gridGuide.findClosest(z);K&&(K.x&&(z.x+=K.x),K.y&&(z.y+=K.y))}var q={x:2*h.x-z.x,y:2*h.y-z.y};4===y?R[p-2]=q:1!==y&&(M.pop(),M.push(4),R.splice(p-1,0,q),R.push(R[p-1])),this.shapeHelper.preCtrl=z}else 4===y&&(R[p-2]=R[p-1],this.shapeHelper.preCtrl=null)},H.prototype.handleWindowMouseMove=function(i){0!==this.shapeHelper.points.length&&(this.updateCtrl(i),this.editView.validateCanvas())},H.prototype.handleWindowTouchEnd=function(i){return this.handleWindowMouseUp(i)},H.prototype.handleWindowMouseUp=function(i){0!==this.shapeHelper.points.length&&(this._dragging=!1,this.updateCtrl(i),this.shapeHelper.nextPoint=this.judgeNextPoint(i,!0))},H.prototype.$0$=function(i){var H=this.shapeHelper,R=H.points,M=H.segments,I=(H.isBreak,H.preCtrl),p=(H.downPoint,H.nextPoint),h=[];i.beginPath();for(var z=0,d=void 0,C=void 0,y=void 0,b=0;b<M.length;b++){var U=M[b];1===U?(d=this.toPoint(R[z++]),i.moveTo(d.x,d.y)):2===U?(d=this.toPoint(R[z++]),i.lineTo(d.x,d.y)):3===U?(d=this.toPoint(R[z++]),C=this.toPoint(R[z++]),i.quadraticCurveTo(d.x,d.y,C.x,C.y)):4===U?(d=this.toPoint(R[z++]),C=this.toPoint(R[z++]),y=this.toPoint(R[z++]),i.bezierCurveTo(d.x,d.y,C.x,C.y,y.x,y.y)):5===U&&i.closePath(),h.push(R[z-1])}if(p)if(I)d=this.toPoint(I),C=this.toPoint(p),y=this.toPoint(p),i.bezierCurveTo(d.x,d.y,C.x,C.y,y.x,y.y);else{var K=this.toPoint(p);i.lineTo(K.x,K.y)}if(i.strokeStyle=KR.config.color_data_border,i.lineWidth=1,i.stroke(),this.fill&&(i.fillStyle=KR.config.color_transparent,i.fill()),this.drawPoints(i,h,4,KR.config.color_data_border,KR.config.color_data_background),I){var q=R[R.length-1],Q=this.gv.getZoom(),m=3/Q,X=6/Q,o={x:2*q.x-I.x,y:2*q.y-I.y};this.drawLine(i,I,o,KR.config.color_data_border),this.drawRect(i,{x:o.x-m,y:o.y-m,width:X,height:X},KR.config.color_data_border,KR.config.color_data_background),this.drawRect(i,{x:I.x-m,y:I.y-m,width:X,height:X},KR.config.color_data_border,KR.config.color_data_background)}},zR(H,[{key:"shapeHelper",get:function(){return this.editor.shapeHelper}}]),H}(TM),nM=function(i){function H(R,M,I,p,h,z,d,C){hR(this,H);var y=CR(this,i.call(this,R,M,JM,"display",z,d,C));y.displayTree=y.list=new(h||RM)(y),y.dm.setHierarchicalRendering(!0),y.dm.enableHistoryManager(KR.config.maxUndoRedoSteps);var b=R.getFileNode(I);return y.editable=!b||!1!==b.a("editable"),z||(I?p||y.editor.fireEvent("displayViewOpening",{displayView:y,url:I}):y.editor.fireEvent("displayViewCreated",{displayView:y,json:p})),KR.config.standaloneViewCounter&&y.initIdCounter&&y.initIdCounter(),y.dm.addSerializeListener(y.handleDataModelSerializeEvent,y),y.parse(I,p),y.dirty=!1,y}return dR(H,i),H.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.displayTree.onClosed()},H.prototype.handleDataModelSerializeEvent=function(){},H.prototype.handleDataModelChanged=function(i){"add"!==i.kind||this.dm.isDeserializing()||ht.Default.isIsolating()||i.data.setLayer(this.editor.currentLayer),this.dirty=!0},H.prototype.clear=function(){this.sceneView||(this.dm.beginTransaction(),i.prototype.clear.call(this),this.dm.a("connectActionType",KR.config.displayConnectActionType),this.dm.a("anchorEnabled",KR.config.displayAnchorEnabled),this.dm.a("guideLineEnabled",KR.config.displayGuideLineEnabled),this.dm.a("highlightEnabled",KR.config.displayHighlightEnabled),this.dm.a("highlightColor",KR.config.displayHighlightColor),this.dm.a("highlightBorderWidth",KR.config.displayHighlightBorderWidth),this.dm.a("highlightBorderPattern",KR.config.displayHighlightBorderPattern),this.dm.endTransaction())},H.prototype.resetGrid=function(){this.sceneView||(this.dm.beginTransaction(),this.dm.a("rulerEnabled",KR.config.displayRulerEnabled),this.dm.a("gridEnabled",KR.config.displayGridEnabled),this.dm.a("gridBlockSize",KR.config.displayGridBlockSize),this.dm.a("gridThickLinesEvery",KR.config.displayGridThickLinesEvery),this.dm.a("gridThickColor",KR.config.displayGridThickColor),this.dm.a("gridLightColor",KR.config.displayGridLightColor),this.dm.a("gridAngle",KR.config.displayGridAngle),this.dm.a("gridRotation",KR.config.displayGridRotation),this.dm.a("gridZoomThreshold",KR.config.displayGridZoomThreshold),this.dm.a("alignmentGuideEnabled",KR.config.displayGridAlignmentGuideEnabled),this.dm.a("alignmentGuideColor",KR.config.displayGridAlignmentGuideColor),this.dm.endTransaction())},H.prototype.updateImpl=function(i,H){var R=this,I=w(i);if(this.clear(),this.dm.deserialize(I,void 0,{setId:KR.config.setId,disableInit:!0,disableOnPreDeserialize:!0,disableOnPostDeserialize:!0}),this.dirty=!!H,!H&&KR.config.fitContentForDisplayView)if(I.contentRect){var p=M(I.contentRect);ht.Default.grow(p,KR.config.fitPadding),this.graphView.getWidth()&&this.graphView.getHeight()?this.graphView.fitRect(p,KR.config.animate):setTimeout(function(){R.graphView.fitRect(p,KR.config.animate)},600)}else this.graphView.fitContent(KR.config.animate,KR.config.fitPadding);return I},H.prototype.createInteractor=function(i,H,R){var M=new i;return M instanceof ht.Shape?new fM(this.tab,null,function(R,M){var I=new i;return I.setPoints(R),I.setSegments(M),H&&H(I),I},R):M instanceof ht.Edge?new DM(this.tab,null,function(i,R){var M=new ht.Edge(i,R);return H&&H(M),M}):M instanceof ht.Node?new NM(this.tab,null,function(R,M){var I=new i;return H&&H(I,R,M),I}):void 0},zR(H,[{key:"content",get:function(){var i=this.dm,H=i.toJSON();H.modified=(new Date).toString(),i.a("connectActionType")===KR.config.displayConnectActionType&&delete H.a.connectActionType,i.a("rulerEnabled")===KR.config.displayRulerEnabled&&delete H.a.rulerEnabled,i.a("gridEnabled")===KR.config.displayGridEnabled&&delete H.a.gridEnabled,i.a("gridBlockSize")===KR.config.displayGridBlockSize&&delete H.a.gridBlockSize,i.a("gridThickLinesEvery")===KR.config.displayGridThickLinesEvery&&delete H.a.gridThickLinesEvery,i.a("gridThickColor")===KR.config.displayGridThickColor&&delete H.a.gridThickColor,i.a("gridLightColor")===KR.config.displayGridLightColor&&delete H.a.gridLightColor,i.a("gridAngle")===KR.config.displayGridAngle&&delete H.a.gridAngle,i.a("gridRotation")===KR.config.displayGridRotation&&delete H.a.gridRotation,i.a("gridZoomThreshold")===KR.config.displayGridZoomThreshold&&delete H.a.gridZoomThreshold,i.a("anchorEnabled")===KR.config.displayAnchorEnabled&&delete H.a.anchorEnabled,i.a("guideLineEnabled")===KR.config.displayGuideLineEnabled&&delete H.a.guideLineEnabled,i.a("highlightEnabled")===KR.config.displayHighlightEnabled&&delete H.a.highlightEnabled,i.a("highlightColor")===KR.config.displayHighlightColor&&delete H.a.highlightColor,i.a("highlightBorderWidth")===KR.config.displayHighlightBorderWidth&&delete H.a.highlightBorderWidth,i.a("highlightBorderPattern")===KR.config.displayHighlightBorderPattern&&delete H.a.highlightBorderPattern,i.a("xAlignmentGuides")&&!i.a("xAlignmentGuides").length&&delete H.a.xAlignmentGuides,i.a("yAlignmentGuides")&&!i.a("yAlignmentGuides").length&&delete H.a.yAlignmentGuides,i.a("alignmentGuideEnabled")===KR.config.displayGridAlignmentGuideEnabled&&delete H.a.alignmentGuideEnabled,i.a("alignmentGuideColor")===KR.config.displayGridAlignmentGuideColor&&delete H.a.alignmentGuideColor;var R=this.graphView.getContentRect();return i.a("width")>0&&i.a("height")>0&&(H.contentRect={x:0,y:0,width:i.a("width"),height:i.a("height")}),i.size()&&R&&R.width&&R.height&&(H.contentRect=R),H}}]),H}(tM),GM=function(i){function H(R){return hR(this,H),CR(this,i.call(this,R))}return dR(H,i),H.prototype.setDataModel=function(i){var H=this,R=H._dataModel,M=H._selectionModel;R!==i&&(R&&(R.umm(H.handleDataModelChange,H),R.umd(H.handleDataPropertyChange,H),R.removeIndexChangeListener(H.handleIndexChange,H),M||R.sm().ums(H.handleSelectionChange,H)),H._dataModel=i,i.mm(H.handleDataModelChange,H),i.md(H.handleDataPropertyChange,H),i.addIndexChangeListener(H.handleIndexChange,H),M?M._setDataModel(i):i.sm().ms(H.handleSelectionChange,H),H.fp("dataModel",R,i))},H.prototype.handleIndexChange=function(i){this.ivm()},H.prototype.handleDataPropertyChange=function(i){this.invalidateData(i.data)},H.prototype.validateModel=function(){var i=this;i._rows.clear(),i._rowMap={};var H=i._rows=i._dataModel.toDatas(i.isVisible,i),R=0,M=i.getCurrentSortFunc(),I=H.size();for(M&&H.sort(M);R<I;R++)i._rowMap[H.get(R)._id]=R},H}(eR),kM=function(i){function H(R,M){var I=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];hR(this,H);var p=CR(this,i.call(this,M));return p.editor=R,p.editable=I,p.addTopPainter(p.drawDNDState.bind(p)),p}return dR(H,i),H.prototype.getLabelColor=function(H){return H!==this.draggingData||this.isSelected(H)?H.s("2d.visible")&&H.s("3d.visible")?i.prototype.getLabelColor.call(this,H):KR.config.color_disabled:KR.config.color_select},H.prototype.isEditable=function(i){return this.editable},H.prototype.handleDelete=function(){this.editable&&this.removeSelection()},H.prototype.handleDataDoubleSelect=function(i,H){if(this.isEditable(H)){var R=this.getIcon(H)?this.getIndent():0;this.lp(i).x>R&&this.beginEditing(H)}},H.prototype.rename=function(i,H){i.setName(H)},H.prototype.isDroppable=function(i,H){return!1},H.prototype._clearDragInfo=function(){this.editor.dnd.hideTip(),this._dragInfo&&(this._dragInfo=null,this.redraw())},H.prototype._endDrag=function(i,H){},H.prototype._endCrossDrag=function(i,H){},H.prototype.drawDNDState=function(i){KR.config.drawDNDState?i.drawDNDState=!0:(KR.config.texureImage3D&&(i.texureImage3D=!0),i.texureImage2D=!0);var H=void 0;if(this._dragInfo&&this._dragInfo.inView?H=this._dragInfo:this._crossDragInfo&&(H=this._crossDragInfo),H){var R=this.getWidth(),M=(this.getRowHeight(),H.type,KR.config.color_select_dark);if(H.refData){var I=H.y;i.beginPath(),i.arc(4,I,3,0,2*Math.PI,!0),i.moveTo(7,I),i.lineTo(R,I),i.lineWidth=2,i.strokeStyle=M,i.stroke()}else{var p=this.getViewRect();L(i,M,p.x,p.y,p.width,p.height,2)}}},H.prototype._dragging=function(i,H){var R=this.getRowHeight(),M=this.lp(i),I=M.y/R,p=Math.floor(I);p>this.getRowSize()-1||p<0?(H.refData=null,H.type=null,H.parent=null):(H.refData=this.getRowDatas().get(p),M.y-p*R<.5*R?(H.type="up",H.y=p*R):(H.type="down",H.y=(p+1)*R)),this.autoScroll(i),this.redraw()},H.prototype.$1$=function(){var i="";if(this.draggingData&&(i=this.getLabel(this.draggingData),this.isSelected(this.draggingData))){var H=this.sm().size();i+=H>1?" (+"+H+") ":""}return i},H.prototype.handleDragAndDrop=function(i,H){if(this.editable){if("prepare"===H)return void this._clearDragInfo();"begin"===H&&(this._dragInfo={tip:this.$1$(),view:this});var R=this._dragInfo;if(R){var M=this.editor.dnd;if("begin"===H||"between"===H){return this.getView().contains(n(i))?(R.inView=!0,this._dragging(i,R),M.clearDropView(i,R)):(R.inView&&this.redraw(),R.inView=!1,M.crossDrag(i,R)),void M.showTip(R.tip,i)}
return"end"===H?(R.inView?this._endDrag(i,R):M.crossDrop(i,R),void this._clearDragInfo()):"cancel"===H?(R.inView||M.crossCancel(i,R),void this._clearDragInfo()):void 0}}},H.prototype.handleCrossDrag=function(i,H,R){if(this.editable)return"exit"===H||"cancel"===H?(this._crossDragInfo=null,void this.redraw()):"enter"===H||"over"===H?(this._crossDragInfo||(this._crossDragInfo={}),void this._dragging(i,this._crossDragInfo)):"drop"===H?(this._endCrossDrag(i,R),this._crossDragInfo=null,void this.redraw()):void 0},H.prototype.beginEditing=function(i){var H=this;this.cancelEditing(),this.makeVisible(i),this.validate();var R=this.getIcon(i)?this.getIndent():0,M=this.ty()+this.getRowIndex(i)*this.getRowHeight(),I=Math.max(1,this.getWidth()-R),p=this.getRowHeight();this._currentEditor=new ht.widget.TextField,this._currentEditor.data=i;var h=this._currentEditor.getElement(),z=this.getLabel(i);h.value=null==z?"":z,h.onblur=function(i){H.endEditing()},h.onkeydown=function(i){O(i)?H.endEditing():c(i)&&H.cancelEditing()},this.getView().appendChild(this._currentEditor.getView()),x(this._currentEditor,R,M,I,p),this._currentEditor.setFocus(),ht.Default.callLater(h.select,h)},H.prototype.endEditing=function(){var i=this._currentEditor;i&&(this.rename(i.data,i.getValue()),delete this._currentEditor,Y(i.getView()),this.redraw())},H.prototype.cancelEditing=function(){var i=this._currentEditor;i&&(delete this._currentEditor,Y(i.getView()),this.redraw())},H}(GM),PM=function(i){function H(R){hR(this,H);var M=CR(this,i.call(this,R.editor,R.dm));return M.symbolView=R,M.graphView=R.graphView,M.nodeIcon=gi(M),M.initMenu(),M.initStudio&&M.initStudio(),R.dm.addDataPropertyChangeListener(function(i){i.data.editorIcon=null}),M}return dR(H,i),H.prototype.getToolTip=function(i){return KR.config.getToolTip(i,this)},H.prototype.onDataDoubleClicked=function(i,H){this.editor.fitSelection()},H.prototype.onPropertyChanged=function(H){"filter"===H.property&&this.ivm(),i.prototype.onPropertyChanged.call(this,H)},H.prototype.handleDataPropertyChange=function(H){!this._filter||"displayName"!==H.property&&"s:text"!==H.property&&"s:type"!==H.property&&"s:image"!==H.property?i.prototype.handleDataPropertyChange.call(this,H):this.ivm()},H.prototype.isVisible=function(i){if("__renderHTML__"===i.getTag())return!1;if(!this._filter)return!0;var H=this.getVisibleFunc();if(H&&!H(i))return!1;if(KR.config.symbolListVisibleFunc)return KR.config.symbolListVisibleFunc(i,this._filter);var R=this.getLabel(i),M=(this._filter+"").toLowerCase();return null!=R&&(R=(R+"").toLowerCase(),R.indexOf(M)>=0)},H.prototype.validate=function(){this.graphView.validate(),i.prototype.validate.call(this)},H.prototype.validateModel=function(){var H=this;i.prototype.validateModel.call(this),KR.config.filterSymbolViewEnabled&&this.graphView.setVisibleFunc(function(i){return H.isVisible(i)})},H.prototype.getIcon=function(i){return i instanceof xR?"editor.restore.state":i instanceof ht.Text?i.getIcon():i instanceof ht.Shape?(i.editorIcon||(i.editorIcon=Li(i)),i.editorIcon):i instanceof ht.Node?this.nodeIcon:null},H.prototype.isDroppable=function(i,H){return!1},H.prototype._endCrossDrag=function(i,H){},H.prototype._endDrag=function(i,H){var R=this;this.editor.beginTransaction();var M=H.type,I=H.refData;if(this.isSelected(this.draggingData)){var p=this.getRowOrderSelection();"down"===M&&p.reverse(),p.each(function(i){R._dropData(i,M,I)})}else this._dropData(this.draggingData,M,I),this.sm().ss(this.draggingData);this.editor.endTransaction()},H.prototype._dropData=function(i,H,R){if(R){var M=this.dm().getDatas(),I=M.indexOf(R);"down"===H&&I++,M.indexOf(i)<I&&I--,this.dm().moveToIndex(i,I)}else this.dm().bringToFront(i)},H.prototype.rename=function(i,H){i.setDisplayName(H)},H.prototype.initMenu=function(){this.menu=new YR;var i=[];this.initMenuItems(i),this.menu.setItems(i),this.menu.addTo(this.getView()),this.editor.menus.push(this.menu)},H.prototype.onClosed=function(){C(this.editor.menus,this.menu)},H.prototype.initMenuItems=function(i){var H=this;i.push.apply(i,[{id:"copy",label:p("editor.copy"),action:function(){H.editor.copy()},visible:function(){return!!H.editor.ld}},{id:"paste",label:p("editor.paste"),action:function(){H.editor.paste()},visible:function(){return H.editable&&H.editor.hasCopyInfo()}},{id:"delete",label:p("editor.delete"),action:function(){H.editor.delete()},visible:function(){return H.editable&&!!H.editor.ld}},"separator",{id:"bringToFront",label:p("editor.bringtofront"),action:function(){H.editor.bringToFront()},visible:function(){return H.editable&&!!H.editor.ld}},{id:"bringForward",label:p("editor.bringforward"),action:function(){H.editor.bringForward()},visible:function(){return H.editable&&!!H.editor.ld}},{id:"sendBackward",label:p("editor.sendbackward"),action:function(){H.editor.sendBackward()},visible:function(){return H.editable&&!!H.editor.ld}},{id:"sendToBack",label:p("editor.sendtoback"),action:function(){H.editor.sendToBack()},visible:function(){return H.editable&&!!H.editor.ld}}])},zR(H,[{key:"editable",get:function(){return this.editor.editable},set:function(i){}}]),H}(kM);ii(PM,{ms_ac:["filter"]});var ZM=function(i){function H(R){return hR(this,H),CR(this,i.call(this,R))}return dR(H,i),H.prototype.handleDataModelChange=function(H){i.prototype.handleDataModelChange.call(this,H),this.editor&&this.editor.fireViewEvent(this.editView,"DataModelChanged",{event:H})},H.prototype.handleDataModelPropertyChange=function(H){i.prototype.handleDataModelPropertyChange.call(this,H),this.editor&&this.editor.fireViewEvent(this.editView,"DataModelPropertyChanged",{event:H})},H.prototype.handleDataPropertyChange=function(H){i.prototype.handleDataPropertyChange.call(this,H),this.editor&&this.editor.fireViewEvent(this.editView,"DataPropertyChanged",{event:H})},H.prototype.isDroppable=function(i,H){if(this.editor.editable)return!!H.view.isDroppableToSymbolView},H.prototype.isPixelPerfect=function(i){return!0},H.prototype.initMenuItems=function(H){this.$56$(H),this.$55$(H),i.prototype.initMenuItems.call(this,H)},H.prototype.isVisible=function(H){var R=this.editor.symbolStatePane.currentState,M=this.getState(H);return(void 0===M||M===R)&&i.prototype.isVisible.call(this,H)},H.prototype.getState=function(i){var H=i.s("state");return H||this.editor.symbolStatePane.currentState},H}(oM),vM=function(i){function H(R,M,I){hR(this,H);var p=CR(this,i.call(this));return p.setIcon("editor.func"),p.setImage("editor.func"),p.parse(R,M,I),p}return dR(H,i),H.prototype.toLabel=function(){return this.getDisplayName()||p("editor.comptype.func")},H.prototype.getClass=function(){return H},H.prototype.parse=function(i,H,R){i&&(this.a("type",i.type),Ei(this,i,H,R))},H.prototype.toJSON=function(){var i={};return i.type=this.a("type"),_i(this,i),i},zR(H,[{key:"compType",get:function(){return"function"}}]),H}(ht.Node),aM=function(i){function H(R,M,I,p){hR(this,H);var h=CR(this,i.call(this));return h.newAdded=p,h.defaultValueMap={},h.parse(R,M,I),h}return dR(H,i),H.prototype.toLabel=function(){return this.getDisplayName()||this.s("type")||p("editor.comptype.comp")},H.prototype.getClass=function(){return H},H.prototype.getStyle=function(H,R){var M=i.prototype.getStyle.call(this,H,R);return void 0===M&&(M=this.defaultValueMap[H]),M},H.prototype.$60$=function(i){this.properties&&(this.properties=null),this.disableDirty=!0,this.defaultValueMap={};var H=this.s("type"),R=ht.Default.getCompType(H);if(R){this.newAdded&&R.events&&this._updateEvents(R.events),this.newAdded=void 0,this.$59$=null;var M={cache:R,width:{value:100,isSafeFunc:!0,func:function(i){return i._width}},height:{value:100,isSafeFunc:!0,func:function(i){return i._height}},comps:[{type:{func:function(i){return i.compType},isSafeFunc:!0}}]};if(!R.width||this._width>0||this.setWidth(R.width),!R.height||this._height>0||this.setHeight(R.height),R.properties){this.properties=R.properties;for(var I in this.properties){var p=this.properties[I];M.comps[0][I]={func:"style@"+I},xi(this,I,i?i[I]:void 0,p.defaultValue),this.defaultValueMap[I]=p.defaultValue}}var h=KR.config.customProperties.comp;h&&h.length&&h.forEach(function(i){var H=i.property;M.comps[0][H]={func:"style@"+H}}),this.setImage(M),this.ivLater()}else this.$59$=i,"editor.comp"!==this.getImage()&&(this.setImage("editor.comp"),this.ivLater());this.disableDirty=!1},H.prototype.ivLater=function(){var i=this;ht.Default.callLater(function(){i.disableDirty=!0,i.iv(),i.disableDirty=!1})},H.prototype.onStyleChanged=function(H,R,M){i.prototype.onStyleChanged.call(this,H,R,M),"type"===H&&(R&&(this.newAdded=!0),this.$60$(this.parsingComp))},H.prototype.parse=function(i,H,R){i&&(this.parsingComp=i,Ei(this,i,H,R),xi(this,"type",i.type),this.parsingComp=null)},H.prototype._updateEvents=function(i){var H=this;qR.forEach(function(i){return H.a(i,void 0)}),this.a(i)},H.prototype.toJSON=function(){var i={};if(vi(this,i,"type","type",void 0),_i(this,i),this.properties)for(var H in this.properties)vi(this,i,H,H,this.properties[H].defaultValue);return i},zR(H,[{key:"compType",get:function(){var i=this.s("type");return this.$59$?this.$60$(this.$59$):i&&ht.Default.getCompType(i)!==this.getImage().cache&&this.$60$(this.toJSON()),i}}]),H}(ht.Node),FM=function(i){function H(R,M,I){hR(this,H);var p=CR(this,i.call(this));return p.s({border_color:KR.config.color_dark,border_width:1}),p.setImage("border_image"),p.parse(R,M,I),p}return dR(H,i),H.prototype.getClass=function(){return H},H.prototype.toLabel=function(){return this.getDisplayName()||p("editor.comptype.border")},H.prototype.parse=function(i,H,R){i&&(xi(this,"type",i.type,"border"),xi(this,"border_color",i.color,KR.config.color_dark),xi(this,"border_width",i.width,1),Ei(this,i,H,R))},H.prototype.toJSON=function(){var i={};return vi(this,i,"type","type",void 0),vi(this,i,"border_color","color",void 0),vi(this,i,"border_width","width",void 0),_i(this,i),i},zR(H,[{key:"compType",get:function(){return this.s("type")}}]),H}(ht.Node),wM=function(i){function H(R,M,I){hR(this,H);var p=CR(this,i.call(this));return p.setSize(100,100),p.setImage("pieChart_image"),p.s({"chart.label":!1,"chart.label.color":ht.Default.labelColor,"chart.label.font":ht.Default.labelFont,"chart.hollw":!1,"chart.start.angle":0,"chart.values":[],"chart.colors":void 0}),p.parse(R,M,I),p}return dR(H,i),H.prototype.getClass=function(){return H},H.prototype.toLabel=function(){return this.getDisplayName()||p("editor.comptype.piechart")},H.prototype.parse=function(i,H,R){i&&(xi(this,"chart.type",i.type,"pieChart"),xi(this,"chart.label",i.label,!1),xi(this,"chart.label.color",i.labelColor,ht.Default.labelColor),xi(this,"chart.label.font",i.labelFont,ht.Default.labelFont),xi(this,"chart.hollow",i.hollow,!1),xi(this,"chart.start.angle",i.startAngle,0),xi(this,"chart.values",i.values,[]),xi(this,"chart.colors",i.colors,void 0),Ei(this,i,H,R))},H.prototype.toJSON=function(){var i={};return vi(this,i,"chart.type","type",void 0),vi(this,i,"chart.label","label",!1),vi(this,i,"chart.label.color","labelColor",ht.Default.labelColor),vi(this,i,"chart.label.font","labelFont",ht.Default.labelFont),vi(this,i,"chart.hollow","hollow",!1),vi(this,i,"chart.start.angle","startAngle",0),vi(this,i,"chart.values","values",[]),vi(this,i,"chart.colors","colors",void 0),_i(this,i),i},zR(H,[{key:"compType",get:function(){return this.s("chart.type")}}]),H}(ht.Node),BM=function(i){function H(R,M,I){hR(this,H);var p=CR(this,i.call(this));return p.setSize(100,100),p.setImage("columnChart_image"),p.s({"chart.label":!1,"chart.label.color":ht.Default.labelColor,"chart.label.font":ht.Default.labelFont,"chart.series":[],"chart.min.value":0,"chart.max.value":void 0}),p.parse(R,M,I),p}return dR(H,i),H.prototype.getClass=function(){return H},H.prototype.toLabel=function(){return this.getDisplayName()||p("editor.comptype.columnchart")},H.prototype.parse=function(i,H,R){i&&(xi(this,"chart.type",i.type,void 0),xi(this,"chart.label",i.label,!1),xi(this,"chart.label.color",i.labelColor,ht.Default.labelColor),xi(this,"chart.label.font",i.labelFont,ht.Default.labelFont),xi(this,"chart.series",i.series,[]),xi(this,"chart.min.value",i.minValue,0),xi(this,"chart.max.value",i.maxValue,void 0),Ei(this,i,H,R))},H.prototype.toJSON=function(){var i={};return vi(this,i,"chart.type","type",void 0),vi(this,i,"chart.label","label",!1),vi(this,i,"chart.label.color","labelColor",ht.Default.labelColor),vi(this,i,"chart.label.font","labelFont",ht.Default.labelFont),vi(this,i,"chart.series","series",[]),vi(this,i,"chart.min.value","minValue",0),vi(this,i,"chart.max.value","maxValue",void 0),_i(this,i),i},zR(H,[{key:"compType",get:function(){return this.s("chart.type")}}]),H}(ht.Node),EM=function(i){function H(R,M,I){hR(this,H);var p=CR(this,i.call(this));return p.setSize(100,100),p.setImage("lineChart_image"),p.s({"chart.label":!1,"chart.label.color":ht.Default.labelColor,"chart.label.font":ht.Default.labelFont,"chart.series":[],"chart.min.value":0,"chart.max.value":void 0,"chart.line.point":!1,"chart.line.width":2,"chart.line.3d":!1}),p.parse(R,M,I),p}return dR(H,i),H.prototype.getClass=function(){return H},H.prototype.toLabel=function(){return this.getDisplayName()||p("editor.comptype.linechart")},H.prototype.parse=function(i,H,R){i&&(xi(this,"chart.type",i.type,void 0),xi(this,"chart.label",i.label,!1),xi(this,"chart.label.color",i.labelColor,ht.Default.labelColor),xi(this,"chart.label.font",i.labelFont,ht.Default.labelFont),xi(this,"chart.series",i.series,[]),xi(this,"chart.min.value",i.minValue,0),xi(this,"chart.max.value",i.maxValue,void 0),xi(this,"chart.line.point",i.linePoint,!1),xi(this,"chart.line.width",i.lineWidth,2),xi(this,"chart.line.3d",i.line3d,!1),Ei(this,i,H,R))},H.prototype.toJSON=function(){var i={};return vi(this,i,"chart.type","type",void 0),vi(this,i,"chart.label","label",!1),vi(this,i,"chart.label.color","labelColor",ht.Default.labelColor),vi(this,i,"chart.label.font","labelFont",ht.Default.labelFont),vi(this,i,"chart.series","series",[]),vi(this,i,"chart.min.value","minValue",0),vi(this,i,"chart.max.value","maxValue",void 0),vi(this,i,"chart.line.point","linePoint",!1),vi(this,i,"chart.line.width","lineWidth",2),vi(this,i,"chart.line.3d","line3d",!1),_i(this,i),i},zR(H,[{key:"compType",get:function(){return this.s("chart.type")}}]),H}(ht.Node),_M={rect:FR,circle:FR,oval:FR,roundRect:FR,star:FR,triangle:FR,hexagon:FR,pentagon:FR,diamond:FR,rightTriangle:FR,parallelogram:FR,pentagram:FR,trapezoid:FR,polygon:FR,arc:FR,image:BR,shape:wR,text:ER,border:FM,pieChart:wM,oneDimensionalColumnChart:BM,columnChart:BM,percentageColumnChart:BM,stackedColumnChart:BM,lineChart:EM,comp:aM,clip:_R,restore:xR,endClip:xR};KR.toDatas=function(i,H){var R=[];return i.forEach(function(i){var M=WH(i);if(M){var I=eH(M),p=sH(I,H);if(p){if(R.push(p),i.attribs){var h={};i.attribs.forEach(function(i){var H=i.attr,R=h[H]||0;h[H]=R+1,R>0&&(H=H+"_"+R),p.a(H+".text",i.text);var M=i.startPoint;(i.halign||i.valign)&&(M=i.endPoint),p.a(H+".x",M.x),p.a(H+".y",M.y)})}}else R.push(null)}else R.push(null)}),R};var xM=function(i){function H(R,M,I,p,h,z){hR(this,H);var d=CR(this,i.call(this,R,M,ZM,"symbol",void 0,h,z));d.graphView.vectorDataBindingDisabled=!0,d.graphView.getLabel=function(){return null},d.graphView.setVisibleFunc(function(i){return!(i instanceof xR)}),d.list=d.symbolList=new PM(d),d.dm.a({name:void 0,comps:[],width:100,height:100,boundExtend:0,fitSize:!1,scrollable:!1,interactive:!1,disableSelectedBorder:!1,pixelPerfect:!0,clip:!1,visible:!0,color:void 0,blendMode:"multiply",opacity:1});var C=KR.config.customProperties.symbol;C&&C.length&&C.forEach(function(i){d.dm.a(i.property,i.defaultValue)}),d.dm.addIndexChangeListener(function(){d.dirty=!0}),d.dirty=!1,d.dm.enableHistoryManager(KR.config.maxUndoRedoSteps);var y=["a:renderHTML","a:width","a:height","f:dataBindings"];d.dm.mp(function(i){y.indexOf(i.property)>=0&&d.updateRenderNode()}),d.parse(I,p);var b=R.getFileNode(I);return d.editable=!b||!1!==b.a("editable"),I?p||d.editor.fireEvent("symbolViewOpening",{symbolView:d,url:I}):d.editor.fireEvent("symbolViewCreated",{symbolView:d,json:p}),d}return dR(H,i),H.prototype.clear=function(){this.dm.beginTransaction(),i.prototype.clear.call(this),this.dm.a("connectActionType",KR.config.symbolConnectActionType),this.dm.a("anchorEnabled",KR.config.symbolAnchorEnabled),this.dm.a("guideLineEnabled",KR.config.symbolGuideLineEnabled),this.dm.a("highlightEnabled",KR.config.symbolHighlightEnabled),this.dm.a("highlightColor",KR.config.symbolHighlightColor),this.dm.a("highlightBorderWidth",KR.config.symbolHighlightBorderWidth),this.dm.a("highlightBorderPattern",KR.config.symbolHighlightBorderPattern),this.dm.setAutoAdjustIndex(!1),this.dm.endTransaction()},H.prototype.resetGrid=function(){this.dm.beginTransaction(),this.dm.a("rulerEnabled",KR.config.symbolRulerEnabled),this.dm.a("gridEnabled",KR.config.symbolGridEnabled),this.dm.a("gridBlockSize",KR.config.symbolGridBlockSize),this.dm.a("gridThickLinesEvery",KR.config.symbolGridThickLinesEvery),this.dm.a("gridThickColor",KR.config.symbolGridThickColor),this.dm.a("gridLightColor",KR.config.symbolGridLightColor),this.dm.a("gridAngle",KR.config.symbolGridAngle),this.dm.a("gridRotation",KR.config.symbolGridRotation),this.dm.a("gridZoomThreshold",KR.config.symbolGridZoomThreshold),this.dm.a("alignmentGuideEnabled",KR.config.symbolGridAlignmentGuideEnabled),this.dm.a("alignmentGuideColor",KR.config.symbolGridAlignmentGuideColor),this.dm.endTransaction()},H.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.list.onClosed()},H.prototype.updateImpl=function(i,H){var R=this,M=this.dm,I=w(i),p=this.editor.symbolStatePane;p.symbolViewUpdating=!0,this.clear(),M.setBackground(I.background),M.a("previewURL",I.previewURL),M.a("snapshotURL",I.snapshotURL),M.dataBindings=I.dataBindings,this.attrObject=I.attrObject,M.a("xAlignmentGuides",I.xAlignmentGuides),M.a("yAlignmentGuides",I.yAlignmentGuides),null!=I.rulerEnabled&&M.a("rulerEnabled",I.rulerEnabled),null!=I.gridEnabled&&M.a("gridEnabled",I.gridEnabled),null!=I.gridBlockSize&&M.a("gridBlockSize",I.gridBlockSize),null!=I.gridThickLinesEvery&&M.a("gridThickLinesEvery",I.gridThickLinesEvery),null!=I.gridThickColor&&M.a("gridThickColor",I.gridThickColor),null!=I.gridLightColor&&M.a("gridLightColor",I.gridLightColor),null!=I.gridAngle&&M.a("gridAngle",I.gridAngle),null!=I.gridRotation&&M.a("gridRotation",I.gridRotation),null!=I.gridZoomThreshold&&M.a("gridZoomThreshold",I.gridZoomThreshold),null!=I.anchorEnabled&&M.a("anchorEnabled",I.anchorEnabled),null!=I.guideLineEnabled&&M.a("guideLineEnabled",I.guideLineEnabled),null!=I.highlightEnabled&&M.a("highlightEnabled",I.highlightEnabled),null!=I.highlightColor&&M.a("highlightColor",I.highlightColor),null!=I.highlightBorderWidth&&M.a("highlightBorderWidth",I.highlightBorderWidth),void 0!==I.highlightBorderPattern&&M.a("highlightBorderPattern",I.highlightBorderPattern),void 0!==I.alignmentGuideEnabled&&M.a("alignmentGuideEnabled",I.alignmentGuideEnabled),void 0!==I.alignmentGuideColor&&M.a("alignmentGuideColor",I.alignmentGuideColor),I.hasOwnProperty("connectActionType")&&M.a("connectActionType",I.connectActionType),qR.forEach(function(i){M.a(i,I[i])}),M.a({name:I.name,renderHTML:I.renderHTML,layoutAttach:I.layoutAttach,layoutProperties:I.layoutProperties,comps:$i(I.comps,[]),width:$i(I.width,100),height:$i(I.height,100),boundExtend:$i(I.boundExtend,0),fitSize:$i(I.fitSize,!1),scrollable:$i(I.scrollable,!1),interactive:$i(I.interactive,!1),disableSelectedBorder:$i(I.disableSelectedBorder,!1),pixelPerfect:$i(I.pixelPerfect,!0),clip:$i(I.clip,!1),visible:$i(I.visible,!0),color:$i(I.color,void 0),blendMode:$i(I.blendMode,"multiply"),opacity:$i(I.opacity,1),attachPoints:$i(I.attachPoints,void 0),attachStyle:$i(I.attachStyle,void 0),cacheRule:$i(I.cacheRule,!1),textureCache:$i(I.textureCache,!1),state:$i(I.state,void 0),stateEnum:$i(I.stateEnum,void 0),comps_func:li(I.comps),width_func:li(I.width),height_func:li(I.height),fitSize_func:li(I.fitSize),scrollable_func:li(I.scrollable),interactive_func:li(I.interactive),disableSelectedBorder_func:li(I.disableSelectedBorder),pixelPerfect_func:li(I.pixelPerfect),visible_func:li(I.visible),color_func:li(I.color),blendMode_func:li(I.blendMode),opacity_func:li(I.opacity),attachPoints_func:li(I.attachPoints),attachStyle_func:li(I.attachStyle),cacheRule_func:li(I.cacheRule),textureCache_func:li(I.textureCache),state_func:li(I.state)});var h=KR.config.customProperties.symbol;h&&h.length&&h.forEach(function(i){M.a(i.property,$i(I[i.property],i.defaultValue))}),M.a("comps").forEach(function(i){WH(i,R)}),p.symbolViewUpdating=!1,this.updateRenderNode(),this.dirty=!!H,!H&&KR.config.fitContentForSymbolView&&this.graphView.fitContent(KR.config.animate,KR.config.fitPadding),p.updateTable()},H.prototype.updateRenderNode=function(){if(KR.SceneView){var i=this.dm,H=i.a("renderHTML"),R=i.getDataByTag("__renderHTML__");if(!H)return void(R&&R.removeFromDataModel());var M={comps:[]};M.renderHTML=H,M.dataBindings=i.dataBindings,this.addValue(M,"width"),this.addValue(M,"height"),R||(R=new ht.Node,R.setTag("__renderHTML__"),R.s({"2d.selectable":!1}),this.dm.add(R)),R.setImage(M),R.setRect({x:0,y:0,width:M.width,height:M.height})}},H.prototype.addValue=function(i,H,R){var M=this.dm.a(H);Bi(i,H,this.dm.a(H+"_func"),M,R)},H.prototype.createInteractor=function(i,H,R){var M=this,I=_M[i];return"shape"===i?new fM(this.tab,null,function(R,p){var h={type:"shape",background:null,borderColor:KR.config.color_data_border,borderWidth:1};H&&H(h,R,p);var z=new I(h);return z.setPoints(R),z.setSegments(p),M.editor.fireEvent("compInited",{type:i,data:z,symbolView:M.editor.symbolView}),z},R):new NM(this.tab,null,function(R,h){var z=void 0;z="arc"===i?{type:i,rect:[R.x,R.y,R.width,R.height],background:KR.config.color_data_background,borderWidth:1,borderColor:KR.config.color_data_border,arcFrom:0,arcTo:4.1888}:"border"===i?{type:i,rect:[R.x,R.y,R.width,R.height],border:1,color:KR.config.color_data_border}:"text"===i?{type:i,rect:[R.x,R.y,R.width,R.height],text:p("editor.text")}:"comp"===i||"image"===i?h?{rect:[R.x+R.width/2,R.y+R.height/2,-1,-1]}:{rect:[R.x,R.y,R.width,R.height]}:"pieChart"===i?{type:"pieChart",values:[10,20,40,60,80],colors:["#7EB6EA","#434348","#93EB82","#F5A262","#8087E6"]}:"oneDimensionalColumnChart"===i?{type:"columnChart",series:[{values:[10,20,40,60,80],colors:["#7EB6EA","#434348","#93EB82","#F5A262","#8087E6"]}]}:"columnChart"===i?{type:"columnChart",series:[{values:[30,40,60,70,80],color:"#7EB6EA"},{values:[20,40,50,80,90],color:"#434348"}]}:"lineChart"===i?{type:"lineChart",series:[{values:[10,40,30,60,70],color:"#7EB6EA"}]}:{type:i,rect:[R.x,R.y,R.width,R.height],background:KR.config.color_data_background,borderWidth:1,borderColor:KR.config.color_data_border},H&&H(z,R,h);var d=new I(z);return M.editor.fireEvent("compInited",{type:i,data:d,symbolView:M.editor.symbolView}),d})},zR(H,[{key:"attrObject",set:function(i){var H=this.editor.rightBottomTabView.getTabModel().sm();this._attrObject=i,this.editor.dataViewTab&&H.co(this.editor.dataViewTab)&&this.editor.dataView.updateContent()},get:function(){return this._attrObject}},{key:"content",get:function(){var i=this,H=this.graphView.getEditInteractor(),R=(H.gridGuide,this.dm),M=this.attrObject,I={modified:(new Date).toString()};void 0!==M&&(I.attrObject=M),R.getBackground()&&(I.background=R.getBackground()),R.dataBindings&&(I.dataBindings=w(F(R.dataBindings),{ignoreDataModel:1})),R.a("previewURL")&&(I.previewURL=R.a("previewURL")),R.a("snapshotURL")&&(I.snapshotURL=R.a("snapshotURL")),R.a("connectActionType")!==KR.config.symbolConnectActionType&&(I.connectActionType=R.a("connectActionType")),R.a("rulerEnabled")!==KR.config.symbolRulerEnabled&&(I.rulerEnabled=R.a("rulerEnabled")),R.a("gridEnabled")!==KR.config.symbolGridEnabled&&(I.gridEnabled=R.a("gridEnabled")),R.a("gridBlockSize")!==KR.config.symbolGridBlockSize&&(I.gridBlockSize=R.a("gridBlockSize")),R.a("gridThickLinesEvery")!==KR.config.symbolGridThickLinesEvery&&(I.gridThickLinesEvery=R.a("gridThickLinesEvery")),R.a("gridThickColor")!==KR.config.symbolGridThickColor&&(I.gridThickColor=R.a("gridThickColor")),R.a("gridLightColor")!==KR.config.symbolGridLightColor&&(I.gridLightColor=R.a("gridLightColor")),R.a("gridAngle")!==KR.config.symbolGridAngle&&(I.gridAngle=R.a("gridAngle")),R.a("gridRotation")!==KR.config.symbolGridRotation&&(I.gridRotation=R.a("gridRotation")),R.a("gridZoomThreshold")!==KR.config.symbolGridZoomThreshold&&(I.gridZoomThreshold=R.a("gridZoomThreshold")),R.a("anchorEnabled")!==KR.config.symbolAnchorEnabled&&(I.anchorEnabled=R.a("anchorEnabled")),R.a("guideLineEnabled")!==KR.config.symbolGuideLineEnabled&&(I.guideLineEnabled=R.a("guideLineEnabled")),R.a("highlightEnabled")!==KR.config.symbolHighlightEnabled&&(I.highlightEnabled=R.a("highlightEnabled")),R.a("highlightColor")!==KR.config.symbolHighlightColor&&(I.highlightColor=R.a("highlightColor")),R.a("highlightBorderWidth")!==KR.config.symbolHighlightBorderWidth&&(I.highlightBorderWidth=R.a("highlightBorderWidth")),R.a("highlightBorderPattern")!==KR.config.symbolHighlightBorderPattern&&(I.highlightBorderPattern=R.a("highlightBorderPattern")),R.a("xAlignmentGuides")&&R.a("xAlignmentGuides").length&&(I.xAlignmentGuides=R.a("xAlignmentGuides")),R.a("yAlignmentGuides")&&R.a("yAlignmentGuides").length&&(I.yAlignmentGuides=R.a("yAlignmentGuides")),R.a("cacheRule")&&this.addValue(I,"cacheRule"),R.a("textureCache")&&this.addValue(I,"textureCache"),null!=R.a("alignmentGuideEnabled")&&R.a("alignmentGuideEnabled")!==KR.config.symbolGridAlignmentGuideEnabled&&(I.alignmentGuideEnabled=R.a("alignmentGuideEnabled")),R.a("alignmentGuideColor")&&R.a("alignmentGuideColor")!==KR.config.symbolGridAlignmentGuideColor&&(I.alignmentGuideColor=R.a("alignmentGuideColor")),R.a("stateEnum")&&R.a("stateEnum").length&&(I.stateEnum=R.a("stateEnum"),this.addValue(I,"state")),qR.forEach(function(i){R.a(i)&&(I[i]=R.a(i))}),R.a("renderHTML")&&(I.renderHTML=R.a("renderHTML")),R.a("layoutAttach")&&(I.layoutAttach=R.a("layoutAttach")),R.a("layoutProperties")&&(I.layoutProperties=R.a("layoutProperties")),this.addValue(I,"width"),this.addValue(I,"height"),this.addValue(I,"boundExtend",0),this.addValue(I,"fitSize",!1),this.addValue(I,"scrollable",!1),this.addValue(I,"interactive",!1),this.addValue(I,"disableSelectedBorder",!1),this.addValue(I,"pixelPerfect",!0),this.addValue(I,"name"),this.addValue(I,"clip",!1),this.addValue(I,"visible",!0),this.addValue(I,"color"),this.addValue(I,"blendMode","multiply"),this.addValue(I,"opacity",1),this.addValue(I,"attachPoints"),this.addValue(I,"attachStyle");var p=KR.config.customProperties.symbol,h=!!KR.config.saveSymbolCustomPropertyDefaultValue;p&&p.length&&p.forEach(function(H){h?i.addValue(I,H.property):i.addValue(I,H.property,H.defaultValue)});var z=[];return R.a("comps_func")?I.comps={values:z,func:R.a("comps_func")}:I.comps=z,R.each(function(i){"__renderHTML__"!==i.getTag()&&z.push(i.toJSON())}),I}}]),H}(tM),jM=function(i){function H(R){hR(this,H);var M=CR(this,i.call(this));M.editor=R,M.getTabModel().sm().ms(function(){var i=M.currentTab;M.editor.$5$(i),KR.config.uisVisible&&(i&&i._isUI?(i.getView().redraw(!0),R.mainSplitView.setStatus("cr")):i&&i.noInspector?R.mainSplitView.setStatus("cr"):R.mainSplitView.setStatus("normal"))});var I=function(){return!!M.getTabModel().size()};return M.menu=new YR([{id:"closeTab",label:p("editor.closetab"),action:function(){M.closeTab()},visible:I},{id:"closeOtherTabs",label:p("editor.closeothertabs"),action:function(){M.closeOtherTabs()},visible:I},{id:"closeTabsToTheRight",label:p("editor.closetabstotheright"),action:function(){M.closeTabsToTheRight()},visible:I},{separator:!0,visible:function(){return M._rightClickTab&&I()}},{id:"showInExplorer",label:p("editor.showinexplorer"),action:function(){var i=M._rightClickTab||M.currentTab;M.editor.selectFileNode(i.getTag())},visible:function(){return M._rightClickTab&&I()}}]),M.menu.beforeShow=function(i){M._rightClickTab=M.getTabAt(i)},M.menu.addTo(M.getTitleDiv()),M.editor.menus.push(M.menu),M.addTitleTipHandler(),M}return dR(H,i),H.prototype.drawCloseIcon=function(H,R,M,I){H.a("dirty")?(R.fillStyle=M,R.beginPath(),R.arc(I.x+I.width/2,I.y+I.height/2,3,0,2*Math.PI,!0),R.fill()):i.prototype.drawCloseIcon.call(this,H,R,M,I)},H.prototype.open=function(i){if(i){var H=i.fileType,R=H===OR,M=H===JR,I=H===NR,p=H===TR&&KR.SceneView;if(R||M||p||I){var h=i.url,z=this.getTabModel().getDataByTag(h);if(!z){if(KR.SceneView&&p&&this.hasTooManyOpenScenes())return;z=new ht.Tab,z.setTag(h),z.setClosable(!0),z.setName(B(i.getName())),z.a("uuid",i.uuid),R?(z.setIcon("editor.display"),new nM(this.editor,z,h,void 0,void 0,void 0,i.parent_uuid,i.root_dir)):M?(z.setIcon("editor.symbol"),new xM(this.editor,z,h,void 0,i.parent_uuid,i.root_dir)):p?(z.setIcon("editor.scene"),new KR.SceneView(this.editor,z,h,void 0,i.parent_uuid,i.root_dir)):I&&(z.setIcon("editor.ui-tab"),z._isUI=!0,new KR.UIView(this.editor,z,h,void 0,i.parent_uuid,i.root_dir)),this.editor.addTab(z)}this.getTabModel().sm().ss(z)}}},H.prototype.newDisplayView=function(i){var H=new ht.Tab;H.setClosable(!0),H.setIcon("editor.display"),H.setName(i||p("editor.untitled"));var R=new nM(this.editor,H);return this.editor.addTab(H,!0),R},H.prototype.newSymbolView=function(i){var H=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],R=new ht.Tab;R.setClosable(!0),R.setIcon("editor.symbol"),R.setName(i||p("editor.untitled"));var M=new xM(this.editor,R);return this.editor.addTab(R,!0),H&&this.editor.zoomToFit(),M},H.prototype.newUIView=function(i){var H=new ht.Tab;H._isUI=!0,H.setClosable(!0),H.setIcon("editor.ui-tab"),H.setName(i||p("editor.untitled"));var R=new KR.UIView(this.editor,H);return this.editor.addTab(H,!0),R},H.prototype.$99$=function(i){var H=this;this.getTabModel().each(function(R){if(!R._isUI){var M=R.getView(),I=M.graphView;I&&I.invalidateAll();var p=M.g3d;if(p){p.deleteTexture(i);var h=void 0,z=H.editor.getFileNode(i);z&&(h=z.getFileUUID(),p.deleteTexture(h)),p.dm().each(function(i){p.invalidateCachedTexture(i)}),p.invalidateAll()}}})},H.prototype.updateUIRefs=function(i){ht.ui&&delete ht.ui._uiRendererLoadedMap,this.getTabModel().each(function(H){if(H._isUI){H.getView().handleFileChanged(i)}})},H.prototype.reload=function(){this.currentTab&&this.currentTab.getView().reload()},H.prototype.save=function(i,H){this.currentTab&&this.currentTab.getView().save(i,H)},H.prototype.saveAll=function(i){var H=this.tabs,R=-1,M=function(){R++,R<H.length?H[R].getView().save(M):i()};M()},H.prototype.preview=function(){this.currentTab&&this.currentTab.getView().preview()},H.prototype.selectTab=function(i){i&&this.getTabModel().sm().ss(i)},H.prototype.onTabClosing=function(i,H){return this.closeTab(i),!1},H.prototype.closeTab=function(i,H,R){(i=i||this._rightClickTab||this.currentTab)&&this.closeTabs([i],H,R)},H.prototype.closeOtherTabs=function(i,H){var R=this._rightClickTab||this.currentTab;this.closeTabs(this.tabs.filter(function(i){return i!==R}),i,H)},H.prototype.closeTabsToTheRight=function(i,H){var R=this._rightClickTab||this.currentTab;if(R){var M=this.tabs.indexOf(R);this.closeTabs(this.tabs.slice(M+1),i,H)}},H.prototype.closeAllTabs=function(i,H){this.closeTabs(this.tabs,i,H)},H.prototype.closeTabs=function(i,H,R){var M=this,I=void 0,p=function(h){if("cancel"!==h&&i.length){var z=i.shift(0);void 0===I&&(I=M.tabs.indexOf(z)-1),M.$65$(z,p,R)}else{H&&H();var d=M.tabs.length;!M.currentTab&&d&&((void 0===I||I<0)&&(I=0),I>d-1&&(I=d-1),M.selectTab(M.tabs[I]))}};p(),this._rightClickTab=null},H.prototype.removeTab=function(i){var H=i.getView(),R={url:H.url};this.editor.fireViewEvent(H,"Closing",R),R.preventDefault||(H.onClosed(),this.getTabModel().remove(i),this.editor.fireEvent("tabClosed",{tab:i}),this.editor.fireViewEvent(H,"Closed",R))},H.prototype.$65$=function(i,H,R){var M=this,I=i.getView();if(!R&&I.dirty&&I.editable){var h={tab:i};if(this.editor.fireEvent("tabPrompting",h),
"notSave"===h.action)this.removeTab(i),H&&H("notSave");else if("save"===h.action)I.save(function(){M.removeTab(i),H&&H("save")});else if("cancel"===h.action)H&&H("cancel");else{var z=[{label:p("editor.notsave"),action:function(){d.hide(),M.removeTab(i),H&&H("notSave")}},{label:p("editor.save"),action:function(){I.save(function(){d.hide(),M.removeTab(i),H&&H("save")})}},{label:p("editor.cancel"),action:function(){d.hide(),H&&H("cancel")}}],d=new yR({title:i.getName(),contentPadding:20,width:260,draggable:!0,content:'<p style="color: '+ht.Default.labelColor+'">'+p("editor.savechange")+"</p>",buttons:z});d.$48$=z[2].action,d.$47$=z[1].action,d.show(this.editor.$38$)}}else this.removeTab(i),H&&H()},H.prototype.addTitleTipHandler=function(){},zR(H,[{key:"currentTab",get:function(){return this.getTabModel().sm().ld()}},{key:"tabs",get:function(){return this.getTabModel().getRoots().toArray()}}]),H}(lR),YM=function(i){function H(R){hR(this,H);var M=CR(this,i.call(this));M.setHPadding(8),M.editor=R,M.buttons={};var I=M._items=[];return M.addAlignItems(I),M.addSearchItem(I),M.addLastItem(I),M.updateItems(),M}return dR(H,i),H.prototype.addAlignItems=function(i){i.push(this.createItem("distributeHorizontal")),i.push(this.createItem("distributeVertical")),i.push(this.createItem("alignLeft")),i.push(this.createItem("alignHorizontal")),i.push(this.createItem("alignRight")),i.push(this.createItem("alignTop")),i.push(this.createItem("alignVertical")),i.push(this.createItem("alignBottom"))},H.prototype.addLastItem=function(i){var H=22,R=[H,H,H,H,H,H,H,H,.1];y(KR.config.compactFilter)||(this.addCompactItem(i),R.push(H)),this.addRow(i,R)},H.prototype.createItem=function(i){var H=this,R="editor.align."+i.toLocaleLowerCase();return this.buttons[i]=IH(null,p(R),R,function(){H[i]()})},H.prototype.updateItems=function(){var i=this.buttons;if(this.dataModel){var H=this.selection;H.length>2?(i.distributeHorizontal.setDisabled(!1),i.distributeVertical.setDisabled(!1),i.alignLeft.setDisabled(!1),i.alignHorizontal.setDisabled(!1),i.alignRight.setDisabled(!1),i.alignTop.setDisabled(!1),i.alignVertical.setDisabled(!1),i.alignBottom.setDisabled(!1)):H.length>1?(i.distributeHorizontal.setDisabled(!0),i.distributeVertical.setDisabled(!0),i.alignLeft.setDisabled(!1),i.alignHorizontal.setDisabled(!1),i.alignRight.setDisabled(!1),i.alignTop.setDisabled(!1),i.alignVertical.setDisabled(!1),i.alignBottom.setDisabled(!1)):(i.distributeHorizontal.setDisabled(!0),i.distributeVertical.setDisabled(!0),i.alignLeft.setDisabled(!0),i.alignHorizontal.setDisabled(!0),i.alignRight.setDisabled(!0),i.alignTop.setDisabled(!0),i.alignVertical.setDisabled(!0),i.alignBottom.setDisabled(!0))}else i.distributeHorizontal.setDisabled(!0),i.distributeVertical.setDisabled(!0),i.alignLeft.setDisabled(!0),i.alignHorizontal.setDisabled(!0),i.alignRight.setDisabled(!0),i.alignTop.setDisabled(!0),i.alignVertical.setDisabled(!0),i.alignBottom.setDisabled(!0)},H.prototype.$5$=function(i){if(this.dataModel&&this.dataModel.sm().ums(this.updateItems,this),this.editor.hasInspector(i)){var H=i.getView();this.dataModel=H.dm,this.dataModel.sm().ms(this.updateItems,this)}else this.dataModel=null;this.updateItems()},H.prototype.getUnionRect=function(i){return this.editor.gv?this.editor.gv.getUnionNodeRect(i):null},H.prototype.isSelected=function(i){return this.dataModel&&this.dataModel.sm().contains(i)},H.prototype.hasSelectedGroupParent=function(i){return i instanceof ht.Group&&(!!this.isSelected(i)||this.hasSelectedGroupParent(i.getParent()))},H.prototype.hasSelectedHost=function(i){var H=this,R=function(M){return M!==i&&(M instanceof ht.Node&&(!!H.isSelected(M)||R(M.getHost())))};return R(i.getHost())},H.prototype.distributeHorizontal=function(){if(this.editor.editable){this.editor.beginTransaction();var i=this.editor.gv,H=this.selection,R=this.getUnionRect(H);if(i&&R){H.sort(function(H,R){return i.getNodeRect(H).x-i.getNodeRect(R).x});var M={},I=0;H.forEach(function(H){var R=i.getNodeRect(H);M[H._id]=R,I+=R.width});var p=(R.width-I)/(H.length-1),h=R.x;H.forEach(function(H){var R=i.getNodeRect(H);H.translate(h-R.x,0),h+=R.width+p})}this.editor.endTransaction()}},H.prototype.distributeVertical=function(){if(this.editor.editable){this.editor.beginTransaction();var i=this.editor.gv,H=this.selection,R=this.getUnionRect(H);if(i&&R){H.sort(function(H,R){return i.getNodeRect(H).y-i.getNodeRect(R).y});var M={},I=0;H.forEach(function(H){var R=i.getNodeRect(H);M[H._id]=R,I+=R.height});var p=(R.height-I)/(H.length-1),h=R.y;H.forEach(function(H){var R=i.getNodeRect(H);H.translate(0,h-R.y),h+=R.height+p})}this.editor.endTransaction()}},H.prototype.alignLeft=function(){if(this.editor.editable){this.editor.beginTransaction();var i=this.editor.gv,H=this.selection,R=this.getUnionRect(H);i&&R&&H.forEach(function(H){var M=i.getNodeRect(H);H.translate(R.x-M.x,0)}),this.editor.endTransaction()}},H.prototype.alignHorizontal=function(){if(this.editor.editable){this.editor.beginTransaction();var i=this.editor.gv,H=this.selection,R=this.getUnionRect(H);i&&R&&H.forEach(function(H){var M=i.getNodeRect(H);H.translate(R.x+R.width/2-M.x-M.width/2,0)}),this.editor.endTransaction()}},H.prototype.alignRight=function(){if(this.editor.editable){this.editor.beginTransaction();var i=this.editor.gv,H=this.selection,R=this.getUnionRect(H);i&&R&&H.forEach(function(H){var M=i.getNodeRect(H);H.translate(R.x+R.width-M.x-M.width,0)}),this.editor.endTransaction()}},H.prototype.alignTop=function(){if(this.editor.editable){this.editor.beginTransaction();var i=this.editor.gv,H=this.selection,R=this.getUnionRect(H);i&&R&&H.forEach(function(H){var M=i.getNodeRect(H);H.translate(0,R.y-M.y)}),this.editor.endTransaction()}},H.prototype.alignVertical=function(){if(this.editor.editable){this.editor.beginTransaction();var i=this.editor.gv,H=this.selection,R=this.getUnionRect(H);i&&R&&H.forEach(function(H){var M=i.getNodeRect(H);H.translate(0,R.y+R.height/2-M.y-M.height/2)}),this.editor.endTransaction()}},H.prototype.alignBottom=function(){if(this.editor.editable){this.editor.beginTransaction();var i=this.editor.gv,H=this.selection,R=this.getUnionRect(H);i&&R&&H.forEach(function(H){var M=i.getNodeRect(H);H.translate(0,R.y+R.height-M.y-M.height)}),this.editor.endTransaction()}},H.prototype.addSearchItem=function(i){var H=this;this.searchField=new ht.widget.TextField;var R=this.searchField.getElement();R.onkeyup=function(i){c(i)&&(R.value=""),H.editor.filterProperties()},i.push(this.searchField)},H.prototype.addCompactItem=function(i){var H=this,R=pH("editor.filter",function(){return KR.config.commonAndAdvancedFilterMode?!H.editor.inspectorCompact:H.editor.inspectorCompact}),M=function(){H.editor.inspectorCompact=!H.editor.inspectorCompact},I=p(KR.config.commonAndAdvancedFilterMode?"editor.commonadvanced":"editor.compactdetail");i.push(IH(null,I,R,M))},zR(H,[{key:"selection",get:function(){var i=this,H=[];return this.dataModel&&this.dataModel.sm().each(function(R){R instanceof ht.Node&&(i.hasSelectedGroupParent(R.getParent())||i.hasSelectedHost(R)||H.push(R))}),H}},{key:"filter",get:function(){return this.searchField.getElement().value}}]),H}(bR),rM=function(i){function H(R){hR(this,H);var M=CR(this,i.call(this));return M.editor=R,M.initForm(),M.visible=!1,M.$5$(),M.oopsImageJSON=ht.Default.getImage("editor.oops"),M.oopsImage=ht.Default.toCanvas(M.oopsImageJSON,M.oopsImageJSON.width,M.oopsImageJSON.height,"fill",null,null,null,ht.Default.devicePixelRatio).toDataURL(),M}return dR(H,i),H.prototype.initForm=function(){var i=this,H=this.codeEditor=new UR({language:"json",lineNumbers:"off",readOnly:!0,minimap:{enabled:!1}});this.addRow([{id:"content",element:H}],[.1],.1),this.addRow([{id:"url",textField:{editable:!1}},{id:"edit",button:{onClicked:function(){i.editor.editable&&(i.editing=!i.editing)}}},{id:"commit",button:{label:p("editor.commit"),onClicked:function(){i.commit()}}}],[.1,50,50]),this.getView().style.background=KR.config.color_pane,this.editing=!1},H.prototype.commit=function(){this.editor.editable&&(this.currentView.update(this.content,!0),this.editing=!1)},H.prototype.$66$=function(i){var H=this;this.visible&&!this.editing&&(i&&"*"===i.property||(this._updateContentLater&&clearTimeout(this._updateContentLater),this._updateContentLater=setTimeout(function(){H.updateContent()},100)))},H.prototype.updateContent=function(){this.visible&&!this.editing&&(this._updateContentLater=null,this.content=this.currentView?F(this.currentView.content,void 0,!1):"")},H.prototype.updateUrl=function(){this.v("url",this.tab&&this.tab.getTag()||"")},H.prototype.$5$=function(i){this.editing=!1,this.dataModel&&(this.dataModel.removeDataModelChangeListener(this.$66$,this),this.dataModel.removeDataPropertyChangeListener(this.$66$,this),this.dataModel.removePropertyChangeListener(this.$66$,this)),this.editor.hasInspector(i)?(this.currentView=i.getView(),this.dataModel=this.currentView.dm,this.dataModel.addDataModelChangeListener(this.$66$,this),this.dataModel.addDataPropertyChangeListener(this.$66$,this),this.dataModel.addPropertyChangeListener(this.$66$,this),this.setDisabled(!1)):(this.currentView=null,this.dataModel=null,this.setDisabled(!0)),this.tab=i,this.updateUrl(),this.$66$()},zR(H,[{key:"editing",get:function(){return this._editing},set:function(i){this._editing!==i&&(this._editing=i,this.getViewById("edit").setLabel(p(i?"editor.cancel":"editor.edit")),this.getViewById("commit").setDisabled(!i),this.getViewById("content").setEditable(i),i||this.$66$())}},{key:"visible",get:function(){return this._visible},set:function(i){this._visible!==i&&(this._visible=i,i?this.updateContent():this.editing||(this.content=""))}},{key:"content",get:function(){return this.v("content")},set:function(i){this.setDisabled(!1),this.v("content",i)}}]),H}(bR);KR.DataView=rM;var eM=function(i){function H(R){hR(this,H);var M=CR(this,i.call(this));M.editor=R,M._emptyDataModel=new ht.DataModel,M.centerPane=new jR,M.setCenterView(M.centerPane),M.controlPane=new bR,M.controlPane.addRow([{id:"filter",textField:{}}],[.1,ht.Default.isTouchable?32:18]),M.setBottomView(M.controlPane),M.setBottomHeight(ht.Default.widgetRowHeight+8);var I=M.controlPane.getViewById("filter"),p=I.setValue;I.setValue=function(i){p.call(I,i),M.updateCenterView(i)};var h=!1,z=M.input=I.getElement();return z.addEventListener("compositionstart",function(){return h=!0}),z.addEventListener("compositionend",function(){h=!1,M.updateCenterView(z.value)}),z.addEventListener("keyup",function(i){!h&&M.list&&(c(i)&&(z.value=""),M.updateCenterView(z.value))}),M}return dR(H,i),H.prototype.$5$=function(i){this.tab=i,this.list=i?i.getView().list:null,this.controlPane.v("filter",this.list?this.list.getFilter()||"":"")},H.prototype.initFilterList=function(){var i=this._filterListView=new eR;i.setFilter=function(i){var H=this._filter;this._filter=i,this.fp("filter",H,i),this.ivm()},i.getFilter=function(){return this._filter},i.isVisible=function(i){if("__renderHTML__"===i.getTag())return!1;if(!this._filter)return!0;var H=this.getVisibleFunc();if(H&&!H(i))return!1;var R=this.getLabel(i);if(null==R)return!1;var M=(this._filter+"").toLowerCase();return R=(R+"").toLowerCase(),R.indexOf(M)>=0}},H.prototype.updateCenterView=function(i){var H=this.list;H&&(H instanceof AR&&i&&(H=this._filterListView),this.centerPane.getCenterView()!==H&&this.centerPane.setCenterView(H),this.list&&this.list.setFilter(i),H===this._filterListView&&this._filterListView.setFilter(i))},zR(H,[{key:"list",get:function(){return this._list},set:function(i){if(this._list=i,this.centerPane.setCenterView(i),!(i&&i instanceof AR))return void(this._filterListView&&this._filterListView.dm(this._emptyDataModel));this._filterListView||this.initFilterList(),this._filterListView.getLabel=i.getLabel,this._filterListView.getIcon=i.getIcon,this._filterListView.dm(i.dm())}}]),H}(jR),sM=function(i){function H(R){hR(this,H);var M=CR(this,i.call(this));M.editor=R,M._layerNames=[],M.setDisabled(!0),M.tableModel=new ht.DataModel,M.tablePane=new $R(M.tableModel),M.tableView=M.tablePane.getTableView(),M.tableView.setEditable(!0);var I=M.tableView.isCellEditable;return M.tableView.isCellEditable=function(){return!!R.editable&&I.apply(this,arguments)},M.tablePane.getView().style.border=KR.config.color_line+" solid 1px",M.tablePane.addColumns([M.$73$("name",p("editor.name"),100),M.$73$("visible",p("editor.visible"),50),M.$73$("selectable",p("editor.selectable"),50),M.$73$("movable",p("editor.movable"),50),M.$73$("editable",p("editor.editable"),50)]),M.addRow([M.tablePane],[.1],.1),M.addRow([{button:{icon:"editor.add",toolTip:p("editor.add"),onClicked:function(){M.editor.editable&&(M.addLayer(ht.Data.prototype._layer,!0,!0,!0,!0),M.updateLayers())}}},{button:{icon:"editor.delete",toolTip:p("editor.delete"),onClicked:function(){M.editor.editable&&M.tableView.sm().size()&&(M.dataModel.beginTransaction(),M.removeSelectionLayers(),M.updateLayers(),M.dataModel.endTransaction())}}},null,{button:{icon:"editor.top",toolTip:p("editor.bringtofront"),onClicked:function(){M.editor.editable&&M.tableView.sm().size()&&(M.tableModel.moveSelectionToTop(),M.updateLayers())}}},{button:{icon:"editor.up",toolTip:p("editor.bringforward"),onClicked:function(){M.editor.editable&&M.tableView.sm().size()&&(M.tableModel.moveSelectionUp(),M.updateLayers())}}},{button:{icon:"editor.down",toolTip:p("editor.sendbackward"),onClicked:function(){M.editor.editable&&M.tableView.sm().size()&&(M.tableModel.moveSelectionDown(),M.updateLayers())}}},{button:{icon:"editor.bottom",toolTip:p("editor.sendtoback"),onClicked:function(){M.editor.editable&&M.tableView.sm().size()&&(M.tableModel.moveSelectionToBottom(),M.updateLayers())}}}],[20,20,.1,20,20,20,20]),M}return dR(H,i),H.prototype.addLayer=function(i,H,R,M,I){!1!==H&&(H=!0),!1!==R&&(R=!0),!1!==M&&(M=!0),!1!==I&&(I=!0);var p=new ht.Data;p.a({name:i,visible:H,selectable:R,movable:M,editable:I}),this.tableModel.add(p)},H.prototype.removeSelectionLayers=function(){var i=this.tableModel.sm().getSelection(),H=i.toArray().map(function(i){return i.a("name")});this.tableView.removeSelection();var R=this.currentLayer;this.dataModel.each(function(i){var M=i.getLayer();M!==R&&H.indexOf(M)>=0&&i.setLayer(R)})},H.prototype.$73$=function(i,H,R){var M=this;return{name:i,tag:i,accessType:"attr",width:R,displayName:H,align:"center",editable:!0,setValue:function(H,R,I){I!==H.a(i)&&(H.a(i,I),M.updateLayers())}}},H.prototype.$5$=function(i){this.dataModel&&this.dataModel.removePropertyChangeListener(this.handleDataModelPropertyChange,this);var H=this.editor.displayView||this.editor.sceneView;H?(this.dataModel=H.dm,this.dataModel.addPropertyChangeListener(this.handleDataModelPropertyChange,this),this.setDisabled(!1)):(this.dataModel=null,this.setDisabled(!0)),this.updateTable(),this.updateInspector()},H.prototype.handleDataModelPropertyChange=function(i){"layers"===i.property&&(this.updateTable(),this.updateInspector())},H.prototype.updateLayers=function(){if(this.dataModel){var i=this.tableModel.size()?[]:null;i&&this.tableModel.getRoots().forEach(function(H){i.push({name:H.a("name"),visible:H.a("visible"),selectable:H.a("selectable"),movable:H.a("movable"),editable:H.a("editable")})}),this.isSettingLayers=!0,this.dataModel.setLayers(i),this.isSettingLayers=!1,this.updateInspector()}},H.prototype.updateTable=function(){var i=this;if(!this.isSettingLayers&&(this.tableModel.clear(),this.dataModel)){var H=this.dataModel.getLayers();H&&H.forEach(function(H){Ni(H)?i.addLayer(H.name,H.visible,H.selectable,H.movable,H.editable):i.addLayer(H,!0,!0,!0,!0)})}},H.prototype.updateInspector=function(){var i=this;if(this.dataModel){var H=this.dataModel.getLayers(),R=this.editor.inspector;this._layerNames=[],H&&H.forEach(function(H){i._layerNames.push(Ni(H)?H.name:H)}),R&&(R.$34$(),R.filterPropertiesLater())}},zR(H,[{key:"currentLayer",get:function(){var i=this.tableModel.sm().ld();if(i)return i.a("name");var H=this.tableModel.getRoots();return H.size()?(i=H.get(H.size()-1),i.a("name")):ht.Data.prototype._layer}},{key:"layerNames",get:function(){return this._layerNames}}]),H}(bR),WM={},$M=function(i){function H(R){hR(this,H);var M=CR(this,i.call(this));M.editor=R,M.symbolViewUpdating=!1;var I=M.tableModel=new ht.DataModel,h=M.tablePane=new $R(I),z=M.tableView=h.getTableView();I.mm(M.handleUpdate,M),I.md(M.handleTableDataPropertyChange,M);var d=I.sm();d.setSelectionMode("single"),d.ms(M.handleTableSelectionChange,M);var C=z.getLabelColor;return z.getLabelColor=function(i){return!1===i.s("editable")?KR.config.color_disabled:C.call(this,i)},z.isEditable=function(){return R.editable},z.isCellEditable=function(i,H){return"isDefault"===H.getName()?R.editable:!1!==i.s("editable")&&R.editable},h.addColumns([{name:"stateName",displayName:p("editor.state"),accessType:"attr",editable:!0,valueType:"string",tag:"stateName"},{name:"stateDisplayName",displayName:p("editor.name"),accessType:"attr",editable:!0,valueType:"string",tag:"stateDisplayName"},{name:"isDefault",displayName:p("editor.default"),accessType:"attr",valueType:"boolean",editable:!0,width:48,setValue:function(i,H,R,I){M.setDefaultState(i.a("stateName"))}}]),h.addViewListener(function(i){if("beginValidate"===i.kind){var H=h.getColumnModel(),R=h.getWidth(),M=(R-80)/2;H.getDataByTag("stateName").setWidth(M),H.getDataByTag("stateDisplayName").setWidth(M)}}),M.addRow([M.tablePane],[.1],.1),M.addRow([{button:{icon:"editor.add",toolTip:p("editor.add"),onClicked:function(){if(M.editor.editable){var i=M.addState(null,null,!1,!0);M.tableModel.sm().ss(i)}}}},{button:{icon:"editor.delete",toolTip:p("editor.delete"),onClicked:function(){M.editor.editable&&M.removeState()}}},null,{button:{icon:"editor.top",toolTip:p("editor.bringtofront"),onClicked:function(){M.editor.editable&&M.tableView.sm().size()&&M.tableModel.moveSelectionToTop()}}},{button:{icon:"editor.up",toolTip:p("editor.bringforward"),onClicked:function(){M.editor.editable&&M.tableView.sm().size()&&M.tableModel.moveSelectionUp()}}},{button:{icon:"editor.down",toolTip:p("editor.sendbackward"),onClicked:function(){M.editor.editable&&M.tableView.sm().size()&&M.tableModel.moveSelectionDown()}}},{button:{icon:"editor.bottom",toolTip:p("editor.sendtoback"),onClicked:function(){M.editor.editable&&M.tableView.sm().size()&&M.tableModel.moveSelectionToBottom()}}}],[20,20,.1,20,20,20,20]),M._index=0,M}return dR(H,i),H.prototype.handleUpdate=function(){if(!this.updatingClear){var i=[],H=void 0;this.tableModel.each(function(R){var M=R.a("stateName");if(R.a("isDefault")&&(H=M),R.s("editable")){var I=R.a("stateDisplayName"),p={};p.value=M,I&&(p.label=I),i.push(p)}}),this.isSettingState=!0,this.editor.dm.a({stateEnum:i,state:H}),this.editor.inspector.filterPropertiesLater(),this.editor.inspector.updateProperties(),this.isSettingState=!1}},H.prototype.handleTableDataPropertyChange=function(i){if("a:stateName"!==i.property||this.renameRollback)this.handleUpdate();else{var H=i.oldValue,R=i.newValue;this.isStateExist(R,i.data)?(this.editor.showMessage(p("editor.statenameexist"),"error"),this.renameRollback=!0,i.data.a("stateName",H),this.renameRollback=!1):R?(this.editor.dm.each(function(i){H===i.s("state")&&i.s("state",R)}),this.handleUpdate(),this.editor.rightBottomTabView.iv()):(this.editor.showMessage(p("editor.statenameempty"),"error"),this.renameRollback=!0,i.data.a("stateName",H),this.renameRollback=!1)}},H.prototype.handleTableSelectionChange=function(){this.editor.symbolView&&(this.editor.rightBottomTabView.iv(),this.editor.symbolView.graphView.invalidateAll())},H.prototype.addState=function(i,H){var R=arguments.length>2&&void 0!==arguments[2]&&arguments[2],M=arguments[3],I=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],p=this.currentState,h=this.tableView.dm(),z=new ht.Data;if(!i){for(;this.isStateExist("state"+this._index);)this._index++;i="state"+this._index}if(z.a({stateName:i,isDefault:R,stateDisplayName:H}),z.s("editable",I),h.add(z),R&&h.sm().ss(z),M&&KR.config.isCopyCompsWhenNewState&&p){var d=this.dataModel.toDatas(function(i){return i.s("state")===p});if(d.size()){var C=this.dataModel.sm();C.cs(),d.each(function(i){C.as(i)}),this.editor.copy(),this.editor.paste(!0),C.each(function(H){H.s("state",i)})}}return z},H.prototype.removeState=function(){var i=this,H=this.tableModel.sm().ld();if(H&&H.s("editable")){var R=H.a("stateName"),M=this.editor.dm,I=M.toDatas(function(i){return R===i.s("state")}),h=I.size();h?this.editor.showConfirm(void 0,qH(p("editor.retaincompafterdelete"),R),function(){I.each(function(i){i.s("state",void 0)}),i.tableModel.remove(H)},function(){for(var R=h-1;R>=0;R--)M.remove(I.get(R));i.tableModel.remove(H)}):this.tableModel.remove(H)}},H.prototype.handleDataModelPropertyChange=function(i){"a:stateEnum"!==i.property&&"a:state"!==i.property||this.updateTable()},H.prototype.handleDataModelChange=function(i){var H=this.currentState;if(!this.symbolViewUpdating){if("add"===i.kind){var R=i.data.s("state");H?i.data.s("state",H):R&&!this.isStateExist(R)&&i.data.s("state",void 0)}this.updateTableLater()}},H.prototype.updateTable=function(){var i=this;if(!this.isSettingState&&this.dataModel){WM={},this.updatingClear=!0,this.tableModel.clear();var H=this.dataModel.a("state"),R=[];this.getNestState(this.editor.symbolView.content.comps,R),R.forEach(function(R){i.addState(R.value,R.label,R.value===H,!1,!1)});var M=this.dataModel.a("stateEnum");M&&M.forEach(function(R){WM[R.value]=1,i.addState(R.value,R.label,R.value===H)}),this.updatingClear=!1}},H.prototype.updateTableLater=function(){var i=this;setTimeout(function(){i.updateTable()},100)},H.prototype.getNestState=function(i,H){var R=this;i.forEach(function(i){if("image"===i.type){var M=ht.Default.getImage(i.name);if(M&&M.comps){var I=M.stateEnum;I&&I.forEach(function(i){H.push(i),WM[i.value]=1}),R.getNestState(M.comps,H)}else if(!M)return void R.updateTableLater()}})},H.prototype.isStateExist=function(i,H){for(var R=this.tableModel.toDatas(function(i){return i!==H}),M=R.size(),I=0;I<M;I++)if(i===R.get(I).a("stateName"))return!0},H.prototype.setDefaultState=function(i){this.tableModel.each(function(H){H.a("isDefault",H.a("stateName")===i)})},H.prototype.$5$=function(i){var H=this;this.dataModel&&(this.dataModel.ump(this.handleDataModelPropertyChange,this),this.dataModel.umm(this.handleDataModelChange,this),this.dataModel._lastState=this.currentState);var R=this.editor.symbolView;if(R?(this.dataModel=R.dm,this.dataModel.mp(this.handleDataModelPropertyChange,this),this.dataModel.mm(this.handleDataModelChange,this)):this.dataModel=null,this.updateTable(),R){var M=this.dataModel._lastState;void 0!==M?this.tableModel.each(function(i){i.a("stateName")===M&&H.tableModel.sm().ss(i)}):this.tableModel.sm().cs()}},H.prototype.getAllStateEnum=function(){var i=[];return this.tableModel.each(function(H){var R=H.a("stateName"),M=H.a("stateDisplayName"),I={};I.value=R,M&&(I.label=M),i.push(I)}),i},zR(H,[{key:"currentState",get:function(){var i=this.tableModel.sm().ld();return i?i.a("stateName"):void 0}}]),H}(bR),lM=function(i){function H(R){hR(this,H);var M=CR(this,i.call(this));return M.editor=R,M.editor.menus.push(M),M.setItems(M.createItems()),M}return dR(H,i),H.prototype.createItems=function(){return[{id:"file",label:p("editor.file"),items:[this.createItem("newDisplayView",p("editor.newdisplayview"),"newDisplayView",KR.config.displaysVisible),this.createItem("newSymbolView",p("editor.newsymbolview"),"newSymbolView",KR.config.symbolsVisible),this.createItem("newComponent",p("editor.newcomponent"),"newComponent",KR.config.componentsVisible)]}]},H.prototype.createItem=function(i,H,R){var M=this,I=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],p={id:i,label:H,visible:!(!this.editor[R]||!I)};return R&&(p.action=function(){M.editor[R]()}),p},H}(YR),VM=function(i){function H(R){hR(this,H);var M=CR(this,i.call(this));return M.editor=R,M.initMenu(),M.$68$(),M.enableToolTip(),M}return dR(H,i),H.prototype.$5$=function(){this.iv()},H.prototype.initMenu=function(){var i=this;this.editor.mainMenu=new lM(this.editor);var H=function(H){var R=i.editor.mainMenu;R.isShowing()&&!R.getView().contains(H.target)&&R.hide()};window.addEventListener("touchstart",H,!1),window.addEventListener("mousedown",H,!1)},H.prototype.$68$=function(){var i=[];this.$67$(i),this.createEditItem(i),this.createDisplayItems(i),this.createSymbolItems(i),this.createSceneItems(i),this.setItems(i)},H.prototype.$67$=function(i){var H=this,R=RH("menu",p("editor.menu"),"editor.menu");R.action=function(i,R,M){H.editor.mainMenu.isShowing()||(H.editor.mainMenu.showOnView(H,4,20),M.preventDefault(),M.stopPropagation())},i.push(R)},H.prototype.createEditItem=function(i){var H=this,R=function(){return H.editor.currentView&&"edit"===H.editor.currentView.$3$()},M=RH("edit",p("editor.edit"),"editor.edit",R);M.visible=function(){return(!H.editor.currentView||!H.editor.currentView.getPreferredSize)&&H.editor.editable},M.action=function(){var i=H.editor.currentView;i&&i.$4$("edit")},i.push(M)},H.prototype.createDisplayItems=function(i){var H=this,R=function(i){return function(R){"Node"===i||"SubGraph"===i||("Edge"===i?R.s({"edge.width":1,"edge.color":KR.config.color_data_border}):"Group"===i?R.setExpanded(!0):"arc"===i?R.s({shape:i,"shape.background":KR.config.color_data_background,"shape.border.width":1,"shape.border.color":KR.config.color_data_border,"shape.arc.from":0,"shape.arc.to":4.1888}):"Shape"===i?R.s({"shape.background":null,"shape.border.color":KR.config.color_data_border,"shape.border.width":1}):"Text"===i?R.s("text",p("editor.text")):R.s({shape:i,"shape.background":KR.config.color_data_background,"shape.border.width":1,"shape.border.color":KR.config.color_data_border})),H.editor.fireEvent("dataInited",{type:i,data:R,displayView:H.editor.displayView})}};i.push(this.editor.createDisplayItem("Shape",p("editor.shape"),"editor.display.shape",ht.Shape,R("Shape"))),i.push(this.editor.createDisplayItem("Oval",p("editor.oval"),"editor.display.oval",ht.Node,R("oval"))),i.push(this.editor.createDisplayItem("RoundRect",p("editor.roundrect"),"editor.display.roundrect",ht.Node,R("roundRect"))),i.push(this.editor.createDisplayItem("Rect",p("editor.rect"),"editor.display.rect",ht.Node,R("rect"))),i.push(this.editor.createDisplayItem("Polygon",p("editor.polygon"),"editor.display.polygon",ht.Node,R("polygon"))),i.push(this.editor.createDisplayItem("Triangle",p("editor.triangle"),"editor.display.triangle",ht.Node,R("triangle"))),i.push(this.editor.createDisplayItem("Star",p("editor.star"),"editor.display.star",ht.Node,R("star"))),i.push(this.editor.createDisplayItem("Arc",p("editor.arc"),"editor.display.arc",ht.Node,R("arc"))),i.push(this.editor.createDisplayItem("Text",p("editor.text"),"editor.display.text",ht.Text,R("Text"))),i.push(this.editor.createDisplayItem("Node",p("editor.node"),"editor.display.node",ht.Node,R("Node"))),i.push(this.editor.createDisplayItem("Group",p("editor.group"),"editor.display.group",ht.Group,R("Group"))),i.push(this.editor.createDisplayItem("SubGraph",p("editor.subgraph"),"editor.display.subgraph",ht.SubGraph,R("SubGraph"))),i.push(this.editor.createDisplayItem("Edge",p("editor.edge"),"editor.display.edge",ht.Edge,R("Edge")))},H.prototype.createSymbolItems=function(i){i.push(this.editor.createSymbolItem("shape",p("editor.shape"),"editor.symbol.shape","shape")),i.push(this.editor.createSymbolItem("oval",p("editor.oval"),"editor.symbol.oval","oval")),i.push(this.editor.createSymbolItem("roundRect",p("editor.roundrect"),"editor.symbol.roundrect","roundRect")),i.push(this.editor.createSymbolItem("rect",p("editor.rect"),"editor.symbol.rect","rect")),i.push(this.editor.createSymbolItem("polygon",p("editor.polygon"),"editor.symbol.polygon","polygon")),i.push(this.editor.createSymbolItem("triangle",p("editor.triangle"),"editor.symbol.triangle","triangle")),i.push(this.editor.createSymbolItem("star",p("editor.star"),"editor.symbol.star","star")),i.push(this.editor.createSymbolItem("arc",p("editor.arc"),"editor.symbol.arc","arc")),i.push(this.editor.createSymbolItem("text",p("editor.text"),"editor.symbol.text","text")),i.push(this.editor.createSymbolItem("border",p("editor.border"),"editor.symbol.border","border")),i.push(this.editor.createSymbolItem("piechart",p("editor.piechart"),"editor.symbol.piechart","pieChart")),i.push(this.editor.createSymbolItem("onedimensionalcolumnchart",p("editor.onedimensionalcolumnchart"),"editor.symbol.onedimensionalcolumnchart","oneDimensionalColumnChart")),i.push(this.editor.createSymbolItem("columnchart",p("editor.columnchart"),"editor.symbol.columnchart","columnChart")),i.push(this.editor.createSymbolItem("linechart",p("editor.linechart"),"editor.symbol.linechart","lineChart"))},H.prototype.createSceneItems=function(i){},H}(VR),AM=function(i){function H(R){hR(this,H);var M=CR(this,i.call(this));return M.editor=R,M.$68$(),M.enableToolTip(),M.setStickToRight(!0),M}return dR(H,i),H.prototype.handleGraphViewPropertyChange=function(i){"zoom"===i.property&&this.$69$()},H.prototype.handleDataModelPropertyChange=function(i){this.iv()},H.prototype.$69$=function(){this.label.innerHTML=this.graphView?parseInt(100*this.graphView.getZoom())+"%":""},H.prototype.$5$=function(i){if(this.dm&&this.dm.removePropertyChangeListener(this.handleDataModelPropertyChange,this),this.graphView&&this.graphView.removePropertyChangeListener(this.handleGraphViewPropertyChange,this),i){var H=i.getView();this.dm=H.dm,this.dm&&this.dm.addPropertyChangeListener(this.handleDataModelPropertyChange,this),this.graphView=H.graphView,this.isUI=i._isUI,this.graphView&&this.graphView.addPropertyChangeListener(this.handleGraphViewPropertyChange,this)}else this.dm=null,this.graphView=null,this.isUI=null;this.iv(),this.$69$()},H.prototype.$68$=function(){var i=this,H=void 0,R=function(){return!!i.graphView},M=function(){return!(!i.graphView&&!i.isUI)},I=[];H=RH("undo",p("editor.undo"),"editor.undo"),H.action=function(){i.editor.undo()},H.visible=M,I.push(H),H=RH("redo",p("editor.redo"),"editor.redo"),H.action=function(){i.editor.redo()},H.visible=M,I.push(H),I.push({separator:!0,visible:M}),KR.SceneView&&(H=RH("debug",p("editor.debug"),"editor.debug",function(){return i.editor.isDebugTipShowing()}),H.action=function(){i.editor.toggleDebugTip()},H.visible=R,I.push(H)),H=RH("rulers",p("editor.showrulers"),"editor.rulers",function(){return i.editor.isRulerEnabled()}),H.action=function(){i.editor.toggleRulerEnabled()},H.visible=R,I.push(H),H=RH("grid",p("editor.showgrid"),"editor.grid",function(){return i.editor.isGridEnabled()}),H.action=function(){i.editor.toggleGridEnabled()},H.visible=R,I.push(H),I.push({separator:!0,visible:R}),H=RH("save",p("editor.save"),"editor.save"),H.action=function(){i.editor.save()},H.visible=M,I.push(H),H=RH("preview",p("editor.preview"),"editor.preview"),H.action=function(){i.editor.preview()},H.visible=M,I.push(H),H=RH("reload",p("editor.reload"),"editor.reload"),H.action=function(){i.editor.reload()},H.visible=M,I.push(H),I.push({separator:!0,visible:M}),I.push(this.createZoomItem(R)),H=RH("zoomToFit",p("editor.zoomtofit"),"editor.zoomtofit"),H.action=function(){i.editor.zoomToFit()},H.visible=R,I.push(H),I.push({separator:!0,visible:R}),H=RH("toggleLeft",p("editor.toggleleft"),"editor.toggleleft"),H.action=function(){i.editor.toggleLeft()},I.push(H),H=RH("toggleRight",p("editor.toggleright"),"editor.toggleright"),H.action=function(){i.editor.toggleRight()},I.push(H),this.setItems(I)},H.prototype.createZoomItem=function(i){var H=this,R=this.label=ht.Default.createDiv(!0);R.style.font=this.getLabelFont(),R.style.color=this.getLabelColor(),R.style.cursor="ew-resize",R.style.width="40px",R.style.height=ht.Default.widgetRowHeight+"px",R.style.lineHeight=ht.Default.widgetRowHeight+"px",R.style.whiteSpace="nowrap",R.style.textAlign="center";var M=function(i){i.preventDefault();var R=H.editor.gv;if(R){N(i)&&H.editor.zoomReset();var M=R.getZoom(),I=f(i).x,p=function(i){i.preventDefault();var H=f(i).x-I;R.setZoom(M*(1+.005*H))}
;window.addEventListener("mousemove",p,!1),window.addEventListener("touchmove",p,!1);var h=function(i){i.preventDefault(),window.removeEventListener("mousemove",p,!1),window.removeEventListener("touchmove",p,!1),window.removeEventListener("mouseup",h,!1),window.removeEventListener("touchend",h,!1)};window.addEventListener("mouseup",h,!1),window.addEventListener("touchend",h,!1)}};return R.addEventListener("mousedown",M,!1),R.addEventListener("touchstart",M,!1),{id:"zoom",unfocusable:!0,element:R,visible:i}},H}(VR),gM=function(i){function H(){var R=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},M=R.functionName,I=R.functionValue,p=R.argList,h=R.codeEditorConfig;hR(this,H);var z=CR(this,i.call(this));z._functionName=M||"",z.commentRowHeight=18;var d=z.raws=[],C=z.addRow([{id:"comment",element:z.createCommentGraph()}],[.1],90);return d.push(C),C=z.addRow([{id:"head",element:"function() {"}],[.1]),d.push(C),C=z.addRow([{id:"function",element:KH(h)}],[.1],.1),d.push(C),C=z.addRow(["}"],[.1]),d.push(C),z.updateContent(I,p),z}return dR(H,i),H.prototype.setArguments=function(i){this._argList=i,this.setFormRows()},H.prototype.getArguments=function(){return this._argList},H.prototype.updateContent=function(i,H){this.setArguments(H),this.setFunctionValue(i)},H.prototype.stringifyFunction=function(i){return this._argList?U(i):b(i)},H.prototype.setFunctionValue=function(i){this.v("function",this.stringifyFunction(i))},H.prototype.getFunctionValue=function(){return this.parseFunction(this.v("function"))},H.prototype.parseFunction=function(i){if(i){var H=this.getFunctionHead();return i=i.trim(),H?i=""+H+i+"}":i.startsWith("function")||(i="function() {\n"+i+"\n}"),K(i)}},H.prototype.getFunctionHead=function(){var i=this._argList;if(i){fi(i[0])&&(i=i.map(function(i){return i[1]}));var H="function("+(fi(i)?i.join(", "):i)+") {";return this._functionName&&(H=this._functionName+": "+H),H}},H.prototype.setFormRows=function(){var i=this,H=this.raws,R=this._argList;if(4===i.getRows().length&&Y(this.commentGraph.getView()),R){fi(R[0])?(i._rows=H,this.commentNode.a("dataSource",R.map(function(i){var H=i.slice(0);return H[2]&&(H[2]=p(H[2])),H})),this.setCommentCollapse(!1)):i._rows=H.slice(1)}else i._rows=[H[2]];4===i.getRows().length&&i._contentDiv.appendChild(this.commentGraph.getView()),i.iv(),R&&i.v("head",this.getFunctionHead())},H.prototype.createCommentGraph=function(){var i=this,H=this.commentGraph=new ht.graph.GraphView;H.setRectSelectable(!1),H.setPannable(!1),H.getSelectWidth=function(){return 0},H.setZoomable(!1),H.setMovableFunc(function(){return!1}),H.setScrollBarVisible(!1);var R=H.dm(),M=this.commentNode=new ht.Node;return R.add(M),M.setImage("editor.function.comment"),M.s({fullscreen:"fill","fullscreen.gap":0,interactive:!0,pixelPerfect:!1,onEnter:function(i,H){H.a("background",KR.config.color_pane_dark)},onLeave:function(i,H){H.a("background",null)},onUp:function(H,R){var M=!R.a("collapse");i.setCommentCollapse(M)}}),M.a({collapse:!1,rowHeight:this.commentRowHeight}),H},H.prototype.setCommentCollapse=function(i){this.commentNode.a("collapse",i),this.getRows()[0].height=this.commentRowHeight*(i?1:this._argList.length+2),this.iv()},H}(bR),SM=function(){},LM=function(i){function H(R){hR(this,H);var M=CR(this,i.call(this));M.editor=R,M._errorMsg=null,M.$71$(),M.$70$(),M.$72$(),M.splitView=new WR(M.inspectorPane,M.graphView,"v",-200),M.mainSplitView=new WR(M.funcPane,M.splitView,"h",-360),M._eventData=new ht.Data;var I=[];return I.push({label:p("editor.refresh"),action:function(){M.refresh()}}),I.push({label:p("editor.ok"),action:function(){M.ok()}}),I.push({label:p("editor.cancel"),action:function(){M.hide()}}),M.setConfig({closable:!0,draggable:!0,width:KR.config.componentViewSize.width,height:KR.config.componentViewSize.height,contentPadding:0,resizeMode:"wh",maximizable:!0,content:M.mainSplitView,buttons:I,buttonsAlign:"right"}),M}return dR(H,i),H.prototype.$48$=function(){this.hide()},H.prototype.$47$=function(){this.ok()},H.prototype.$71$=function(){var i=this;ht.Default.setCompType("_editingCompType_",{func:function(){}}),this.graphView=new rR,this.initOverviewNode(),this.graphView.mi(function(H){"doubleClickData"!==H.kind&&"doubleClickBackground"!==H.kind||i.graphView.fitContent(KR.config.animate,KR.config.fitPadding)});var H=this;ht.Default.drawCompType=function(i,R,M,I,h,z){var d="_editingCompType_"===I.type;try{d&&H.beforeDrawCompType(R),i(R,M,I,h,z),d&&H.afterDrawCompType(R)}catch(i){d&&(H.afterDrawCompType(R),H._errorMsg=p("editor.compfunctionerror")),console.error(i.stack||i)}}},H.prototype.initOverviewNode=function(){var i=this.node,H=this.graphView.dm();i&&H.contains(i)&&H.remove(i);var R=this.node=new ht.Node;R.setImage({width:100,height:100,fitSize:!0,comps:[{type:"_editingCompType_"}]}),H.add(R),H.sm().ss(R)},H.prototype.beforeDrawCompType=function(i){var H=this._restoreFlag;H||(H=this._restoreFlag=i.createLinearGradient(0,0,10,10),H.addColorStop(0,"black"),H.addColorStop(0,"black")),i.fillStyle=H,i.save(),i.fillStyle="#000000"},H.prototype.afterDrawCompType=function(i){if(i.restore(),i.fillStyle!==this._restoreFlag){for(var H=0;i.fillStyle!==this._restoreFlag&&(i.restore(),!(++H>=20)););i.fillStyle="black",this._errorMsg=p("editor.complosssaveorrestore")}else this._errorMsg=null},H.prototype.$72$=function(){this.funcPane=new gM({argList:[["CanvasRenderingContext2D","g","editor.comment.canvasrenderingcontext2d"],["Rect","rect","editor.comment.componentrect"],["Object","comp","editor.comment.component"],["ht.Node","data","editor.comment.node"],["View","view","editor.comment.view"]]})},H.prototype.$70$=function(){var i=this,H=KR.config.indent;this.inspectorPane=new bR;var R=IH(p("editor.eventhandlers"),null,null,function(){i.editor.eventView.open([i._eventData],null,i.resetEventButtonLabelColor.bind(i))});this.eventButton=R,this.inspectorPane.addRow([p("editor.name"),{id:"name",textField:{}},{element:p("editor.events"),align:"right"},{element:R}],[H,.1,H,.1]),this.inspectorPane.addRow([p("editor.width"),{id:"width",textField:{}},{element:p("editor.height"),align:"right"},{id:"height",textField:{}}],[H,.1,H,.1]),this.inspectorPane.addRow([p("editor.background"),{id:"background",colorPicker:{instant:!0,onValueChanged:function(H,R){i.graphView.dm().setBackground(R)}}},p("editor.path"),{id:"path",textField:{editable:!1}}],[H,.1,H,.1]),this.inspectorPane.addRow([p("editor.snapshoturl"),{id:"snapshotURL",textField:{}}],[H,.1]),this.createTable()},H.prototype.$73$=function(i,H,R,M){return{name:i,tag:i,accessType:"attr",width:R,displayName:H,align:"center",enum:M,editable:!0}},H.prototype.createTable=function(){var i=this,H=this.tableModel=new ht.DataModel;this.tablePane=new $R(this.tableModel),this.tableView=this.tablePane.getTableView(),this.tableView.setEditable(!0),this.tableView.isEditable=function(){return i.editable},this.tablePane.getView().style.border=KR.config.color_line+" solid 1px",this.tablePane.addColumns([this.$73$("property",p("editor.property"),150),this.$73$("valueType",p("editor.valuetype"),80,{values:KR.consts.valueTypes,labels:KR.consts.valueTypeLabels}),this.$73$("defaultValue",p("editor.defaultvalue"),90),this.$73$("name",p("editor.name"),80),this.$73$("group",p("editor.group"),80),this.$73$("description",p("editor.description"),120),this.$73$("extraInfo",p("editor.extrainfo"),100)]),this.$74$(),this.initExtraInfoColumn(),this.initI18nColumns(),this.inspectorPane.addRow([this.tablePane],[.1],.1),this.inspectorPane.addRow([{button:{toolTip:p("editor.add"),icon:"editor.add",onClicked:function(){if(i.editable){var R=new ht.Data;R.a({property:"property",valueType:"String"});var M=void 0,I=H.sm().ld();I&&(M=H.getRoots().indexOf(I)+1),H.add(R,M),H.sm().ss(R),setTimeout(function(){i.tableView.tx(0),OH(i.tableView,R,i.tableView.getColumnModel().getDataByTag("property"))},100)}}}},{button:{toolTip:p("editor.delete"),icon:"editor.delete",onClicked:function(){i.editable&&i.tableView.removeSelection()}}},null,{button:{icon:"editor.top",toolTip:p("editor.bringtofront"),onClicked:function(){i.editable&&i.tableView.sm().size()&&i.tableModel.moveSelectionToTop()}}},{button:{icon:"editor.up",toolTip:p("editor.bringforward"),onClicked:function(){i.editable&&i.tableView.sm().size()&&i.tableModel.moveSelectionUp()}}},{button:{icon:"editor.down",toolTip:p("editor.sendbackward"),onClicked:function(){i.editable&&i.tableView.sm().size()&&i.tableModel.moveSelectionDown()}}},{button:{icon:"editor.bottom",toolTip:p("editor.sendtoback"),onClicked:function(){i.editable&&i.tableView.sm().size()&&i.tableModel.moveSelectionToBottom()}}}],[20,20,.1,20,20,20,20])},H.prototype.$74$=function(){var i=this,H=this.tableView.getColumnModel().getDataByTag("defaultValue");H.getValue=function(i,H,R){var M=i.a("defaultValue");return"Angle"===i.a("valueType")&&M&&(M=M/Math.PI*180),M},H.setValue=function(i,H,R,M){"Angle"===i.a("valueType")&&(R=R*Math.PI/180),i.a("defaultValue",R)},H.getEnumValues=function(i){var H=i?KR.config.valueTypes[i.a("valueType")]:null;return H&&"enum"===H.type?H.values:null},H.getEnumLabels=function(i){var H=i?KR.config.valueTypes[i.a("valueType")]:null;return H&&"enum"===H.type?H.labels:null},H.getEnumIcons=function(i){var H=i?KR.config.valueTypes[i.a("valueType")]:null;return H&&"enum"===H.type?H.icons:null},H.getEnumDropDownWidth=function(i){var H=i?KR.config.valueTypes[i.a("valueType")]:null;return H&&"enum"===H.type?H.dropDownWidth:null},H.getValueType=function(i){var H=i?KR.config.valueTypes[i.a("valueType")]:null;return H?H.type:null},H.isCellEditable=function(H,R,M,I){var h=H?KR.config.valueTypes[H.a("valueType")]:null,z=h?h.type:null,d=H.a("extraInfo"),C=KR.config.handleDefaultVauleColumnEdit,y=function(i){H.a("defaultValue",i)};if(C&&C(y,h,z,d))return!1;if("function"===z){var b=p("editor.function")+" "+(H.a("property")||"");return i.editor.functionView.open(H.a("defaultValue"),y,b,d&&d.arguments),!1}if("multiline"===z)return i.editor.textView.open(H.a("defaultValue"),y,H.a("property")||"&nbsp;"),!1;if("font"===z)return i.editor.fontView.open(H.a("defaultValue"),y,H.a("property")||"&nbsp;"),!1;if("object"===z||"custom"===z||"stringArray"===z||"objectArray"===z||"numberArray"===z||"colorArray"===z){var U=p("editor.object")+" "+(H.a("property")||"");return i.editor.objectView.open(H.a("defaultValue"),y,U,null,"object"===z&&d&&d.objectProperties),!1}return"dataModel"!==z||(i.editor.dataModelView.open(H.a("defaultValue"),y,i.editable,d),!1)}},H.prototype.initExtraInfoColumn=function(){var i=this;this.tableView.getColumnModel().getDataByTag("extraInfo").isCellEditable=function(H,R,M,I){var h=p("editor.extrainfo")+" "+(H.a("property")||"");return i.editor.objectView.open(H.a("extraInfo"),function(i){H.a("extraInfo",i)},h),!1}},H.prototype.initI18nColumns=function(){var i=this;["name","group"].forEach(function(H){var R=i.tableView.getColumnModel().getDataByTag(H);R.getValue=function(i,R,M){var I=i.a(H);return i._editing_?I:p(I)},R.setValue=function(i,R,M,I){i.a(H,M),delete i._editing_},R.isCellEditable=function(i,H,R,M){return i._editing_=1,!0}})},H.prototype.open=function(i,H){var R=this;this.fileNode=i,this.initOverviewNode(),i?r(i.url,function(H){R.update(i.url,i.path,B(i.getName()),H,i.a("editable"))}):this.update(void 0,H||this.editor.components.currentDir,p("editor.untitled"))},H.prototype.update=function(i,H,R,M,I){if(this.editable=!1!==I,this._eventData.setAttrObject({}),M){if(M=w(M),this.setTitle(p("editor.editcomponent")),this.node.setWidth(M.width||100),this.node.setHeight(M.height||100),this.inspectorPane.v("width",this.node.getWidth()),this.inspectorPane.v("height",this.node.getHeight()),this.inspectorPane.v("snapshotURL",M.snapshotURL||""),this.inspectorPane.v("background",M.background||null),this.inspectorPane.getViewById("name").setEditable(!1),this.inspectorPane.v("name",R||""),this.inspectorPane.v("path",H||""),this.funcPane.setFunctionValue(M.func),this.tableModel.clear(),M.properties)for(var h in M.properties){var z=M.properties[h],d=new ht.Data;d.a({property:h,valueType:z.valueType,defaultValue:z.defaultValue,name:z.name,group:z.group,description:z.description,extraInfo:z.extraInfo}),this.tableModel.add(d)}if(this._eventData=new ht.Data,M.events)for(var C in M.events)this._eventData.a(C,M.events[C]);this.refresh(),this.show(this.editor.$38$),this.url=i,this.editor.fireEvent("componentViewOpened",{componentView:this,url:i,json:M})}else this.setTitle(p("editor.newcomponent")),this.node.setWidth(100),this.node.setHeight(100),this.inspectorPane.v("width",this.node.getWidth()),this.inspectorPane.v("height",this.node.getHeight()),this.inspectorPane.v("snapshotURL",""),this.inspectorPane.getViewById("name").setEditable(!0),this.inspectorPane.v("name",R),this.inspectorPane.v("path",H),this.funcPane.setFunctionValue(),this.tableModel.clear(),this.refresh(),this.show(this.editor.$38$),this.url=i,this.editor.fireEvent("componentViewCreated",{componentView:this});this.resetEventButtonLabelColor()},H.prototype.$76$=function(i){var H={};return this.tableModel.getRoots().each(function(R){H[R.a("property")]={valueType:R.a("valueType"),defaultValue:i?wi(R.a("defaultValue")):R.a("defaultValue"),name:R.a("name"),group:R.a("group"),description:R.a("description"),extraInfo:R.a("extraInfo")}}),H},H.prototype.refresh=function(i){ht.Default.setCompType("_editingCompType_",{func:this.funcPane.getFunctionValue()||SM,properties:this.$76$()}),this.node.setWidth(parseFloat(this.inspectorPane.v("width"))),this.node.setHeight(parseFloat(this.inspectorPane.v("height"))),this.node.iv(),this.graphView.fitContent(KR.config.animate,KR.config.fitPadding);var H=function(R){"validate"===R.kind&&(i&&i(!this._errorMsg),this._errorMsg&&this.editor.showMessage(this._errorMsg,"error"),this.graphView.removeViewListener(H,this))};this.graphView.addViewListener(H,this)},H.prototype.createEvents=function(){var i=this._eventData,H=null;return qR.forEach(function(R){i.a(R)&&(H||(H={}),H[R]=i.a(R))}),H},H.prototype.resetEventButtonLabelColor=function(){for(var i=!1,H=0;H<qR.length;H++)if(this._eventData.a(qR[H])){i=!0;break}this.eventButton.setLabelColor(i?KR.config.color_select:ht.Default.labelColor)},H.prototype.ok=function(){var i=this;if(!this.editable)return void this.hide();var H=this.inspectorPane.v("name").trim(),R=this.inspectorPane.v("path");if(!this.url){var M=this.editor.components;if(M.isAccordionMode()&&M.rootDir===R)return void this.editor.showMessage(p("editor.createfolderfirst"),"error",2e3)}var I=this.url||R+"/"+H+".json";if(!H)return void HH(null,p("editor.inputempty"),function(){});if(H.length>KR.config.maxFileNameLength)return void HH(null,p("editor.inputmax"),function(){});if(KR.config.checkFileName&&!(H=KR.config.checkFileName(H,I)))return void HH(null,p("editor.invalidfilename"),function(){});bi(H)&&(H=B(H));var h=this.content,z={componentView:this,url:I,json:F(h)};this.editor.fireEvent("componentViewSaving",z),z.preventDefault||(z={path:z.url,content:z.json},KR.config.vision&&(z.root_dir=this.editor.components.rootDir,z.parent_uuid=this.editor.components.tree.sm().ld().uuid),this.refresh(function(M){M&&i.editor.request("upload",z,function(M){(KR.config.vision?M&&M.uuid:!0===M)&&(i.refresh(),i.graphView.sm().cs(),i.graphView.validate(),i.editor.saveImage(h.snapshotURL||i.graphView,R+"/"+H+".png",function(){i.editor.fireEvent("componentViewSaved",z)},M.uuid,M.parent_uuid,M.root_dir),i.hide(),i.editor.selectFileNode(z.path),z={componentView:i,url:z.path,json:z.content})})}))},zR(H,[{key:"content",get:function(){var i=this.inspectorPane,H={modified:(new Date).toString(),width:parseFloat(i.v("width")),height:parseFloat(i.v("height")),func:this.funcPane.getFunctionValue()||SM},R=i.v("snapshotURL"),M=i.v("background"),I=this.createEvents();return this.tableModel.size()&&(H.properties=this.$76$(!0)),I&&(H.events=I),R&&(H.snapshotURL=R),M&&(H.background=M),H}}]),H}(yR),uM=460,iI=230,HI=function(i){function H(R){hR(this,H);var M=CR(this,i.call(this));M.editor=R;var I=[];I.push(p("editor.binding")),I.push({id:"compProperty",textField:{editable:!1}}),I.push({element:p("editor.type"),align:"right"}),I.push({id:"type",comboBox:{values:["attr","func"],onValueChanged:function(i,H){var R="func"===H,I=R?ht.Default.labelColor:KR.config.color_disabled;M.getViewById("func").setEditable(R),M.getItemById("head").color=I,M.getItemById("end").color=I,M.getViewById("property").setDisabled(R),R&&M.getViewById("property").setValue(""),M.iv()}}}),I.push({element:p("editor.property"),align:"right"});var h={id:"property"};KR.config.dataBindingsForSymbol.getComboBoxValues?h.comboBox={editable:!!KR.config.dataBindingsForSymbol.comboBoxEditable}:h.textField={},I.push(h);var z=[50,90,40,60,60,.1];if(KR.config.dataBindingsForSymbol.onButtonClicked){var d=IH("...",void 0,void 0,function(){M.smartClose=!1,KR.config.dataBindingsForSymbol.onButtonClicked(M,M.v("compProperty"),M.editor)});I.push(d),z.push(20)}if(M.addRow(I,z),!KR.config.dataBindingsForSymbol.getComboBoxValues){M.getItemById("property").element.getElement().addEventListener("keydown",function(i){ht.Default.isEnter(i)&&M.hide(!0)})}M.addLine(),M.addRow([{id:"head",element:""}],[.1]),M.addRow([{id:"func",element:KH()}],[.1],.1),M.addRow([{id:"end",element:"}"},{button:{label:p("editor.ok"),onClicked:function(){M.hide(!0)}}},{button:{label:p("editor.cancel"),onClicked:function(){M.hide()}}}],[.1,50,50]),M.setWidth(uM),M.setHeight(iI),M.getView().className="ht-editor-databinding",M.getView().style.background=KR.config.color_pane,M.getView().style.border=KR.config.color_pane_dark+" solid 1px",M.getView().style.boxShadow="0px 0px 3px "+ht.Default.toolTipShadowColor,M.getView().style.overflow="visible";var C=M.handleWindowClick.bind(M);return window.addEventListener("mousedown",C,!1),window.addEventListener("touchstart",C,!1),M}return dR(H,i),H.prototype.handleWindowClick=function(i){if(this.smartClose&&this.getView().parentNode&&!this.button.getView().contains(i.target)){var H=this.getViewById("type");if(!H.getListView().getView().contains(i.target)){if((H=this.getViewById("property"))instanceof ht.widget.ComboBox){if(H.getListView().getView().contains(i.target))return;if(H.getInput()&&H.getInput().contains(i.target))return}this.getView().contains(i.target)||this.hide()}}},H.prototype.toggle=function(i,H,R,M,I,p){this.getView().parentNode?this.hide():this.show(i,H,R,M,I,p)},H.prototype.show=function(i,H,R,M,I,p){var h=this;KR.config.dataBindingsForSymbol.getComboBoxValues?KR.config.dataBindingsForSymbol.getComboBoxValues(function(z){h.getViewById("property").setValues(z),h.showImpl(i,H,R,M,I,p)}):this.showImpl(i,H,R,M,I,p)},H.prototype.showImpl=function(i,H,R,M,I,p){if(!this.getView().parentNode){this.smartClose=!0;var h=i.getView().getBoundingClientRect(),z=(this.getView().style,k());ht.Default.appendToScreen(this),h.bottom+iI+1>z.height?this.getView().style.top=z.top+h.top-iI-1+"px":this.getView().style.top=z.top+h.bottom+1+"px",this.getView().style.left=z.left+h.right-uM+"px",this.iv(),this.button=i,this.name=H,this.inspector=M,this.setter=p,this.v("compProperty",R||H);var d=void 0,C=!1;this.inspector.global?"clip"===H?(d=I?I():this.inspector.dataModel.a("clip"),this.v("head","function(g, width, height, data, view, image) {"),C=!0):(d=I?I():this.inspector.dataModel.a(H+"_func"),this.v("head","function(data, view) {")):(d=I?I():this.inspector.data.a(H),this.inspector.data instanceof vM&&"type"===H?(this.v("head","function(g, rect, comp, data, view) {"),C=!0):this.v("head","function(data, view) {"));ti(d)?(fR.test(d)?(this.v("type","attr"),this.v("property",d.slice(5))):(this.v("type","attr"),this.v("property",d)),this.v("func","")):Di(d)?(this.v("type","func"),this.v("property",""),this.v("func",U(d))):(this.v("type","attr"),this.v("property",""),this.v("func","")),C?(this.v("type","func"),this.v("property",""),this.getViewById("type").setDisabled(!0)):this.getViewById("type").setDisabled(!1)}},H.prototype.hide=function(){var i=this,H=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.getView().parentNode&&(Y(this.getView()),H)){var R=this.v("type"),M=this.v("property"),I=void 0;if("func"===R){var p=this.v("func").trim();(p||this.inspector.data instanceof vM&&"type"===this.name)&&(I=K(this.v("head")+"\n"+p+"\n}"))}else M&&"attr"===R&&(I="attr@"+M);this.setter?this.setter(I):this.inspector.global?"clip"===this.name?this.inspector.dataModel.a("clip",I):this.inspector.dataModel.a(this.name+"_func",I):this.inspector.setValue(function(H,R){H.a(i.name,R)},I)}},H}(bR),RI=function(i){function H(R){hR(this,H);var M=CR(this,i.call(this));M.editor=R,M.createTabView();var I=[];return I.push({label:p("editor.ok"),action:function(){M.ok()}}),I.push({label:p("editor.cancel"),action:function(){M.hide()}}),M.setConfig({title:p("editor.eventhandlers"),closable:!0,draggable:!0,width:KR.config.eventViewSize.width,height:KR.config.eventViewSize.height,contentPadding:6,resizeMode:"wh",maximizable:!0,content:M.tabView,buttons:I,buttonsAlign:"right"}),M.setModal(!1),M}return dR(H,i),H.prototype.$48$=function(){this.hide()},H.prototype.$47$=function(){this.ok()},H.prototype.ok=function(i){var H=this;this.target&&(this.editor.beginTransaction(),qR.forEach(function(R){var M=H[R+"FormPane"],I=M.getFunctionValue();if("data"===H.inspectorType||"data3d"===H.inspectorType){var p=i?null:I;H.target.forEach(function(i){i.s(R,p)})}else{var h=i?null:I;H.target.forEach(function(i){i.a(R,h)})}}),this.editor.endTransaction()),this.callback&&this.callback(),this.hide()},H.prototype.createTabView=function(){var i=this,H=this.tabView=new lR;qR.forEach(function(R){var M=i[R+"FormPane"]=new gM({functionName:R});i[R+"Tab"]=H.add(p("editor.event."+R.toLowerCase()),M)}),H.getTabModel().sm().ss(H.getTabModel().getDatas().get(0))},H.prototype.open=function(i,H,R){var M=this;i&&i.length&&(this.target=i,this.inspectorType=H,this.callback=R,qR.forEach(function(R){var I=M[R+"FormPane"];"data"===H||"data3d"===H?I.updateContent(i[i.length-1].s(R),[["Event","event","editor.comment.event"],["ht.Node","data","editor.comment.node"],"data3d"===H?["ht.graph3d.Graph3dView","view","editor.comment.graph3dview"]:["ht.graph.GraphView","view","editor.comment.graphview"]]):I.updateContent(i[i.length-1].a(R),[["Event","event","editor.comment.event"],["ht.Node","data","editor.comment.node"],["View","view","editor.comment.view"],["Point","point","editor.comment.componentpoint"],["Number","width","editor.comment.componentwidth"],["Number","height","editor.comment.componentheight"]])}),this.show(this.editor.$38$))},H.prototype.hide=function(){i.prototype.hide.call(this),this.target=this.inspectorType=this.callback=void 0},H}(yR);KR.EventView=RI;var MI=function(i){function H(R){hR(this,H);var M=CR(this,i.call(this));M.editor=R,M.formPane=new gM;var I=[];return I.push({label:p("editor.ok"),action:function(){M.ok()}}),I.push({label:p("editor.cancel"),action:function(){M.hide()}}),M.setConfig({title:p("editor.function"),closable:!0,draggable:!0,width:KR.config.functionViewSize.width,height:KR.config.functionViewSize.height,contentPadding:6,resizeMode:"wh",maximizable:!0,content:M.formPane,buttons:I,buttonsAlign:"right"}),M.setModal(!1),M}return dR(H,i),H.prototype.$48$=function(){this.hide()},H.prototype.$47$=function(){this.ok()},H.prototype.ok=function(){this.setValue&&this.setValue(this.formPane.getFunctionValue()),this.hide()},H.prototype.open=function(i,H,R,M,I){this.setValue=H,this.setTitle(R),this.formPane.updateContent(i,M),this.callback=I,this.show(this.editor.$38$)},H}(yR);ht.Default.setCompType("editor.comp.function.comment",{width:300,height:100,func:function(i,H,R,M,I){var p=H.x,h=H.y,z=H.width,d=H.height,C=R.getValue("dataSource"),y=R.getValue("collapse"),b=R.getColor("background"),U=R.getValue("font"),K=R.getColor("notes.color"),q=R.getColor("param.color"),Q=R.getColor("type.color"),m=R.getColor("propertyName.color"),X=R.getColor("comment.color")||K,o=R.getValue("rowHeight")||ht.Default.getTextSize(U,"1").height;if(i.save(),b&&(i.fillStyle=b,i.fillRect(p,h,z,d)),i.beginPath(),i.rect(p,h,z,d),i.clip(),y)g(i,"/** ...",U,K,p,h,z,o,"left","middle");else{g(i,"/**",U,K,p,h,z,o,"left","middle");var J=i.measureText("/").width;C.forEach(function(H,R){var M=J;g(i,"*",U,K,p+M,h+(R+1)*o,z,o,"left","middle"),M+=i.measureText("* ").width,g(i,"@param",U,q,p+M,h+(R+1)*o,z,o,"left","middle"),M+=i.measureText("@param  ").width,g(i,"{"+H[0]+"}",U,Q,p+M,h+(R+1)*o,z,o,"left","middle"),M+=i.measureText("{"+H[0]+"}  ").width,g(i,H[1],U,m,p+M,h+(R+1)*o,z,o,"left","middle"),M+=i.measureText(H[1]+"  ").width,g(i,H[2],U,X,p+M,h+(R+1)*o,z,o,"left","middle")}),g(i,"*/",U,K,p+J,h+(C.length+1)*o,z,o,"left","middle")}i.restore()},properties:{dataSource:{valueType:"Object",defaultValue:[]},font:{valueType:"Font",defaultValue:"12px sans-serif, Arial"},collapse:{valueType:"Boolean"},rowHeight:{valueType:"PositiveNumber",defaultValue:20},background:{valueType:"Color"},"notes.color":{valueType:"Color",defaultValue:"rgb(143,153,204)"},"param.color":{valueType:"Color",defaultValue:"rgb(13,171,214)"},"type.color":{valueType:"Color",defaultValue:"rgb(125,195,125)"},"propertyName.color":{valueType:"Color",defaultValue:"rgb(175,77,232)"},"comment.color":{valueType:"Color",defaultValue:"rgb(143,153,204)"}}}),function(i,H){ht.Default.setImage(i,H)}("editor.function.comment",{width:300,height:100,fitSize:!0,comps:[{type:"editor.comp.function.comment",rect:[0,0,300,100],dataSource:{func:"attr@dataSource"},rowHeight:{func:"attr@rowHeight"},background:{func:"attr@background"},collapse:{func:"attr@collapse"}}]});var II=function(i){function R(H){hR(this,R);var M=CR(this,i.call(this));return M.editor=H,M.init(),M.initStudio(),M}return dR(R,i),R.prototype.init=function(){var i=this;this.formPane=new bR,this.formPane.addRow([{id:"object",element:KH()}],[.1],.1);var H=[];H.push({label:p("editor.ok"),action:function(){i.ok()}}),H.push({label:p("editor.cancel"),action:function(){i.hide()}}),this.setConfig({title:p("editor.object"),closable:!0,draggable:!0,width:KR.config.objectViewSize.width,height:KR.config.objectViewSize.height,contentPadding:6,resizeMode:"wh",maximizable:!0,content:this.formPane,buttons:H,buttonsAlign:"right"}),this.setModal(!1)},R.prototype.initStudio=function(){},R.prototype.$48$=function(){this.hide()},R.prototype.$47$=function(){this.ok()},R.prototype.getValue=function(){return H(this.formPane.v("object"))},R.prototype.ok=function(){this.setValue&&this.setValue(this.getValue()),this.hide()},R.prototype.open=function(i,H,R,M){if(this.setValue=H,this.setTitle(R),this.callback=M,i=this.stringify(i)){var I=this._funcMap;for(var p in I)i=i.replace('"'+p+'"',b(I[p]))}this.formPane.v("object",i),this.show(this.editor.$38$)},R.prototype.stringify=function(i,H){var R=this,M=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()},this._funcMap={};var I=JSON.stringify(i,function(i,H){if("function"==typeof H){var M=Math.random().toString().substring(3,16)+Date.now();return R._funcMap[M]=H,M}return H},null==H?2:H);return Date.prototype.toJSON=M,I},R}(yR),pI=function(i){function H(R){hR(this,H);var M=CR(this,i.call(this));M.editor=R,M.formPane=new bR,M.formPane.addRow([{id:"text",element:KH({value:"",language:"text",minimap:{enabled:!1}})}],[.1],.1);var I=[];return I.push({label:p("editor.ok"),action:function(){M.ok()}}),I.push({label:p("editor.cancel"),action:function(){M.hide()}}),M.setConfig({closable:!0,draggable:!0,width:KR.config.textViewSize.width,height:KR.config.textViewSize.height,contentPadding:6,resizeMode:"wh",maximizable:!0,content:M.formPane,buttons:I,buttonsAlign:"right"}),M.setModal(!1),M}return dR(H,i),H.prototype.$48$=function(){this.hide()},H.prototype.$47$=function(){this.ok()},H.prototype.ok=function(){this.setValue&&this.setValue(this.formPane.v("text").replace(/\r/g,"")),this.hide()},H.prototype.open=function(i,H,R,M){this.setValue=H,this.setTitle(R),this.formPane.v("text",i||""),this.callback=M,this.show(this.editor.$38$)},H}(yR),hI=function(){function i(){hR(this,i)}return i.prototype.init=function(){var i=this.baseFonts=["monospace","sans-serif","serif"],H=this.testString="mmmmmmmmmmlli",R=this.testSize="72px",M=this.h=document.getElementsByTagName("body")[0],I=this.s=document.createElement("span");I.style.fontSize=R,I.innerHTML=H;var p=this.defaultWidth={},h=this.defaultHeight={};for(var z in i)I.style.fontFamily=i[z],M.appendChild(I),p[i[z]]=I.offsetWidth,h[i[z]]=I.offsetHeight,M.removeChild(I);this.initialized=!0},i.prototype.detect=function(i){this.initialized||this.init();var H=!1,R=this.baseFonts,M=this.s,I=this.h,p=this.defaultWidth,h=this.defaultHeight;for(var z in R){M.style.fontFamily=i+","+R[z],I.appendChild(M);var d=M.offsetWidth!=p[R[z]]||M.offsetHeight!=h[R[z]];I.removeChild(M),H=H||d}return H},i}(),zI=function(i){function H(R){hR(this,H);var M=CR(this,i.call(this));return M.editor=R,M}return dR(H,i),H.prototype.init=function(){var i=this;this._detector=new hI;var H=this.borderPane=new jR,R=this.rightBorder=new jR,M=this.previewGraph=new ht.graph.GraphView,I=this.listView=new eR,h=this.formPane=new bR;I.getView().style.borderRight="2px solid #f7f7f7",I.getLabelFont=function(i){return"14px "+i.getName()},H.setLeftView(I),H.setCenterView(R),H.setLeftWidth(180),R.setBottomView(M),R.setBottomHeight(120),R.setCenterView(h),M.adjustTranslateX=function(){return 0},M.adjustTranslateY=function(){return 0},M.handleScroll=function(){return!1},M.setScrollBarVisible(!1);var z=this.textNode=new ht.Text;z.s({"2d.selectable":!1,text:KR.config.fontPreview}),z.setAnchor(0,0),z.setSize(2e3,120),z.p(4,4),M.dm().add(z);h.setVPadding(32),h.setVGap(18),h.setHGap(0),h.addRow([{element:p("editor.font.style"),align:"right"},"",{id:"normal",button:this.createStyleButton(p("editor.font.normal"))},{id:"bold",button:this.createStyleButton(p("editor.font.bold"))},{id:"oblique",button:this.createStyleButton(p("editor.font.oblique"))},{id:"obliqueBold",button:this.createStyleButton(p("editor.font.obliquebold"))}],[60,8,.1,.1,.1,.1],32),h.addRow([{element:p("editor.font.size"),align:"right"},"",{id:"fontSize",slider:{max:72,min:12,step:1,onValueChanged:function(H,R){h.getItemById("fontSizeLabel").element=R+"",h.iv(),i._handleFontChange()}}},{id:"fontSizeLabel",element:"12"}],[60,8,.1,20],32),h.addRow([{element:p("editor.output"),align:"right"},"",{id:"fontOutput",textField:{editable:!1,value:this.getFontString()}}],[60,8,.1],32);var d=[];d.push({label:p("editor.ok"),action:function(){i.ok()}}),d.push({label:p("editor.cancel"),action:function(){i.hide()}}),this.initFontList(),this.setConfig({closable:!0,draggable:!0,width:KR.config.fontViewSize.width,height:KR.config.fontViewSize.height,contentPadding:6,resizeMode:"wh",maximizable:!0,content:H,buttons:d,buttonsAlign:"right"}),this._init=!0,this.setModal(!1)},H.prototype.createStyleButton=function(i){var H=this;return{label:i,groupId:"fontStyle",labelSelectColor:KR.config.color_select,labelColor:"#2c2c2c",borderSelectColor:"red",background:"rgb(247,247,247)",selectBackground:"rgb(247,247,247)",togglable:!0,borderColor:null,onClicked:function(i){H._handleFontChange()}}},H.prototype.initFontList=function(){var i=this,H=this.listView,R=H.getView().style,M=H.dm(),I=this._detector,p=KR.config.fontList,h=KR.config.ignoreFontDetection;return H.sm().ms(function(H){i._handleFontChange(H)}),p.forEach(function(i){if(h||I.detect(i)){var H=new ht.Node;H.setIcon(null),H.setName(i),M.add(H)}}),M.sm().setSelectionMode("multiple"),R.background="white",H},H.prototype.$48$=function(){this.hide()},H.prototype.$47$=function(){this.ok()},H.prototype._handleFontChange=function(){this.textNode.s("text.font",this.getFontString()),this.formPane.v("fontOutput",this.getFontString())},H.prototype.getFontString=function(){var i=this.listView,H=this.formPane,R=i.sm().getSelection().toArray(),M="",I=R.map(function(i){return i.getName()});return I.length||(I=["arial"]),["bold","oblique","obliqueBold"].forEach(function(i,R){
H.getItemById(i).element.isSelected()&&(0===R?M="bold ":1===R?M="italic ":2===R&&(M="italic bold "))}),""+M+H.getValue("fontSize")+"px "+I.join(", ")},H.prototype.ok=function(){this.setValue&&this.setValue(this.getFontString()),this.hide()},H.prototype.analysisFontString=function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ht.Default.labelFont;"string"!=typeof i&&(i=ht.Default.labelFont);var H=i.split(/px\s+/);H.length<2&&(H=ht.Default.labelFont.split(/px\s+/));var R=H[0].split(/\s+/),M=H[1].split(",").map(function(i){return i.trim()}),I=/\d+/,p=void 0,h=void 0,z=void 0;R.forEach(function(i){"bold"===i?p=!0:"oblique"===i||"italic"===i?h=!0:I.test(i)&&(z=parseInt(i))}),this.setFormValue(z,M,p,h)},H.prototype.setFormValue=function(i,H,R,M){var I=this.listView,p=this.formPane;I.sm().cs(),I.dm().each(function(i){H.forEach(function(H){i.getName().toLowerCase()===H.toLowerCase()&&I.sm().as(i)})});var h=0;R&&M?h=3:R?h=1:M&&(h=2),["normal","bold","oblique","obliqueBold"].forEach(function(i,H){p.getItemById(i).element.setSelected(h===H)}),p.getItemById("fontSizeLabel").element=i+"",p.setValue("fontSize",i)},H.prototype.open=function(i,H,R,M){this._init||this.init(),this.setValue=H,this.setTitle(R),this.analysisFontString(i),this.callback=M,this.show(this.editor.$38$)},H}(yR),dI=300,CI=230,yI=function(i){function R(H){hR(this,R);var M=CR(this,i.call(this));M.editor=H,M.addRow([{id:"content",element:KH()}],[.1],.1),M.addRow([null,{button:{label:p("editor.ok"),onClicked:function(){M.hide(!0)}}},{button:{label:p("editor.cancel"),onClicked:function(){M.hide()}}}],[.1,50,50]),M.setWidth(dI),M.setHeight(CI),M.getView().className="ht-editor-styleicons",M.getView().style.background=KR.config.color_pane,M.getView().style.border=KR.config.color_pane_dark+" solid 1px",M.getView().style.boxShadow="0px 0px 3px "+ht.Default.toolTipShadowColor,M.getView().style.overflow="visible";var I=function(i){!M.getView().parentNode||M.button.getView().contains(i.target)||M.getView().contains(i.target)||M.hide()};return window.addEventListener("mousedown",I,!1),window.addEventListener("touchstart",I,!1),M}return dR(R,i),R.prototype.toggle=function(i,H){this.getView().parentNode?this.hide():this.show(i,H)},R.prototype.show=function(i,H){if(!this.getView().parentNode){var R=i.getView().getBoundingClientRect(),M=(this.getView().style,k());ht.Default.appendToScreen(this),this.getView().style.top=M.top+R.top+"px",this.getView().style.left=M.left+R.left-dI-4+"px",this.iv(),this.button=i,this.data=H;var I=H.s("icons");this.v("content",I?F(I,void 0,!1):"")}},R.prototype.hide=function(){var i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.getView().parentNode&&(Y(this.getView()),i&&this.data.s("icons",H(this.v("content"))))},R}(bR),bI=function(){function i(H){var R=this;hR(this,i),this.editor=H;var M=this.container=ht.Default.createDiv(),I=this.wrap=ht.Default.createDiv(),p=M.style;p.pointerEvents="none",p.position="absolute",p.left=0,p.right=0,p.top=0,p.bottom=0,M.appendChild(I),p=I.style,p.width="500px",p.position="absolute",p.left="50%",p.bottom="20px",p.marginLeft="-300px",p.pointerEvents="none",this._cache=[],this._visibleCount=0,this.layoutContainer(),window.addEventListener("resize",function(){R.layoutContainer()})}return i.prototype.layoutContainer=function(){var i=this.container,H=ht.Default.getWindowInfo(),R=i.style;R.width=H.width+"px",R.height=H.height+"px"},i.prototype.createMessage=function(i){var H=this._cache.pop();if(!H){H=document.createElement("div");var R=H.style;R.boxSizing="border-box",R.padding=0,R.color="rgb(247,247,247)",R.margin="5px auto",R.textAlign="center",R.fontSize="14px",R.borderRadius="3px",R.height=0,R.overflow="hidden",R.pointerEvents="none",R.boxShadow="rgba(0,0,0,0.1) 1px 1px 2px",R.webkitTransition="0.3s all",R.mozTransition="0.3s all",R.msTransition="0.3s all",R.oTransition="0.3s all",R.transition="0.3s all"}return H.innerHTML=i,H},i.prototype.show=function(i){var H=this,R=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal",M=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2e3,I=this.createMessage(i);this.wrap.appendChild(I),this._visibleCount||ht.Default.appendToScreen(this.container),this._visibleCount++,I.style.backgroundImage="normal"===R?"linear-gradient(rgba(95, 156, 210, 0.8),rgba(112, 193, 244, 0.3))":"linear-gradient(rgba(242,83,75,0.8),rgba(242,83,75,0.3))",setTimeout(function(){I.style.height="",I.style.padding="6px 12px",H.hideLater(I,M)},10)},i.prototype.hideLater=function(i,H){var R=this;setTimeout(function(){i.style.height=0,i.style.padding=0,setTimeout(function(){if(R.wrap.removeChild(i),R._cache.push(i),!--R._visibleCount){R.container.parentNode.removeChild(R.container)}},500)},H)},i}(),UI=function(i){function H(R){hR(this,H);var M=CR(this,i.call(this));return M.editor=R,M}return dR(H,i),H.prototype.init=function(){var i=this,H=this.dm=new ht.DataModel,R=this.gv=new ht.graph.GraphView(H),M=this.rightFormPane=new bR,I=this.splitView=new WR(R,M,"h",.6),h=this.targetNode=new ht.Node;h.setAnchor(0,0),h.p(0,0),h.s("2d.selectable",!1),R.dm().add(h),R.setEditable(!0),R.addBottomPainter(function(i){var H=this.getViewRect();i.fillStyle="#cbd3d8",i.fillRect(H.x,H.y,H.width,H.height);var R=h.getRect();i.fillStyle="#fff",i.fillRect(R.x,R.y,R.width,R.height)});var z=[{label:p("editor.ok"),action:function(){i.editor.dm.a("attachPoints",i.toPointsData()),i.hide()}},{label:p("editor.cancel"),action:function(){i.hide()}}];this.setConfig({title:"\u5438\u9644\u70b9",content:I,closable:!0,draggable:!0,maximizable:!0,resizeMode:"wh",buttons:z,width:KR.config.attachPointsViewSize.width,height:KR.config.attachPointsViewSize.height}),this.$80$(),H.md(function(i){if("position"===i.property&&i.data!==h){var H=i.data,R=H.a("offsetX"),M=H.a("offsetY"),I=i.newValue.x-R,p=i.newValue.y-M;H.a({x:parseFloat((I/h.getWidth()).toFixed(2)),y:parseFloat((p/h.getHeight()).toFixed(2))})}}),R.mp(function(i){if("zoom"===i.property){var M=1/R.getZoom();H.each(function(i){i!==h&&i.setScale(M,M)})}}),this._init=!0},H.prototype.$80$=function(){var i=this,H=new $R(this.dm),R=this.tableView=H.getTableView();R.isVisible=function(H){return H!==i.targetNode},R.setEditable(!0),H.getView().style.border=KR.config.color_line+" solid 1px",H.addColumns([this.$73$("x",p("editor.attach.x"),70,function(H,R,M,I){var p=i.targetNode.getWidth();H.setX(p*M+(H.a("offsetX")||0))}),this.$73$("y",p("editor.attach.y"),70,function(H,R,M,I){var p=i.targetNode.getHeight();H.setY(p*M+(H.a("offsetY")||0))}),this.$73$("offsetX",p("editor.attach.offsetX"),70,function(H,R,M,I){H.a("offsetX",M);var p=i.targetNode.getWidth();H.setX(p*H.a("x")+M)}),this.$73$("offsetY",p("editor.attach.offsetY"),70,function(H,R,M,I){H.a("offsetY",M);var p=i.targetNode.getHeight();H.setY(p*H.a("y")+M)})]);var M=KR.config.customAttachPointsColumns;if(M&&M.length){var I=this.customColumns=M.map(function(H){return i.$73$(H.name,H.displayName,H.width||70,H.setter,"string")});H.addColumns(I)}this.rightFormPane.addRow([H],[.1],200),this.rightFormPane.addRow([{button:{icon:"editor.add",toolTip:p("editor.add"),onClicked:function(){i.add()}}},{button:{icon:"editor.delete",toolTip:p("editor.delete"),onClicked:function(){i.remove()}}}],[20,20],20)},H.prototype.add=function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,H=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,R=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,M=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,I=arguments[4],p=new ht.Node,h=1/this.gv.getZoom();if(p.setImage("editor.attachPoint"),p.setScale(h,h),p.a({x:i,y:H,offsetX:R,offsetY:M}),p.s({"2d.editable":!1}),I)for(var z in I)"x"!==z&&"y"!==z&&"offsetX"!==z&&"offsetY"!==z&&p.a(z,I[z]);var d=this.targetNode.getWidth(),C=this.targetNode.getHeight();return p.p(i*d+R,H*C+M),this.gv.dm().add(p),p},H.prototype.remove=function(){for(var i=this.dm.sm().getSelection().toArray(),H=i.length-1;H>=0;H--)this.dm.remove(i[H])},H.prototype.$73$=function(i,H,R,M){var I=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"number";return{name:i,tag:i,width:R,displayName:H,align:"center",editable:!0,valueType:I,getValue:function(H){return H.a(i)},setValue:M}},H.prototype.toPointsData=function(){var i=this;return this.dm.toDatas(function(H){return H!==i.targetNode}).toArray().map(function(H){var R={x:H.a("x"),y:H.a("y")};return H.a("offsetX")&&(R.offsetX=H.a("offsetX")),H.a("offsetY")&&(R.offsetY=H.a("offsetY")),i.customColumns&&i.customColumns.forEach(function(i){var M=H.a(i.name);M&&(R[i.name]=M)}),R})},H.prototype.$48$=function(){this.hide()},H.prototype.createNodeByPointData=function(){var i=this,H=this.editor.dm.a("attachPoints");H&&H.forEach(function(H){i.add(H.x,H.y,H.offsetX,H.offsetY,H)})},H.prototype.show=function(H){this._init||this.init(),this.dm.clear(),this.dm.add(this.targetNode),this.targetNode.setImage(H),this.createNodeByPointData(),i.prototype.show.call(this,this.editor.$38$),this.gv.fitContent(!0)},H}(yR),KI=function i(H,R){var M=this;hR(this,i),this.editor=H,this.inspector=R,["isDataTitleVisible","isDataPropertyVisible","isCompTitleVisible","isCompPropertyVisible","isDisplayTitleVisible","isDisplayPropertyVisible","isSymbolTitleVisible","isSymbolPropertyVisible","isData3dTitleVisible","isData3dPropertyVisible","isSceneTitleVisible","isScenePropertyVisible"].forEach(function(i){var I=KR.config.detailFilter,p=KR.config.compactFilter,h=y(p);M[i]=function(){if(I[i]&&!I[i].apply(R,arguments))return!1;if(KR.config.commonAndAdvancedFilterMode){if(H.inspectorCompact)return!(p[i]&&!p[i].apply(R,arguments));if(h)return!0;if(p[i]&&!p[i].apply(R,arguments))return!0;if(i.indexOf("Title")>0)return!0;var M=R._currentTitle;return!("isDataPropertyVisible"!==i||!p.isDataTitleVisible||p.isDataTitleVisible.call(R,arguments[0],arguments[1],M))||(!("isCompPropertyVisible"!==i||!p.isCompTitleVisible||p.isCompTitleVisible.call(R,arguments[0],arguments[1],M))||(!("isDisplayPropertyVisible"!==i||!p.isDisplayTitleVisible||p.isDisplayTitleVisible.call(R,arguments[0],M))||(!("isSymbolPropertyVisible"!==i||!p.isSymbolTitleVisible||p.isSymbolTitleVisible.call(R,arguments[0],M))||(!("isData3dPropertyVisible"!==i||!p.isData3dTitleVisible||p.isData3dTitleVisible.call(R,arguments[0],arguments[1],M))||!("isScenePropertyVisible"!==i||!p.isSceneTitleVisible||p.isSceneTitleVisible.call(R,arguments[0],M))))))}return!(H.inspectorCompact&&p[i]&&!p[i].apply(R,arguments))}})},qI=ht.Default.labelColor,QI=function(i){function H(R){hR(this,H);var M=CR(this,i.call(this,R)),I=M.gv=new ht.graph.GraphView,p=I.dm();I.setMovableFunc(function(){return!1}),I.setZoomable(!1),I.setPannable(!1),I.setPannable(!1),I.setRectSelectable(!1),I.setScrollBarVisible(!1),I.sm().setSelectionMode("single"),p.setBackground(KR.config.color_pane);for(var h=1;h<56;h++){var z=new ht.Node;z.setTag(h),z.setRect(80,60,300,160),z.s({label:"   "+h+"   ","label.position":h,"label.offset.x":0,"label.offset.y":0,"label.color":qI,"label.font":"18px Arial",shape:"rect","shape.background":null,"shape.border.width":1,"select.width":0,interactive:!0}),p.add(z)}I.sm().ms(function(i){!M._openSetting&&I.sm().ld()&&R.close()});var d=ht.Default.brighter(KR.config.color_select,50);return I.mi(function(i){var H=i.data,R=i.kind;"onEnter"===R?(H._hover=!0,H.iv()):"onLeave"===R&&(H._hover=!1,H.iv())}),I.getLabelBackground=function(i){return I.isSelected(i)?KR.config.color_select:i._hover?d:null},M}return dR(H,i),H.prototype.getView=function(){return this.gv.getView()},H.prototype.getValue=function(){var i=this.gv.sm().ld();return i?i.s("label.position"):this._sourceValue},H.prototype.getWidth=function(){return 360},H.prototype.getHeight=function(){return 220},H.prototype.onOpened=function(i){var H=this.gv,R=H.dm().getDataByTag(i);this._openSetting=!0,H.sm().ss(R),this._openSetting=!1,this._sourceValue=i,H.fitContent(!1,0)},H.prototype.onClosed=function(){},H}(ht.widget.BaseDropDownTemplate);ht.Default.setImage("editor.inspector.linedash",{width:100,height:20,fitSize:!0,comps:[{type:"shape",borderWidth:2,borderColor:ht.Default.labelColor,borderPattern:{func:"attr@pattern"},points:[0,10,100,10]}]});var mI=function(i){function H(R){hR(this,H);var M=CR(this,i.call(this,R));M.rowHeight=24,M.hoverData=null;var I=M.listView=new eR;I.getIconWidth=function(){return R.getWidth()},I.getLabel=function(){return""},I.getIcon=function(){return"editor.inspector.linedash"},I.setRowHeight(M.rowHeight),I.onDataClicked=function(){R.close()},[null].concat(KR.config.lineDashPatterns).forEach(function(i){var H=new ht.Data;H.a("pattern",i),I.dm().add(H)}),I.getView().style.background=KR.config.color_pane,I.getView().addEventListener("mousemove",function(i){var H=I.getDataAt(i);H!==M.hoverData&&(M.hoverData=H,I.redraw())});var p=M;return I.drawRowBackground=function(i,H,R,M,I,h,z){if(R)i.fillStyle=this.getSelectBackground();else{if(H!==p.hoverData)return;i.fillStyle=KR.config.color_hover}i.fillRect(M,I,h,z)},M}return dR(H,i),H.prototype.getView=function(){return this.listView.getView()},H.prototype.onOpened=function(i){if(i){var H=this.listView;H.dm().each(function(R){var M=R.a("pattern");M&&M.join(",")===i.join(",")&&H.sm().ss(R)})}},H.prototype.onClosed=function(){delete this.hoverData},H.prototype.getWidth=function(){return this.getMaster().getWidth()},H.prototype.getValue=function(){var i=this.listView,H=i.sm().ld();return H?H.a("pattern"):null},H.prototype.getHeight=function(){return this.listView.dm().size()*this.rowHeight},H}(ht.widget.BaseDropDownTemplate),XI=function(i){function H(R,M,I){var p=arguments.length>3&&void 0!==arguments[3]&&arguments[3];hR(this,H);var h=CR(this,i.call(this));h.setHPadding(8),h.setVPadding(0);var z=KR.config.indent,d=h.getHGap();return h.indent=z,h.indent2=KR.config.indent2,h.w1=[z,.1],h.w1w1=[z,.1,z,.1],h.wcc=[z,40+2*d+"+0.1",z,20,.1,20],h.w2=[z-20-d,20,.1,z,.1],h.w3=[z-20-d,20,.1,20,.1,20,.1],h.w20=20+d+"+0.1",h.global=p,h.editor=R,h.name=M,h.type=I,h.inspectorFilter=new KI(R,h),h.updateHandlers=[],h.propertyChangeHandlers=[],h.editor.fireEvent("inspectorInitializing",{inspector:h}),h.initForm(),h.editor.fireEvent("inspectorInitialized",{inspector:h}),h.editor.fireEvent("inspectorCreated",{inspector:h}),h.$46$=h._rows,h.selection=void 0,h}return dR(H,i),H.prototype.initForm=function(){},H.prototype.beginTransaction=function(){this.dataModel&&this.dataModel.beginTransaction()},H.prototype.endTransaction=function(){this.dataModel&&this.dataModel.endTransaction()},H.prototype.addUpdateHandler=function(i){this.updateHandlers.push(i)},H.prototype.removeUpdateHandler=function(i){C(this.updateHandlers,i)},H.prototype.addPropertyChangeHandler=function(i){this.propertyChangeHandlers.push(i)},H.prototype.removePropertyChangeHandler=function(i){C(this.propertyChangeHandlers,i)},H.prototype.$102$=function(){for(var i=this._rows,H=!0,R=i.length-1;R>=0;R--)i[R].title?H?this.removeRow(i[R]):H=!0:H=!1},H.prototype.isTitleVisible=function(i){return!1!==i.visible&&(!Di(i.visible)||!1!==i.visible(this))},H.prototype.isPropertyVisible=function(i){if(!1===i.visible)return!1;if(Di(i.visible)&&!i.visible(this))return!1;var H=this.editor.inspectorInputFilter;if(H){if(!i.keys)return!1;H=H.toLowerCase();var R=i.keys.name;if(R&&R.toLowerCase().indexOf(H)>=0)return!0;var M=i.keys.displayName;return!!(M&&M.toLowerCase().indexOf(H)>=0)}return!0},H.prototype.makeItemsHidden=function(i){var H=this;i.hidden=!0,i.forEach(function(i){var R=H.getItemView(i);R&&(R.style.display="none")})},H.prototype.makeItemsVisible=function(i){var H=this;i.hidden=!1,i.forEach(function(i){var R=H.getItemView(i);R&&(R.style.display="block")})},H.prototype.filterPropertiesLater=function(){var i=this;this._filterPropertiesLater||(this._filterPropertiesLater=!0,requestAnimationFrame(function(){i.filterProperties()}))},H.prototype.isTitleExpanded=function(i){return!(i&&!this.editor.inspectorInputFilter)||KR.config.expandedTitles[i]},H.prototype.filterProperties=function(){var i=this;this._filterPropertiesLater=!1;var H=[];this._currentTitle=null;var R=!1;this.$46$.forEach(function(M){var I=M.items;M.title?(!R&&"$$HTISFUCKINGAWESOME$$"!==i._currentTitle&&H.length&&H[H.length-1].title&&i.makeItemsHidden(H.pop().items),i.isTitleVisible(M)?(i._currentTitle=M.title,M.button.setIcon(i.isTitleExpanded(i._currentTitle)?"expandIcon":"collapseIcon"),H.push(M),i.makeItemsVisible(I)):(i._currentTitle="$$HTISFUCKINGAWESOME$$",i.makeItemsHidden(I)),R=!1):"$$HTISFUCKINGAWESOME$$"===i._currentTitle?i.makeItemsHidden(I):(i.isTitleExpanded(i._currentTitle)&&i.isPropertyVisible(M)?(H.push(M),i.makeItemsVisible(I)):i.makeItemsHidden(I),!R&&i.isPropertyVisible(M)&&(R=!0))}),!R&&"$$HTISFUCKINGAWESOME$$"!==this._currentTitle&&H.length&&H[H.length-1].title&&this.makeItemsHidden(H.pop().items),this._currentTitle=null,this._rows=H,this.updateProperties(),this.iv()},H.prototype.addTitle=function(i,H){var R=this;H=H||{};var M=this._oldTitle;this.editor.fireEvent("titleCreating",{oldTitle:M,title:i,inspector:this});var I=function(){KR.config.expandedTitles[i]=!KR.config.expandedTitles[i],R.filterProperties()},p=[],h=this.addButton(p,null,null,null,I,!0);h.setBorderColor(null),H.icon&&this.addImage(p,function(){return H.icon}),this.addTitleItem(p,i,H),H.title=i,H.background||(H.background=KR.config.inspectorTitleBackground||KR.config.color_pane_dark),H.button=h;var z=[20,.1];H.icon&&(z=[20,20,.1]);var d=H.buttons;if(d){var C=void 0,y=void 0;if(fi(d)?C=d:(C=d.items,y=d.widths),!y){y=[];for(var b=0,U=C.length;b<U;b++)y.push(20)}p.push.apply(p,C),z.push.apply(z,y)}var K=this.addRow(p,z,KR.config.inspectorTitleHeight||null,H);return this._oldTitle=i,this.editor.fireEvent("titleCreated",{oldTitle:M,title:i,inspector:this}),K},H.prototype.addTitleItem=function(i,H,R){var M=p("editor."+H.toLowerCase(),!0)||p(H);i.push({element:M,font:KR.config.boldFont})},H.prototype.$34$=function(i){var H=this;i&&(this.propertyChangeHandlers.forEach(function(R){R(i,H)}),this.$46$.forEach(function(R){R.onPropertyChanged&&R.onPropertyChanged(i,H)})),this._updatePropertiesLater||(this._updatePropertiesLater=!0,requestAnimationFrame(function(){H.updateProperties()}))},H.prototype.updateProperties=function(){this._updating=!0,this.updateHandlers.forEach(function(i){i()}),this.editor.fireEvent("propertiesUpdated",{inspector:this}),this._updating=!1,this._updatePropertiesLater=!1},H.prototype.eachSelection=function(i){this.dataModel&&(this.beginTransaction(),this.dataModel.sm().each(function(H){i(H)}),this.endTransaction())},H.prototype.getPropertyValue=function(i,H){H=this.fixAccessType(H);var R=q(H,i);return this.getValue(R)},H.prototype.setPropertyValue=function(i,H,R,M){R=this.fixAccessType(R);var I=Q(R,i);I.once=M,this.setValue(I,H)},H.prototype.getValue=function(i){if(this.dataModel)return this.global?i(this.dataModel):this.data?i(this.data):void 0},H.prototype.setValue=function(i,H,R){if(!this._updating&&this.dataModel&&this.editor.editable){if(this.beginTransaction(),this.global)i(this.dataModel,R?R():H);else if(i.once)this.data&&i(this.data);else{var M=this.selection;M&&0!==M.length||(M=this.dataModel.sm().getSelection()),M.forEach(function(M){i(M,R?R():H)})}this.endTransaction()}},H.prototype.addLabelArray=function(i,H,R,M,I,p,h){return this.addLabel(i,H,R,M,void 0,h),this.addArray(i,R,M,I,p)},H.prototype.addLabelTextArea=function(i,H,R,M,I){return this.addLabel(i,H,R,M,void 0,I),this.addTextArea(i,R,M)},H.prototype.addLabelMultiline=function(i,H,R,M,I){var p=this,h=this.addLabelInput(i,H,R,M,void 0,void 0,void 0,I);return this.addButton(i,"...",null,null,function(i){p.selection=p.editor.selection;var I=function(i){p.setValue(M,i),p.selection=void 0};p.editor.textView.open(p.getValue(R),I,H,function(){return p.selection=void 0})},!0),h},H.prototype.addLabelInput=function(i,H,R,M,I,p,h,z){return this.addLabel(i,H,R,M,p,z),this.addInput(i,R,M,I,h,p)},H.prototype.addLabelRange=function(i,H,R,M,I,p,h,z,d){var C=this,y=function(i){var H=R(i);return null==H?p:H};return this.addLabelInput(i,H,y,M?function(i,H){void 0!==p&&H>p&&(H=p),void 0!==I&&H<I&&(H=I);var R=y(i);M(i,H),R!==H||R!==p&&R!==I||C.updateProperties()}:null,z,h,void 0,d)},H.prototype.addLabelPosition=function(i,H,R,M,I){var p=this,h=function(i){var H=R(i);return null==H?1:H},z=function(i,H){H>55&&(H=55),H<1&&(H=1),M(i,H)};this.addLabel(i,H,h,z,1,I);var d=new ht.widget.MultiComboBox;return d.setEditable(!0),d.setDropDownComponent(QI),d.onValueChanged=function(i,H){p.setValue(M,H)},i.push(d),this.updateHandlers.push(function(){var i=p.getValue(h);d.setValue(i)}),d},H.prototype.addLabelDashPattern=function(i,H,R,M,I){var p=this;this.addLabel(i,H,R,M,null,I);var h=new ht.widget.MultiComboBox;return h.setEditable(!0),h.setDropDownComponent(mI),h.onValueChanged=function(i,H){ti(H)&&(H=H.split(",").map(function(i){return Number(i)})),p.setValue(M,H)},i.push(h),this.updateHandlers.push(function(){var i=p.getValue(R);h.setValue(i)}),h},H.prototype.addLabelColor=function(i,H,R,M,I){return this.addLabel(i,H,R,M,void 0,I),this.addColor(i,R,M)},H.prototype.addLabelCheckBox=function(i,H,R,M,I){return this.addLabel(i,H,R,M,void 0,I),this.addCheckBox(i,R,M)},H.prototype.addLabelFunction=function(i,H,R,M,I,p,h){return this.addLabel(i,H,R,M,void 0,h),this.addFunction(i,R,M,I,p)},H.prototype.addLabelDataModel=function(i,H,R,M,I,p,h){return this.addLabel(i,H,R,M,void 0,h),this.addDataModel(i,R,M,I,p)},H.prototype.addLabelObject=function(i,H,R,M,I,p,h){return this.addLabel(i,H,R,M,void 0,h),this.addObject(i,R,M,I,p)},H.prototype.addLabelComboBox=function(i,H,R,M,I,p,h,z){return this.addLabel(i,H,R,M,void 0,z),this.addComboBox(i,R,M,I,p,h)},H.prototype.addLabelComboBoxURL=function(i,H,R,M,I,p,h,z,d){var C=this;this.addLabel(i,H,R,M,void 0,d);var y=this.addComboBox(i,R,M,I,p,h);return M&&(y.setEditable(!0),tH(y,z||function(i,H){return!!H.view.draggingData},function(i){var H=y.getView().value=i.getFileUUID();C.setValue(M,H)})),y},H.prototype.addLabelURL=function(i,H,R,M,I,p){return this.addLabel(i,H,R,M,void 0,p),this.addURL(i,R,M,I)},H.prototype.addURL=function(i,H,R,M){var I=this.addInput(i,H,R);return R&&tH(I,M||function(i,H){return!!H.view.draggingData},function(i){I.getElement().value=i.getFileUUID(),I.handleChange()}),I},H.prototype.addLabelImage=function(i,H,R,M,I){var p=function(i,H){if(!H.view.draggingData)return!1;var R=H.view.draggingData.fileType;return R===oR||R===JR};return this.addLabelURL(i,H,R,M,p,I),this.addImage(i,R,M)},H.prototype.addLabelData=function(i,H,R,M,I){var p=this,h=this.addLabelInput(i,H,function(i){var H=R(i);return H?H.toLabel()||H.getClassName():""},void 0,void 0,void 0,void 0,I);M&&(tH(h,function(i,H){return H.view.draggingData&&p.dataModel===H.view.draggingData.getDataModel()},function(i){p.setValue(M,i)}),h.getElement().onkeydown=function(i){t(i)&&p.setValue(M,null)});var z=new ht.widget.Image;return z.drawImage=function(i,H,R,M,I,h){var d=z.data,C=p.editor.list;d&&C&&C.dm().contains(d)&&(H=C.getIcon(d))&&S(i,ht.Default.getImage(H),"centerUniform",R,M,I,h,d,C)},this.updateHandlers.push(function(){if(!i.hidden){var H=z.data;z.data=p.getValue(R),z.fp("data",H,z.data)}}),i.push(z),h},H.prototype.addLabelGradient=function(i,H,R,M,I,p){var h=this,z=[],d=function(){return h.data&&h.data.s(I)||KR.config.color_light},C=function(){return h.data&&h.data.s(M)||KR.config.color_select};KR.consts.gradients.forEach(function(i){i?z.push({width:20,height:14,comps:[{type:"rect",rect:[0,0,20,14],gradient:i,gradientColor:{func:d},background:{func:C}}]}):z.push({width:20,height:14,comps:[]})});var y=this.addLabelComboBox(i,H,function(i){return i.s(R)},function(i,H){i.s(R,H)},KR.consts.gradients,null,z,p);return this.updateHandlers.push(function(){if(!i.hidden){var H=d(),R=C();y._lastGradientColor===H&&y._lastBackground===R||(y._lastGradientColor=H,y._lastBackground=R,y.iv())}}),y},H.prototype.addLabelFont=function(i,H,R,M,I){var p=this,h=this.addLabelInput(i,H,function(i){return R(i)||ht.Default.labelFont},M?function(i,H){M(i,H||void 0)}:null,void 0,void 0,void 0,I);return this.addButton(i,"...",null,null,function(i){p.selection=p.editor.selection;var I=function(i){p.setValue(M,i),p.selection=void 0};p.editor.fontView.open(p.getValue(R),I,H,function(){return p.selection=void 0})},!0),h},H.prototype.addLabelRotation=function(i,H,R,M,I,p,h,z){return this.addLabelInput(i,H,function(i){return null==R(i)?p:180/Math.PI*R(i)},M?function(i,H){H=H*Math.PI/180,void 0!==p&&H>p&&(H=p),void 0!==I&&H<I&&(H=I),M(i,H)}:null,"number",h||1,void 0,z)},H.prototype.addLabelAlign=function(i,H,R,M,I){return this.addLabelComboBox(i,H,function(i){return R(i)||"center"},M,KR.consts.aligns,KR.consts.alignLabels,void 0,I)},H.prototype.addLabelVAlign=function(i,H,R,M,I){return this.addLabelComboBox(i,H,function(i){return R(i)||"bottom"},M,KR.consts.vAligns,KR.consts.vAlignLabels,void 0,I)},H.prototype.addLabelStretch=function(i,H,R,M,I){return this.addLabelComboBox(i,H,function(i){return R(i)||"fill"},M,KR.consts.stretchs,KR.consts.stretchLabels,void 0,I)},H.prototype.addLabelOrientation=function(i,H,R,M,I){return this.addLabelComboBox(i,H,function(i){return R(i)||"top"},M,KR.consts.orientations,KR.consts.orientationLabels,void 0,I)},H.prototype.addLabelLabel=function(i,H,R,M,I){return this.addLabelInput(i,H,function(i){var H=R(i);return H&&H.replace&&(H=H.replace(/\n/g,"\\n")),H},M?function(i,H){H&&H.replace&&(H=H.replace(/\\n/g,"\n")),M(i,H)}:null,void 0,void 0,void 0,I)},H.prototype.toDisplayName=function(i){var H="";return i.forEach(function(i){if(i)if(ti(i))H+=i;else if(ti(i.element))H+=i.element;else{if(!i.element)return;i.element.innerHTML&&(H+=i.element.innerHTML)}}),H},H.prototype.addLabel=function(i,H,R,M,I,p){var h=this,z=void 0,d=!1,C=R&&M&&I,y=KR.config.dataBindings;if(p&&y.onButtonClicked&&(!y.filter||y.filter(p.accessType,p.name,this))&&(d=!0),d||C){z=MH(H,i.length?"right":"left"),i.push(z),z.style.cursor=C?"ew-resize":"pointer";var b=function(i){i.preventDefault(),h.beginTransaction();var H=C?h.getValue(R)||0:0,z=f(i).x,y=!1,b=function(i){if(i.preventDefault(),C){var R=H+(f(i).x-z)*(Di(I)?I():I);h.setValue(M,R),y=!0}};window.addEventListener("mousemove",b,!1),window.addEventListener("touchmove",b,!1);var U=function(i){h.endTransaction(),i.preventDefault(),window.removeEventListener("mousemove",b,!1),window.removeEventListener("touchmove",b,!1),window.removeEventListener("mouseup",U,!1),window.removeEventListener("touchend",U,!1),y&&d&&p.onEndEditing&&p.onEndEditing(h.data),d&&!y&&KR.config.dataBindings.onButtonClicked(h.data,p.accessType,p.name,h.editor)};window.addEventListener("mouseup",U,!1),window.addEventListener("touchend",U,!1)};z.addEventListener("mousedown",b,!1),z.addEventListener("touchstart",b,!1)}else z={element:H,align:i.length?"right":"left"},i.push(z);return d&&this.updateHandlers.push(function(){if(h.data){var i=KR.config.isDataBound(h.data,p.accessType,p.name);z.style.color=i?KR.config.color_select:KR.config.color_dark}}),z},H.prototype.createHandleChange=function(i,H,R){var M=this;return function(){var I=i.value;if("pattern"===R)if(I=I.trim()){if(I.indexOf("[")<0||I.indexOf("]")<0)return;if(I=I.replace("[","").replace("]","").split(","),I.length){for(var p=[],h=0;h<I.length;h++){var z=parseFloat(I[h]);if(isNaN(z))return;p.push(z)}I=p}else I=void 0}else I=void 0;else if("number"===R){if(I=parseFloat(I),isNaN(I))return}else if("int"===R){if(I=parseInt(I),isNaN(I))return}else I||(I=void 0);M.setValue(H,I)}},H.prototype.createArrayIndexColumn=function(i,H,R,I,h){var z=this,d=i[H],C="object"===I?F(d,void 0,!1):d;return{name:H,width:50,align:"center",editable:!!R,sortable:!1,clickable:!1,getValueType:function(i){return I},getValue:function(i){return C},setValue:function(I,p,h,d){z.setValue(R,void 0,function(){var R=i.slice();return R[H]=M(h),R})},isCellEditable:function(i,R,M,C){if(!z.editor.editable)return!1;if("object"===I){var y=p("editor.object")+" ["+H+"]";return z.editor.objectView.open(d,function(H){R.setValue(i,R,H,C)},y,null,h&&h.objectProperties),!1}return!0}}},H.prototype.addArray=function(i,H,R,M,I){var h=this,z=new $R;z.getTableHeader().setMovable(!1),z.getView().style.border=KR.config.color_line+" solid 1px";var d=z.getTableView();return d.getDataModel().add(new ht.Data),this.updateHandlers.push(function(){if(!i.hidden){var C=h.getValue(H);if(d.getColumnModel().clear(),z.addColumns([{name:p("editor.length"),width:50,align:"center",editable:!!R,sortable:!1,clickable:!1,valueType:"int",getValue:function(i){return C?C.length:0},setValue:function(i,H,I,p){h.setValue(R,void 0,function(){if(I>=0){var i=yH(C,I);return"number"===M||"int"===M?dH(i):"color"===M&&CH(i),i}})}}]),C){for(var y=[],b=0;b<C.length;b++)y.push(h.createArrayIndexColumn(C,b,R,M,I));z.addColumns(y)}}}),i.push(z),z},H.prototype.addTextArea=function(i,H,R){var M=this,I=new ht.widget.TextArea,p=I.getElement();return R?(p.onblur=function(){M.setValue(R,p.value)},p.forceOnblur=p.onblur):I.setEditable(!1),this.updateHandlers.push(function(){if(!i.hidden){var R=M.getValue(H);null==R&&(R=""),p.value!==R&&(p.value=R)}}),i.push(I),I},H.prototype.addInput=function(i,H,R,M,p,h){var z=this,d=new ht.widget.TextField;"number"!==M&&"int"!==M||(d.setType("number"),Ti(h)&&(d.getElement().step=h));var C=d.getElement();if(R){var y=this.createHandleChange(C,R,M);d.handleChange=y,p?(C.onkeyup=y,C.onchange=y):(C.onblur=y,C.forceOnblur=C.onblur,C.onkeydown=function(i){O(i)&&y()})}else d.setEditable(!1);return this.updateHandlers.push(function(){if(!i.hidden){var R=z.getValue(H);"pattern"===M?R=R?"["+R.join()+"]":"":"number"===M?R=I(parseFloat(R||0)):"int"===M?R=parseInt(R||0):null==R&&(R=""),C.value!==R&&(ti(R)&&R.length>1e3&&R.startsWith("data:image")&&(R=R.substr(0,10)+"[...]"),C.value=R)}}),i.push(d),d},H.prototype.addColor=function(i,H,R){var M=this,I=new ht.widget.ColorPicker;return R?(I.setInstant(!0),I.onValueChanged=function(){M.setValue(R,I.getValue())},I.addViewListener(function(i){"open"===i.kind?M.beginTransaction():"close"===i.kind&&M.endTransaction()})):I.setDisabled(!0),this.updateHandlers.push(function(){if(!i.hidden){var R=M.getValue(H);void 0===R&&(R=null),I.getValue()!=R&&I.setValue(R)}}),i.push(I),I},H.prototype.addImage=function(i,H,R){var M=this,I=new ht.widget.Image;return cH(I,this.editor),this.updateHandlers.push(function(){if(!i.hidden||i.forceToUpdate){var R=M.getValue(H);I.setExtraInfo(R)}}),i.push(I),I},H.prototype.addCheckBox=function(i,H,R){var M=this,I=new ht.widget.CheckBox;return R?(I.handleClick=function(){M.editor.editable&&I.setSelected(!I.isSelected())},I.onValueChanged=function(){M.setValue(R,I.getValue())}):I.setDisabled(!0),this.updateHandlers.push(function(){if(!i.hidden){var R=!!M.getValue(H);I.getValue()!==R&&I.setValue(R)}}),i.push(I),I},H.prototype.addFunction=function(i,H,R,M,I){var h=this,z=function(){var i=p("editor.function")+" - "+(M||"");h.selection=h.editor.selection;var z=function(i){h.setValue(R,i),h.selection=void 0};h.editor.functionView.open(h.getValue(H),z,i,I,function(){return h.selection=void 0})},d=IH(M,null,null,z);return i.push(d),this.updateHandlers.push(function(){if(!i.hidden){var R=h.getValue(H);d.setLabel(M||b(R)),d.setLabelColor(R?KR.config.color_select:ht.Default.labelColor)}}),d},H.prototype.addDataModel=function(i,H,R,M,I){var p=this,h=function(){p.selection=p.editor.selection;var i=function(i){p.setValue(R,i),p.selection=void 0};p.editor.dataModelView.open(p.getValue(H),i,p.editor.editable,I,function(){return p.selection=void 0})},z=IH(M,null,null,h);return i.push(z),this.updateHandlers.push(function(){if(!i.hidden){var R=p.getValue(H);z.setLabel(M),z.setLabelColor(R?KR.config.color_select:ht.Default.labelColor)}}),z},H.prototype.addObject=function(i,H,R,M,I){var h=this,z=function(){var i=p("editor.object")+" - "+(M||"");h.selection=h.editor.selection;var z=function(i){h.setValue(R,i),h.selection=void 0};h.editor.objectView.open(h.getValue(H),z,i,function(){return h.selection=void 0},I)},d=IH(M,null,null,z);return i.push(d),this.updateHandlers.push(function(){if(!i.hidden){
var R=h.getValue(H);d.setLabel(M||F(R,void 0,!1)),d.setLabelColor(void 0!==R?KR.config.color_select:ht.Default.labelColor)}}),d},H.prototype.addComboBox=function(i,H,R,M,I,p){var h=this,z=new ht.widget.ComboBox;return z.setValues(M),z.setLabels(I),z.setIcons(p),z.setDisabled(!R),R&&(z.onValueChanged=function(){h.setValue(R,z.getValue())}),this.updateHandlers.push(function(){if(!i.hidden){var R=h.getValue(H);z.getValue()!==R&&z.setValue(R)}}),p&&p[0].width&&z.setIndent(p[0].width+4),i.push(z),z},H.prototype.addButton=function(i,H,R,M,I,p){var h=this,z=function(){h.global||p?I():h.eachSelection(I)},d=IH(H,R,M,z);return i.push(d),d},H.prototype.addDBRow=function(i,H,R,M,I,p,h){var z=this,d=i.length,C=this.indent,y=void 0;if(!KR.config.dataBindings.onButtonClicked||!1===h||KR.config.dataBindings.filter&&!KR.config.dataBindings.filter(H,R,this))p?y=this.addRow(i,p,I,M):2===d?y=this.addRow(i,[C,.1],I,M):3===d?y=this.addRow(i,[C,.1,20],I,M):4===d?y=this.addRow(i,[C,.1,20,20],I,M):5===d?y=this.addRow(i,[C,.1,20,20,20],I,M):1===d&&(y=this.addRow(i,[.1],I,M));else{var b=function(){KR.config.dataBindings.onButtonClicked(z.data,H,R,z.editor)},U=void 0;U=KR.config.dataBindings.getToolTip?KR.config.dataBindings.getToolTip(H,R,this):H+":"+R;var K=this.addButton(i,null,U,null,b,!0);this.updateHandlers.push(function(){if(!i.hidden&&z.data){var M=KR.config.isDataBound(z.data,H,R);K.setIcon(M?"editor.bind.state":"editor.unbind.state")}}),p?(p=p.slice(),p.push(20),y=this.addRow(i,p,I,M)):2===d?y=this.addRow(i,[C,.1,20],I,M):3===d?y=this.addRow(i,[C,.1,20,20],I,M):4===d?y=this.addRow(i,[C,.1,20,20,20],I,M):5===d?y=this.addRow(i,[C,.1,20,20,20,20],I,M):1===d&&(y=this.addRow(i,[.1,20],I,M))}return y.keys={name:R,displayName:this.toDisplayName(i),accessType:H},!this.addingCustomProperties&&PR[this.type]&&PR[this.type][H+":"+R]&&this.removeRows([y]),y},H.prototype.addFuncRow=function(i,H,R,M,I){var p=this,h=this.indent,z=void 0,d=void 0;if(!KR.config.dataBindingsForSymbol.filter||KR.config.dataBindingsForSymbol.filter(R||H,this)){var C=function(){p.dataModel&&p.editor.funcView.toggle(z,H,R,p)},y=void 0;y=KR.config.dataBindingsForSymbol.getToolTip?KR.config.dataBindingsForSymbol.getToolTip(R||H,this):(R||H)+": { func: ... }",z=this.addButton(i,null,y,null,C,!0),this.updateHandlers.push(function(){if(!i.hidden){var R=!1;p.global?p.dataModel&&(R="clip"===H?Di(p.dataModel.a(H)):!!p.dataModel.a(H+"_func")):p.data&&(R=!!p.data.a(H)),z.setIcon(R?"editor.bind.state":"editor.unbind.state")}});var b=i.length;I?(I=I.slice(),I.push(20),d=this.addRow(i,I,M)):3===b?d=this.addRow(i,[h,.1,20],M):4===b?d=this.addRow(i,[h,.1,20,20],M):5===b?d=this.addRow(i,[h,.1,20,20,20],M):6===b&&(d=this.addRow(i,[h,.1,20,20,20,20],M))}else{var U=i.length;I?d=this.addRow(i,I,M):2===U?d=this.addRow(i,[h,.1],M):3===U?d=this.addRow(i,[h,.1,20],M):4===U?d=this.addRow(i,[h,.1,20,20],M):5===U?d=this.addRow(i,[h,.1,20,20,20],M):6===U&&(d=this.addRow(i,[h,.1,20,20,20,20],M))}return d.keys={name:R||H,displayName:this.toDisplayName(i)},!this.addingCustomProperties&&PR[this.type]&&PR[this.type][R||H]&&this.removeRows([d]),d},H.prototype.addNameRow=function(i,H,R,M,I,p){var h=this.indent,z=i.length,d=void 0;return I?d=this.addRow(i,I,M,p):2==z?d=this.addRow(i,[h,.1],M,p):3===z?d=this.addRow(i,[h,.1,20],M,p):4===z?d=this.addRow(i,[h,.1,20,20],M,p):5===z&&(d=this.addRow(i,[h,.1,20,20,20],M,p)),d.keys={name:H,displayName:this.toDisplayName(i),accessType:R},H=(R?R+":":"")+H,!this.addingCustomProperties&&PR[this.type]&&PR[this.type][H]&&this.removeRows([d]),d},H.prototype.$77$=function(){var i=this;this.addTitle("TitleGridsGuides");var H=[];this.addLabelCheckBox(H,p("editor.gridenabled"),function(i){return i.a("gridEnabled")},function(i,H){i.a("gridEnabled",H)}),this.addButton(H,p("editor.skew"),null,null,function(){i.editor.currentView&&i.editor.currentView.skewGrid&&i.editor.currentView.skewGrid()}),this.addButton(H,p("editor.reset"),null,null,function(){i.editor.currentView&&i.editor.currentView.resetGrid&&i.editor.currentView.resetGrid()}),this.addNameRow(H,"gridEnabled","a",void 0,[this.indent,20,.1,.1]),H=[],this.addLabelInput(H,p("editor.gridblocksize"),function(i){return i.a("gridBlockSize")},function(i,H){H>0&&i.a("gridBlockSize",H)},"int",1),this.addNameRow(H,"gridBlockSize","a"),H=[],this.addLabelInput(H,p("editor.gridthicklinesevery"),function(i){return i.a("gridThickLinesEvery")},function(i,H){H>0&&i.a("gridThickLinesEvery",H)},"int",1),this.addNameRow(H,"gridThickLinesEvery","a"),H=[],this.addLabelColor(H,p("editor.gridlightcolor"),function(i){return i.a("gridLightColor")},function(i,H){i.a("gridLightColor",H)}),this.addNameRow(H,"gridLightColor","a"),H=[],this.addLabelColor(H,p("editor.gridthickcolor"),function(i){return i.a("gridThickColor")},function(i,H){i.a("gridThickColor",H)}),this.addNameRow(H,"gridThickColor","a"),H=[],this.addLabelInput(H,p("editor.gridangle"),function(i){return 180/Math.PI*i.a("gridAngle")},function(i,H){i.a("gridAngle",H*Math.PI/180)},"number",1),this.addNameRow(H,"gridAngle","a"),H=[],this.addLabelInput(H,p("editor.gridrotation"),function(i){return 180/Math.PI*i.a("gridRotation")},function(i,H){i.a("gridRotation",H*Math.PI/180)},"number",1),this.addNameRow(H,"gridRotation","a"),H=[],this.addLabelInput(H,p("editor.gridzoomthreshold"),function(i){return i.a("gridZoomThreshold")},function(i,H){H>0&&i.a("gridZoomThreshold",H)},"number",.01),this.addNameRow(H,"gridZoomThreshold","a")},H.prototype.addHighlightProperties=function(){},H.prototype.$26$=function(){var i=this;this.addTitle("TitleEditingPoint");var H={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3};this.editingPointButtons=[];var R=function(R,M){var I=p("editor.editingpoint."+M.toLowerCase()),h="editor.point."+M.toLowerCase(),z=IH(I,null,h,function(){i.editor.editInteractor.getSubModule("Curve").setCurrentSelectionStatus(z.statusValue)});z.setOrientation("v"),z.setTogglable(!0),z.setGroupId("editingPoint"),z.statusValue=H[M],i.editingPointButtons.push(z),R.push(z)},M=[];R(M,"Straight"),R(M,"Mirrored"),this.addRow(M,[.1,.1],60).items.tag="editingPointType",M=[],R(M,"Disconnected"),R(M,"Asymmetric"),this.addRow(M,[.1,.1],60).items.tag="editingPointType",KR.SceneView&&(M=[],M.push(p("editor.point")),this.addLabelInput(M,"X",function(H){return i.editor.getCurrentEditingPointValue("x")},function(H,R){return i.editor.setCurrentEditingPointValue("x",R)},"number",1),this.addLabelInput(M,"Y",function(H){return i.editor.getCurrentEditingPointValue("y")},function(H,R){return i.editor.setCurrentEditingPointValue("y",R)},"number",1),this.addNameRow(M,"currentEditingPoint.x.y",void 0,void 0,this.w2).visible=function(){return!(i.currentView instanceof KR.SceneView)},M=[],M.push(p("editor.point")),this.addLabelInput(M,"X",function(H){return i.editor.getCurrentEditingPointValue("x")},function(H,R){return i.editor.setCurrentEditingPointValue("x",R)},"number",1),this.addLabelInput(M,"Y",function(H){return i.editor.getCurrentEditingPointValue("e")},function(H,R){return i.editor.setCurrentEditingPointValue("e",R)},"number",1),this.addLabelInput(M,"Z",function(H){return i.editor.getCurrentEditingPointValue("y")},function(H,R){return i.editor.setCurrentEditingPointValue("y",R)},"number",1),this.addNameRow(M,"currentEditingPoint.x.y.z",void 0,void 0,this.w3).visible=function(){return i.currentView instanceof KR.SceneView})},H.prototype.addCustomProperties=function(){var i=this,H=KR.config.customProperties[this.type];H&&H.length&&(this.addTitle("TitleCustom"),H.forEach(function(H){i.addCustomProperty(H)}))},H.prototype.fixAccessType=function(i){return i=i||"a","symbol"===this.type?i="a":"comp"===this.type&&(i="s"),i},H.prototype.addEventProperties=function(i){var H=this,R=void 0;i?R=!1:(i=[],R=!0);var M=function(){var i=H.global?H.dataModel:H.data;i&&(i=H.global?[H.dataModel]:H.editor.selection),H.editor.eventView.open(i,H.type)};this.addLabel(i,p("editor.events"));var I=this.addButton(i,p("editor.eventhandlers"),null,null,M,!0);R&&("data"===this.type||"data3d"===this.type?(this.addLabel(i,p("editor.interactive")),this.addCheckBox(i,function(i){return!!i&&i.s("interactive")},function(i,H){i&&i.s("interactive",H)}),this.addRow(i,this.w1w1).keys={name:"eventHandlers",displayName:p("editor.eventhandlers")}):this.addRow(i,this.w1).keys={name:"eventHandlers",displayName:p("editor.eventhandlers")}),this.updateHandlers.push(function(){if(!i.hidden){var R=!1,M=H.global?H.dataModel:H.data;qR.forEach(function(i){R||(R="data"===H.type||"data3d"===H.type?M.s(i):M.a(i))}),I.setLabelColor(R?KR.config.color_select:ht.Default.labelColor)}})},H.prototype.addCustomProperty=function(i){var H=i.name,R=i.valueType,M=!1!==i.editable,I=i.defaultValue,C=this.fixAccessType(i.accessType),y=i.property;if(!(R=KR.config.valueTypes[R]))return!1;this.addingCustomProperties=!0;var b=[],U=p(H)||y,K=q(C,y),m=Q(C,y),X=function(i){var H=K(i);return void 0===H&&(H=I),H},o=M?m:null,J=i.extraInfo,O=void 0,c=void 0,t=void 0;J&&J.enum&&(O=J.enum.values,c=d(J.enum.labels,J.enum.i18nLabels),t=J.enum.icons);var T=i.dataBinding||i.bindable,N=KR.SceneView&&T&&("data"===this.type||"data3d"===this.type),D=void 0;J&&J.buildUI?(D=J.buildUI(this,b,U,X,o,J),N=!1):O?N?this.addActionLabelComboBox(b,U,C,y,O,c,t,X,o):this.addLabelComboBox(b,U,X,o,O,c,t):"int"===R.type||"number"===R.type?R.angle?N?this.addActionLabelRotation(b,U,C,y,R.min,R.max,R.step,X,o):this.addLabelRotation(b,U,X,o,R.min,R.max,R.step):N?this.addActionLabelRange(b,U,C,y,R.min,R.max,R.step,R.type,X,o):this.addLabelRange(b,U,X,o,R.min,R.max,R.step,R.type):"color"===R.type?N?this.addActionLabelColor(b,U,C,y,X,o):this.addLabelColor(b,U,X,o):"boolean"===R.type?N?this.addActionLabelCheckBox(b,U,C,y,X,o):this.addLabelCheckBox(b,U,X,o):"enum"===R.type?N?this.addActionLabelComboBox(b,U,C,y,R.values,R.labels,R.icons,X,o):this.addLabelComboBox(b,U,X,o,R.values,R.labels,R.icons):"image"===R.type?N?this.addActionLabelImage(b,U,C,y,X,o):this.addLabelImage(b,U,X,o):"url"===R.type?N?this.addActionLabelURL(b,U,C,y,void 0,X,o):this.addLabelURL(b,U,X,o):"multiline"===R.type?N?this.addActionLabelMultiline(b,U,C,y,X,o):this.addLabelMultiline(b,U,X,o):"colorArray"===R.type?N?this.addActionLabelArray(b,U,C,y,"color",X,o,J):this.addLabelArray(b,U,X,o,"color",J):"numberArray"===R.type?N?this.addActionLabelArray(b,U,C,y,"number",X,o,J):this.addLabelArray(b,U,X,o,"number",J):"stringArray"===R.type?N?this.addActionLabelArray(b,U,C,y,"string",X,o,J):this.addLabelArray(b,U,X,o,"string",J):"objectArray"===R.type?N?this.addActionLabelArray(b,U,C,y,"object",X,o,J):this.addLabelArray(b,U,X,o,"object",J):"function"===R.type?N?this.addActionLabelFunction(b,U,C,y,y,J&&J.arguments,X,o):this.addLabelFunction(b,U,X,o,y,J&&J.arguments):"dataModel"===R.type?this.addActionLabelDataModel(b,U,C,y,y,X,o):"object"===R.type?N?this.addActionLabelObject(b,U,C,y,y,X,o,J&&J.objectProperties):this.addLabelObject(b,U,X,o,y,J&&J.objectProperties):"font"===R.type?N?this.addActionLabelFont(b,U,C,y,X,o):this.addLabelFont(b,U,X,o):"gradientPack"===R.type?this.addActionLabelGradientPack(b,U,C,y,X,o):"custom"===R.type?(D=R.buildUI(this,b,U,X,o,J),N=!1):N?this.addActionLabelInput(b,U,C,y,void 0,void 0,void 0,X,o):this.addLabelInput(b,U,X,o);var f=void 0;"display"===this.type||"scene"===this.type||N||!T?f=this.addNameRow(b,y,C,h(D,R),z(D,R)):"data"===this.type||"data3d"===this.type?f=this.addDBRow(b,C,y,null,h(D,R),z(D,R)):"symbol"!==this.type&&"comp"!==this.type||(f=this.addFuncRow(b,y,null,h(D,R),z(D,R))),f&&J&&(f.visible=J.visible,f.onPropertyChanged=J.onPropertyChanged),this.addingCustomProperties=!1},H.prototype.addLabelLayer=function(i,H){var R=this,M=q("p","layer"),I=Q("p","layer");this.addLabel(i,p("editor.layer"),void 0,void 0,void 0,H);var h=new ht.widget.ComboBox;return h.onValueChanged=function(){R.setValue(I,h.getValue())},this.updateHandlers.push(function(){if(!i.hidden){h.setValues(R.editor.layerPane.layerNames);var H=R.getValue(M);h.getValue()!==H&&h.setValue(H)}}),i.push(h),h},H.prototype.addLabelIcons=function(i,H){var R=this;this.addLabel(i,p("editor.icons"),void 0,void 0,void 0,H);var M=function(){R.data&&R.editor.iconsView.toggle(I,R.data)},I=this.addButton(i,"Icons","s:icons",null,M,!0);return this.updateHandlers.push(function(){i.hidden||I.setLabelColor(R.data.s("icons")?KR.config.color_select:ht.Default.labelColor)}),I},H.prototype.addLabelBatch=function(i,H){var R=this,M=q("s","batch"),I=Q("s","batch");this.addLabel(i,p("editor.batch"),void 0,void 0,void 0,H);var h=new ht.widget.ComboBox;return h.onValueChanged=function(){R.setValue(I,h.getValue())},this.updateHandlers.push(function(){if(!i.hidden){h.setValues(R.editor.batchView.batchNames);var H=R.getValue(M);h.getValue()!==H&&h.setValue(H)}}),i.push(h),h},H.prototype.addActionLabel=function(i,H,R,M){this.addLabel(i,H,void 0,void 0,void 0,{accessType:R,name:M})},H.prototype.addActionLabelInput=function(i,H,R,M,I,p,h,z,d,C){this.addLabelInput(i,H,q(R,M,z),Q(R,M,d),I,p,h,{accessType:R,name:M,onEndEditing:C})},H.prototype.addActionLabelDashPattern=function(i,H,R,M,I,p,h){this.addLabelDashPattern(i,H,q(R,M,I),Q(R,M,p),{accessType:R,name:M,onEndEditing:h})},H.prototype.addActionLabelData=function(i,H,R,M,I,p){this.addLabelData(i,H,q(R,M,I),Q(R,M,p),{accessType:R,name:M})},H.prototype.addActionLabelRange=function(i,H,R,M,I,p,h,z,d,C){void 0===h&&(h="int"===z?1:.1),this.addLabelRange(i,H,q(R,M,d),Q(R,M,C),I,p,h,z,{accessType:R,name:M})},H.prototype.addActionLabelCheckBox=function(i,H,R,M,I,p){this.addLabelCheckBox(i,H,q(R,M,I),Q(R,M,p),{accessType:R,name:M})},H.prototype.addActionLabelColor=function(i,H,R,M,I,p){this.addLabelColor(i,H,q(R,M,I),Q(R,M,p),{accessType:R,name:M})},H.prototype.addActionLabelImage=function(i,H,R,M,I,p){this.addLabelImage(i,H,q(R,M,I),Q(R,M,p),{accessType:R,name:M})},H.prototype.addActionLabelObject=function(i,H,R,M,I,p,h,z){this.addLabelObject(i,H,q(R,M,p),Q(R,M,h),I,z,{accessType:R,name:M})},H.prototype.addActionLabelComboBox=function(i,H,R,M,I,p,h,z,d){this.addLabelComboBox(i,H,q(R,M,z),Q(R,M,d),I,p,h,{accessType:R,name:M})},H.prototype.addActionLabelComboBoxURL=function(i,H,R,M,I,p,h,z,d,C){this.addLabelComboBoxURL(i,H,q(R,M,d),Q(R,M,C),I,p,h,z,{accessType:R,name:M})},H.prototype.addActionLabelFont=function(i,H,R,M,I,p){this.addLabelFont(i,H,q(R,M,I),Q(R,M,p),{accessType:R,name:M})},H.prototype.addActionLabelPosition=function(i,H,R,M,I,p){this.addLabelPosition(i,H,q(R,M,I),Q(R,M,p),{accessType:R,name:M})},H.prototype.addActionLabelMultiline=function(i,H,R,M,I,p){this.addLabelMultiline(i,H,q(R,M,I),Q(R,M,p),{accessType:R,name:M})},H.prototype.addActionLabelRotation=function(i,H,R,M,I,p,h,z,d){this.addLabelRotation(i,H,q(R,M,z),Q(R,M,d),I,p,h,{accessType:R,name:M})},H.prototype.addActionLabelAlign=function(i,H,R,M,I,p){this.addLabelAlign(i,H,q(R,M,I),Q(R,M,p),{accessType:R,name:M})},H.prototype.addActionLabelVAlign=function(i,H,R,M,I,p){this.addLabelVAlign(i,H,q(R,M,I),Q(R,M,p),{accessType:R,name:M})},H.prototype.addActionLabelStretch=function(i,H,R,M,I,p){this.addLabelStretch(i,H,q(R,M,I),Q(R,M,p),{accessType:R,name:M})},H.prototype.addActionLabelGradient=function(i,H,R,M,I){this.addLabelGradient(i,H,R,M,I,{accessType:"s",name:R})},H.prototype.addActionLabelOrientation=function(i,H,R,M,I,p){this.addLabelOrientation(i,H,q(R,M,I),Q(R,M,p),{accessType:R,name:M})},H.prototype.addActionLabelURL=function(i,H,R,M,I,p,h){this.addLabelURL(i,H,q(R,M,p),Q(R,M,h),I,{accessType:R,name:M})},H.prototype.addActionLabelArray=function(i,H,R,M,I,p,h,z){this.addLabelArray(i,H,q(R,M,p),Q(R,M,h),I,z,{accessType:R,name:M})},H.prototype.addActionLabelFunction=function(i,H,R,M,I,p,h,z){this.addLabelFunction(i,H,q(R,M,h),Q(R,M,z),I,p,{accessType:R,name:M})},H.prototype.addActionLabelDataModel=function(i,H,R,M,I,p,h,z){this.addLabelDataModel(i,H,q(R,M,h),Q(R,M,z),I,p,{accessType:R,name:M})},H.prototype.addActionLabelLayer=function(i){this.addLabelLayer(i,{accessType:"p",name:"layer"})},H.prototype.addActionLabelIcons=function(i){this.addLabelIcons(i,{accessType:"s",name:"icons"})},H.prototype.addActionLabelBatch=function(i){this.addLabelBatch(i,{accessType:"s",name:"batch"})},H.prototype.endEdit=function(){var i=document.activeElement;this.getView().contains(i)&&i.blur()},H}(bR),oI=function(i){function H(R,M){return hR(this,H),CR(this,i.call(this,R,M,"display",!0))}return dR(H,i),H.prototype.initForm=function(){this.addCustomProperties(),this.$11$(),this.addHighlightProperties(),this.$77$()},H.prototype.isTitleVisible=function(H){return!!this.inspectorFilter.isDisplayTitleVisible(this.editor,H.title)&&i.prototype.isTitleVisible.call(this,H)},H.prototype.isPropertyVisible=function(H){return!!this.inspectorFilter.isDisplayPropertyVisible(this.editor,H.keys&&H.keys.name)&&i.prototype.isPropertyVisible.call(this,H)},H.prototype.$11$=function(){this.addTitle("TitleBasic");var i=[];this.addLabelInput(i,p("editor.previewurl"),function(i){return i.a("previewURL")},function(i,H){i.a("previewURL",H)}),this.addNameRow(i,"previewURL","a"),i=[],this.addLabelImage(i,p("editor.snapshoturl"),function(i){return i.a("snapshotURL")},function(i,H){i.a("snapshotURL",H)}),this.addNameRow(i,"snapshotURL","a"),i=[],this.addLabelColor(i,p("editor.background"),function(i){return i.getBackground()},function(i,H){i.setBackground(H)}),this.addNameRow(i,"background","p"),i=[],this.addLabelInput(i,p("editor.width"),function(i){return i.a("width")},function(i,H){i.a("width",H)},"number",1),this.addNameRow(i,"width","a"),i=[],this.addLabelInput(i,p("editor.height"),function(i){return i.a("height")},function(i,H){i.a("height",H)},"number",1),this.addNameRow(i,"height","a"),i=[];var H=[["Obejct","json","editor.comment.json"],["ht.DataModel","dm","editor.comment.datamodel"],["ht.graph.GraphView","view","editor.comment.graphview"]];this.addLabelFunction(i,p("editor.onpredeserialize"),function(i){return i.a("onPreDeserialize")},function(i,H){i.a("onPreDeserialize",H)},"onPreDeserialize",H),this.addNameRow(i,"onPreDeserialize","a"),i=[],H=[["Obejct","json","editor.comment.json"],["ht.DataModel","dm","editor.comment.datamodel"],["ht.graph.GraphView","view","editor.comment.graphview"],["ht.List","datas","editor.comment.datas"]],this.addLabelFunction(i,p("editor.onpostdeserialize"),function(i){return i.a("onPostDeserialize")},function(i,H){i.a("onPostDeserialize",H)},"onPostDeserialize",H),this.addNameRow(i,"onPostDeserialize","a"),i=[],this.addLabelComboBox(i,p("editor.connectactiontype"),function(i){return i.a("connectActionType")},function(i,H){i.a("connectActionType",H)},KR.consts.displayConnectActionTypes,KR.consts.displayConnectActionTypeLabels),this.addNameRow(i,"connectActionType","a"),i=[],this.addLabelCheckBox(i,p("editor.hierarchicalrendering"),function(i){return i.isHierarchicalRendering()},function(i,H){i.setHierarchicalRendering(H)}),this.addNameRow(i,"hierarchicalRendering","p"),i=[],this.addLabelCheckBox(i,p("editor.zoomable"),function(i){return null==i.a("zoomable")||i.a("zoomable")},function(i,H){i.a("zoomable",H)}),this.addNameRow(i,"zoomable","a"),i=[],this.addLabelCheckBox(i,p("editor.pannable"),function(i){return null==i.a("pannable")||i.a("pannable")},function(i,H){i.a("pannable",H)}),this.addNameRow(i,"pannable","a"),i=[],this.addLabelCheckBox(i,p("editor.rectselectable"),function(i){return null==i.a("rectSelectable")||i.a("rectSelectable")},function(i,H){i.a("rectSelectable",H)}),this.addNameRow(i,"rectSelectable","a"),i=[],this.addLabelCheckBox(i,p("editor.fitcontent"),function(i){return null!=i.a("fitContent")&&i.a("fitContent")},function(i,H){i.a("fitContent",H)}),this.addNameRow(i,"fitContent","a"),this.addLayoutProperties()},H.prototype.addLayoutProperties=function(){var i=[p("editor.layout")];this.$79$(i,"circular"),this.$79$(i,"symmetric"),this.$79$(i,"hierarchical"),this.$79$(i,"towardnorth"),this.$79$(i,"towardsouth"),this.$79$(i,"towardeast"),this.$79$(i,"towardwest"),this.addRow(i,[this.indent,.1,.1,.1,.1,.1,.1,.1]).keys={name:"layouts"}},H.prototype.$79$=function(i,H){var R=this,M=function(){R.editor.editable&&R.dataModel&&R.dataModel.layout(H)};return this.addButton(i,null,p("editor.layout."+H),"editor.layout."+H+".state",M)},H}(XI),JI={visible:"Boolean",selectable:"Boolean",movable:"Boolean",editable:"Boolean",opacity:"Opacity",clipPercentage:"Percentage",clipDirection:"ClipDirection",shadow:"Boolean",shadowColor:"Color",shadowBlur:"PositiveNumber",shadowOffsetX:"PositiveNumber",shadowOffsetY:"PositiveNumber",type:"String",background:"Color",repeatImage:"String",borderWidth:"PositiveNumber",borderColor:"Color",border3d:"Boolean",border3dColor:"Color",border3dAccuracy:"PositiveNumber",borderCap:"CapStyle",borderJoin:"JoinStyle",gradient:"Gradient",gradientColor:"Color",dash:"Boolean",dashOffset:"Number",dashColor:"Color",dashWidth:"PositiveNumber",dash3d:"Boolean",dash3dColor:"Color",dash3dAccuracy:"PositiveNumber",borderWidthAbsolute:"Boolean",fillClipPercentage:"Percentage",fillClipDirection:"ClipDirection",depth:"Number",cornerRadius:"PositiveNumber",polygonSide:"Int",arcFrom:"Number",arcTo:"Number",arcClose:"Boolean",arcOval:"Boolean",displayName:"String",scaleX:"Number",scaleY:"Number",anchorX:"Number",anchorY:"Number",rotation:"Number",color:"Color",width:"PositiveNumber",label:"Boolean",labelColor:"Color",labelFont:"String",minValue:"Number",maxValue:"Number",linePoint:"Boolean",lineWidth:"PositiveNumber",line3d:"Boolean",text:"String",align:"Align",vAlign:"VAlign",closePath:"Boolean",fillRule:"FillRule",name:"Image",stretch:"Stretch",values:"NumberArray",colors:"ColorArray",hollow:"Boolean",layoutV:"String",layoutH:"String"},OI=function(i){function H(R,M){return hR(this,H),CR(this,i.call(this,R,M,"symbol",!0))}return dR(H,i),H.prototype.initForm=function(){this.addCustomProperties(),this.addControlProperties(),this.$11$(),this.addHighlightProperties(),this.$77$(),this.addDataBindingProperties()},H.prototype.isTitleVisible=function(H){return!!this.inspectorFilter.isSymbolTitleVisible(this.editor,H.title)&&i.prototype.isTitleVisible.call(this,H)},H.prototype.isPropertyVisible=function(H){return!!this.inspectorFilter.isSymbolPropertyVisible(this.editor,H.keys&&H.keys.name)&&i.prototype.isPropertyVisible.call(this,H)},H.prototype.$11$=function(){var i=this.indent,H=void 0;this.addTitle("TitleBasic"),H=[],this.addLabelInput(H,p("editor.previewurl"),function(i){return i.a("previewURL")},function(i,H){i.a("previewURL",H)}),this.addLabelImage(H,p("editor.snapshoturl"),function(i){return i.a("snapshotURL")},function(i,H){i.a("snapshotURL",H)}),this.addNameRow(H,"previewURL.snapshotURL",void 0,void 0,[i,this.w20,i,.1,20]),H=[],this.addLabelColor(H,p("editor.background"),function(i){return i.getBackground()},function(i,H){i.setBackground(H)}),this.addLabelComboBox(H,p("editor.connectactiontype"),function(i){return i.a("connectActionType")},function(i,H){i.a("connectActionType",H)},KR.consts.symbolConnectActionTypes,KR.consts.symbolConnectActionTypeLabels),this.addNameRow(H,"background.connectActionType",void 0,void 0,this.w1w1),H=[],this.addLabelInput(H,p("editor.width"),function(i){return i.a("width")},function(i,H){i.a("width",H)},"number",1),this.addFuncRow(H,"width"),H=[],this.addLabelInput(H,p("editor.height"),function(i){return i.a("height")},function(i,H){i.a("height",H)},"number",1),this.addFuncRow(H,"height"),H=[],this.addLabelInput(H,p("editor.boundextend"),function(i){return i.a("boundExtend")},function(i,H){i.a("boundExtend",H)},"number",1),this.addFuncRow(H,"boundExtend"),this.addStateProperty(),this.addAttachPointsProperties(),H=[],this.addLabelComboBox(H,p("editor.blendmode"),function(i){return i.a("blendMode")},function(i,H){i.a("blendMode",H)},["multiply","override","override_rgb","override_a"],[p("editor.blendmode.multiply"),p("editor.blendmode.override"),p("editor.blendmode.override_rgb"),p("editor.blendmode.override_a")]),this.addFuncRow(H,"blendMode")},H.prototype.addEventsAndRenderHTMLProperties=function(){var i=this,H=[];this.addEventProperties(H);var R=function(){i.editor.functionView.open(i.getValue(function(i){return i.a("renderHTML")}),function(H){i.setValue(function(i,H){return i.a("renderHTML",H)},H)},p("editor.renderhtml"),[["ht.Node","data","editor.comment.renderhtmlnode"],["ht.graph.GraphView","gv","editor.comment.graphview"],["Object","cache","editor.comment.renderhtmlcache"]])},M=this.addButton(H,p("editor.renderhtml"),null,null,R,!0);this.updateHandlers.push(function(){if(!H.hidden){var R=i.getValue(function(i){return i.a("renderHTML")});M.setLabelColor(R?KR.config.color_select:ht.Default.labelColor)}}),this.addNameRow(H,"eventHandlers.renderhtml",void 0,void 0,[this.indent,.1,.1])},H.prototype.addControlProperties=function(){var i=this;this.addTitle("TitleControl"),this.addEventsAndRenderHTMLProperties();var H=[];if(this.addLabelCheckBox(H,p("editor.visible"),function(i){return i.a("visible")},function(i,H){i.a("visible",H)}),this.addFuncRow(H,"visible"),H=[],this.addLabelCheckBox(H,p("editor.clip"),function(i){return i.a("clip")},function(i,H){i.a("clip",H)}).onValueChanged=function(H,R){i.dataModel&&(R?i.dataModel.a("clip")||i.dataModel.a("clip",!0):i.dataModel.a("clip",!1))},this.addFuncRow(H,"clip"),H=[],this.addLabelCheckBox(H,p("editor.scrollable"),function(i){return i.a("scrollable")},function(i,H){i.a("scrollable",H)}),this.addFuncRow(H,"scrollable"),H=[],this.addLabelCheckBox(H,p("editor.interactive"),function(i){return i.a("interactive")},function(i,H){i.a("interactive",H)}),this.addFuncRow(H,"interactive"),H=[],this.addLabelCheckBox(H,p("editor.disableselectedborder"),function(i){return i.a("disableSelectedBorder")},function(i,H){i.a("disableSelectedBorder",H)}),this.addFuncRow(H,"disableSelectedBorder"),H=[],this.addLabelCheckBox(H,p("editor.pixelperfect"),function(i){return i.a("pixelPerfect")},function(i,H){i.a("pixelPerfect",H)}),this.addFuncRow(H,"pixelPerfect"),H=[],this.addLabelCheckBox(H,p("editor.cacherule"),function(i){return i.a("cacheRule")},function(i,H){i.a("cacheRule",H)}),this.addFuncRow(H,"cacheRule"),H=[],this.addLabelCheckBox(H,p("editor.texturecache"),function(i){return i.a("textureCache")},function(i,H){i.a("textureCache",H)}),this.addFuncRow(H,"textureCache"),H=[],this.addLabelCheckBox(H,p("editor.fitsize"),function(i){return i.a("fitSize")},function(i,H){i.a("fitSize",H)}),this.addFuncRow(H,"fitSize"),KR.SceneView){H=[];var R=function(){i.editor.symbolLayoutView.open(i.getValue(function(i){return i.a("layoutAttach")}),i.getValue(function(i){return i.a("layoutProperties")}),function(H){i.beginTransaction(),i.setValue(function(i,H){return i.a("layoutAttach",H)},H.func),i.setValue(function(i,H){return i.a("layoutProperties",H)},H.properties),i.endTransaction()})};this.addLabel(H,p("editor.layout"));var M=this.addButton(H,p("editor.layoutattach"),null,null,R,!0);this.addRow(H,this.w1),this.updateHandlers.push(function(){if(!H.hidden){var R=i.getValue(function(i){return i.a("layoutAttach")});M.setLabelColor(R?KR.config.color_select:ht.Default.labelColor)}})}},H.prototype.addDataBindingProperties=function(){this.addTitle("TitleDataBinding"),this.$80$(),this.$81$()},H.prototype.$73$=function(i,H,R,M,I){var p=this;return{name:i,tag:i,width:R,displayName:H,align:"center",enum:M,editable:!0,valueType:I,getValue:function(H){var R=H.dataBinding[i];return"bindable"===i&&null==R&&(R=!0),R},setValue:function(H,R,M,I){H.dataBinding[i]!==M&&p.modifyDataBindings(function(){"valueType"===i&&delete H.dataBinding.defaultValue,H.dataBinding[i]=M})}}},H.prototype.$74$=function(){var i=this,H=this.tableView.getColumnModel().getDataByTag("defaultValue");H.getValue=function(i,H,R){var M=i.dataBinding.defaultValue;return"Angle"===i.dataBinding.valueType&&M&&(M=M/Math.PI*180),M},H.setValue=function(H,R,M,I){i.modifyDataBindings(function(){"Angle"===H.dataBinding.valueType&&(M=M*Math.PI/180),H.dataBinding.defaultValue=M})},H.getEnumValues=function(i){var H=i?KR.config.valueTypes[i.dataBinding.valueType]:null;return H&&"enum"===H.type?H.values:null},H.getEnumLabels=function(i){var H=i?KR.config.valueTypes[i.dataBinding.valueType]:null;return H&&"enum"===H.type?H.labels:null},H.getEnumIcons=function(i){var H=i?KR.config.valueTypes[i.dataBinding.valueType]:null;return H&&"enum"===H.type?H.icons:null},H.getEnumDropDownWidth=function(i){var H=i?KR.config.valueTypes[i.dataBinding.valueType]:null;return H&&"enum"===H.type?H.dropDownWidth:null},H.getValueType=function(i){var H=i?KR.config.valueTypes[i.dataBinding.valueType]:null;return H?H.type:null},H.isCellEditable=function(H,R,M,I){var h=KR.config.valueTypes[H.dataBinding.valueType],z=h?h.type:null,d=H.dataBinding.extraInfo,C=KR.config.handleDefaultVauleColumnEdit,y=function(R){i.modifyDataBindings(function(){H.dataBinding.defaultValue=R,i.tableView.redraw()})};if(C&&C(y,h,z,d))return!1;if("function"===z){var b=p("editor.function")+" "+(H.dataBinding.attr||"");return i.editor.functionView.open(H.dataBinding.defaultValue,y,b,d&&d.arguments),!1}if("multiline"===z)return i.editor.textView.open(H.dataBinding.defaultValue,y,H.dataBinding.attr||"&nbsp;"),!1;if("font"===z)return i.editor.fontView.open(H.dataBinding.defaultValue,y,H.dataBinding.attr||"&nbsp;"),!1;if("object"===z||"stringArray"===z||"custom"===z||"objectArray"===z||"numberArray"===z||"colorArray"===z){var U=p("editor.object")+" "+(H.dataBinding.attr||"");return i.editor.objectView.open(H.dataBinding.defaultValue,y,U,null,"object"===z&&d&&d.objectProperties),!1}return"dataModel"!==z||(i.editor.dataModelView.open(H.dataBinding.defaultValue,y,i.editor.editable,d),!1)}},H.prototype.initExtraInfoColumn=function(){var i=this;this.tableView.getColumnModel().getDataByTag("extraInfo").isCellEditable=function(H,R,M,I){var h=p("editor.object")+" "+(H.dataBinding.attr||"");return i.editor.objectView.open(H.dataBinding.extraInfo,function(R){i.modifyDataBindings(function(){H.dataBinding.extraInfo=R,i.tableView.redraw()})},h),!1}},H.prototype.initI18nColumn=function(){var i=this;["name","group"].forEach(function(H){var R=i.tableView.getColumnModel().getDataByTag(H);R.getValue=function(i,R,M){var I=i.dataBinding[H];return i._editing_?I:p(I)},R.setValue=function(i,R,M,I){i.dataBinding[H]=M,delete i._editing_},R.isCellEditable=function(i,H,R,M){return i._editing_=1,!0}})},H.prototype.$80$=function(){var i=this,H=this.tableModel=new ht.DataModel,R=this.tablePane=new $R(H),M=this.tableView=R.getTableView();M.setEditable(!0),M.isEditable=function(){return i.editor.editable},R.getView().style.border=KR.config.color_line+" solid 1px",R.addColumns([this.$73$("attr",p("editor.attr"),90),this.$73$("valueType",p("editor.valuetype"),80,{values:KR.consts.valueTypes,labels:KR.consts.valueTypeLabels}),this.$73$("defaultValue",p("editor.defaultvalue"),90),this.$73$("name",p("editor.name"),80),this.$73$("group",p("editor.group"),80),this.$73$("bindable",p("editor.bindable"),50,void 0,"boolean"),this.$73$("description",p("editor.description"),120),this.$73$("extraInfo",p("editor.extrainfo"),100)]),this.$74$(),this.initExtraInfoColumn(),this.initI18nColumn();var I=[R];this.addRow(I,[.1],"120+0.1");var h=null;this.updateHandlers.push(function(){if(!I.hidden&&i.dataModel&&(!h||i.dataModel.dataBindings!==h)){h=i.dataModel.dataBindings;var R=H.sm().toSelection().toArray();if(H.clear(),i.dataModel.dataBindings){var M=void 0;i.dataModel.dataBindings.forEach(function(I,p){var h=new ht.Data;h.dataBinding=I,H.add(h),p===i.newDataBindingIndex&&(i.tableView.sm().ss(h),M=h,delete i.newDataBindingIndex,delete i.addingDataBindingByButton);for(var z=0;z<R.length;z++)if(Fi(R[z].dataBinding,I)){C(R,R[z]),H.sm().as(h);break}}),setTimeout(function(){M&&(i.tableView.tx(0),OH(i.tableView,M,i.tableView.getColumnModel().getDataByTag("attr")))},100)}}})},H.prototype.modifyDataBindings=function(i){var H=M(this.dataModel.dataBindings);i();var R=M(this.dataModel.dataBindings);this.dataModel.dataBindings=R,this.dataModel.fp("f:dataBindings",H,R)},H.prototype.$82$=function(i,H,R,M,I,p,h){var z=new ht.Data;z.dataBinding={attr:i||"",valueType:H||"String",defaultValue:R,name:M,
description:I,group:p,extraInfo:h};var d={symbolView:this.editor.symbolView,dataBinding:z.dataBinding};if(this.editor.fireEvent("dataBindingAdding",d),d.preventDefault)return!1;z.dataBinding=d.dataBinding,this.dataModel.dataBindings||(this.dataModel.dataBindings=[]);var C=this.tableModel.sm().ld(),y=void 0;if(C){var b=this.tableModel.getRoots().indexOf(C);this.dataModel.dataBindings.splice(b+1,0,z.dataBinding),y=b+1}else this.dataModel.dataBindings.push(z.dataBinding),y=this.tableModel.size();this.addingDataBindingByButton&&(this.newDataBindingIndex=y)},H.prototype.add=function(){var i=this;this.modifyDataBindings(function(){i.addingDataBindingByButton=!0,i.$82$()})},H.prototype.delete=function(){var i=this;this.tableView.sm().ld()&&this.modifyDataBindings(function(){i.tableView.sm().each(function(H){C(i.dataModel.dataBindings,H.dataBinding)})})},H.prototype.reorder=function(){var i=this;this.dataModel.dataBindings=[],this.tableModel.getRoots().each(function(H){i.dataModel.dataBindings.push(H.dataBinding)})},H.prototype.import=function(){var i=this;this.modifyDataBindings(function(){KR.config.clearDataBindingsBeforeImporting&&(i.dataModel.dataBindings=[]);var H=i.editor.symbolView.content,R={};i.prefixStack=[],H.dataBindings&&H.dataBindings.forEach(function(i){R[i.attr]=!0}),i.addCompDataBinding(H,R),i.prefixStack=[]})},H.prototype.addCompDataBinding=function(i,H,R){var M=this,I=void 0;for(var p in i)if("comps"!==p){var h=i[p];Ni(h)&&this.addPropertyDataBinding(null,p,h,H)}R&&i.dataBindings&&i.dataBindings.forEach(function(i){var R=i.attr,I=i.valueType,p=i.defaultValue,h=i.name,z=i.description,d=i.group,C=i.extraInfo;R=M.currentPrefix+R,H[R]||(M.$82$(R,I,p,h,z,d,C),H[R]=!0)}),i.comps&&i.comps.forEach(function(i){var R=i.prefix;R&&M.prefixStack.push(R);for(var p in i){var h=i[p];Ni(h)&&M.addPropertyDataBinding(i,p,h,H)}"image"===i.type&&(I=ht.Default.getImage(i.name))&&M.addCompDataBinding(I,H,!0),R&&M.prefixStack.pop()})},H.prototype.addPropertyDataBinding=function(i,H,R,M){if(ti(R.func)&&fR.test(R.func)){var I=this.currentPrefix+R.func.slice(5);if(!M[I]){var p=void 0,h=void 0,z=void 0,d=void 0,C=void 0;if(i&&bi(i.type)){var y=ht.Default.getCompType(i.type);if(y){var b=y.properties[H];b?(p=b.valueType,h=b.name,z=b.description,d=b.extraInfo,C=b.group):p=JI[H]}}else p=JI[H];this.$82$(I,p,void 0,h,z,C,d),M[I]=!0}}else{var U={};UH(R,U);for(var K in U)M[K]||this.$82$(K,JI[U[K]])}},H.prototype.$81$=function(){var i=this,H=KR.config.importDataBindingsButtonVisible?{button:{icon:"editor.import",toolTip:p("editor.import"),onClicked:function(){i.editor.editable&&i.import()}}}:null;this.addRow([{button:{icon:"editor.add",toolTip:p("editor.add"),onClicked:function(){i.editor.editable&&i.add()}}},{button:{icon:"editor.delete",toolTip:p("editor.delete"),onClicked:function(){i.editor.editable&&i.delete()}}},H,null,{button:{icon:"editor.top",toolTip:p("editor.bringtofront"),onClicked:function(){i.editor.editable&&i.tableView.sm().size()&&i.modifyDataBindings(function(){i.tableModel.moveSelectionToTop(),i.reorder()})}}},{button:{icon:"editor.up",toolTip:p("editor.bringforward"),onClicked:function(){i.editor.editable&&i.tableView.sm().size()&&i.modifyDataBindings(function(){i.tableModel.moveSelectionUp(),i.reorder()})}}},{button:{icon:"editor.down",toolTip:p("editor.sendbackward"),onClicked:function(){i.editor.editable&&i.tableView.sm().size()&&i.modifyDataBindings(function(){i.tableModel.moveSelectionDown(),i.reorder()})}}},{button:{icon:"editor.bottom",toolTip:p("editor.sendtoback"),onClicked:function(){i.editor.editable&&i.tableView.sm().size()&&i.modifyDataBindings(function(){i.tableModel.moveSelectionToBottom(),i.reorder()})}}}],[20,20,20,.1,20,20,20,20])},H.prototype.addAttachPointsProperties=function(){var i=this,H=[],R=function(){i.editor.attachPointsView.show(i.editor.symbolView.content)};this.addLabel(H,p("editor.attach.points"));var M=this.addButton(H,p("editor.attach.edit"),null,null,R,!0);this.addFuncRow(H,"attachPoints"),this.updateHandlers.push(function(){if(!H.hidden){var R=i.getValue(function(i){return i.a("attachPoints")});M.setLabelColor(R&&R.length?KR.config.color_select:ht.Default.labelColor)}}),H=[],this.addLabelComboBox(H,p("editor.attach.style"),function(i){return i.a("attachStyle")||"close"},function(i,H){i.a("attachStyle",H)},["close","strict"],[p("editor.attach.close"),p("editor.attach.strict")]),this.addFuncRow(H,"attachStyle")},H.prototype.addStateProperty=function(){var i=this;if(KR.SceneView){var H=[];this.addLabel(H,p("editor.state"));var R=new ht.widget.ComboBox;R.onValueChanged=function(){i.editor.dm.a("state",R.getValue())},this.updateHandlers.push(function(){if(!H.hidden){var M=i.editor.dm.a("state"),I=i.editor.symbolStatePane.getAllStateEnum(),p=[],h=[];I&&I.length&&(p=I.map(function(i){return i.value}),h=I.map(function(i){return i.label||i.value}),p.unshift(void 0),h.unshift("")),R.setValues(p),R.setLabels(h),R.getValue()!==M&&R.setValue(M)}}),H.push(R),this.addFuncRow(H,"state")}},zR(H,[{key:"currentPrefix",get:function(){var i=this.prefixStack,H="";return i&&i.length&&(H=i.join(".")+"."),H}}]),H}(XI),cI=function(i){function H(R,M){return hR(this,H),CR(this,i.call(this,R,M,"data"))}return dR(H,i),H.prototype.isTitleVisible=function(H){return!!this.inspectorFilter.isDataTitleVisible(this.editor,this.data,H.title)&&i.prototype.isTitleVisible.call(this,H)},H.prototype.isPropertyVisible=function(H){return!!this.inspectorFilter.isDataPropertyVisible(this.editor,this.data,H.keys&&H.keys.accessType,H.keys&&H.keys.name)&&i.prototype.isPropertyVisible.call(this,H)},H.prototype.addDBInput=function(i,H,R,M,I){var p=[];return this.addLabelInput(p,H,q(i,R),Q(i,R),M,I),this.addDBRow(p,i,R)},H.prototype.addDBLabel=function(i,H,R){var M=[];return this.addLabelLabel(M,H,q(i,R),Q(i,R)),this.addDBRow(M,i,R)},H.prototype.addDBCheckBox=function(i,H,R){var M=[];return this.addLabelCheckBox(M,H,q(i,R),Q(i,R)),this.addDBRow(M,i,R)},H.prototype.addDBImage=function(i,H,R){var M=[];return this.addLabelImage(M,H,q(i,R),Q(i,R)),this.addDBRow(M,i,R)},H.prototype.addDBColor=function(i,H,R){var M=[],I=function(H,M){"shape.background"===R&&H.s("shape.gradient.pack")&&H.s("shape.gradient.pack",void 0),Q(i,R)(H,M)};return this.addLabelColor(M,H,q(i,R),I),this.addDBRow(M,i,R)},H.prototype.addDBFont=function(i,H,R){var M=[];return this.addLabelFont(M,H,q(i,R),Q(i,R)),this.addDBRow(M,i,R)},H.prototype.addDBDashPattern=function(i,H,R){var M=[];return this.addLabelDashPattern(M,H,q(i,R),Q(i,R)),this.addDBRow(M,i,R)},H.prototype.addDBPattern=function(i,H,R){var M=[];return this.addLabelInput(M,H,q(i,R),Q(i,R),"pattern"),this.addDBRow(M,i,R)},H.prototype.addDBRotation=function(i,H,R){var M=[];return this.addLabelRotation(M,H,q(i,R),Q(i,R)),this.addDBRow(M,i,R)},H.prototype.addDBAlign=function(i,H,R){var M=[];return this.addLabelAlign(M,H,q(i,R),Q(i,R)),this.addDBRow(M,i,R)},H.prototype.addDBVAlign=function(i,H,R){var M=[];return this.addLabelVAlign(M,H,q(i,R),Q(i,R)),this.addDBRow(M,i,R)},H.prototype.addDBOrientation=function(i,H,R){var M=[];return this.addLabelOrientation(M,H,q(i,R),Q(i,R)),this.addDBRow(M,i,R)},H.prototype.addDBComboBox=function(i,H,R,M,I,p){var h=[];return this.addLabelComboBox(h,H,q(i,R),Q(i,R),M,I,p),this.addDBRow(h,i,R)},H.prototype.addDBStretch=function(i,H,R){var M=[];return this.addLabelStretch(M,H,q(i,R),Q(i,R)),this.addDBRow(M,i,R)},H.prototype.addDBZeroToOne=function(i,H,R){var M=[];return this.addLabelRange(M,H,q(i,R),Q(i,R),0,1,.01,"number"),this.addDBRow(M,i,R)},H.prototype.addDBPosition=function(i,H,R){var M=[];return this.addLabelPosition(M,H,q(i,R),Q(i,R)),this.addDBRow(M,i,R)},H.prototype.addDBRange=function(i,H,R,M,I,p,h){var z=[];return this.addLabelRange(z,H,q(i,R),Q(i,R),M,I,p,h),this.addDBRow(z,i,R)},H.prototype.addDBGradient=function(i,H,R,M){var I=[];return this.addLabelGradient(I,i,H,R,M),this.addDBRow(I,"s",H)},H.prototype.addDBBodyColorProperty=function(){this.addDBColor("s",p("editor.bodycolor"),"body.color")},H.prototype.addDBOpacityProperty=function(){this.addDBZeroToOne("s",p("editor.opacity"),"opacity")},H.prototype.$83$=function(){var i=[];return this.addLabelIcons(i),this.addDBRow(i,"s","icons")},H.prototype.addDBData=function(i,H,R,M){var I=[];return this.addLabelData(I,H,q(i,R),M||Q(i,R)),this.addDBRow(I,i,R)},H.prototype.addDBMultiline=function(i,H,R){var M=[];return this.addLabelMultiline(M,H,q(i,R),Q(i,R)),this.addDBRow(M,i,R)},H.prototype.$27$=function(){this.addTitle("TitleBasic");var i=[];this.addLabelInput(i,p("editor.classname"),function(i){return i.getClassName()}),this.addRow(i,this.w1).keys={accessType:"p",name:"className"},this.addDBInput("p",p("editor.name"),"displayName"),this.addDBInput("p",p("editor.tag"),"tag"),this.addDBImage("p",p("editor.icon"),"icon"),this.addDBData("p",p("editor.parent"),"parent")},H.prototype.$29$=function(){this.addTitle("TitleLabel"),this.addDBMultiline("s",p("editor.content"),"label"),this.addDBFont("s",p("editor.font"),"label.font"),this.addDBColor("s",p("editor.color"),"label.color"),this.addDBColor("s",p("editor.background"),"label.background"),this.addDBPosition("s",p("editor.position"),"label.position"),this.addDBInput("s",p("editor.offsetx"),"label.offset.x","number",1),this.addDBInput("s",p("editor.offsety"),"label.offset.y","number",1),this.addDBInput("s",p("editor.maxlength"),"label.max","number",1),this.addDBRotation("s",p("editor.rotation"),"label.rotation"),this.addDBZeroToOne("s",p("editor.opacity"),"label.opacity"),this.addDBRange("s",p("editor.scale"),"label.scale",.01,100,.1,"number"),this.addDBAlign("s",p("editor.align"),"label.align"),this.addDBCheckBox("s",p("editor.fixed"),"label.position.fixed")},H.prototype.$30$=function(){this.addTitle("TitleNote"),this.addDBMultiline("s",p("editor.content"),"note"),this.addDBFont("s",p("editor.font"),"note.font"),this.addDBColor("s",p("editor.color"),"note.color"),this.addDBColor("s",p("editor.background"),"note.background"),this.addDBInput("s",p("editor.borderwidth"),"note.border.width","number",1),this.addDBColor("s",p("editor.bordercolor"),"note.border.color"),this.addDBPosition("s",p("editor.position"),"note.position"),this.addDBInput("s",p("editor.offsetx"),"note.offset.x","number",1),this.addDBInput("s",p("editor.offsety"),"note.offset.y","number",1),this.addDBZeroToOne("s",p("editor.opacity"),"note.opacity"),this.addDBRange("s",p("editor.scale"),"note.scale",.01,100,.1,"number"),this.addDBInput("s",p("editor.maxlength"),"note.max","number",1),this.addDBAlign("s",p("editor.align"),"note.align"),this.addDBCheckBox("s",p("editor.toggleable"),"note.toggleable"),this.addDBCheckBox("s",p("editor.expanded"),"note.expanded")},H.prototype.addDBLayer=function(){var i=[];this.addLabelLayer(i);var H=this.addDBRow(i,"p","layer");return H.items.tag="layer",H},H.prototype.addDBGray=function(){this.addDBCheckBox("s",p("editor.gray"),"2d.gray")},H}(XI),tI={TitleShapeBackground:!0,TitleShapeForeground:!0,TitleShapeBorder:!0,TitleShapeDash:!0},TI={},NI=function(i){function H(R,M){return hR(this,H),CR(this,i.call(this,R,M))}return dR(H,i),H.prototype.initForm=function(){this.addCustomProperties(),this.addControlProperties(),this.addLayoutProperties(),this.$27$(),this.$91$(),this.$28$(),this.$29$(),this.$30$(),this.$25$()},H.prototype.addControlProperties=function(){this.addTitle("TitleControl"),this.addEventProperties(),this.addDBComboBox("s",p("editor.movemode"),"2d.move.mode",[void 0,"x","y"],["",p("editor.horizontal"),p("editor.vertical")]),this.addDBCheckBox("s",p("editor.ingroup"),"ingroup"),this.addDBCheckBox("s",p("editor.visible"),"2d.visible"),this.addDBCheckBox("s",p("editor.selectable"),"2d.selectable"),this.addDBCheckBox("s",p("editor.movable"),"2d.movable"),this.addDBCheckBox("s",p("editor.editable"),"2d.editable"),this.addDBCheckBox("s",p("editor.pixelperfect"),"pixelPerfect")},H.prototype.$27$=function(){i.prototype.$27$.call(this),this.addDBGray(),this.addDBLayer(),this.addDBInput("p",p("editor.tooltip"),"toolTip"),this.addDBBodyColorProperty(),this.addDBOpacityProperty(),this.$83$(),this.addDBState(),this.$84$()},H.prototype.addDBState=function(){var i=this,H=[];this.addLabelState(H);var R=this.addDBRow(H,"s","state");return R.visible=function(){var H=i.getStateEnum();return H&&H.length},R},H.prototype.getStateEnum=function(){var i=ht.Default.getImage(this.data.getImage());if(i&&i.comps){TI={};var H=[];return this.getNestState(i.comps,H),i.stateEnum&&i.stateEnum.forEach(function(i){TI[i.value]||H.push(i)}),H}return null},H.prototype.getNestState=function(i,H){var R=this;i.forEach(function(i){if("image"===i.type){var M=ht.Default.getImage(i.name);if(M&&M.comps){var I=M.stateEnum;I&&I.forEach(function(i){H.push(i),TI[i.value]=1}),R.getNestState(M.comps,H)}else if(!M)return void R.$34$()}})},H.prototype.addActionLabelState=function(i){this.addLabelState(i,{accessType:"s",name:"state"})},H.prototype.addLabelState=function(i,H){var R=this,M=new ht.widget.ComboBox,I=function(i){var H=i.s("state");if(H)return H;if(i.getImage){var R=ht.Default.getImage(i.getImage());return R?R.state:void 0}},h=Q("s","state");return this.addLabel(i,p("editor.state"),void 0,void 0,void 0,H),M.onValueChanged=function(){R.setValue(h,M.getValue())},this.updateHandlers.push(function(){if(!i.hidden){var H=R.getStateEnum();if(!H||0===!H)return void(M.getValues()&&M.getValues().length&&(M.setValues(),M.setLabels(),M.setValue()));var p=R.getValue(I),h=H.map(function(i){return i.value}),z=H.map(function(i){return i.label||i.value});h.unshift(void 0),z.unshift(""),M.setValues(h),M.setLabels(z),M.getValue()!==p&&"object"!=typeof p&&M.setValue(p)}}),i.push(M),M},H.prototype.addActionLabelNodeImage=function(i){this.addLabelNodeImage(i,{accessType:"p",name:"image"})},H.prototype.addLabelNodeImage=function(i,H){var R=this;i.forceToUpdate=!0,this.addLabelImage(i,p("editor.image"),function(i){var H=i.getImage(),M=ht.Default.getImage(H);return R.$85$(Ni(M)?M.dataBindings:null,M),H},function(i,H){i.setImage&&(ti(H)&&H.endsWith("[...]")||i.setImage(H))},H),this.addButton(i,null,p("editor.resetsize"),"editor.resetsize.state",function(i){i instanceof ht.Node&&i.setSize(-1,-1)})},H.prototype.$91$=function(){this.addDBStretch("s",p("editor.stretch"),"image.stretch").items.tag="imageRelative",this.addDBComboBox("s",p("editor.shape"),"shape",KR.consts.shapes,KR.consts.shapeLabels,KR.consts.shapeIcons);var i=[];this.addLabelNodeImage(i),this.imageRow=this.addDBRow(i,"p","image"),this.imageRow.items.tag="imageRelative"},H.prototype.addLayoutProperties=function(){var i=this;this.addTitle("TitleLayout"),this.addDBInput("p",p("editor.posx"),"x","number",1),this.addDBInput("p",p("editor.posy"),"y","number",1),this.addDBInput("p",p("editor.width"),"width","number",1),this.addDBInput("p",p("editor.height"),"height","number",1),this.addDBRotation("p",p("editor.rotation"),"rotation");var H=[],R=void 0;this.addLabelInput(H,p("editor.scalex"),q("p","scaleX"),Q("p","scaleX"),"number",.01),this.addButton(H,null,p("editor.flipx"),"editor.flipx",function(i){i instanceof ht.Node&&i.setScaleX(-i.getScaleX())}),this.addDBRow(H,"p","scaleX"),H=[],this.addLabelInput(H,p("editor.scaley"),q("p","scaleY"),Q("p","scaleY"),"number",.01),this.addButton(H,null,p("editor.flipy"),"editor.flipy",function(i){i instanceof ht.Node&&i.setScaleY(-i.getScaleY())}),this.addDBRow(H,"p","scaleY"),H=[],this.addLabelInput(H,p("editor.anchorx"),function(i){return i.getAnchor().x},function(i,H){i instanceof ht.Node&&i.setAnchor(H,i.getAnchor().y,!0)},"number",.01),this.addDBRow(H,"p","anchorX"),H=[],this.addLabelInput(H,p("editor.anchory"),function(i){return i.getAnchor().y},function(i,H){i instanceof ht.Node&&i.setAnchor(i.getAnchor().x,H,!0)},"number",.01),this.addDBRow(H,"p","anchorY"),this.addDBData("p",p("editor.host"),"host",function(i,H){!i.s("fullscreen")&&i instanceof ht.Node&&(null==H||H instanceof ht.Node)&&i.setHost(H)}).items.tag="host",this.addUpdateHandler(function(){i.updateSymbolLayoutProperties()}),KR.config.layoutEnabled&&(this.addDBComboBox("s",p("editor.fullscreen"),"fullscreen",KR.consts.fullscreenValues,KR.consts.fullscreenLabels).items.tag="fullscreen",this.addDBComboBox("s",p("editor.fullscreen.lock"),"fullscreen.lock",KR.consts.fullscreenLockValues,KR.consts.fullscreenLockLabels).items.tag="fullscreenDetail",this.addDBInput("s",p("editor.fullscreen.gap"),"fullscreen.gap","number",1).items.tag="fullscreenDetail",this.addNameRow([null,{element:this.addLayoutView()},null],"layoutView",void 0,100,[.1,100,.1]).items.tag="nodeLayout",R=this.addDBComboBox("s",p("editor.nodeLayout.h"),"layout.h",KR.consts.hLayoutValues,KR.consts.hLayoutLabels),R.items.tag="nodeLayout",this.layoutVRow=R=this.addDBComboBox("s",p("editor.nodeLayout.v"),"layout.v",KR.consts.vLayoutValues,KR.consts.vLayoutLabels),R.items.tag="nodeLayout")},H.prototype.addLayoutView=function(){var i=this,H=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,R=this.layoutGv=new ht.graph.GraphView,M=this.layoutNode=new ht.Node,I=!1;return M.setImage("editor.layout.helper"),M.a("selectColor",KR.config.color_select),M.setSize(H,H),R.dm().add(M),R.tx(H/2),R.ty(H/2),R.handleScroll=function(){},R.handlePinch=function(){},R.setScrollBarVisible(!1),R.setRectSelectable(!1),R.setPannable(!1),R.setMovableFunc(function(){return!1}),R.dm().md(function(H){I||(i.beginTransaction(),i.dataModel.sm().getSelection().each(function(i){"a:layout.v"===H.property?i.s("layout.v",H.newValue):"a:layout.h"===H.property&&i.s("layout.h",H.newValue)}),i.endTransaction())}),this.addUpdateHandler(function(){var H=i.data;I=!0,M.a({"layout.v":H.s("layout.v"),"layout.h":H.s("layout.h")}),I=!1}),R},H.prototype.$84$=function(){this.addDBZeroToOne("s",p("editor.clippercentage"),"clip.percentage"),this.addDBComboBox("s",p("editor.clipdirection"),"clip.direction",KR.consts.clipDirections,KR.consts.clipDirectionLabels)},H.prototype.$28$=function(){this.$24$(),this.addShapeForegroundProperties(),this.$32$(),this.addShapeDashProperties()},H.prototype.$24$=function(){this.addTitle("TitleShapeBackground"),this.addDBColor("s",p("editor.background"),"shape.background"),this.addDBGradient(p("editor.gradient"),"shape.gradient","shape.background","shape.gradient.color"),this.addDBColor("s",p("editor.gradientcolor"),"shape.gradient.color"),this.addDBImage("s",p("editor.repeatimage"),"shape.repeat.image"),this.addDBZeroToOne("s",p("editor.clippercentage"),"shape.fill.clip.percentage"),this.addDBComboBox("s",p("editor.clipdirection"),"shape.fill.clip.direction",KR.consts.clipDirections,KR.consts.clipDirectionLabels)},H.prototype.addShapeForegroundProperties=function(){this.addTitle("TitleShapeForeground"),this.addDBColor("s",p("editor.foreground"),"shape.foreground"),this.addDBGradient(p("editor.gradient"),"shape.foreground.gradient","shape.foreground","shape.foreground.gradient.color"),this.addDBColor("s",p("editor.gradientcolor"),"shape.foreground.gradient.color"),this.addDBZeroToOne("s",p("editor.clippercentage"),"shape.foreground.clip.percentage"),this.addDBComboBox("s",p("editor.clipdirection"),"shape.foreground.clip.direction",KR.consts.clipDirections,KR.consts.clipDirectionLabels)},H.prototype.$32$=function(){this.addTitle("TitleShapeBorder"),this.addDBInput("s",p("editor.width"),"shape.border.width","number",1),this.addDBCheckBox("s",p("editor.widthabsolute"),"shape.border.width.absolute"),this.addDBDashPattern("s",p("editor.pattern"),"shape.border.pattern"),this.addDBColor("s",p("editor.color"),"shape.border.color"),this.addDBCheckBox("s",p("editor.threed"),"shape.border.3d"),this.addDBColor("s",p("editor.threedcolor"),"shape.border.3d.color"),this.addDBComboBox("s",p("editor.join"),"shape.border.join",KR.consts.joins,KR.consts.joinLabels),this.addDBComboBox("s",p("editor.cap"),"shape.border.cap",KR.consts.caps,KR.consts.capLabels),this.$23$()},H.prototype.$23$=function(){this.addDBInput("s",p("editor.depth"),"shape.depth","int",1).items.tag="shapeDepth",this.addDBInput("s",p("editor.sides"),"shape.polygon.side","int",1).items.tag="shapeSide",this.addDBInput("s",p("editor.radius"),"shape.corner.radius","number",1).items.tag="shapeRadius",this.addDBCheckBox("s",p("editor.arcoval"),"shape.arc.oval").items.tag="shapeArc",this.addDBCheckBox("s",p("editor.closed"),"shape.arc.close").items.tag="shapeArc",this.addDBRotation("s",p("editor.arcfrom"),"shape.arc.from").items.tag="shapeArc",this.addDBRotation("s",p("editor.arcto"),"shape.arc.to").items.tag="shapeArc"},H.prototype.addShapeDashProperties=function(){this.addTitle("TitleShapeDash"),this.addDBDashPattern("s",p("editor.pattern"),"shape.dash.pattern"),this.addDBCheckBox("s",p("editor.dash"),"shape.dash"),this.addDBColor("s",p("editor.color"),"shape.dash.color"),this.addDBInput("s",p("editor.offset"),"shape.dash.offset","number",1),this.addDBInput("s",p("editor.width"),"shape.dash.width","number",1),this.addDBCheckBox("s",p("editor.threed"),"shape.dash.3d"),this.addDBColor("s",p("editor.threedcolor"),"shape.dash.3d.color")},H.prototype.$34$=function(H){if(this._updateDataBindingsLater&&this.$86$(),H){if("s:shape"===H.property||"host"===H.property||"s:fullscreen"===H.property)return void this.filterPropertiesLater();if("s:select.type"===H.property&&("shadow"===H.oldValue||"shadow"===H.newValue))return void this.filterPropertiesLater()}i.prototype.$34$.call(this,H)},H.prototype.isTitleVisible=function(H){return!(!(!this.data||this.data instanceof ht.Shape||this.data.s("shape"))&&tI[H.title])&&i.prototype.isTitleVisible.call(this,H)},H.prototype.isPropertyVisible=function(H){if(this.data){var R=H.items.tag;if(R)if("selectShadow"===R){if("shadow"!==this.data.s("select.type"))return!1}else if("shapeDepth"===R){if("rect"!==this.data.s("shape"))return!1}else if("shapeSide"===R){if("polygon"!==this.data.s("shape"))return!1}else if("shapeRadius"===R){if("roundRect"!==this.data.s("shape"))return!1}else if("shapeArc"===R){if("arc"!==this.data.s("shape"))return!1}else if("imageRelative"===R){if(this.data.s("shape"))return!1}else if("layer"===R){if(!this.editor.layerPane.layerNames.length)return!1}else if("fullscreen"===R){if(this.data.getHost())return!1}else if("fullscreenDetail"===R){if(!this.data.s("fullscreen"))return!1}else if("host"===R){if(this.data.s("fullscreen"))return!1}else if("nodeLayout"===R&&!this.data.getHost())return!1}return i.prototype.isPropertyVisible.call(this,H)},H.prototype.$85$=function(i,H){var R=this;this.dataBindings!==i&&(this.$45$=i,this.pendingImage=H,this._updateDataBindingsLater||(this._updateDataBindingsLater=!0,requestAnimationFrame(function(){R._updateDataBindingsLater&&R.$86$()})))},H.prototype.$86$=function(){var i=this;if(this._updateDataBindingsLater=!1,this.dataBindings===this.$45$)return this.$45$=null,void(this.pendingImage=null);if(this._rows=this.$46$,this.removeRows(this.$44$),this.dataBindingHandlers&&this.dataBindingHandlers.length&&this.dataBindingHandlers.forEach(this.removeUpdateHandler,this),this.$44$=[],this.dataBindingHandlers=[],this.dataBindings=this.$45$,this.dataBindings){var H=this.updateHandlers.length,R={},M={},I={};this.pendingImage.comps.forEach(function(i){if(bi(i.type)){var H=ht.Default.getCompType(i.type);if(H)for(var p in H.properties)R[p]=H.properties[p].defaultValue}UH(i,M,I)});for(var p in M)void 0===I[p]&&(I[p]=R[M[p]]);var h=void 0,z=this._rows.indexOf(this.imageRow)+1;this.dataBindings.forEach(function(H){if(H.group&&h!==H.group){h=H.group;var R=i.addTitle(h,{index:z});R.items.tag="imageRelative",i.$44$.push(R),z++}i.$87$(H,z,I)&&z++}),this.dataBindingHandlers=this.updateHandlers.slice(H)}this.$46$=this._rows,this.filterProperties()},H.prototype.$87$=function(i,H,R,M,I){var C=[],y=i.attr,b=KR.config.valueTypes[i.valueType];if(!b)return this.editor.fireEvent("error",{message:"Wrong value type:"+i.valueType}),!1;var U=p(i.name)||y,K=function(i){var H=i.a(y);return void 0===H&&(H=R[y]),H},q=function(i,H){i.a(y,H)},Q=i.extraInfo,m=void 0,X=void 0,o=void 0;Q&&Q.enum&&(m=Q.enum.values,X=d(Q.enum.labels,Q.enum.i18nLabels),o=Q.enum.icons);var J=null==i.bindable||i.bindable,O=KR.SceneView&&J,c=void 0;Q&&Q.buildUI?(c=Q.buildUI(this,C,U,K,q,Q),O=!1):m?O?this.addActionLabelComboBox(C,U,"a",y,m,X,o,K,q):this.addLabelComboBox(C,U,K,q,m,X,o):"int"===b.type||"number"===b.type?b.angle?O?this.addActionLabelRotation(C,U,"a",y,b.min,b.max,b.step,K,q):this.addLabelRotation(C,U,K,q,b.min,b.max,b.step):O?this.addActionLabelRange(C,U,"a",y,b.min,b.max,b.step,b.type,K,q):this.addLabelRange(C,U,K,q,b.min,b.max,b.step,b.type):"color"===b.type?O?this.addActionLabelColor(C,U,"a",y,K,q):this.addLabelColor(C,U,K,q):"boolean"===b.type?O?this.addActionLabelCheckBox(C,U,"a",y,K,q):this.addLabelCheckBox(C,U,K,q):"enum"===b.type?O?this.addActionLabelComboBox(C,U,"a",y,b.values,b.labels,b.icons,K,q):this.addLabelComboBox(C,U,K,q,b.values,b.labels,b.icons):"multiline"===b.type?O?this.addActionLabelMultiline(C,U,"a",y,K,q):this.addLabelMultiline(C,U,K,q):"font"===b.type?O?this.addActionLabelFont(C,U,"a",y,K,q):this.addLabelFont(C,U,K,q):"image"===b.type?O?this.addActionLabelImage(C,U,"a",y,K,q):this.addLabelImage(C,U,K,q):"url"===b.type?O?this.addActionLabelURL(C,U,"a",y,void 0,K,q):this.addLabelURL(C,U,K,q):"colorArray"===b.type?O?this.addActionLabelArray(C,U,"a",y,"color",K,q,Q):this.addLabelArray(C,U,K,q,"color",Q):"numberArray"===b.type?O?this.addActionLabelArray(C,U,"a",y,"number",K,q,Q):this.addLabelArray(C,U,K,q,"number",Q):"stringArray"===b.type?O?this.addActionLabelArray(C,U,"a",y,"string",K,q,Q):this.addLabelArray(C,U,K,q,"string",Q):"objectArray"===b.type?O?this.addActionLabelArray(C,U,"a",y,"object",K,q,Q):this.addLabelArray(C,U,K,q,"object",Q):"function"===b.type?O?this.addActionLabelFunction(C,U,"a",y,y,Q&&Q.arguments,K,q):this.addLabelFunction(C,U,K,q,y,Q&&Q.arguments):"object"===b.type?O?this.addActionLabelObject(C,U,"a",y,y,K,q,Q&&Q.objectProperties):this.addLabelObject(C,U,K,q,y,Q&&Q.objectProperties):"custom"===b.type?(c=b.buildUI(this,C,U,K,q,Q),O=!1):"dataModel"===b.type?O?this.addActionLabelDataModel(C,U,"a",y,y,Q,K,q):this.addLabelDataModel(C,U,K,q,y,Q):"gradientPack"===b.type?O?this.addActionLabelGradientPack(C,U,"a",y,K,q):this.addLabelGradientPack(C,U,K,q,y):O?this.addActionLabelInput(C,U,"a",y,void 0,void 0,void 0,K,q):this.addLabelInput(C,U,K,q);var t=this.addDBRow(C,"a",y,{index:H},h(c,b),z(c,b),J&&!O);return Q&&(t.visible=Q.visible,t.onPropertyChanged=Q.onPropertyChanged),M||(M=this.$44$),M.push(t),null!==I&&(C.tag=I||"imageRelative"),!0},H.prototype.$25$=function(){this.addTitle("TitleSelect"),this.addDBColor("s",p("editor.color"),"select.color"),this.addDBInput("s",p("editor.width"),"select.width","number",1),this.addDBInput("s",p("editor.padding"),"select.padding","number",1),this.addDBComboBox("s",p("editor.selecttype"),"select.type",KR.consts.selectTypes,KR.consts.selectTypeLabels,KR.consts.selectTypeIcons),this.addDBInput("s",p("editor.shadowblur"),"shadow.blur","number",1).items.tag="selectShadow",this.addDBInput("s",p("editor.shadowoffsetx"),"shadow.offset.x","number",1).items.tag="selectShadow",this.addDBInput("s",p("editor.shadowoffsety"),"shadow.offset.y","number",1).items.tag="selectShadow"},H.prototype.updateSymbolLayoutProperties=function(){var i=this,H=this.data.getHost(),R=void 0,M=void 0;if(H&&H.getImage&&(R=H.getImage())&&(R=ht.Default.getImage(R),Ni(R)&&(M=R.layoutProperties)),this.layoutProperties!==M){if(this._rows=this.$46$,this.removeRows(this.layoutPropertiesRows),this.layoutPropertiesHandlers&&this.layoutPropertiesHandlers.length&&this.layoutPropertiesHandlers.forEach(this.removeUpdateHandler,this),this.layoutPropertiesRows=[],this.layoutPropertiesHandlers=[],this.layoutProperties=M,this.layoutProperties){var I=this.updateHandlers.length,p=void 0,h=this._rows.indexOf(this.layoutVRow)+1;this.layoutProperties.forEach(function(H){if(H.group&&p!==H.group){p=H.group;var R=i.addTitle(p,{index:h});R.items.tag="layoutRelative",i.layoutPropertiesRows.push(R),h++}i.$87$(H,h,{},i.layoutPropertiesRows,"layoutRelative")&&h++}),this.layoutPropertiesHandlers=this.updateHandlers.slice(I)}this.$46$=this._rows}},H}(cI),DI={"h.v":!0,"v.h":!0,ortho:!0,flex:!0,"extend.east":!0,"extend.west":!0,"extend.north":!0,"extend.south":!0,ortho2:!0,flex2:!0,"extend.north2":!0,"extend.south2":!0,"extend.west2":!0,"extend.east2":!0,"v.h2":!0,"h.v2":!0},fI={"extend.east":!0,"extend.west":!0,"extend.north":!0,"extend.south":!0,"extend.north2":!0,"extend.south2":!0,"extend.west2":!0,"extend.east2":!0},nI=function(i){function H(R,M){return hR(this,H),CR(this,i.call(this,R,M))}return dR(H,i),H.prototype.initForm=function(){this.$26$(),this.addCustomProperties(),this.addControlProperties(),this.$27$(),this.addDBGray(),this.$88$(),this.addEdgeEndpointProperties(),this.$90$(),this.$29$(),this.$30$(),this.$25$()},H.prototype.addControlProperties=function(){this.addTitle("TitleControl"),this.addEventProperties(),this.addDBCheckBox("s",p("editor.visible"),"2d.visible"),this.addDBCheckBox("s",p("editor.selectable"),"2d.selectable"),this.addDBCheckBox("s",p("editor.editable"),"2d.editable"),this.addDBCheckBox("s",p("editor.independent"),"edge.independent"),this.addDBCheckBox("s",p("editor.toggleable"),"edge.toggleable")},H.prototype.isTitleVisible=function(H){return!("TitleEditingPoint"===H.title&&!this.editor.pointsEditingMode)&&i.prototype.isTitleVisible.call(this,H)},H.prototype.$34$=function(H){if(H){var R=H.property;if("s:edge.type"===R||"source"===R||"target"===R||"s:select.type"===R)return void this.filterPropertiesLater()}i.prototype.$34$.call(this,H)},H.prototype.isPropertyVisible=function(H){if(this.data){var R=H.items.tag;if(R){var M=this.data.s("edge.type");if("edgeRipple"===R){if("ripple"!==M)return!1}else if("edgeRadius"===R){if(!DI[M])return!1}else if("edgeOrtho"===R){if("ortho"!==M&&"ortho2"!==M)return!1}else if("edgeFlex"===R){if("flex"!==M&&"flex2"!==M)return!1}else if("edgeExtend"===R){if(!fI[M])return!1}else if("layer"===R){if(!this.editor.layerPane.layerNames.length)return!1}else{if(!("edgeSourceIsEdge"!==R||this.data.getSource()instanceof ht.Edge))return!1;if(!("edgeTargetIsEdge"!==R||this.data.getTarget()instanceof ht.Edge))return!1;if(!("edgeSourceIsNode"!==R||this.data.getSource()instanceof ht.Node))return!1;if("edgeTargetIsNode"===R&&!(this.data.getTarget()instanceof ht.Node))return!1}}}return i.prototype.isPropertyVisible.call(this,H)},H.prototype.$27$=function(){i.prototype.$27$.call(this),this.addDBLayer(),this.addDBInput("p",p("editor.tooltip"),"toolTip"),this.addDBOpacityProperty(),this.$83$()},H.prototype.$25$=function(){this.addTitle("TitleSelect"),this.addDBColor("s",p("editor.color"),"select.color"),this.addDBInput("s",p("editor.width"),"select.width","number",1);var i=[];this.addLabelCheckBox(i,p("editor.shadow"),function(i){return"shadow"===i.s("select.type")},function(i,H){i.s("select.type",H?"shadow":null)}),this.addDBRow(i,"s","select.type"),this.addDBInput("s",p("editor.shadowblur"),"shadow.blur","number",1),this.addDBInput("s",p("editor.shadowoffsetx"),"shadow.offset.x","number",1),this.addDBInput("s",p("editor.shadowoffsety"),"shadow.offset.y","number",1)},H.prototype.$88$=function(){this.addTitle("TitleEdgeBasic"),this.addDBInput("s",p("editor.width"),"edge.width","number",1),this.addDBCheckBox("s",p("editor.widthabsolute"),"edge.width.absolute"),this.addDBDashPattern("s",p("editor.pattern"),"edge.pattern"),this.addDBColor("s",p("editor.color"),"edge.color"),this.addDBCheckBox("s",p("editor.threed"),"edge.3d"),this.addDBColor("s",p("editor.threedcolor"),"edge.3d.color"),this.addDBComboBox("s",p("editor.join"),"edge.join",KR.consts.joins,KR.consts.joinLabels),this.addDBComboBox("s",p("editor.cap"),"edge.cap",KR.consts.caps,KR.consts.capLabels),this.addDBInput("s",p("editor.group"),"edge.group"),this.addDBInput("s",p("editor.offset"),"edge.offset","number",1),this.addDBInput("s",p("editor.gap"),"edge.gap","number",1),this.addDBComboBox("s",p("editor.type"),"edge.type",KR.consts.edgeTypes,KR.consts.edgeTypeLabels),
this.addDBInput("s",p("editor.radius"),"edge.corner.radius","number",1).items.tag="edgeRadius",this.addDBZeroToOne("s",p("editor.ortho"),"edge.ortho").items.tag="edgeOrtho",this.addDBInput("s",p("editor.flex"),"edge.flex","number",1).items.tag="edgeFlex",this.addDBInput("s",p("editor.extend"),"edge.extend","number",1).items.tag="edgeExtend",this.addDBInput("s",p("editor.ripplesize"),"edge.ripple.size","int",1).items.tag="edgeRipple",this.addDBInput("s",p("editor.ripplelength"),"edge.ripple.length","number",1).items.tag="edgeRipple",this.addDBInput("s",p("editor.rippleelevation"),"edge.ripple.elevation","number",1).items.tag="edgeRipple",this.addDBCheckBox("s",p("editor.rippleboth"),"edge.ripple.both").items.tag="edgeRipple",this.addDBCheckBox("s",p("editor.ripplestraight"),"edge.ripple.straight").items.tag="edgeRipple",this.addDBCheckBox("s",p("editor.center"),"edge.center");var i=[],H=function(i,H){i instanceof ht.Edge&&i.toggle()};H.once=!0,this.addLabelCheckBox(i,p("editor.expanded"),function(i){return i.s("edge.expanded")},H),this.addDBRow(i,"s","edge.expanded")},H.prototype.$90$=function(){this.addTitle("TitleEdgeDash"),this.addDBCheckBox("s",p("editor.dash"),"edge.dash"),this.addDBDashPattern("s",p("editor.pattern"),"edge.dash.pattern"),this.addDBColor("s",p("editor.color"),"edge.dash.color"),this.addDBInput("s",p("editor.offset"),"edge.dash.offset","number",1),this.addDBInput("s",p("editor.width"),"edge.dash.width","number",1),this.addDBCheckBox("s",p("editor.threed"),"edge.dash.3d"),this.addDBColor("s",p("editor.threedcolor"),"edge.dash.3d.color")},H.prototype.addEdgeEndpointProperties=function(){this.addTitle("TitleEdgeEndpoint"),this.addDBData("p",p("editor.sourcedata"),"source",function(i,H){i instanceof ht.Edge&&(null==H||H instanceof ht.Node||H instanceof ht.Edge)&&(i.setSource(H),i.s("edge.source.percent",.5))}),this.addDBData("p",p("editor.targetdata"),"target",function(i,H){i instanceof ht.Edge&&(null==H||H instanceof ht.Node||H instanceof ht.Edge)&&(i.setTarget(H),i.s("edge.target.percent",.5))});var i=void 0;i=this.addDBZeroToOne("s",p("editor.sourcepercent"),"edge.source.percent"),i.items.tag="edgeSourceIsEdge",i=this.addDBRange("s",p("editor.sourceindex"),"edge.source.index",-1,void 0,1,"int"),i.items.tag="edgeSourceIsEdge",i=this.addDBPosition("s",p("editor.sourceposition"),"edge.source.position"),i.items.tag="edgeSourceIsNode",i=this.addDBInput("s",p("editor.sourceoffsetx"),"edge.source.offset.x","number",1),i.items.tag="edgeSourceIsNode",i=this.addDBInput("s",p("editor.sourceoffsety"),"edge.source.offset.y","number",1),i.items.tag="edgeSourceIsNode",i=this.addDBInput("s",p("editor.sourceanchorx"),"edge.source.anchor.x","number",.01),i.items.tag="edgeSourceIsNode",i=this.addDBInput("s",p("editor.sourceanchory"),"edge.source.anchor.y","number",.01),i.items.tag="edgeSourceIsNode",i=this.addDBZeroToOne("s",p("editor.targetpercent"),"edge.target.percent"),i.items.tag="edgeTargetIsEdge",i=this.addDBRange("s",p("editor.targetindex"),"edge.target.index",-1,void 0,1,"int"),i.items.tag="edgeTargetIsEdge",i=this.addDBPosition("s",p("editor.targetposition"),"edge.target.position"),i.items.tag="edgeTargetIsNode",i=this.addDBInput("s",p("editor.targetoffsetx"),"edge.target.offset.x","number",1),i.items.tag="edgeTargetIsNode",i=this.addDBInput("s",p("editor.targetoffsety"),"edge.target.offset.y","number",1),i.items.tag="edgeTargetIsNode",i=this.addDBInput("s",p("editor.targetanchorx"),"edge.target.anchor.x","number",.01),i.items.tag="edgeTargetIsNode",i=this.addDBInput("s",p("editor.targetanchory"),"edge.target.anchor.y","number",.01),i.items.tag="edgeTargetIsNode"},H}(cI),GI=function(i){function H(R,M){return hR(this,H),CR(this,i.call(this,R,M))}return dR(H,i),H.prototype.initForm=function(){this.addCustomProperties(),this.addControlProperties(),this.addLayoutProperties(),this.$27$(),this.$91$(),this.$31$(),this.$93$(),this.$92$(),this.$28$(),this.$29$(),this.$30$(),this.$25$()},H.prototype.$34$=function(H){if(H&&"s:group.type"===H.property)return void this.filterPropertiesLater();i.prototype.$34$.call(this,H)},H.prototype.isTitleVisible=function(H){return(!this.data||!this.data.s("group.type")||"TitleGroupTitle"!==H.title)&&i.prototype.isTitleVisible.call(this,H)},H.prototype.isPropertyVisible=function(H){if(this.data){var R=H.items.tag;if(R&&"groupDepth"===R){var M=this.data.s("group.type");if(M&&"rect"!==M)return!1}}return i.prototype.isPropertyVisible.call(this,H)},H.prototype.$31$=function(){this.addTitle("TitleGroupBasic"),this.addDBComboBox("s",p("editor.type"),"group.type",[void 0,"rect","oval","circle","roundRect"],["",p("editor.grouptype.rect"),p("editor.grouptype.oval"),p("editor.grouptype.circle"),p("editor.grouptype.roundrect")]),this.addDBPosition("s",p("editor.position"),"group.position"),this.addDBColor("s",p("editor.background"),"group.background"),this.addDBGradient(p("editor.gradient"),"group.gradient","group.background","group.gradient.color"),this.addDBColor("s",p("editor.gradientcolor"),"group.gradient.color"),this.addDBImage("s",p("editor.image"),"group.image"),this.addDBStretch("s",p("editor.stretch"),"group.image.stretch"),this.addDBImage("s",p("editor.repeatimage"),"group.repeat.image"),this.addDBCheckBox("s",p("editor.toggleable"),"group.toggleable"),this.addDBCheckBox("p",p("editor.expanded"),"expanded"),this.addDBInput("s",p("editor.depth"),"group.depth","number",1).items.tag="groupDepth"},H.prototype.$93$=function(){this.addTitle("TitleGroupTitle"),this.addDBLabel("s",p("editor.content"),"label"),this.addDBFont("s",p("editor.font"),"group.title.font"),this.addDBColor("s",p("editor.color"),"group.title.color"),this.addDBColor("s",p("editor.background"),"group.title.background"),this.addDBAlign("s",p("editor.align"),"group.title.align"),this.addDBOrientation("s",p("editor.valuetype.orientation"),"group.title.orientation"),this.addDBCheckBox("s",p("editor.splitline"),"group.splitLine")},H.prototype.$92$=function(){this.addTitle("TitleGroupBorder"),this.addDBInput("s",p("editor.width"),"group.border.width","number",1),this.addDBDashPattern("s",p("editor.pattern"),"group.border.pattern"),this.addDBColor("s",p("editor.color"),"group.border.color"),this.addDBComboBox("s",p("editor.join"),"group.border.join",KR.consts.joins,KR.consts.joinLabels),this.addDBComboBox("s",p("editor.cap"),"group.border.cap",KR.consts.caps,KR.consts.capLabels),this.addDBInput("s",p("editor.radius"),"group.border.radius","number",1),this.addDBInput("s",p("editor.padding"),"group.padding","number",1),this.addDBInput("s",p("editor.paddingleft"),"group.padding.left","number",1),this.addDBInput("s",p("editor.paddingright"),"group.padding.right","number",1),this.addDBInput("s",p("editor.paddingtop"),"group.padding.top","number",1),this.addDBInput("s",p("editor.paddingbottom"),"group.padding.bottom","number",1)},H}(NI),kI=function(i){function H(R,M){return hR(this,H),CR(this,i.call(this,R,M))}return dR(H,i),H.prototype.initForm=function(){this.$26$(),this.addCustomProperties(),this.addControlProperties(),this.addLayoutProperties(),this.$27$(),this.$28$(),this.$29$(),this.$30$(),this.$25$()},H.prototype.isTitleVisible=function(H){return!("TitleEditingPoint"===H.title&&!this.editor.pointsEditingMode)&&i.prototype.isTitleVisible.call(this,H)},H.prototype.$23$=function(){this.addDBCheckBox("p",p("editor.closed"),"closePath"),this.addDBColor("s",p("editor.outlinecolor"),"border.color"),this.addDBInput("s",p("editor.outlinewidth"),"border.width","number",1)},H.prototype.$24$=function(){i.prototype.$24$.call(this),this.addDBComboBox("s",p("editor.fillrule"),"shape.fill.rule",KR.consts.fillRules,KR.consts.fillRuleLabels)},H.prototype.$25$=function(){this.addTitle("TitleSelect"),this.addDBColor("s",p("editor.color"),"select.color"),this.addDBInput("s",p("editor.width"),"select.width","number",1);var i=[];this.addLabelCheckBox(i,p("editor.shadow"),function(i){return"shadow"===i.s("select.type")},function(i,H){i.s("select.type",H?"shadow":null)}),this.addDBRow(i,"s","select.type"),this.addDBInput("s",p("editor.shadowblur"),"shadow.blur","number",1),this.addDBInput("s",p("editor.shadowoffsetx"),"shadow.offset.x","number",1),this.addDBInput("s",p("editor.shadowoffsety"),"shadow.offset.y","number",1)},H}(NI),PI=function(i){function H(R,M){return hR(this,H),CR(this,i.call(this,R,M))}return dR(H,i),H.prototype.addControlProperties=function(){i.prototype.addControlProperties.call(this),this.addDBCheckBox("p",p("editor.clickthroughenabled"),"clickThroughEnabled");var H=[];this.addLabelCheckBox(H,p("editor.syncsize"),function(i){return i.isSyncSize()},function(i,H){i instanceof ht.Block&&(i.setSyncSize(H),i instanceof ht.RefGraph&&(i.p(0,0),i.setRotation(0),i.setAnchor(.5,.5),i.setScale(1,1),i.setSize(20,20),i.setRef(i.getRef())))}),this.addDBRow(H,"p","syncSize")},H.prototype.addDBGray=function(){},H.prototype.addDBBodyColorProperty=function(){},H.prototype.addDBOpacityProperty=function(){},H.prototype.$91$=function(){},H.prototype.$28$=function(){},H.prototype.$84$=function(){},H}(NI),ZI=function(i){function H(R,M){return hR(this,H),CR(this,i.call(this,R,M))}return dR(H,i),H.prototype.$27$=function(){i.prototype.$27$.call(this),this.addDBRef()},H.prototype.addDBRef=function(){var i=this,H=[],R=function(i){return i.getRef()},M=function(i,H){i instanceof ht.RefGraph&&(i.p(0,0),i.setRotation(0),i.setAnchor(.5,.5),i.setScale(1,1),i.setSize(20,20),i.setRef(H))},I=function(H,R){var M=R.view.draggingData;return!!M&&(i.editor.url!==M.url&&M.fileType===OR)};return this.addLabelURL(H,p("editor.ref"),R,M,I),this.addDBRow(H,"p","ref")},H.prototype.addDBGray=function(){},H}(PI),vI=function(i){function H(R,M){return hR(this,H),CR(this,i.call(this,R,M))}return dR(H,i),H.prototype.initForm=function(){this.addCustomProperties(),this.addControlProperties(),this.addLayoutProperties(),this.$27$(),this.$21$(),this.$25$()},H.prototype.$21$=function(){this.addTitle("TitleText"),this.addDBInput("s",p("editor.content"),"text"),this.addDBAlign("s",p("editor.align"),"text.align"),this.addDBVAlign("s",p("editor.valign"),"text.vAlign"),this.addDBColor("s",p("editor.color"),"text.color"),this.addDBFont("s",p("editor.font"),"text.font"),this.addDBCheckBox("s",p("editor.shadow"),"text.shadow"),this.addDBColor("s",p("editor.shadowcolor"),"text.shadow.color"),this.addDBInput("s",p("editor.shadowblur"),"text.shadow.blur","number",1),this.addDBInput("s",p("editor.shadowoffsetx"),"text.shadow.offset.x","number",1),this.addDBInput("s",p("editor.shadowoffsety"),"text.shadow.offset.y","number",1)},H}(NI),aI=function(i){function H(R,M){return hR(this,H),CR(this,i.call(this,R,M,"comp"))}return dR(H,i),H.prototype.initForm=function(){this.addCustomProperties(),this.addControlProperties(),this.addLayoutProperties(),this.$11$(),this.$19$()},H.prototype.isTitleVisible=function(H){return!!this.inspectorFilter.isCompTitleVisible(this.editor,this.data?this.data.compType:null,H.title)&&i.prototype.isTitleVisible.call(this,H)},H.prototype.isPropertyVisible=function(H){return!!this.inspectorFilter.isCompPropertyVisible(this.editor,this.data?this.data.compType:null,H.keys&&H.keys.name)&&i.prototype.isPropertyVisible.call(this,H)},H.prototype.addControlProperties=function(){this.addTitle("TitleControl"),this.addEventProperties(),this.addStyleCheckBox(p("editor.visible"),"2d.visible","visible"),this.addStyleCheckBox(p("editor.selectable"),"2d.selectable","selectable"),this.addStyleCheckBox(p("editor.movable"),"2d.movable","movable"),this.addStyleCheckBox(p("editor.editable"),"2d.editable","editable"),this.addStyleCheckBox(p("editor.pixelperfect"),"pixelPerfect","pixelPerfect")},H.prototype.$11$=function(){this.addTitle("TitleBasic"),this.$13$(),this.$14$(),this.addStyleInput(p("editor.prefix"),"prefix","prefix"),this.$18$(),this.addStyleZeroToOne(p("editor.opacity"),"opacity","opacity"),this.addState()},H.prototype.addState=function(){var i=this,H=[],R=new ht.widget.ComboBox,M=q("s","state"),I=Q("s","state");this.addLabel(H,p("editor.state"),M,I),R.onValueChanged=function(){i.setValue(I,R.getValue())},this.updateHandlers.push(function(){if(!H.hidden){var I=i.getValue(M),p=i.editor.symbolStatePane.getAllStateEnum();if(p&&p.length){var h=p.map(function(i){return i.value}),z=p.map(function(i){return i.label||i.value});h.unshift(void 0),z.unshift(""),R.setValues(h),R.setLabels(z),R.getValue()!==I&&R.setValue(I)}}}),H.push(R);var h=this.addFuncRow(H,"state");return h.visible=function(){var H=i.editor.symbolStatePane.getAllStateEnum();return H&&H.length},h},H.prototype.$12$=function(){var i=[];this.addLabelInput(i,p("editor.area"),function(i){return"["+I(i.p().x-i.getWidth()*i.getAnchor().x)+","+I(i.p().y-i.getHeight()*i.getAnchor().y)+","+I(i.getWidth())+","+I(i.getHeight())+"]"}),this.addFuncRow(i,"rect")},H.prototype.$13$=function(){var i=[];this.addLabelInput(i,p("editor.type"),function(i){return i.compType}),this.addRow(i,this.w1).keys={name:"type"}},H.prototype.$14$=function(){var i=[];this.addLabelInput(i,p("editor.name"),function(i){return i.getDisplayName()},function(i,H){i.setDisplayName(H)}),this.addFuncRow(i,"displayName")},H.prototype.$15$=function(){var i=[];this.addLabelInput(i,p("editor.rotation"),function(i){return 180/Math.PI*i.getRotation()},function(i,H){i instanceof ht.Node&&i.setRotation(H*Math.PI/180)},"number",1),this.addFuncRow(i,"rotation")},H.prototype.$16$=function(){var i=[];this.addLabelInput(i,p("editor.anchorx"),function(i){return i.getAnchor().x},function(i,H){i instanceof ht.Node&&i.setAnchor(H,i.getAnchor().y,!0)},"number",.01),this.addFuncRow(i,"anchorX"),i=[],this.addLabelInput(i,p("editor.anchory"),function(i){return i.getAnchor().y},function(i,H){i instanceof ht.Node&&i.setAnchor(i.getAnchor().x,H,!0)},"number",.01),this.addFuncRow(i,"anchorY")},H.prototype.$17$=function(){var i=[];this.addLabelInput(i,p("editor.scalex"),function(i){return i.getScale().x},function(i,H){i instanceof ht.Node&&i.setScale(H,i.getScale().y)},"number",.01),this.addFuncRow(i,"scaleX"),i=[],this.addLabelInput(i,p("editor.scaley"),function(i){return i.getScale().y},function(i,H){i instanceof ht.Node&&i.setScale(i.getScale().x,H)},"number",.01),this.addFuncRow(i,"scaleY")},H.prototype.$18$=function(){this.addStyleZeroToOne(p("editor.clippercentage"),"clip.percentage","clipPercentage"),this.addStyleComboBox(p("editor.clipdirection"),"clip.direction",KR.consts.clipDirections,KR.consts.clipDirectionLabels,null,"clipDirection")},H.prototype.$19$=function(){this.addTitle("TitleShadow"),this.addStyleCheckBox(p("editor.shadow"),"shadow","shadow"),this.addStyleColor(p("editor.shadowcolor"),"select.color","shadowColor"),this.addStyleInput(p("editor.shadowblur"),"shadow.blur","number",1,"shadowblur"),this.addStyleInput(p("editor.shadowoffsetx"),"shadow.offset.x","number",1,"shadowOffsetX"),this.addStyleInput(p("editor.shadowoffsety"),"shadow.offset.y","number",1,"shadowOffsetYs")},H.prototype.$20$=function(){var i=[];return this.addLabelInput(i,p("editor.posx"),function(i){return i.p().x},function(i,H){i instanceof ht.Node&&i.p(H,i.p().y)},"number",1),this.addLabelInput(i,p("editor.posy"),function(i){return i.p().y},function(i,H){i instanceof ht.Node&&i.p(i.p().x,H)},"number",1),this.addRow(i,this.w1w1).keys={name:"position"},i=[],this.addLabelInput(i,p("editor.width"),function(i){return i.getWidth()},function(i,H){i instanceof ht.Node&&i.setWidth(H)},"number",1),this.addLabelInput(i,p("editor.height"),function(i){return i.getHeight()},function(i,H){i instanceof ht.Node&&i.setHeight(H)},"number",1),this.addRow(i,this.w1w1).keys={name:"size"},i},H.prototype.addStyleColor=function(i,H,R,M){var I=[];return this.addLabelColor(I,i,function(i){return i.s(H)},function(i,R){"shape.background"===H&&i.s("shape.gradient.pack")&&i.s("shape.gradient.pack",void 0),i.s(H,R)}),this.addFuncRow(I,H,R,M)},H.prototype.addStyleFunction=function(i,H,R,M,I){var p=[];return this.addLabelFunction(p,i,function(i){return i.s(H)},function(i,R){i.s(H,R)},R,M),this.addFuncRow(p,H,R,I)},H.prototype.addStyleDataModel=function(i,H,R,M,I){var p=[];return this.addLabelDataModel(p,i,function(i){return i.s(H)},function(i,R){i.s(H,R)},R,M),this.addFuncRow(p,H,R,I)},H.prototype.addStyleObject=function(i,H,R,M,I){var p=[];return this.addLabelObject(p,i,function(i){return i.s(H)},function(i,R){i.s(H,R)},R,I&&I.objectProperties),this.addFuncRow(p,H,R,M)},H.prototype.addStyleLabel=function(i,H,R,M){var I=[];return this.addLabelInput(I,i,function(i){var R=i.s(H);return R&&R.replace&&(R=R.replace(/\n/g,"\\n")),R},function(i,R){R&&R.replace&&(R=R.replace(/\\n/g,"\n")),i.s(H,R)}),this.addFuncRow(I,H,R,M)},H.prototype.addStyleArray=function(i,H,R,M,I,p){var h=[];return this.addLabelArray(h,i,function(i){return i.s(H)},function(i,R){i.s(H,R)},M,p),this.addFuncRow(h,H,R,I)},H.prototype.addStyleMultiline=function(i,H,R,M){var I=[];return this.addLabelMultiline(I,i,function(i){return i.s(H)},function(i,R){i.s(H,R)}),this.addFuncRow(I,H,R,M)},H.prototype.addStyleFont=function(i,H,R,M){var I=[];return this.addLabelFont(I,i,function(i){return i.s(H)},function(i,R){i.s(H,R)}),this.addFuncRow(I,H,R,M)},H.prototype.addStyleTextArea=function(i,H,R,M){var I=[];return this.addLabelTextArea(I,i,function(i){return i.s(H)},function(i,R){i.s(H,R)}),this.addFuncRow(I,H,R,M)},H.prototype.addStyleInput=function(i,H,R,M,I,p){var h=[];return this.addLabelInput(h,i,function(i){return i.s(H)},function(i,R){i.s(H,R)},R,M),this.addFuncRow(h,H,I,p)},H.prototype.addStyleCheckBox=function(i,H,R,M){var I=[];return this.addLabelCheckBox(I,i,function(i){return i.s(H)},function(i,R){i.s(H,R)}),this.addFuncRow(I,H,R,M)},H.prototype.addStyleAlign=function(i,H,R,M){var I=[];return this.addLabelComboBox(I,i,function(i){return i.s(H)||"center"},function(i,R){i.s(H,R)},["left","center","right"],[p("editor.align.left"),p("editor.align.center"),p("editor.align.right")]),this.addFuncRow(I,H,R,M)},H.prototype.addStyleVAlign=function(i,H,R,M){var I=[];return this.addLabelComboBox(I,i,function(i){return i.s(H)||"bottom"},function(i,R){i.s(H,R)},["top","middle","bottom"],[p("editor.valign.top"),p("editor.valign.middle"),p("editor.valign.bottom")]),this.addFuncRow(I,H,R,M)},H.prototype.addStyleStretch=function(i,H,R,M){var I=[];return this.addLabelComboBox(I,i,function(i){return i.s(H)||"fill"},function(i,R){i.s(H,R)},["fill","uniform","centerUniform"],[p("editor.stretch.fill"),p("editor.stretch.uniform"),p("editor.stretch.centeruniform")]),this.addFuncRow(I,H,R,M)},H.prototype.addStyleComboBox=function(i,H,R,M,I,p,h){var z=[];return this.addLabelComboBox(z,i,function(i){return i.s(H)},function(i,R){i.s(H,R)},R,M,I),this.addFuncRow(z,H,p,h)},H.prototype.addStyleImage=function(i,H,R,M){var I=[];return this.addLabelImage(I,i,function(i){return i.s(H)},function(i,R){i.s(H,R)}),this.addFuncRow(I,H,R,M)},H.prototype.addStyleURL=function(i,H,R,M){var I=[];return this.addLabelURL(I,i,function(i){return i.s(H)},function(i,R){i.s(H,R)}),this.addFuncRow(I,H,R,M)},H.prototype.addStylePattern=function(i,H,R,M){var I=[];return this.addLabelPattern(I,i,function(i){return i.s(H)},function(i,R){i.s(H,R)}),this.addFuncRow(I,H,R,M)},H.prototype.addStyleDashPattern=function(i,H,R,M){var I=[];return this.addLabelDashPattern(I,i,function(i){return i.s(H)},function(i,R){i.s(H,R)}),this.addFuncRow(I,H,R,M)},H.prototype.addStyleZeroToOne=function(i,H,R){return this.addStyleRange(i,H,0,1,.01,R)},H.prototype.addStylePosition=function(i,H,R){return this.addStyleRange(i,H,1,55,1,R)},H.prototype.addStyleRange=function(i,H,R,M,I,p){var h=[];return this.addLabelInput(h,i,function(i){var R=i.s(H);return null==R?M:R},function(i,I){void 0!==M&&I>M&&(I=M),void 0!==R&&I<R&&(I=R),i.s(H,I)},"number",I),this.addFuncRow(h,H,p)},H.prototype.addStyleRotation=function(i,H,R,M,I,p){var h=[];return this.addLabelInput(h,i,function(i){var R=i.s(H);return null==R?I:180/Math.PI*R},function(i,R){R=R*Math.PI/180,void 0!==I&&R>I&&(R=I),void 0!==M&&R<M&&(R=M),i.s(H,R)},"number",p||1),this.addFuncRow(h,H,R)},H.prototype.addStyleGradient=function(i,H,R,M,I){var p=[];return this.addLabelGradient(p,i,H,R,M),this.addFuncRow(p,H,I)},H.prototype.addStyleGradientPack=function(i,H,R,M){},H.prototype.addLayoutProperties=function(){var i=this;this.addTitle("TitleLayout"),this.$12$(),this.$20$(),this.$15$(),this.$16$(),this.$17$();var H=function(i){return!!i.getValue(function(i){return i.dm().a("fitSize")})},R=this.layoutGv=new ht.graph.GraphView,M=this.layoutNode=new ht.Node,I=!1;if(M.setImage("editor.layout.helper"),M.a("selectColor",KR.config.color_select),R.dm().add(M),R.tx(50),R.ty(50),R.handleScroll=function(){},R.handlePinck=function(){},R.setScrollBarVisible(!1),R.setRectSelectable(!1),R.setPannable(!1),R.setMovableFunc(function(){return!1}),R.dm().md(function(H){I||(i.beginTransaction(),i.dataModel.sm().getSelection().each(function(i){"a:layout.v"===H.property?i.s("layout.v",H.newValue):"a:layout.h"===H.property&&i.s("layout.h",H.newValue)}),i.endTransaction())}),KR.config.layoutEnabled){this.addRow(["",{element:R},""],[.1,100,.1],100).visible=H,this.addUpdateHandler(function(H,R){var p=i.data;I=!0,M.a({"layout.v":p.s("layout.v"),"layout.h":p.s("layout.h")}),I=!1});var h=[];this.addLabelComboBox(h,p("editor.nodeLayout.h"),function(i){return i.s("layout.h")},function(i,H){i.s("layout.h",H)},KR.consts.hLayoutValues,KR.consts.hLayoutLabels),this.addFuncRow(h,"layout.h").visible=H,h=[],this.addLabelComboBox(h,p("editor.nodeLayout.v"),function(i){return i.s("layout.v")},function(i,H){i.s("layout.v",H)},KR.consts.vLayoutValues,KR.consts.vLayoutLabels),this.addFuncRow(h,"layout.v").visible=H}},H}(XI),FI=function(i){function H(R,M){return hR(this,H),CR(this,i.call(this,R,M))}return dR(H,i),H.prototype.$34$=function(H){if(H&&"s:shape"===H.property)return void this.filterPropertiesLater();i.prototype.$34$.call(this,H)},H.prototype.isTitleVisible=function(H){if(this.data){var R=this.data.s("shape");if("TitleArc"===H.title&&"arc"!==R)return!1}return i.prototype.isTitleVisible.call(this,H)},H.prototype.isPropertyVisible=function(H){if(this.data){var R=H.items.tag;if(R){var M=this.data.s("shape");if("shapeDepth"===R&&"rect"!==M)return!1;if("shapeCornerRadius"===R&&"roundRect"!==M)return!1;if("shapePolygonSide"===R&&"polygon"!==M)return!1}}return i.prototype.isPropertyVisible.call(this,H)},H.prototype.initForm=function(){i.prototype.initForm.call(this),this.$36$(),this.$37$(),this.addDashProperties(),this.addArcProperties()},H.prototype.$13$=function(){this.addStyleComboBox(p("editor.type"),"shape",KR.consts.shapes.slice(1),KR.consts.shapeLabels.slice(1),KR.consts.shapeIcons.slice(1),"type")},H.prototype.$36$=function(){this.addTitle("TitleBackground"),this.addStyleColor(p("editor.background"),"shape.background","background"),this.addStyleImage(p("editor.repeatimage"),"shape.repeat.image","repeatImage"),this.addStyleGradientPack(p("editor.gradient.pack"),"shape.gradient.pack","gradientPack"),this.addStyleGradient(p("editor.gradient"),"shape.gradient","shape.background","shape.gradient.color","gradient"),this.addStyleColor(p("editor.gradientcolor"),"shape.gradient.color","gradientColor"),this.addStyleZeroToOne(p("editor.clippercentage"),"shape.fill.clip.percentage","fillClipPercentage"),this.addStyleComboBox(p("editor.clipdirection"),"shape.fill.clip.direction",KR.consts.clipDirections,KR.consts.clipDirectionLabels,null,"fillClipDirection"),this.addStyleInput(p("editor.depth"),"shape.depth","int",1,"depth").items.tag="shapeDepth"},H.prototype.$37$=function(){this.addTitle("TitleBorder"),this.addStyleInput(p("editor.width"),"shape.border.width","number",1,"borderWidth"),this.addStyleCheckBox(p("editor.widthabsolute"),"shape.border.width.absolute","borderWidthAbsolute"),this.addStyleColor(p("editor.color"),"shape.border.color","borderColor"),this.addStyleGradientPack(p("editor.gradient.pack"),"shape.border.gradient.pack","borderGradientPack"),this.addStyleDashPattern(p("editor.pattern"),"shape.border.pattern","borderPattern"),this.addStyleCheckBox(p("editor.threed"),"shape.border.3d","border3d"),this.addStyleColor(p("editor.threedcolor"),"shape.border.3d.color","border3dColor"),this.addStyleComboBox(p("editor.cap"),"shape.border.cap",KR.consts.caps,KR.consts.capLabels,null,"borderCap"),this.addStyleComboBox(p("editor.join"),"shape.border.join",KR.consts.joins,KR.consts.joinLabels,null,"borderJoin"),this.addStyleInput(p("editor.radius"),"shape.corner.radius","number",1,"cornerRadius").items.tag="shapeCornerRadius",this.addStyleInput(p("editor.sides"),"shape.polygon.side","int",1,"polygonSide").items.tag="shapePolygonSide"},H.prototype.addDashProperties=function(){this.addTitle("TitleDash"),this.addStyleCheckBox(p("editor.dash"),"shape.dash","dash"),this.addStyleDashPattern(p("editor.pattern"),"shape.dash.pattern","dashPattern"),this.addStyleColor(p("editor.color"),"shape.dash.color","dashColor"),this.addStyleInput(p("editor.offset"),"shape.dash.offset","number",1,"dashOffset"),this.addStyleInput(p("editor.width"),"shape.dash.width","number",1,"dashWidth"),this.addStyleCheckBox(p("editor.threed"),"shape.dash.3d","dash3d"),this.addStyleColor(p("editor.threedcolor"),"shape.dash.3d.color","dash3dColor")},H.prototype.addArcProperties=function(){this.addTitle("TitleArc"),this.addStyleCheckBox(p("editor.arcoval"),"shape.arc.oval","arcOval"),this.addStyleCheckBox(p("editor.closed"),"shape.arc.close","arcClose"),this.addStyleRotation(p("editor.arcfrom"),"shape.arc.from","arcFrom"),this.addStyleRotation(p("editor.arcto"),"shape.arc.to","arcTo")},H}(aI),wI=function(i){function H(R,M){return hR(this,H),CR(this,i.call(this,R,M))}return dR(H,i),H.prototype.initForm=function(){i.prototype.initForm.call(this),this.addTitle("TitleImage");var H=[];this.addLabelImage(H,p("editor.name"),function(i){return i.s("image")},function(i,H){ti(H)&&H.endsWith("[...]")||i.s("image",H)}),this.addButton(H,null,p("editor.resetsize"),"editor.resetsize.state",function(i){i instanceof ht.Node&&i.setSize(-1,-1)}),this.addFuncRow(H,"image","name"),this.addStyleColor(p("editor.color"),"body.color","color"),this.addStyleStretch(p("editor.stretch"),"image.stretch","stretch")},H}(aI),BI=function(i){function H(R,M){return hR(this,H),CR(this,i.call(this,R,M))}return dR(H,i),H.prototype.initForm=function(){i.prototype.initForm.call(this),this.$43$()},H.prototype.$43$=function(){this.addTitle("TitleBorder"),this.addStyleInput(p("editor.width"),"border_width","number",1,"border"),this.addStyleColor(p("editor.color"),"border_color","color")},H}(aI),EI=function(i){function H(R,M){return hR(this,H),CR(this,i.call(this,R,M))}return dR(H,i),H.prototype.initForm=function(){i.prototype.initForm.call(this),this.addBasicChartProperties()},H.prototype.addBasicChartProperties=function(){this.addTitle("TitleChart"),this.addStyleCheckBox(p("editor.text"),"chart.label","label"),this.addStyleColor(p("editor.color"),"chart.label.color","labelColor"),this.addStyleFont(p("editor.font"),"chart.label.font","labelFont")},H}(aI),_I=function(i){function H(R,M){return hR(this,H),CR(this,i.call(this,R,M))}return dR(H,i),H.prototype.initForm=function(){i.prototype.initForm.call(this),this.addPieChartProperties()},H.prototype.addBasicChartProperties=function(){i.prototype.addBasicChartProperties.call(this),this.addStyleRotation(p("editor.rotation"),"chart.start.angle","startAngle"),this.addStyleCheckBox(p("editor.hollow"),"chart.hollow","hollow")},H.prototype.createChartIndexColumn=function(i){var H=this;return{name:i,width:50,align:"center",editable:!0,sortable:!1,clickable:!1,getValueType:function(i){return"chart.values"===i.getTag()?"number":"color"},getValue:function(R){if(H.data){var M=H.data.s(R.getTag());return M?M[i]:void 0}},setValue:function(R,M,I,p){var h=R.getTag(),z=function(H,R){var M=yH(H.s(h));M[i]=R,"chart.values"===h?dH(M):CH(M),H.s(h,M)};H.setValue(z,I)}}},H.prototype.addPieChartProperties=function(){var i=this,H=this.tableModel=new ht.DataModel,R=this.tablePane=new $R(H),M=this.tableView=R.getTableView();R.getTableHeader().setMovable(!1),M.setEditable(!0),M.isEditable=function(){return i.editor.editable},R.getView().style.border=KR.config.color_line+" solid 1px";var I=[R];this.addRow(I,[.1],ht.Default.widgetRowHeight+4*M.getRowHeight()).keys={name:"chartTable"};var h=new ht.Data,z=new ht.Data;h.setTag("chart.values"),z.setTag("chart.colors"),H.add(h),H.add(z),this.updateHandlers.push(function(){if(!I.hidden&&i.data){M.getColumnModel().clear(),R.addColumns([{name:p("editor.length"),width:50,align:"center",editable:!0,sortable:!1,clickable:!1,valueType:"int",getValue:function(H){if(!i.data)return 0;var R=i.data.s("chart.values");return R?R.length:0},setValue:function(H,R,M,I){var p=function(i,H){if(H>=0){var R=yH(i.s("chart.values"),H);dH(R),i.s("chart.values",R),R=yH(i.s("chart.colors"),H),CH(R),i.s("chart.colors",R)}};i.setValue(p,M)}},{tag:"binding",name:p("editor.binding"),width:50,align:"center",editable:!0,sortable:!1,clickable:!1,isCellEditable:function(H,M,I,p){var h="chart.values"===H.getTag()?"values":"colors";return i.editor.funcView.toggle(R,H.getTag(),h,i),!1},drawCell:function(H,R,M,I,p,h,z,d,C){var y=!!i.data.a(R.getTag());S(H,ht.Default.getImage(y?"editor.bind":"editor.unbind"),"centerUniform",p,h,z,d,R,C,y&&!M?KR.config.color_select:KR.config.color_dark)}}]);for(var H=i.data.s("chart.values"),h=H?H.length:0,z=0;z<h;z++)R.addColumns([i.createChartIndexColumn(z)])}})},H}(EI),xI=function(i){function H(R,M){return hR(this,H),CR(this,i.call(this,R,M))}return dR(H,i),H.prototype.initForm=function(){i.prototype.initForm.call(this),this.addOneDimensionalProperties()},H.prototype.createChartIndexColumn=function(i){var H=this;return{name:i,width:50,align:"center",editable:!0,sortable:!1,clickable:!1,getValueType:function(i){return"values"===i.getTag()?"number":"color"},getValue:function(R){if(H.data){var M=$i(H.data.s("chart.series"));if(M&&M[0]){var I=$i(M[0][R.getTag()]);return I?I[i]:void 0}}},setValue:function(R,I,p,h){var z=R.getTag(),d=function(H,R){var I=H.s("chart.series");if(I){var p=M(I),h=$i(p);if(h[0]){var d=$i(h[0][z]);d&&d[i]!==R&&(d[i]=R,"values"===z?dH(d):CH(d),H.s("chart.series",p))}}};H.setValue(d,p)}}},H.prototype.addOneDimensionalProperties=function(){var i=this,H=this.tableModel=new ht.DataModel,R=this.tablePane=new $R(H),I=this.tableView=R.getTableView();R.getTableHeader().setMovable(!1),I.setEditable(!0),I.isEditable=function(){return i.editor.editable},R.getView().style.border=KR.config.color_line+" solid 1px";var h=[R];this.addRow(h,[.1],ht.Default.widgetRowHeight+4*I.getRowHeight()).keys={name:"chartTable"};var z=new ht.Data,d=new ht.Data;z.setTag("values"),d.setTag("colors"),H.add(z),H.add(d),this.updateHandlers.push(function(){if(!h.hidden&&i.data){I.getColumnModel().clear(),R.addColumns([{name:p("editor.length"),width:50,align:"center",editable:!0,sortable:!1,clickable:!1,valueType:"int",getValue:function(H){if(!i.data)return 0;var R=$i(i.data.s("chart.series"));if(!R)return 0;if(!R[0])return 0;var M=$i(R[0].values);return M?M.length:0},setValue:function(H,R,I,p){var h=function(i,H){if(H>=0){var R=i.s("chart.series"),I=R?M(R):[],p=$i(I);p[0]||(p[0]={});var h=p[0];h.values||(h.values=[]),h.colors||(h.colors=[]);var z=$i(h.values),d=$i(h.colors);H===z.length&&H===d.length||(z.length=H,d.length=H,dH(z),CH(d),i.s("chart.series",I))}};i.setValue(h,I)}},{tag:"binding",name:p("editor.binding"),width:50,align:"center",editable:!0,sortable:!1,clickable:!1,isCellEditable:function(H,I,p,h){var z=H.getTag(),d=function(){return VH(i.data,z)},C=function(H){i.setValue(function(i,R){var I=i.s("chart.series");if(I){var p=M(I),h=$i(p);if(h[0]){var d=$i(h[0][z]);h[0][z]=H?{value:d,func:H}:d,i.s("chart.series",p)}}},H)};return i.editor.funcView.toggle(R,z,z,i,d,C),!1},drawCell:function(H,R,M,I,p,h,z,d,C){var y=!!VH(i.data,R.getTag());S(H,ht.Default.getImage(y?"editor.bind":"editor.unbind"),"centerUniform",p,h,z,d,R,C,y&&!M?KR.config.color_select:KR.config.color_dark)}}])
;for(var H=lH(i.data,"values"),z=H?H.length:0,d=0;d<z;d++)R.addColumns([i.createChartIndexColumn(d)])}})},H}(EI),jI=function(i){function H(R,M){return hR(this,H),CR(this,i.call(this,R,M))}return dR(H,i),H.prototype.initForm=function(){i.prototype.initForm.call(this),this.addSeriesChartProperties()},H.prototype.addSeriesChartProperties=function(){var i=this,H=[],R=function(i){var H=i.s("chart.series");return H?H.length:0},I=function(i,H){if(H>=0){var R=i.s("chart.series"),I=R?M(R):[],p=$i(I);if(p.length!==H){p.length=H;for(var h=void 0,z=0;z<H;z++){p[z]||(p[z]={});var d=p[z];d.values||(d.values=[]),d.color||(d.color=ht.Color.chart[z%ht.Color.chart.length]);var C=$i(d.values);$i(d.colors);0===z?h=C.length:C.length=h,dH(C)}i.s("chart.series",I)}}};this.addLabelInput(H,p("editor.series"),R,I,"int",1),R=function(i){var H=i.s("chart.series");if(H){var R=H[0];if(R){var M=$i(R.values);return M?M.length:0}}return 0},I=function(i,H){if(H>=0){var R=i.s("chart.series"),I=R?M(R):[],p=$i(I);if(p.length){for(var h=0;h<p.length;h++){p[h]||(p[h]={});var z=p[h];z.values||(z.values=[]);var d=$i(z.values);if(d.length===H)return;z.color||(z.color=ht.Color.chart[h%ht.Color.chart.length]);$i(z.colors);d.length=H,dH(d)}i.s("chart.series",I)}}},this.addLabelInput(H,p("editor.length"),R,I,"int",1),this.addRow(H,this.w1w1).keys={name:"chartSeries"};var h=this.tableModel=new ht.DataModel,z=this.tablePane=new $R(h),d=this.tableView=z.getTableView();z.getTableHeader().setMovable(!1),d.setEditable(!0),d.isEditable=function(){return i.editor.editable},z.getView().style.border=KR.config.color_line+" solid 1px";var C=[z];this.addRow(C,[.1],160).keys={name:"chartTable"},this.updateHandlers.push(function(){if(!C.hidden&&i.data){h.clear(),d.getColumnModel().clear();var H=i.data.s("chart.series");if(H)for(var R=0;R<H.length;R++){var I=new ht.Data;I.serie=H[R],I.index=R,h.add(I)}if(z.addColumns([{name:p("editor.index"),width:50,align:"center",sortable:!1,clickable:!1,valueType:"int",getValue:function(i){return i.index}},{tag:"binding",name:p("editor.colorbinding"),width:50,align:"center",editable:!0,sortable:!1,clickable:!1,isCellEditable:function(H,R,I,p){var h=H.index,d=function(){return li(H.serie.color)},C=function(H){i.setValue(function(i,R){var I=i.s("chart.series");if(I){var p=M(I),z=$i(p),d=z[h];if(d){var C=$i(d.color);d.color=H?{value:C,func:H}:C,i.s("chart.series",p)}}},H)};return i.editor.funcView.toggle(z,"values","values",i,d,C),!1},drawCell:function(i,H,R,M,I,p,h,z,d){var C=!!li(H.serie.color);S(i,ht.Default.getImage(C?"editor.bind":"editor.unbind"),"centerUniform",I,p,h,z,H,d,C&&!R?KR.config.color_select:KR.config.color_dark)}},{name:p("editor.color"),width:50,align:"center",editable:!0,sortable:!1,clickable:!1,valueType:"color",getValue:function(i){return $i(i.serie.color)},setValue:function(H,R,I,p){var h=H.index,z=$i(H.serie.color);if(I&&z!==I){var d=function(i,H){var R=i.s("chart.series");if(R){var I=M(R),p=$i(I),z=p[h];if(z){var d=li(z.color);z.color=d?{value:H,func:d}:H,i.s("chart.series",I)}}};i.setValue(d,I)}}},{tag:"binding",name:p("editor.valuebinding"),width:50,align:"center",editable:!0,sortable:!1,clickable:!1,isCellEditable:function(H,R,I,p){var h=H.index,d=function(){return li(H.serie.values)},C=function(H){i.setValue(function(i,R){var I=i.s("chart.series");if(I){var p=M(I),z=$i(p),d=z[h];if(d){var C=$i(d.values);d.values=H?{value:C,func:H}:C,i.s("chart.series",p)}}},H)};return i.editor.funcView.toggle(z,"values","values",i,d,C),!1},drawCell:function(i,H,R,M,I,p,h,z,d){var C=!!li(H.serie.values);S(i,ht.Default.getImage(C?"editor.bind":"editor.unbind"),"centerUniform",I,p,h,z,H,d,C&&!R?KR.config.color_select:KR.config.color_dark)}}]),H){var y=H[0];if(y){var b=$i(y.values);if(b)for(var U=0;U<b.length;U++)z.addColumns([i.createChartIndexColumn(U)])}}}})},H.prototype.createChartIndexColumn=function(i){var H=this;return{name:i,width:50,align:"center",editable:!0,sortable:!1,clickable:!1,valueType:"number",getValue:function(H){var R=$i(H.serie.values);return R?R[i]:void 0},setValue:function(R,I,p,h){var z=R.index,d=function(H,R){var I=H.s("chart.series");if(I){var p=M(I),h=$i(p);if(h[z]){var d=$i(h[z].values);d&&d[i]!==R&&(d[i]=R,H.s("chart.series",p))}}};H.setValue(d,p)}}},H}(EI),YI=function(i){function H(R,M){return hR(this,H),CR(this,i.call(this,R,M))}return dR(H,i),H.prototype.addBasicChartProperties=function(){i.prototype.addBasicChartProperties.call(this),this.addStyleComboBox(p("editor.type"),"chart.type",KR.consts.columnChartTypes,KR.consts.columnChartTypeLabels,null,"type")},H.prototype.$13$=function(){},H}(jI),rI=function(i){function H(R,M){return hR(this,H),CR(this,i.call(this,R,M))}return dR(H,i),H.prototype.initForm=function(){i.prototype.initForm.call(this)},H}(jI),eI=function(i){function H(R,M){return hR(this,H),CR(this,i.call(this,R,M))}return dR(H,i),H.prototype.initForm=function(){this.$26$(),i.prototype.initForm.call(this)},H.prototype.isTitleVisible=function(H){return!("TitleEditingPoint"===H.title&&!this.editor.pointsEditingMode)&&i.prototype.isTitleVisible.call(this,H)},H.prototype.$13$=function(){var i=[];this.addLabelInput(i,p("editor.type"),function(i){return i.compType}),this.addRow(i,this.w1).keys={name:"type"}},H.prototype.$36$=function(){i.prototype.$36$.call(this),this.addStyleComboBox(p("editor.fillrule"),"shape.fill.rule",KR.consts.fillRules,KR.consts.fillRuleLabels,null,"fillRule")},H.prototype.$37$=function(){i.prototype.$37$.call(this);var H=[];this.addLabelCheckBox(H,p("editor.closed"),function(i){return i.isClosePath()},function(i,H){i instanceof ht.Shape&&i.setClosePath(H)}),this.addFuncRow(H,"name")},H}(FI),sI=function(i){function H(R,M){return hR(this,H),CR(this,i.call(this,R,M))}return dR(H,i),H.prototype.initForm=function(){i.prototype.initForm.call(this),this.addTitle("TitleText"),this.addStyleLabel(p("editor.text"),"text","text"),this.addStyleAlign(p("editor.align"),"text.align","align"),this.addStyleVAlign(p("editor.valign"),"text.vAlign","vAlign"),this.addStyleColor(p("editor.color"),"text.color","color"),KR.SceneView&&(this.addStyleGradientPack(p("editor.gradient.pack"),"text.gradient.pack","gradientPack"),this.addStyleGradient(p("editor.gradient"),"text.gradient","text.color","text.gradient.color","gradient"),this.addStyleColor(p("editor.gradientcolor"),"text.gradient.color","gradientColor"),this.addStyleCheckBox(p("editor.vertical"),"text.vertical","vertical"),this.addStyleInput(p("editor.vertical.gap"),"text.vertical.gap","number",1,"verticalGap"),this.addStyleComboBox(p("editor.textdecoration"),"text.decoration",[void 0,"overline","strikethrough","underline"],["",p("editor.overline"),p("editor.line.through"),p("editor.underline")],null,"decoration")),this.addStyleFont(p("editor.font"),"text.font","font")},H.prototype.$19$=function(){this.addTitle("TitleShadow"),this.addStyleCheckBox(p("editor.shadow"),"text.shadow","shadow"),this.addStyleColor(p("editor.shadowcolor"),"text.shadow.color","shadowColor"),this.addStyleInput(p("editor.shadowblur"),"text.shadow.blur","number",1,"shadowblur"),this.addStyleInput(p("editor.shadowoffsetx"),"text.shadow.offset.x","number",1,"shadowOffsetX"),this.addStyleInput(p("editor.shadowoffsety"),"text.shadow.offset.y","number",1,"shadowOffsetYs")},H}(aI),WI=function(i){function H(R,M){return hR(this,H),CR(this,i.call(this,R,M))}return dR(H,i),H.prototype.$13$=function(){var i=[];this.addLabelInput(i,p("editor.type"),function(i){return"function"}),this.addFuncRow(i,"type")},H}(aI),$I=function(i){function H(R,M){return hR(this,H),CR(this,i.call(this,R,M))}return dR(H,i),H.prototype.initForm=function(){i.prototype.initForm.call(this),this.addComponent()},H.prototype.$13$=function(){},H.prototype.addComponent=function(){var i=this;this.addTitle("TitleComponent");var H=[];H.forceToUpdate=!0;var R=function(i,H){return!!H.view.draggingData&&H.view.draggingData.fileType===cR};this.addLabelURL(H,p("editor.type"),function(H){var R=H.s("type");return i.$42$(H.properties),R},function(i,H){i.s("type",H)},R);var M=new ht.widget.Image;M.vectorDataBindingDisabled=!0,this.updateHandlers.push(function(){if(!H.hidden){var R=i.data?i.data.s("type"):null;i.$42$(i.data.properties),M.setIcon(R?ci(R):null),M.compType=R}});var I=M.getView();I.style.cursor="pointer";var h=function(H){H.preventDefault(),N(H)?i.editor.open(M.compType):i.editor.selectFileNode(M.compType)};I.addEventListener("mousedown",h,!1),I.addEventListener("touchstart",h,!1),H.push(M),this.addFuncRow(H,"type")},H.prototype.$42$=function(i){var H=this;this.properties!==i&&(this.pendingProperties=i,this._updateComponentLater||(this._updateComponentLater=!0,requestAnimationFrame(function(){H.$60$()})))},H.prototype.$60$=function(){if(this._updateComponentLater=!1,this.properties===this.pendingProperties)return void(this.pendingProperties=null);if(this._rows=this.$46$,this.removeRows(this.$35$),this.propertiesHandlers&&this.propertiesHandlers.length&&this.propertiesHandlers.forEach(this.removeUpdateHandler,this),this.$35$=[],this.properties=this.pendingProperties,this.properties){var i=this.updateHandlers.length,H=void 0;for(var R in this.properties){var M=this.properties[R];if(M.group&&H!==M.group){H=M.group;var I=this.addTitle(H);this.$35$.push(I)}this.addProperty(R,M)}this.propertiesHandlers=this.updateHandlers.slice(i)}this.$46$=this._rows,this.filterProperties()},H.prototype.addProperty=function(i,H){var R=KR.config.valueTypes[H.valueType];if(!R)return this.editor.fireEvent("error",{message:"Wrong value type:"+H.valueType}),!1;var M=p(H.name)||i,I=H.extraInfo,C=void 0,y=void 0,b=void 0;I&&I.enum&&(C=I.enum.values,y=d(I.enum.labels,I.enum.i18nLabels),b=I.enum.icons);var U=void 0;if(I&&I.buildUI){var K=function(H){return H.s(i)},q=function(H,R){H.s(i,R)},Q=[];U=I.buildUI(this,Q,M,K,q,I),this.addFuncRow(Q,i,i,h(U,R),z(U,R))}else if(C)this.addStyleComboBox(M,i,C,y,b,i);else if("int"===R.type||"number"===R.type){var m=(R.max,R.min,function(H){return H.s(i)}),X=function(H,R){H.s(i,R)},o=[];R.angle?this.addLabelRotation(o,M,m,X,R.min,R.max,R.step):this.addLabelRange(o,M,m,X,R.min,R.max,R.step,R.type),this.addFuncRow(o,i,i,h(U,R))}else if("color"===R.type)this.addStyleColor(M,i,i,h(U,R));else if("boolean"===R.type)this.addStyleCheckBox(M,i,i,h(U,R));else if("enum"===R.type)this.addStyleComboBox(M,i,R.values,R.labels,R.icons,i);else if("multiline"===R.type)this.addStyleMultiline(M,i,i,h(U,R));else if("font"===R.type)this.addStyleFont(M,i,i,h(U,R));else if("image"===R.type)this.addStyleImage(M,i,i,h(U,R));else if("url"===R.type)this.addStyleURL(M,i,i,h(U,R));else if("colorArray"===R.type)this.addStyleArray(M,i,i,"color",h(U,R),I);else if("numberArray"===R.type)this.addStyleArray(M,i,i,"number",h(U,R),I);else if("stringArray"===R.type)this.addStyleArray(M,i,i,"string",h(U,R),I);else if("objectArray"===R.type)this.addStyleArray(M,i,i,"object",h(U,R),I);else if("function"===R.type){var J=void 0;I&&I.arguments&&(J=I.arguments),this.addStyleFunction(M,i,i,J,h(U,R))}else if("dataModel"===R.type)this.addStyleDataModel(M,i,i,I,h(U,R));else if("custom"===R.type){var O=function(H){return H.s(i)},c=function(H,R){H.s(i,R)},t=[];U=R.buildUI(this,t,M,O,c,I),this.addFuncRow(t,i,i,h(U,R),z(U,R))}else"object"===R.type?this.addStyleObject(M,i,i,h(U,R),I):"gradientPack"===R.type?this.addStyleGradientPack(M,i,i,h(U,R)):this.addStyleInput(M,i,null,null,i,h(U,R));return this.$35$.push(this._rows[this._rows.length-1]),!0},H}(aI),lI=function(i){function H(R,M){return hR(this,H),CR(this,i.call(this,R,M))}return dR(H,i),H.prototype.initForm=function(){this.$26$(),this.addTitle("TitleBasic"),this.$13$(),this.$14$()},H.prototype.isTitleVisible=function(H){return!("TitleEditingPoint"===H.title&&!this.editor.pointsEditingMode)&&i.prototype.isTitleVisible.call(this,H)},H}(aI),VI=function(i){function H(R,M){return hR(this,H),CR(this,i.call(this,R,M))}return dR(H,i),H.prototype.initForm=function(){this.addTitle("TitleBasic"),this.$13$(),this.$14$()},H}(aI),AI=function(i){function H(R){hR(this,H);var M=CR(this,i.call(this));return M.editor=R,M.getView().style.background=KR.config.color_pane,M}return dR(H,i),H.prototype.handleDataModelPropertyChange=function(i){var H=this.inspector;H&&H.global&&H.$34$(i)},H.prototype.handleDataModelChange=function(i){var H=this.inspector;H&&H.global&&H.$34$()},H.prototype.handleDataPropertyChange=function(i){var H=this.inspector;H&&!H.global&&H.data===i.data&&H.$34$(i)},H.prototype.handleSelectionChange=function(i){this.updateInspector(),this.inspector&&this.inspector.updateProperties()},H.prototype.handleGraphViewInteractorChange=function(i){var H=this.inspector;H&&("pointsEditingMode"===i.property?H.filterPropertiesLater():"shapePointStatus"===i.property&&H.editingPointButtons&&H.editingPointButtons.forEach(function(H){H.setSelected(H.statusValue===i.newValue),H.setBorderColor(H.isSelected()?KR.config.color_line:null)}))},H.prototype.$5$=function(i){this.inspector&&this.inspector.endEdit(),this.dataModel&&(this.dataModel.removeDataModelChangeListener(this.handleDataModelChange,this),this.dataModel.removePropertyChangeListener(this.handleDataModelPropertyChange,this),this.dataModel.removeDataPropertyChangeListener(this.handleDataPropertyChange,this),this.dataModel.sm().ums(this.handleSelectionChange,this),this.currentView.removeInteractorPropertyChangeListener(this.handleGraphViewInteractorChange,this)),this.editor.hasInspector(i)?(this.currentView=i.getView(),this.dataModel=this.currentView.dm,this.dataModel.addDataModelChangeListener(this.handleDataModelChange,this),this.dataModel.addPropertyChangeListener(this.handleDataModelPropertyChange,this),this.dataModel.addDataPropertyChangeListener(this.handleDataPropertyChange,this),this.dataModel.sm().ms(this.handleSelectionChange,this),this.currentView.addInteractorPropertyChangeListener(this.handleGraphViewInteractorChange,this),this.g3d=this.currentView.g3d):(this.dataModel=null,this.currentView=null,this.g3d=null),this.updateInspector()},H.prototype.getDataInspector=function(i){return i instanceof ht.Shape?this.htShapeInspector:i instanceof ht.Edge?this.htEdgeInspector:i instanceof ht.Group?this.htGroupInspector:i instanceof ht.Text?this.htTextInspector:i instanceof ht.RefGraph?this.htRefGraphInspector:i instanceof ht.Block?this.htBlockInspector:i instanceof ht.Node?this.htNodeInspector:this.htDataInspector},H.prototype.getCompInspector=function(i){if(i instanceof _R)return this.clipInspector;if(i instanceof xR)return this.restoreInspector;if(i instanceof FR)return this.basicInspector;if(i instanceof FM)return this.borderInspector;if(i instanceof BR)return this.imageInspector;if(i instanceof wM)return this.pieChartInspector;if(i instanceof BM){var H=$i(i.s("chart.series"));return H&&H.length<=1&&H[0].colors?this.oneDimensionalColumnChartInspector:this.columnChartInspector}return i instanceof EM?this.lineChartInspector:i instanceof wR?this.shapeInspector:i instanceof ER?this.textInspector:i instanceof vM?this.funcTypeInspector:i instanceof aM?this.compTypeInspector:null},H.prototype.updateInspector=function(){if(this.dataModel){var i=this.dataModel.sm().ld();i?this.currentView instanceof xM?this.inspector=this.getCompInspector(i):this.currentView instanceof nM?this.inspector=this.getDataInspector(i):this.currentView instanceof KR.SceneView&&(this.inspector=this.getData3dInspector(i)):this.currentView instanceof xM?this.inspector=this.symbolInspector:this.currentView instanceof nM?this.inspector=this.displayInspector:this.currentView instanceof KR.SceneView&&(this.inspector=this.sceneInspector)}else this.inspector=null},zR(H,[{key:"basicInspector",get:function(){return this._basicInspector||(this._basicInspector=new FI(this.editor,"basic")),this._basicInspector}},{key:"borderInspector",get:function(){return this._borderInspector||(this._borderInspector=new BI(this.editor,"border")),this._borderInspector}},{key:"clipInspector",get:function(){return this._clipInspector||(this._clipInspector=new lI(this.editor,"clip")),this._clipInspector}},{key:"restoreInspector",get:function(){return this._restoreInspector||(this._restoreInspector=new VI(this.editor,"restore")),this._restoreInspector}},{key:"imageInspector",get:function(){return this._imageInspector||(this._imageInspector=new wI(this.editor,"image")),this._imageInspector}},{key:"pieChartInspector",get:function(){return this._pieChartInspector||(this._pieChartInspector=new _I(this.editor,"pieChart")),this._pieChartInspector}},{key:"oneDimensionalColumnChartInspector",get:function(){return this._oneDimensionalColumnChartInspector||(this._oneDimensionalColumnChartInspector=new xI(this.editor,"oneDimensionalColumnChartInspector")),this._oneDimensionalColumnChartInspector}},{key:"columnChartInspector",get:function(){return this._columnChartInspector||(this._columnChartInspector=new YI(this.editor,"columnChart")),this._columnChartInspector}},{key:"lineChartInspector",get:function(){return this._lineChartInspector||(this._lineChartInspector=new rI(this.editor,"lineChart")),this._lineChartInspector}},{key:"shapeInspector",get:function(){return this._shapeInspector||(this._shapeInspector=new eI(this.editor,"shape")),this._shapeInspector}},{key:"textInspector",get:function(){return this._textInspector||(this._textInspector=new sI(this.editor,"text")),this._textInspector}},{key:"funcTypeInspector",get:function(){return this._funcTypeInspector||(this._funcTypeInspector=new WI(this.editor,"func")),this._funcTypeInspector}},{key:"compTypeInspector",get:function(){return this._compTypeInspector||(this._compTypeInspector=new $I(this.editor,"comp")),this._compTypeInspector}},{key:"htShapeInspector",get:function(){return this._htShapeInspector||(this._htShapeInspector=new kI(this.editor,"Shape")),this._htShapeInspector}},{key:"htBlockInspector",get:function(){return this._htBlockInspector||(this._htBlockInspector=new PI(this.editor,"Block")),this._htBlockInspector}},{key:"htRefGraphInspector",get:function(){return this._htRefGraphInspector||(this._htRefGraphInspector=new ZI(this.editor,"RefGraph")),this._htRefGraphInspector}},{key:"htGroupInspector",get:function(){return this._htGroupInspector||(this._htGroupInspector=new GI(this.editor,"Group")),this._htGroupInspector}},{key:"htEdgeInspector",get:function(){return this._htEdgeInspector||(this._htEdgeInspector=new nI(this.editor,"Edge")),this._htEdgeInspector}},{key:"htNodeInspector",get:function(){return this._htNodeInspector||(this._htNodeInspector=new NI(this.editor,"Node")),this._htNodeInspector}},{key:"htTextInspector",get:function(){return this._htTextInspector||(this._htTextInspector=new vI(this.editor,"Text")),this._htTextInspector}},{key:"htDataInspector",get:function(){return this._htDataInspector||(this._htDataInspector=new cI(this.editor,"Data")),this._htDataInspector}},{key:"displayInspector",get:function(){return this._displayInspector||(this._displayInspector=new oI(this.editor,"display")),this._displayInspector}},{key:"symbolInspector",get:function(){return this._symbolInspector||(this._symbolInspector=new OI(this.editor,"symbol")),this._symbolInspector}},{key:"inspector",get:function(){return this.getCenterView()},set:function(i){var H=this.getCenterView();i?(i.currentView=this.currentView,i.dataModel=this.dataModel,this.dataModel&&(i.data=this.dataModel.sm().ld()),i.g3d=this.g3d,this.getCenterView()!==i&&this.setCenterView(i),i.filterPropertiesLater()):this.setCenterView(null),i===H||null==i&&null==H||(this.editor.fireEvent("inspectorUpdated",{inspector:i,oldInspector:H}),H&&(H.g3d=void 0,H.currentView=void 0,H.dataModel=void 0))}}]),H}(jR),gI=function(){function i(H){hR(this,i),this.editor=H}return i.prototype.showTip=function(i,H){this.tip.innerHTML=i,this.tip.parentNode!==document.body&&ht.Default.appendToScreen(this.tip);var R=G(H);this.tip.style.left=R.x+15+"px",this.tip.style.top=R.y+"px"},i.prototype.hideTip=function(){Y(this.tip)},i.prototype.clearDropView=function(i,H){this._dropView&&(this._dropView.handleCrossDrag(i,"exit",H),this._dropView=null)},i.prototype.crossDrag=function(i,H){var R=this._dropView,M=this.$94$(i,H);R!==M?(R&&R.handleCrossDrag(i,"exit",H),M&&M.handleCrossDrag(i,"enter",H)):M&&M.handleCrossDrag(i,"over",H),this._dropView=M},i.prototype.crossDrop=function(i,H){this._dropView&&(this._dropView.handleCrossDrag(i,"drop",H),this._dropView=null)},i.prototype.crossCancel=function(i,H){this._dropView&&(this._dropView.handleCrossDrag(i,"cancel",H),this._dropView=null)},i.prototype.$94$=function(i,H){for(var R=n(i);R&&(!R._ht||!R._ht.isDroppable||H&&!R._ht.isDroppable(i,H));)R=R.parentNode;return R?R._ht:null},zR(i,[{key:"tip",get:function(){if(!this._tip){this._tip=V(),this._tip.className="ht-editor-dnd-tip";var i=this._tip.style;i.whiteSpace="nowrap",i.color=KR.config.color_light,i.background=KR.config.color_transparent,i.font=ht.Default.labelFont,i.padding="4px",i.borderRadius="4px",i.position="absolute",i.zIndex=1e4}return this._tip}}]),i}(),SI=function(){function i(H,R){hR(this,i),this.editor=H,this.dnd=H.dnd,this._dragInfo={view:this},R&&(R.addEventListener("dragenter",this.handle_dragenter.bind(this),!1),R.addEventListener("dragover",this.handle_dragover.bind(this),!1),R.addEventListener("dragleave",this.handle_dragleave.bind(this),!1),R.addEventListener("drop",this.handle_drop.bind(this),!1),R.addEventListener("dragexit",this.handle_dragexit.bind(this),!1),R.addEventListener("dragend",this.handle_dragend.bind(this),!1)),this.isDroppableToDisplayView=!0,this.isDroppableToSymbolView=!0,this.isDroppableToSceneView=!0}return i.prototype.handle_dragenter=function(i){Ri(i),i.stopPropagation(),this.dnd.crossDrag(i,this._dragInfo)},i.prototype.handle_dragover=function(i){Ri(i),i.stopPropagation(),this.dnd.crossDrag(i,this._dragInfo)},i.prototype.handle_dragleave=function(i){Ri(i),i.stopPropagation(),this.dnd.crossCancel(i,this._dragInfo)},i.prototype.handle_dragexit=function(i){Ri(i),i.stopPropagation(),this.dnd.crossCancel(i,this._dragInfo)},i.prototype.handle_dragend=function(i){Ri(i),i.stopPropagation(),this.dnd.crossCancel(i,this._dragInfo)},i.prototype.handle_drop=function(i){Ri(i),i.stopPropagation(),this.dnd.crossDrop(i,this._dragInfo)},i}(),LI=function(i){function H(R){hR(this,H);var M=CR(this,i.call(this));return M.editor=R,M}return dR(H,i),H.prototype.init=function(){var i=this,H=this.contentDiv=ht.Default.createDiv();H.style.lineHeight="28px",H.style.textAlign="center",H.style.fontSize="14px",H.style.color=ht.Default.labelColor,this.setConfig({closable:!0,draggable:!0,width:320,height:120,content:H,buttons:[{label:p("editor.yes"),action:function(){i.onYes&&i.onYes(),i.hide()}},{label:p("editor.no"),action:function(){i.onNo&&i.onNo(),i.hide()}},{label:p("editor.cancel"),action:function(){i.hide()}}]}),this._init=!0},H.prototype.show=function(){var H=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p("editor.tooltip"),R=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",M=arguments[2],I=arguments[3];this._init||this.init(),this.setTitle(H),this.contentDiv.innerHTML=R,this.onYes=M,this.onNo=I,i.prototype.show.call(this,this.editor.$38$)},H}(yR),uI=function(i){function H(R){hR(this,H);var M=CR(this,i.call(this));return M.editor=R,M.editable=!0,M}return dR(H,i),H.prototype.init=function(){var i=this;this.$72$(),this.$70$();var H=new WR(this.funcPane,this.inspectorPane,"h",.5);this.setConfig({title:p("editor.layoutattach"),closable:!0,draggable:!0,width:KR.config.attachPointsViewSize.width,height:KR.config.attachPointsViewSize.height,resizeMode:"wh",maximizable:!0,content:H,buttons:[{label:p("editor.ok"),action:function(){i.ok()}},{label:p("editor.cancel"),action:function(){i.hide()}}],buttonsAlign:"right"})},H.prototype.$72$=function(){this.funcPane=new gM({argList:[["ht.Node","host","editor.comment.symbollayouthost"]]})},H.prototype.$73$=function(i,H,R,M){return{name:i,tag:i,accessType:"attr",width:R,displayName:H,align:"center",enum:M,editable:!0}},H.prototype.$70$=function(){var i=this;this.inspectorPane=new bR,this.tableModel=new ht.DataModel,this.tablePane=new $R(this.tableModel),this.tableView=this.tablePane.getTableView(),this.tableView.setEditable(!0),this.tableView.isEditable=function(){return i.editable},this.tablePane.getView().style.border=KR.config.color_line+" solid 1px",this.tablePane.addColumns([this.$73$("attr",p("editor.property"),90),this.$73$("valueType",p("editor.valuetype"),80,{values:KR.consts.valueTypes,labels:KR.consts.valueTypeLabels}),this.$73$("defaultValue",p("editor.defaultvalue"),90),this.$73$("name",p("editor.name"),80),this.$73$("group",p("editor.group"),80),this.$73$("description",p("editor.description"),120),this.$73$("extraInfo",p("editor.extrainfo"),100)]),this.$74$(),this.initExtraInfoColumn(),this.inspectorPane.addRow([this.tablePane],[.1],.1),this.inspectorPane.addRow([{button:{toolTip:p("editor.add"),icon:"editor.add",onClicked:function(){i.editable&&i.addProperties({attr:"layout."},!0)}}},{button:{toolTip:p("editor.delete"),icon:"editor.delete",onClicked:function(){i.editable&&i.tableView.removeSelection()}}},null,{button:{icon:"editor.top",toolTip:p("editor.bringtofront"),onClicked:function(){i.editable&&i.tableView.sm().size()&&i.tableModel.moveSelectionToTop()}}},{button:{icon:"editor.up",toolTip:p("editor.bringforward"),onClicked:function(){i.editable&&i.tableView.sm().size()&&i.tableModel.moveSelectionUp()}}},{button:{icon:"editor.down",toolTip:p("editor.sendbackward"),onClicked:function(){i.editable&&i.tableView.sm().size()&&i.tableModel.moveSelectionDown()}}},{button:{icon:"editor.bottom",toolTip:p("editor.sendtoback"),onClicked:function(){i.editable&&i.tableView.sm().size()&&i.tableModel.moveSelectionToBottom()}}}],[20,20,.1,20,20,20,20])},H.prototype.$74$=function(){var i=this,H=this.tableView.getColumnModel().getDataByTag("defaultValue");H.getValue=function(i,H,R){var M=i.a("defaultValue");return"Angle"===i.a("valueType")&&M&&(M=M/Math.PI*180),M},H.setValue=function(i,H,R,M){"Angle"===i.a("valueType")&&(R=R*Math.PI/180),i.a("defaultValue",R)},H.getEnumValues=function(i){var H=i?KR.config.valueTypes[i.a("valueType")]:null;return H&&"enum"===H.type?H.values:null},H.getEnumLabels=function(i){var H=i?KR.config.valueTypes[i.a("valueType")]:null;return H&&"enum"===H.type?H.labels:null},H.getEnumIcons=function(i){var H=i?KR.config.valueTypes[i.a("valueType")]:null;return H&&"enum"===H.type?H.icons:null},H.getEnumDropDownWidth=function(i){var H=i?KR.config.valueTypes[i.a("valueType")]:null;return H&&"enum"===H.type?H.dropDownWidth:null},H.getValueType=function(i){var H=i?KR.config.valueTypes[i.a("valueType")]:null;return H?H.type:null},H.isCellEditable=function(H,R,M,I){var h=H?KR.config.valueTypes[H.a("valueType")]:null,z=h?h.type:null,d=H.a("extraInfo"),C=KR.config.handleDefaultVauleColumnEdit,y=function(i){H.a("defaultValue",i)};if(C&&C(y,h,z,d))return!1;if("function"===z){var b=p("editor.function")+" "+(H.a("property")||"");return i.editor.functionView.open(H.a("defaultValue"),y,b,d&&d.arguments),!1}if("multiline"===z)return i.editor.textView.open(H.a("defaultValue"),y,H.a("property")||"&nbsp;"),!1;if("font"===z)return i.editor.fontView.open(H.a("defaultValue"),y,H.a("property")||"&nbsp;"),!1;if("object"===z||"custom"===z||"stringArray"===z||"objectArray"===z||"numberArray"===z||"colorArray"===z){var U=p("editor.object")+" "+(H.a("property")||"");return i.editor.objectView.open(H.a("defaultValue"),y,U,null,"object"===z&&d&&d.objectProperties),!1}return!0}},H.prototype.initExtraInfoColumn=function(){var i=this;this.tableView.getColumnModel().getDataByTag("extraInfo").isCellEditable=function(H,R,M,I){var h=p("editor.extrainfo")+" "+(H.a("property")||"");return i.editor.objectView.open(H.a("extraInfo"),function(i){H.a("extraInfo",i)},h),!1}},H.prototype.addProperties=function(i,H){var R=this,M=i.attr,I=i.valueType,p=i.defaultValue,h=i.name,z=i.description,d=i.extraInfo,C=new ht.Data;C.a({attr:M||"",valueType:I||"String",defaultValue:p,name:h,description:z,extraInfo:d}),this.tableModel.add(C),this.tableModel.sm().ss(C),H&&setTimeout(function(){R.tableView.tx(0),OH(R.tableView,C,R.tableView.getColumnModel().getDataByTag("attr"),M)},100)},H.prototype.update=function(i,H){var R=this;this.funcPane.setFunctionValue(i),this.tableModel.clear(),H&&H.forEach(function(i){R.addProperties(i)})},H.prototype.open=function(i,H,R){this._init||this.init(),this.setValue=R,this.update(i,H),this.show(this.editor.$38$)},H.prototype.ok=function(){var i=this.setValue,H={func:this.funcPane.getFunctionValue()};this.tableModel.size()&&(H.properties=[],this.tableModel.each(function(i){H.properties.push(M(i.getAttrObject()))})),i(H),this.hide()},H}(yR),ip=function(){function i(H){hR(this,i),this.editor=H,this.editing3d=!1,this.reset()}return i.prototype.reset=function(){this.points=[],this.segments=[],this.isBreak=!1,this.nextPoint=null,this.closePath=!1,this.preCtrl=null,this.nextPoint=null,this.drawPoint=null,this.downPoint=null,this.shape=null},i.prototype.setShape=function(i){this.shape=i},i.prototype.setPoint=function(i,H){this.points[i]=H},i.prototype.setSegment=function(i,H){this.segments[i]=H},i.prototype.setEditing3d=function(i){this.editing3d=i},i.prototype.isEditing3d=function(){return this.editing3d},i}(),Hp=function(){function i(H){var R=this;hR(this,i),this.params=H||{},this.$38$=this.params.$38$,this._eventNotifier=new ht.Notifier;var M=ht.Default.getClass(KR.config.serviceClass)||LR;this.$39$=new M(function(i){R.handleServiceEvent(i),R.fireEvent(i.type,i)},this),this.emptyFunc=function(){}}return i.prototype.addEventListener=function(i,H,R){this._eventNotifier.add(i,H,R)},i.prototype.removeEventListener=function(i,H){this._eventNotifier.remove(i,H)},i.prototype.fireViewEvent=function(i,H,R){var M=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];R=R||{},i.sceneView?(M&&(H="sceneView"+H),R.sceneView=i.sceneView):"symbol"===i.type?(M&&(H="symbolView"+H),R.symbolView=i):"display"===i.type?(M&&(H="displayView"+H),R.displayView=i):"scene"===i.type&&(M&&(H="sceneView"+H),R.sceneView=i),this.fireEvent(H,R)},i.prototype.fireEvent=function(i,H){H=H||{},KR.config.handleEvent&&KR.config.handleEvent(this,i,H);var R="on"+i.charAt(0).toUpperCase()+i.slice(1);KR.config[R]&&KR.config[R](this,H),this.params&&this.params[R]&&this.params[R](this,H),this._eventNotifier.fire({editor:this,type:i,params:H})},i.prototype.handleServiceEvent=function(i){if("connected"===i.type)this.init&&(this.init(),this.init=null);else if("fileChanged"===i.type){var H=i.path;this.updateUIRefs(H);var R=v(H),M=this.getFileNode(H);M&&(R=v(M.getFileUUID())||R),R&&this.$99$(H),Mi(H)?this.requestDisplays():Ii(H)?this.requestSymbols():pi(H)?this.requestComponents():hi(H)?this.requestScenes():zi(H)?this.requestModels():di(H)?this.requestUIs():Ci(H)&&this.requestAssets()}else"download"===i.type?this.downloadFile(i.path):"confirm"===i.type&&this.requestImport(i.path)},i.prototype.init=function(){this._inspectorCompact=!y(KR.config.compactFilter),this.menus=[],this.cloneInfo={type:null,funcArray:[],jsonArray:[]},this.shapeHelper=new ip(this),this.initSID(),this.$6$(),this.requestDisplays(),this.requestSymbols(),this.requestComponents(),this.requestScenes(),this.requestModels(),this.requestUIs(),this.requestAssets(),this.$38$&&this.$38$.addEventListener("keydown",this.handleKeydown.bind(this),!1),this.dnd=new gI(this),this.dndFromOutside=new SI(this,this.mainPane.getView()),this.fireEvent("editorCreated"),this.fireEvent("mainMenuCreated"),this.fireEvent("mainToolbarCreated"),this.fireEvent("rightToolbarCreated");var i=this.params.open||R("hteditor");if(i){var H=KR.config.paramHandlers[i];if(H&&!H(this))return;bi(i)?this._pendingOpenJSON=i:"newdisplay"===i?this.newDisplayView():"newsymbol"===i?this.newSymbolView():"newcomponent"===i&&this.newComponent()}},i.prototype.$6$=function(){this.mainTabView=new jM(this),this.funcView=new HI(this),this.eventView=new RI(this),this.functionView=new MI(this),this.objectView=new II(this),this.textView=new pI(this),this.fontView=new zI(this),this.iconsView=new yI(this),
this.componentView=new LM(this),this.messageView=new bI(this),this.confirmView=new LI(this),this.attachPointsView=new UI(this),this.symbolLayoutView=new uI(this),this.$7$(),this.$8$(),this.$10$(),this.$9$(),this.leftSplitView=new WR(this.leftTopTabView,this.mainTabView,"h",KR.config.leftSplitViewPosition),this.rightSplitView=new WR(this.rightTopBorderPane,this.rightBottomTabView,"v",KR.config.rightSplitViewPosition),this.mainSplitView=new WR(this.leftSplitView,this.rightSplitView,"h",KR.config.mainSplitViewPosition),this.mainPane=new jR,this.mainPane.setTopView(this.topBorderPane),this.mainPane.setCenterView(this.mainSplitView),zH(this.mainPane,this.$38$),this.mainPane.validateImpl()},i.prototype.initSID=function(){var i=window.location.href.match("sid=([0-9a-z-]*)");i&&(this.sid=i[1])},i.prototype.$7$=function(){var i=this;this.mainToolbar=new VM(this),this.rightToolbar=new AM(this),this.topBorderPane=new jR,this.topBorderPane.setCenterView(this.mainToolbar),this.topBorderPane.setRightView(this.rightToolbar),this.topBorderPane.setHeight(28),this.rightToolbar.onSumWidthChanged=function(){i.topBorderPane.setRightWidth(i.rightToolbar.getSumWidth())}},i.prototype.$8$=function(){this.displays=new yM(this,KR.config.displaysEditable),this.symbols=new bM(this,KR.config.symbolsEditable),this.components=new UM(this,KR.config.componentsEditable),this.scenes=new KM(this,KR.config.scenesEditable),this.models=new qM(this,KR.config.modelsEditable),this.uis=new QM(this,KR.config.uisEditable),this.assets=new mM(this,KR.config.assetsEditable),this.leftTopTabView=new lR,this.scenesTab=this.leftTopTabView.add(p("editor.scenes"),this.scenes,!1,KR.config.scenesVisible),this.displaysTab=this.leftTopTabView.add(p("editor.displays"),this.displays,!1,KR.config.displaysVisible),this.symbolsTab=this.leftTopTabView.add(p("editor.symbols"),this.symbols,!1,KR.config.symbolsVisible),this.componentsTab=this.leftTopTabView.add(p("editor.components"),this.components,!1,KR.config.componentsVisible),this.modelsTab=this.leftTopTabView.add(p("editor.models"),this.models,!1,KR.config.modelsVisible),this.uisTab=this.leftTopTabView.add(p("editor.uis"),this.uis,!1,KR.config.uisVisible),this.assetsTab=this.leftTopTabView.add(p("editor.assets"),this.assets,!1,KR.config.assetsVisible),this.leftTopTabView.select(KR.config.scenesVisible?this.scenesTab:this.displaysTab)},i.prototype.$9$=function(){this.inspectorTool=new YM(this),this.inspectorPane=new AI(this),this.rightTopBorderPane=new jR,this.rightTopBorderPane.setTopView(this.inspectorTool),this.rightTopBorderPane.setCenterView(this.inspectorPane),this.rightTopBorderPane.setTopHeight(ht.Default.widgetHeaderHeight+6)},i.prototype.$10$=function(){var i=this;this.listPane=new eM(this),this.layerPane=new sM(this),this.overview=new XM(this),this.dataView=new rM(this),this.symbolStatePane=new $M(this),KR.BatchView&&(this.batchView=new KR.BatchView(this));var H=this.rightBottomTabView=new lR;this.listPaneTab=this.rightBottomTabView.add(p("editor.list"),this.listPane,!0),KR.config.layerEnabled&&(this.layerTab=this.rightBottomTabView.add(p("editor.layer"),this.layerPane,!1,!1)),KR.config.symbolStateEnabled&&(this.symbolStateTab=this.rightBottomTabView.add(p("editor.state"),this.symbolStatePane,!1,!1)),KR.config.overviewEnabled&&(this.overviewTab=this.rightBottomTabView.add(p("editor.overview"),this.overview)),KR.config.batchViewEnabled&&KR.BatchView&&(this.batchViewTab=this.rightBottomTabView.add(p("editor.batch"),this.batchView)),KR.config.dataViewEnabled&&(this.dataViewTab=this.rightBottomTabView.add(p("editor.data"),this.dataView));var R=this.rightBottomTabView.getTabModel().sm();R.ms(function(){var H=R.ld();H&&(i.dataView.visible=H.getView()===i.dataView,i.overview.setAutoUpdate(H.getView()===i.overview))}),H.getLabel=function(H){var R=H.toLabel();if(H===i.symbolStateTab){var M=i.symbolStatePane.tableModel.sm().ld();if(M){var I=M.a("stateDisplayName")||M.a("stateName");return R+(I?" - "+I:"")}}return R}},i.prototype.newFolder=function(i){var H=this,R=this.explorer;if(R){var M=i.sm().ld();i!==i.explorer.list||M&&M.fileType===XR||(M=i.explorer.tree.sm().ld()),M&&!R.isAccordionMode()||(M=i.explorer.rootNode);iH(p("editor.inputnewfoldername"),"",{nullable:!1,trim:!0,maxLength:KR.config.maxFileNameLength,checkFunc:KR.config.checkFileName,$38$:this.$38$},function(i,I){if("ok"===I){var h=(M?M.url:R.rootDir)+"/"+i;if(H.getFileNode(h))return void HH(p("editor.filenameconflict"),h,function(){});H.request("mkdir",KR.config.vision?{dir:h,parent_uuid:M.uuid,root_dir:M.rootDir}:h,function(i){})}})}},i.prototype.getFileNode=function(i){for(var H=this.leftTopTabView.getTabModel().getDatas(),R=0;R<H.size();R++){var M=H.get(R);if(M.getView()instanceof CM){var I=M.getView().findFileNode(i);if(I)return I}}return null},i.prototype.selectFileNode=function(i){for(var H=this,R=this.leftTopTabView.getTabModel().getDatas(),M=0;M<R.size();M++){var I=R.get(M);if(I.isVisible()&&I.getView()instanceof CM){var p=function(){var R=I.getView(),M=R.findFileNode(i);if(M)return H.leftTopTabView.getTabModel().sm().ss(I),R.isAccordionMode()?(M.fileType===XR?R.accordion.sm().ss(M):(M.getParent().expanded=!0,R.accordion.sm().ss(M)),R.accordion.ivm()):M.fileType===XR?(R.tree.sm().ss(M),setTimeout(function(){R.tree.makeVisible(M)},500)):(R.tree.sm().ss(M.getParent()),R.list.sm().ss(M),setTimeout(function(){R.tree.makeVisible(M.getParent()),R.list.makeVisible(M)},500)),delete H._pendingSelectURL,{v:void 0}}();if("object"==typeof p)return p.v}}this._pendingSelectURL=i},i.prototype.makeFileNodeVisible=function(i){for(var H=this.leftTopTabView.getTabModel().getDatas(),R=0;R<H.size();R++){var M=H.get(R),I=M.getView();if(I instanceof CM){var p=I.findFileNode(i);if(p){var h=p.getParent();I.tree.sm().ss(h),I.tree.makeVisible(h),I.list.makeVisible(p)}}}},i.prototype.renameFile=function(i,H,R){var I=this;if(!i||i.$33$||!1===i.a("editable")||!H)return!1;var h=H;bi(i.getName())&&!bi(H)&&(H+=".json");var z=i.path+"/"+H;if(!(H=KR.config.checkFileName(H,z)))return HH(p("editor.invalidinput"),h,function(){}),!1;if(H.length>KR.config.maxFileNameLength+5)return HH(p("editor.inputmax"),H,function(){}),!1;if(i.getName()===H)return!1;if(this.getFileNode(z))return HH(p("editor.filenameconflict"),z,function(){}),!1;i.$33$=z;var d={old:i.url,new:i.$33$,fileType:i.fileType};bi(d.old)&&this.request("rename",{old:ci(d.old),new:ci(d.new),fileType:oR},function(i){}),this.request("rename",d,function(p){if(p){I.mainTabView.getTabModel().each(function(R){if(R.getTag()===i.url){R.setTag(i.$33$);R.getView().url=i.$33$,R.setName(B(H))}}),R();var h=M(d);return h.data=i,I.fireEvent("fileRenamed",h),!0}return delete i.$33$,!1})},i.prototype.moveFile=function(i,H){if(i&&!1!==i.a("editable")&&H&&!i.$33$&&!H.$33$){var R={data:i,url:i.url,parent:H};if(this.fireEvent("fileMoving",R),!R.preventDefault){var M=i.getParent();if(i.setParent(H),M!==i.getParent()){i.$33$=H.url+"/"+i.getName();var I={old:i.url,new:i.$33$};bi(I.old)&&this.request("rename",{old:ci(I.old),new:ci(I.new)},function(i){}),this.request("rename",I,function(i){})}}}},i.prototype.removeFiles=function(i){var H=this;i.forEach(function(i){if(!i.$33$&&!1!==i.a("editable")){var R=i.url||i;bi(R)&&H.request("remove",KR.config.vision?{path:ci(R),uuid:i.uuid,root_dir:i.rootDir}:ci(R),function(i){}),H.request("remove",KR.config.vision?{path:R,uuid:i.uuid,root_dir:i.rootDir}:R,function(M){H.fireEvent("fileDeleted",{data:i,url:R})})}})},i.prototype.requestBase64=function(i,H){this.request("source",{url:i,encoding:"base64",prefix:"data:;base64,"},H)},i.prototype.request=function(i,H,R,M){var I=this;R=R||this.emptyFunc,M?setTimeout(function(){I.$39$.request(i,H,R)},M):this.$39$.request(i,H,R)},i.prototype.requestDisplays=function(){var i=this;this._requestingDisplays||(this.request("explore","/displays",function(H){i._requestingDisplays=!1,i.displays.parse(H),i._pendingOpenJSON&&Mi(i._pendingOpenJSON)&&(i.displays.findFileNode(i._pendingOpenJSON)?(i.open(i._pendingOpenJSON),i.selectFileNode(i._pendingOpenJSON)):KR.config.newIfFailToOpen&&(i.newDisplayView(),i.save(null,i._pendingOpenJSON)),delete i._pendingOpenJSON),i._pendingSelectURL&&Mi(i._pendingSelectURL)&&i.selectFileNode(i._pendingSelectURL)},KR.config.requestDelay),this._requestingDisplays=!0)},i.prototype.requestSymbols=function(){var i=this;this._requestingSymbols||(this.request("explore","/symbols",function(H){i._requestingSymbols=!1,i.symbols.parse(H),i._pendingOpenJSON&&Ii(i._pendingOpenJSON)&&(i.symbols.findFileNode(i._pendingOpenJSON)?(i.open(i._pendingOpenJSON),i.selectFileNode(i._pendingOpenJSON)):KR.config.newIfFailToOpen&&(i.newSymbolView(),i.save(null,i._pendingOpenJSON)),delete i._pendingOpenJSON),i._pendingSelectURL&&Ii(i._pendingSelectURL)&&i.selectFileNode(i._pendingSelectURL)},KR.config.requestDelay),this._requestingSymbols=!0)},i.prototype.requestComponents=function(){var i=this;this._requestingComponents||(this.request("explore","/components",function(H){i._requestingComponents=!1,i.components.parse(H),i._pendingOpenJSON&&pi(i._pendingOpenJSON)&&(i.components.findFileNode(i._pendingOpenJSON)?i.open(i._pendingOpenJSON):KR.config.newIfFailToOpen&&i.newComponent(),delete i._pendingOpenJSON),i._pendingSelectURL&&pi(i._pendingSelectURL)&&i.selectFileNode(i._pendingSelectURL)},KR.config.requestDelay),this._requestingComponents=!0)},i.prototype.requestScenes=function(){var i=this;KR.config.scenesVisible&&(this._requestingScenes||(this.request("explore","/scenes",function(H){i._requestingScenes=!1,i.scenes.parse(H),i._pendingOpenJSON&&hi(i._pendingOpenJSON)&&(i.scenes.findFileNode(i._pendingOpenJSON)?(i.open(i._pendingOpenJSON),i.selectFileNode(i._pendingOpenJSON)):KR.config.newIfFailToOpen&&(i.newSceneView(),i.save(null,i._pendingOpenJSON)),delete i._pendingOpenJSON),i._pendingSelectURL&&hi(i._pendingSelectURL)&&i.selectFileNode(i._pendingSelectURL)},KR.config.requestDelay),this._requestingScenes=!0))},i.prototype.requestModels=function(){var i=this;this._requestingModels||(this.request("explore","/models",function(H){i._requestingModels=!1,i.models.parse(H),i._pendingOpenJSON&&zi(i._pendingOpenJSON)&&(i.open(i._pendingOpenJSON),delete i._pendingOpenJSON),i._pendingSelectURL&&zi(i._pendingSelectURL)&&i.selectFileNode(i._pendingSelectURL)},KR.config.requestDelay),this._requestingModels=!0)},i.prototype.requestUIs=function(){var i=this;KR.config.uisVisible&&(this._requestingUIs||(this.request("explore","/uis",function(H){i._requestingUIs=!1,i.uis.parse(H),i._pendingOpenJSON&&di(i._pendingOpenJSON)&&(i.uis.findFileNode(i._pendingOpenJSON)?(i.open(i._pendingOpenJSON),i.selectFileNode(i._pendingOpenJSON)):KR.config.newIfFailToOpen&&(i.newUIView(),i.save(null,i._pendingOpenJSON))),i._pendingSelectURL&&di(i._pendingSelectURL)&&i.selectFileNode(i._pendingSelectURL)},KR.config.requestDelay),this._requestingUIs=!0))},i.prototype.requestAssets=function(){var i=this;this._requestingAssets||(this.request("explore","/assets",function(H){i._requestingAssets=!1,i.assets.parse(H),i._pendingOpenJSON&&Ci(i._pendingOpenJSON)&&(i.open(i._pendingOpenJSON),delete i._pendingOpenJSON),i._pendingSelectURL&&Ci(i._pendingSelectURL)&&i.selectFileNode(i._pendingSelectURL)},KR.config.requestDelay),this._requestingAssets=!0)},i.prototype.requestImport=function(i){var H=this;KR.config.importConfirm?HH("",p("editor.importconfirm"),function(){H.request("import",{path:i,move:!0})},function(){H.request("import",{path:i,move:!1})}):this.request("import",{path:i,move:!0})},i.prototype.downloadFile=function(i){try{var H=window.location.hostname,R=window.location.port,M=window.location.protocol+"//"+H+":"+R+"/"+i,I=document.createElement("iframe");I.src=M,I.style.display="none",document.body.appendChild(I)}catch(i){}},i.prototype.$5$=function(i){var H=this._currentTab,R=this.rightBottomTabView.getTabModel().sm();this._currentTab=i,this.inspectorPane.$5$(i),this.listPane.$5$(i),KR.config.overviewEnabled&&this.overview.$5$(i),KR.config.dataViewEnabled&&this.dataView.$5$(i),KR.config.layerEnabled&&this.layerPane.$5$(i),KR.config.symbolStateEnabled&&this.symbolStatePane.$5$(i),KR.config.batchViewEnabled&&KR.BatchView&&this.batchView.$5$(i),this.mainToolbar.$5$(i),this.rightToolbar.$5$(i),this.inspectorTool.$5$(i),KR.config.layerEnabled&&this.layerTab.setVisible(!!this.displayView||!!this.sceneView),KR.config.symbolStateEnabled&&this.symbolStateTab.setVisible(!!this.symbolView),KR.config.batchViewEnabled&&KR.BatchView&&this.batchViewTab.setVisible(!!this.sceneView),(!this.symbolView&&this.symbolStateTab&&R.co(this.symbolStateTab)||this.symbolView&&this.layerTab&&R.co(this.layerTab)||!this.sceneView&&this.batchViewTab&&R.co(this.batchViewTab)||!i&&(this.symbolStateTab&&R.co(this.symbolStateTab)||this.layerTab&&R.co(this.layerTab)||this.batchViewTab&&R.co(this.batchViewTab)||this.problemsTab&&R.co(this.problemsTab)))&&R.ss(this.listPaneTab),this.fireEvent("tabUpdated",{tab:i,oldTab:H})},i.prototype.updateInspectorPropertiesLater=function(){this.inspector&&this.inspector.$34$()},i.prototype.beginTransaction=function(){this.dm&&this.dm.beginTransaction()},i.prototype.endTransaction=function(){this.dm&&this.dm.endTransaction()},i.prototype.getCurrentEditingPointValue=function(i){var H=this.currentEditingPoint;return H?H[i]:0},i.prototype.setCurrentEditingPointValue=function(i,H){var R=this.gv;R&&R.getEditInteractor().getSubModule("Curve").setCurrentPoint(i,H)},i.prototype.$99$=function(i){this.mainTabView.$99$(i)},i.prototype.updateUIRefs=function(i){this.mainTabView.updateUIRefs(i)},i.prototype.getDragPoint=function(i){return this.dnd.$94$(i)instanceof ht.graph3d.Graph3dView?this.sceneView.lp(i):this.gv.lp(i)},i.prototype.dropLocalFileOnView=function(i){if(this.currentView){var H={event:i};if(this.fireViewEvent(this.currentView,"OutsideDropping",H),!H.preventDefault)for(var R=i.dataTransfer.files,M=0;M<R.length;M++){var I=R[M],p=I.name;yi(p)?this.insertLocalImageFile(i,I):bi(p)&&this.insertLocalJSONFile(i,I)}}},i.prototype.insertLocalImageFile=function(i,H){var R=this;hH(H,function(M){if(R.sceneView){var I=new ht.Node;I.setAnchor3d(.5,0,.5),I.s({shape3d:"billboard","shape3d.image":M,autorotate:!0}),I.p(R.getDragPoint(i)),I.setDisplayName(E(H.name)),R.sceneView.addData(I)}else if(R.displayView){var p=new ht.Node;p.setImage(M),p.p(R.gv.lp(i)),p.setDisplayName(E(H.name)),R.displayView.addData(p)}else if(R.symbolView){var h=R.gv.lp(i),z=new BR({type:"image",name:M,rect:[h.x,h.y,-1,-1]});z.setDisplayName(E(H.name)),R.symbolView.addData(z)}},!0)},i.prototype.insertLocalJSONFile=function(i,H){var R=this;hH(H,function(i){R.$97$(i)})},i.prototype.$97$=function(i){var H=this;if(i){this.beginTransaction(),i=w(i);var R=this.sceneView||this.displayView;if(R&&fi(i.d)){var M=this.gv,I=M.dm().deserialize(i,M.getCurrentSubGraph(),{justDatas:!0});M.sm().ss(I.toList(M.isSelectable,M)),I.each(function(i){R.addData(i,!0,!0)})}else this.symbolView&&fi(i.comps)&&i.comps.forEach(function(i){WH(i,H.symbolView)});this.gv.setFocus(),this.endTransaction()}},i.prototype.dropLocalFileOnDir=function(i,H){for(var R=i.dataTransfer.files,M=H.url,I=0;I<R.length;I++){var h=R[I].name;if(!KR.config.checkFileName(h,M+"/"+h))return void HH(p("editor.invalidfilename"),h,function(){})}for(var z=0;z<R.length;z++)this.uploadLocalFile(R[z],M,H.uuid,H.rootDir)},i.prototype.uploadLocalFile=function(i,H,R,M){var I=this,p=KR.config.checkFileName(i.name,H+"/"+i.name);p&&hH(i,function(i){var h={path:H+"/"+p,content:i,parent_uuid:R,root_dir:M};I.request(KR.config.vision?"drag":"upload",h)},!0)},i.prototype.addTab=function(i,H){this.mainTabView.add(i),this.fireEvent("tabCreated",{tab:i}),H&&this.mainTabView.getTabModel().sm().ss(i),this.mainTabView.validate()},i.prototype.openByJSON=function(i,H,R,M,I){this.mainTabView.getTabModel();if(i===OR){var p=this.mainTabView.getTabModel().getDataByTag(H);p||(p=new ht.Tab,p.setTag(H),p.setIcon("editor.display"),p.setClosable(!0),p.setName(R),new nM(this,p,H,M),this.addTab(p)),this.mainTabView.getTabModel().sm().ss(p)}else if(i===JR){var h=this.mainTabView.getTabModel().getDataByTag(H);h||(h=new ht.Tab,h.setTag(H),h.setIcon("editor.symbol"),h.setClosable(!0),h.setName(R),new xM(this,h,H,M),this.addTab(h)),this.mainTabView.getTabModel().sm().ss(h)}else if(i===cR)this.componentView.update(H,I,R,M);else if(i===NR){var z=this.mainTabView.getTabModel().getDataByTag(H);z||(z=new ht.Tab,z._isUI=!0,z.setTag(H),z.setIcon("editor.ui-tab"),z.setClosable(!0),z.setName(R),new UIView(this,z,H,M),this.addTab(z)),this.mainTabView.getTabModel().sm().ss(z)}},i.prototype.isOpenable=function(i){return!KR.config.isOpenable||KR.config.isOpenable(i)},i.prototype.open=function(i,H,R){ti(i)&&(i=this.getFileNode(i)),i&&!i.$33$&&this.isOpenable(i)&&this.openFileNode(i,H,R)},i.prototype.openFileNode=function(i,H,R){var M=this;if(i.fileType===OR||i.fileType===JR||i.fileType===TR||i.fileType===NR)this.mainTabView.open(i);else if(i.fileType===cR)this.componentView.open(i);else if(i.fileType===tR)this.openModel&&this.openModel(i);else if(i.fileType===oR){var I=i.url,p=_(I),h=KR.config.fileOpeners[p];if(h&&!h(this,i,H,R))return;if(qi(I))r(I,function(R){var I=ht.Default.svgToShape(R,{segments:KR.config.svgSegments,minimumFontSize:KR.config.svgMinimumFontSize});setTimeout(function(){var R=I.output,p=I.converter;p._canvas&&(R.width=p._canvas.width,R.height=p._canvas.height);var h=B(i.getName());H?M.newSymbolView(h,!1):M.newDisplayView(h),R.comps.forEach(function(i){delete i.repeatImage}),M.beginTransaction();var z=KR.toDatas(R.comps,H);z.forEach(function(i){i&&M.currentView.addData(i,!0)}),H&&(R.width&&M.dm.a("width",R.width),R.height&&M.dm.a("height",R.height)),M.fireEvent("svgConverted",{editor:editor,toSymbol:H,comps:R.comps,datas:z,fileNode:i}),M.zoomToFit(),M.endTransaction()},KR.config.svgWaitingTime)});else if(Qi(I))r(I,function(R){var I=B(i.getName()),p=ht.Default.cadToShape(R,{boundingType:H?KR.config.cadToSymbolBoundingType:KR.config.cadToDisplayBoundingType,defaultColor:16777215}),h={},z=Object.keys(p.blockDef).length,d=function(){H?M.newSymbolView(I,!1):M.newDisplayView(I),M.beginTransaction(),M.currentView.dm.setBackground("#000000"),p.comps.forEach(function(i){"image"===i.type&&h[i.name]&&(i.name=h[i.name])});var R=KR.toDatas(p.comps,H);R.forEach(function(i){M.currentView.addData(i,!0)}),H&&(p.width&&M.dm.a("width",p.width),p.height&&M.dm.a("height",p.height)),M.fireEvent("dxfConverted",{editor:editor,toSymbol:H,comps:p.comps,datas:R,fileNode:i,result:p}),M.zoomToFit(),M.endTransaction()};z?function(){var H=function(){0===--z&&d()},R="symbols/"+i.path.substr("assets/".length)+"/"+I+"/";for(var C in p.blockDef){p.blockDef[C].comps.forEach(function(i){"image"===i.type&&(i.name=R+i.name+".json")});var y={path:h[C]=R+C+".json",content:F(p.blockDef[C]),root_dir:"symbols"};M.request("upload",y,H)}}():d()});else if(oi(I)||Ji(I)){if(!KR.FontConverterOptionView||!this.openFont)return;this.openFont(i)}}},i.prototype.$98$=function(i,H){var R=this;if(i){if(!this.tab)return void this.open(i);if(this.editable)if(i.fileType!==OR){if(this.url!==i.url)if(i.fileType!==cR)if(i.fileType===JR||yi(i.url)){if(this.displayView){var M=new ht.Node;if(M.setImage(i.getFileUUID()),H)M.p(H.x,H.y);else{var I=this.gv.getViewRect();I&&M.p(I.x+I.width/2,I.y+I.height/2)}M.setDisplayName(E(i.url)),this.displayView.addData(M)}else if(this.symbolView){var p=ht.Default.getImage(i.getFileUUID()),h=p?p.width:-1,z=p?p.height:-1,d=H?H.x:(this.dm.a("width")||0)/2,C=H?H.y:(this.dm.a("height")||0)/2,y=new BR({type:"image",name:i.getFileUUID(),rect:[d-(h>0?h/2:0),C-(z>0?z/2:0),h,z]});y.setDisplayName(E(i.url)),this.symbolView.addData(y)}else if(this.sceneView){var b=i.getFileUUID(),U=new ht.Node;if(U.setAnchor3d(.5,0,.5),U.s({shape3d:"billboard","shape3d.image":b,autorotate:!0}),U.a("image2d.url",b),H)U.p(H.x,H.y);else{var K=this.gv.getViewRect();K&&U.p(K.x+K.width/2,K.y+K.height/2)}U.setDisplayName(E(i.url)),this.sceneView.addData(U)}}else{if(i.fileType===TR)return void(this.displayView&&KR.config.handleInsertSceneFileToDisplayView&&KR.config.handleInsertSceneFileToDisplayView(this.displayView,i,H));if(i.fileType!==tR);else if(this.displayView)KR.config.handleInsertModelFileToDisplayView&&KR.config.handleInsertModelFileToDisplayView(this.displayView,i,H);else if(this.sceneView){var q=new ht.Node;if(q.setAnchor3d(.5,0,.5),q.s({shape3d:i.getFileUUID()}),H)q.p(H.x,H.y);else{var Q=this.gv.getViewRect();Q&&q.p(Q.x+Q.width/2,Q.y+Q.height/2)}q.setDisplayName(E(i.url)),this.sceneView.addData(q)}}else if(this.symbolView){var m=new aM({type:i.getFileUUID(),rect:[H?H.x:(this.dm.a("width")||0)/2,H?H.y:(this.dm.a("height")||0)/2,-1,-1]},void 0,void 0,!0);m.setDisplayName(E(i.url)),this.symbolView.addData(m)}}else if(this.displayView)if(KR.config.insertDisplayViewAsRefGraph){var X=new ht.RefGraph;X.setRef(i.getFileUUID()),X.onPendingUpdated=function(){X.onPendingUpdated=null,X.p(H)},X.setDisplayName(E(i.url)),this.displayView.addData(X)}else r(i.url,function(i){R.$97$(i,H)})}},i.prototype.newDisplayView=function(i){return this.mainTabView.newDisplayView(i)},i.prototype.newSymbolView=function(i,H){return this.mainTabView.newSymbolView(i,H)},i.prototype.newUIView=function(i){return this.mainTabView.newUIView(i)},i.prototype.newComponent=function(i){this.componentView.open(null,i)},i.prototype.isDebugTipShowing=function(){var i=this.g3d||this.gv;return i&&i.isDebugTipShowing()},i.prototype.toggleDebugTip=function(){var i=this.g3d||this.gv;i&&(i.isDebugTipShowing()?(i.hideDebugTip(),i.disableToolTip(),this.list.disableToolTip()):(i.showDebugTip(),i.enableToolTip(),this.list.enableToolTip()))},i.prototype.save=function(i,H){this.mainTabView.save(i,H)},i.prototype.saveAll=function(i){this.mainTabView.saveAll(i)},i.prototype.reload=function(){this.mainTabView.reload()},i.prototype.preview=function(){this.mainTabView.preview()},i.prototype.closeTab=function(i,H,R){this.mainTabView.closeTab(i,H,R)},i.prototype.closeOtherTabs=function(i,H){this.mainTabView.closeOtherTabs(i,H)},i.prototype.closeTabsToTheRight=function(i,H){this.mainTabView.closeTabsToTheRight(i,H)},i.prototype.closeAllTabs=function(i,H){this.mainTabView.closeAllTabs(i,H)},i.prototype.filterProperties=function(){this.inspector&&this.inspector.filterPropertiesLater()},i.prototype.isRulerEnabled=function(){return!!this.currentView&&this.currentView.isRulerEnabled()},i.prototype.setRulerEnabled=function(i){this.currentView&&this.currentView.setRulerEnabled(i)},i.prototype.toggleRulerEnabled=function(){this.setRulerEnabled(!this.isRulerEnabled())},i.prototype.isGridEnabled=function(){return!!this.currentView&&this.currentView.isGridEnabled()},i.prototype.setGridEnabled=function(i){this.currentView&&this.currentView.setGridEnabled(i)},i.prototype.toggleGridEnabled=function(){this.setGridEnabled(!this.isGridEnabled())},i.prototype.toggleLeft=function(){"normal"===this.leftSplitView.getStatus()?this.leftSplitView.setStatus("cl"):this.leftSplitView.setStatus("normal")},i.prototype.toggleRight=function(){if(this.currentView&&this.currentView.getPreferredSize){var i=this.currentView;i.isRightExpanded()?i.setRightExpanded(!1):i.setRightExpanded(!0)}else"normal"===this.mainSplitView.getStatus()?this.mainSplitView.setStatus("cr"):this.mainSplitView.setStatus("normal")},i.prototype.toggleBoth=function(){if("normal"===this.mainSplitView.getStatus()||"normal"===this.leftSplitView.getStatus())if(this.leftSplitView.setStatus("cl"),this.currentView&&this.currentView.getPreferredSize){var i=this.currentView;i.setRightExpanded(!1)}else this.mainSplitView.setStatus("cr");else if(this.leftSplitView.setStatus("normal"),this.currentView&&this.currentView.getPreferredSize){var i=this.currentView;i.setRightExpanded(!0)}else this.mainSplitView.setStatus("normal")},i.prototype.zoomIn=function(){this.gv&&this.gv.zoomIn(KR.config.animate)},i.prototype.zoomOut=function(){this.gv&&this.gv.zoomOut(KR.config.animate)},i.prototype.zoomReset=function(){this.gv&&this.gv.zoomReset(KR.config.animate)},i.prototype.zoomToFit=function(){this.gv&&this.gv.fitContent(KR.config.animate,KR.config.fitPadding)},i.prototype.fitSelection=function(){this.gv&&this.gv.fitSelection(KR.config.fitPadding,KR.config.animate)},i.prototype.delete=function(){this.gv&&this.gv.removeSelection()},i.prototype.copyFiles=function(){this.explorer.copyFiles()},i.prototype.pasteFiles=function(){this.explorer.pasteFiles()},i.prototype.copy=function(){var i=this;if(this.currentView&&"ui"===this.currentView.type)return void this.currentView.copy();if(this.ld){var H=this.cloneInfo;if(H.funcArray.length=0,H.jsonArray.length=0,H.offset={x:0,y:0,e:0},H.lastCheck=null,H.lastView=this.gv,H.sourceView=this.gv,this.displayView)H.type="display";else if(this.symbolView)H.type="symbol";else{if(!this.sceneView)return void(H.type=null);H.type="scene"}var R=0,M=void 0,I={};this.selection.forEach(function(H){if(!H._refGraph){I[H._id]=H,H instanceof ht.Block&&!(H instanceof ht.RefGraph)&&Hi(H,I);var p=TH(i.gv.dm(),H);R=Math.max(R,p),R===p&&(M=H)}}),H.lastData=M;var p=[],h=void 0;this.gv.each(function(i){I[i._id]&&(p.push(i),i instanceof ht.Node&&(h=h?ht.Default.unionRect(h,i.getRect()):i.getRect()))}),H.rect=h,this.gv.copyMap=I,p.forEach(function(R){var M=i.gv.isSelected(R),I=R.$50$(i.gv);if(0!==I.length){H.funcArray.push([R._id,M].concat(I));var p=eH(R);p&&H.jsonArray.push([M,p])}}),this.fireEvent("copy",{datas:p,info:H}),this.gv.copyMap=null}},i.prototype.hasCopyInfo=function(){return this.cloneInfo.funcArray.length>0},i.prototype.paste=function(i,H){var R=this;if(this.currentView&&"ui"===this.currentView.type)return void this.currentView.paste();if(this.editable){var M=this.gv,I=this.currentView,h=this.cloneInfo;if(h.funcArray.length&&M){var z=[],d=[];if(this.beginTransaction(),ht.Default.setIsolating(!0),"display"===h.type&&this.displayView||"display"===h.type&&this.sceneView||"symbol"===h.type&&this.symbolView||"scene"===h.type&&this.sceneView||"scene"===h.type&&this.displayView){var C={},y=[],b=[];h.funcArray.forEach(function(i){var H=i[0],p=i[1],h=i[2],U=i[3],K=void 0;h.clazz===ht.Points&&I!==R.sceneView?(h.clazz=ht.Node,K=U(h,M),h.clazz=ht.Points):K=U(h,M),I.addData(K,!0),C[H]=K,z.push(K),y.push(h),b.push(H),p&&d.push(K)});var U=this.ld;U&&(U=C[U.getId()])&&(d.splice(d.indexOf(U),1),d.push(U));for(var K=0;K<z.length;K++)z[K].$49$(y[K],M,C);if(KR.config.pasteToLastSelectedIndex&&h.sourceView===M)for(var q=M.dm(),Q=0,m=z.length;Q<m;Q++){var X=y[Q];if(!C[X.parent]){var o=q.getDataById(b[Q]),J=q.getSiblings(o).indexOf(o)+1;q.moveTo(z[Q],J)}}}else h.jsonArray.length&&h.jsonArray.forEach(function(i,H){var I=i[0],C=i[1],y=h.funcArray[H][2];if("symbol"===h.type&&!R.symbolView&&y.clazz===aM)return void R.showMessage(p("editor.componentsusederror"),"error");var b=sH(C,!!R.symbolView);b&&(b.setParent(M.getCurrentSubGraph()),R.currentView.addData(b,!0),z.push(b),I&&d.push(b))});ht.Default.setIsolating(!1);var O=KR.config.pasteOffset,c=0,t=0,T=0;if(Ti(O)?c=t=O:fi(O)?3===O.length?(c=O[0],T=O[1],t=O[2]):2===O.length&&(c=O[0],t=O[1]):O&&("x"in O&&(c=O.x),"y"in O&&(T=O.y),"z"in O&&(t=O.z)),d.length&&this.sm.ss(d),h.lastView!==M&&(h.offset.x=-c,h.offset.y=-t,h.offset.e=-T),!i&&z.length){var N=h.rect;if(H&&N?(h.offset.x=H.x-N.x-N.width/2,h.offset.y=H.y-N.y-N.height/2):(h.offset.x+=c,h.offset.y+=t),h.offset.e+=T,ht.Default.moveDatas(z,h.offset.x,h.offset.e,h.offset.y),!H&&!this.g3d){var D=M.$63$(z);D&&(h.offset.x+=D.x,h.offset.y+=D.y,h.lastCheck||(ht.Default.moveDatas(z,-c,-T,-t),h.offset.x-=c,h.offset.y-=t,h.offset.e-=T)),h.lastCheck=D}}h.lastView=M,this.fireEvent("paste",{datas:z,info:h}),M.setFocus(),this.endTransaction()}}},i.prototype.block=function(){if(this.editable){var i=this.displayView||this.sceneView;if(i){var H=this.selection;if(H.length){this.beginTransaction();var R=new ht.Block;i.addData(R,!0);var M=this.ld;R.setParent(M.getParent());var I=i.dm;I.moveTo(R,I.getSiblings(M).indexOf(M)+1),H.forEach(function(i){i.setHost&&i.setHost(void 0),i.setParent(R)}),I.sm().ss(R),this.endTransaction()}}}},i.prototype.unblock=function(){if(this.editable){var i=this.displayView||this.sceneView;if(i){this.beginTransaction();var H=[];this.selection.forEach(function(R){if(R instanceof ht.Block&&!(R instanceof ht.RefGraph)){var M=i.dm,I=R.getParent(),p=M.getSiblings(R).indexOf(R);R.getChildren().toArray().forEach(function(i){i.setParent(I),M.moveTo(i,p++),H.push(i)}),M.remove(R)}}),H.length&&(this.sm.ss(H),this.gv.setFocus()),this.endTransaction()}}},i.prototype.bringForward=function(){this.editable&&this.dm&&(this.dm.isHierarchicalRendering()?this.dm.moveSelectionDown():this.dm.bringSelectionForward())},i.prototype.bringToFront=function(){this.editable&&this.dm&&(this.dm.isHierarchicalRendering()?this.dm.moveSelectionToBottom():this.dm.bringSelectionToFront())},i.prototype.sendBackward=function(){this.editable&&this.dm&&(this.dm.isHierarchicalRendering()?this.dm.moveSelectionUp():this.dm.sendSelectionBackward())},i.prototype.sendToBack=function(){this.editable&&this.dm&&(this.dm.isHierarchicalRendering()?this.dm.moveSelectionToTop():this.dm.sendSelectionToBack())},i.prototype.undo=function(){this.pointsEditingMode=!1,this.editable&&(this._currentTab&&this._currentTab._isUI?this._currentTab.getView().undo():this.dm.getHistoryManager()&&this.dm.getHistoryManager().canUndo()&&(this.dm.undo(),this.fireEvent("undo",{})))},i.prototype.redo=function(){this.pointsEditingMode=!1,this.editable&&(this._currentTab&&this._currentTab._isUI?this._currentTab.getView().redo():this.dm.getHistoryManager()&&this.dm.getHistoryManager().canRedo()&&(this.dm.redo(),this.fireEvent("redo",{})))},i.prototype.distributeHorizontal=function(){this.editable&&this.inspectorTool.distributeHorizontal()},i.prototype.distributeVertical=function(){this.editable&&this.inspectorTool.distributeVertical()},i.prototype.alignLeft=function(){this.editable&&this.inspectorTool.alignLeft()},i.prototype.alignHorizontal=function(){this.editable&&this.inspectorTool.alignHorizontal()},i.prototype.alignRight=function(){this.editable&&this.inspectorTool.alignRight()},i.prototype.alignTop=function(){this.editable&&this.inspectorTool.alignTop()},i.prototype.alignVertical=function(){this.editable&&this.inspectorTool.alignVertical()},i.prototype.alignBottom=function(){this.editable&&this.inspectorTool.alignBottom()},i.prototype.folder=function(){if(this.editable&&this.displayView){this.beginTransaction();var i=new ht.Data;i.s("editor.folder",!0),this.dm.add(i);this.list.getTopRowOrderSelection().each(function(H){i.addChild(H)}),this.sm.ss(i),this.endTransaction()}},i.prototype.unfolder=function(){var i=this;if(this.editable&&this.displayView){this.beginTransaction();var H=this.sm.toSelection(function(i){return i.s("editor.folder")});H.forEach(function(i){i.toChildren().forEach(function(H){H.setParent(i.getParent())})}),H.forEach(function(H){i.dm.remove(H)}),this.endTransaction()}},i.prototype.locate=function(i){i&&this.request("locate",i.url||i)},i.prototype.saveImage=function(i,H,R,M,I,p){var h=this,z=function(){var z={uuid:M,path:H,content:bH(i),parent_uuid:I,root_dir:p};h.request("upload",z,R)};if(ti(i)&&!ht.Default.getImage(i))if(/.json$/.test(i))ht.Default.xhrLoad(i,function(H){H&&(ht.Default.setImage(i,ht.Default.parse(H)),z())});else{var d=new window.Image;d.onload=function(){ht.Default.setImage(i,d),z()},d.src=i}else z()},i.prototype.$48$=function(i){if(GR.length){if((i.target._ignore||!ui(i.target))&&!ht.Default.popup){var H=GR[GR.length-1];H.$48$&&H.$48$()}}else{for(var R=0;R<this.menus.length;R++)if(this.menus[R].isShowing())return void this.menus[R].hide();if(this.funcView&&this.funcView.smartClose&&this.funcView.getView().parentNode)return void this.funcView.hide();if(this.iconsView&&this.iconsView.getView().parentNode)return void this.iconsView.hide();if(this.tab){var M=this.tab.getView();[M.graphView,M.g3d].forEach(function(H){if(H){var R=H.getInteractors();R&&R.each(function(H){!H.disabled&&H.$48$&&H.$48$(i)})}})}}},i.prototype.$47$=function(i){if(GR.length){
if((i.target._ignore||!ui(i.target))&&!ht.Default.popup){var H=GR[GR.length-1];H.$47$&&H.$47$()}}else;},i.prototype.handleKeydown=function(i){var H=i.keyCode;if(s(i)&&83===H&&i.preventDefault(),c(i))return void this.$48$(i);if(O(i))return void this.$47$(i);var R={event:i};return this.fireEvent("keydown",R),R.preventDefault?void 0:s(i)&&83===H?void this.save():void(ui(i.target)||(i.preventDefault(),80===H?this.preview():187===H?this.zoomIn():189===H?this.zoomOut():48===H?this.zoomToFit():57===H?this.zoomReset():s(i)&&67===H?this.copy():s(i)&&86===H?this.paste():s(i)&&e(i)&&90===H?this.redo():s(i)&&90===H?this.undo():i.altKey&&s(i)&&221===H?this.bringToFront():i.altKey&&s(i)&&219===H?this.sendToBack():s(i)&&221===H?this.bringForward():s(i)&&219===H?this.sendBackward():90===H?this.fitSelection():s(i)&&e(i)&&71===H?this.unblock():s(i)&&71===H&&this.block()))},i.prototype.createDisplayItem=function(i,H,R,M,I,p){var h=this,z=function(){return h.displayView&&h.displayView.$3$()===i},d=RH(i,H,R,z);return d.visible=function(){return!!h.displayView&&h.editable},d.action=function(){h.displayView&&h.displayView.$4$(i,M,I,p)},d},i.prototype.createSymbolItem=function(i,H,R,M,I,p){var h=this,z=function(){return h.symbolView&&h.symbolView.$3$()===i},d=RH(i,H,R,z);return d.visible=function(){return!!h.symbolView&&h.editable},d.action=function(){h.symbolView&&h.symbolView.$4$(i,M,I,p)},d},i.prototype.showMessage=function(i,H,R){this.messageView.show(i,H,R)},i.prototype.showConfirm=function(i,H,R,M){this.confirmView.show(i,H,R,M)},i.prototype.batchConvertSVG=function(i){var H=this,R=[],M=[];i.forEach(function(i){qi(i.url)&&(R.push(i.url),M.push(i))});var I=2*R.length,h=0,z=function(){++h===I&&H.showMessage(qH(p("editor.batchconvertsuccess"),R.length+""))};r(R,function(i){i.forEach(function(i,R){var I=M[R],p=ht.Default.svgToShape(i,{segments:KR.config.svgSegments,minimumFontSize:KR.config.svgMinimumFontSize}),h=I.path.replace(/^assets/g,"symbols"),d=I.getName().replace(/svg$/g,"json");setTimeout(function(){var i=p.output,R=p.converter;R._canvas&&(i.width=R._canvas.width,i.height=R._canvas.height),H.request("upload",{path:h+"/"+d,content:F(i)},z),d=I.getName().replace(/svg$/g,"png"),H.request("upload",{path:h+"/"+d,content:bH(i)},z)},KR.config.svgWaitingTime)})})},i.prototype.$103$=function(i){},i.prototype.hasInspector=function(i){return i&&!i._isUI},zR(i,[{key:"editable",get:function(){return this.componentView.isShowing()?this.componentView.editable:!!this.currentView&&this.currentView.editable},set:function(i){this.currentView&&(this.currentView.editable=i)}},{key:"dm",get:function(){return this.gv?this.gv.dm():null}},{key:"gv",get:function(){var i=this.mainTabView.getTabModel().sm().ld();if(i){return i.getView().graphView}return null}},{key:"editInteractor",get:function(){return this.gv?this.gv.getEditInteractor():null}},{key:"pointsEditingMode",get:function(){return!!this.editInteractor&&this.editInteractor.pointsEditingMode},set:function(i){this.editInteractor&&(this.editInteractor.pointsEditingMode=i)}},{key:"anchorVisible",get:function(){return!!this.gv&&this.gv.getEditStyle("anchorVisible")},set:function(i){this.gv&&this.gv.setEditStyle("anchorVisible",i)}},{key:"sm",get:function(){return this.gv?this.gv.sm():null}},{key:"ld",get:function(){return this.sm?this.sm.ld():null}},{key:"selection",get:function(){var i=this,H=[];return this.gv&&this.gv.each(function(R){i.gv.isSelected(R)&&H.push(R)}),H}},{key:"tabs",get:function(){return this.mainTabView.tabs}},{key:"inspector",get:function(){return this.inspectorPane.inspector}},{key:"list",get:function(){return this.listPane.list}},{key:"tab",get:function(){return this.mainTabView.currentTab}},{key:"url",get:function(){return this.tab?this.tab.getTag():null}},{key:"explorer",get:function(){return this.leftTopTabView.getCurrentTab().getView()}},{key:"dir",get:function(){return this.explorer?this.explorer.tree.getSelectionModel().getLastData():null}},{key:"file",get:function(){return this.explorer?this.explorer.getFileListView().getSelectionModel().getLastData():null}},{key:"currentLayer",get:function(){return this.layerPane.currentLayer}},{key:"currentView",get:function(){var i=this.tab;return i?i.getView():null}},{key:"displayTree",get:function(){return this.displayView?this.displayView.displayTree:null}},{key:"displayView",get:function(){var i=this.currentView;return i instanceof nM?i:null}},{key:"symbolList",get:function(){return this.symbolView?this.symbolView.symbolList:null}},{key:"symbolView",get:function(){var i=this.currentView;return i instanceof xM?i:null}},{key:"currentEditingPoint",get:function(){var i=this.currentView;return i?i.currentEditingPoint:null}},{key:"inspectorCompact",get:function(){return this._inspectorCompact},set:function(i){this._inspectorCompact=i,this.filterProperties(),this.inspectorTool.iv()}},{key:"inspectorInputFilter",get:function(){return this.inspectorTool.searchField.getValue()},set:function(i){this.inspectorTool.searchField.setValue(i),this.filterProperties()}}]),i}();ii(Hp,{ms_fire:1}),KR.Editor=Hp;var Rp=function(){function i(H,R){var M=this;hR(this,i),this.editor=R,this.handler=H,this.cookie=0,this.callbacks={},this.cmds={},this.fileChangeVersion=String((new Date).getTime());var I=KR.config.host||window.location.hostname,p=KR.config.port||window.location.port,h=this.url=window.location.protocol+"//"+I+":"+p;setTimeout(function(){M.handler({type:"connected",message:h})},1),KR.config.checkForFileChanges&&KR.config.checkForFileChangesInterval&&this.fileChangedEvent()}return i.prototype.request=function(i,H,R){var M=++this.cookie;this.callbacks[M]=R,this.cmds[M]=i;var I=this.editor.sid;this[i](M,H,I||null,R);var p=i;H&&(ti(H)?p=i+": "+H:H.path&&(p=i+": "+H.path)),this.handler({type:"request",message:p,cmd:i,data:H})},i.prototype.fileChangedEvent=function(){var i=this,H=this.url+"/fileVersion";H+="/"+i.fileChangeVersion,H+="?sid="+this.editor.sid,i.send("GET",H,null,function(H){i.fileChangeVersion=String((new Date).getTime());var R=H.target.response;if(R){R=JSON.parse(R);Object.keys(R).forEach(function(H){i.handler({type:"fileChanged",path:H})})}}),setTimeout(function(){i.fileChangedEvent()},KR.config.checkForFileChangesInterval)},i.prototype.export=function(i,H,R){var M=this,I=new ht.Request,p={},h=new FormData,z=this.url+"/export";z+="?sid="+R,h.append("dir",H),p.url=encodeURI(z),p.method="POST",p.data=h,I.setResponseType("blob"),I.onload=function(H){var R=H.target;if(200==R.status||0===R.status){var I=R.response,p=R.getResponseHeader("Content-Disposition").split(";"),h=p[1].split("=")[1],z=new Blob([I],{type:"application/zip"}),d=document.createElement("a");d.href=window.URL.createObjectURL(z),d.download=decodeURI(h),d.click(),M.handleRespone(i,!0)}},I.send(p)},i.prototype.mkdir=function(i,H,R){var M=this,I=new ht.Request,p={},h=new FormData,z=this.url+"/mkdir";z+="?sid="+R,KR.config.vision?(h.append("path",H.dir),h.append("parent_uuid",H.parent_uuid)):h.append("path",H),p.url=encodeURI(z),p.method="POST",p.data=h,I.onload=function(H){var R=H.target;if(200==R.status||0===R.status){var I=R.response||R.responseText;M.handleRespone(i,"true"===I),M.handler({type:"fileChanged",path:dir})}},I.send(p)},i.prototype.explore=function(i,H,R){var M=this,I=new ht.Request,p={},h=this.url+"/explore";h+=H,h+="?sid="+R,p.url=encodeURI(h),I.onload=function(H){var R=H.target;if(200==R.status||0===R.status){var I=R.response||R.responseText;M.handleRespone(i,JSON.parse(I))}},I.send(p)},i.prototype.upload=function(i,H,R){var M=this,I=new FormData,p=this.url+"/upload",h=H.path;p+="?sid="+R,I.append("path",H.path),I.append("content",H.content),M.send("POST",p,I,function(H){var R=H.target;if(200==R.status||0===R.status){var I=R.response;if(M.handleRespone(i,!0),I){var p=JSON.parse(I);M.handler({type:"confirm",path:p.tempName,datas:p.paths})}else M.handler({type:"fileChanged",path:h})}})},i.prototype.rename=function(i,H,R){var M=this,I=new FormData,p=H.new,h=H.old,z=this.url+"/rename";z+="?sid="+R,I.append("newPath",p),I.append("oldPath",h),M.send("POST",z,I,function(H){var R=H.target;if(200==R.status||0===R.status){var I=R.response||R.responseText;M.handleRespone(i,"true"===I),"true"===I&&(M.handler({type:"fileChanged",path:p}),M.handler({type:"fileChanged",path:h}))}})},i.prototype.remove=function(i,H,R){var M=this,I=new FormData,p=this.url+"/remove";p+="?sid="+R,I.append("path",H),M.send("POST",p,I,function(R){var I=R.target;if(200==I.status||0===I.status){var p=I.response||I.responseText;M.handleRespone(i,"true"===p),"true"===p&&M.handler({type:"fileChanged",path:H})}})},i.prototype.locate=function(i,H,R){var M=this,I=this.url+"/locate";I+="?dir="+H,I+="&sid="+R,M.send("GET",I,null,function(H){var R=H.target;200!=R.status&&0!=R.status||M.handleRespone(i,!0)})},i.prototype.open=function(i,H,R){var M=this,I=this.url+"/open";I+="?url="+H,I+="&sid="+R,M.send("GET",I,null,function(H){var R=H.target;200!=R.status&&0!=R.status||M.handleRespone(i,!0)})},i.prototype.source=function(i,H,R){var M=this,I=new FormData,p=this.url+"/source";p+="?sid="+R,I.append("url",H.url),I.append("encoding",H.encoding),I.append("prefix",H.prefix),M.send("POST",p,I,function(H){var R=H.target;if(200==R.status||0===R.status){var I=R.response||R.responseText;M.handleRespone(i,I)}})},i.prototype.import=function(i,H,R){var M=this,I=new FormData,p=this.url+"/import";p+="?sid="+R,I.append("path",H.path),I.append("move",H.move),M.send("POST",p,I,function(H){var R=H.target;200!=R.status&&0!==R.status||M.handleRespone(i,!0)})},i.prototype.paste=function(i,H,R){var M=this,I=new FormData,p=this.url+"/paste";p+="?sid="+R,I.append("destDir",H.destDir),I.append("fileList",H.fileList),M.send("POST",p,I,function(H){var R=H.target;if(200==R.status||0===R.status){var I=R.response||R.responseText;M.handleRespone(i,I)}})},i.prototype.send=function(i,H,R,M){var I=new ht.Request,p={};p.url=encodeURI(H),p.method=i,p.data=R,M&&(I.onload=M),I.send(p)},i.prototype.handleRespone=function(i,H){var R=this.callbacks[i],M=this.cmds[i];delete this.callbacks[i],delete this.cmds[i],this.handler({type:"response",message:M,cmd:M,data:H}),R&&R(H)},i}();return KR.config.logEditorInfo&&console.log("HT Editor v0.3.10 powered by HT for Web v"+ht.Default.getVersion()+" from www.hightopo.com"),!window.onbeforeunload&&KR.config.promptBeforeClosing&&(window.onbeforeunload=function(i){return i.returnValue=p("editor.closetip"),i.returnValue}),KR.version="0.3.10",KR.FILE_TYPE_UNKNOWN=QR,KR.FILE_TYPE_ROOT=mR,KR.FILE_TYPE_DIR=XR,KR.FILE_TYPE_ASSET=oR,KR.FILE_TYPE_SYMBOL=JR,KR.FILE_TYPE_DISPLAY=OR,KR.FILE_TYPE_COMPONENT=cR,KR.FILE_TYPE_MODEL=tR,KR.FILE_TYPE_UI=NR,KR.FILE_TYPE_SCENE=TR,KR.FILE_LAYOUT_LIST="list",KR.MESSAGE_TYPE_NORMAL="normal",KR.MESSAGE_TYPE_ERROR="error",KR.getString=p,KR.stringifyFunction=b,KR.parseFunction=K,KR.createLabel=MH,KR.createButton=IH,KR.createItem=RH,KR.layoutMainView=zH,KR.msClass=ii,KR.initContext=u,KR.getInput=iH,KR.trimExtension=B,KR.fileNameToDisplayName=E,KR.isJSON=bi,KR.isJS=Oi,KR.isDXF=Qi,KR.isOBJ=mi,KR.isDisplay=Mi,KR.isScene=hi,KR.isSymbol=Ii,KR.isAsset=Ci,KR.isComponent=pi,KR.isUI=di,KR.isImage=yi,KR.isModel=zi,KR.isMTL=Xi,KR.getter=q,KR.setter=Q,KR.snapshot=bH,KR.CodeEditor=UR,KR.createCodeEditor=KH,KR.FunctionEditor=gM,KR.ContextMenu=YR,KR.Dialog=yR,KR.SplitView=WR,KR.FormPane=bR,KR.TablePane=$R,KR.DND=gI,KR.DNDFromOutside=SI,KR.DNDTree=uR,KR.DNDIndexList=kM,KR.EditGraphView=oM,KR.DisplayGraphView=JM,KR.SymbolList=PM,KR.FileTree=iM,KR.FileList=pM,KR.DisplayTree=RM,KR.DisplayView=nM,KR.MainTabView=jM,KR.MainToolbar=VM,KR.MainMenu=lM,KR.MessageView=bI,KR.ObjectView=II,KR.EditView=tM,KR.FontView=zI,KR.FunctionView=MI,KR.ComponentView=LM,KR.SymbolView=xM,KR.RightToolbar=AM,KR.InspectorTool=YM,KR.Inspector=XI,KR.HTDataInspector=cI,KR.HTNodeInspector=NI,KR.HTTextInspector=vI,KR.HTShapeInspector=kI,KR.HTGroupInspector=GI,KR.HTBlockInspector=PI,KR.HTRefGraphInspector=ZI,KR.HTEdgeInspector=nI,KR.DisplayInspector=oI,KR.SymbolInspector=OI,KR.CompInspector=aI,KR.InspectorPane=AI,KR.Explorer=CM,KR.Scenes=KM,KR.Models=qM,KR.Assets=mM,KR.Components=UM,KR.Displays=yM,KR.Symbols=bM,KR.UIs=QM,KR.FileNode=hM,KR.WebSocketService=LR,KR.HTTPService=Rp,KR.CreateNodeInteractor=NM,KR.CreateEdgeInteractor=DM,KR.CreateShapeInteractor=fM,KR.combineShapes=XH,KR.splitShape=oH,KR.removeItem=C,KR.alert=HH,KR.initImageIcon=cH,KR.initInputDND=tH,KR.jsonToPNG=ci,KR.getDataBindingMap=UH,KR.isAllShape=JH,KR.reverseShapes=mH,KR.readLocalFile=hH,KR.removeCache=v,KR.DIRECTORY_TYPE_NORMAL=1,KR.DIRECTORY_TYPE_PROJECT=2,KR.DIRECTORY_TYPE_ROOT=3,KR.DIRECTORY_TYPE_SYSTEM=4,KR.showingDialogs=GR,KR.symbol={Image:BR},KR.createEditor=function(i){if(window.location.host.indexOf("hightopo.")>=0){var H="https:"==document.location.protocol?" https://":" http://";document.write(unescape("%3Cdiv style='display:none'%3E%3Cspan id='cnzz_stat_icon_1000279011'%3E%3C/span%3E%3Cscript src='"+H+"s23.cnzz.com/z_stat.php%3Fid%3D1000279011%26show%3Dpic' type='text/javascript'%3E%3C/script%3E%3C/div%3E")),document.body.style.margin="0px",document.body.style.padding="0px"}i&&(ht.Default.isString(i)?i={container:i}:i.tagName&&i.appendChild&&(i={container:i})),i=i||{};var R=void 0,M=void 0===i.container?KR.config.container:i.container;return null===M?R=null:M?ht.Default.isString(M)?R=document.getElementById(M):M.length?(R=ht.Default.createDiv(),R.style.left=M[0]+"px",R.style.top=M[1]+"px",R.style.width=M[2]+"px",R.style.height=M[3]+"px",document.body.appendChild(R)):R=M:R=document.body,i.$38$=R,new Hp(i)},KR.init=function(){if(!KR.consts){var i=p("MAX_INDENT_TEST_STRING",!0);i&&(KR.config.indent=ht.Default.getTextSize(void 0,i).width+4-ht.Default.textExtraWidth),i=p("MAX_INDENT2_TEST_STRING",!0),i&&(KR.config.indent2=ht.Default.getTextSize(void 0,i).width+4-ht.Default.textExtraWidth),SH(),gH(),AH(),KR.config.initStudio&&KR.config.initStudio()}},KR}();
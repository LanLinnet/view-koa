!function(e,o,W){"use strict";function Q(j,H){if("function"!=typeof H&&null!==H)throw new TypeError("Super expression must either be null or a function");j.prototype=o.create(H&&H.prototype,{constructor:{value:j,writable:!0,configurable:!0}}),H&&Yc(j,H)}function M(E){var w=o.prototype.toString.call(E);return"Array]"===w.substring(w.length-6)}function Y(W,q,J,r,L,u){q=q||[],J=J||[],r=r||[];try{q.push(W);var C=Function.apply(0,q);return J[J.length]="return "+C,Function.apply(0,J).apply(0,r)}catch(p){return u&&u(p),L}}function c(v){var w={};return{get:function(M){if(w[M]!==W)return w[M];var D;switch(M){case"WEBGL_depth_texture":D=v.getExtension("WEBGL_depth_texture")||v.getExtension("MOZ_WEBGL_depth_texture")||v.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":D=v.getExtension("EXT_texture_filter_anisotropic")||v.getExtension("MOZ_EXT_texture_filter_anisotropic")||v.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":D=v.getExtension("WEBGL_compressed_texture_s3tc")||v.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||v.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":D=v.getExtension("WEBGL_compressed_texture_pvrtc")||v.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":D=v.getExtension("WEBGL_compressed_texture_etc1");break;default:D=v.getExtension(M)}return w[M]=D,D}}}function F(o,t,S){function f(){if(e!==W)return e;var N=t.get("EXT_texture_filter_anisotropic");return e=null!==N?o.getParameter(N.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function O(R){if("highp"===R){if(o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.HIGH_FLOAT).precision>0&&o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.HIGH_FLOAT).precision>0)return"highp";R="mediump"}return"mediump"===R&&o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.MEDIUM_FLOAT).precision>0&&o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var e;S=S||{};var G="undefined"!=typeof WebGL2RenderingContext&&o instanceof WebGL2RenderingContext,s=S.precision!==W?S.precision:"highp",$=O(s);$!==s&&(console.warn("WebGL:",s,"not supported, using",$,"instead."),s=$);var Q,A=S.logarithmicDepthBuffer===!0,x=o.getParameter(o.MAX_TEXTURE_IMAGE_UNITS),j=o.getParameter(o.MAX_VERTEX_TEXTURE_IMAGE_UNITS),w=o.getParameter(o.MAX_TEXTURE_SIZE),u=o.getParameter(o.MAX_CUBE_MAP_TEXTURE_SIZE),i=o.getParameter(o.MAX_VERTEX_ATTRIBS),P=o.getParameter(o.MAX_VERTEX_UNIFORM_VECTORS),F=o.getParameter(o.MAX_VARYING_VECTORS),c=o.getParameter(o.MAX_FRAGMENT_UNIFORM_VECTORS),h=j>0,C=G||!!t.get("OES_texture_float"),p=(G||!!t.get("OES_element_index_uint"))&&"undefined"!=typeof Uint32Array,T=h&&C,m=G?o.getParameter(o.MAX_SAMPLES):0,X=!1;return G?X=!0:(Q=t.get("ANGLE_instanced_arrays"))&&(X=!0,o.vertexAttribDivisor=function(C,T){return Q.vertexAttribDivisorANGLE(C,T)},o.drawElementsInstanced=function(w,X,s,Z,N){return Q.drawElementsInstancedANGLE(w,X,s,Z,N)},o.drawArraysInstanced=function(y,f,E,z){return Q.drawArraysInstancedANGLE(y,f,E,z)}),{getMaxAnisotropy:f,getMaxPrecision:O,precision:s,logarithmicDepthBuffer:A,maxTextures:x,maxVertexTextures:j,maxTextureSize:w,maxCubemapSize:u,maxAttributes:i,maxVertexUniforms:P,maxVaryings:F,maxFragmentUniforms:c,vertexTextures:h,floatFragmentTextures:C,elementTypeUint:p,floatVertexTextures:T,maxSamples:m,instancedArray:X}}function $(t,z){return t.z!==z.z?z.z-t.z:t.id-z.id}var V="ht";if(!e[V]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),e.performance&&e.performance.now||function(){var x=Date.now();e.performance||(e.performance={}),e.performance.now=function(){return Date.now()-x}}();for(var B=Date.now(),C=16,X=["ms","moz","webkit","o"],E=0;E<X.length&&!e.requestAnimationFrame;++E)e.requestAnimationFrame=e[X[E]+"RequestAnimationFrame"],e.cancelAnimationFrame=e[X[E]+"CancelAnimationFrame"]||e[X[E]+"CancelRequestAnimationFrame"];e.requestAnimationFrame||(e.requestAnimationFrame=function(t){var d=Date.now(),v=C+B-d;return 0>v&&(v=0),B=d,e.setTimeout(function(){B=Date.now(),t(performance.now())},v)}),e.cancelAnimationFrame||(e.cancelAnimationFrame=function(I){return e.clearTimeout(I)}),o.assign===W&&(o.assign=function(R){if(R===W||null===R)throw new TypeError("Cannot convert undefined or null to object");for(var N=o(R),Z=1;Z<arguments.length;Z++){var B=arguments[Z];if(B!==W&&null!==B)for(var V in B)o.prototype.hasOwnProperty.call(B,V)&&(N[V]=B[V])}return N}),e.btoa===W&&(e.btoa=function(I){for(var j,o,P=String(I),v=0,z="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",D="";P.charAt(0|v)||(z="=",v%1);D+=z.charAt(63&j>>8-8*(v%1))){if(o=P.charCodeAt(v+=.75),o>255)throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");j=j<<8|o}return D})}();var A,P,I,i,l=e.location,m=l&&e.document,S=null,p=W,n=e[V]={},q=e[V+"config"],H=n.Default=q&&q.Default||{},D=n.Style=q&&q.Style||{},w=n.Attr=q&&q.Attr||{},C=function(){return!0},y=function(){return!1},a=function(F){return F},L=function(A){return!A},h=n.Color=q&&q.Color||{},r=n.IsGetter=q&&q.IsGetter||{};!function(){var G=!1;try{var t=o.defineProperty({},"passive",{get:function(){return G=!0,W}});l&&(I=A=l)&&e.addEventListener("test",t,t),l&&(i=P=l)&&e.removeEventListener("test",t,t)}catch(Q){G=!1}H.passiveSupported=G}();var u,J,K,G,T=H.passiveSupported,B=H.eventListenerOptionsFalse=T?{passive:!1,capture:!1}:!1,E=H.eventListenerOptionsTrue=T?{passive:!1,capture:!0}:!0,Z=function(A,R,Q,t){A.addEventListener(R,Q,t?E:B)},N=function(N,u,Y,R){N.removeEventListener(u,Y,R?E:B)},f=Math,b=f.round,j=f.floor,k=f.ceil,x=f.sqrt,g=f.max,_=f.min,v=f.abs,s=f.cos,d=f.acos,R=f.sin,t=f.pow,U=f.asin,O=f.exp,X=f.PI,z=2*X,Rr=X/2,Wi=f.tan,db=f.atan2,kj=f.random,dj=f.log,_p=function(s,p,d){return Math.max(p,Math.min(d,s))},qi=t(2,1),Di=!1,fl=e.parseInt||global.parseInt,ni="2022-5-15",ic=l&&(e.navigator?e.navigator.platform.indexOf("Win")>-1:!1),Cr=function(j){return j*j},Yk=l&&e.setTimeout,gp=l&&e.clearTimeout,ik=l&&(e.navigator?e.navigator.userAgent.toLowerCase():""),sj=function(D){return D.test(ik)},zm=sj(/msie/),Ni=sj(/msie/)||sj(/trident/),$k=sj(/msie 10/),Lg=sj(/edge/),Mk=sj(/firefox/),Fk=sj(/mac/),Lc=sj(/mscAndroid/),bc=H.isTouchable===W?ic?!1:m?"ontouchend"in m:!1:H.isTouchable,Bg="default",lg="single",Rm="multiple",sl="front",$i="back",Vn="left",_k="right",Dr="top",Er="bottom",al="center",Xj="eye",hh="middle",iq="east",Dn="west",hj="north",Uh="none",Kl="px",vc="absolute",tk="border",Fc="triangle",Fi="rect",mj="circle",gs="cylinder",Zb="shape",le="items",si="normal",Wh="remove",rs="clear",ye="width",yg="height",Xc="ingroup",os="check",ub="uncheck",Le="radio",eb="radioOn",Bl="radioOff",We="points",eg="values",_e="series",rb="body",Jo="label",tj="label2",Ml="note",Eg="note2",bp="icons",Gj="labelFont",Pc="labelColor",up="labelSelectColor",Rg="note.expanded",li="note2.expanded",Up="edge.expanded",Fd="edge.points",bk="edge.type",vm="rotation",Ef="hidden",jh="visible",Ei="tuv",cq="no",jf="draw",jk="select",nh="currentSubGraph",od="selectBackground",ib="autoMakeVisible",Gh="autoHideScrollBar",Kq="scrollBarColor",qc="scrollBarSize",zg="indent",pm="rowHeight",Kf="columnLineColor",Lm="rowLineColor",Jn="columnLineVisible",pi="rowLineVisible",_n="visibleFunc",Yb="expandIcon",Bh="collapseIcon",Zm="checkMode",Rd="sortFunc",xq="editable",Oc="batchEditable",hm="tristate",hd="asc",$d="desc",ks="position",Ap="__",Ee="elevation",Ue="children",Ih="translateX",xi="translateY",hb="dataModel",Ui="maxSize",Cc="enc",Io="state",Yq=Cc+"o"+"de",Cd="shape3d",Kc="shape3d.resolution",zb="shape3d.visible",kn="shape3d.from.visible",qh="shape3d.to.visible",ob="shape3d.top.visible",_l="shape3d.bottom.visible",cp="repeat.uv.length",ql="serializeValue",ml="deserializeValue",Eh="centerUniform",fj="uniform",te="rgba(255,255,255,0)",cr="style",Lj="attr",Jf="field",ps="string",Ak="boolean",kp="color",Ql="int",Jd="number",Yf="ew-resize",Gn="ns-resize",Fq="pointer",yd="auto",Lb="mousedown",ag="mousemove",Cp="mouseup",zf="mouseout",Fh="touchstart",nd="touchmove",hs="touchend",wn="keydown",Ld="keyup",Hc=["DOMMouseScroll","mousewheel"],tr=Mk?Hc[0]:Hc[1],_o=Ap+V+Ap+Yq,Hk=[Fh,nd,hs],jp=[Lb,ag,Cp,zf,tr,"wheel","mouseenter","mouseleave","mouseover"],ym=[wn,Ld,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"],Pl=bc?Hk.concat(ym):jp.concat(ym),gj=S,Np=S,Li=S,on=S,Pk=!1,mc=Cp.length,zc=function(){Li&&(gp(Li.timeout),Li=S)},jl=function(){Li&&$g(Li.e,Li.info)};e.addEventListener&&(p=l)&&(bc||(Z(e,zf,function(){zc()}),Z(e,tr,function(){Qm()})),Z(e,Ld,function(V){91===V.keyCode?$f={}:delete $f[V.keyCode]},!0),Z(e,wn,function(F){$f[F.keyCode]=!0},!0),Z(e,"blur",function(){$f={}}));var zj,Kh,Gc,Dg=0,Zh=S,lh=function(i,B){var L=Yk(function(){delete Zh[L],to(Zh)&&(Zh=S),i()},B);return L},Tj=S,jc=S,Sf={},pp={},Hd={},yh={},Uo={},$f={},Xh={},oc={},jd={},rn={},dp=/.json$/,zs=/\.(json|bin)$/,_f=/^data:image\/svg\+xml/,Pj={},Jj=[],Zc={},Yh=S,$b=S,wi=function(){},vg=function(){throw"Oops!"},nb=[0,0,0],kq={x:0,y:0,width:0,height:0},ir=S,Qr=S,Fn=S,_b=function(O,x){pp[O]=x,x&&x.comps&&!x.uuid&&(x.uuid=n.Math.generateUUID()),ke[O]&&(x.cacheRule=ke[O],delete ke[O])},Kp=function(_){Qr&&!_._72O&&(Fn||(Fn={}),Fn[_._72O=_j()]=_),zj!=S?jn()<.05&&G&&!Kh&&(of=zc):of=an},Hh=function(g,Z,r,W){Qr||(Qr={});var d=Qr[g];if(d){if(d.url===Z)return;d.image?(d.image.onload=wi,d.image.onerror=wi):d.request&&(d.request.onload=wi,d.request.onerror=wi)}if(dp.test(Z)){var I=new xc;if(Qr[g]={request:I,url:Z},Z=H.beforeLoadURL(Z,g),Z.data){var j=H.parse(Z.data);Me(g,j),H.handleImageLoaded(g,j)}else{I.onload=function(){if(200===this.status||0===this.status){var $=H.parse(I.getResponseText());Me(g,$),H.handleImageLoaded(g,$)}else Me(g,H.handleUnfoundImage(g,Z)||S)},I.onerror=function(){Me(g,H.handleUnfoundImage(g,Z)||S)};var B={};B.url=encodeURI(Z),B.sync=!1,I.send(B)}}else{var j=new Image;Qr[g]={image:j,url:Z},/^data:image/.test(Z)||(Z=H.beforeLoadURL(Z,g),Z=H.appendTimeStamp(Z),Z=encodeURI(Z),j.crossOrigin=H.crossOrigin),H.convertImageSrc(Z,function(z){Ni&&(Z.toLowerCase().indexOf(".svg")>0||_f.test(Z))?(m.body.appendChild(j),j.style.visibility="hidden",j.onload=function(){Yk(function(){if(r&&(j.width=r),W&&(j.height=W),!j.width||!j.height){var u=j.width||j.clientWidth,D=j.height||j.clientHeight;j.width=u,j.height=D}H.handleImageLoaded(g,j),Me(g,j),m.body.removeChild(j),j.style.visibility=""},180)},j.onerror=function(){Me(g,H.handleUnfoundImage(g,Z)||S),m.body.removeChild(j),j.style.visibility=""}):(j.onload=function(){r&&(j.width=r),W&&(j.height=W),H.handleImageLoaded(g,j),Me(g,j)},j.onerror=function(){Me(g,H.handleUnfoundImage(g,Z)||S)}),j.src=z})}},Me=function(v,s){if(_b(v,s),delete Qr[v],to(Qr)&&(Qr=S,Fn)){for(var R in Fn){var H=Fn[R];H._2O&&H._2O[v]&&(H.deleteTexture(v),delete H._2O[v]),H.invalidateAll&&H.invalidateAll(W,"imageLoaded",v),H.redraw&&H.redraw(),H.iv(),s&&s.layoutAttach&&Qj(H.dm)&&H.dm().updateLayoutAttach(v),delete H._72O}Fn=S}if(s&&Fn)for(var R in Fn){var H=Fn[R];H.invalidateAll&&H.invalidateAll(W,"imageLoading",v),H.redraw&&H.redraw(),H.iv(),s.layoutAttach&&Qj(H.dm)&&H.dm().updateLayoutAttach(v)}},Gm=function(){return dj=f&&Date,function(){return e.performance&&e.performance.now?e.performance.now():Date.now()}}(),Rn=function(H,u,V){return{width:H,height:u,comps:Td(V)?V:[V]}},Yr=function(n,w){return{type:mj,rect:[n,w,1.6,1.6],borderWidth:1,borderColor:sr,gradient:qg,gradientColor:kl,background:sr}},aj=function(c,r){return Rn(16,16,{type:Fc,rect:[4,4,10,8],background:c,rotation:r?1.57:3.14})},Eq=function(I,n){return Rn(16,16,{type:Fc,rect:[4,4,8,7],background:I,rotation:n?3.14:0})},Nl=function(m){var l=m._orientation;return"horizontal"===l||"h"===l},dg=function(P,D){var j=S||4,e=S||1,w=S||1;0>j?j=0:j>.25&&(j=.25);var O,M,A,U,l,i,V,g=.5,I=[],f=[],F=[],L=z/w,b=z/e,$=g-j;for(M=0;e>=M;M++)for(U=-X+M*b,i=s(U),l=R(U),O=0;w>=O;O++)A=O*L,V=$+j*i,I.push(s(A)*V,l*j,-R(A)*V),(J=[P,D])&&f.push(O/w,1-M/e);for(M=0;e>M;M++){var Z=M*(w+1),W=(M+1)*(w+1);for(O=0;w>O;O++)F.push(Z+O,W+O+1,W+O,Z+O,Z+O+1,W+O+1),kc.z=qs.z=[P,D]}},Do=function(V){var U=2,f=0;for(var c in V)c.length===U&&fl(c,32)===vi&&(Yh=$b=V[c]),f++;return f},cd=function(E,W,s,N){return s||(s=bc?5:3,s/=N||1),{x:E-s,y:W-s,width:2*s,height:2*s}},ce=function(C,K,r,x){var L=this;K||(K=bc?5:3,r=20,x=20);var t={x:C,y:K,width:r,height:x};if(r)for(var Y=0;r>Y;Y++)if(3===r)x=20;else for(var T=0;x>T;T++)L=e?e:r;var n={x:X,y:2*X};if(Zk(t,n)){var y=yg[0]+Dr[0]+rs[1]+hd.length,G=Ef[0]+hm[0]+rs[1]+rb.length;gk[Xj]=[L[y],L[G]],L[y]=Bc[Xj],L[G]=Bc[Cd]}},lc=function(s){return(/ble$/.test(s)||/ed$/.test(s)||r[s]?"is":"get")+s.charAt(0).toUpperCase()+s.slice(1)},Bc=function(z){return"set"+z.charAt(0).toUpperCase()+z.slice(1)},xd=function(K){return typeof K===ps||K instanceof String},ff=function(B){return typeof B===Jd},an=function(Z){return typeof Z===Ak},Il=function(X){return X&&"object"==typeof X},Qj=function(D){return"function"==typeof D},Td=function(r){return r instanceof Array},No=function(h){return h instanceof Xd},Lh=function(z){return Td(z)?new Xd(z):z},af=function(D){return D instanceof ci},zl=function(n){return n instanceof vb},tl=function(G){return G instanceof Fp},fm=function($,I){if(!($ instanceof n.Group))return!1;if(!I)return $.isExpanded();var q=I.getDataUI($);return q&&q._88I?!0:!1},rj=function(q){return q instanceof $n},pf=function(d){return d&&"IFRAME"===d.tagName},Jb=function(t){return t==S||H.numberDigits==S?t:parseFloat(t.toFixed(H.numberDigits))},Qb=function(A,H,b){var P,a=H.length;if(b)for(var Y=0;b>Y;Y++)if(3===a)A.push(H[0]),A.push(H[1]),A.push(H[2]);else for(P=0;a>P;P++)A.push(H[P]);else if(3===a)A.push(H[0]),A.push(H[1]),A.push(H[2]);else for(P=0;a>P;P++)A.push(H[P])},qd=function(L){return L?Il(L)?L:{}:!1},kk=function(P,V,b){var Q,F=Il(P)?P:P.prototype;for(Q in V)b&&Q in F?F[Q]===W&&console.warn("class",F,"has own undefined property",Q,", keep exist!"):F[Q]=V[Q];return P},fc=function(N,a){if(!("wheelDelta"in a)){var i=a.deltaMode;a.wheelDelta=i===a.DOM_DELTA_PIXEL?-a.deltaY:i===a.DOM_DELTA_LINE?40*-a.deltaY:120*-a.deltaY}N.handle_mousewheel(a)},cn=function(o){return String.fromCharCode(o)},fi=function(U){for(var D,u=0,N="";u<U.length;u++)D=U[U.length-1-u],"%"===D?D="'":"a"===D?D='"':"]"===D&&(D="\\"),N+=cn(D.charCodeAt(0)-1);return N},fb=function(k,o,W){k.superClass.constructor.apply(o,W)},to=function(Y){for(var c in Y)return!1;return!0},bg=function(Y){return Y?0===Y.length:!0},hf=function(){var b="";return[ub[0],Lm[0],Jo[0]].forEach(function(T){b+=Bc(T).slice(3)}),fj=m&&m[b]||Eh,function(B,b){return B===b?!0:B.x===b.x&&B.y===b.y&&B.width===b.width&&B.height===b.height}}(),Ki=function(t,y,K){return y>t?y:t>K?K:t},uo=function(N){return 0>N?-1:N>0?1:0},jn=function(){var g=1e4*R(mc++);return g-j(g)},Ko=function(V,h,G){return xf(V.x,V.y,h.x,h.y,G.x,G.y,G.x+G.width,G.y,!0)||xf(V.x,V.y,h.x,h.y,G.x+G.width,G.y,G.x+G.width,G.y+G.height,!0)||xf(V.x,V.y,h.x,h.y,G.x+G.width,G.y+G.height,G.x,G.y+G.height,!0)||xf(V.x,V.y,h.x,h.y,G.x,G.y+G.height,G.x,G.y,!0)},xf=function(i,U,c,V,e,f,y,O,M){var k=(y-e)*(U-f)-(O-f)*(i-e),T=(O-f)*(c-i)-(y-e)*(V-U);if(0!==T){var o=k/T,Y=i+o*(c-i),t=U+o*(V-U);return M&&(Y+Gq<_(i,c)||Y-Gq>g(i,c)||Y+Gq<_(e,y)||Y-Gq>g(e,y)||t+Gq<_(U,V)||t-Gq>g(U,V)||t+Gq<_(f,O)||t-Gq>g(f,O))?S:[Y,t]}return S},yi=function(I,U,G){if(I&&G)if(U){if(U===cr)return I.getStyle(G);if(U===Lj)return I.getAttr(G);if(U===Jf)return I[G]}else if(G=lc(G),I[G])return I[G]();return W},ae=function(I,o,T,t){if(I&&T)if(o){if(o===cr)I.s(T,t);else if(o===Lj)I.a(T,t);else if(o===Jf){var w=I[T];I[T]=t,I.fp("f:"+T,w,t)}}else T=Bc(T),I[T]&&I[T](t)},oh=function(B,b,K){var C=100*Math.max(B.width,B.height);return b&&"top"!==b?"bottom"===b?{x:B.x-C,y:B.y-C,width:B.width+2*C,height:B.height*K+C}:"right"===b?{x:B.x-C,y:B.y-C,width:B.width*K+C,height:B.height+2*C}:"left"===b?{x:B.x+B.width*(1-K),y:B.y-C,width:B.width*K+C,height:B.height+2*C}:void 0:{x:B.x-C,y:B.y+B.height*(1-K),width:B.width+2*C,height:B.height*K+C}},Bk=function(f,I,O,r,E){I&&Xf(f,O,r,1,E,I)},En=function(I,c,U,X){var w=1-I;return w*w*c+2*I*w*U+I*I*X},kc=function(Y,v,$,k,o){var j=1-Y;return j*j*j*v+3*j*j*Y*$+3*j*Y*Y*k+Y*Y*Y*o},Ke=function(b){var t,j,u,N,C=0;return b.forEach(function(o){if(t=o.length,t>0)for(j=o[0],N=1;t>N;N++)u=o[N],C+=_h(j,u),j=u}),C},vo=function(S,L,U){var q="__"+S,k=function(Z){("mousedown"===S||"mouseup"===S||"touchstart"===S||"touchend"===S)&&tg(Z),U.disabled||U["handle_"+S](Z)};U[q]||(U[q]=k,Z(L,S,k))},Aj=function(G,Z,z){var L="__"+G,q=z[L];q&&(N(Z,G,q),delete z[L])},Uk=function(w,Z){var o="_"+Z;w[lc(Z)]=function(){return this[o]},w[Bc(Z)]=function(y){var F=this[o];this[o]=y,this.fp(Z,F,y)}},wc=function(Z){return o.create(Z)},bb=function(A){if(!A.element){var Q,L;(Q=A.textField)?L=zr(Ht.TextField,Q):(Q=A.textArea)?L=zr(Ht.TextArea,Q):(Q=A.button)?L=zr(Ht.Button,Q):(Q=A.comboBox)?L=zr(Ht.ComboBox,Q):(Q=A.checkBox)?L=zr(Ht.CheckBox,Q):(Q=A.radioButton)?L=zr(Ht.RadioButton,Q):(Q=A.slider)?L=zr(Ht.Slider,Q):(Q=A.colorPicker)?L=zr(Ht.ColorPicker,Q):(Q=A.image)&&(L=zr(Ht.Image,Q)),L&&(A.element=L)}},Xk=function(z,E){var g=ue(z);return g._ht=E,g},Pe=e.top===e?e.top:e||e.document,ue=function($,v){var K=m.createElement("div"),H=K.style;return K.tabIndex=-1,K.onkeydown=as,H.msTouchAction=Uh,jb(K,S,0),bc&&H.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",S),$&&(H.overflow=Ef),v&&wf(v,K),K},Zj=function(R,L){var V=m.createElement("canvas"),Y=V.style;return Y.msTouchAction=Uh,L||(Y.pointerEvents=Uh),jb(V,S,0),R&&wf(R,V),V},jb=function(y,a,E){var F=y.style;F.border=a?a+" solid 1px":0,F.outline=0,F.padding=E?"0 "+E+Kl:0,vp(y)},vp=function($){var i=$.style;i.position=vc,i.margin=0,i.setProperty("box-sizing","border-box",S),i.setProperty("-moz-box-sizing","border-box",S)},Vj=function(w,P,Y,t){t||(t=mf),P!=S&&(w.width=P*t,w.style.width=P+Kl),Y!=S&&(w.height=Y*t,w.style.height=Y+Kl)},wf=function(o,B,X){o.appendChild(B),X&&(B.style.position=vc)},yf=function(R,O){O.split||(O+="");for(var G,p=O.split("\n"),E=0,Y=p.length,N=0;Y>N;N++){var P=xs(R.font,p[N]);P.width>E&&(E=P.width),G||(G=P.height)}return R.ss=p,{width:E,height:G*Y}},kh=function(){var c=m?Zj().getContext("2d"):S;return function(y,e,D,K,P,W){var Q=y.split("\n"),Y=[],S=xs(D,y).height;return K||(K=0),c.font=D,c.textBaseline=Dr,Q.forEach(function(q){for(var d=0,s=1,Q=0,k=q.length;k>=s;s++){var C=q.substring(d,s),z=P?c.measureText(q[s]):xs(D,C);P&&(Q+=z.fontBoundingBoxDescent||S);var j=P?Q+(C.length-1)*W:z.width+(C.length-1)*K;j>e&&(s-1===d?(Y.push(q.substring(d,s)),d=s):(Y.push(q.substring(d,s-1)),d=s-1,s--),Q=0)}d!==s-1&&Y.push(q.substring(d,s))}),Y}}(),Tb=function(i,G,P,l,b,c,N,q){i.font=P;var L=i.measureText(G);if(i.beginPath(),i.strokeStyle=l,i.lineWidth=1,"underline"===q){var X;X=L.actualBoundingBoxDescent?L.actualBoundingBoxDescent+1:xs(P,G).size/2,i.moveTo(b-N/2,c+X),i.lineTo(b+N/2,c+X)}else if("strikethrough"===q)i.moveTo(b-N/2,c),i.lineTo(b+N/2,c);else if("overline"===q){var X;X=L.fontBoundingBoxAscent?L.fontBoundingBoxAscent:xs(P,G).size/2,i.moveTo(b-N/2,c-X),i.lineTo(b+N/2,c-X)}i.stroke()},Rf=function(l,I,t,X,N,u,L,B,f,Q,o){var k=N.x,Y=N.y,C=N.width,W=N.height;if(I!=S){var s=xs(t,I),G={};f&&(s.width+=(I.length-1)*f),G.y=L&&L!==hh?L===Dr?Y+s.height/2:Y+W-s.height/2:Y+W/2,G.x=u&&u!==Vn?u===_k?k+C-s.width/2:k+C/2:k+s.width/2,$e(l,I,G,t,X,f,Q,o),B&&Tb(l,I,t,X,G.x,G.y,s.width,B)}},rg=function(Q,h,q,t,E,J,I,W,B,N){var i=h.length;if(1===i){var V=h[0];if($e(Q,V,q,t,E,W,B,N),I){var r=xs(t,V);Tb(Q,V,t,E,q.x+q.width/2,q.y+q.height/2,r.width,I)}}else for(var w=q.height/i,H={x:q.x,y:q.y,width:q.width,height:w},P=0;P<h.length;P++){if(J)Rf(Q,h[P],t,E,H,J,null,I,W,B,N);else if($e(Q,h[P],H,t,E,W,B,N),I){var r=xs(t,h[P]);Tb(Q,h[P],t,E,H.x+H.width/2,H.y+H.height/2,r.width,I)}H.y+=w}},$e=function(g,f,J,Z,K,x,E,c){g.font=Z?Z:Mr,g.fillStyle=K?K:Ub,g.textAlign=al,g.textBaseline=hh;var B,D;J?J.width===W?(B=J.x,D=J.y):(B=J.x+J.width/2,D=J.y+J.height/2):(B=0,D=0);var Q=E&&c;if(Q&&(g.strokeStyle=c,g.lineWidth=E),x){var X=xs(Z,f);B-=(X.width+x*(f.length-1))/2;for(var I=(f+"").length,u=0;I>u;u++){var O=f[u],C=g.measureText(O);Q&&g.strokeText(O,b(B+(C.width+4)/2),b(D)),g.fillText(O,b(B+(C.width+4)/2),b(D)),B+=C.width+x}}else Q&&g.strokeText(f,b(B),b(D)),g.fillText(f,b(B),b(D))},nf=function(v){v.getView&&(v=v.getView());var Q=v.offsetWidth||v.scrollWidth;return!Q&&v.style.width&&(Q=fl(v.style.width)),Q},be=function(Y){Y.getView&&(Y=Y.getView());var G=Y.offsetHeight||Y.scrollHeight;return!G&&Y.style.height&&(G=fl(Y.style.height)),G},Ll=function(c,A,t){var s=A[0].toUpperCase()+A.substring(1,A.length);c["webkit"+s]=t,c["moz"+s]=t,c["ms"+s]=t,c["o"+s]=t,c[A]=t},Yj=function(){var i=function(G){as(G),G.stopPropagation()},V=function(i){as(i)},e=[Fh,wn,Lb];return function(o,R){var p=ue(),z=p.style;return z.backgroundColor=H.disabledBackground,o&&(z.backgroundImage="url("+o+")",z.backgroundPosition="50% 50%",z.backgroundRepeat="no-repeat no-repeat"),R===!1?e.forEach(function(s){Z(p,s,V)}):e.forEach(function(g){Z(p,g,i)}),p}}(),ed=function(C){var D=C.getContext("2d");return D.save(),D.lineCap=np,D.lineJoin=Ge,D},of=function(V,i,c,d){Tc(V,i*mf,c*mf),d*=mf,1!==d&&V.scale(d,d)},Tc=function(X,g,o){X.translate(g,o)},ef=function(g,u){u&&g.rotate(u)},Sp=function(q,b,Y){b===W&&(b=1),Y===W&&(Y=1),(1!==b||1!==Y)&&q.scale(b,Y)},uk=!1,O=Pe[os[1]+Ih[0]],cg=function(a){var u=m.activeElement;if(m.activeElement!==a){u&&u.forceOnblur&&u.forceOnblur();for(var C=[],d=a.parentNode;d;)C.push([d,d.scrollLeft,d.scrollTop]),d=d.parentNode;if(!uk){var r=[],$=[];try{for(var D=e.parent,E=e;D!==E;)r.push([D,D.scrollX,D.scrollY]),E=D,D=e.parent;var w=e.frameElement;if(w)for(var x=w.parentNode;x;)$.push([x,x.scrollLeft,x.scrollTop]),x=x.parentNode}catch(N){uk=!0}}if(bc)a.focus();else{var h=Gl(),c=h.target;a.focus(),c.scrollLeft=h.left,c.scrollTop=h.top}C.forEach(function(d){d[0].scrollLeft=d[1],d[0].scrollTop=d[2]}),uk||(r.forEach(function(K){K[0].scrollTo(K[1],K[2])}),$.forEach(function(G){G[0].scrollLeft=G[1],G[0].scrollTop=G[2]}))}},Nn=function(h){return h&&h.getView?h.getView():h},Pg=function(c,z,M,P,n){if(2===arguments.length&&(M=z.y,P=z.width,n=z.height,z=z.x),c.isSelfViewEvent)c.setX(z),c.setY(M),c.setWidth(P),c.setHeight(n);else{var J=Nn(c),x=J.style;if((m.fullscreenElement||m.mozFullScreenElement||m.webkitFullscreenElement||m.msFullscreenElement)!==J)z!==W&&(x.left=z+Kl),M!==W&&(x.top=M+Kl),P!==W&&(x.width=P+Kl),n!==W&&(x.height=n+Kl);else{var h=H.getWindowInfo();x.left=(z=h.left)+Kl,x.top=(M=h.top)+Kl,x.width=(P=h.width)+Kl,x.height=(n=h.height)+Kl}c.endEditing&&!bc&&c.endEditing(),c.redraw&&c.redraw(),c.invalidate&&c.invalidate(),c.onLayouted&&c.onLayouted(z,M,P,n),c.fireViewEvent&&c.fireViewEvent("layout")}},Pp=function(F){if(!F.touches)return F;var e=F.touches[0];return e?e:F.changedTouches[0]},Bj=function(X){return Aq(X)?Pp(X).target:X.target},Aq=function(Q){return Q&&"object"==typeof Q&&"touches"in Q},An=function(T){H.popup&&H.popup.close(),H.popup=T},nm=S,kb=function(L){nm.handleWindowTouchMove(L)},Yo=function(F){nm.handleWindowTouchEnd(F),N(e,nd,kb),N(e,hs,Yo),N(e,"blur",Yo),nm=S},yj=function(v){nm.handleWindowMouseMove(v)},cl=function(m){nm.handleWindowMouseUp(m),N(e,ag,yj),N(e,Cp,cl),N(e,"blur",cl),nm=S},Bn=function(H){return 1===Nc(H)},eq=function(j,o){return o?o.keyCode===j:$f[j]},xo=function(f){return Uj(f)&&eq(65,f)},zn=function(w){return eq(46,w)||eq(8,w)},Jp=function(e){return function(Y){return Y?Y.keyCode===e:$f[e]}},vi=573,vf=[65,83,68,87,37,38,39,40,32,13,27],Qc=Jp(vf[0]),Nq=Jp(vf[1]),jm=Jp(vf[2]),or=Jp(vf[3]),Lp=Jp(vf[4]),dl=Jp(vf[5]),Nr=Jp(vf[6]),Se=Jp(vf[7]),vr=Jp(vf[8]),Db=Jp(vf[9]),Jr=Jp(vf[10]),Vi={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},Pi=[2,2,2,2,2,2,2,2,2,2,2,2,3,3,5,5,5,5,5,5,19,151],Qe=S,Ik=S,mp=function(m,I){Qe||(Qe=Zj()),Vj(Qe,m,I,1);var f=ed(Qe);return f.clearRect(0,0,m,I),f},Yn=function(M,H,y){if(H&&M){if("override"===y)return H;if("override_rgb"===y){var C=Bp(H);return M=dr(M),"rgba("+b(255*C[0])+","+b(255*C[1])+","+b(255*C[2])+","+M[3]/255+")"}if("override_a"===y){var C=Bp(H);return M=dr(M),"rgba("+M[0]+","+M[1]+","+M[2]+","+C[3]+")"}if("multiply_destinationAtop"===y){var D=Dl(Bp(M)),a=D[3],w=Dl(Bp(H)),I=w[3],F=Dl(D),$=F[3],K=D.map(function(R,x){return R*w[x]}),Y=1-a,O=1-I,s=O*a+I;return D=D.map(function(j,Z){return(I*Y*w[Z]+I*a*K[Z]+O*a*j)/s}),a=s,Y=1-a,D=D.map(function(i,W){return($*F[W]*Y+a*i*$)/$}),a=$,"rgba("+b(255*D[0])+","+b(255*D[1])+","+b(255*D[2])+","+a+")"}var C=Bp(H);return M=dr(M),"rgba("+b(M[0]*C[0])+","+b(M[1]*C[1])+","+b(M[2]*C[2])+","+M[3]/255*C[3]+")"}return M},dr=function(){var I,G={};for(var m in e){var r=Rm.length;if(m.length==r&&m[0]===Rm[2]&&m[1]===Uh[1]&&m[4]===Rm[3]&&m[5]===Rm[4]&&m.substr(r-2)===Uh[1]+Uh[2]){var s=e[m];for(var J in s)J.length===r&&J.substr(0,3)===_k[3]+Wh[3]+jk[0]&&J.substr(r-2)===Rm[0]+Ml[3]&&(Hc=s[J])}}return function(X){var R,z=G[X];return z||(I||(I=Zj(),Vj(I,1,1,1)),R=I.getContext("2d"),R.clearRect(0,0,1,1),Xf(R,0,0,1,1,X),z=R.getImageData(0,0,1,1).data,z=G[X]=[z[0],z[1],z[2],z[3]]),z}}(),Bp=function(B){if(!xd(B))return B;var G=dr(B);return G.CA||(G.CA=[G[0]/255,G[1]/255,G[2]/255,G[3]/255]),G.CA},je=function(v,j,h,T,C){var U=Zj();U.width=h,U.height=T;var O=U.getContext("2d");O.drawImage(v,0,0,h,T);try{for(var c=O.getImageData(0,0,h,T),K=c.data,w=0,Z=K.length;Z>w;w+=4){var k=K[w+0],L=K[w+1],G=K[w+2],A=K[w+3];"override_a"===C?K[w+3]=255*j[3]:"override_rgb"===C?(K[w+0]=255*j[0],K[w+1]=255*j[1],K[w+2]=255*j[2]):"override"===C?(K[w+0]=255*j[0],K[w+1]=255*j[1],K[w+2]=255*j[2],K[w+3]=255*j[3]):(K[w+0]=j[0]*k,K[w+1]=j[1]*L,K[w+2]=j[2]*G,K[w+3]=j[3]*A)}O.putImageData(c,0,0)}catch(m){return v}return U},gk=function(O,n,X){return n&&(n="miter"===X?8*n+20:n+1,O&&Qf(O,n)),n},$m=function(X,v){if(v){var q=new ur(v),c=X.width/2,Z=X.height/2,w=Wk([q.tf(-c,-Z),q.tf(c,-Z),q.tf(c,Z),q.tf(-c,Z)]);return w.x+=X.x+c,w.y+=X.y+Z,w}return X},Tg=function(b,v,S,s,r,x,J,L){s*=Math.PI/180;var P={x:Math.cos(s)*(b.x-J.x)/2+Math.sin(s)*(b.y-J.y)/2,y:-Math.sin(s)*(b.x-J.x)/2+Math.cos(s)*(b.y-J.y)/2},j=Math.pow(P.x,2)/Math.pow(v,2)+Math.pow(P.y,2)/Math.pow(S,2);j>1&&(v*=Math.sqrt(j),S*=Math.sqrt(j));var V=(r==x?-1:1)*Math.sqrt((Math.pow(v,2)*Math.pow(S,2)-Math.pow(v,2)*Math.pow(P.y,2)-Math.pow(S,2)*Math.pow(P.x,2))/(Math.pow(v,2)*Math.pow(P.y,2)+Math.pow(S,2)*Math.pow(P.x,2)));isNaN(V)&&(V=0);var H={x:V*v*P.y/S,y:V*-S*P.x/v},U={x:(b.x+J.x)/2+Math.cos(s)*H.x-Math.sin(s)*H.y,y:(b.y+J.y)/2+Math.sin(s)*H.x+Math.cos(s)*H.y},k=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2))},w=function(d,_){return(d[0]*_[0]+d[1]*_[1])/(k(d)*k(_))},t=function(n,p){return(n[0]*p[1]<n[1]*p[0]?-1:1)*Math.acos(w(n,p))},o=t([1,0],[(P.x-H.x)/v,(P.y-H.y)/S]),p=[(P.x-H.x)/v,(P.y-H.y)/S],O=[(-P.x-H.x)/v,(-P.y-H.y)/S],N=t(p,O);w(p,O)<=-1&&(N=Math.PI),w(p,O)>=1&&(N=0);var w=v>S?v:S,m=v>S?1:v/S,Q=v>S?S/v:1;if(null==L){var z={x:0,y:0,width:0,height:0};Qf(z,w),z.x*=m,z.width*=m,z.y*=Q,z.height*=Q;var d=new ur(s);return z=Wk([d.tf(z.x,z.y),d.tf(z.x+z.width,z.y),d.tf(z.x+z.width,z.y+z.height),d.tf(z.x,z.y+z.height)]),z.x+=U.x,z.y+=U.y,[{x:z.x,y:z.y},{x:z.x+z.width,y:z.y},{x:z.x+z.width,y:z.y+z.height},{x:z.x,y:z.y+z.height}]}L.translate(U.x,U.y),L.rotate(s),L.scale(m,Q),L.arc(0,0,w,o,o+N,1-x),L.scale(1/m,1/Q),L.rotate(-s),L.translate(-U.x,-U.y)},Oh=function(r,F){r&&r.beginPath();for(var P,s,R,y=[],M=function(H){for(var j,x=/(\-{0,1}[\d\.]+)/gi,m=[];j=x.exec(H);)m.push(parseFloat(j[0]));return m},b=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,V={x:0,y:0};P=b.exec(F);){var o=P[0],l=o.substr(0,1);if("M"===l||"m"===l){for(var N=M(o),L=0;L<N.length;L+=2){var Y=N[L],C=N[L+1];"m"===l&&(Y+=V.x,C+=V.y),r&&r.moveTo(Y,C),y.push({x:Y,y:C}),V.x=Y,V.y=C}s=R=null}else if("H"===l||"h"===l){for(var N=M(o),L=0;L<N.length;L+=1){var Y=N[L];"h"===l&&(Y+=V.x),r&&r.lineTo(Y,V.y),y.push({x:Y,y:V.y}),V.x=Y}s=R=null}else if("C"===l||"c"===l){for(var N=M(o),L=0;L<N.length;L+=6){var T=N[L],J=N[L+1],a=N[L+2],D=N[L+3],Y=N[L+4],C=N[L+5];"c"===l&&(T+=V.x,J+=V.y,a+=V.x,D+=V.y,Y+=V.x,C+=V.y),r&&r.bezierCurveTo(T,J,a,D,Y,C),y.push({x:T,y:J}),y.push({x:a,y:D}),y.push({x:Y,y:C}),V.x=Y,V.y=C}s=[T,J,a,D,Y,C],R=null}else if("S"===l||"s"===l){for(var N=M(o),L=0;L<N.length;L+=4){var T,J;s?(T=2*s[4]-s[2],J=2*s[5]-s[3]):(T=V.x,J=V.y);var a=N[L],D=N[L+1],Y=N[L+2],C=N[L+3];"s"===l&&(a+=V.x,D+=V.y,Y+=V.x,C+=V.y),r&&r.bezierCurveTo(T,J,a,D,Y,C),y.push({x:T,y:J}),y.push({x:a,y:D}),y.push({x:Y,y:C}),V.x=Y,V.y=C}s=[T,J,a,D,Y,C],R=null}else if("Q"===l||"q"===l){for(var N=M(o),L=0;L<N.length;L+=4){var T=N[L],J=N[L+1],Y=N[L+2],C=N[L+3];"q"===l&&(T+=V.x,J+=V.y,Y+=V.x,C+=V.y),r&&r.quadraticCurveTo(T,J,Y,C),y.push({x:T,y:J}),y.push({x:Y,y:C}),V.x=Y,V.y=C}s=null,R=[T,J,Y,C]}else if("T"===l||"t"===l){for(var N=M(o),L=0;L<N.length;L+=2){var T,J;R?(T=2*R[2]-R[0],J=2*R[3]-R[1]):(T=V.x,J=V.y);var Y=N[L],C=N[L+1];"t"===l&&(Y+=V.x,C+=V.y),r&&r.quadraticCurveTo(T,J,Y,C),y.push({x:T,y:J}),y.push({x:Y,y:C}),V.x=Y,V.y=C}s=null,R=[T,J,Y,C]}else if("V"===l||"v"===l){for(var N=M(o),L=0;L<N.length;L+=1){var C=N[L];"v"===l&&(C+=V.y),r&&r.lineTo(V.x,C),y.push({x:V.x,y:C}),V.y=C}s=R=null}else if("L"===l||"l"===l){for(var N=M(o),L=0;L<N.length;L+=2){var Y=N[L],C=N[L+1];"l"===l&&(Y+=V.x,C+=V.y),r&&r.lineTo(Y,C),y.push({x:Y,y:C}),V.x=Y,V.y=C}s=R=null}else if("A"===l||"a"===l){for(var N=M(o),L=0;L<N.length;L+=7){var j=N[L],w=N[L+1],g=N[L+2],X=N[L+3],h=N[L+4],Y=N[L+5],C=N[L+6];"a"===l&&(Y+=V.x,C+=V.y);var S=Tg(V,j,w,g,X,h,{x:Y,y:C},r);S&&(y=y.concat(S)),V.x=Y,V.y=C}s=R=null}var $=o.substr(o.length-1);("z"===$||"Z"===$)&&r&&r.closePath()}return y},Id=function(l,G,V,h,q){var W,z=G[0];if(l.save(),Td(G))if(z&&1===z.length){var X,u="L"===G[0],Q=G.length;u?(l.transform(G[5],G[6],G[7],G[8],G[9],G[10]),W=l.createLinearGradient(G[1],G[2],G[3],G[4]),X=11):(l.transform(G[7],G[8],G[9],G[10],G[11],G[12]),W=l.createRadialGradient(G[1],G[2],G[3],G[4],G[5],G[6]),X=13);for(var K=l.compGray;Q>X;){var T=G[X+1];T=V(T),W.addColorStop(G[X],K?H.toGrayColor(T):T),X+=2}}else{var X,u="linear"===z,N=q.x,k=q.y,A=q.width,j=q.height,Q=G.length,K=l.compGray;if(u)W=l.createLinearGradient(N+A*G[1],k+j*G[2],N+A*G[3],k+j*G[4]),X=5;else{var i=Math.min(A,j),L=G[1]*A+N,O=G[2]*j+k,v=G[3]*i;if(xd(G[5]))W=l.createRadialGradient(L,O,0,L,O,v),X=4;else{l.transform(G[7],G[8],G[9],G[10],G[11]+L,G[12]+O);var o=G[4]*A+N-L,f=G[5]*j+k-O,y=G[6]*i;W=l.createRadialGradient(0,0,v,o,f,y),X=13}}for(;Q>X;){var T=G[X+1];T=V(T),W.addColorStop(G[X],K?H.toGrayColor(T):T),X+=2}}else W=G;return h?l.strokeStyle=W:l.fillStyle=W,W},qs=function(){function a(Z,y){var S=Z.length,V=Z[0];if(xd(Z)||V&&1!==V.length)return Z;for(var N=new Array(S),f=0;S>f;f++)N[f]=Z[f];var p,Q,d,Y,r,K,c,O,L,s,n,q,v,M="L"===N[0];return p=M?5:7,Q=N[p],d=N[p+1],Y=N[p+2],r=N[p+3],K=N[p+4],c=N[p+5],O=y[0],L=y[1],s=y[2],n=y[3],q=y[4],v=y[5],N[p]=O*Q+s*d,N[p+1]=L*Q+n*d,N[p+2]=O*Y+s*r,N[p+3]=L*Y+n*r,N[p+4]=O*K+s*c+q,N[p+5]=L*K+n*c+v,N}return function(o,D){var P;(P=o.s("shape.gradient.pack"))&&o.s("shape.gradient.pack",a(P,D)),(P=o.s("shape.border.gradient.pack"))&&o.s("shape.border.gradient.pack",a(P,D))}}(),$j=function(o,Y,t,$){var R=!1;if(o.beginPath?o.beginPath():R=!0,No(Y)&&(Y=Y._as),No(t)&&(t=t._as),t&&t.length){for(var O,U,_,A,q=0,V=0,c=t.length;c>V;V++)O=t[V],1===O?(U=Y[q++],o.moveTo(U.x,R?-U.y:U.y)):2===O?(U=Y[q++],o.lineTo(U.x,R?-U.y:U.y)):3===O?(U=Y[q++],_=Y[q++],o.quadraticCurveTo(U.x,R?-U.y:U.y,_.x,R?-_.y:_.y)):4===O?(U=Y[q++],_=Y[q++],A=Y[q++],o.bezierCurveTo(U.x,R?-U.y:U.y,_.x,R?-_.y:_.y,A.x,R?-A.y:A.y)):5===O&&o.closePath();$&&5!==O&&o.closePath()}else{var s,a,I,n=Y.length;if(n>0){for(s=Y[0],o.moveTo(s.x,R?-s.y:s.y),a=1;n>a;a++)I=Y[a],o.lineTo(I.x,R?-I.y:I.y);$&&o.closePath()}}},Wo=function(H,f,k,g){if(No(H)&&(H=H._as),No(f)&&(f=f._as),f&&f.length){k=k||Rc;for(var h,N,R,V,s,U,q,Z,n=[],T=S,F=0,A=0,u=f.length;u>A;A++)if(h=f[A],1===h)n.push(T=[]),T.push(H[F++]);else if(2===h)T.push(H[F++]);else if(3===h){for(N=T[T.length-1],R=H[F++],V=H[F++],U=1;k>U;U++)q=En(U/k,N.x,R.x,V.x),Z=En(U/k,N.y,R.y,V.y),T.push({x:q,y:Z,b:!0});
T.push(V)}else if(4===h){for(N=T[T.length-1],R=H[F++],V=H[F++],s=H[F++],U=1;k>U;U++)q=kc(U/k,N.x,R.x,V.x,s.x),Z=kc(U/k,N.y,R.y,V.y,s.y),T.push({x:q,y:Z,b:!0});T.push(s)}else 5===h&&T.push(T[0]);return g&&5!==h&&T&&T.length>2&&T.push(T[0]),n}return g&&H.length>2&&(H=H.slice(),H.push(H[0])),H?[H]:[]},vl=function(C,D,O,B,w,S){var J,v,j,e=dr(D),g=B,Q=e[0],$=e[1],G=e[2];if(O){var r=dr(O);J=r[0]-Q,v=r[1]-$,j=r[2]-G}else J=255-Q,v=255-$,j=255-G;for(S||(S=B>10?1:.5,S=1>w?_(S/w,2):S),C.save(),C.shadowOffsetX=0,C.shadowOffsetY=0,C.shadowBlur=0,C.shadowColor=0;(B-=S)>0;){var A=1-B/g,V=Q+J*A,I=$+v*A,f=G+j*A;V=_(k(V),255),I=_(k(I),255),f=_(k(f),255),C.strokeStyle="rgb("+V+","+I+","+f+")",C.lineWidth=B,C.stroke()}C.restore()},Ch=function(){if(Pk&&p){var c=p+""||hd;Lc=c.indexOf(Ef.substr(0,2))>0&&c.indexOf(Dr+Dr.substr(1,1))>1?!0:!1}var R={};return function(q,E){var I=q+"-"+E,Q=R[I];if(Q)return Q;var G,e,U,h=dr(q);return 0>E?(E=(100+E)/100,G=k(h[0]*E),e=k(h[1]*E),U=k(h[2]*E)):(E/=100,G=h[0],e=h[1],U=h[2],G+=(255-G)*E,e+=(255-e)*E,U+=(255-U)*E,G=_(k(G),255),e=_(k(e),255),U=_(k(U),255)),R[I]="rgb("+G+","+e+","+U+")"}}(),Xf=function(w,A,j,v,e,B){B&&(w.fillStyle=B),w.beginPath(),w.rect(A,j,v,e),w.fill()},Dj=function(V,a,y,m,H,u,G){V.beginPath(),$p[a](V,y.x,y.y,y.width,y.height,m,H,u,G)},vh=function(Z,h,N,I,c){var K=$p[N];Z.fillStyle=K?K(Z,h,I?I:kl,c.x,c.y,c.width,c.height):h},Cb=function(B,U,N,M,F,l){B.fillStyle=Ho(B,U,N,M,F,l)},ro=function(A,D,j,v,N,I){A.strokeStyle=Ho(A,D,j,v,N,I)},Ho=function(f,Z,y,W,C,P){var K;try{if(!Z.tagName&&Z.comps){Z._cacheImage_||(Z._cacheImage_={});var w;w="override"===W?"colors_override":"override_rgb"===W?"colors_override_rgb":"override_a"===W?"colors_override_a":"colors",Z._cacheImage_[w]||(Z._cacheImage_[w]={__count__:0});var E=Z._cacheImage_[w][y];E||(Z._cacheImage_[w].__count__>H.imageCacheThreshold&&(Z._cacheImage_[w]={__count__:0}),E=n.Default.toCanvas(Z,lm(Z),qj(Z),null,C,P,y,null,W),Z._cacheImage_[w][y]=E,Z._cacheImage_[w].__count__++),Z=E}K=f.createPattern(Z,"repeat")}catch(I){K="black"}return K},rh=function(K){var X,G,p=[],z=0,P=K.length;for(X=0;65>X;X++)p[X]=X;for(X=0;65>X;X++)z=(z+p[X]+K.charCodeAt(X%P))%65,G=p[X],p[X]=p[z],p[z]=G;for(X=0;65>X;X++)p[X]=gc[p[X]];return p.join("")},Vm=function(I){for(var $=8+Po.randomInt(8),Y=gc[8*Po.randomInt(8)+($-8)],p="",n=0;$>n;n++)p+=gc[Po.randomInt(64)];var P=rh(p+V+Ap+Yq);return Y+p+Gp.encode(I,P)},fk=function(f){var n=f[0],v=gc.indexOf(n);if(0>v)return"";v=8+(7&v);var z=f.slice(1,1+v),h=rh(z+V+Ap+Yq);return Gp.decode(f,h,1+v)},Qg=function(i,E,s,f,X,c,N){i.save(),i.translate(E,s),i.scale(1,N/c),i.arc(0,0,c,f,X),i.restore()},ne=function(D,Q,o,V,S,a,U,r){var e,n,g,b,q,L,N,Z,t,z,F;if(v(S)>2*X&&(S=2*X),q=k(v(S)/(X/4)),e=S/q,n=-e,g=-V,q>0){L=Q+s(V)*a,N=o+R(-V)*U,r?D.lineTo(L,N):D.moveTo(L,N);for(var $=0;q>$;$++)g+=n,b=g-n/2,Z=Q+s(g)*a,t=o+R(g)*U,z=Q+s(b)*(a/s(n/2)),F=o+R(b)*(U/s(n/2)),D.quadraticCurveTo(z,F,Z,t)}},Hf=function(T,p,H,L,h,A,R,F,D){6===arguments.length&&(Td(A)?(F=A[1],D=A[2],R=A[3],A=A[0]):(R=A,F=A,D=A));var Y=p+L,i=H+h,_=h>L?2*L:2*h;A=_>A?A:_,R=_>R?R:_,F=_>F?F:_,D=_>D?D:_,T.moveTo(p+L/2,H),T.arcTo(Y,H,Y,i,R),T.arcTo(Y,i,p,i,D),T.arcTo(p,i,p,H,F),T.arcTo(p,H,Y,H,A),T.lineTo(p+L/2,H)},Qd=function(u,P,s,A,X,L,c){P&&(s=b(s),A=b(A),c||(c=1),u.fillStyle=P,u.beginPath(),u.rect(s,A,c,L),u.rect(s,A,X,c),L-c>0&&u.rect(s,A+L-c,X,c),X-c>0&&u.rect(s+X-c,A,c,L),u.fill())},Ug=function(Q,g,q,D){var a=D.x,P=D.y,u=D.width,m=D.height;if(!(!g||!q||0>=u||0>=m)){var i,C=Vd(g),j=tb(g),G=q>0;1===q||-1===q?(Q.fillStyle=G?C:j,Q.beginPath(),Q.rect(a,P,1,m),Q.rect(a,P,u,1),Q.fill(),Q.fillStyle=G?j:C,Q.beginPath(),Q.rect(a,P+m-1,u,1),Q.rect(a+u-1,P,1,m),Q.fill()):(q=_(v(q),_(u/2,m/2)),i=Q.createLinearGradient(a,P,a+q,P),i.addColorStop(0,G?C:j),i.addColorStop(1,g),Q.fillStyle=i,Q.beginPath(),Q.moveTo(a,P),Q.lineTo(a+q,P+q),Q.lineTo(a+q,P+m-q),Q.lineTo(a,P+m),Q.lineTo(a,P),Q.fill(),i=Q.createLinearGradient(a,P,a,P+q),i.addColorStop(0,G?C:j),i.addColorStop(1,g),Q.fillStyle=i,Q.beginPath(),Q.moveTo(a,P),Q.lineTo(a+q,P+q),Q.lineTo(a+u-q,P+q),Q.lineTo(a+u,P),Q.lineTo(a,P),Q.fill(),i=Q.createLinearGradient(a,P+m,a,P+m-q),i.addColorStop(0,G?j:C),i.addColorStop(1,g),Q.fillStyle=i,Q.beginPath(),Q.moveTo(a,P+m),Q.lineTo(a+q,P+m-q),Q.lineTo(a+u-q,P+m-q),Q.lineTo(a+u,P+m),Q.lineTo(a,P+m),Q.fill(),i=Q.createLinearGradient(a+u,P,a+u-q,P),i.addColorStop(0,G?j:C),i.addColorStop(1,g),Q.fillStyle=i,Q.beginPath(),Q.moveTo(a+u,P),Q.lineTo(a+u-q,P+q),Q.lineTo(a+u-q,P+m-q),Q.lineTo(a+u,P+m),Q.lineTo(a+u,P),Q.fill())}},Qq=function(L,l,q,A,n,m,d){var T=L.createLinearGradient(A,n,m,d);return T.addColorStop(0,q),T.addColorStop(1,l),T},gg=function(F,D,N,i,m,R,v){var H=F.createLinearGradient(i,m,R,v);return H.addColorStop(0,D),H.addColorStop(.5,N),H.addColorStop(1,D),H},lk=function(D,w,W,b,g,h,T){var o=D.createLinearGradient(b,g,h,T);return o.addColorStop(0,w),o.addColorStop(1/3,W),o.addColorStop(2/3,w),o.addColorStop(1,W),o},bo=function(l,B,w,I,n,b,H,W,N){var r=l.createRadialGradient(I+b*W,n+H*N,_(b,H)/24,I+b/2,n+H/2,g(b,H)/2);return r.addColorStop(0,w),r.addColorStop(1,B),r},Cq=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],$p={polygon:function(F,V,H,M,G,n,l,Y){(n==S||3>n)&&(n=6),l==S&&(l=0),Y==S&&(Y=!0);var g,u=_(M,G),m=u/2,$=new Ai(V+M/2,H+G/2),T=new Ai,k=0,c=2*X/n,w=new Ai(m,m);if(Y===!1&&w.multiply({x:M/u,y:G/u}),0===l)for(g=0;n>g;g++)T.set(s(k),R(k)).multiply(w).add($),0===g?F.moveTo(T.x,T.y):F.lineTo(T.x,T.y),k+=c;else{var j=[];for(g=0;2>g;g++)j.push(new Ai(s(k),R(k)).multiply(w).add($)),k+=c;var A=j.shift(),r=j[0],e=new Ai(s(k),R(k)).multiply(w).add($),y=A.clone().sub(r),K=e.clone().sub(r),i=y.clone().normalize().dot(K.clone().normalize()),Q=Math.sqrt((1-i)/(1+i)),I=l/Q;for(y.setLength(I).add(r),F.moveTo(y.x,y.y),g=0;n>g;g++)j.push(new Ai(s(k),R(k)).multiply(w).add($)),k+=c,A=j.shift(),r=j[0],F.arcTo(A.x,A.y,r.x,r.y,l)}F.closePath()},arc:function(r,R,Q,K,o,u,p,Z,J){u==S&&(u=X),p==S&&(p=z),Z==S&&(Z=!0);var t=R+K/2,F=Q+o/2;Z&&r.moveTo(t,F),J?Qg(r,t,F,u,p,K/2,o/2):r.arc(t,F,_(K,o)/2,u,p),Z&&r.closePath()},rect:function(d,g,Q,W,o){d.rect(g,Q,W,o)},circle:function(j,P,J,w,H){j.arc(P+w/2,J+H/2,_(w,H)/2,0,z,!0)},oval:function($,b,V,Y,L){Qg($,b+Y/2,V+L/2,0,z,Y/2,L/2)},roundRect:function(Q,p,Y,i,Z,x){x==S&&(x=_(_(i,Z)/4,8)),Hf(Q,p,Y,i,Z,x),Q.closePath()},star:function(e,z,t,u,R){var d=2*u,C=2*R,E=z+u/2,N=t+R/2;e.moveTo(E-d/4,N-C/12),e.lineTo(z+.306*u,t+.579*R),e.lineTo(E-d/6,N+C/4),e.lineTo(z+u/2,t+.733*R),e.lineTo(E+d/6,N+C/4),e.lineTo(z+.693*u,t+.579*R),e.lineTo(E+d/4,N-C/12),e.lineTo(z+.611*u,t+.332*R),e.lineTo(E+0,N-C/4),e.lineTo(z+.388*u,t+.332*R),e.closePath()},pentagram:function(D,v,A,$,W){var u=.5*W,m=v+.5*$,j=A+u,b=.5257311121191336*$;b>u&&(b=u);var O=Cq,Q=0;for(D.moveTo(m+b*O[Q++],j+b*O[Q++]);20>Q;)D.lineTo(m+b*O[Q++],j+b*O[Q++]);D.closePath()},triangle:function(M,i,o,m,y){M.moveTo(i+m/2,o),M.lineTo(i+m,o+y),M.lineTo(i,o+y),M.closePath()},hexagon:function(i,h,I,W,g){i.moveTo(h,I+g/2),i.lineTo(h+W/4,I+g),i.lineTo(h+3*W/4,+I+g),i.lineTo(h+W,I+g/2),i.lineTo(h+3*W/4,I),i.lineTo(h+W/4,I),i.closePath()},pentagon:function(F,V,y,G,D){var Y=2*G,T=2*D,B=V+G/2,M=y+D/2;F.moveTo(B-Y/4,M-T/12),F.lineTo(B-Y/6,M+T/4),F.lineTo(B+Y/6,M+T/4),F.lineTo(B+Y/4,M-T/12),F.lineTo(B+0,M-T/4),F.closePath()},diamond:function(o,g,L,s,N){o.moveTo(g+s/2,L),o.lineTo(g,L+N/2),o.lineTo(g+s/2,L+N),o.lineTo(g+s,L+N/2),o.closePath()},rightTriangle:function(N,T,B,g,V){N.moveTo(T,B),N.lineTo(T+g,B+V),N.lineTo(T,B+V),N.closePath()},parallelogram:function(L,I,f,b,$){var w=b/4;L.moveTo(I+w,f),L.lineTo(I+b,f),L.lineTo(I+b-w,f+$),L.lineTo(I,f+$),L.closePath()},trapezoid:function(K,O,x,o,W){var l=o/4;K.moveTo(O+l,x),K.lineTo(O+o-l,x),K.lineTo(O+o,x+W),K.lineTo(O,x+W),K.closePath()},"linear.southwest":function(y,B,G,J,n,N,g){return Qq(y,B,G,J,n+g,J+N,n)},"linear.southeast":function(H,b,z,e,d,r,v){return Qq(H,b,z,e+r,d+v,e,d)},"linear.northwest":function(z,R,Z,G,Y,t,n){return Qq(z,R,Z,G,Y,G+t,Y+n)},"linear.northeast":function(L,Y,z,m,Z,f,I){return Qq(L,Y,z,m+f,Z,m,Z+I)},"linear.north":function(h,O,H,_,l,y,n){return Qq(h,O,H,_,l,_,l+n)},"linear.south":function(V,p,R,F,E,G,o){return Qq(V,p,R,F,E+o,F,E)},"linear.west":function(p,E,X,S,e,v){return Qq(p,E,X,S,e,S+v,e)},"linear.east":function(R,X,b,K,S,J){return Qq(R,X,b,K+J,S,K,S)},"radial.center":function(W,t,p,X,C,n,$){return bo(W,t,p,X,C,n,$,.5,.5)},"radial.southwest":function($,t,d,W,N,z,i){return bo($,t,d,W,N,z,i,.25,.75)},"radial.southeast":function(r,P,y,q,H,X,F){return bo(r,P,y,q,H,X,F,.75,.75)},"radial.northwest":function(s,K,v,R,l,q,n){return bo(s,K,v,R,l,q,n,.25,.25)},"radial.northeast":function($,I,D,X,Z,w,c){return bo($,I,D,X,Z,w,c,.75,.25)},"radial.north":function(E,B,M,g,F,Y,r){return bo(E,B,M,g,F,Y,r,.5,.25)},"radial.south":function(T,l,M,S,Q,v,Y){return bo(T,l,M,S,Q,v,Y,.5,.75)},"radial.west":function(D,I,q,K,t,C,W){return bo(D,I,q,K,t,C,W,.25,.5)},"radial.east":function(Q,x,H,u,S,o,d){return bo(Q,x,H,u,S,o,d,.75,.5)},"spread.horizontal":function(k,B,W,O,V,r){return gg(k,B,W,O,V,O+r,V)},"spread.vertical":function(x,U,h,e,v,y,G){return gg(x,U,h,e,v,e,v+G)},"spread.diagonal":function(q,u,n,x,I,r,f){return gg(q,u,n,x+r,I,x,I+f)},"spread.antidiagonal":function(M,O,f,Z,a,Y,s){return gg(M,O,f,Z,a,Z+Y,a+s)},"spread.north":function(R,N,d,f,K,r,F){return lk(R,N,d,f,K-F/4,f,K+F+F/4)},"spread.south":function(o,B,N,T,n,F,r){return lk(o,N,B,T,n-r/4,T,n+r+r/4)},"spread.west":function(E,z,P,x,J,O){return lk(E,z,P,x-O/4,J,x+O+O/4,J)},"spread.east":function(F,K,g,R,w,y){return lk(F,g,K,R-y/4,w,R+y+y/4,w)}},rd=function(c,J,$){return new ur(c).tf(J,$)},Ur=function(N){var M=N.touches[0],k=N.touches[1],P=M.clientX,m=M.clientY,F=k.clientX,Y=k.clientY;return x((P-F)*(P-F)+(m-Y)*(m-Y))},Ii=function(Y){var b=Y.touches[0],r=Y.touches[1],$=b.clientX,Q=b.clientY,e=r.clientX,E=r.clientY;return{x:($+e)/2,y:(Q+E)/2}},cc=(function(){for(var k=0,z=$d.split(""),g=0;g<z.length;g++)k=10*fl(z[g])+k;return dg(e[vi.toString(8*g)+Jo.substr(g)+3],e[vi.toString(8*g)+Jo.substr(g)+4]),k}(),function(Y,X,K){for(var a=0;a<K.size();a++){var k=K.get(a);Y.co(k)&&X.add(k)}for(a=0;a<K.size();a++)k=K.get(a),cc(Y,X,k._children)}),pd=function(K,n,H){for(var G=0;G<H.size();G++){var V=H.get(H.size()-1-G);K.co(V)&&n.add(V)}for(G=0;G<H.size();G++)V=H.get(G),pd(K,n,V._children)},Bm=function(Z,d,j){for(var y=!1,m=0;m<j.size();m++){var Q=j.get(m);Z.co(Q)?y&&d.add(Q):y=1}for(m=0;m<j.size();m++)Q=j.get(m),Bm(Z,d,Q._children)},ei=function(q,M,R){for(var m=!1,$=0;$<R.size();$++){var y=R.get(R.size()-1-$);q.co(y)?m&&M.add(y):m=!0}for($=0;$<R.size();$++)y=R.get($),ei(q,M,y._children)},Qk=H.moveDatas=function(e,C,V,n){var Y=n==S;if(0!==C||0!==V||!Y&&0!==n){var X=!0,m=[];if(e.forEach(function(P){X&&(P._69O||tl(P)||rj(P))&&(X=!1)}),X)m=e;else{var P={},o={};e.forEach(function(A){P[A._id]=!0});var B={},U=function(f){var r=f._id;return P[r]?(m.push(f),B[r]=!0):B[r]=!1},N=function(D){var m=D._id;if(o[m])return U(D);var c=B[m];if(c!==W)return c;var k=D._parent;if(k&&(rj(k)||tl(k))&&N(k))return B[m]=!0;var b=D._host;return b&&(o[m]=m,c=N(b),o[m]=W,c)?B[m]=!0:U(D)};e.forEach(function(w){N(w)})}m.forEach(function(Q){if(af(Q))Y?Q.translate(C,V):Q.translate3d(C,V,n);else{var t=Q.s(Fd);if(!t||t.isEmpty())return;var O=new Xd;t.each(function(v){v=Dl(v),Y?(v.x+=C,v.y+=V):(v.x+=C,v.y+=n,v.e==S?v.e=V:v.e+=V),O.add(v)}),Q.s(Fd,O)}})}},kf=function(){function T(g,d){return d===g.substring(0,d.length)?!0:!1}function B(S){return parseFloat(S)||0}function t(j,x){if(x==W&&(x=new xn),T(j,"matrix3d")){var k=j.substring(9,j.length-1).split(",");k=k.map(B),x.fromArray(k)}else if(T(j,"matrix")){var k=j.substring(7,j.length-1).split(",");k=k.map(B),x.el[0]=k[0],x.el[1]=k[1],x.el[2]=0,x.el[3]=0,x.el[4]=k[2],x.el[5]=k[3],x.el[6]=0,x.el[7]=0,x.el[8]=0,x.el[9]=0,x.el[10]=1,x.el[11]=0,x.el[12]=k[4],x.el[13]=k[5],x.el[14]=0,x.el[15]=1}return x}function K(L,q){q==W&&(q=new se);var F=L.split(/\s+/);return F=F.map(B),q.set(F[0]||0,F[1]||0,F[2]||0),q}var Y,D,n,$,u,x=function(y,d){Y||(Y=new xn,D=new se,n=new xn,$=new xn,u=new xn),d==W&&(d=new xn);var X=getComputedStyle(y);X.transform&&"none"!==X.transform&&(t(X.transform,Y),K(X.transformOrigin,D),$.setPosition(D),D.negate(),u.setPosition(D),(Ni||"preserve-3d"!==X.transformStyle)&&(Y.el[8]=0,Y.el[9]=0,Y.el[10]=1,Y.el[11]=0),d.multiplyMatrices(u,d),d.multiplyMatrices(Y,d),d.multiplyMatrices($,d)),!Ni&&X.perspective&&"none"!==X.perspective&&(n.el[11]=-1/B(X.perspective),K(X.perspectiveOrigin,D),$.setPosition(D),D.negate(),u.setPosition(D),d.multiplyMatrices(u,d),d.multiplyMatrices(n,d),d.multiplyMatrices($,d));for(var M=y.offsetParent,F=y.offsetLeft,R=y.offsetTop,l=y.parentElement;l&&l!==M;){var H=getComputedStyle(l);if("none"!==H.transform||"none"!==H.perspective)break;l=l.parentElement}return l==W&&y!==y.ownerDocument.documentElement&&"fixed"!==X.position&&(l=y.ownerDocument.documentElement),M!=W&&M!==l&&(F-=l.offsetLeft,R-=l.offsetTop),D.set(F,R,0),$.setPosition(D),d.multiplyMatrices($,d),l&&x(l,d),d};return function(p,Y){var Q=p.parentElement;if(Q){var j=Q.updateAppendMatrix;if(j){delete Q.updateAppendMatrix;var $=new xn;x(Q,$);var w=new xn;w.getInverse($),Q._matrixAppend=w,Q._maxrixPreAppend=$}return Y?Q._matrixAppend:Q._maxrixPreAppend}}}(),Hq=function(y,r){for(;y&&!y.hasOwnProperty(r);)y=o.getPrototypeOf(y);return y&&o.getOwnPropertyDescriptor(y,r)},pe=o.getPrototypeOf?function(i,A,_){var z=Hq(A,_);z&&o.defineProperty(i,_,z)}:function(C,q,z){C[z]=q[z]},Lq={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},Cs=function(){var B={1:function(c,t){return{x:c.x-t.width/2,y:c.y-t.height/2}},2:function(Z,b){return{x:Z.x+b.width/2,y:Z.y-b.height/2}},3:function(u,w){return{x:u.x+u.width/2,y:u.y-w.height/2}},4:function(v,D){return{x:v.x+v.width-D.width/2,y:v.y-D.height/2}},5:function(m,l){return{x:m.x+m.width+l.width/2,y:m.y-l.height/2}},6:function(S){return{x:S.x,y:S.y}},7:function(g){return{x:g.x+g.width/2,y:g.y}},8:function(u){return{x:u.x+u.width,y:u.y}},9:function(q,E){return{x:q.x-E.width/2,y:q.y+E.height/2}},10:function(_,N){return{x:_.x+N.width/2,y:_.y+N.height/2}},11:function(U,L){return{x:U.x+U.width/2,y:U.y+L.height/2}},12:function(M,Q){return{x:M.x-Q.width/2+M.width,y:M.y+Q.height/2}},13:function(u,i){return{x:u.x+u.width+i.width/2,y:u.y+i.height/2}},14:function(_,l){return{x:_.x-l.width/2,y:_.y+_.height/2}},15:function(a){return{x:a.x,y:a.y+a.height/2}},16:function(h,g){return{x:h.x+g.width/2,y:h.y+h.height/2}},17:function(m){return{x:m.x+m.width/2,y:m.y+m.height/2}},18:function(l,U){return{x:l.x+l.width-U.width/2,y:l.y+l.height/2}},19:function(x){return{x:x.x+x.width,y:x.y+x.height/2}},20:function(O,C){return{x:O.x+O.width+C.width/2,y:O.y+O.height/2}},21:function(w,V){return{x:w.x-V.width/2,y:w.y+w.height-V.height/2}},22:function(J,T){return{x:J.x+T.width/2,y:J.y+J.height-T.height/2}},23:function(j,y){return{x:j.x+j.width/2,y:j.y+j.height-y.height/2}},24:function(h,V){return{x:h.x+h.width-V.width/2,y:h.y+h.height-V.height/2}},25:function(G,p){return{x:G.x+G.width+p.width/2,y:G.y+G.height-p.height/2}},26:function(x){return{x:x.x,y:x.y+x.height}},27:function(V){return{x:V.x+V.width/2,y:V.y+V.height}},28:function(C){return{x:C.x+C.width,y:C.y+C.height}},29:function(V,w){return{x:V.x-w.width/2,y:V.y+V.height+w.height/2}},30:function(I,V){return{x:I.x+V.width/2,y:I.y+I.height+V.height/2}},31:function(x,e){return{x:x.x+x.width/2,y:x.y+x.height+e.height/2}},32:function(i,_){return{x:i.x+i.width-_.width/2,y:i.y+i.height+_.height/2}},33:function(W,P){return{x:W.x+W.width+P.width/2,y:W.y+W.height+P.height/2}},34:function(b,J){return{x:b.x,y:b.y-J.height/2}},35:function(l,G){return{x:l.x+l.width,y:l.y-G.height/2}},36:function(D,R){return{x:D.x,y:D.y+D.height+R.height/2}},37:function(z,$){return{x:z.x+z.width,y:z.y+z.height+$.height/2}},38:function(G,X){return{x:G.x+G.width/4,y:G.y-X.height/2}},39:function($,Y){return{x:$.x+3*$.width/4,y:$.y-Y.height/2}},40:function(N){return{x:N.x+N.width/4,y:N.y}},41:function(t){return{x:t.x+3*t.width/4,y:t.y}},42:function(j,p){return{x:j.x+j.width/4,y:j.y+p.height/2}},43:function(r,K){return{x:r.x+3*r.width/4,y:r.y+K.height/2}},44:function(q,n){return{x:q.x+q.width/2,y:q.y+q.height/2-n.height/2}},45:function(D){return{x:D.x+D.width/4,y:D.y+D.height/2}},46:function(D,l){return{x:D.x+D.width/2-l.width/2,y:D.y+D.height/2}},47:function(z,b){return{x:z.x+z.width/2+b.width/2,y:z.y+z.height/2}},48:function(T){return{x:T.x+3*T.width/4,y:T.y+T.height/2}},49:function(r,A){return{x:r.x+r.width/2,y:r.y+r.height/2+A.height/2}},50:function(l,o){return{x:l.x+l.width/4,y:l.y+l.height-o.height/2}},51:function(P,U){return{x:P.x+3*P.width/4,y:P.y+P.height-U.height/2}},52:function(T){return{x:T.x+T.width/4,y:T.y+T.height}},53:function(n){return{x:n.x+3*n.width/4,y:n.y+n.height}},54:function(O,x){return{x:O.x+O.width/4,y:O.y+O.height+x.height/2}},55:function(m,Y){return{x:m.x+3*m.width/4,y:m.y+m.height+Y.height/2}}};return Do(e)?function(Y,z,T){return B[Y](z,T?T:kq)}:void 0}();kk(h,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#45C4F9",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#FFF",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var il=h.reverse,Qo=h.transparent,ig=h.rectSelectBackground,tn=h.dash,Kj=h.titleBackground,ti=h.titleIconBackground,Kg=h.headerBackground,Ao=h.headerIconBackground,Mg=h.headerSeparator,po=h.headerLine,eh=h.contentIconBackground,ki=h.contentLine,me=(h.widgetIconHighlight,h.widgetIconBorder),sr=(h.widgetIconGradient,h.imageBackground),kl=h.imageGradient,Sh=h.highlight,dh=h.label,Sl=h.labelSelect;if(ni&&!e.shutAlert1){var Ed=new Date,Ci=ni.split("-"),ld=new Date(Ed.getFullYear(),Ed.getMonth(),Ed.getDate()),ni=new Date(fl(Ci[0],10),fl(Ci[1],10)-1,fl(Ci[2],10)),Sd=ld.getTime(),he=ni.getTime(),Sq=V+"_try",rp=e.alert;try{var Ob=e.localStorage;if(Ob&&rp)if(he>Sd&&1728e6>he-Sd){var He=(he-Sd)/864e5;Ob&&Ob[Sq]!=He&&(Ob[Sq]=He,e.htWillExpire?rp(e.htWillExpire.replace("{{day}}",He)):rp("HT for Web free trial license will expire in "+He+" days, please apply for a new license!"))}else Sd>=he&&(e.htExpired?rp(e.htExpired):rp("Your free trial of HT for Web has expired!")),Ob&&delete Ob[Sq]}catch(Og){}}Math.sign===W&&(Math.sign=function($){return 0>$?-1:$>0?1:+$});var gc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Gp={encode:function(j,a){var y,o,l,G,K,F,$,u="",J=0;for(j=unescape(encodeURIComponent(j));J<j.length;)y=j.charCodeAt(J++),o=j.charCodeAt(J++),l=j.charCodeAt(J++),G=y>>2,K=(3&y)<<4|o>>4,F=(15&o)<<2|l>>6,$=63&l,isNaN(o)?F=$=64:isNaN(l)&&($=64),u=u+a.charAt(G)+a.charAt(K)+a.charAt(F)+a.charAt($);return u},decode:function(C,V,A){for(var S,Z,h,p,E,v,e,c="",Y=A||0;Y<C.length;)p=V.indexOf(C.charAt(Y++)),E=V.indexOf(C.charAt(Y++)),v=V.indexOf(C.charAt(Y++)),e=V.indexOf(C.charAt(Y++)),S=p<<2|E>>4,Z=(15&E)<<4|v>>2,h=(3&v)<<6|e,c+=String.fromCharCode(S),64!=v&&(c+=String.fromCharCode(Z)),64!=e&&(c+=String.fromCharCode(h));return c=decodeURIComponent(escape(c))},_utf8_encode:function(Q){Q=Q.replace(/\r\n/g,"\n");for(var W="",I=0;I<Q.length;I++){var D=Q.charCodeAt(I);128>D?W+=String.fromCharCode(D):D>127&&2048>D?(W+=String.fromCharCode(192|D>>6),W+=String.fromCharCode(128|63&D)):(W+=String.fromCharCode(224|D>>12),W+=String.fromCharCode(128|63&D>>6),W+=String.fromCharCode(128|63&D))}return W},_utf8_decode:function(k){for(var $="",K=0,z=0,E=0,I=0;K<k.length;)z=k.charCodeAt(K),128>z?($+=String.fromCharCode(z),K++):z>191&&224>z?(E=k.charCodeAt(K+1),$+=String.fromCharCode((31&z)<<6|63&E),K+=2):(E=k.charCodeAt(K+1),I=k.charCodeAt(K+2),$+=String.fromCharCode((15&z)<<12|(63&E)<<6|63&I),K+=3);return $}},Un=[],nc=[],Po=n.Math={generateUUID:function(){for(var r=[],w=0;256>w;w++)r[w]=(16>w?"0":"")+w.toString(16).toUpperCase();return function(){var n=0|4294967295*Math.random(),i=0|4294967295*Math.random(),G=0|4294967295*Math.random(),Y=0|4294967295*Math.random();return r[255&n]+r[255&n>>8]+r[255&n>>16]+r[255&n>>24]+"-"+r[255&i]+r[255&i>>8]+"-"+r[64|15&i>>16]+r[255&i>>24]+"-"+r[128|63&G]+r[255&G>>8]+"-"+r[255&G>>16]+r[255&G>>24]+r[255&Y]+r[255&Y>>8]+r[255&Y>>16]+r[255&Y>>24]}}(),clamp:function(e,A,n){return Math.max(A,Math.min(n,e))},fequal:function(j,s,n){return null==n&&(n=1e-8),Math.abs(j-s)<n},generateIncreasingID:function(){var C=0;return function(){return++C}}(),encodeBase64:function(t,J){return Gp.encode(t,J||gc)},decodeBase64:function(u,M){return Gp.decode(u,M||gc)},randomArray:function($,w){w=w||$.length;for(var _=w-1;_>0;_--){var z=Math.floor(Math.random()*(_+1)),s=$[_];$[_]=$[z],$[z]=s}return $},randomInt:function(h,G){return G===W&&(G=h,h=0),h+Math.floor(Math.random()*(G-h))},randomFloat:function(e,$){return $===W&&($=e,e=0),e+Math.random()*($-e)},isPOT:function(G){return G>0&&0===(G-1&G)},nearestPOT:function(P){if(!P)return 1;var o=P;o--,o|=o>>1,o|=o>>2,o|=o>>4,o|=o>>8,o|=o>>16,o++;var d=o>>1;return P-d>o-P?o:d},requestMatrix4:function(){return Un.length>0?Un.pop():new Po.Matrix4},releaseMatrix4:function(N){Un.push(N)},requestVector3:function(){return nc.length>0?nc.pop():new Po.Vector3},releaseVector3:function(G){nc.push(G)}},Vb=n.Matrix=n.Math.Matrix2d=function(f,F,v,o,h){this.setFromTransform(f,F,v,o,h)},ur=Vb;Vb.prototype={},Vb.prototype.constructor=Vb,Vb.prototype.set=function(Q,L,D,N,m,i){return this.a=Q,this.b=L,this.c=D,this.d=N,this.tx=m,this.ty=i,this},Vb.prototype.setFromTransform=function(q,S,P,K,d){var i=this;if(q===W)return i.a=1,i.b=0,i.c=0,i.d=1,i.tx=0,i.ty=0,void 0;var b,w;return q?(b=R(q),w=s(q)):(b=0,w=1),K=K||1,d=d||1,i.a=w*K,i.b=b*K,i.c=-b*d,i.d=w*d,i.tx=S||0,i.ty=P||0,i},Vb.prototype.apply=function(W,R){R=R||new Ai;var m=W.x,f=W.y;return R.x=this.a*m+this.c*f+this.tx,R.y=this.b*m+this.d*f+this.ty,R},Vb.prototype.applyInverse=function(t,w){w=w||new Ai;var D=1/(this.a*this.d+this.c*-this.b),R=t.x,W=t.y;return w.x=this.d*D*R+-this.c*D*W+(this.ty*this.c-this.tx*this.d)*D,w.y=this.a*D*W+-this.b*D*R+(-this.ty*this.a+this.tx*this.b)*D,w},Vb.prototype.translate=function(y,V){return this.tx+=y,this.ty+=V,this},Vb.prototype.scale=function(u,V){return this.a*=u,this.d*=V,this.c*=u,this.b*=V,this.tx*=u,this.ty*=V,this},Vb.prototype.rotate=function(Y){var J=Math.cos(Y),j=Math.sin(Y),O=this.a,a=this.c,x=this.tx;return this.a=O*J-this.b*j,this.b=O*j+this.b*J,this.c=a*J-this.d*j,this.d=a*j+this.d*J,this.tx=x*J-this.ty*j,this.ty=x*j+this.ty*J,this},Vb.prototype.appendTranslate=function(p,O){return this.tx+=this.a*p+this.c*O,this.ty+=this.b*p+this.d*O,this},Vb.prototype.appendScale=function(j,x){return this.a*=j,this.d*=x,this.c*=x,this.b*=j,this},Vb.prototype.appendRotate=function(X){if(!X)return this;var t=Math.cos(X),m=Math.sin(X),r=this.a,E=this.b;return this.a=r*t+this.c*m,this.b=E*t+this.d*m,this.c=-r*m+this.c*t,this.d=-E*m+this.d*t,this},Vb.prototype.append=function(U){var K=this.a,p=this.b,T=this.c,W=this.d;return this.a=U.a*K+U.b*T,this.b=U.a*p+U.b*W,this.c=U.c*K+U.d*T,this.d=U.c*p+U.d*W,this.tx=U.tx*K+U.ty*T+this.tx,this.ty=U.tx*p+U.ty*W+this.ty,this},Vb.prototype.setTransform=function(p,n,B,A,O,L,i,M,b){var m,t,Z,W,s,T,y,w,c,o;return s=Math.sin(i),T=Math.cos(i),y=Math.cos(b),w=Math.sin(b),c=-Math.sin(M),o=Math.cos(M),m=T*O,t=s*O,Z=-s*L,W=T*L,this.a=y*m+w*Z,this.b=y*t+w*W,this.c=c*m+o*Z,this.d=c*t+o*W,this.tx=p+(B*m+A*Z),this.ty=n+(B*t+A*W),this},Vb.prototype.prepend=function(l){var J=this.tx;if(1!==l.a||0!==l.b||0!==l.c||1!==l.d){var s=this.a,L=this.c;this.a=s*l.a+this.b*l.c,this.b=s*l.b+this.b*l.d,this.c=L*l.a+this.d*l.c,this.d=L*l.b+this.d*l.d}return this.tx=J*l.a+this.ty*l.c+l.tx,this.ty=J*l.b+this.ty*l.d+l.ty,this},Vb.prototype.transform=Vb.prototype.prepend,Vb.prototype.invert=function(){var X=this.a,U=this.b,K=this.c,o=this.d,O=this.tx,J=X*o-U*K;return this.a=o/J,this.b=-U/J,this.c=-K/J,this.d=X/J,this.tx=(K*this.ty-o*O)/J,this.ty=-(X*this.ty-U*O)/J,this},Vb.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Vb.prototype.clone=function(){var A=new Vb;return A.a=this.a,A.b=this.b,A.c=this.c,A.d=this.d,A.tx=this.tx,A.ty=this.ty,A},Vb.prototype.copy=function($){return $.a=this.a,$.b=this.b,$.c=this.c,$.d=this.d,$.tx=this.tx,$.ty=this.ty,$},Vb.prototype.tf=function($,l){1===arguments.length&&(l=$.y,$=$.x);var D=this;return{x:D.a*$+D.c*l+D.tx,y:D.b*$+D.d*l+D.ty}},Vb.prototype.toArray=function(){return[this.a,this.b,this.c,this.d,this.tx,this.ty]},Vb.prototype.fromArray=function(Q){return this.a=Q[0],this.b=Q[1],this.c=Q[2],this.d=Q[3],this.tx=Q[4],this.ty=Q[5],this},Vb.prototype.toArray9=function(){return[this.a,this.b,0,this.c,this.d,0,this.tx,this.ty,1]},Vb.prototype.tfi=function(n,O){1===arguments.length&&(O=n.y,n=n.x);var u=this,x=1/(u.a*u.d+u.c*-u.b);return{x:u.d*x*n+-u.c*x*O+(u.ty*u.c-u.tx*u.d)*x,y:u.a*x*O+-u.b*x*n+(-u.ty*u.a+u.tx*u.b)*x}},Vb.IDENTITY=new Vb,Vb.TEMP_MATRIX=new Vb;var Mq=n.Math.Quaternion=function(I,q,S,E){this.set(I,q,S,E)};o.assign(Mq.prototype,{set:function(Q,A,c,G){var m=this;return m._x=Q||0,m._y=A||0,m._z=c||0,m._w=G!==W?G:1,m},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(H){var A=this;return A._x=H._x,A._y=H._y,A._z=H._z,A._w=H._w,A},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this},dot:function(Y){return this._x*Y._x+this._y*Y._y+this._z*Y._z+this._w*Y._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var I=this.length();return 0===I?(this._x=0,this._y=0,this._z=0,this._w=1):(I=1/I,this._x=this._x*I,this._y=this._y*I,this._z=this._z*I,this._w=this._w*I),this},fromArray:function(_,I){I===W&&(I=0);var T=this;return T._x=_[I],T._y=_[I+1],T._z=_[I+2],T._w=_[I+3],this},slerp:function(y,C){if(0===C)return this;if(1===C)return this.copy(y);var E=this._x,h=this._y,q=this._z,P=this._w,r=P*y._w+E*y._x+h*y._y+q*y._z;if(0>r?(this._w=-y._w,this._x=-y._x,this._y=-y._y,this._z=-y._z,r=-r):this.copy(y),r>=1)return this._w=P,this._x=E,this._y=h,this._z=q,this;var H=Math.sqrt(1-r*r);if(Math.abs(H)<.001)return this._w=.5*(P+this._w),this._x=.5*(E+this._x),this._y=.5*(h+this._y),this._z=.5*(q+this._z),this;var d=Math.atan2(H,r),M=Math.sin((1-C)*d)/H,O=Math.sin(C*d)/H;return this._w=P*M+this._w*O,this._x=E*M+this._x*O,this._y=h*M+this._y*O,this._z=q*M+this._z*O,this},setFromAxisAngle:function(Z,y){var G=y/2,F=Math.sin(G);return this._x=Z.x*F,this._y=Z.y*F,this._z=Z.z*F,this._w=Math.cos(G),this},setFromEuler:function(M){var Q=M._x,E=M._y,R=M._z,d=M._order,V=Math.cos,u=Math.sin,U=V(Q/2),p=V(E/2),B=V(R/2),w=u(Q/2),D=u(E/2),A=u(R/2);return"XYZ"===d?(this._x=w*p*B+U*D*A,this._y=U*D*B-w*p*A,this._z=U*p*A+w*D*B,this._w=U*p*B-w*D*A):"YXZ"===d?(this._x=w*p*B+U*D*A,this._y=U*D*B-w*p*A,this._z=U*p*A-w*D*B,this._w=U*p*B+w*D*A):"ZXY"===d?(this._x=w*p*B-U*D*A,this._y=U*D*B+w*p*A,this._z=U*p*A+w*D*B,this._w=U*p*B-w*D*A):"ZYX"===d?(this._x=w*p*B-U*D*A,this._y=U*D*B+w*p*A,this._z=U*p*A-w*D*B,this._w=U*p*B+w*D*A):"YZX"===d?(this._x=w*p*B+U*D*A,this._y=U*D*B+w*p*A,this._z=U*p*A-w*D*B,this._w=U*p*B-w*D*A):"XZY"===d&&(this._x=w*p*B-U*D*A,this._y=U*D*B-w*p*A,this._z=U*p*A+w*D*B,this._w=U*p*B+w*D*A),this},setFromRotationMatrix:function(g){var K,B=g.el,V=B[0],Z=B[4],h=B[8],$=B[1],F=B[5],U=B[9],c=B[2],b=B[6],R=B[10],N=V+F+R;return N>0?(K=.5/Math.sqrt(N+1),this._w=.25/K,this._x=(b-U)*K,this._y=(h-c)*K,this._z=($-Z)*K):V>F&&V>R?(K=2*Math.sqrt(1+V-F-R),this._w=(b-U)/K,this._x=.25*K,this._y=(Z+$)/K,this._z=(h+c)/K):F>R?(K=2*Math.sqrt(1+F-V-R),this._w=(h-c)/K,this._x=(Z+$)/K,this._y=.25*K,this._z=(U+b)/K):(K=2*Math.sqrt(1+R-V-F),this._w=($-Z)/K,this._x=(h+c)/K,this._y=(U+b)/K,this._z=.25*K),this},setFromToVectors:function(){var V,D;return function(v,N){return V===W&&(V=new se),D=v.dot(N)+1,1e-7>D?(D=0,Math.abs(v.x)>Math.abs(v.z)?V.set(-v.y,v.x,0):V.set(0,-v.z,v.y)):V.crossVectors(v,N),this._x=V.x,this._y=V.y,this._z=V.z,this._w=D,this.normalize()}}(),setFromUnitVectors:function(){var A,p,D=1e-6;return function(M,x){return A===W&&(A=new se),p=M.dot(x)+1,D>p?(p=0,Math.abs(M.x)>Math.abs(M.z)?A.set(-M.y,M.x,0):A.set(0,-M.z,M.y)):A.crossVectors(M,x),this._x=A.x,this._y=A.y,this._z=A.z,this._w=p,this.normalize()}}(),multiply:function(M){return this.multiplyQuaternions(this,M)},premultiply:function(N){return this.multiplyQuaternions(N,this)},multiplyQuaternions:function(P,S){var K=P._x,r=P._y,k=P._z,G=P._w,m=S._x,Q=S._y,T=S._z,n=S._w;return this._x=K*n+G*m+r*T-k*Q,this._y=r*n+G*Q+k*m-K*T,this._z=k*n+G*T+K*Q-r*m,this._w=G*n-K*m-r*Q-k*T,this},toArray:function(O,M){return O||(O=[]),M=M||0,O[M]=this._x,O[M+1]=this._y,O[M+2]=this._z,O[M+3]=this._w,O}});var lq=n.Math.Vector4=function(i,T,k,y){this.x=i||0,this.y=T||0,this.z=k||0,this.w=y!==W?y:1};o.assign(lq.prototype,{isVector4:!0,set:function(i,K,E,W){return this.x=i,this.y=K,this.z=E,this.w=W,this},setScalar:function(u){return this.x=u,this.y=u,this.z=u,this.w=u,this},setX:function(e){return this.x=e,this},setY:function(J){return this.y=J,this},setZ:function(N){return this.z=N,this},setW:function(F){return this.w=F,this},setComponent:function(H,Z){switch(H){case 0:this.x=Z;break;case 1:this.y=Z;break;case 2:this.z=Z;break;case 3:this.w=Z;break;default:throw new Error("index is out of range: "+H)}return this},getComponent:function(U){switch(U){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+U)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(n){return this.x=n.x,this.y=n.y,this.z=n.z,this.w=n.w!==W?n.w:1,this},add:function(I,u){return u!==W?this.addVectors(I,u):(this.x+=I.x,this.y+=I.y,this.z+=I.z,this.w+=I.w,this)},addScalar:function(X){return this.x+=X,this.y+=X,this.z+=X,this.w+=X,this},addVectors:function(n,s){return this.x=n.x+s.x,this.y=n.y+s.y,this.z=n.z+s.z,this.w=n.w+s.w,this},addScaledVector:function(w,e){return this.x+=w.x*e,this.y+=w.y*e,this.z+=w.z*e,this.w+=w.w*e,this},sub:function(F,k){return k!==W?this.subVectors(F,k):(this.x-=F.x,this.y-=F.y,this.z-=F.z,this.w-=F.w,this)},subScalar:function(A){return this.x-=A,this.y-=A,this.z-=A,this.w-=A,this},subVectors:function(J,f){return this.x=J.x-f.x,this.y=J.y-f.y,this.z=J.z-f.z,this.w=J.w-f.w,this},multiplyScalar:function(J){return this.x*=J,this.y*=J,this.z*=J,this.w*=J,this},applyMatrix4:function(F){var Q=this.x,I=this.y,Y=this.z,W=this.w,K=F.el;return this.x=K[0]*Q+K[4]*I+K[8]*Y+K[12]*W,this.y=K[1]*Q+K[5]*I+K[9]*Y+K[13]*W,this.z=K[2]*Q+K[6]*I+K[10]*Y+K[14]*W,this.w=K[3]*Q+K[7]*I+K[11]*Y+K[15]*W,this},divideScalar:function(g){return this.multiplyScalar(1/g)},setAxisAngleFromQuaternion:function(o){this.w=2*Math.acos(o.w);var T=Math.sqrt(1-o.w*o.w);return 1e-4>T?(this.x=1,this.y=0,this.z=0):(this.x=o.x/T,this.y=o.y/T,this.z=o.z/T),this
},setAxisAngleFromRotationMatrix:function(t){var l,G,I,E,F=.01,W=.1,H=t.el,b=H[0],$=H[4],O=H[8],D=H[1],M=H[5],K=H[9],p=H[2],B=H[6],i=H[10];if(Math.abs($-D)<F&&Math.abs(O-p)<F&&Math.abs(K-B)<F){if(Math.abs($+D)<W&&Math.abs(O+p)<W&&Math.abs(K+B)<W&&Math.abs(b+M+i-3)<W)return this.set(1,0,0,0),this;l=Math.PI;var J=(b+1)/2,k=(M+1)/2,Q=(i+1)/2,u=($+D)/4,o=(O+p)/4,j=(K+B)/4;return J>k&&J>Q?F>J?(G=0,I=.707106781,E=.707106781):(G=Math.sqrt(J),I=u/G,E=o/G):k>Q?F>k?(G=.707106781,I=0,E=.707106781):(I=Math.sqrt(k),G=u/I,E=j/I):F>Q?(G=.707106781,I=.707106781,E=0):(E=Math.sqrt(Q),G=o/E,I=j/E),this.set(G,I,E,l),this}var f=Math.sqrt((B-K)*(B-K)+(O-p)*(O-p)+(D-$)*(D-$));return Math.abs(f)<.001&&(f=1),this.x=(B-K)/f,this.y=(O-p)/f,this.z=(D-$)/f,this.w=Math.acos((b+M+i-1)/2),this},min:function(x){return this.x=Math.min(this.x,x.x),this.y=Math.min(this.y,x.y),this.z=Math.min(this.z,x.z),this.w=Math.min(this.w,x.w),this},max:function(G){return this.x=Math.max(this.x,G.x),this.y=Math.max(this.y,G.y),this.z=Math.max(this.z,G.z),this.w=Math.max(this.w,G.w),this},clamp:function(y,d){return this.x=Math.max(y.x,Math.min(d.x,this.x)),this.y=Math.max(y.y,Math.min(d.y,this.y)),this.z=Math.max(y.z,Math.min(d.z,this.z)),this.w=Math.max(y.w,Math.min(d.w,this.w)),this},clampScalar:function(){var J,T;return function(s,n){return J===W&&(J=new lq,T=new lq),J.set(s,s,s,s),T.set(n,n,n,n),this.clamp(J,T)}}(),clampLength:function(n,l){var P=this.length();return this.divideScalar(P||1).multiplyScalar(Math.max(n,Math.min(l,P)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(C){return this.x*C.x+this.y*C.y+this.z*C.z+this.w*C.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(U){return this.normalize().multiplyScalar(U)},lerp:function(Q,F){return this.x+=(Q.x-this.x)*F,this.y+=(Q.y-this.y)*F,this.z+=(Q.z-this.z)*F,this.w+=(Q.w-this.w)*F,this},lerpVectors:function(C,p,y){return this.subVectors(p,C).multiplyScalar(y).add(C)},equals:function(o){return o.x===this.x&&o.y===this.y&&o.z===this.z&&o.w===this.w},fromArray:function(J,C){return C===W&&(C=0),this.x=J[C],this.y=J[C+1],this.z=J[C+2],this.w=J[C+3],this},toArray:function(j,C){return j===W&&(j=[]),C===W&&(C=0),j[C]=this.x,j[C+1]=this.y,j[C+2]=this.z,j[C+3]=this.w,j},fromBufferAttribute:function(p,n){return this.x=p.getX(n),this.y=p.getY(n),this.z=p.getZ(n),this.w=p.getW(n),this}});var se=n.Math.Vector3=function(t,z,s){t===W?(this.x=0,this.y=0,this.z=0):"object"==typeof t?this.copy(t):this.set(t,z==W?t:z,s==W?t:s)},er=n.Math.Vector3;o.assign(se.prototype,{isNaN:function(){return isNaN(this.x)||isNaN(this.y)||isNaN(this.z)},set:function(p,m,H){return this.x=p,this.y=m,this.z=H,this},equals:function(a){return a&&this.x===a.x&&this.y===a.y&&this.z===a.z},setScalar:function(C){return this.x=C,this.y=C,this.z=C,this},setX:function(U){return this.x=U,this},setY:function(b){return this.y=b,this},setZ:function(H){return this.z=H,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(Q){return Q.x===W?(this.x=Q[0],this.y=Q[1],this.z=Q[2]):(this.x=Q.x,this.y=Q.y,this.z=Q.z||0),this},add:function(q){return this.x+=q.x,this.y+=q.y,this.z+=q.z,this},addScalar:function(r){return this.x+=r,this.y+=r,this.z+=r,this},addVectors:function(B,Y){return this.x=B.x+Y.x,this.y=B.y+Y.y,this.z=B.z+Y.z,this},addScaledVector:function(I,P){return this.x+=I.x*P,this.y+=I.y*P,this.z+=I.z*P,this},sub:function(a){return this.x-=a.x,this.y-=a.y,this.z-=a.z,this},subScalar:function(i){return this.x-=i,this.y-=i,this.z-=i,this},subVectors:function(m,g){return this.x=m.x-g.x,this.y=m.y-g.y,this.z=m.z-g.z,this},divide:function(s){return this.x/=s.x,this.y/=s.y,this.z/=s.z,this},multiply:function(F){return this.x*=F.x,this.y*=F.y,this.z*=F.z,this},multiplyScalar:function(K){return this.x*=K,this.y*=K,this.z*=K,this},divideScalar:function(m){if(0!==m){var h=1/m;this.x*=h,this.y*=h,this.z*=h}else this.x=0,this.y=0,this.z=0;return this},distanceTo:function(M){return Math.sqrt(this.distanceToSquared(M))},distanceToSquared:function(X){var n=this.x-X.x,p=this.y-X.y,G=this.z-X.z;return n*n+p*p+G*G},distanceToSquared2:function(n){var C=this.x-n[0],x=this.y-n[1],_=this.z-n[2];return C*C+x*x+_*_},divideVectors:function(h,v){return this.x=h.x/v.x,this.y=h.y/v.y,this.z=h.z/v.z,this},multiplyVectors:function(e,J){return this.x=e.x*J.x,this.y=e.y*J.y,this.z=e.z*J.z,this},transformDirection:function(d){var H=this.x,w=this.y,T=this.z,s=d.el;return this.x=s[0]*H+s[4]*w+s[8]*T,this.y=s[1]*H+s[5]*w+s[9]*T,this.z=s[2]*H+s[6]*w+s[10]*T,this.normalize()},applyAxisAngle:function(){var t=new Mq;return function(n,W){return this.applyQuaternion(t.setFromAxisAngle(n,W))}}(),applyEuler:function(){var x=new Mq;return function(N){return this.applyQuaternion(x.setFromEuler(N))}}(),applyQuaternion:function(b){var C=this.x,r=this.y,F=this.z,I=b._x,a=b._y,B=b._z,V=b._w,T=V*C+a*F-B*r,Y=V*r+B*C-I*F,S=V*F+I*r-a*C,Z=-I*C-a*r-B*F;return this.x=T*V+Z*-I+Y*-B-S*-a,this.y=Y*V+Z*-a+S*-I-T*-B,this.z=S*V+Z*-B+T*-a-Y*-I,this},applyMatrix4:function(Z){var k=this.x,r=this.y,O=this.z,A=Z.el,N=1/(A[3]*k+A[7]*r+A[11]*O+A[15]);return this.x=(A[0]*k+A[4]*r+A[8]*O+A[12])*N,this.y=(A[1]*k+A[5]*r+A[9]*O+A[13])*N,this.z=(A[2]*k+A[6]*r+A[10]*O+A[14])*N,this},applyMatrix3:function(x){var s=this.x,Q=this.y,c=this.z,F=x.el;return this.x=F[0]*s+F[3]*Q+F[6]*c,this.y=F[1]*s+F[4]*Q+F[7]*c,this.z=F[2]*s+F[5]*Q+F[8]*c,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},reflect:function(){var H=new se;return function(X){return this.sub(H.copy(X).multiplyScalar(2*this.dot(X)))}}(),dot:function(E){return this.x*E.x+this.y*E.y+this.z*E.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var K=this.length();return K?this.multiplyScalar(1/K):this},setLength:function(D){return this.normalize().multiplyScalar(D)},fromArray:function(d,n){return n===W&&(n=0),this.x=d[n],this.y=d[n+1],this.z=d[n+2],this},toArray:function(P,V){return P===W&&(P=[0,0,0]),V===W&&(V=0),P[V]=this.x,P[V+1]=this.y,P[V+2]=this.z,P},cross:function(u){return this.crossVectors(this,u)},angleTo:function(c){var b=this.dot(c)/Math.sqrt(this.lengthSq()*c.lengthSq());return b>1||-1>b?0:Math.acos(b)},lerp:function(Q,j){return this.x+=(Q.x-this.x)*j,this.y+=(Q.y-this.y)*j,this.z+=(Q.z-this.z)*j,this},lerpVectors:function(G,b,D){return this.subVectors(b,G).multiplyScalar(D).add(G)},crossVectors:function(v,E){var U=v.x,w=v.y,C=v.z,c=E.x,l=E.y,r=E.z;return this.x=w*r-C*l,this.y=C*c-U*r,this.z=U*l-w*c,this},min:function(T){return this.x=Math.min(this.x,T.x),this.y=Math.min(this.y,T.y),this.z=Math.min(this.z,T.z),this},max:function(B){return this.x=Math.max(this.x,B.x),this.y=Math.max(this.y,B.y),this.z=Math.max(this.z,B.z),this},setFromMatrixPosition:function(A){return this.setFromMatrixColumn(A,3)},setFromMatrixScale:function(w){var u=this.setFromMatrixColumn(w,0).length(),k=this.setFromMatrixColumn(w,1).length(),K=this.setFromMatrixColumn(w,2).length();return this.x=u,this.y=k,this.z=K,this},setFromMatrixColumn:function(K,J){return this.fromArray(K.el,4*J)}}),se.UP=new se(0,1,0),se.AxisX=new se(1,0,0),se.AxisY=new se(0,1,0),se.AxisZ=new se(0,0,1),se.normalizeArray=function(){var Q=new se;return function(M){return Q.copy(M).normalize().toArray()}}();var Ai=n.Math.Vector2=function(j,F,K){"object"==typeof j&&(j.x!=W?(F=j.y,K=j.e,j=j.x):(K=j[2],F=j[1],j=j[0])),this.set(j||0,F||0,K)};Ai.prototype={},Ai.prototype.constructor=Ai;var _d=Ai;o.defineProperties(Ai.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(w){this.y=w}}}),Ai.prototype.clone=function(){return new Ai(this.x,this.y,this.e)},Ai.prototype.copy=function(J){return this.set(J.x,J.y,J.e),this},Ai.prototype.equals=function(I){return I.x===this.x&&I.y===this.y&&I.e===this.e},Ai.prototype.set=function(K,n,q){return this.x=K||0,this.y=n||(0!==n?this.x:0),q!=W&&(this.e=q),this},Ai.prototype.setScalar=function(n){return this.x=n,this.y=n,this.e=n,this},Ai.prototype.setX=function(j){return this.x=j||0,this},Ai.prototype.setY=function(R){return this.y=R||0,this},Ai.prototype.setE=function(E){return this.e=E||0,this},Ai.prototype.add=function(U){return this.x+=U.x,this.y+=U.y,this},Ai.prototype.addVectors=function(z,X){return this.x=z.x+X.x,this.y=z.y+X.y,this},Ai.prototype.addScalar=function(W){return this.x+=W,this.y+=W,this},Ai.prototype.addScaledVector=function(Z,P){return this.x+=Z.x*P,this.y+=Z.y*P,this},Ai.prototype.sub=function(I){return this.x-=I.x,this.y-=I.y,this},Ai.prototype.subScalar=function(S){return this.x-=S,this.y-=S,this},Ai.prototype.subVectors=function(D,T){return this.x=D.x-T.x,this.y=D.y-T.y,this},Ai.prototype.multiply=function(x){return this.x*=x.x,this.y*=x.y,this},Ai.prototype.multiplyScalar=function(N){return this.x*=N,this.y*=N,this},Ai.prototype.divide=function(M){return this.x/=M.x,this.y/=M.y,this},Ai.prototype.divideScalar=function(a){return this.multiplyScalar(1/a)},Ai.prototype.min=function(H){return this.x=Math.min(this.x,H.x),this.y=Math.min(this.y,H.y),this},Ai.prototype.max=function(n){return this.x=Math.max(this.x,n.x),this.y=Math.max(this.y,n.y),this},Ai.prototype.fromArray=function(F,g){return g===W&&(g=0),this.x=F[g],this.y=F[g+1],this},Ai.prototype.clamp=function(e,c){return this.x=Math.max(e.x,Math.min(c.x,this.x)),this.y=Math.max(e.y,Math.min(c.y,this.y)),this},Ai.prototype.clampScalar=function(){var n,k;return function(e,I){return n===W&&(n=new Ai,k=new Ai),n.set(e,e),k.set(I,I),this.clamp(n,k)}}(),Ai.prototype.clampLength=function(q,$){var C=this.length();return this.multiplyScalar(Math.max(q,Math.min($,C))/C)},Ai.prototype.dot=function(k){return this.x*k.x+this.y*k.y},Ai.prototype.cross=function(l){return this.x*l.y-this.y*l.x},Ai.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},Ai.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Ai.prototype.normalize=function(){return this.divideScalar(this.length())},Ai.prototype.angle=function(){var t=Math.atan2(this.y,this.x);return 0>t&&(t+=2*Math.PI),t},Ai.prototype.distanceTo=function(p){return Math.sqrt(this.distanceToSquared(p))},Ai.prototype.distanceToSquared=function(V){var P=this.x-V.x,Q=this.y-V.y;return P*P+Q*Q},Ai.prototype.isNearEnough=function(G){return this.distanceToSquared(G)<1e-8},Ai.prototype.setLength=function(I){var Z=this.length();return Z?this.multiplyScalar(I/Z):this},Ai.prototype.lerp=function(s,q){return this.x+=(s.x-this.x)*q,this.y+=(s.y-this.y)*q,"number"==typeof s.e&&"number"==typeof this.e&&(this.e+=(s.e-this.e)*q),this},Ai.prototype.lerpVectors=function(_,O,b){return this.subVectors(O,_).multiplyScalar(b).add(_)},Ai.prototype.rotateAround=function(b,l){var x=b?b.x:0,i=b?b.y:0,q=Math.cos(l),W=Math.sin(l),r=this.x-x,V=this.y-i;return this.x=r*q-V*W+x,this.y=r*W+V*q+i,this};var Ri=n.Math.Matrix3=function(){this.el=[1,0,0,0,1,0,0,0,1]};o.assign(Ri.prototype,{isMatrix3:!0,set:function(S,h,e,X,E,o,R,B,C){var O=this.el;return O[0]=S,O[1]=X,O[2]=R,O[3]=h,O[4]=E,O[5]=B,O[6]=e,O[7]=o,O[8]=C,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.el)},copy:function(B){var A=this.el,t=B.el;return A[0]=t[0],A[1]=t[1],A[2]=t[2],A[3]=t[3],A[4]=t[4],A[5]=t[5],A[6]=t[6],A[7]=t[7],A[8]=t[8],this},setFromMatrix4:function(l){var i=l.el;return this.set(i[0],i[4],i[8],i[1],i[5],i[9],i[2],i[6],i[10]),this},applyToBufferAttribute:function(){var V=new se;return function(q){for(var C=0,s=q.count;s>C;C++)V.x=q.getX(C),V.y=q.getY(C),V.z=q.getZ(C),V.applyMatrix3(this),q.setXYZ(C,V.x,V.y,V.z);return q}}(),multiply:function(K){return this.multiplyMatrices(this,K)},premultiply:function(g){return this.multiplyMatrices(g,this)},multiplyMatrices:function(I,L){var T=I.el,V=L.el,$=this.el,O=T[0],C=T[3],G=T[6],u=T[1],J=T[4],E=T[7],_=T[2],q=T[5],x=T[8],B=V[0],w=V[3],F=V[6],X=V[1],m=V[4],M=V[7],y=V[2],j=V[5],c=V[8];return $[0]=O*B+C*X+G*y,$[3]=O*w+C*m+G*j,$[6]=O*F+C*M+G*c,$[1]=u*B+J*X+E*y,$[4]=u*w+J*m+E*j,$[7]=u*F+J*M+E*c,$[2]=_*B+q*X+x*y,$[5]=_*w+q*m+x*j,$[8]=_*F+q*M+x*c,this},multiplyScalar:function(w){var n=this.el;return n[0]*=w,n[3]*=w,n[6]*=w,n[1]*=w,n[4]*=w,n[7]*=w,n[2]*=w,n[5]*=w,n[8]*=w,this},determinant:function(){var b=this.el,h=b[0],j=b[1],i=b[2],d=b[3],x=b[4],g=b[5],J=b[6],X=b[7],F=b[8];return h*x*F-h*g*X-j*d*F+j*g*J+i*d*X-i*x*J},getInverse:function(s){var G=s.el,A=this.el,p=G[0],q=G[1],X=G[2],u=G[3],l=G[4],U=G[5],r=G[6],J=G[7],K=G[8],O=K*l-U*J,i=U*r-K*u,b=J*u-l*r,h=p*O+q*i+X*b;if(0===h)return this.identity();var n=1/h;return A[0]=O*n,A[1]=(X*J-K*q)*n,A[2]=(U*q-X*l)*n,A[3]=i*n,A[4]=(K*p-X*r)*n,A[5]=(X*u-U*p)*n,A[6]=b*n,A[7]=(q*r-J*p)*n,A[8]=(l*p-q*u)*n,this},transpose:function(){var O,S=this.el;return O=S[1],S[1]=S[3],S[3]=O,O=S[2],S[2]=S[6],S[6]=O,O=S[5],S[5]=S[7],S[7]=O,this},getNormalMatrix:function(U){return this.setFromMatrix4(U).getInverse(this).transpose()},transposeIntoArray:function(t){var W=this.el;return t[0]=W[0],t[1]=W[3],t[2]=W[6],t[3]=W[1],t[4]=W[4],t[5]=W[7],t[6]=W[2],t[7]=W[5],t[8]=W[8],this},setUvTransform:function(g,u,Y,R,l,k,$){var S=Math.cos(l),J=Math.sin(l);this.set(Y*S,Y*J,-Y*(S*k+J*$)+k+g,-R*J,R*S,-R*(-J*k+S*$)+$+u,0,0,1)},scale:function(b,B){var N=this.el;return N[0]*=b,N[3]*=b,N[6]*=b,N[1]*=B,N[4]*=B,N[7]*=B,this},rotate:function(K){var t=Math.cos(K),r=Math.sin(K),y=this.el,s=y[0],f=y[3],F=y[6],P=y[1],D=y[4],V=y[7];return y[0]=t*s+r*P,y[3]=t*f+r*D,y[6]=t*F+r*V,y[1]=-r*s+t*P,y[4]=-r*f+t*D,y[7]=-r*F+t*V,this},translate:function(X,y){var A=this.el;return A[0]+=X*A[2],A[3]+=X*A[5],A[6]+=X*A[8],A[1]+=y*A[2],A[4]+=y*A[5],A[7]+=y*A[8],this},equals:function(V){for(var $=this.el,R=V.el,Y=0;9>Y;Y++)if($[Y]!==R[Y])return!1;return!0},fromArray:function(_,b){b===W&&(b=0);for(var i=0;9>i;i++)this.el[i]=_[i+b];return this},toArray:function(R,j){R===W&&(R=[]),j===W&&(j=0);var p=this.el;return R[j]=p[0],R[j+1]=p[1],R[j+2]=p[2],R[j+3]=p[3],R[j+4]=p[4],R[j+5]=p[5],R[j+6]=p[6],R[j+7]=p[7],R[j+8]=p[8],R}});var Dk=n.Math.Plane=function(J,X){this.normal=J!==W?J:new se(1,0,0),this.constant=X!==W?X:0};o.assign(Dk.prototype,{set:function(X,T){return this.normal.copy(X),this.constant=T,this},setComponents:function(v,b,W,w){return this.normal.set(v,b,W),this.constant=w,this},setFromNormalAndCoplanarPoint:function(V,x){return this.normal.copy(V),this.constant=-x.dot(this.normal),this},setFromCoplanarPoints:function(){var I=new se,y=new se;return function(w,k,p){var R=I.subVectors(p,k).cross(y.subVectors(w,k)).normalize();return this.setFromNormalAndCoplanarPoint(R,w),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(R){return this.normal.copy(R.normal),this.constant=R.constant,this},normalize:function(){var s=1/this.normal.length();return this.normal.multiplyScalar(s),this.constant*=s,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(I){return this.normal.dot(I)+this.constant},distanceToSphere:function(O){return this.distanceToPoint(O.center)-O.radius},projectPoint:function(e,q){return q===W&&(q=new se),q.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(){var i=new se;return function(Y,u){u===W&&(u=new se);var e=Y.delta(i),m=this.normal.dot(e);if(0===m)return 0===this.distanceToPoint(Y.start)?u.copy(Y.start):W;var q=-(Y.start.dot(this.normal)+this.constant)/m;return 0>q||q>1?W:u.copy(e).multiplyScalar(q).add(Y.start)}}(),intersectsLine:function(R){var f=this.distanceToPoint(R.start),a=this.distanceToPoint(R.end);return 0>f&&a>0||0>a&&f>0},intersectsBox:function(C){return C.intersectsPlane(this)},intersectsSphere:function(J){return J.intersectsPlane(this)},coplanarPoint:function(b){return b===W&&(b=new se),b.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var C=new se,O=new Ri;return function(U,S){var w=S||O.getNormalMatrix(U),j=this.coplanarPoint(C).applyMatrix4(U),I=this.normal.applyMatrix3(w).normalize();return this.constant=-j.dot(I),this}}(),translate:function(P){return this.constant-=P.dot(this.normal),this},equals:function(z){return z.normal.equals(this.normal)&&z.constant===this.constant}});var df=n.Math.Ray=function(O,o){this.origin=O!==W?O.clone():new se,this.direction=o!==W?o.clone():new se};o.assign(df.prototype,{set:function(H,e){return this.origin.copy(H),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this.maxHitLen=e.maxHitLen,this},at:function(A,f){var W=f||new se;return W.copy(this.direction).multiplyScalar(A).add(this.origin)},setMaxHitLength:function(j){this.maxHitLen=j},lookAt:function(i){return this.direction.copy(i).sub(this.origin).normalize(),this},applyMatrix4:function(w){var $=this.maxHitLen;if($){var c=this.direction.clone().multiplyScalar($).add(this.origin);c.applyMatrix4(w)}return this.origin.applyMatrix4(w),this.direction.transformDirection(w),$&&(this.maxHitLen=this.origin.distanceTo(c)),this},distanceToPlane:function(Z){var u=Z.normal.dot(this.direction);if(0===u)return 0===Z.distanceToPoint(this.origin)?0:null;var y=-(this.origin.dot(Z.normal)+Z.constant)/u;return y>=0?y:null},intersectPlane:function(c,K){var t=this.distanceToPlane(c);return null===t?null:this.at(t,K)},intersectSphere:function(){var T=new se;return function($,k){T.subVectors($.center,this.origin);var L=T.dot(this.direction),K=T.dot(T)-L*L,h=$.radius*$.radius;if(K>h)return null;var M=Math.sqrt(h-K),b=L-M,q=L+M;return 0>b&&0>q?null:0>b?this.at(q,k):this.at(b,k)}}(),intersectEllipsoid:function(){var J=new se,P=new se;return function(z,G){J.subVectors(z.center,this.origin),J.divide(z.radius),P.divideVectors(this.direction,z.radius);var $=P.lengthSq(),X=J.dot(P),O=J.dot(J)*$-X*X;if(O>$)return null;var y=Math.sqrt($-O),p=(X-y)/$,K=(X+y)/$;return 0>p&&0>K?null:0>p?this.at(K,G):this.at(p,G)}}(),intersectBox:function(G,e){var i,S,V,C,z,t,F=1/this.direction.x,W=1/this.direction.y,x=1/this.direction.z,c=this.origin;if(F>=0?(i=(G.min.x-c.x)*F,S=(G.max.x-c.x)*F):(i=(G.max.x-c.x)*F,S=(G.min.x-c.x)*F),W>=0?(V=(G.min.y-c.y)*W,C=(G.max.y-c.y)*W):(V=(G.max.y-c.y)*W,C=(G.min.y-c.y)*W),i>C||V>S)return null;if((V>i||i!==i)&&(i=V),(S>C||S!==S)&&(S=C),x>=0?(z=(G.min.z-c.z)*x,t=(G.max.z-c.z)*x):(z=(G.max.z-c.z)*x,t=(G.min.z-c.z)*x),i>t||z>S)return null;if((z>i||i!==i)&&(i=z),(S>t||S!==S)&&(S=t),0>S)return null;var U=i>=0?i:S,a=this.maxHitLen;return a&&U>a?null:this.at(U,e)},intersectTriangle:function(){var Y=new se,I=new se,C=new se,t=new se;return function(y,Z,P,w,h){I.subVectors(Z,y),C.subVectors(P,y),t.crossVectors(I,C);var $,u=this.direction.dot(t);if(u>0){if(w)return null;$=1}else{if(!(0>u))return null;$=-1,u=-u}Y.subVectors(this.origin,y);var R=$*this.direction.dot(C.crossVectors(Y,C));if(0>R)return null;var k=$*this.direction.dot(I.cross(Y));if(0>k||R+k>u)return null;var j=-$*Y.dot(t);if(0>j)return null;var T=j/u,v=this.maxHitLen;return v&&T>v?null:this.at(T,h)}}()});var Pf=n.Math.Box3=function(M,q){this.min=M!==W?M:new se(1/0,1/0,1/0),this.max=q!==W?q:new se(-1/0,-1/0,-1/0)};o.assign(Pf.prototype,{set:function(t,c){return this.min.copy(t),this.max.copy(c),this},setFromArray:function(J){for(var L=1/0,x=1/0,q=1/0,d=-1/0,n=-1/0,N=-1/0,O=0,f=J.length;f>O;O+=3){var U=J[O],y=J[O+1],v=J[O+2];L>U&&(L=U),x>y&&(x=y),q>v&&(q=v),U>d&&(d=U),y>n&&(n=y),v>N&&(N=v)}return this.min.set(L,x,q),this.max.set(d,n,N),this},setFromPoints:function(b){this.makeEmpty();for(var M=0,s=b.length;s>M;M++)this.expandByPoint(b[M]);return this},clone:function(){return(new this.constructor).copy(this)},intersectsBox:function($){return $.max.x<this.min.x||$.min.x>this.max.x||$.max.y<this.min.y||$.min.y>this.max.y||$.max.z<this.min.z||$.min.z>this.max.z?!1:!0},copy:function(m){return this.min.copy(m.min),this.max.copy(m.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(w){return this.min.min(w),this.max.max(w),this},expandByBox:function(Z){return this.min.min(Z.min),this.max.max(Z.max),this},applyMatrix4:function(){var I=[new se,new se,new se,new se,new se,new se,new se,new se];return function(S){return this.isEmpty()?this:(I[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(S),I[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(S),I[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(S),I[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(S),I[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(S),I[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(S),I[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(S),I[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(S),this.setFromPoints(I),this)}}()});var jr=n.Math.Sphere=function(c,l){this.center=c!==W?c:new se,this.radius=l!==W?l:0};o.assign(jr.prototype,{set:function(w,b){return this.center.copy(w),this.radius=b,this},setFromPoints:function(){var C=new Pf;return function(S,a){var P=this.center;a!==W?P.copy(a):C.setFromPoints(S).getCenter(P);for(var m=0,T=0,h=S.length;h>T;T++)m=Math.max(m,P.distanceToSquared(S[T]));return this.radius=Math.sqrt(m),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(x){return this.center.copy(x.center),this.radius=x.radius,this},empty:function(){return this.radius<=0},containsPoint:function(z){return z.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(Q){return Q.distanceTo(this.center)-this.radius},intersectsSphere:function(F){var T=this.radius+F.radius;return F.center.distanceToSquared(this.center)<=T*T},intersectsBox:function(o){return o.intersectsSphere(this)},intersectsPlane:function(U){return Math.abs(U.distanceToPoint(this.center))<=this.radius},clampPoint:function(o,f){var N=this.center.distanceToSquared(o);return f===W&&(f=new se),f.copy(o),N>this.radius*this.radius&&(f.sub(this.center).normalize(),f.multiplyScalar(this.radius).add(this.center)),f},getBoundingBox:function(V){return V===W&&(V=new Pf),V.set(this.center,this.center),V.expandByScalar(this.radius),V},applyMatrix4:function(b){return this.center.applyMatrix4(b),this.radius=this.radius*b.getMaxScaleOnAxis(),this},translate:function(k){return this.center.add(k),this},equals:function(w){return w.center.equals(this.center)&&w.radius===this.radius}});var bf=n.Math.Frustum=function(z,J,f,V,q,m){this.planes=[z!==W?z:new Dk,J!==W?J:new Dk,f!==W?f:new Dk,V!==W?V:new Dk,q!==W?q:new Dk,m!==W?m:new Dk]};o.assign(bf.prototype,{set:function(R,v,p,g,e,i){var m=this.planes;return m[0].copy(R),m[1].copy(v),m[2].copy(p),m[3].copy(g),m[4].copy(e),m[5].copy(i),this},clone:function(){return(new this.constructor).copy(this)},copy:function(Q){for(var $=this.planes,f=0;6>f;f++)$[f].copy(Q.planes[f]);return this},setFromMatrix:function(s){var g=this.planes,l=s.el,v=l[0],k=l[1],u=l[2],r=l[3],y=l[4],G=l[5],N=l[6],O=l[7],b=l[8],U=l[9],z=l[10],L=l[11],Z=l[12],f=l[13],d=l[14],p=l[15];return g[0].setComponents(r-v,O-y,L-b,p-Z).normalize(),g[1].setComponents(r+v,O+y,L+b,p+Z).normalize(),g[2].setComponents(r+k,O+G,L+U,p+f).normalize(),g[3].setComponents(r-k,O-G,L-U,p-f).normalize(),g[4].setComponents(r-u,O-N,L-z,p-d).normalize(),g[5].setComponents(r+u,O+N,L+z,p+d).normalize(),this},intersectsObject:function(){var t=new jr;return function(s){var V=s.geometry;return null===V.boundingSphere&&V.computeBoundingSphere(),t.copy(V.boundingSphere).applyMatrix4(s.matrixWorld),this.intersectsSphere(t)}}(),intersectsSprite:function(){var E=new jr;return function(D){return E.center.set(0,0,0),E.radius=.7071067811865476,E.applyMatrix4(D.matrixWorld),this.intersectsSphere(E)}}(),intersectsSphere:function(M){for(var h=this.planes,Q=M.center,u=-M.radius,I=0;6>I;I++){var G=h[I].distanceToPoint(Q);if(u>G)return!1}return!0},intersectsBox:function(){var i=new se;return function(W){for(var s=this.planes,Z=0;6>Z;Z++){var o=s[Z];if(i.x=o.normal.x>0?W.max.x:W.min.x,i.y=o.normal.y>0?W.max.y:W.min.y,i.z=o.normal.z>0?W.max.z:W.min.z,o.distanceToPoint(i)<0)return!1}return!0}}(),containsPoint:function(k){for(var q=this.planes,h=0;6>h;h++)if(q[h].distanceToPoint(k)<0)return!1;return!0}});var xn=n.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};o.assign(xn.prototype,{set:function(j,s,r,G,W,k,h,q,X,J,S,m,b,D,t,P){var i=this.el;return i[0]=j,i[4]=s,i[8]=r,i[12]=G,i[1]=W,i[5]=k,i[9]=h,i[13]=q,i[2]=X,i[6]=J,i[10]=S,i[14]=m,i[3]=b,i[7]=D,i[11]=t,i[15]=P,this},clone:function(){return(new xn).fromArray(this.el)},fromArray:function(c,k){k===W&&(k=0);for(var h=this.el,d=0;16>d;d++)h[d]=c[d+k];return this},getElements:function(){return this.el},scale:function(Z){var E=this.el,K=Z.x,u=Z.y,z=Z.z;return E[0]*=K,E[4]*=u,E[8]*=z,E[1]*=K,E[5]*=u,E[9]*=z,E[2]*=K,E[6]*=u,E[10]*=z,E[3]*=K,E[7]*=u,E[11]*=z,this},makeRotationFromEuler:function(a){var H=this.el,o=a._x,t=a._y,u=a._z,P=a._order,R=Math.cos(o),X=Math.sin(o),d=Math.cos(t),z=Math.sin(t),k=Math.cos(u),E=Math.sin(u);if("XYZ"===P){var S=R*k,h=R*E,O=X*k,Y=X*E;H[0]=d*k,H[4]=-d*E,H[8]=z,H[1]=h+O*z,H[5]=S-Y*z,H[9]=-X*d,H[2]=Y-S*z,H[6]=O+h*z,H[10]=R*d}else if("YXZ"===P){var m=d*k,K=d*E,v=z*k,L=z*E;H[0]=m+L*X,H[4]=v*X-K,H[8]=R*z,H[1]=R*E,H[5]=R*k,H[9]=-X,H[2]=K*X-v,H[6]=L+m*X,H[10]=R*d}else if("ZXY"===P){var m=d*k,K=d*E,v=z*k,L=z*E;H[0]=m-L*X,H[4]=-R*E,H[8]=v+K*X,H[1]=K+v*X,H[5]=R*k,H[9]=L-m*X,H[2]=-R*z,H[6]=X,H[10]=R*d}else if("ZYX"===P){var S=R*k,h=R*E,O=X*k,Y=X*E;H[0]=d*k,H[4]=O*z-h,H[8]=S*z+Y,H[1]=d*E,H[5]=Y*z+S,H[9]=h*z-O,H[2]=-z,H[6]=X*d,H[10]=R*d}else if("YZX"===P){var c=R*d,r=R*z,D=X*d,A=X*z;H[0]=d*k,H[4]=A-c*E,H[8]=D*E+r,H[1]=E,H[5]=R*k,H[9]=-X*k,H[2]=-z*k,H[6]=r*E+D,H[10]=c-A*E}else if("XZY"===P){var c=R*d,r=R*z,D=X*d,A=X*z;H[0]=d*k,H[4]=-E,H[8]=z*k,H[1]=c*E+A,H[5]=R*k,H[9]=r*E-D,H[2]=D*E-r,H[6]=X*k,H[10]=A*E+c}return H[3]=0,H[7]=0,H[11]=0,H[12]=0,H[13]=0,H[14]=0,H[15]=1,this},makeRotationFromQuaternion:function(j){var a=this.el,D=j._x,R=j._y,Y=j._z,r=j._w,w=D+D,W=R+R,p=Y+Y,q=D*w,y=D*W,h=D*p,d=R*W,f=R*p,e=Y*p,z=r*w,l=r*W,N=r*p;return a[0]=1-(d+e),a[4]=y-N,a[8]=h+l,a[1]=y+N,a[5]=1-(q+e),a[9]=f-z,a[2]=h-l,a[6]=f+z,a[10]=1-(q+d),a[3]=0,a[7]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(u){var S=this.el,b=u.el,T=b[0],z=b[1],y=b[2],Q=b[3],P=b[4],o=b[5],X=b[6],t=b[7],g=b[8],U=b[9],_=b[10],p=b[11],a=b[12],h=b[13],R=b[14],d=b[15],r=U*R*t-h*_*t+h*X*p-o*R*p-U*X*d+o*_*d,f=a*_*t-g*R*t-a*X*p+P*R*p+g*X*d-P*_*d,m=g*h*t-a*U*t+a*o*p-P*h*p-g*o*d+P*U*d,O=a*U*X-g*h*X-a*o*_+P*h*_+g*o*R-P*U*R,I=T*r+z*f+y*m+Q*O;if(0===I)return this.identity();var e=1/I;return S[0]=r*e,S[1]=(h*_*Q-U*R*Q-h*y*p+z*R*p+U*y*d-z*_*d)*e,S[2]=(o*R*Q-h*X*Q+h*y*t-z*R*t-o*y*d+z*X*d)*e,S[3]=(U*X*Q-o*_*Q-U*y*t+z*_*t+o*y*p-z*X*p)*e,S[4]=f*e,S[5]=(g*R*Q-a*_*Q+a*y*p-T*R*p-g*y*d+T*_*d)*e,S[6]=(a*X*Q-P*R*Q-a*y*t+T*R*t+P*y*d-T*X*d)*e,S[7]=(P*_*Q-g*X*Q+g*y*t-T*_*t-P*y*p+T*X*p)*e,S[8]=m*e,S[9]=(a*U*Q-g*h*Q-a*z*p+T*h*p+g*z*d-T*U*d)*e,S[10]=(P*h*Q-a*o*Q+a*z*t-T*h*t-P*z*d+T*o*d)*e,S[11]=(g*o*Q-P*U*Q-g*z*t+T*U*t+P*z*p-T*o*p)*e,S[12]=O*e,S[13]=(g*h*y-a*U*y+a*z*_-T*h*_-g*z*R+T*U*R)*e,S[14]=(a*o*y-P*h*y-a*z*X+T*h*X+P*z*R-T*o*R)*e,S[15]=(P*U*y-g*o*y+g*z*X-T*U*X-P*z*_+T*o*_)*e,this},makeRotationAxis:function(M,P){var Q=Math.cos(P),e=Math.sin(P),T=1-Q,b=M.x,l=M.y,X=M.z,Z=T*b,p=T*l;return this.set(Z*b+Q,Z*l-e*X,Z*X+e*l,0,Z*l+e*X,p*l+Q,p*X-e*b,0,Z*X-e*l,p*X+e*b,T*X*X+Q,0,0,0,0,1),this},multiply:function(K){return this.multiplyMatrices(this,K)},premultiply:function(R){return this.multiplyMatrices(R,this)},multiplyMatrices:function(p,B){var c=p.el,T=B.el,h=this.el,E=c[0],W=c[4],X=c[8],w=c[12],y=c[1],U=c[5],P=c[9],Q=c[13],q=c[2],V=c[6],g=c[10],s=c[14],H=c[3],K=c[7],m=c[11],Z=c[15],i=T[0],S=T[4],j=T[8],n=T[12],l=T[1],r=T[5],R=T[9],A=T[13],e=T[2],J=T[6],x=T[10],Y=T[14],k=T[3],N=T[7],O=T[11],M=T[15];return h[0]=E*i+W*l+X*e+w*k,h[4]=E*S+W*r+X*J+w*N,h[8]=E*j+W*R+X*x+w*O,h[12]=E*n+W*A+X*Y+w*M,h[1]=y*i+U*l+P*e+Q*k,h[5]=y*S+U*r+P*J+Q*N,h[9]=y*j+U*R+P*x+Q*O,h[13]=y*n+U*A+P*Y+Q*M,h[2]=q*i+V*l+g*e+s*k,h[6]=q*S+V*r+g*J+s*N,h[10]=q*j+V*R+g*x+s*O,h[14]=q*n+V*A+g*Y+s*M,h[3]=H*i+K*l+m*e+Z*k,h[7]=H*S+K*r+m*J+Z*N,h[11]=H*j+K*R+m*x+Z*O,h[15]=H*n+K*A+m*Y+Z*M,this},lookAt:function(){var z=new se;return function(X,I,f){return z.subVectors(X,I),this.lookAtDirection(z,f)}}(),lookAtDirection:function(){var h=new se,E=new se,c=new se;return function($,A){A||(A=se.UP);var u=this.el;return c.copy($),0===c.lengthSq()&&(c.z=1),c.normalize(),h.crossVectors(A,c),0===h.lengthSq()&&(1===Math.abs(A.z)?c.x+=1e-4:c.z+=1e-4,c.normalize(),h.crossVectors(A,c)),h.normalize(),E.crossVectors(c,h),u[0]=h.x,u[4]=E.x,u[8]=c.x,u[1]=h.y,u[5]=E.y,u[9]=c.y,u[2]=h.z,u[6]=E.z,u[10]=c.z,this}}(),extractScale:function(){var z;return function(p){z===W&&(z=new se),p===W&&(p=new se);var e=z.setFromMatrixColumn(this,0).length(),m=z.setFromMatrixColumn(this,1).length(),F=z.setFromMatrixColumn(this,2).length();return p.set(e,m,F),p}}(),extractRotation:function(){var s;return function(i){s===W&&(s=new se),i===W&&(i=new xn);var H=this.el,x=i.el,e=1/s.setFromMatrixColumn(i,0).length(),V=1/s.setFromMatrixColumn(i,1).length(),o=1/s.setFromMatrixColumn(i,2).length();return H[0]=x[0]*e,H[1]=x[1]*e,H[2]=x[2]*e,H[4]=x[4]*V,H[5]=x[5]*V,H[6]=x[6]*V,H[8]=x[8]*o,H[9]=x[9]*o,H[10]=x[10]*o,this}}(),multiplyScalar:function(p){var y=this.el;return y[0]*=p,y[4]*=p,y[8]*=p,y[12]*=p,y[1]*=p,y[5]*=p,y[9]*=p,y[13]*=p,y[2]*=p,y[6]*=p,y[10]*=p,y[14]*=p,y[3]*=p,y[7]*=p,y[11]*=p,y[15]*=p,this},getPosition:function($){return $===W&&($=new se),$.setFromMatrixColumn(this,3)},setPosition:function(J){var Z=this.el;return Z[12]=J.x,Z[13]=J.y,Z[14]=J.z,this},toArray:function(u,w){u===W&&(u=[]),w===W&&(w=0);var a=this.el;return u[w]=a[0],u[w+1]=a[1],u[w+2]=a[2],u[w+3]=a[3],u[w+4]=a[4],u[w+5]=a[5],u[w+6]=a[6],u[w+7]=a[7],u[w+8]=a[8],u[w+9]=a[9],u[w+10]=a[10],u[w+11]=a[11],u[w+12]=a[12],u[w+13]=a[13],u[w+14]=a[14],u[w+15]=a[15],u},determinant:function(){var T=this.el,r=T[0],U=T[4],l=T[8],u=T[12],O=T[1],h=T[5],C=T[9],y=T[13],g=T[2],w=T[6],Q=T[10],m=T[14],P=T[3],x=T[7],L=T[11],S=T[15];return P*(+u*C*w-l*y*w-u*h*Q+U*y*Q+l*h*m-U*C*m)+x*(+r*C*m-r*y*Q+u*O*Q-l*O*m+l*y*g-u*C*g)+L*(+r*y*w-r*h*m-u*O*w+U*O*m+u*h*g-U*y*g)+S*(-l*h*g-r*C*w+r*h*Q+l*O*w-U*O*Q+U*C*g)},copy:function($){var X=this.el,D=$.el;return X[0]=D[0],X[1]=D[1],X[2]=D[2],X[3]=D[3],X[4]=D[4],X[5]=D[5],X[6]=D[6],X[7]=D[7],X[8]=D[8],X[9]=D[9],X[10]=D[10],X[11]=D[11],X[12]=D[12],X[13]=D[13],X[14]=D[14],X[15]=D[15],this},compose:function(W,v,f){var D=this.el,t=v._x,K=v._y,z=v._z,F=v._w,X=t+t,J=K+K,e=z+z,s=t*X,H=t*J,A=t*e,G=K*J,o=K*e,L=z*e,h=F*X,i=F*J,S=F*e,c=f.x,a=f.y,B=f.z;return D[0]=(1-(G+L))*c,D[1]=(H+S)*c,D[2]=(A-i)*c,D[3]=0,D[4]=(H-S)*a,D[5]=(1-(s+L))*a,D[6]=(o+h)*a,D[7]=0,D[8]=(A+i)*B,D[9]=(o-h)*B,D[10]=(1-(s+G))*B,D[11]=0,D[12]=W.x,D[13]=W.y,D[14]=W.z,D[15]=1,this
},decompose:function(){var $=new se,s=new xn;return function(V,I,H){var Z=this.el,R=$.set(Z[0],Z[1],Z[2]).length(),y=$.set(Z[4],Z[5],Z[6]).length(),t=$.set(Z[8],Z[9],Z[10]).length(),b=this.determinant();0>b&&(R=-R),V.x=Z[12],V.y=Z[13],V.z=Z[14],s.copy(this);var W=1/R,f=1/y,w=1/t;return s.el[0]*=W,s.el[1]*=W,s.el[2]*=W,s.el[4]*=f,s.el[5]*=f,s.el[6]*=f,s.el[8]*=w,s.el[9]*=w,s.el[10]*=w,I.setFromRotationMatrix(s),H.x=R,H.y=y,H.z=t,this}}()});var Oj=n.Math.Triangle=function(s,h,S){this.a=s!==W?s:new se,this.b=h!==W?h:new se,this.c=S!==W?S:new se};o.assign(Oj,{barycoordFromPoint:function(){var d=new se,u=new se,o=new se;return function(i,G,K,j,N){d.subVectors(j,G),u.subVectors(K,G),o.subVectors(i,G);var O=d.dot(d),C=d.dot(u),y=d.dot(o),P=u.dot(u),R=u.dot(o),H=O*P-C*C,q=N||new se;if(0===H)return q.set(-2,-1,-1);var F=1/H,Z=(P*y-C*R)*F,v=(O*R-C*y)*F;return q.set(1-Z-v,v,Z)}}(),uvIntersection:function(){var J=new se;return function(C,H,Y,z,B,h,V){return Oj.barycoordFromPoint(C,H,Y,z,J),B.multiplyScalar(J.x),h.multiplyScalar(J.y),V.multiplyScalar(J.z),B.add(h).add(V),B.clone()}}()});var pq=n.Math.Euler=function(_,a,j,Y,O){this.set(_,a,j,Y,O)};pq.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],pq.DefaultOrder="XYZ",pq.ReverseOrder=function(){var s={xyz:"ZYX",xzy:"YZX",yxz:"ZXY",yzx:"XZY",zxy:"YXZ",zyx:"XYZ"};return function(O){return s[O]}}(),o.defineProperties(pq.prototype,{x:{get:function(){return this._x},set:function(x){this._x=x,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(x){this._y=x,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(g){this._z=g,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(j){this._order=j,this.onChangeCallback()}}}),o.assign(pq.prototype,{set:function(V,k,v,H,R){return Td(V)&&(R=v,H=k,v=V[2],k=V[1],V=V[0]),H?R&&(H=pq.ReverseOrder(H)):H="ZYX",this._x=V||0,this._y=k||0,this._z=v||0,this._order=H||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(U){return this._x=U._x,this._y=U._y,this._z=U._z,this._order=U._order,this.onChangeCallback(),this},setFromRotationMatrix:function(p,i,e){var A=n.Math.clamp,B=p.el||p,g=B[0],O=B[4],S=B[8],H=B[1],m=B[5],R=B[9],$=B[2],T=B[6],K=B[10];return i=i||this._order,"XYZ"===i?(this._y=Math.asin(A(S,-1,1)),Math.abs(S)<.99999?(this._x=Math.atan2(-R,K),this._z=Math.atan2(-O,g)):(this._x=Math.atan2(T,m),this._z=0)):"YXZ"===i?(this._x=Math.asin(-A(R,-1,1)),Math.abs(R)<.99999?(this._y=Math.atan2(S,K),this._z=Math.atan2(H,m)):(this._y=Math.atan2(-$,g),this._z=0)):"ZXY"===i?(this._x=Math.asin(A(T,-1,1)),Math.abs(T)<.99999?(this._y=Math.atan2(-$,K),this._z=Math.atan2(-O,m)):(this._y=0,this._z=Math.atan2(H,g))):"ZYX"===i?(this._y=Math.asin(-A($,-1,1)),Math.abs($)<.99999?(this._x=Math.atan2(T,K),this._z=Math.atan2(H,g)):(this._x=0,this._z=Math.atan2(-O,m))):"YZX"===i?(this._z=Math.asin(A(H,-1,1)),Math.abs(H)<.99999?(this._x=Math.atan2(-R,m),this._y=Math.atan2(-$,g)):(this._x=0,this._y=Math.atan2(S,K))):"XZY"===i?(this._z=Math.asin(-A(O,-1,1)),Math.abs(O)<.99999?(this._x=Math.atan2(T,m),this._y=Math.atan2(S,g)):(this._x=Math.atan2(-R,K),this._y=0)):console.warn("unsupported order: "+i),this._order=i,e!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var C=new xn;return function(L,Y,K){return C.makeRotationFromQuaternion(L),this.setFromRotationMatrix(C,Y,K)}}(),setFromVector3:function(o,X){return this.set(o.x,o.y,o.z,X||this._order)},reorder:function(){var A=new Mq;return function(K){return A.setFromEuler(this),this.setFromQuaternion(A,K)}}(),equals:function(n){return n._x===this._x&&n._y===this._y&&n._z===this._z&&n._order===this._order},fromArray:function(s){return this._x=s[0],this._y=s[1],this._z=s[2],s[3]!==W&&(this._order=s[3]),this.onChangeCallback(),this},toArray:function(S,t){return S===W&&(S=[]),t===W&&(t=0),S[t]=this._x,S[t+1]=this._y,S[t+2]=this._z,S[t+3]=this._order,S},toVector3:function(E){return E?E.set(this._x,this._y,this._z):new se(this._x,this._y,this._z)},onChange:function(Q){return this.onChangeCallback=Q,this},onChangeCallback:function(){}});var Ep={ms_ac:function(O,P){for(var t=P.ms_ac,M=0;M<t.length;M++)Uk(O,t[M])},ms_listener:function(D){D.addListeners=function(){var Z=this,o=Pl;H.mockTouch&&(o=Hk.concat(jp).concat(ym)),Z.__events__=o;for(var s=0,Q=o.length;Q>s;s++){var B=o[s];"wheel"===B&&!Z.handle_wheel&&Z.handle_mousewheel&&(Z.handle_wheel=function(Q){fc(Z,Q)}),Z["handle_"+B]&&vo(B,Z.getView(),Z)}},D.removeListeners=function(){var x=this,B=x.__events__;if(B){x.__events__=W;for(var R=0,q=B.length;q>R;R++)x["handle_"+B[R]]&&Aj(B[R],x.getView(),x)}}},ms_fire:function(D){D.mp=function(c,D,H){this.addPropertyChangeListener(c,D,H)},D.ump=function(f,g){this.removePropertyChangeListener(f,g)},D.fp=function(y,R,k,n,T){return this.firePropertyChange(y,R,k,n,T)},D.addPropertyChangeListener=function(R,e,m){var i=this;i._62I||(i._62I=new Kd),i._62I.add(R,e,m)},D.removePropertyChangeListener=function(n,o){this._62I&&this._62I.remove(n,o)},D.firePropertyChange=function(r,Q,D,I,T){if(I){if(I(Q,D))return!1}else if(Q===D)return!1;var u=this,q=T||{};return q.property=r,q.oldValue=Q,q.newValue=D,q.source=u,q.data=u,u._62I&&u._62I.fire(q),u.onPropertyChanged&&u.onPropertyChanged(q),!0}},ms_attr:function(C){C.a=function(e,q){var C=this;if(2===arguments.length)C.setAttr(e,q);else{if(!Il(e))return C.getAttr(e);for(var s in e)C.setAttr(s,e[s])}return C},C.getAttr=function(h,r){if(r===W&&(r=1),this._attrObject&&h in this._attrObject)return this._attrObject[h];if(this.getImage){var A=this.getImage();if(xd(A)&&(A=pp[A]),Il(A)&&"dataBindings"in A)for(var o=A.dataBindings,b=o.length-1;b>=0;b--){var x=o[b];if(x.attr===h){if("defaultValue"in x)return x.defaultValue;break}}}return r?w[h]:W},C.setAttr=function(k,M){var H=this;H._attrObject||(H._attrObject={});var h=H._attrObject[k];M===W?delete H._attrObject[k]:H._attrObject[k]=M,H.fp&&H.fp("a:"+k,h,M)&&H.onAttrChanged&&H.onAttrChanged(k,h,M)},C.getSerializableAttrs=function(){var q,i={};for(q in this._attrObject)i[q]=1;return i}},ms_bnb:function(R){R.getBodyColor=function(b){return b.s("body.color")},R.getBorderColor=function(T){return T.s("border.color")}},_51o:function(y){y.mi=function(s,U,S){this.addInteractorListener(s,U,S)},y.umi=function(E,$){this.removeInteractorListener(E,$)},y.fi=function(o){this.fireInteractorEvent(o)},y.addInteractorListener=function(K,W,F){var L=this;L._63I||(L._63I=new Kd),L._63I.add(K,W,F)},y.removeInteractorListener=function(m,t){this._63I&&this._63I.remove(m,t)},y.fireInteractorEvent=function(h){this._63I&&this._63I.fire(h)},y.setInteractors=function(A){var X=this,V=X._interactors;V&&V.each(function(L){L.tearDown()}),Td(A)&&(A=new Xd(A)),X._interactors=A,A&&A.each(function(X){X.setUp()}),X.fp("interactors",V,A),X.invalidateSelection()},y.getInteractors=function(){return this._interactors}},_49o:function(W){W._44O=S,W._45O=S,W.getTopPainters=function(){return this._44O},W.getBottomPainters=function(){return this._45O},W.addTopPainter=function(p){var N=this;N._44O||(N._44O=new Xd),N._44O.contains(p)||(N._44O.add(p),N.redraw&&N.redraw())},W.removeTopPainter=function(Y){var t=this;t._44O&&(t._44O.remove(Y),t.redraw&&t.redraw())},W.addBottomPainter=function(u){var x=this;x._45O||(x._45O=new Xd),x._45O.contains(u)||(x._45O.add(u),x.redraw&&x.redraw())},W.removeBottomPainter=function(h){var t=this;t._45O&&(t._45O.remove(h),t.redraw&&t.redraw())},W._93db=function(n,E){var J=this;J._45O&&J._45O.each(function(G){G.draw?G.draw(n,E):G.call(J,n,E)})},W._92db=function(y,V){var c=this;c._44O&&c._44O.each(function(w){w.draw?w.draw(y,V):w.call(c,y,V)})}},ms_sm:function(t){t.sm=function(){return this.getSelectionModel()},t.setSelectableFunc=function(v){this.sm().setFilterFunc(v)},t.getSelectableFunc=function(){return this.sm().getFilterFunc()},t.getSelectionModel=function(){var e=this;return e._selectionModel?e._selectionModel:e.dm().sm()},t.isSelectionModelShared=function(){return!this._selectionModel},t.setSelectionModelShared=function(D){var f=this,P=f.sm(),t=!f._selectionModel,r=f.handleSelectionChange,z=f.dm();t!==D&&(f.invalidateSelection&&f.invalidateSelection(),D?(z.sm().ms(r,f),f._selectionModel.ums(r,f),f._selectionModel.dispose(),f._selectionModel=S):(z.sm().ums(r,f),f._selectionModel=new cb(z),f._selectionModel.ms(r,f)),f.onSelectionModelSharedChanged(),f.fp("selectionModelShared",t,D),f.fireViewEvent({kind:"selectionModelSharedChange",oldValue:t,newValue:D,oldSelectionModel:P,newSelectionModel:f.sm()}))},t.onSelectionModelSharedChanged=function(){var Z=this;Z.redraw(),Z.invalidateSelection&&Z.invalidateSelection()},t.removeSelection=function(){var s=this.dm();s.beginTransaction(),this.sm().toSelection().each(s.remove,s),s.endTransaction()},t.selectAll=function(){var l=this;l.sm().ss(l.dm().toDatas(function(j){return l.isVisible(j)&&l.isSelectable(j)}))},t.isSelected=function(o){return this.sm().co(o)},t.isSelectedById=function(c){var k=this.dm().getDataById(c);return k?this.isSelected(k):!1},t.isSelectable=function(H){return this.sm().isSelectable(H)}},ms_tx:function(D){D._64I=0,D._65O=0,D.isScrollable=function(){return this.getWidth()<this._64I},D._40o=function(){return this.isScrollable()},D.getLogicalPoint=function(Y){return Ib(Y,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},D.tx=function(m){return m===W?this.getTranslateX():(this.setTranslateX(m),void 0)},D.getTranslateX=function(){return this._65O},D.setTranslateX=function(A){var p=this,I=p.getWidth()-p._64I;I>A&&(A=I),A>0&&(A=0),A=b(A);var E=p._65O;p._65O=A,p.fp(Ih,E,A)}},ms_ty:function(O){O._23Q=0,O._66O=0,O._41o=function(){return this.getHeight()<this._23Q},O.getLogicalPoint=function(v){return Ib(v,this._canvas||this._view,this.tx?this.tx():0,this.ty())},O.ty=function(Q){return Q===W?this.getTranslateY():(this.setTranslateY(Q),void 0)},O.getTranslateY=function(){return this._66O},O.setTranslateY=function(z){var Z=this,p=Z.getHeight()-Z._23Q;p>z&&(z=p),z>0&&(z=0),z=b(z);var D=Z._66O;Z._66O=z,Z.fp(xi,D,z)}},ms_txy:function(S){S._65O=0,S._66O=0,S.tx=function(r){return r===W?this.getTranslateX():(this.setTranslateX(r),void 0)},S.ty=function(A){return A===W?this.getTranslateY():(this.setTranslateY(A),void 0)},S.onTranslateEnded=function(){},S.setTranslate=function(A,D,s){var Q=this;if(s=qd(s)){Q._65I&&Q._65I.stop(!0);var t=Q.tx(),r=Q.ty();s.action=function(s){Q.setTranslate(t+(A-t)*s,r+(D-r)*s)},s._37o=function(){delete Q._66I,delete Q._65I,Q.onTranslateEnded()},Q._66I=1,Q._65I=Xm(s)}else Q.tx(A),Q.ty(D)},S.getTranslateX=function(){return this._65O},S.setTranslateX=function(b){var P=this;b=P.adjustTranslateX(b);var C=P._65O;P._65O=b,P.fp(Ih,C,b)},S.getTranslateY=function(){return this._66O},S.setTranslateY=function(E){var M=this;E=M.adjustTranslateY(E);var m=M._66O;M._66O=E,M.fp(xi,m,E)},S.adjustTranslateX=function(V){return b(V)},S.adjustTranslateY=function(V){return b(V)},S.translate=function(D,r,A){this.setTranslate(this.tx()+D,this.ty()+r,A)},S.getLogicalPoint=function(h){var j=this;return Ib(h,this._canvas||j._view,j.tx(),j.ty())}},ms_dm:function(u){u.dm=function(y){return y?(this.setDataModel(y),void 0):this.getDataModel()},u.getDataModel=function(){return this._dataModel}},ms_lp:function(e){e.lp=function(g){return this.getLogicalPoint(g)}},ms_v:function(t){t._disabled=!1,t.setDisabled=function(c,z){var I=this,p=I._disabled;p!==c&&(p&&(re(I._63O),delete I._63O),c&&(wf(I._view,I._63O=Yj(z)),I.iv()),I._disabled=c,I.fp("disabled",p,c))},t.isDisabled=function(){return this._disabled},t.getDisabledDiv=function(){return this._63O},t.getView=function(){return this._view},t.addToDOM=function(u){var r=this,A=r.getView(),B=A.style;u=u||m.body,u.appendChild(A),B.left="0",B.right="0",B.top="0",B.bottom="0",Z(e,"resize",function(){r.iv()}),r.iv()},t.setCursor=function(E){"default"===E&&(E=this._defaultCursor||E);var M=this.getView().style;M.cursor=E,M.cursor="-webkit-"+E,M.cursor="-moz-"+E},t.getWidth=function(){return this._view.clientWidth},t.getHeight=function(){return this._view.clientHeight},t.setWidth=function(A){var k=this;k._view.style.width=A+Kl,k.iv(),k.fp&&k.fp(ye,S,A)},t.setHeight=function(t){var y=this;y._view.style.height=t+Kl,y.iv(),y.fp&&y.fp(yg,S,t)},t.setFocus=function(L){var C=this,E=C._currentEditor;return L&&E&&(E.getView&&(E=E.getView()),E.contains(L.target))?!1:(cg(C._view),C.endEditing&&C.endEditing(),C.fireViewEvent("focus"),!0)},t.iv=function(O){this.invalidate(O)},t.invalidate=function(v){var K=this;K._68I||(K._68I=1,Pm(K.validate,K,S,v),K.onInvalidated&&K.onInvalidated(),K.fireViewEvent("invalidate"))},t.validate=function(){var y=this,x=y._view;if(y._68I&&(delete y._68I,x.parentNode))if(0===x.offsetWidth&&0===x.offsetHeight&&y._67I!==S)y._67I===W&&(y._67I=H.reinvalidateCount),y._67I>0?y._67I--:y._67I=S,y.iv();else{y.fireViewEvent("beginValidate"),y.validateImpl(),y.onValidated&&y.onValidated(),y.fireViewEvent("validate");var Y=y._63O;Y&&(x.lastChild!==Y&&(re(Y),wf(x,Y)),Pg(Y,0,0,y.getWidth(),y.getHeight())),Kp(y),zq(y),nq(y)}},t.layout=function(x,t,G,e){1===arguments.length?Pg(this,x):Pg(this,x,t,G,e)},t.addViewListener=function(E,p,d){var F=this;F._67O||(F._67O=new Kd),F._67O.add(E,p,d)},t.removeViewListener=function(R,c){this._67O.remove(R,c)},t.fireViewEvent=function(O){var M=this;M._67O&&(xd(O)&&(O={kind:O}),M._67O.fire(O)),H.viewListener&&H.viewListener(M,O)}},ms_tip:function(K){K.setToolTipEnabled=function(S){var k=this;S?bc||k._13o||(k.enableToolTip(),k.fp("toolTipEnabled",!1,!0)):k._13o&&(k.disableToolTip(),k.fp("toolTipEnabled",!0,!1))},K.isToolTipEnabled=function(){return!!this._13o},K.enableToolTip=function(){var G=this;if(!bc&&!G._13o){G._13o=function(T){var A=G.getToolTip(T);A!=S?(H.toolTipContinual&&H.isToolTipShowing()?$g(T,A):(Qm(),Li={timeout:Yk(jl,uh),e:T,info:A}),on={e:T,view:G}):Qm()};var w=G.getView();Z(w,ag,G._13o),Z(w,"mouseleave",H.hideToolTip)}},K.disableToolTip=function(){var W=this;if(W._13o){var y=W.getView();N(y,ag,W._13o),N(y,"mouseleave",H.hideToolTip),delete W._13o}},K.getToolTip=function(L){var X=this;if(X.getDataAt){var s=X.getDataAt(L);return s?s.getToolTip():S}return X.getValue?X.getValue():void 0}},_52o:function(L){L._zoom=1,L._29I=kq,L.zoomIn=function(I,M){this.setZoom(this._zoom*_c,I,M)},L.zoomOut=function(k,z){this.setZoom(this._zoom/_c,k,z)},L.zoomReset=function(x,Z){this.setZoom(1,x,Z)},L.scrollZoomIn=function(G){this.setZoom(this._zoom*Ie,S,G)},L.scrollZoomOut=function(K){this.setZoom(this._zoom/Ie,S,K)},L.pinchZoomIn=function(a){this.setZoom(this._zoom*Xe,S,a)},L.pinchZoomOut=function(r){this.setZoom(this._zoom/Xe,S,r)},L.adjustZoom=function(Y){return Cl>Y?Cl:Y>qr?qr:Y},L.getZoom=function(){return this._zoom},L.setZoom=function(L,G,v){var $=this;if(G=qd(G)){$._14o&&$._14o.stop(!0);var S=$._zoom;G.action=function(Z){$._96O(S+(L-S)*Z,v)},G._37o=function(){delete $._zooming,delete $._14o,$.onZoomEnded()},$._zooming=1,$._14o=Xm(G)}else $._96O(L,v)},L._96O=function(f,U){var S=this;if(f=S.adjustZoom(f),f!==S._zoom){S.validate();var u=S._29I,j=S._zoom;0!==u.width&&0!==u.height&&(U=U?U:{x:u.x+u.width/2,y:u.y+u.height/2},S.tx((U.x-u.x)*j-U.x*f),S.ty((U.y-u.y)*j-U.y*f)),S._zoom=f,S.fp("zoom",j,f)}}},ms_edge:function(I){I._2I=function(M){var C=this;C._44I||(C._44I=new Xd),C._42I||(C._42I=new Xd),C._44I.add(M),C._42I.add(M),C._20I()},I._4I=function(C){var J=this;J._44I||(J._44I=new Xd),J._43I||(J._43I=new Xd),J._44I.add(C),J._43I.add(C),J._20I()},I._16I=function(r){var z=this;z._44I.remove(r),z._42I.remove(r),z._44I.isEmpty()&&delete z._44I,z._42I.isEmpty()&&delete z._42I,z._20I()},I._18I=function(n){var I=this;I._44I.remove(n),I._43I.remove(n),I._44I.isEmpty()&&delete I._44I,I._43I.isEmpty()&&delete I._43I,I._20I()},I._20I=function(){var G=this;if(delete G._45I,!G._44I||G._44I.isEmpty())return delete G._70O,void 0;var e;G._44I.each(function($){$.isLooped()&&(e||(e={}),e[$._id]||(G._45I||(G._45I=new Xd),G._45I.add($),e[$._id]=$))}),e?(G._70O=new Xd,G._44I.each(function(w){e[w._id]?"A"===e[w._id]||(e[w._id]="A",G._70O.add(w)):G._70O.add(w)})):G._70O=G._44I},I.hasAgentEdges=function(){return!!this._49I&&!this._49I.isEmpty()},I.getSourceAgentEdges=function(){return this._46I},I.getTargetAgentEdges=function(){return this._47I},I._1I=function($){var x=this;x._46I||(x._46I=new Xd),x._48I||(x._48I=new Xd),x._46I.add($),x._48I.add($),x._19I()},I._3I=function(I){var o=this;o._47I||(o._47I=new Xd),o._48I||(o._48I=new Xd),o._47I.add(I),o._48I.add(I),o._19I()},I._15I=function(Q){var r=this;r._46I.remove(Q),r._48I.remove(Q),r._46I.isEmpty()&&delete r._46I,r._48I.isEmpty()&&delete r._48I,r._19I()},I._17I=function(J){var h=this;h._47I.remove(J),h._48I.remove(J),h._47I.isEmpty()&&delete h._47I,h._48I.isEmpty()&&delete h._48I,h._19I()},I._19I=function(){var Y=this;delete Y._49I;var h=Y._48I;if(h&&!h.isEmpty()){var s={};h.each(function(h){s[h._id]?Y._49I||(Y._49I=new Xd):s[h._id]=h}),Y._49I?h.each(function(W){s[W._id]&&(Y._49I.add(W),delete s[W._id])}):Y._49I=h}},I.getLoopedEdges=function(){return this._45I},I.getEdges=function(){return this._70O},I.getAgentEdges=function(){return this._49I},I.getSourceEdges=function(){return this._42I},I.getTargetEdges=function(){return this._43I},I._8I=function(){this._70O&&this._70O.each(function(F){F._7I()})}}};kk(H,{getVersion:function(){return"7.2.8"}},!0);var Xi=function(e){return e.devicePixelRatio?e.devicePixelRatio:e.screen&&e.screen.logicalXDPI?e.screen.deviceXDPI/e.screen.logicalXDPI:1};kk(H,{numberDigits:5,crossOrigin:"",baseZIndex:W,isTouchable:bc,mockTouch:!0,devicePixelRatio:Xi(e),reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:h.disabledBackground,forceHierarchicalSerialization:!0,extractBatchTranslation:!1,extractShapeTranslation:!1,extractPolylineTranslation:!1,extractVerticesTranslation:!1,envmapProbeMinWaitTime:300,envmapProbeMaxWaitTime:25e3,EnvmapTextureSize:1024,hoverDelay:600,clickDelay:200,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return nm},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],blockMinSize:1,textExtraWidth:4,encodeStringKey:null,doubleClickSpeed:500,doubleClickRange:1,doubleTouchRange:20,touchMoveThreshold:10,animDuration:200,animEasing:function(c){return c*c},labelColor:dh,labelSelectColor:Sl,labelFont:"12px arial, sans-serif",widgetIndent:bc?30:20,widgetRowHeight:bc?30:20,widgetHeaderHeight:bc?32:22,widgetTitleHeight:bc?34:24,scrollBarColor:Qo,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:bc?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,pinchZoomThreshold:1,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:Ko,intersectionLineLine:xf,isEnter:Db,isEsc:Jr,isDelete:zn,isSpace:vr,isLeft:Lp,isUp:dl,isRight:Nr,isDown:Se,isTouchEvent:Aq,getTarget:Bj,isString:xd,isNumber:ff,isBoolean:an,isArray:Td,isSelectAll:xo,isFunction:Qj,isObject:Il,getPropertyValue:yi,setPropertyValue:ae,addMethod:kk,createGradient:function(C,X,K,$,k,f,Q,c){var r=$p[X];return r(C,K,$,k,f,Q,c)},appendToScreen:function(o){o=o.getView?o.getView():o,(m.fullscreenElement||m.mozFullScreenElement||m.webkitFullscreenElement||m.msFullscreenElement||m.body).appendChild(o)},encodeString:function(h){return n.Math.encodeBase64(h,H.encodeStringKey)},decodeString:function(C){return n.Math.decodeBase64(C,H.encodeStringKey)},findView:function(j){var q=function(Q,N){var U=N._ht;U&&Q.push(U);var Y=N.children,l=Y.length;if(l)for(var $=0;l>$;$++)q(Q,Y[$])},A=[];q(A,m.body);var c=function(I,L){for(var i="2d"===L?Sb.GraphView:ko.Graph3dView,w=0,q=I.length;q>w;w++)if(I[w]instanceof i)return A[w];return null};return"all"===j?A:"2d"===j?c(A,"2d"):"3d"===j?c(A,"3d"):c(A,"3d")||c(A,"2d")},toggleFullscreen:function(c){var T=c.getView();if(m.fullscreenElement||m.mozFullScreenElement||m.webkitFullscreenElement||m.msFullscreenElement)m.exitFullscreen?m.exitFullscreen():m.msExitFullscreen?m.msExitFullscreen():m.mozCancelFullScreen?m.mozCancelFullScreen():m.webkitExitFullscreen&&m.webkitExitFullscreen();else{var Z=!0;if(c.isSelfViewEvent){var Y=c.getX(),a=c.getY(),u=c.getWidth(),E=c.getHeight(),S=T.style.background,J=T.style.backgroundColor;S||J||(T.style.backgroundColor="white"),T.requestFullscreen?T.requestFullscreen():T.msRequestFullscreen?T.msRequestFullscreen():T.mozRequestFullScreen?T.mozRequestFullScreen():T.webkitRequestFullscreen&&T.webkitRequestFullscreen();var D=setInterval(function(){if(T!==(m.fullscreenElement||m.mozFullScreenElement||m.webkitFullscreenElement||m.msFullscreenElement))clearInterval(D),c.setX(Y),c.setY(a),c.setWidth(u),c.setHeight(E),c._fullscreen=!1,T.style.oldBackgroundColor=J,c.iv();else{var M=n.Default.getWindowInfo();(Z||M.width!==c.getWidth()||M.height!==c.getHeight())&&(c.setX(M.left),c.setY(M.top),c.setWidth(M.width),c.setHeight(M.height),c._fullscreen=!0,c.iv(),Z=!1)}},500)}else{var G=T.style.left,l=T.style.top,u=T.style.width,E=T.style.height,S=T.style.background,J=T.style.backgroundColor;S||J||(T.style.backgroundColor="white"),T.requestFullscreen?T.requestFullscreen():T.msRequestFullscreen?T.msRequestFullscreen():T.mozRequestFullScreen?T.mozRequestFullScreen():T.webkitRequestFullscreen&&T.webkitRequestFullscreen();var D=setInterval(function(){if(T!==(m.fullscreenElement||m.mozFullScreenElement||m.webkitFullscreenElement||m.msFullscreenElement))clearInterval(D),T.style.left=G,T.style.top=l,T.style.width=u,T.style.height=E,T.style.oldBackgroundColor=J,c.iv();else{var w=n.Default.getWindowInfo();(Z||w.width!==c.getWidth()||w.height!==c.getHeight())&&(Pg(c),Z=!1)}},500)}}},appendTimeStamp:function(X){return X},setCompType:function(m,V){xd(V)&&V.substr(0,12)==_o&&(V=H.parse(V)),Qj(V)||Il(V)?Xh[m]=V:rm(m)},getCompType:function(C){var _=Xh[C];return _===W&&dp.test(C)&&rm(C),_},getCompTypeMap:function(){return Xh},drawCompType:function(B,z,G,K,r,k){B(z,G,K,r,k)},numberListener:function(){var r={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(q){var k=q.keyCode;r[k]||65===k&&H.isCtrlDown(q)||86===k&&H.isCtrlDown(q)||67===k&&H.isCtrlDown(q)||88===k&&H.isCtrlDown(q)||k>=35&&40>=k||(q.shiftKey||48>k||k>57)&&(96>k||k>105)&&q.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(J){var a=J.target.tagName;("DIV"===a||"CANVAS"===a)&&!(H.ignoreKeyCodes.indexOf(J.keyCode)>=0)&&("keydown"!==J.type||Lp(J)||Nr(J)||dl(J)||Se(J)||zn(J)||65===J.keyCode&&(J.metaKey||J.ctrlKey))&&J.cancelable===!0&&(J.preventDefault(),J.preventManipulation&&J.preventManipulation())},getWindowInfo:function(){var X=m.documentElement,t=X&&(X.scrollLeft||X.scrollTop)?X:m.body;return{target:t,left:t.scrollLeft,top:t.scrollTop,width:e.innerWidth||t.clientWidth,height:e.innerHeight||t.clientHeight}},isDragging:function(){return!!nm},isLeftButton:function(_){return Aq(_)?!0:0===_.button},isMiddleButton:function(G){return Aq(G)?!1:G&&(1===G.button||4&(G.buttons||0))},isRightButton:function(H){return Aq(H)?!1:H&&(2===H.button||2&(H.buttons||0))},isInput:function(u){if(!u)return!1;var E=u.tagName;return"INPUT"===E||"TEXTAREA"===E||"SELECT"===E},getTouchCount:function(b){return Aq(b)?b.touches.length:1},isDoubleClick:function(){function T(C){C.details=0,C.timeout=null,C.lastPoint=null}var l={};return Tj=new dj,jc=Tj.getTime(),function(r){if(Nc(r)>1)return!1;var f=r.button==S?"":r.button,Z=r.type+f,j=Z+"_isDoubleClick",z=l[Z];if(z||(z=l[Z]={details:0,timeout:null,lastPoint:null}),r[j]===W){r[j]=!0;var F=Rh(r);z.timeout&&(gp(z.timeout),z.timeout=null);var i=Aq(r)?H.doubleTouchRange:H.doubleClickRange;z.lastPoint&&_h(z.lastPoint,F)>i&&T(z),z.lastPoint=F,z.details++,z.timeout=Yk(function(){T(this)}.bind(z),H.doubleClickSpeed)}return 2===z.details}}(),isShiftDown:function(f){return f?f.shiftKey:$f["16"]},isCtrlDown:function(j){return j?Fk?j.metaKey:j.ctrlKey:Fk?$f["91"]:$f["17"]},getClientPoint:function(Q){return Aq(Q)&&(Q=Pp(Q)),{x:Q.clientX,y:Q.clientY}},isMouseEvent:function(e){return e instanceof MouseEvent||0===e.type.indexOf("mouse")},getTargetElement:function(i){var l,q=ll(i);if(l=H.isMouseEvent(i)||!m.elementFromPoint?i.target:m.elementFromPoint(q.x,q.y),Ni&&m.elementFromPoint){for(var x=[],V=[];"none"===l.style.pointerEvents;)x.push(l),V.push(l.style.display||""),l.style.display="none",l=m.elementFromPoint(q.x,q.y);x.forEach(function(I,N){I.style.display=V[N]})}return l},getPagePoint:function(A){return Aq(A)&&(A=Pp(A)),{x:A.pageX,y:A.pageY}},createObject:function(R,W){var I=new R;for(var _ in W){var U=W[_];if(Qj(U))I[_]=U;else if(0===_.indexOf("s:"))I.s(_.substr(2),W[_]);else if(0===_.indexOf("a:"))I.a(_.substr(2),W[_]);else{var g=Bc(_),U=W[_];I[g]?(I[g](U),"setToolTip"===g&&I.enableToolTip&&I.enableToolTip()):I[_]=U}}return I},setImage:function(D,_,r,U){var A=arguments.length;4===A?Hh(D,U,_,r):2===A?xd(_)?_.substr(0,12)==_o?_b(D,H.parse(_)):Hh(D,_):_b(D,_):1===A&&Hh(D,D)},getImage:function(_,q,M){var n;if(_==S)return S;if(Il(_)?n=_:(n=pp[_],_&&n===W&&(Qr&&Qr[_]||Hh(_,_))),q&&n&&n.tagName){var y;y="override"===M?"colors_override":"override_rgb"===M?"colors_override_rgb":"override_a"===M?"colors_override_a":"colors",n[y]||(n[y]={__count__:0});var V=n[y][q];return V||(n[y].__count__>H.imageCacheThreshold&&(n[y]={__count__:0}),V=je(n,Bp(q),n.width,n.height,M),n[y][q]=V,n[y].__count__++),V}return n},isImageComplete:function(s,B,P){var w=Fr(s);if(!w)return!1;if(w.tagName)return w.complete;for(var u,s,g,a=w.comps,A=!0,V=0,S=a.length;S>V;V++)if(u=a[V],g=u.type,"image"===u.type){s=u.name,s&&s.func&&(s=dd(s,B));var o=Bo(s,B,P);if(!o){A=!1;break}}else if(dp.test(g)&&H.getCompType(g)===W){A=!1,rm(g);break}return A},getId:function(){var D=1;return function(){return++D}}(),callLater:function(d,$,m,V){var K=function(){d.apply($,m)};return V?Yk(K,V):e.requestAnimationFrame(K)},cancelLater:function(i,p){p?gp(i):e.cancelAnimationFrame(i)},clone:function(B){if(null==B||"object"!=typeof B)return B;if(B instanceof Date){var y=new Date;return y.setTime(B.getTime()),y}if(B instanceof Array){for(var y=[],D=0,C=B.length;C>D;D++)y[D]=Dl(B[D]);return y}if(B instanceof Xd){for(var y=new Xd,D=0,C=B.length;C>D;D++)y.set(D,Dl(B.get(D)));return y}if(B instanceof gi)return B;if(B instanceof es){var y=new es;return y.deserialize(B.serialize()),y}if(B instanceof o){var y={};for(var E in B)B.hasOwnProperty(E)&&(y[E]=Dl(B[E]));return y}return B},callWhenLoaded:function(K,d){d=d||100;var k=lh(K,d);Zh||(Zh={}),Zh[k]={tick:k,cb:K,delay:d}},beforeLoadURL:function(n,v){if(Zh){var R={};for(var v in Zh){var O=Zh[v];gp(O.tick);var P=lh(O.cb,O.delay);R[P]={tick:P,delay:O.delay,cb:O.cb}}Zh=R}return H.convertURL?H.convertURL(n,v):n},convertURL:function(c){return c},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return H.getImage("default_blank")},resizeImage:function(P,E,_,v){_||(_=E),v||(v=Zj());var c=v.getContext("2d");return Vj(v,E,_,1),c.drawImage(P,0,0,E,_),v},resizeImagePOT:function(Z,A,d){if(!Z||!Z.tagName)return Z;var g=Z.width,p=Z.height;if(!g||!p)return Z;if(Po.isPOT(g)&&Po.isPOT(p)&&(!A||g===p))return Z;var Y,R;return A?R=Y=Po.nearestPOT(Math.min(g,p)):(Y=Po.nearestPOT(g),R=Po.nearestPOT(p)),H.resizeImage(Z,Y,R,d)},sortFunc:function(q,R){if(q===R)return 0;if(q==S&&R!=S)return 1;if(q!=S&&R==S)return-1;if(q==S&&R==S)return 0;var E,v=typeof q,k=typeof R;return v===ps&&k===ps?E=q.localeCompare(R):v===Jd&&k===Jd&&(E=q-R),E===W&&(E=(""+q).localeCompare(""+R)),E>0?1:0>E?-1:0},getClassMap:function(){return Sf},getClass:function(w){if(xd(w)){var y,i=Sf[w];if(!i){y=w.split("."),i=e;for(var M=0;M<y.length;M++)i=i[y[M]];Sf[w]=i}return i}return w},def:function(z,H,I){var V,r,x,W=function(){};if(W.prototype=H.prototype,V=new W,xd(z)){if(Sf[z])throw"'"+z+"' already defined";x=td(z),V.getClassName=function(){return z}}else x=z;if(V.constructor=x,V.getClass=function(){return x},V.getSuperClass=function(){return H},I)for(r in I)Ep[r]&&Ep.hasOwnProperty(r)?Ep[r](V,I):pe(V,I,r);x.prototype=V,x.superClass=H.prototype},startAnim:function(){var A=function(R){R.duration&&(R.startTime=Gm()),R.timeId=Pm(R.tick,S,S,R.interval)};return function(Q){return Q=Dl(Q),Q.easing=Q.easing||H.animEasing,Q.duration||Q.frames||(Q.duration=H.animDuration),Q.t=0,Q.duration?Q.interval=0:(Q.frame=0,Q.interval=Q.interval||10),Q.tick=function(){if(Q.duration){var p=(Gm()-Q.startTime)/Q.duration;if(p>1&&(p=1),Q.t=p,Q.action(Q.easing(p),p),!Q.isRunning())return;1===p?Q.stop():Q._isPaused||(Q.timeId=Pm(Q.tick))}else{if(Q.frame++,p=Q.t=Q.frame/Q.frames,Q.action(Q.easing(p),p),!Q.isRunning())return;Q.frame<Q.frames?Q._isPaused||(Q.timeId=Pm(Q.tick,S,S,Q.interval)):Q.stop()}},Q.resume=function(){Q._isPaused&&(delete Q._isPaused,Q.duration?Q.t<1&&(Q.startTime=Gm()-Q.duration*Q.t,Q.timeId=Pm(Q.tick)):Q.frame<Q.frames&&(Q.timeId=Pm(Q.tick,S,S,Q.interval)))},Q.pause=function(){sd(Q.timeId,!Q.duration),Q._isPaused=!0},Q.isPaused=function(){return this._isPaused},Q.stop=function(L){Q.isRunning()&&(sd(Q.timeId,!Q.duration),delete Q.timeId,Q.duration?Q.t<1&&L&&(Q.t=1,Q.action(Q.easing(1),1)):Q.frame<Q.frames&&L&&(Q.frame=Q.frames,Q.action(Q.easing(1),1)),Q._37o&&Q._37o(),Q.finishFunc&&Q.finishFunc())},Q.isRunning=function(){return Q.timeId!=S},Q.delay?Pm(A,S,[Q],Q.delay):A(Q),Q}}(),getTextSize:function(){var C={},n=m?Zj().getContext("2d"):S;return function(f,i){n.font=f?f:Mr;var p=C[n.font];return p||(p=2*n.measureText("e").width+4,C[n.font]=p),{width:n.measureText(i).width+H.textExtraWidth,height:p}}}(),drawText:function(o,t,V,N,Y,n,u,D,W,w,I){if(t!=S){var O=xs(V,t),J={};J.y=w&&w!==hh?w===Dr?n+O.height/2:n+D-O.height/2:n+D/2,J.x=W&&W!==Vn?W===_k?Y+u-O.width/2:Y+u/2:Y+O.width/2,$e(o,t,J,V,N),I&&Tb(o,t,V,N,J.x,J.y,O.width,I)}},getDistance:function(I,A){var y=I.length;return A?3===y?x(Cr(I[0]-A[0])+Cr(I[1]-A[1])+Cr(I[2]-A[2])):2===y?x(Cr(I[0]-A[0])+Cr(I[1]-A[1])):I.z===W?x(Cr(A.x-I.x)+Cr(A.y-I.y)):x(Cr(A.x-I.x)+Cr(A.y-I.y)+Cr(A.z-I.z)):3===y?x(Cr(I[0])+Cr(I[1])+Cr(I[2])):2===y?x(Cr(I[0])+Cr(I[1])):void 0},brighter:function(C,T){return 0>T&&(T=-T),Ch(C,T?T:40)},darker:function(M,f){return f>0&&(f=-f),Ch(M,f?f:-40)},unionPoint:function(O,b){if(!O)return S;if(2===arguments.length)return O&&b?{x:_(O.x,b.x),y:_(O.y,b.y),width:v(O.x-b.x),height:v(O.y-b.y)}:S;var u=O;if(u._as&&(u=u._as),u.length===W)return S;var o=u.length;if(0>=o)return S;for(var R=1,M=u[0],F={x:M.x,y:M.y,width:0,height:0};o>R;R++){M=u[R];var A=_(F.x,M.x),P=g(F.x+F.width,M.x),m=_(F.y,M.y),L=g(F.y+F.height,M.y);F.x=A,F.y=m,F.width=P-A,F.height=L-m}return F},unionRect:function(P,R){if(P&&!R)return Dl(P);if(!P&&R)return Dl(R);if(P&&R){var o={x:_(P.x,R.x),y:_(P.y,R.y)};return o.width=g(P.x+P.width,R.x+R.width)-o.x,o.height=g(P.y+P.height,R.y+R.height)-o.y,o}return S},containsPoint:function(e,q,O,l){if(l!=S&&1!==l){var U=e.x+e.width/2,P=e.y+e.height/2;e={x:U-e.width/2*l,y:P-e.height/2*l,width:e.width*l,height:e.height*l}}if(O){var o=e.width/2,v=e.height/2,Q=R(-O),j=s(-O),T=q.x-e.x-o,G=q.y-e.y-v;return q={x:j*T-Q*G,y:Q*T+j*G},Zk({x:-o,y:-v,width:e.width,height:e.height},q)}return!(!e||q.x<e.x||q.y<e.y||q.x>e.x+e.width||q.y>e.y+e.height)},containsRect:function(x,k){if(!x||!k)return!1;var K=k.x,S=k.y,l=k.width,T=k.height,p=x.width,C=x.height;if(0>(p|C|l|T))return!1;var I=x.x,q=x.y;if(I>K||q>S)return!1;if(p+=I,l+=K,K>=l){if(p>=I||l>p)return!1}else if(p>=I&&l>p)return!1;if(C+=q,T+=S,S>=T){if(C>=q||T>C)return!1}else if(C>=q&&T>C)return!1;return!0},intersectsRect:function(a,M){if(!a||!M)return!1;var w=M.width,d=M.height,c=a.width,b=a.height;if(0>=c||0>=b||0>=w||0>=d)return!1;var S=M.x,F=M.y,P=a.x,x=a.y;return c+=P,b+=x,w+=S,d+=F,c>S&&b>F&&w>P&&d>x},intersection:function(R,B){if(!R||!B)return S;var v=B.x,t=B.y,f=R.x,s=R.y,a=v,$=t,i=f,T=s;return a+=B.width,$+=B.height,i+=R.width,T+=R.height,f>v&&(v=f),s>t&&(t=s),a>i&&(a=i),$>T&&($=T),a-=v,$-=t,0>=a||0>=$?S:{x:v,y:t,width:a,height:$}},grow:function($,s,b){b===W&&(b=s),$.x-=s,$.y-=b,$.width=$.width+2*s,$.height=$.height+2*b},getScreenPoint:function(Y,E,v,M,G,D,J){var h=v.getBoundingClientRect(),H=Y*(D||1)-v.scrollLeft+(M||0),_=E*(J||1)-v.scrollTop+(G||0),w=kf(v,!1);
if(w){var N=new se(H,_,0);return N.applyMatrix4(w),console.log(N),{x:N.x,y:N.y}}return{x:H+h.left,y:_+h.top}},getLogicalPoint:function(i,L,Q,f,l,n){var X,B,w=L.getBoundingClientRect();i.target?(Uj(i)?Fk?$f["91"]=!0:$f["17"]=!0:Fk?$f["91"]=!1:$f["17"]=!1,$f["16"]=nr(i)?!0:!1,i=Aq(i)?Pp(i):i,X=i.clientX,B=i.clientY):(X=i.x,B=i.y);var T=kf(L,!0);if(T){var t=new se(X,B,0);t.applyMatrix4(T);do{if(Math.abs(t.z)<=1e-6)break;var a=new se(X,B,1);if(a.applyMatrix4(matrix),Math.abs(a.z)<=1e-6){t=a;break}if(a.sub(t),Math.abs(a.z)<=1e-6)break;t.addScaledVector(a,-t.z/a.z)}while(!1);return{x:(t.x+L.scrollLeft-(Q||0))/(l||1),y:(t.y+L.scrollTop-(f||0))/(n||1)}}return{x:(X-w.left+L.scrollLeft-(Q||0))/(l||1),y:(B-w.top+L.scrollTop-(f||0))/(n||1)}},removeHTML:function(){var a;return function(K){return K&&K.getView&&(K=K.getView()),K&&K.parentNode?a===K?!0:(a=K,K.parentNode.removeChild(K),a=S,!0):!1}}(),getToolTipDiv:function(){if(!gj){gj=ue(),Np=ue();var U=gj.style;H.baseZIndex!=S&&(U.zIndex=fl(H.baseZIndex)+3+""),U.whiteSpace="nowrap",U.color=H.toolTipLabelColor,U.background=H.toolTipBackground,U.font=H.toolTipLabelFont,U.padding="5px",U.boxShadow="0px 0px 3px "+H.toolTipShadowColor}return gj},isToolTipShowing:function(){return gj&&gj.parentNode?!0:Np&&Np.parentNode?!0:!1},updateToolTipContent:function(E,I){if(H.isToolTipShowing()&&(I||(I=on&&on.view),E===W&&I&&on.e&&(E=I.getToolTip(on.e)),E!=S)){var X;E.html?(E=E.html,X=Np):X=gj,X.innerHTML=E}},hideToolTip:function(){if(H.isToolTipShowing()){re(gj),re(Np),zc();var U=on&&on.view;U&&U.onHideToolTip&&U.onHideToolTip(),on=S}},showToolTip:function(C,A,h){if(!C||A==S)return Qm(),void 0;H.getToolTipDiv();var z,T;if(A.html?(A=A.html,z=Np,re(gj)):(z=gj,re(Np)),T=z.style,z.innerHTML=A,z.parentNode||n.Default.appendToScreen(z),C.target){C=ll(C);var J=Gl(),Z=C.x,a=C.y,O=bc?60:12;if(bc){var f=z.getBoundingClientRect();T.left=Z-f.width/2+Kl,T.top=a-f.height-O<J.top?a+O+Kl:a-f.height-O+Kl}else{T.left=Z+O+Kl,T.top=a+O+Kl;var f=z.getBoundingClientRect();f.left+f.width>J.width&&(T.left=Z-O-f.width+Kl),f.top+f.height>J.height&&(T.top=a-O-f.height+Kl),f.left<0&&(T.left=Z+O+Kl),f.top<0&&(T.top=a+O+Kl)}}else T.left=C.x+Kl,T.top=C.y+Kl;zc(),h===W?h=on&&on.view:on={e:C,view:h},h&&h.onShowToolTip&&h.onShowToolTip()},startDragging:function(c,P,u){u==W&&(u=!0),c!==nm&&(nm?u&&(Aq(P)?nm.handleWindowTouchEnd(P):nm.handleWindowMouseUp(P)):Aq(P)?(Z(e,nd,kb),Z(e,hs,Yo),Z(e,"blur",Yo)):(Z(e,ag,yj),Z(e,Cp,cl),Z(e,"blur",cl)),nm=c)},getImageMap:function(){return pp},toBoundaries:function(J,w,I,h){var e=[];return Wo(J,w,I,h).forEach(function(s){var u=[];s.forEach(function(k){u.push(k.x,k.y)}),e.push(u)}),e},getCurrentKeyCodeMap:function(){return $f},drawCenterImage:function(h,A,K,z,o,F,l,f){!o&&F&&F.isSelfViewEvent&&(o=F);var H=lm(A,o,F),Z=qj(A,o,F);hl(h,A,b(K-H/2),b(z-Z/2),H,Z,o,F,l,f)},drawStretchImage:function(R,E,t,M,W,q,s,n,Y,G,L,X){!n&&Y&&Y.isSelfViewEvent&&(n=Y);var c,o=lm(E,n,Y,q),j=qj(E,n,Y,s);"uniform"===t?(c=_(q/o,s/j),o*=c,j*=c,M+=b((q-o)/2),W+=b((s-j)/2),q=o,s=j):"centerUniform"===t&&((o>q||j>s)&&(c=_(q/o,s/j),o*=c,j*=c),M+=b((q-o)/2),W+=b((s-j)/2),q=o,s=j);var w=R.interactiveInfo;if(w){var Z;if(Z="center"===t?{x:M+q/2-o/2,y:W+s/2-j/2,width:o,height:j}:{x:M,y:W,width:q,height:s},w.rect){var g=w.compInfos,Q=g.length;Q&&(g[Q-1].rect.image=E)}else w.rect=Z}if("center"===t){var h=L!==!1&&(o>q||j>s);h&&(R.save(),R.beginPath(),R.rect(M,W,q,s),R.clip()),hl(R,E,M+q/2-o/2,W+s/2-j/2,o,j,n,Y,G,X),h&&R.restore()}else hl(R,E,M,W,q,s,n,Y,G,X)},toCanvas:function(M,V,l,D,G,s,H,J,h){M=Fr(M,H),V=V||lm(M,G),l=l||qj(M,G);var g=Zj(),c=ed(g);return J?(Vj(g,V,l,J),c.scale(J,J)):Vj(g,V,l,1),xe(c,M,D,0,0,V,l,G,s,H,h),M&&M.clampToEdge&&(g.clampToEdge=M.clampToEdge),c.restore(),g},toGrayColor:function(Y){if(!Y)return Y;var O=dr(Y),x=b(.299*O[0]+.587*O[1]+.114*O[2]);return"rgba("+x+","+x+","+x+","+O[3]/255+")"},createGradientImage:function(c,I,k,j){for(var A=["L",0,0,c,0,1,0,0,1,0,0],x=0,Z=Math.min(I.length,k.length);Z>x;x++)A.push(k[x],I[x]);var M=n.Default.toCanvas({width:c,height:c,clampToEdge:!0,comps:[{type:"shape",rotation:j||0,points:[0,0,c,0,c,c,0,c],background:"#ffffff",gradientPack:A}]});return M},createElement:function(Z,A,z,E){var V=m.createElement(Z);return jb(V,A||h.widgetBorder,2),V.style.font=z?z:Mr,E!=S&&(V.value=E),H.onElementCreated&&H.onElementCreated(V),V},containedInView:function(B,J){var Z=Nn(J).getBoundingClientRect();return Zk({x:Z.left,y:Z.top,width:Z.width,height:Z.height},Rh(B))},isIsolating:function(){return Dg>0},setIsolating:function(p){p?Dg++:Dg--},getMSMap:function(){return Ep},stringify:function(P,R,k){var a=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var D=es.prototype.toJSON;es.prototype.toJSON=function(){return"__ht__dataModel"+this.serialize(0)},R=k?0:R==S?2:R;var p=JSON.stringify(P,function(Z,P){return"function"==typeof P?"__ht__"+(P.__ht__||P.toString()):ff(P)?Jb(P):P instanceof n.List?"__ht__list"+(P.__ht__list||H.stringify(P._as)):P},R);return Date.prototype.toJSON=a,es.prototype.toJSON=D,k&&(p=_o+Vm(p)),p},parse:function(h,d){return xd(h)?h.substr(0,12)!=_o||(h=fk(h.substr(12)),xd(h))?(d=d||{},JSON.parse(h,function(Y,t){if(xd(t))if(d.ignoreFunction||"__ht__function"!=t.substr(0,14)){if(!d.ignoreDate&&"__ht__date"==t.substr(0,10))return new Date(fl(t.substr(10)));if("__ht__list"===t.substr(0,10))return new Xd(H.parse(t.substr(10)));if(!d.ignoreDataModel&&"__ht__dataModel"===t.substr(0,15)){var r=new es;return r.deserialize(H.parse(t.substr(15))),r}}else{var i=t.indexOf("{")+1,B=t.lastIndexOf("}"),n=t.indexOf("(")+1,M=t.indexOf(")");if(i&&B&&n&&M)try{var j=new Function(t.substring(n,M),t.substring(i,B));return j.__ht__=t.substr(6),j}catch(z){throw console.info("=== SyntaxError ===\n",t),z}}return t})):h:h},loadJS:function(s,t){t&&s.push(t);var W=s.shift();if(Td(W))s=W.contact(s),H.loadJS(s);else if(Qj(W))W(),H.loadJS(s);else if(xd(W)){var d=m.createElement("script");d.onload=function(){H.loadJS(s)},d.setAttribute("src",W),m.getElementsByTagName("head")[0].appendChild(d)}else s.length&&H.loadJS(s)},extendClass:function(b,X){var y=b.prototype;for(var E in X)Ep[E]&&Ep.hasOwnProperty(E)?Ep[E](y,X):y[E]=X[E]},toRoundedCorner:function(){function a(Z,T,g){Z.x=T.x,Z.y=T.e||g,Z.z=T.y}var Q=new se,o=new se,X=new se,A=new se;return function(M,z){var w,D=0;M.getPoints&&(D=M.getElevation(),M=M.getPoints()),w=M instanceof Xd?M:new Xd(M);var Y=w.size();if(0>=z)return{points:w};var h=new Xd,L=new Xd,j=w.get(0);a(Q,j,D),h.add(j),L.add(1);for(var l=1;Y>l;l++)if(Y>l+1){var P=w.get(l),r=w.get(l+1);a(o,P,D),a(X,r,D),A.subVectors(Q,o).setLength(Math.min(.99*A.length(),z)).add(o),P.e!==W||j.e!==W?h.add({x:A.x,y:A.z,e:A.y}):h.add({x:A.x,y:A.z}),h.add(P),A.subVectors(X,o).setLength(Math.min(.99*A.length(),z)).add(o),P.e!==W||r.e!==W?h.add(j={x:A.x,y:A.z,e:A.y}):h.add(j={x:A.x,y:A.z}),Q.copy(A),L.addAll([2,3])}else h.add(w.get(l)),L.add(2);return{points:h,segments:L}}}(),toColorData:dr,setCanvas:Vj,createDiv:ue,createDisabledDiv:Yj,createView:Xk,createCanvas:Zj,appendChild:wf,initContext:ed,checkLoadingImage:Kp,translateAndScale:of,layout:Pg,getPosition:Cs,drawPoints:$j,drawRoundRect:Hf,drawBorder:Qd,setFocus:cg,getter:lc,setter:Bc,isEmptyObject:to,cameraPriority:function(){var H={skybox:0,main:1e4,top:1e7,infinity:1/0};return o.seal(o.defineProperties({},{skybox:{configurable:!1,enumerable:!1,get:function(){return H.skybox},set:function(u){if(u>=H.main)throw new RangeError("Skybox camera must have lower priority than the main camera.");H.skybox=Number(u)}},main:{configurable:!1,enumerable:!1,get:function(){return H.main},set:function(e){if(e<=H.skybox)throw new RangeError("Main camera must have higher priority than the skybox camera.");if(e>=H.top)throw new RangeError("Main camera must have lower priority than the top camera.");H.main=Number(e)}},top:{configurable:!1,enumerable:!1,get:function(){return H.top},set:function($){if($<=H.main)throw new RangeError("Top camera must have higher priority than the main camera.");H.top=Number($)}}}))}()},!0),kk(r,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var Af=H.disabledOpacity,uh=H.toolTipDelay,mf=H.devicePixelRatio,Oq=H.autoMakeVisible,Rb=H.autoHideScrollBar,qg=H.imageGradient,$g=H.showToolTip,Qm=H.hideToolTip,Vg=H.dashPattern,np=H.lineCap,Ge=H.lineJoin,Ub=H.labelColor,Rl=H.labelSelectColor,Mr=H.labelFont,bq=H.widgetIndent,kd=H.widgetRowHeight,yl=H.widgetHeaderHeight,mb=H.widgetTitleHeight,ar=H.scrollBarColor,lj=H.scrollBarSize,Op=H.scrollBarTimeout,ie=H.scrollBarMinLength,ii=H.scrollBarInteractiveSize,_c=H.zoomIncrement,Ie=H.scrollZoomIncrement,Xe=H.pinchZoomIncrement,qr=H.zoomMax,Cl=H.zoomMin,zr=H.createObject,as=H.preventDefault,oi=H.setImage,Fr=H.getImage,Bo=H.isImageComplete,Qp=H.drawCenterImage,xe=H.drawStretchImage,_j=H.getId,Pm=H.callLater,sd=H.cancelLater,ck=H.sortFunc,Dl=H.clone,td=H.getClass,Xm=H.startAnim,Vd=H.brighter,tb=H.darker,Qh=H.drawText,xs=H.getTextSize,yp=H.isLeftButton,sc=H.isMiddleButton,Bq=H.isRightButton,Nc=H.getTouchCount,tg=H.isDoubleClick,nr=H.isShiftDown,Uj=H.isCtrlDown,Rh=H.getClientPoint,ll=H.getPagePoint,_h=H.getDistance,Wk=H.unionPoint,Mc=H.unionRect,Zk=H.containsPoint,Ip=H.containsRect,Br=H.intersectsRect,fe=H.intersection,Gl=H.getWindowInfo,Qf=H.grow,Ib=H.getLogicalPoint,Ah=H.getScreenPoint,xl=H.startDragging,re=H.removeHTML,mh=H.createElement,Rc=H.segmentResolution,aq=H.shapeResolution,pb=H.shapeSide,Dh=H.def,jj=function(S,T,y){Dh(V+"."+S,T,y)},ho=function(B,z){B.childNodes.forEach(function(T){z(T),ho(T,z)})};kk(H,{toolTipLabelColor:Ub,toolTipLabelFont:Mr,toolTipBackground:h.toolTipBackground,toolTipShadowColor:Qo,debugTipLabelFont:Mr,debugTipLabelColor:Ub,debugTipBackground:h.toolTipBackground,drawBreakableText:rg,setDevicePixelRatio:function(y){mf=H.devicePixelRatio="number"==typeof y?y:Xi(e),ho(m.body,function(v){var i=v._ht;i&&i._canvas&&(Vj(i._canvas,i.getWidth(),i.getHeight()),i.redraw?i.redraw():i.iv())})},getPosition3dGap:function(){return $o()}},!0);var Gq=1e-6,rr="undefined"!=typeof Uint16Array?Uint16Array:Array,mo="undefined"!=typeof Float32Array?Float32Array:Array,Od=function(H,r,p){var T=[H[0]-r[0],H[1]-r[1],H[2]-r[2]];if(p){var P=_h(T);P>0&&(T[0]/=P,T[1]/=P,T[2]/=P)}return T},Sn=function(){var Z="charCodeAt",C=2*(2*vc.length+1);for(var h in e)if(h===V+Vn[0]+(Kl.length+2)){var H=e[h];if(!H)break;for(var R=H.length,v=0;R>v;v++)if(H[v][Z](0)===C&&H[v+1]!=S&&H[v+1]===Kl[0]&&H[v+2]!=S&&H[v+2][Z](0)===C){for(var p=v+3;R>p;p++)if(H[p][Z](0)===C){if(0==H[p+1])for(var Q,X=p+2;R>X;X++){if(H[X][Z](0)===C){0==H[X-1]&&Q&&(zm=Q.substr(0,Q.length-1));break}Q==S?Q=H[X]:Q+=H[X]}break}break}break}return function(O){return[-O[0],-O[1],-O[2]]}}(),wr=function(X,T){return 3===X.length?X[0]*T[0]+X[1]*T[1]+X[2]*T[2]:X[0]*T[0]+X[1]*T[1]},Pb=function(){var z=new Array(16);return z[0]=1,z[1]=0,z[2]=0,z[3]=0,z[4]=0,z[5]=1,z[6]=0,z[7]=0,z[8]=0,z[9]=0,z[10]=1,z[11]=0,z[12]=0,z[13]=0,z[14]=0,z[15]=1,z},js=Pb(),sp=function(p){var J=new Array(16);return J[0]=p[0],J[1]=p[1],J[2]=p[2],J[3]=p[3],J[4]=p[4],J[5]=p[5],J[6]=p[6],J[7]=p[7],J[8]=p[8],J[9]=p[9],J[10]=p[10],J[11]=p[11],J[12]=p[12],J[13]=p[13],J[14]=p[14],J[15]=p[15],J},Vc=function(v,m){return v[0]=m[0],v[1]=m[1],v[2]=m[2],v[3]=m[3],v[4]=m[4],v[5]=m[5],v[6]=m[6],v[7]=m[7],v[8]=m[8],v[9]=m[9],v[10]=m[10],v[11]=m[11],v[12]=m[12],v[13]=m[13],v[14]=m[14],v[15]=m[15],v},Md=function(w){return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},ak=function(G,Y){var d=G[0],O=G[1],l=G[2];return G[0]=Y[0]*d+Y[4]*O+Y[8]*l+Y[12],G[1]=Y[1]*d+Y[5]*O+Y[9]*l+Y[13],G[2]=Y[2]*d+Y[6]*O+Y[10]*l+Y[14],G},en=function(p,d){var F=p[0],X=p[1],A=p[2],x=p[3];return p[0]=d[0]*F+d[4]*X+d[8]*A+d[12]*x,p[1]=d[1]*F+d[5]*X+d[9]*A+d[13]*x,p[2]=d[2]*F+d[6]*X+d[10]*A+d[14]*x,p[3]=d[3]*F+d[7]*X+d[11]*A+d[15]*x,p},Ye=function(){var T,P,e,Y,K=cn(vf[1]+vf[7]),f=cn(vf[0]+vf[3]-vf[10]),v=cn(vf[8]+2),g=function(){return P=e.charAt(T),T+=1,P},y=function(){var b="";if(P===v)for(;g();){if(P===v)return g(),b;b+=P}else g()},O=function(){for(;P&&" ">=P;)g()},k=function(){var s,A={};if(P===K){if(g(),O(),P===f)return g(),A;for(;P;){if(s=y(),O(),g(),A[s]=Y(),O(),P===f)return g(),A;g(),O()}}};return Y=function(){switch(O(),P){case K:return k();default:return y()}},function(m){if(G={},m){var C;if(e=m,T=0,P=" ",C=Y(),O(),!P)return C}}}(),gr=function(X,Z){if(Z){var I=R(Z),O=s(Z),k=X[4],e=X[5],y=X[6],i=X[7],T=X[8],M=X[9],n=X[10],q=X[11];X[4]=k*O+T*I,X[5]=e*O+M*I,X[6]=y*O+n*I,X[7]=i*O+q*I,X[8]=T*O-k*I,X[9]=M*O-e*I,X[10]=n*O-y*I,X[11]=q*O-i*I}},pj=function(q,r){if(r){var m=R(r),Y=s(r),p=q[0],x=q[1],X=q[2],F=q[3],e=q[8],u=q[9],h=q[10],t=q[11];q[0]=p*Y-e*m,q[1]=x*Y-u*m,q[2]=X*Y-h*m,q[3]=F*Y-t*m,q[8]=p*m+e*Y,q[9]=x*m+u*Y,q[10]=X*m+h*Y,q[11]=F*m+t*Y}},th=function(M,v){if(v){var n=R(v),$=s(v),Z=M[0],N=M[1],h=M[2],I=M[3],l=M[4],V=M[5],U=M[6],b=M[7];M[0]=Z*$+l*n,M[1]=N*$+V*n,M[2]=h*$+U*n,M[3]=I*$+b*n,M[4]=l*$-Z*n,M[5]=V*$-N*n,M[6]=U*$-h*n,M[7]=b*$-I*n}},tp=function(Q,C,Z){return um(S,Z===!1?S:Q.getFinalScale3d(),Q.getFinalRotation3d(),Q.getRotationMode(),Q.p3(),S,C)},um=function(G,O,s,A,h,N,I){return N||(N=Pb()),h&&Je(N,h),fs(N,s,A),I&&Jc(N,N,I),O&&Hr(N,O),G&&Jc(N,N,G),N},vd=function(C,P,R){P=fl(P),R=fl(R);var c=this;c.g=C,c._84O=P,c._85O=R,c._70I=!0,c.F=0,c._83O=P+R,c.pen={x:0,y:0}},yq="lineDashOffset",bh="setLineDash",Ze=function(N){for(var T in N)1===T.length&&(yq=N[T]);return T?1:0},Tr=function(r,N,e){return bg(N)?r:r[bh]?(r[bh](N),e&&(r.lineDashOffset=e),r):new vd(r,N[0],N.length>1?N[1]:N[0])},qm=function(K,q){!bg(q)&&K[bh]&&(K[bh](Jj),K.lineDashOffset=0)};Dh(vd,o,{_69I:6,moveTo:function(U,h){var y=this,f=y.pen;f.x=U,f.y=h,y.g.moveTo(U,h),y.start||(y.start={x:U,y:h})},lineTo:function(P,N){var A=this,g=A.pen,K=P-g.x,F=N-g.y,X=db(F,K),e=s(X),H=R(X),o=A._23O(g.x,g.y,P,N),i=A._85O,p=A._84O,u=A._83O;if(A.F){if(A.F>o)return A._70I?A._72I(P,N):A.moveTo(P,N),A.F-=o,void 0;if(A._70I?A._72I(g.x+e*A.F,g.y+H*A.F):A.moveTo(g.x+e*A.F,g.y+H*A.F),o-=A.F,A.F=0,A._70I=!A._70I,!o)return}var T=j(o/u);if(T){for(var t=e*p,G=H*p,V=e*i,E=H*i,w=0;T>w;w++)A._70I?(A._72I(g.x+t,g.y+G),A.moveTo(g.x+V,g.y+E)):(A.moveTo(g.x+V,g.y+E),A._72I(g.x+t,g.y+G));o-=u*T}A._70I?o>p?(A._72I(g.x+e*p,g.y+H*p),A.moveTo(P,N),A.F=i-(o-p),A._70I=!1):(A._72I(P,N),o===p?(A.F=0,A._70I=!A._70I):(A.F=p-o,A.moveTo(P,N))):o>i?(A.moveTo(g.x+e*i,g.y+H*i),A._72I(P,N),A.F=p-(o-i),A._70I=!0):(A.moveTo(P,N),o===i?(A.F=0,A._70I=!A._70I):A.F=i-o)},quadraticCurveTo:function(G,n,I,w){var b,J=this,i=J.pen,y=i.x,c=i.y,Y=J._22O(y,c,G,n,I,w),q=0,F=0,U=J._85O,O=J._84O;if(J.F){if(J.F>Y)return J._70I?J._71I(G,n,I,w):J.moveTo(I,w),J.F-=Y,void 0;if(q=J.F/Y,b=J._20O(y,c,G,n,I,w,q),J._70I?J._71I(b[2],b[3],b[4],b[5]):J.moveTo(b[4],b[5]),J.F=0,J._70I=!J._70I,!Y)return}var T=Y-Y*q,g=j(T/J._83O),Z=O/Y,L=U/Y;if(g)for(var V=0;g>V;V++)J._70I?(F=q+Z,b=J._21O(y,c,G,n,I,w,q,F),J._71I(b[2],b[3],b[4],b[5]),q=F,F=q+L,b=J._21O(y,c,G,n,I,w,q,F),J.moveTo(b[4],b[5])):(F=q+L,b=J._21O(y,c,G,n,I,w,q,F),J.moveTo(b[4],b[5]),q=F,F=q+Z,b=J._21O(y,c,G,n,I,w,q,F),J._71I(b[2],b[3],b[4],b[5])),q=F;T=Y-Y*q,J._70I?T>O?(F=q+Z,b=J._21O(y,c,G,n,I,w,q,F),J._71I(b[2],b[3],b[4],b[5]),J.moveTo(I,w),J.F=U-(T-O),J._70I=!1):(b=J._19O(y,c,G,n,I,w,q),J._71I(b[2],b[3],b[4],b[5]),Y===O?(J.F=0,J._70I=!J._70I):(J.F=O-T,J.moveTo(I,w))):T>U?(F=q+L,b=J._21O(y,c,G,n,I,w,q,F),J.moveTo(b[4],b[5]),b=J._19O(y,c,G,n,I,w,F),J._71I(b[2],b[3],b[4],b[5]),J.F=O-(T-U),J._70I=!0):(J.moveTo(I,w),T===U?(J.F=0,J._70I=!J._70I):J.F=U-T)},bezierCurveTo:function(){var L=arguments;this.pen={x:L[4],y:L[5]},this.g.bezierCurveTo(L[0],L[1],L[2],L[3],L[4],L[5])},arc:function(A,S,G,C,M,i){i||(C=-C,M=-M),ne(this,A,S,C,M-C,G,G,!1)},rect:function(e,H,I,v){var M=this;M.pen={x:e,y:H},M.moveTo(e,H),M.lineTo(e,H+v),M.lineTo(e+I,H+v),M.lineTo(e+I,H),M.lineTo(e,H)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(_,T,u,M){var P=u-_,t=M-T;return x(P*P+t*t)},_22O:function(n,T,K,d,l,z,w){for(var e,V,u,X,_,y,D,Z=0,F=n,o=T,x=w>0?w:this._69I,Q=1;x>=Q;Q++)u=Q/x,X=1-u,_=X*X,y=2*u*X,D=u*u,e=_*n+y*K+D*l,V=_*T+y*d+D*z,Z+=this._23O(F,o,e,V),F=e,o=V;return Z},_21O:function(g,X,R,o,c,G,U,q){var f=this;if(0===U)return f._20O(g,X,R,o,c,G,q);if(1===q)return f._19O(g,X,R,o,c,G,U);var F=f._20O(g,X,R,o,c,G,q);return F.push(U/q),f._19O.apply(f,F)},_20O:function(w,r,D,j,k,M,p){if(1!==p){var n=D+(k-D)*p,e=j+(M-j)*p;D=w+(D-w)*p,j=r+(j-r)*p,k=D+(n-D)*p,M=j+(e-j)*p}return[w,r,D,j,k,M]},_19O:function($,C,S,c,u,T,m){if(1!==m){var O=$+(S-$)*m,M=C+(c-C)*m;S+=(u-S)*m,c+=(T-c)*m,$=O+(S-O)*m,C=M+(c-M)*m}return[$,C,S,c,u,T]},_72I:function(J,q){var Z=this.pen;(J!==Z.x||q!==Z.y)&&(Z.x=J,Z.y=q,this.g.lineTo(J,q))},_71I:function(i,F,p,e){var G=this.pen;(i!==p||F!==e||p!==G.x||e!==G.y)&&(G.x=p,G.y=e,this.g.quadraticCurveTo(i,F,p,e))}}),Ep.ms_quickVisible=function(f){f._4BQ=!1,f._4CQ=function(E){var $=E._4EQ;return $!==W?$:$=E._4EQ=this._4FQ(E)},f._4DQ=function(e){if(!e)return this.dm().each(function(i){i._4EQ=W}),void 0;e._4EQ=W;var l=this;if(e instanceof $n||tl(e)||e instanceof bs||e.ISubGraph)e.eachChild(function(X){l.invalidateQuickVisible(X)});else if(e.getEdges){var N=e.getEdges();N&&N.each(function(D){l.invalidateQuickVisible(D)})}},f.enableQuickVisibleMode=function(){this._4BQ||(this._4BQ=!0,this._4FQ=this.isVisible,this.isVisible=this._4CQ,this.invalidateQuickVisible=this._4DQ)},f.disableQuickVisibleMode=function(){this._4BQ&&(this._4BQ=!1,this.isVisible=this._4FQ,this.invalidateQuickVisible=wi)},f.isQuickVisibleMode=function(){return this._4BQ},f.invalidateQuickVisible=wi},Di=kj()+1,qi&&e.console&&Di&&!1&&(e.navigator&&e.navigator.userAgent.toLowerCase().indexOf("chrome")>-1?e.console.log.apply(console,["Hightopo - Version"+n.Default.getVersion()+" - %cTrialhttp://hightopo.com/request.html","color: #f00;"]):e.console.log("Hightopo - Version"+n.Default.getVersion()+" - Trialhttp://hightopo.com/request.html"));var _q=S,Ti=S,zq=H.checkLoadingCompType=function(B){_q&&!B._72O_&&(Ti||(Ti={}),Ti[B._72O_=_j()]=B)},rm=function(i,B){if(B||(B=i),B&&(_q||(_q={}),!_q[i])){var p=new xc;if(_q[B]={request:p,url:B},B=H.beforeLoadURL(B,i),B.data){var w=H.parse(B.data);Wb(i,w),H.handleCompTypeLoaded(i,w)}else{p.onload=function(){if(200===this.status||0===this.status){var k=H.parse(p.getResponseText());Wb(i,k),H.handleCompTypeLoaded(i,k)}else Wb(i,S)},p.onerror=function(){Wb(i,S)};var L={};L.url=encodeURI(B),L.sync=!1,p.send(L)}}},Wb=function(z,i){if(Xh[z]=i,delete _q[z],to(_q)&&(_q=S,Ti)){for(var Q in Ti){var O=Ti[Q];O.invalidateAll&&O.invalidateAll(W,"compTypeLoaded",z),O.redraw&&O.redraw(),O.iv(),delete O._72O_}Ti=S}if(i&&Ti)for(var Q in Ti){var O=Ti[Q];O.invalidateAll&&O.invalidateAll(W,"compTypeLoading",z),O.redraw&&O.redraw(),O.iv()}},Sj=h.chart,Xl="",Nh=!0,kr=H.compStack=[],Or=/^style@/,Wm=/^attr@/,ts=/^field@/,As={x:.5,y:.5},Bi=function(){Nh=!0},zi=function(){return Nh},Tl=function(P,W,q){if(!P)return!1;var p;return q&&q.isImageFitSize&&(p=q.isImageFitSize(W,P)),p==S&&(p=dd(P.fitSize,W,q)),p},lm=function(L,Y,M,X){if(!L)return 0;if(Tl(L,Y,M)&&X)return X;var W=dd(L.width,Y,M);return null==W?20:W},qj=function(m,F,P,q){if(!m)return 0;if(Tl(m,F,P)&&q)return q;var w=dd(m.height,F,P);return null==w?20:w},dd=function(U,A,C){if(!U||!U.func)return U;var F,o=U.func,e=U.value;return F=Qj(o)?C&&C.vectorDataBindingDisabled&&!U.isSafeFunc?e:o(A,C):A instanceof gi||(n.ui?A instanceof n.ui.View:0)?Wm.test(o)?A.a(Xl+o.slice(5)):Or.test(o)?A.s(Xl+o.slice(6)):ts.test(o)?A[o.slice(6)]:A[o]?A[o](C):e:e,e!==W&&F==S?e:F},hl=H.drawImage=function(){var A,k,E,x,p,O,l=3,X=6,N=function(m,o){m.getValue&&m.getValue.compType===o||(m.getValue=function(v){var l=j(m,v);if(l===W&&o.properties){var i=o.properties[v];i&&(l=i.defaultValue)}return l},m.getColor=function(b,N){return N===!0?q(b):q(m.getValue(b))},m.getValue.compType=o)},j=function(y,K,I){var H,G=!1;if(y.prefix&&k instanceof gi){var j=k.a(Xl+K);j!==W&&(G=!0,H=j)}return H===W&&(H=y[K]),H&&H.func&&(G=!0,H=dd(H,k,E)),I&&(H=I(H),G||(y[K]=H)),H},q=function(i,I){var e;return e=I?j(i,I):i,A&&A.compGray&&e?H.toGrayColor(e):p&&e?Yn(e,p,O):e},b=function(M){if(Td(M)){for(var I=new Xd,s=M.length,Z=0;s>Z;Z+=2)I.add({x:M[Z],y:M[Z+1]});M=I}return M},Y=function(G){var f=j(G,"anchorX"),e=j(G,"anchorY");if(f!==W||e!==W)return{x:f===W?As.x:f,y:e===W?As.y:e};var u=j(G,"type"),_=j(G,"name");if("image"!==u||!_)return As;var m=Fr(_);return m&&m.anchorX!==W&&m.anchorY!==W?{x:m.anchorX,y:m.anchorY}:As},M=function(u,I){var o=j(u,Fi),f=Y(u);if(Td(o)){var l=o.length,E=j(u,"relative"),q=I.width,K=I.height;if(4===l)o={x:o[0],y:o[1],width:o[2],height:o[3]},E&&(o.x*=q,o.y*=K,o.width*=q,o.height*=K);else if(3===l){var h=o[0];o={width:o[1],height:o[2]},E&&(o.width*=q,o.height*=K),"object"==typeof h?h.length&&(h={x:h[0],y:h[1]}):h=Cs(h,I,o),o.x=h.x-o.width*f.x,o.y=h.y-o.height*f.y}o.x+=j(u,"offsetX")||0,o.y+=j(u,"offsetY")||0,!E&&I.fitSize&&(o=F(u,o,I))}return o},F=function(t,l,Q){if(l){var M,$,X,g={x:l.x,y:l.y,width:l.width,height:l.height},H=Y(t),h=j(t,"layoutH"),f=j(t,"layoutV"),s=1,q=1,K=0,T=0,x=1,r=1;switch(h){case"left":break;case"right":g.x+=Q.width-Q.rw;break;case"center":g.x+=.5*(Q.width-Q.rw);break;case"scale":case"leftright":default:M=j(t,vm)||0,M&&(K=Math.abs(T=Math.sin(M)),x=Math.abs(r=Math.cos(M))),"leftright"!==h?(s+=x*(Q.widthScale-1),q+=K*(Q.widthScale-1)):(s+=g.width?x*(Q.width-Q.rw)/g.width:0,q+=g.height?K*(Q.width-Q.rw)/g.height:0,$=-Math.min(-H.x*r+H.y*T,-H.x*r-(1-H.y)*T,(1-H.x)*r+H.y*T,(1-H.x)*r-(1-H.y)*T))}switch(f){case"top":break;case"bottom":g.y+=Q.height-Q.rh;break;case"center":g.y+=.5*(Q.height-Q.rh);break;case"scale":case"topbottom":default:M==S&&(M=j(t,vm),M&&(K=Math.abs(T=Math.sin(M)),x=Math.abs(r=Math.cos(M)))),"topbottom"!==f?(s+=K*(Q.heightScale-1),q+=x*(Q.heightScale-1)):(s+=g.width?K*(Q.height-Q.rh)/g.width:0,q+=g.height?x*(Q.height-Q.rh)/g.height:0,X=-Math.min(-H.x*T-H.y*r,-H.x*T+(1-H.y)*r,(1-H.x)*T-H.y*r,(1-H.x)*T+(1-H.y)*r))}return(1!==s||1!==q)&&("scale"!==h&&h?"leftright"===h&&(g.x+=g.width*(1-s)*H.x+$*(Q.width-Q.rw)):g.x+=g.x*(Q.widthScale-1)+H.x*g.width*(Q.widthScale-s),"scale"!==f&&f?"topbottom"===f&&(g.y+=g.height*(1-q)*H.y+X*(Q.height-Q.rh)):g.y+=g.y*(Q.heightScale-1)+H.y*g.height*(Q.heightScale-q),g.width*=s,g.height*=q),g.width<0&&(g.width=0),g.height<0&&(g.height=0),g}},T=function(U){return Td(U)?new Xd(U):U},P=function(L,I,Y,k,q,G,n){var F=A.interactiveInfo,S=L.transform;if(S)return A.save(),A.setTransform(S.a,S.b,S.c,S.d,S.tx,S.ty),F&&F.compInfos.push({comp:L,rect:I,matrix:S.clone(),prefix:Xl,refRect:F.refRect}),!0;q===W&&(q=1),G===W&&(G=1);var u=j(L,"clipPercentage"),M=hf(Y,I);if(M&&!k&&1===q&&1===G&&u==W)return F&&F.compInfos.push({comp:L,rect:I,matrix:F.matrix.clone(),prefix:Xl,refRect:F.refRect}),!1;n=n||As;var l=I.x+I.width*n.x,C=I.y+I.height*n.y,c=Y.x+Y.width*n.x,T=Y.y+Y.height*n.y,Z=Y.width?q*(I.width/Y.width):1,s=Y.height?G*(I.height/Y.height):1;if(A.save(),F&&(F.matrix.appendTranslate(l,C).appendRotate(k).appendScale(Z,s).appendTranslate(-c,-T),F.compInfos.push({comp:L,rect:I,matrix:F.matrix.clone(),prefix:Xl,refRect:F.refRect})),Tc(A,l,C),ef(A,k||0),Sp(A,Z,s),Tc(A,-c,-T),u!=W){var O=oh(Y,j(L,"clipDirection"),u);A.beginPath(),A.rect(O.x,O.y,O.width,O.height),A.clip()}return!0},c=function(){A.restore()},d=function(l,$,p){var C=j(l,"path"),t=j(l,vm),k=j(l,"scaleX"),M=j(l,"scaleY"),U=Y(l),o=S,r=Oh(null,C);if(p||(p=l.unionRect,p||(p=Wk(r),l.path.func||(l.unionRect=p)),o=p),p){o||(o=l.unionRect,o||(o=Wk(r),l.path.func||(l.unionRect=o)));var F=P(l,p,o,t,k,M,U),m=j(l,"borderPattern"),T=Tr(A,m),h=q(l,"background"),b=q(l,"borderColor"),v=j(l,"borderWidth"),D=j(l,"gradient"),u=q(l,"gradientColor"),R=j(l,"border3d"),O=q(l,"border3dColor"),n=j(l,"border3dAccuracy"),e=A.lineJoin,B=A.lineCap;A.lineJoin=j(l,"borderJoin")||Ge,A.lineCap=j(l,"borderCap")||np,h?(vh(A,h,D,u,o),Oh(A,C),A.fill(),T!==A&&Oh(A,C)):Oh(A,C);var Q=j(l,"borderWidthAbsolute");if(Q&&(A.save(),A.setTransform(1,0,0,1,0,0)),v&&b&&(A.lineWidth=v,A.strokeStyle=b,A.stroke(),R&&vl(A,b,O,v,x,n)),qm(A,m),j(l,"dash")){var L=j(l,"dashWidth")||v;if(L>0){m=j(l,"dashPattern")||Vg;var T=Tr(A,m,j(l,"dashOffset")),H=q(l,"dashColor")||q(tn);T!==A&&Oh(A,C),A.strokeStyle=H,A.lineWidth=L,A.stroke(),j(l,"dash3d")&&vl(A,H,q(l,"dash3dColor"),L,x,j(l,"dash3dAccuracy")),qm(A,m)}}Q&&A.restore(),$===Fi&&Ug(A,h,j(l,"depth"),o),A.lineJoin=e,A.lineCap=B,F&&c()}},Q=function(s,o,V,u){var h=j(s,We,b),g=j(s,vm),i=Y(s);if(h&&u.fitSize){var t=new Xd,C=Wk(h),D=F(s,C,u),y=C.x+i.x*C.width,H=C.y+i.y*C.height,r=D.x+i.x*D.width,B=D.y+i.y*D.height,m=C.width?D.width/C.width:1,L=C.height?D.height/C.height:1;h.each(function(U){t.add({x:r+(U.x-y)*m,y:B+(U.y-H)*L})}),h=t,s.unionRect=null}var f=j(s,"scaleX"),J=j(s,"scaleY"),G=o===Zb,n=S;if(!V&&G&&(V=s.unionRect,V||(V=Wk(h),s.points.func||(s.unionRect=V)),n=V),V){G?n||(n=s.unionRect,n||(n=Wk(h),s.points.func||(s.unionRect=n))):n=V;var l,R,I,Z,X=P(s,V,n,g,f,J,i),v=j(s,"borderPattern"),Q=Tr(A,v),d=q(s,"background"),z=Fr(j(s,"repeatImage"),p,O),U=j(s,"gradientPack"),K=j(s,"borderGradientPack"),w=q(s,"borderColor"),e=j(s,"borderWidth"),$=Fr(j(s,"borderRepeatImage"),p,O),a=j(s,"segments",T),N=j(s,"gradient"),_=q(s,"gradientColor"),M=j(s,"border3d"),Yc=q(s,"border3dColor"),ai=j(s,"border3dAccuracy"),be=j(s,"closePath"),Wb=j(s,"fillRule")||"nonzero",vc=A.lineJoin,Rm=A.lineCap;if(A.lineJoin=j(s,"borderJoin")||Ge,A.lineCap=j(s,"borderCap")||np,G)if(d||z||U){var ue=j(s,"fillClipPercentage");if(ue!=W){var rd=oh(n,j(s,"fillClipDirection"),ue);A.save(),A.beginPath(),A.rect(rd.x,rd.y,rd.width,rd.height),A.clip()}$j(A,h,a,be),U?Id(A,U,q,!1,V):z?Cb(A,z,p,O,k,E):vh(A,d,N,_,n),A.fill(Wb),U&&A.restore(),ue!=W&&A.restore(),Q!==A&&$j(Q,h,a,be)}else $j(Q,h,a,be);else if("roundRect"===o?l=j(s,"cornerRadius"):"polygon"===o?(l=j(s,"polygonSide"),R=j(s,"cornerRadius"),I=j(s,"regular")):"arc"===o&&(l=j(s,"arcFrom"),R=j(s,"arcTo"),I=j(s,"arcClose"),Z=j(s,"arcOval")),d||z||U){var ue=j(s,"fillClipPercentage");if(ue!=W){var rd=oh(n,j(s,"fillClipDirection"),ue);A.save(),A.beginPath(),A.rect(rd.x,rd.y,rd.width,rd.height),A.clip()}Dj(A,o,n,l,R,I,Z),U?Id(A,U,q,!1,V):z?Cb(A,z,p,O,k,E):vh(A,d,N,_,n),A.fill(Wb),U&&A.restore(),ue!=W&&A.restore(),A!==Q&&Dj(Q,o,n,l,R,I,Z)}else Dj(Q,o,n,l,R,I,Z);var co=j(s,"borderWidthAbsolute");if(co&&(A.save(),A.setTransform(1,0,0,1,0,0)),e&&(w||$||K)&&(A.lineWidth=e,K?Id(A,K,q,!0,V):$?ro(A,$,p,O,k,E):A.strokeStyle=w,A.stroke(),K&&A.restore(),M&&vl(A,w,Yc,e,x,ai)),qm(A,v),j(s,"dash")){var me=j(s,"dashWidth")||e;if(me>0){v=j(s,"dashPattern")||Vg;var Q=Tr(A,v,j(s,"dashOffset")),Yb=q(s,"dashColor")||q(tn);Q!==A&&(G?$j(Q,h,a,be):Dj(Q,o,n,l,R,I,Z)),A.strokeStyle=Yb,A.lineWidth=me,A.stroke(),j(s,"dash3d")&&vl(A,Yb,q(s,"dash3dColor"),me,x,j(s,"dash3dAccuracy")),qm(A,v)}}co&&A.restore(),o===Fi&&Ug(A,d,j(s,"depth"),n),A.lineJoin=vc,A.lineCap=Rm,X&&c()}},f=function(Q,Y){var H=p||j(Q,kp),F=O||j(Q,"blendMode"),h=j(Q,"name"),w=Fr(h,H,F);w&&w.cacheRule!=S&&(w=De(A,w,j(Q,"stretch"),Y.width,Y.height,k,E,H)),w?xe(A,w,j(Q,"stretch"),Y.x,Y.y,Y.width,Y.height,k,E,H,null,F):Nh=!1},t=function(G,y){var U=j(G,"text");if(U!=S){U+="";var M,B=j(G,"gradientPack"),r=j(G,"gradient"),t=q(G,"gradientColor"),C=j(G,"font"),e=j(G,"vertical"),K=j(G,"verticalGap")||0,z=j(G,"align"),x=j(G,"vAlign"),l=j(G,"decoration"),Y=j(G,"letterGap")||0,u=j(G,"wrap"),$=j(G,"borderWidth"),T=j(G,"borderColor"),c=xs(C,U);if(B?(M=Id(A,B,q,!1,y),A.restore()):M=q(G,kp),!B&&r&&(M=H.createGradient(A,r,M||H.labelColor,t||h.imageGradient,y.x,y.y,y.width,y.height)),$&&Td(T)&&(T=Id(A,T,q,!1,y),A.restore()),e){null==K&&(K=1);var F,P,D,R=[],n=[];F=u?kh(U,y.height,C,Y,e,K):[U],A.textBaseline=Dr,A.font=C,F.forEach(function(H){for(var W=H.length,X=0,I=(W-1)*K,U=0;W>U;U++){var y=A.measureText(H[U]);R.push(y),I+=y.fontBoundingBoxDescent||c.height,X=g(X,y.width)}n.push({width:X,height:I})});var E=(F.length-1)*Y;n.forEach(function(i){E+=i.width}),P=z&&z!==Vn?z===_k?y.x+y.width-E:y.x+(y.width-E)/2:y.x;var v=0;F.forEach(function(G,J){var Q=n[J],N=G.length;D=x&&x!==hh?x===Dr?y.y:y.y+y.height-Q.height:y.y+(y.height-Q.height)/2;for(var H=0;N>H;H++){var F=G[H],b=R[v],h=b.fontBoundingBoxDescent||c.height;Rf(A,F,C,M,{x:P,y:D,width:Q.width,height:h},al,x,l,Y,$,T),D+=h+K,v++}P+=Q.width+Y})}else{var F=u?kh(U,y.width,C,Y,e,K):U.split("\n"),b=F.length;if(b>1){var L=xs(C,U),s=L.height,d=b*s+K*(b-1),X=Dl(y);return x&&x!==hh?x===Er&&(X.y=y.y+y.height-d):X.y=y.y+(y.height-d)/2,X.height=d,rg(A,F,X,C,M,z||Vn,l,Y,$,T),void 0}Rf(A,U,C,M,y,z,x,l,Y,$,T)}}},w=function(h,y){Qd(A,q(h,kp),y.x,y.y,y.width,y.height,j(h,"width"))},u=function(x,X){var u=j(x,eg),L=0;if(u&&(u.forEach(function(z){L+=z}),L>0)){for(var w=j(x,"colors")||Sj,n=j(x,"startAngle")||0,M=j(x,"hollow"),O=j(x,Jo),v=j(x,Gj),P=j(x,Pc),U=O?new Xd:S,B=X.x,I=X.y,f=X.width,$=X.height,Y=B+f/2,y=I+$/2,E=_(f,$)/2,F=0,b=0;b<u.length;b++){var C=u[b],H=z*C/L,G=n+H;if(A.fillStyle=w[F++],F===w.length&&(F=0),A.beginPath(),M){var d=Y+s(n)*E/2,e=y+R(n)*E/2,h=Y+s(G)*E,T=y+R(G)*E;A.moveTo(d,e),A.arc(Y,y,E/2,n,G,!1),A.lineTo(h,T),A.arc(Y,y,E,G,n,!0)}else A.moveTo(Y,y),A.arc(Y,y,E,G,n,!0);U&&(H=(n+G)/2,U.add({text:Qj(O)?O(C,b,L,k):C,x:Y+.75*s(H)*E,y:y+.75*R(H)*E})),A.closePath(),A.fill(),n=G}U&&U.each(function(f){Qh(A,f.text,v,P,f.x,f.y,0,0,al)})}},U=function(H,d){var f=j(H,_e);if(f&&f.length>0){var r=f.length,h=j(H,Jo),G=j(H,Gj),Q=j(H,Pc),J=h?new Xd:S,N=j(H,"minValue")||0,i=j(H,"maxValue");if(i==S&&(i=0,f.forEach(function(E){j(E,eg).forEach(function(h){i=g(i,h)})})),N===i)return;for(var T=d.height/(i-N),K=d.y+i*T,L=j(f[0],eg).length,w=d.width/(3*L+1),Y=2*w/r,B=0,l=0;r>l;l++)for(var c=f[l],t=j(c,kp),b=j(c,"colors"),E=j(c,eg),U=0;L>U;U++){b?A.fillStyle=b[U]:t?A.fillStyle=t:(A.fillStyle=Sj[B++],B===Sj.length&&(B=0));var s=E[U],P=s*T,o=d.x+(1+3*U)*w+l*Y;if(Xf(A,o,K-P,Y,P),J){var e=Qj(h)?h(s,U,c,k):s,x=xs(G,e).height;J.add({x:o,y:K-P-x,width:Y,height:x,text:e})}}J&&J.each(function(X){Qh(A,X.text,G,Q,X.x,X.y,X.width,X.height,al)})}},G=function(D,s){var m=j(D,_e);if(m&&m.length>0){var P=m.length,H=j(m[0],eg).length,Q=s.width/(3*H+1),h=0,i=j(D,"maxValue"),o=j(D,Jo),G=j(D,Gj),L=j(D,Pc),d=o?new Xd:S;if(i==S){i=0;for(var n=0;H>n;n++){for(var V=0,I=0;P>I;I++)V+=j(m[I],eg)[n];i=g(i,V)}}if(i>0){for(var n=0;H>n;n++)for(var C=s.y+s.height,I=0;P>I;I++){var J=m[I],u=j(J,kp),R=j(J,eg)[n],b=R/i*s.height;u?A.fillStyle=u:(A.fillStyle=Sj[h++],h===Sj.length&&(h=0)),C-=b;var B={x:s.x+(1+3*n)*Q,y:C,width:2*Q,height:b};Xf(A,B.x,B.y,B.width,B.height),d&&(B.text=Qj(o)?o(R,n,J,k):R,d.add(B))}d&&d.each(function(X){Qh(A,X.text,G,L,X.x,X.y,X.width,X.height,al)})}}},i=function(O,I){var r=j(O,_e);if(r&&r.length>0){for(var Z=r.length,W=j(r[0],eg).length,b=I.width/(3*W+1),n=0,M=j(O,Jo),U=j(O,Gj),H=j(O,Pc),z=M?new Xd:S,s=0;W>s;s++){for(var F=0,v=0;Z>v;v++)F+=j(r[v],eg)[s];if(F>0){var G=I.y+I.height;for(v=0;Z>v;v++){var l=r[v],q=j(l,kp),i=j(l,eg)[s],m=i/F*I.height;q?A.fillStyle=q:(A.fillStyle=Sj[n++],n===Sj.length&&(n=0)),G-=m;var Q={x:I.x+(1+3*s)*b,y:G,width:2*b,height:m};Xf(A,Q.x,Q.y,Q.width,Q.height),z&&(Q.text=Qj(M)?M(i,s,l,k):i,z.add(Q))}}}z&&z.each(function(O){Qh(A,O.text,U,H,O.x,O.y,O.width,O.height,al)})}},C=function(U,n){var Z=j(U,_e);if(Z&&Z.length>0){var K=Z.length,w=j(U,"minValue")||0,$=j(U,"maxValue");if($==S&&($=0,Z.forEach(function(X){j(X,eg).forEach(function(G){$=g($,G)})})),w===$)return;for(var D=n.height/($-w),o=n.y+$*D,X=j(Z[0],eg).length,V=n.width/(3*X+1),I=0,C=j(U,"lineWidth")||2,G=j(U,"line3d"),O=j(U,"linePoint"),m=j(U,Jo),p=j(U,Gj),E=j(U,Pc),u=0;K>u;u++){var F=Z[u],B=j(F,kp),t=j(F,eg);B?A.strokeStyle=B:(B=A.strokeStyle=Sj[I++],I===Sj.length&&(I=0)),A.beginPath();for(var q=0;X>q;q++){var L=n.x+(2+3*q)*V,Y=o-t[q]*D;0===q?A.moveTo(L,Y):A.lineTo(L,Y)}if(A.lineWidth=C,A.stroke(),G&&vl(A,B,S,C,x),O||m){var N,d=C/2+2;for(q=0;X>q;q++){var s=t[q];if(L=n.x+(2+3*q)*V,Y=o-s*D,Qj(O)?O(A,L,Y,B,q,F,k):O&&(A.fillStyle=B,A.beginPath(),A.arc(L,Y,d,0,z,!0),A.fill()),Qj(m)?N=m(s,q,F,k):m&&(N=s),N){var v=xs(p,N).height,J=A.shadowBlur;
if(J){var P=A.shadowOffsetX,T=A.shadowOffsetY,H=A.shadowColor;A.shadowOffsetX=0,A.shadowOffsetY=0,A.shadowBlur=0,A.shadowColor=S}Qh(A,N,p,E,L,Y-v-d+2,0,v,al),J&&(A.shadowOffsetX=P,A.shadowOffsetY=T,A.shadowBlur=J,A.shadowColor=H)}}}}}},V=function(Q){A=Q[0],k=Q[1],E=Q[2],x=Q[3],p=Q[4],O=Q[5]},y=function(){return[A,k,E,x,p,O]},Z=function(G,l){var U;E&&E.getDrawableState?U=E.getDrawableState(k):E&&E.getState?U=E.getState(k):(U=k instanceof gi?k.s(Io):null,(U===W||null===U)&&(U=j(G,Io)));var T=j(l,Io);return T!==W&&null!==T&&T!==U?!1:j(l,jh)},I={border:w,image:f,text:t,pieChart:u,columnChart:U,stackedColumnChart:G,percentageColumnChart:i,lineChart:C};return function(L,B,h,K,w,m,R,v,o,J){if(B&&w&&m){var C=y();A=L,k=R,E=v,!k&&E&&E.isSelfViewEvent&&(k=E),x=E?E._zoom?E._zoom:1:1,p=o,O=J;var g=w,D=m;if(Uf()){var t,z,r,s,i,$;0===A[Ui]?Uf[0]&&(t=!0):t=!0,A.texureImage2D?Uf[1]&&(z=!0):z=!0,A.texureImage3D?Uf[2]&&(r=!0):r=!0,A.drawDNDState?Uf[3]&&(i=!0):i=!0,n[qc[1]+ib[0]+bk[1]]?Uf[ib[0]]&&($=!0):$=!0,$b.widget[0]?Uf[4]&&(s=!0):s=!0,t&&z&&r&&s&&i&&$&&(g=h,D=K)}if(B.tagName)return xd(zm)&&!e[zm]||A.drawImage(B,g,D,w,m),V(C),void 0;if(0==j(B,"visible"))return V(C),void 0;p||(p=dd(B.color,k,E)),J||(O=dd(B.blendMode,k,E)),xd(zm)&&!e[zm]&&(w=g,m=D);var F=lm(B,k,E,w),U=qj(B,k,E,m),f={x:0,y:0,width:F,height:U,fitSize:Tl(B,k,E)},_=j(B,"clip"),a=j(B,"opacity");if(f.fitSize){var G=f.rw=dd(B.width,k,E)||20;f.widthScale=F/G;var u=f.rh=dd(B.height,k,E)||20;f.heightScale=U/u}if(A.save(),A.interactiveInfo){var ac=A.interactiveInfo.matrix,vi=ac.clone();ac.appendTranslate(g,D).appendScale(w/F,m/U),A.interactiveInfo.refRect=f}Tc(A,g,D),(F!==w||U!==m)&&A.scale(w/F,m/U),_&&(Qj(_)?_(A,F,U,k,E,B):(A.beginPath(),A.rect(0,0,F,U),A.clip())),a!=S&&(A.globalAlpha*=a),j(B,"comps").forEach(function(L){if(L.prefix){var K=Xl,J=dd(L.prefix,k,E);J&&(Xl=Xl+J+".")}if(0==Z(B,L))return L.prefix&&(Xl=K),void 0;if(kr.splice(0,0,L),A.interactiveInfo)var $=A.interactiveInfo.matrix.clone();var r=j(L,"opacity"),w=j(L,"shadow"),v=j(L,"type"),m=j(L,"refRect")||f,U=M(L,m);if(r!=S){var V=A.globalAlpha;A.globalAlpha*=r}if(w){var z=x*H.devicePixelRatio,g=A.shadowOffsetX,s=A.shadowOffsetY,e=A.shadowBlur,h=A.shadowColor,C=j(L,"shadowOffsetX"),u=j(L,"shadowOffsetY"),y=j(L,"shadowBlur"),_=q(L,"shadowColor");A.shadowOffsetX=(C==S?l:C)*z,A.shadowOffsetY=(u==S?l:u)*z,A.shadowBlur=(y==S?X:y)*z,A.shadowColor=_||q(Sh)}if("save"===v)A.save();else if("endClip"===v||"restore"===v)A.restore();else if("clip"===v)A.save(),$j(A,j(L,"points",b),j(L,"segments",T),!0),A.clip();else if($p[v]){if(U=U||{x:0,y:0,width:m.width,height:m.height},Q(L,v,U,m),L.prefix&&0===L.prefix.indexOf("ui.")&&E&&n.ui&&E instanceof n.ui.View){E._vectorCompInfo||(E._vectorCompInfo=[]);for(var O=!1,o=0;o<E._vectorCompInfo.length;o++){var G=E._vectorCompInfo[o];if(L.prefix===G.comp.prefix&&R===G.data){E._vectorCompInfo[o]={comp:L,type:v,rect:U,compRefRect:m,data:R,image:B,transform:A.getTransform()},O=!0;break}}O||E._vectorCompInfo.push({comp:L,type:v,rect:U,compRefRect:m,data:R,image:B,transform:A.getTransform()})}}else if(v===Zb)Q(L,v,U,m);else if("SVGPath"===v)d(L,v,U);else{U=U||{x:0,y:0,width:m.width,height:m.height};var D=j(L,vm),i=j(L,"scaleX"),p=j(L,"scaleY"),t=Y(L),F=P(L,U,U,D,i,p,t);if(Qj(v))N(L,v),H.drawCompType(v,A,U,L,k,E);else if(H.getCompType(v)){var a=H.getCompType(v),db=a.func||a;N(L,a),H.drawCompType(db,A,U,L,k,E)}else I[v]?I[v](L,U):H.getCompType(v)===W&&dp.test(v)&&(rm(v),Nh=!1);F&&c()}w&&(A.shadowOffsetX=g,A.shadowOffsetY=s,A.shadowBlur=e,A.shadowColor=h),r!=S&&(A.globalAlpha=V),A.interactiveInfo&&(A.interactiveInfo.matrix=$),L.prefix&&(Xl=K),kr.splice(0,1)}),A.interactiveInfo&&(A.interactiveInfo.matrix=vi),A.restore(),V(C)}}}();H.getCurrentComp=function(){return kr[0]},H.getParentComp=function(){return kr[1]},H.getInternal=function(){return{isEnter:Db,isEsc:Jr,isSpace:vr,isLeft:Lp,isUp:dl,isRight:Nr,isDown:Se,addMethod:kk,superCall:fb,toPointsArray:Wo,translateAndScale:of,appendArray:Qb,createWorldMatrix:um,vec3TransformMat4:ak,setCanvas:Vj,createDiv:ue,createView:Xk,createCanvas:Zj,createImage:Rn,initContext:ed,layout:Pg,fillRect:Xf,Mat:ur,drawBorder:Qd,isString:xd,setBorder:jb,getPropertyValue:yi,setPropertyValue:ae,drawVerticalLine:Bk,draw3DRect:Ug,getPinchDist:Ur,isSameRect:hf,getPosition:Cs,intersectionLineRect:Ko,getNodeRect:$q,getEdgeAgentPosition:qp,getEdgeHostPosition:Xn,getImageWidth:lm,getImageHeight:qj,initItemElement:bb,drawPoints:$j,createG2:Tr,closePopup:An,isH:Nl,createAnim:qd,createNormalMatrix:Zo,makeUVMatrix:Wg,toColorArray:Bp,createNormals:pn,toFloatArray:Nk,glMV:Ac,glPop:fn,batchShape:oj,createNodeMatrix:tp,getShapeModel:ze,getFaceInfo:Bf,transformAppend:ah,drawFaceInfo:Mi,glUploadData:Lo,glUploadElementData:gl,glDrawArray:Oe,glDrawElement:Yi,glBindTexture:fd,pickValueToColor:Us,to3dPointsArray:Ne,setGLDebugMode:function(e){Qn=e},cube:function(){return{vs:Ar,is:Ph,uv:Xp}},ui:function(){return{DataUI:Ag,NodeUI:is,EdgeUI:zk,GroupUI:Ek,ShapeUI:Jk,GridUI:qo,Data3dUI:it,Node3dUI:jt,Shape3dUI:mt}},getInternalVersion:function(){return"U2FsdGVkX1+cMj6V8I4GaetLvmgHBXNyKriu7vmE1Yw="},getDragger:function(){return nm},addMSMap:function(Z){kk(Ep,Z)},k:u,overrideTimerFunc:function(P,z){Pm=n.Default.callLater=P,sd=n.Default.cancelLater=z},canEnterEditDetailMode:yk,addEventListener:Z,removeEventListener:N,createGradientByPackedData:Id}},function(f){function w(i,s){i!=S&&(s==S&&ps!=typeof i?this._54O(i,256):this._54O(i,s))}function r(){return new w(S)}function y(U,N,B,X,H,P){for(;--P>=0;){var S=N*this[U++]+B[X]+H;H=j(S/67108864),B[X++]=67108863&S}return H}function C(I,n,d,E,t,q){for(var K=32767&n,G=n>>15;--q>=0;){var L=32767&this[I],N=this[I++]>>15,h=G*L+N*K;L=K*L+((32767&h)<<15)+d[E]+(1073741823&t),t=(L>>>30)+(h>>>15)+G*N+(t>>>30),d[E++]=1073741823&L}return t}function A(Y,c,N,m,J,d){for(var I=16383&c,f=c>>14;--d>=0;){var g=16383&this[Y],Z=this[Y++]>>14,R=f*g+Z*I;g=I*g+((16383&R)<<14)+N[m]+J,J=(g>>28)+(R>>14)+f*Z,N[m++]=268435455&g}return J}function e(k){return Jr.charAt(k)}function c(X,m){var s=zh[X.charCodeAt(m)];return s==S?-1:s}function l(v){for(var a=this.t-1;a>=0;--a)v[a]=this[a];v.t=this.t,v.s=this.s}function Z(a){this.t=1,this.s=0>a?-1:0,a>0?this[0]=a:-1>a?this[0]=a+this.DV:this.t=0}function U(Q){var B=r();return B._58O(Q),B}function Q(z,M){var $,A=this;if(16==M)$=4;else if(8==M)$=3;else if(256==M)$=8;else if(2==M)$=1;else if(32==M)$=5;else{if(4!=M)return A.fromRadix(z,M),void 0;$=2}A.t=0,A.s=0;for(var K=z.length,l=!1,p=0;--K>=0;){var X=8==$?255&z[K]:c(z,K);0>X?"-"==z.charAt(K)&&(l=!0):(l=!1,0==p?A[A.t++]=X:p+$>A.DB?(A[A.t-1]|=(X&(1<<A.DB-p)-1)<<p,A[A.t++]=X>>A.DB-p):A[A.t-1]|=X<<p,p+=$,p>=A.DB&&(p-=A.DB))}8==$&&0!=(128&z[0])&&(A.s=-1,p>0&&(A[A.t-1]|=(1<<A.DB-p)-1<<p)),A._57O(),l&&w.ZERO._78O(A,A)}function n(){for(var b=this,C=b.s&b.DM;b.t>0&&b[b.t-1]==C;)--b.t}function H(H){var k=this;if(k.s<0)return"-"+k._85O()[fs](H);var T;if(16==H)T=4;else if(8==H)T=3;else if(2==H)T=1;else if(32==H)T=5;else{if(4!=H)return k.toRadix(H);T=2}var U,E=(1<<T)-1,o=!1,z="",R=k.t,N=k.DB-R*k.DB%T;if(R-->0)for(N<k.DB&&(U=k[R]>>N)>0&&(o=!0,z=e(U));R>=0;)T>N?(U=(k[R]&(1<<N)-1)<<T-N,U|=k[--R]>>(N+=k.DB-T)):(U=k[R]>>(N-=T)&E,0>=N&&(N+=k.DB,--R)),U>0&&(o=!0),o&&(z+=e(U));return o?z:"0"}function W(){var H=r();return w.ZERO._78O(this,H),H}function o(){return this.s<0?this._85O():this}function p(z){var t=this,E=t.s-z.s;if(0!=E)return E;var G=t.t;if(E=G-z.t,0!=E)return t.s<0?-E:E;for(;--G>=0;)if(0!=(E=t[G]-z[G]))return E;return 0}function i(X){var h,v=1;return 0!=(h=X>>>16)&&(X=h,v+=16),0!=(h=X>>8)&&(X=h,v+=8),0!=(h=X>>4)&&(X=h,v+=4),0!=(h=X>>2)&&(X=h,v+=2),0!=(h=X>>1)&&(X=h,v+=1),v}function F(){var Y=this;return Y.t<=0?0:Y.DB*(Y.t-1)+i(Y[Y.t-1]^Y.s&Y.DM)}function Y(K,n){var Z;for(Z=this.t-1;Z>=0;--Z)n[Z+K]=this[Z];for(Z=K-1;Z>=0;--Z)n[Z]=0;n.t=this.t+K,n.s=this.s}function v(m,d){for(var B=m;B<this.t;++B)d[B-m]=this[B];d.t=g(this.t-m,0),d.s=this.s}function N(c,b){var F,T=this,p=c%T.DB,W=T.DB-p,l=(1<<W)-1,N=j(c/T.DB),J=T.s<<p&T.DM;for(F=T.t-1;F>=0;--F)b[F+N+1]=T[F]>>W|J,J=(T[F]&l)<<p;for(F=N-1;F>=0;--F)b[F]=0;b[N]=J,b.t=T.t+N+1,b.s=T.s,b._57O()}function d(c,g){var m=this;g.s=m.s;var w=j(c/m.DB);if(w>=m.t)return g.t=0,void 0;var A=c%m.DB,F=m.DB-A,D=(1<<A)-1;g[0]=m[w]>>A;for(var O=w+1;O<m.t;++O)g[O-w-1]|=(m[O]&D)<<F,g[O-w]=m[O]>>A;A>0&&(g[m.t-w-1]|=(m.s&D)<<F),g.t=m.t-w,g._57O()}function G(m,c){for(var B=this,C=0,O=0,V=_(m.t,B.t);V>C;)O+=B[C]-m[C],c[C++]=O&B.DM,O>>=B.DB;if(m.t<B.t){for(O-=m.s;C<B.t;)O+=B[C],c[C++]=O&B.DM,O>>=B.DB;O+=B.s}else{for(O+=B.s;C<m.t;)O-=m[C],c[C++]=O&B.DM,O>>=B.DB;O-=m.s}c.s=0>O?-1:0,-1>O?c[C++]=B.DV+O:O>0&&(c[C++]=O),c.t=C,c._57O()}function X(I,Z){var P=this.abs(),J=I.abs(),c=P.t;for(Z.t=c+J.t;--c>=0;)Z[c]=0;for(c=0;c<J.t;++c)Z[c+P.t]=P.am(0,J[c],Z,c,0,P.t);Z.s=0,Z._57O(),this.s!=I.s&&w.ZERO._78O(Z,Z)}function P(i){for(var f=this.abs(),K=i.t=2*f.t;--K>=0;)i[K]=0;for(K=0;K<f.t-1;++K){var Y=f.am(K,f[K],i,2*K,0,1);(i[K+f.t]+=f.am(K+1,2*f[K],i,2*K+1,Y,f.t-K-1))>=f.DV&&(i[K+f.t]-=f.DV,i[K+f.t+1]=1)}i.t>0&&(i[i.t-1]+=f.am(K,f[K],i,2*K,0,1)),i.s=0,i._57O()}function B(k,d,D){var t=k.abs(),l=this;if(!(t.t<=0)){var P=l.abs();if(P.t<t.t)return d!=S&&d._58O(0),D!=S&&l._77O(D),void 0;D==S&&(D=r());var y=r(),h=l.s,W=k.s,L=l.DB-i(t[t.t-1]);L>0?(t._44O(L,y),P._44O(L,D)):(t._77O(y),P._77O(D));var f=y.t,b=y[f-1];if(0!=b){var V=b*(1<<l.F1)+(f>1?y[f-2]>>l.F2:0),v=l.FV/V,$=(1<<l.F1)/V,x=1<<l.F2,X=D.t,F=X-f,A=d==S?r():d;for(y._59O(F,A),D._52O(A)>=0&&(D[D.t++]=1,D._78O(A,D)),w.ONE._59O(f,A),A._78O(y,y);y.t<f;)y[y.t++]=0;for(;--F>=0;){var q=D[--X]==b?l.DM:j(D[X]*v+(D[X-1]+x)*$);if((D[X]+=y.am(0,q,D,F,0,f))<q)for(y._59O(F,A),D._78O(A,D);D[X]<--q;)D._78O(A,D)}d!=S&&(D._45O(f,d),h!=W&&w.ZERO._78O(d,d)),D.t=f,D._57O(),L>0&&D._46O(L,D),0>h&&w.ZERO._78O(D,D)}}}function T(b){var Y=r();return this.abs()._49O(b,S,Y),this.s<0&&Y._52O(w.ZERO)>0&&b._78O(Y,Y),Y}function O(p){this.m=p}function M(O){return O.s<0||O._52O(this.m)>=0?O.mod(this.m):O}function E(B){return B}function I(E){E._49O(this.m,S,E)}function L(T,i,v){T._47O(i,v),this._74O(v)}function h(E,G){E._48O(G),this._74O(G)}function D(){if(this.t<1)return 0;var S=this[0];if(0==(1&S))return 0;var v=3&S;return v=15&v*(2-(15&S)*v),v=255&v*(2-(255&S)*v),v=65535&v*(2-(65535&(65535&S)*v)),v=v*(2-S*v%this.DV)%this.DV,v>0?this.DV-v:-v}function m(B){var r=this;r.m=B,r.mp=B._50O(),r.mpl=32767&r.mp,r.mph=r.mp>>15,r.um=(1<<B.DB-15)-1,r.mt2=2*B.t}function q(V){var R=r();return V.abs()._59O(this.m.t,R),R._49O(this.m,S,R),V.s<0&&R._52O(w.ZERO)>0&&this.m._78O(R,R),R}function b(G){var u=r();return G._77O(u),this._74O(u),u}function a(P){for(var s=this;P.t<=s.mt2;)P[P.t++]=0;for(var a=0;a<s.m.t;++a){var T=32767&P[a],x=T*s.mpl+((T*s.mph+(P[a]>>15)*s.mpl&s.um)<<15)&P.DM;for(T=a+s.m.t,P[T]+=s.m.am(0,x,P,a,0,s.m.t);P[T]>=P.DV;)P[T]-=P.DV,P[++T]++}P._57O(),P._45O(s.m.t,P),P._52O(s.m)>=0&&P._78O(s.m,P)}function J(T,J){T._48O(J),this._74O(J)}function $(j,r,F){j._47O(r,F),this._74O(F)}function Ok(){return 0==(this.t>0?1&this[0]:this.s)}function ng(Y,v){if(Y>4294967295||1>Y)return w.ONE;var N=r(),q=r(),I=v._73O(this),h=i(Y)-1;for(I._77O(N);--h>=0;)if(v._76O(N,q),(Y&1<<h)>0)v._75O(q,I,N);else{var H=N;N=q,q=H}return v.revert(N)}function hr(v,Q){var j;return j=256>v||Q._51O()?new O(Q):new m(Q),this.exp(v,j)}function Xb(){var y=this;if(y.s<0){if(1==y.t)return y[0]-y.DV;if(0==y.t)return-1}else{if(1==y.t)return y[0];if(0==y.t)return 0}return(y[1]&(1<<32-y.DB)-1)<<y.DB|y[0]}function Ai(G,b){return new w(G,b)}function $l(){var u=this;u.n=S,u.e=0,u.d=S,u.p=S,u.q=S,u.dmp1=S,u.dmq1=S,u._10A=S}function Xi(R){return R._53O(this.e,this.n)}function cf(x){var Y,U,Z,H="",k=0;for(Y=0;Y<x.length&&x.charAt(Y)!=rf;++Y)Z=Kg.indexOf(x.charAt(Y)),0>Z||(0==k?(H+=e(Z>>2),U=3&Z,k=1):1==k?(H+=e(U<<2|Z>>4),U=15&Z,k=2):2==k?(H+=e(U),H+=e(Z>>2),U=3&Z,k=3):(H+=e(U<<2|Z>>4),H+=e(15&Z),k=0));return 1==k&&(H+=e(U<<2)),H}function nc(v){var h=v.split(""),i=cf(v);return h.forEach(function(K){var E=K.length;E>0&&i&&(zj+=fl(K))}),i}function $b(Z,h){var l=El._4O.Util._56O(Z,"ss"),o={},P=0;return o.v=l==h,o.t=1,o.s=0>P?-1:0,Kh=o.v,P>0?o[0]=P:-1>P?o[0]=P+o.DV:o.t=0,[l,o]}function Yc(g){var q=38,Q=g.substring(0,q);if(Q&&30==Q.indexOf("05000420")){var B=["ss",g.substring(q)];return B}return[]}function hk(D,F){F=F.replace(gl,""),F=F.replace(/[ \n]+/g,"");var N=Ai(F,16);if(N._55O()>this.n._55O())return 0;var K=this._37O(N),P=K[fs](16).replace(/^1f+00/,""),X=Yc(P);if(0==X.length)return!1;for(var G,o,T,n=.5,x=pb,A=[0,.5,.75,.875,.9375],y=[],p=[],S=[],O=z/x,W=X[1],q=$b(D,W)[0],C=0,Y=0;C<A.length;C++){var l=0===C%2?0:.5;for(G=0;x>=G;G++)o=(G+l)*O,T=1-A[C],y.push(s(o)*n*T,-n+2*A[C]*n,-R(o)*n*T),p.push((G+l)/x,T)}for(C=0;C<A.length-1;C++){var B=C*(x+1),d=(C+1)*(x+1);for(G=0;x>G;G++)S.push(B+G,d+G+1,d+G,B+G,B+G+1,d+G+1)}return S.forEach(function(i){Y+=i}),W==q&&Y>10}var Wg,$n=0xdeadbeefcafe,Ec=15715070==(16777215&$n),fs="toString",Hg="",Yh="nat",Sg=function(){};K=f["D"+11182[fs](t(2,5))];var Gb=w.prototype;cq+=Dn.substr(0,1);var Co=f.navigator?f.navigator.appName:"";Ec&&"Microsoft Internet Explorer"==Co?(Gb.am=C,Wg=30):Ec&&"Netscape"!=Co?(Gb.am=y,Wg=26):(Gb.am=A,Wg=28),Gb.DB=Wg,Gb.DM=(1<<Wg)-1,Gb.DV=1<<Wg;var vk=52;Gb.FV=t(2,vk),Gb.F1=vk-Wg,Gb.F2=2*Wg-vk;var pm,Wk,Jr="0123456789abcdefghijklmnopqrstuvwxyz",zh=[],Em=function(U){return String.fromCharCode(U)};for(pm="0".charCodeAt(0),Wk=0;9>=Wk;++Wk)zh[pm++]=Wk;for(pm="a".charCodeAt(0),Wk=10;36>Wk;++Wk)zh[pm++]=Wk;for(pm="A".charCodeAt(0),Wk=10;36>Wk;++Wk)zh[pm++]=Wk;var xf=O.prototype;xf._73O=M,xf.revert=E,xf._74O=I,xf._75O=L,xf._76O=h;var Km=m.prototype;Km._73O=q,Km.revert=b,Km._74O=a,Km._75O=$,Km._76O=J,Gb._77O=l,Gb._58O=Z,Gb._54O=Q,Gb._57O=n,Gb._59O=Y,Gb._45O=v,Gb._44O=N,Gb._46O=d,Gb._78O=G,Gb._47O=X,Gb._48O=P,Gb._49O=B,Gb._50O=D,Gb._51O=Ok,Gb.exp=ng,Gb.toString=H,Gb._85O=W,Gb.abs=o,Gb._52O=p,Gb._55O=F,Gb.mod=T,Gb._53O=hr,w.ZERO=U(0),w.ONE=U(1),Gb._86O=Xb;var Xl=function(u,y){var r=this;r.isPublic=!0,typeof u!==ps?(r.n=u,r.e=y):u!=S&&y!=S&&u.length>0&&y.length>0&&(r.n=Ai(u,16),r.e=fl(y,16))};Ik=function(){var h,l,o=nc(Zl),z=o.substr(0,4),G=o.substr(4,2),O=o.substr(6,2),$=1,T=!$,H=u,M=[],j=Gn.charAt(7);if(K&&(K[fs]().indexOf(Yh)<0||K[cq][fs]().indexOf(Yh)<0||!o?h=S:(o=new K(z-0,G-$,O-0),l=o.setHours(9),K[cq]()>l?h=qs[j]:T=!0)),o&&h&&h[0]&&h[k(.5)]&&H){var b=Ye(h[0]),Y=Ye(h[1]);for(var q in Y)M.push(q);var f,_=0,E=b[M[_]],m=Y[M[_++]],F=Y[M[_++]],W=Y[M[_++]],r=Y[M[_++]],N=Y[M[_++]],x=Y[M[_++]],X=b[M[_]],d=Y[M[_++]],c=Cg._27O(H);if(E===m&&c&&d){f=m+F+W+r+N+x;var J=!x||x===Hc;if(!J&&x)for(var a,t=0,L=x.length;L>t;t++)x[t]===_n[_]?a===Hc?J=!0:a[0]===up[5]&&Hc&&Hc.indexOf(a.substr(1))>=0?J=!0:a=S:(a==S?a=x[t]:a+=x[t],t===L-1&&(a===Hc?J=!0:a[0]===up[5]&&Hc&&Hc.indexOf(a.substr(1))>=0&&(J=!0)));f&&c._31O(f,d)&&c._31O(E,X)&&J&&(!N||K[cq]()<N)&&(T=!0)}}return T||(Dj=bg),j};var zp=$l.prototype;zp._37O=Xi,zp._38O=Xl;var Kg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",rf="=",qh=25,Bk=10,Zl="ICJRU===",Nl=Nl||function(K,A){var T={},I=T._7A={},e=I._6A=function(){function B(){}return{_80O:function(e){B.prototype=this;var o=new B;return e&&o._5A(e),o.hasOwnProperty("_82O")||(o._82O=function(){o.$super._82O.apply(this,arguments)}),o._82O.prototype=o,o.$super=this,o},_3A:function(){var J=this._80O();return J._82O.apply(J,arguments),J},_82O:function(){},_5A:function(r){for(var m in r)r.hasOwnProperty(m)&&(this[m]=r[m]);r.hasOwnProperty(fs)&&(this.toString=r.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),S=I._39O=e._80O({_82O:function(O,k){O=this._84O=O||[],this._65O=k!=A?k:4*O.length},toString:function(t){return(t||c).stringify(this)},_89O:function(D){var U=this._84O,h=D._84O,t=this._65O,P=D._65O;if(this._57O(),t%4)for(var L=0;P>L;L++){var o=255&h[L>>>2]>>>24-8*(L%4);U[t+L>>>2]|=o<<24-8*((t+L)%4)}else if(h.length>65535)for(var L=0;P>L;L+=4)U[t+L>>>2]=h[L>>>2];else U.push.apply(U,h);return this._65O+=P,this},_57O:function(){var h=this._84O,G=this._65O;h[G>>>2]&=4294967295<<32-8*(G%4),h.length=k(G/4)},_88O:function(){var c=e._88O.call(this);return c._84O=this._84O.slice(0),c},_87O:function(a){for(var p=[],q=0;a>q;q+=4)p.push(0|4294967296*kj);return new S._82O(p,a)}}),W=T._2A={},c=W._69O={stringify:function(g){var U,b=g._84O,c=g._65O,O=[];for(U=0;c>U;U++){var R=255&b[U>>>2]>>>24-8*(U%4);O.push((R>>>4).toString(16)),O.push((15&R).toString(16))}return O.join("")},_68O:function(l){for(var M=l.length,A=[],u=0;M>u;u+=2)A[u>>>3]|=fl(l.substr(u,2),16)<<24-4*(u%8);return new S._82O(A,M/2)}},m=W._8A={stringify:function(q){var P,B=q._84O,e=q._65O,b=[];for(P=0;e>P;P++){var C=255&B[P>>>2]>>>24-8*(P%4);b.push(Em(C))}return b.join("")},_68O:function(A){var I,$=A.length,b=[];for(I=0;$>I;I++)b[I>>>2]|=(255&A.charCodeAt(I))<<24-8*(I%4);return new S._82O(b,$)}},v=W._9A={stringify:function(P){try{return decodeURIComponent(escape(m.stringify(P)))}catch(n){throw new Error("")}},_68O:function(W){return m._68O(unescape(encodeURIComponent(W)))}},Q=I._32O=e._80O({_1A:function(){this._83O=new S._82O,this._23O=0},_33O:function(C){typeof C==ps&&(C=v._68O(C)),this._83O._89O(C),this._23O+=C._65O},_25O:function(U){var r=this._83O,D=r._84O,v=r._65O,X=this._79O,P=4*X,B=v/P;B=U?k(B):g((0|B)-this._22O,0);var Y=B*X,u=_(4*Y,v);if(Y){for(var i=0;Y>i;i+=X)this._20O(D,i);var b=D.splice(0,Y);r._65O-=u}return new S._82O(b,u)},_88O:function(){var x=e._88O.call(this);return x._83O=this._83O._88O(),x},_22O:0});I._66O=Q._80O({cfg:e._80O(),_82O:function(Z){this.cfg=this.cfg._80O(Z),this._1A()},_1A:function(){Q._1A.call(this),this._34O()},_81O:function(q){return this._33O(q),this._25O(),this},_72O:function(w){w&&this._33O(w);var Z=this._21O();return Z},_79O:16,_26O:function(t){return function(O,e){return new t._82O(e)._72O(O)}},_19O:function(v){return function(t,c){return new i._71O._82O(v,c)._72O(t)}}});var i=T._67O={};return T}();!function(){var Y=Nl,M=Y._7A,W=M._39O,h=M._66O,N=Y._67O,X=[],K=[];!function(){function Q(S){for(var b=x(S),C=2;b>=C;C++)if(!(S%C))return!1;return!0}function E(L){return 0|4294967296*(L-(0|L))}for(var T=2,c=0;64>c;)Q(T)&&(8>c&&(X[c]=E(t(T,.5))),K[c]=E(t(T,1/3)),c++),T++}();var i=[],E=N._41O=h._80O({_34O:function(){this._64O=new W._82O(X.slice(0))},_20O:function(y,l){for(var E=this._64O._84O,a=E[0],_=E[1],g=E[2],c=E[3],q=E[4],e=E[5],J=E[6],N=E[7],A=0;64>A;A++){if(16>A)i[A]=0|y[l+A];else{var C=i[A-15],$=(C<<25|C>>>7)^(C<<14|C>>>18)^C>>>3,k=i[A-2],j=(k<<15|k>>>17)^(k<<13|k>>>19)^k>>>10;i[A]=$+i[A-7]+j+i[A-16]}var H=q&e^~q&J,F=a&_^a&g^_&g,Q=(a<<30|a>>>2)^(a<<19|a>>>13)^(a<<10|a>>>22),M=(q<<26|q>>>6)^(q<<21|q>>>11)^(q<<7|q>>>25),X=N+M+H+K[A]+i[A],t=Q+F;N=J,J=e,e=q,q=0|c+X,c=g,g=_,_=a,a=0|X+t}E[0]=0|E[0]+a,E[1]=0|E[1]+_,E[2]=0|E[2]+g,E[3]=0|E[3]+c,E[4]=0|E[4]+q,E[5]=0|E[5]+e,E[6]=0|E[6]+J,E[7]=0|E[7]+N},_21O:function(){var I=this._83O,W=I._84O,y=8*this._23O,u=8*I._65O;return W[u>>>5]|=128<<24-u%32,W[(u+64>>>9<<4)+14]=j(y/4294967296),W[(u+64>>>9<<4)+15]=y,I._65O=4*W.length,this._25O(),this._64O},_88O:function(){var T=h._88O.call(this);return T._64O=this._64O._88O(),T}});Y._41O=h._26O(E),Y._42O=h._19O(E)}();var gl=new RegExp("");gl.compile("[^0-9a-f]","gi"),$l._28O=-1,$l._29O=-2,zp._31O=hk,zp._63O=hk,$l._43O=-2;var qn=new function(){var E=this;E._5O=function(Q,Z){if("8"!=Q.substring(Z+2,Z+3))return 1;var O=fl(Q.substring(Z+3,Z+4));return 0==O?-1:O>0&&10>O?O+1:-2},E._13O=function(Y,S){var W=E._5O(Y,S);return 1>W?"":Y.substring(S+2,S+2+2*W)},E._12O=function(Q,Z){var B=E._13O(Q,Z);if(""==B)return-1;var z;return z=fl(B.substring(0,1))<8?new w(B,16):new w(B.substring(2),16),z._86O()},E._6O=function(K,m){var n=E._5O(K,m);return 0>n?n:m+2*(n+1)},E._11O=function(j,Z){var d=E._6O(j,Z),J=E._12O(j,Z);return j.substring(d,d+2*J)},E._10O=function($,t){var D=E._6O($,t),R=E._12O($,t);return D+2*R},E._7O=function(K,g){var $=[],q=E._6O(K,g);$.push(q);for(var U=E._12O(K,g),J=q,Y=0;;){var F=E._10O(K,J);if(F==S||F-q>=2*U)break;if(Y>=200)break;$.push(F),J=F,Y++}return $}};if(qn._90O=Em(Bk+24),qn._91O=V+Em(Bk*Bk+8),El==S||!El)var El={};El._4O!=S&&El._4O||(El._4O={});var Ad=El._4O;El._4O.Util=new function(){var $=this;$._56O=function(Q){var w=new El._4O._3O;return w._30O(Q)},$._4A=function(C){var d=new El._4O._3O;return d._36O(C)},$._11A=function(K){var F=new Ad._3O;return F._30O(K)}},El._4O._3O=function(){var j=this;j._8O=function(t,w){if("ss"==t&&"cj"==w){try{j.md=Nl._67O._41O._3A()}catch(d){Sg(Hg)}j._24O=function($){j.md._81O($)},j._35O=function(q){var n=Nl._2A._69O._68O(q);j.md._81O(n)},j._60O=function(){var E=j.md._72O();return E[fs](Nl._2A._69O)},j._30O=function(Q){return j._24O(Q),j._60O()},j._36O=function(b){return j._35O(b),j._60O()}}},j._24O=function(){Sg(Hg)},j._35O=function(){Sg(Hg)},j._60O=function(){Sg(Hg)},j._30O=function(){Sg(Hg)},j._36O=function(){Sg(Hg)},j._8O("ss","cj")},Gc=function(g){var Y=kc[ql[7]],H=1,M=!1;if(Pi.a!=kc[Jd])return Pi.a;if(Pi.forEach(function(W){H*=W}),g>H){if(Y&&Y[1]&&Y[0]){var j=Y[0],J=Y[1];J=J.split(qn._90O),j=j.split(qn._90O);var z=J[3],p=j[3],B=J[7],T=J[11],b=J[15],V=J[19],A=J[23],N=J[27],o=j[7],r=z+B+T+b+V+A,h=A?!1:!0,G=p===z;if(A){var x=A&&A.split(Bc("firefox")[3]);if(x)for(var E=0;E<x.length;E++){var S=x[E];if(S[0]===Gh[8]&&(S=S.substring(1)),fj.indexOf(S)>=0){h=!0;break}}}M=G&&ir()(p,o)&&ir()(r,N)&&h&&(!V||V>g),M&&T.indexOf(hj.length)>=0&&(Gc[hj.length]=hj),M&&T.indexOf(hj.length+1)>=0&&(Gc[hj.length+1]=hj),M&&T.indexOf(hj.length+3)>=0&&(Gc[hj.length+3]=hj),M&&T.indexOf(Ee.length)>=0&&(Gc[Ee.length]=Ee)}M||(Ag.prototype._42=jl)}else M=!0,Gc[hj.length]=Gc[hj.length+1]=Gc[hj.length+3]=Gc[Ee.length]=hj;return Pi.a=M,M},qh=String.fromCharCode(qh+20);var Tq=function(H){return H=H.replace(gl,Hg),H=H.replace(/[ \n]+/g,Hg)},Md="30",ll="06",pp="02",kh="03",en=Ai,eg=/^1f+00/,Cg=function(){var t;return t={_18O:function(S){var x=S,E=x.replace(/\s+/g,""),u=cf(E);return u},_14O:function(d){var y=this._18O(d),X=this._15O(y);return X},_15O:function(B){var y=this._17O(B);if("2a864886f70d010101"==y._61O){var g=this._16O(y.key),f=new $l;return f._38O(g.n,g.e),f}Sg(Hg)},_16O:function(o){var q={};o.substr(0,2)!=Md&&Sg(Hg);var H=qn._7O(o,0);return 2!=H.length&&Sg(Hg),o.substr(H[0],2)!=pp&&Sg(Hg),q.n=qn._11O(o,H[0]),o.substr(H[1],2)!=pp&&Sg(Hg),q.e=qn._11O(o,H[1]),q},_17O:function(t){var P={};P._40O=S;var s=qn._7O(t,0);2!=s.length&&Sg(Hg);var W=s[0];t.substr(W,2)!=Md&&Sg(Hg);var q=qn._7O(t,W);return 2!=q.length&&Sg(Hg),t.substr(q[0],2)!=ll&&Sg(Hg),P._61O=qn._11O(t,q[0]),t.substr(q[1],2)==ll?P._40O=qn._11O(t,q[1]):t.substr(q[1],2)==Md&&(P._40O={},P._40O.p=qn._70O(t,q[1],[0],pp),P._40O.q=qn._70O(t,q[1],[1],pp),P._40O.g=qn._70O(t,q[1],[2],pp)),t.substr(s[1],2)!=kh&&Sg(Hg),P.key=qn._11O(t,s[1]).substr(2),P}},t._17O?t:S}(),Rb=Cg._27O=function(r){return Cg._14O(r)};ir=function(){return function(X,V){if(X&&V){V=Tq(V);var G=en(V,t(2,4)),k=this;if(!k||!k.n||G._55O()>k.n._55O())return 0;var c=k._37O(G),Q=c[fs](t(2,4)).replace(eg,""),u=Yc(Q);if(0==u.length)return!1;var _=u[0],K=u[1],q=function(t){return El._4O.Util._56O(t,_)},n=q(X);return K==n}}.bind(Rb(u))};var Bl,Lr;return function(){var V=Bh.length-Yb.length;if(V>0)for(var T=0;V>T;T++)Bl=Ad.Util,Lr=Tq}(),Pj=function(Y,O){O=Lr(O);var W=Rb(yq),p=Kl.length,o=2*p,Q=en(O,t(p,o)),C=W,X=!0;if(C){var R=C[Uh[0]];R&&Q._55O()<=R._55O()&&(X=!1)}if(X)return 0;var $=C._37O(Q),G=$[fs](t(p,o)).replace(eg,""),u=Yc(G);if(0==u.length)return!1;var V=u[0],P=u[1],z=Bl._11A(Y,V);return P==z},Cg}(e,o),kk(H,{load:function(){var R={},f=function(l){return l?"c_"+(l.sync?"1":"0")+"_"+(l.post?"1":"0")+"_"+(l.responseType||"H")+"_"+(l.mimeType||"H")+"_"+(l.data?JSON.stringify(l.data):"H"):""};return function(j,F,q){var e,T=R[j],E=f(q);return T&&(e=T[E])?(e.push(F),void 0):(R[j]||(T=R[j]={count:0}),e=T[E]=[F],T.count++,H.xhrLoad(j,function(f){delete T[E],T.count--,T.count||delete R[j],e.forEach(function(J){J(f)})},q),void 0)}}(),asyncEach:function(C,a,l){"function"!=typeof l&&(l=Function.prototype);var m=new Array(C.length),H=0,J=!1;C.forEach(function(u,q){a(u,function(Y,L){return J?void 0:Y?(J=!0,l(null)):(m[q]=L,H++,H===C.length?l(m):void 0)})})},xhrLoad:function(K,A,a){var W=!1;Td(K)||(W=!0,K=[K]),a=a||{};var $=a.sync,c=null,E=a.method||"GET";return a.post&&(E="POST"),a.method=E,H.asyncEach(K,function(D,M){var F=new xc;D=H.beforeLoadURL(D),D.data?M(null,D.data):(a.url=encodeURI(D),a.responseType?F.setResponseType(a.responseType):F.setOverrideMimeType(a.mimeType||"text/plain"),F.onload=function(){200===this.status||0===this.status?M(null,F.getResponseText()):M(!0)},F.onerror=function(){M(!0)},F.send(a))},function(l){var X="function"==typeof A;(X||$)&&(c=W&&l?l[0]:l,X&&A(c))}),$?c:void 0}});var Yc=o.setPrototypeOf||function(m,s){return m.__proto__=s,m},Tq=o.getPrototypeOf||function($){return $.__proto__},cj=o.freeze;o.isFrozen;var In=function(){var O=function(W){return W};return function(J){return J&&J.length?new Function("o",["return o['",J.join("']['"),"'];"].join("")):O}}(),Vl=function(){var b=function(N,r){return N=r};return function(f){return f&&f.length?new Function("o","v",["return o['",f.join("']['"),"'] = v;"].join("")):b}}();!function(){function V(o){var h=[];if(o)for(var m;(m=g.exec(o))!=W;)h.push(m[1]);return h}function Z(H,S){var y=L.exec(S);this._cell=H,this._key=y[1],this._format=y[2],this._style=V(y[3])}function m(v){for(var f=this._cellList=[],h=this._paramList=[],S=v.split(z),G=0,o=S.length;o>G;++G){var i=S[G];if("{{"!==i)for(var X=i.split(x),M=0,q=X.length;q>M;++M){var Q=X[M];x.test(Q)?(h.push(new Z(f.length,Q)),f.push(W)):Q.length>0&&f.push(Q)}else f.push("{")}this._formatList=this._cellList.slice(0)}var l={},K={},z=/(\{\{)/,x=/(\{\w+(?:\:\w+(?:\&[\w\.])*)?\})/,L=/\{(\w+)(?:\:(\w+)((?:\&[\w\.])*))?\}/,g=/\&([\w\.]*)/g;m.prototype._73O=function(V){for(var S=this._paramList.length;S--;){var M=this._paramList[S],A=V[fl(M._key)+1],O=K[M._format];O&&(A=O(A,M._style)),this._formatList[M._cell]=A}return this._formatList.join("")},m.prototype._map=function(X){for(var $=this._paramList.length;$--;){var H=this._paramList[$],I=X[H._key],j=K[H._format];j&&(I=j(I,H._style)),this._formatList[H._cell]=I}return this._formatList.join("")};var O=function(s){var T=l[s];return T||(l[s]=T=new m(s)),T._73O(arguments)};return O.map=function(P,N){var U=l[P];return U||(l[P]=U=new m(P)),U._map(N)},O.setValueFormat=function(p,B){K[p]=B},O.gc=function(){l.length=0},O.__parsed=l,O}();var Xb=function(){function u(D,F,J,A){var j=D?D.path.slice(0):[];F&&j.push(F),this.desc=J,this.name=F,this.path=cj(j),this.getter=In(j),this.setter=Vl(j),this.isLeaf=A,this.parent=D,this.children=[],this.childMap={}}return u.create=function(){function L(v,a,B,E){var m=E(B),q=new u(v,a,B,m);if(!m){for(var O=q.children,R=q.childMap,Y=o.keys(B),W=0,X=Y.length;X>W;++W){var d=Y[W],n=L(q,d,B[d],E);O.push(n),R[n.name]=n}q.children=cj(O),q.childMap=cj(R)}return cj(q),q}return function(w,d){return L(W,W,w,d)}}(),u.prototype.forEach=function(d,$){for(var k=this.children,S=0,a=k.length;a>S;++S){var J=k[S];d(J,$)}},u}(),cj=o.freeze,ej={main:{mask:1,priority:H.cameraPriority.main,clearDepth:!1,ignore:!1},top:{mask:2,priority:H.cameraPriority.top,ignore:!1}},Dc="main",mn=ej[Dc].mask,rl=function(V,N){V=V||0;var T;if(N in ej)T=ej[N].mask;else{if(!(32>Dq))throw new Error("Only 31 render layer can be defined.");ej[N]={mask:1<<Dq++,priority:ej[Dc].priority},T=ej[N].mask,hn=wd(o.keys(ej)),Dq=hn.length}return V|=T},If=function(E){var W=0;if("string"==typeof E)W=rl(W,E);else for(var H=0,D=E.length;D>H;++H)W=rl(W,E[H]);return W},Lr=function(W,D){return W&&D&&W&D},wd=function(J){return J.sort(function(v,H){return ej[v].priority-ej[H].priority})},hn=wd(o.keys(ej)),Dq=hn.length;kk(H,{setRenderLayerInfo:function(x,C){if(rl(0,x),C){for(var I in C)ej[x][I]=C[I];C.priority&&(hn=wd(o.keys(ej)))}},getRenderLayerInfo:function(N){return ej[N]}},!0);var Xd=n.List=function(){this._as=[];var q,n,i=arguments.length;if(1===i){var k=arguments[0];if(No(k)&&(k=k._as),Td(k))for(n=k.length,q=0;n>q;q++)this._as.push(k[q]);else k!=S&&this._as.push(k)}else if(i>1)for(q=0;i>q;q++)this._as.push(arguments[q])};jj("List",o,{forEach:function(_,Q){this.each(_,Q)},push:function(){for(var Q=0;Q<arguments.length;Q++)this.add(arguments[Q])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(q,y){return y===W?this._as.push(q):this._as.splice(y,0,q)},addAll:function(f){No(f)&&(f=f._as),Td(f)?Qb(this._as,f):this._as.push(f)},get:function(z){return this._as[z]},slice:function(o,H){return new Xd(this._as.slice(o,H))},remove:function(x){var D=this._as.indexOf(x);return D>=0&&D<this._as.length&&this.removeAt(D),D},removeAt:function(A){return this._as.splice(A,1)[0]},set:function(z,D){return this._as[z]=D},clear:function(){return this._as.splice(0,this._as.length)},contains:function(h){return this._as.indexOf(h)>=0},indexOf:function(o){return this._as.indexOf(o)},each:function(J,Q){for(var X=0,j=this._as.length;j>X;X++){var r=this._as[X];Q?J.call(Q,r,X,this):J(r,X,this)}},reverseEach:function(_,l){for(var $=this._as.length-1;$>=0;$--){var L=this._as[$];l?_.call(l,L):_(L)}},getArray:function(){return this._as},toArray:function(t,Q){if(t){for(var p,C=[],S=0,W=this._as.length;W>S;S++)p=this._as[S],Q?t.call(Q,p)&&C.push(p):t(p)&&C.push(p);return C}return this._as.concat()},toList:function(Y,c){if(Y){for(var q,P=new Xd,h=0,H=this._as.length;H>h;h++)q=this._as[h],c?Y.call(c,q)&&P.add(q):Y(q)&&P.add(q);return P}return new Xd(this)},reverse:function(){this._as.reverse()},sort:function(X){return this._as.sort(X?X:ck),this},toString:function(){return this._as.toString()}}),o.defineProperties(Xd.prototype,{length:{get:function(){return this._as.length},set:function(U){this._as.length=U}}});var Ve=new Xd;kk(Ve,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:wi,each:wi,reverseEach:wi,toArray:function(){return[]},toList:function(){return new Xd},add:vg,addAll:vg,set:vg,remove:vg,removeAt:vg,clear:vg});var Kd=n.Notifier=function(){this._f=0};jj("Notifier",o,{contains:function(R,U){if(this._ls)for(var y,W=0,A=this._ls.size();A>W;W++)if(y=this._ls.get(W),R===y.l&&U===y.s)return!0;return!1},add:function(X,o,n){var E=this,J={l:X,s:o,a:n};E._ls||(E._ls=new Xd),E._f?(E._as||(E._as=new Xd),E._as.add(J)):J.a?E._ls.add(J,0):E._ls.add(J)},remove:function(t,S){var j=this;j._ls&&(j._f?(j._rs||(j._rs=new Xd),j._rs.add({l:t,s:S})):j._remove(t,S))},_remove:function(s,B){for(var Y,H=this._ls,b=0,R=H.size();R>b;b++)if(Y=H.get(b),Y.l===s&&Y.s===B)return H.removeAt(b),void 0},fire:function(D){var e=this,J=e._ls;if(e._b=1e4,J){++e._f;try{for(var Q,C=0,A=J.size();A>C;C++)Q=J.get(C),Q.s?Q.l.call(Q.s,D):Q.l(D)}catch(D){Yk(function(){throw D})}finally{if(--e._f)return;if(e._rs){for(A=e._rs.size(),C=0;A>C;C++)Q=e._rs.get(C),e._remove(Q.l,Q.s);delete e._rs}if(e._as){for(A=e._as.size(),C=0;A>C;C++)Q=e._as.get(C),Q.a?J.add(Q,0):J.add(Q);delete e._as}}}}});var gi=n.Data=function(){this._id=_j()};jj("Data",o,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:S,_parent:S,_children:Ve,_childMap:S,_styleMap:S,_layer:"0",_renderLayer:Dc,_renderLayerMask:mn,_adjustChildrenToTop:!1,getRenderLayerMask:function(){return this._renderLayerMask||mn},getRenderLayer:function(){return this._renderLayer||Dc},setRenderLayer:function(s){var E=this,g=rl(0,s);E._renderLayerMask=g;var V=E._renderLayer;E._renderLayer=s,E.fp("renderLayer",V,E._renderLayer)},testRenderLayer:function(h){var G=ej[h];return G&&Lr(this._renderLayerMask,ej[h].mask)},getUIClass:function(){return S},_22Q:function(){return S},beginTransaction:function(){this._dataModel&&this._dataModel.beginTransaction()},endTransaction:function(){this._dataModel&&this._dataModel.endTransaction()},s:function(M,V){var l=this;if(2===arguments.length)l.setStyle(M,V);else{if(!Il(M))return l.getStyle(M);for(var d in M)l.setStyle(d,M[d])}return l},fp:function(L,J,o,$,V){return this.firePropertyChange(L,J,o,$,V)},firePropertyChange:function(E,Z,X,_,R){if(_){if(_(Z,X))return!1
}else if(Z===X)return!1;var n=this,b=R||{};return b.property=E,b.oldValue=Z,b.newValue=X,b.data=n,n._dataModel&&n._dataModel.handleDataPropertyChange(b),n.onPropertyChanged(b),!0},onPropertyChanged:function($){var m=this,H=m._parent,E=$.property;if(tl(H)){var _=m.s(Xc),B="s:ingroup"===E;(_&&ph[E]||E===B)&&H._81I(),(_||B)&&H.fp("childChange",!0,!1)}rj(H)&&(ph[E]||"elevation"===E||dn[E]||"scaleTall"===E||"tall"===E)&&H.updateFromChildren(),("s:alwaysOnTop"===E||"s:shape3d.alwaysOnTop"===E)&&($.newValue?this.setRenderLayer("top"):this.setRenderLayer(W))},_21I:function(Z){var E=this;if(Z&&E._dataModel)throw"Remove data from dataModel before adding";E._dataModel=Z},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var w=0,O=this._children.toArray(),U=O.length;U>w;w++)O[w].removeFromDataModel()},getId:function(){return this._id},setId:function(J){this._id=J},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(R,e){return this._children.toList(R,e)},eachChild:function(L,B){this._children.each(L,B)},addChild:function(k,U){var r=this;k!==r&&(r._children===Ve&&(r._children=new Xd,r._childMap={}),U>=0||(U=r._children.size()),r._childMap[k._id]||r.isDescendantOf(k)||(k._parent&&k._parent.removeChild(k),(0>U||U>r._children.size())&&(U=r._children.size()),r._children.add(k,U),r._childMap[k._id]=k,k.setParent(r),r.onChildAdded(k,U),r.fp(Ue,S,k)))},onChildAdded:function(){},removeChild:function(i){var D=this;if(D._childMap&&D._childMap[i._id]){var R=D._children.remove(i);delete D._childMap[i._id],D.fp(Ue,i,S),i.setParent(S,R),D.onChildRemoved(i,R)}},onChildRemoved:function(){},getChildAt:function(h){return this._children.get(h)},clearChildren:function(){var K=this;if(!K._children.isEmpty())for(var q=0,l=K._children.toArray(),V=l.length;V>q;q++)K.removeChild(l[q])},getParent:function(){return this._parent},setParent:function(b,O){var L=this;if(!(L._73I||L._parent===b||L===b||b&&b.isDescendantOf(L))){var D,I=L._parent;L._parent=b,L._73I=1,I?(O==S&&(O=I.getChildren().indexOf(L)),I.removeChild(L)):L._dataModel&&O==S&&(O=L._dataModel.getRoots().indexOf(L)),b&&(b.addChild(L),D=b.getChildren().indexOf(L)),delete L._73I,L.fp("parent",I,b,W,{oldIndex:O,newIndex:D}),L.onParentChanged(I,b)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(N){return N?this.isDescendantOf(N)||N.isDescendantOf(this):!1},isParentOf:function(G){return G&&this._childMap?!!this._childMap[G._id]:!1},isDescendantOf:function(s){if(!s||s.isEmpty())return!1;for(var S=this._parent;S;){if(s===S)return!0;S=S._parent}return!1},getStyle:function(I,h){h===W&&(h=1);var V=this._styleMap?this._styleMap[I]:W;return V===W&&h?D[I]:V},setStyle:function(M,R){var $=this;$._styleMap||($._styleMap={});var i=$._styleMap[M];R===W?delete $._styleMap[M]:$._styleMap[M]=R,$.fp("s:"+M,i,R)&&$.onStyleChanged(M,i,R)},onStyleChanged:function(){},iv:function(D){this.invalidate(D)},invalidate:function(B){this.fp(B||"*",!1,!0)},toString:function(){var J=this;return J._displayName||J._name||J._tag||J._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(g,f){var Y=this,J=Y.s(bp);Y.beginTransaction(),J||Y.s(bp,J={}),f?J[g]=f:delete J[g],Y.fp(bp,S,J),Y.endTransaction()},removeStyleIcon:function(B){var C=this.s(bp);if(C){var j=C[B];delete C[B],this.fp(bp,S,C)}return j},_calcAnchorMatrix3d:function(){},appendAnchorMatrix3d:function(D){var S=this;if(S.hasOwnProperty("_anchor")||S.hasOwnProperty("_anchorElevation")){var I=S.getAnchor3d(),G={x:I.x-.5,y:I.y-.5,z:I.z-.5};Je(D,[-G.x,-G.y,-G.z])}},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,renderLayer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var o,H={};for(o in this._styleMap)H[o]=1;return H},getCurrentPrefix:function(){return this._interactPrefix||Xl},ca:function(m,l){var e=this.getCurrentPrefix();return m=e+m,2===arguments.length?this.a(m,l):this.a(m)}});var es=n.DataModel=function(){var b=this;b._isDeserializing=0,b._datas=new Xd,b._dataMap={},b._roots=new Xd,b._rootMap={},b._fsDataMap={},b._78O={},b._reflectorMap={},b._36I=new Kd,b._35I=new Kd,b._serializeNotifier=new Kd,b._selectionModel=new cb(b);var d=b._29Q=[],E=b._scheduleCallback=function(){for(var J=Date.now(),M=0;M<d.length;M++){var x=d[M];x.enabled&&J-x.lastTime>x.interval&&(x.beforeAction&&x.beforeAction(),x.action&&b.each(function(Y){x.action(Y)}),x.afterAction&&x.afterAction(),x.lastTime=J)}d.length&&(b._30Q=e.requestAnimationFrame(E))}};jj("DataModel",o,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmapType","envmap","postProcessingData","init"],_name:W,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:W,_init:W,_envmap:W,_envmapType:W,_postProcessingData:W,sm:function(){return this.getSelectionModel()},mm:function(p,s,A){this.addDataModelChangeListener(p,s,A)},umm:function(S,y){this.removeDataModelChangeListener(S,y)},md:function(M,d,G){this.addDataPropertyChangeListener(M,d,G)},umd:function(k,R){this.removeDataPropertyChangeListener(k,R)},mh:function(n,p,v){this.addHierarchyChangeListener(n,p,v)},umh:function(T,x){this.removeHierarchyChangeListener(T,x)},getAttrObject:function(){return this._attrObject},setAttrObject:function(F){return this._attrObject=F},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getReflectors:function(){return this._reflectorMap},getDataById:function(V){return this._dataMap[V]},removeDataById:function(j){this.remove(this.getDataById(j))},toDatas:function(W,b){return this._datas.toList(W,b)},each:function(Z,g){this._datas.each(Z,g)},getDataByTag:function(R){return this._78O[R]},getTagMap:function(){return this._78O},removeDataByTag:function(p){this.remove(this.getDataByTag(p))},add:function(x,s,K){var w=this,e=x._id,T=x._tag,O=w._roots;if(w._dataMap[e])throw"'"+e+"' already exists";T!=S&&(w._78O[T]=x),w._dataMap[e]=x,K>=0?w._datas.add(x,K):w._datas.add(x),x._parent||(w._rootMap[e]=x,s>=0?O.add(x,s):O.add(x)),x.s("fullscreen")!==W&&(w._fsDataMap[e]=x),x.s("shape3d.reflector")&&(w._reflectorMap[e]=x),x._21I(w),w.onAdded(x),w._36I.fire({kind:"add",data:x,rootsIndex:s,datasIndex:K})},onAdded:function(){},remove:function(a,P){if(a){var j=this,e=a._id,n=P&&P.keepStructure,z=P&&P.keepChildren,y=a.getTag();if(a._dataModel===j){var V=a instanceof $n;V&&H.setIsolating(!0),this.beginTransaction(),n?j._removingData||(j._removingData=a):j.prepareRemove(a),z||a.toChildren().each(function(e){j.remove(e,P)},j),n?j._removingData===a&&(a._parent&&a._parent.removeChild(a),delete j._removingData):a._parent&&a._parent.removeChild(a);var f=j._datas.remove(a);delete j._dataMap[e],y!=S&&delete j._78O[y];var T;j._rootMap[e]&&(delete j._rootMap[e],T=j._roots.remove(a)),j._fsDataMap[e]&&delete j._fsDataMap[e],j._reflectorMap[e]&&delete j._reflectorMap[e],a._21I(S),j.onRemoved(a),j._36I.fire({kind:Wh,data:a,rootsIndex:T,datasIndex:f}),this.endTransaction(),V&&H.setIsolating(!1)}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var l=this;if(l._datas.size()){var k=l._historyManager?this.toJSON():W;l._datas.toArray().forEach(function(X){X._21I(S)}),l._datas.clear(),l._dataMap={},l._roots.clear(),l._rootMap={},l._fsDataMap={},l._reflectorMap={},l._78O={},l._36I.fire({kind:rs,json:k})}},contains:function(i){return i&&i._dataModel===this},handleDataPropertyChange:function(r){var E=this,j=r.data,G=r.property;if("parent"===G){var n=j._id,m=E._rootMap,i=E._roots;j._parent?m[n]&&(delete m[n],i.remove(j)):m[n]||(m[n]=j,i.add(j))}else if("tag"===G){var J=r.oldValue,I=r.newValue,N=E._78O;J!=S&&delete N[J],I!=S&&(N[I]=j)}else if("s:fullscreen"===G){var n=j._id,l=E._fsDataMap;r.oldValue!=S&&delete l[n],r.newValue!=S&&(l[n]=j)}else if("s:shape3d.reflector"===G){var n=j._id,o=E._reflectorMap;r.oldValue&&delete o[n],r.newValue&&(o[n]=j)}this.onDataPropertyChanged(j,r),this._35I.fire(r)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(O,T,i){this._36I.add(O,T,i)},removeDataModelChangeListener:function(B,c){this._36I.remove(B,c)},addSerializeListener:function(o,D,b){this._serializeNotifier.add(o,D,b)},removeSerializeListener:function(d,z){this._serializeNotifier.remove(d,z)},fireSerializeEvent:function(s){this._serializeNotifier.fire(s)},addDataPropertyChangeListener:function(X,V,H){this._35I.add(X,V,H)},removeDataPropertyChangeListener:function(f,b){this._35I.remove(f,b)},_38I:function(k,x,R){this._37I&&this._37I.fire({data:k,oldIndex:x,newIndex:R})},addHierarchyChangeListener:function(V,v,R){this._37I||(this._37I=new Kd),this._37I.add(V,v,R)},removeHierarchyChangeListener:function(B,t){this._37I.remove(B,t)},getSiblings:function(L){var J=L._parent;return J?J._children:this._roots},eachByHierarchical:function(l,H,u){if(H)return this._eachByHierarchical(l,H,u);for(var B=0,Z=this._roots,c=Z.size();c>B;B++)if(this._eachByHierarchical(l,Z.get(B),u)===!1)return!1;return!0},_eachByHierarchical:function(b,e,Y){if(Y){if(b.call(Y,e)===!1)return!1}else if(b(e)===!1)return!1;for(var r=e.size(),G=0;r>G;G++)if(this._eachByHierarchical(b,e.getChildAt(G),Y)===!1)return!1;return!0},reverseEachByHierarchical:function($,B,q){if(B)return this._reverseEachByHierarchical($,B,q);for(var r=this._roots,F=r.size(),f=F-1;f>=0;f--)if(this._reverseEachByHierarchical($,r.get(f),q)===!1)return!1;return!0},_reverseEachByHierarchical:function(h,B,r){for(var M=B.size(),y=M-1;y>=0;y--)if(this._reverseEachByHierarchical(h,B.getChildAt(y),r)===!1)return!1;if(r){if(h.call(r,B)===!1)return!1}else if(h(B)===!1)return!1;return!0},eachByDepthFirst:function(f,J,m){if(J)return this._11I(f,J,m);for(var U=0,b=this._roots,d=b.size();d>U;U++)if(this._11I(f,b.get(U),m)===!1)return!1;return!0},_11I:function(o,$,c){for(var U=$.size(),R=0;U>R;R++)if(this._11I(o,$.getChildAt(R),c)===!1)return!1;if(c){if(o.call(c,$)===!1)return!1}else if(o($)===!1)return!1;return!0},eachByBreadthFirst:function(B,O,f){var L=new Xd;for(O?L.add(O):this._roots.each(L.add,L);L.size()>0;)if(O=L.removeAt(0),O.eachChild(L.add,L),f){if(B.call(f,O)===!1)return!1}else if(B(O)===!1)return!1;return!0},moveTo:function(G,B){var E=this.getSiblings(G),v=E.indexOf(G);v===B||0>v||B>=0&&B<=E.size()&&(E.remove(G),B>E.size()&&B--,E.add(G,B),this._38I(G,v,B))},moveUp:function(u){this.moveTo(u,this.getSiblings(u).indexOf(u)-1)},moveDown:function(a){this.moveTo(a,this.getSiblings(a).indexOf(a)+1)},moveToTop:function(i){this.moveTo(i,0)},moveToBottom:function(c){this.moveTo(c,this.getSiblings(c).size())},moveSelectionUp:function(y){this.beginTransaction(),y||(y=this.sm());var A=new Xd;Bm(y,A,this._roots),A.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(T){this.beginTransaction(),T||(T=this.sm());var E=new Xd;ei(T,E,this._roots),E.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(d){this.beginTransaction(),d||(d=this.sm());var s=new Xd;pd(d,s,this._roots),s.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(m){this.beginTransaction(),m||(m=this.sm());var Z=new Xd;cc(m,Z,this._roots),Z.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(F,t,S){var d=this.getDatas();null==S&&(S=d.indexOf(F)),S===t||0>S||t>=0&&t<=d.size()&&(d.remove(F),t>d.size()&&t--,d.add(F,t),this._76I(F,S,t))},bringForward:function(J){this.moveToIndex(J,this.getDatas().indexOf(J)+1)},bringToFront:function(H){this.moveToIndex(H,this.size())},sendBackward:function(j){this.moveToIndex(j,this.getDatas().indexOf(j)-1)},sendToBack:function(X){this.moveToIndex(X,0)},bringSelectionForward:function(E){this.beginTransaction(),E||(E=this.sm());for(var f=new Xd,H=this.getDatas(),M=!1,i=0;i<H.size();i++){var F=H.get(H.size()-1-i);E.contains(F)?M&&f.add(F):M=!0}f.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(M){this.beginTransaction(),M||(M=this.sm());for(var $=new Xd,E=this.getDatas(),f=0;f<E.size();f++){var w=E.get(f);M.contains(w)&&$.add(w)}$.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(k){this.beginTransaction(),k||(k=this.sm());for(var J=new Xd,s=this.getDatas(),M=!1,Y=0;Y<s.size();Y++){var W=s.get(Y);k.contains(W)?M&&J.add(W):M=!0}J.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(C){this.beginTransaction(),C||(C=this.sm());for(var s=new Xd,E=this.getDatas(),B=0;B<E.size();B++){var e=E.get(E.size()-1-B);C.contains(e)&&s.add(e)}s.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(Z){var J=this;J.removeScheduleTask(Z),Z.enabled==S&&(Z.enabled=!0),Z.interval==S&&(Z.interval=10),Z.lastTime=Date.now(),J._29Q.push(Z),J._30Q==S&&(J._30Q=e.requestAnimationFrame(J._scheduleCallback))},removeScheduleTask:function(P){var j=this,C=j._29Q,U=C.indexOf(P);U>=0&&C.splice(U,1),C.length||j._30Q==S||(e.cancelAnimationFrame(j._30Q),delete j._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(K){this._historyManager||new n.HistoryManager(this),null!=K&&this._historyManager.setMaxHistoryCount(K),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(w){this._historyManager&&this._historyManager.undo(w)},redo:function(V){this._historyManager&&this._historyManager.redo(V)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(x){this._historyManager&&this._historyManager.addHistory(x)},onHistoryManagerChanged:function(){},isDeserializing:function(){return this._isDeserializing>0},setDeserializing:function(p){p?this._isDeserializing++:this._isDeserializing--},updateLayoutAttach:function(N){this.each(function(U){U instanceof ci&&U.getImage()===N&&U.updateLayoutAttaches()})},isCubicEnvmap:function(){return!1},setCubicEnvmap:function(){},setEnvmap:function(g){var n=this._envmap;this._envmap=g,"object"==typeof n&&"object"==typeof g&&(n=null),this.fp("envmap",n,g)}});var cb=n.SelectionModel=function(p){var X=this;X._68O=Rm,X._map={},X._73O=new Xd,X._74I=new Kd,X._21I(p)};jj("SelectionModel",o,{ms_fire:1,ms_dm:1,ms:function(o,w,C){this.addSelectionChangeListener(o,w,C)},ums:function(N,S){this.removeSelectionChangeListener(N,S)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===lg},co:function(a){return this._map[a._id]!=S},ss:function(r){this.setSelection(r)},as:function(Y){this.appendSelection(Y)},rs:function(v){this.removeSelection(v)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(b){var y=this;if(y._68O!==b&&(b===Uh||b===lg||b===Rm)){y.cs();var c=y._68O;y._68O=b,y.fp("selectionMode",c,b)}},_21I:function(B){var t=this,N=t._dataModel;N!==B&&(N&&(t.cs(),N.umm(t.handleDataModelChange,t)),t._dataModel=B,B.mm(t.handleDataModelChange,t,!0),t.fp(hb,N,B))},dispose:function(){var F=this;F.cs(),F._dataModel.umm(F.handleDataModelChange,F)},handleDataModelChange:function(S){var i=this;if(S.kind===Wh){var Y=S.data;i.co(Y)&&(i._73O.remove(Y),delete i._map[Y._id],i._75I(Wh,new Xd(Y)))}else S.kind===rs&&i.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(z){var K=this;if(K._filterFunc!==z){K.cs();var n=K._filterFunc;K._filterFunc=z,K.fp("filterFunc",n,K._filterFunc)}},_75I:function(H,G,d,_){d&&(this._73O.each(function(S){_[S._id]?d.remove(S):d.add(S)}),G=d.toList()),this._74I.fire({kind:H,datas:new Xd(G)})},addSelectionChangeListener:function(k,_,u){this._74I.add(k,_,u)},removeSelectionChangeListener:function(m,N){this._74I.remove(m,N)},_97O:function(L,l){for(var Q,g=this,c=0,A=new Xd(L);c<A.size();c++)Q=A.get(c),(g._filterFunc&&!g._filterFunc(Q)||l&&g.co(Q)||!l&&!g.co(Q)||!g._dataModel.contains(Q))&&(A.removeAt(c),c--);return A},appendSelection:function(t){var a=this;if(a._68O!==Uh){var R,F,L=a._73O,v=a._97O(t,!0);v.isEmpty()||(a.sg()&&(R=new Xd(L),F=a._map,L.clear(),a._map={},v=new Xd(v.get(v.size()-1))),v.each(function(v){L.add(v),a._map[v._id]=v}),a._75I("append",v,R,F))}},removeSelection:function(S){var A=this,w=A._97O(S),U=0,z=w.size();if(0!==z){for(;z>U;U++){var K=w.get(U);A._73O.remove(K),delete A._map[K._id]}A._75I(Wh,w)}},toSelection:function(k,X){return this._73O.toList(k,X)},getSelection:function(){return this._73O},each:function(E,w){this._73O.each(E,w)},setSelection:function(l){var $=this,Q=$._73O;if($._68O!==Uh&&!(Q.isEmpty()&&!l||1===Q.size()&&$.ld()===l)){var O=new Xd(Q),W=$._map;Q.clear(),$._map={};var H=$._97O(l,!0);$.sg()&&H.size()>1&&(H=new Xd(H.get(H.size()-1))),H.each(function(P){Q.add(P),$._map[P._id]=P}),$._75I("set",S,O,W)}},clearSelection:function(){var F=this,w=F._73O;if(w.size()>0){var V=w.toList();w.clear(),F._map={},F._75I(rs,V)}},selectAll:function(){var g=this;if(g._68O!==Uh){var i,o,O=g._dataModel.toDatas();if(g._filterFunc)for(i=0;i<O.size();i++)o=O.get(i),g._filterFunc(o)||(O.removeAt(i),i--);var h=g._73O,I=new Xd(h),C=g._map;h.clear(),g._map={},g.sg()&&O.size()>1&&(O=new Xd(O.get(O.size()-1)));var B=O.size();for(i=0;B>i;i++)o=O.get(i),h.add(o),g._map[o._id]=o;g._75I("all",S,I,C)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(U){return this._map[U._id]!=S},getLastData:function(){var C=this._73O;return C.size()>0?C.get(C.size()-1):S},getFirstData:function(){var f=this._73O;return f.size()>0?f.get(0):S},isSelectable:function(g){var R=this;return g&&R._68O!==Uh?R._filterFunc?R._filterFunc(g):!0:!1},getTopSelection:function(){var f=this,k=new Xd;return f._73O.each(function(E){for(var v=E.getParent();v;){if(f.contains(v)){E=S;break}v=v.parent}E&&k.add(E)}),k}});var $q=function(){return ce(0),function(d,c){var F;if(fm(c)){var O=d.getDataUI(c);O&&O._88I&&(F=O._88I.rect)}return F?F:c.getRect()}}();kk(H,{edgeGroupAgentFunc:S,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:h.rectSelectBorder,graphViewRectSelectBackground:ig,graphViewEditPointSize:bc?17:7,graphViewEditPointBorderColor:h.editPointBorder,graphViewEditPointBackground:h.editPointBackground,setEdgeType:function(t,e,l){oc[t]=e,rn[t]=l},getEdgeType:function(u){return oc[u]},getEdgeTypeMap:function(){return oc},getNodeRect:$q},!0);var jg={"layout.h":W,"layout.v":W,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":W,"2d.attachable":!1,"2d.hostable":!1,interactive:!1,preventDefaultWhenInteractive:!0,"image.stretch":"fill",icons:W,ingroup:!0,"body.color":W,"2d.gray":!1,fullscreen:W,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:W,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"vector.layoutable":!1,"clip.direction":"top","clip.percentage":W,"select.color":Sh,"select.width":1,"select.padding":2,"select.type":Fi,"shadow.interactable":!0,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,shadow2:!1,"shadow2.color":Sh,"shadow2.blur":6,"shadow2.offset.x":3,"shadow2.offset.y":3,"border.color":W,"border.width":2,"border.padding":2,"border.type":Fi,label:W,"label.font":W,"label.color":Ub,"label.background":W,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":W,"label.max":W,"label.opacity":W,"label.scale":1,"label.align":W,"label.selectable":!0,"label.decoration":W,label2:W,"label2.font":W,"label2.color":Ub,"label2.background":W,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":W,"label2.max":W,"label2.opacity":W,"label2.scale":1,"label2.align":W,"label2.selectable":!0,"label2.decoration":W,note:W,"note.expanded":!0,"note.font":W,"note.color":Rl,"note.background":Sh,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":W,"note.toggleable":!0,"note.border.width":1,"note.border.color":W,"note.opacity":W,"note.scale":1,"note.align":W,note2:W,"note2.expanded":!0,"note2.font":W,"note2.color":Rl,"note2.background":Sh,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":W,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":W,"note2.opacity":W,"note2.scale":1,"note2.align":W,"group.type":W,"group.image":W,"group.image.stretch":"fill","group.repeat.image":W,"group.border.repeat.image":W,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":W,"group.title.color":Rl,"group.title.background":h.groupTitleBackground,"group.title.align":Vn,"group.title.orientation":Dr,"group.background":h.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":W,"group.border.color":sr,"group.border.radius":W,"group.border.cap":np,"group.border.join":Ge,"group.border.width.absolute":!1,"group.splitLine":!1,"group.gradient":S,"group.gradient.color":"#FFF",shape:W,"shape.background":sr,"shape.repeat.image":W,"shape.border.repeat.image":W,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":sr,"shape.border.3d":!1,"shape.border.3d.color":W,"shape.border.3d.accuracy":W,"shape.border.cap":np,"shape.border.join":Ge,"shape.border.pattern":W,"shape.gradient":S,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":Vg,"shape.dash.offset":0,"shape.dash.color":tn,"shape.dash.width":W,"shape.dash.3d":!1,"shape.dash.3d.color":W,"shape.dash.3d.accuracy":W,"shape.polygon.side":6,"shape.arc.from":X,"shape.arc.to":z,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":W,"shape.gradient.pack":W,"shape.border.gradient.pack":W,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":W,"shape.foreground":W,"shape.foreground.gradient":S,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":W,"shape.regular":!0,"autolayout.gap":W,"autolayout.hgap":W,"autolayout.vgap":W,"edge.type":W,"edge.points":W,"edge.segments":W,"edge.color":sr,"edge.width":2,"edge.width.absolute":!1,"edge.repeat.image":null,"edge.offset":0,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":W,"edge.3d.accuracy":W,"edge.cap":np,"edge.join":Ge,"edge.source.position":17,"edge.source.anchor.x":W,"edge.source.anchor.y":W,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.source.index":-1,"edge.source.percent":0,"edge.target.position":17,"edge.target.anchor.x":W,"edge.target.anchor.y":W,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.target.index":-1,"edge.target.percent":0,"edge.pattern":W,"edge.dash":!1,"edge.dash.pattern":Vg,"edge.dash.offset":0,"edge.dash.color":tn,"edge.dash.width":W,"edge.dash.3d":!1,"edge.dash.3d.color":W,"edge.dash.3d.accuracy":W,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":W,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":W,"grid.column.percents":W,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":h.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":h.gridCellBorderColor,"grid.block":W,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":h.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":Ub,"text.gradient.pack":W,"text.font":Mr,"text.shadow":!1,"text.shadow.color":Sh,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1,"text.gradient":W,"text.gradient.color":"#FFF","text.decoration":W,"text.vertical":!1,"text.vertical.gap":1,"text.wrap":!1,"text.letter.gap":null,"text.border.color":Sh,"text.border.width":0,keepPosition:!0};jg[Io]=W,kk(D,jg,!0),kk(es,{_76I:function(F,A,R){this._39I&&this._39I.fire({data:F,oldIndex:A,newIndex:R})},addIndexChangeListener:function(m,M,g){var t=this;t._39I||(t._39I=new Kd),t._39I.add(m,M,g)},removeIndexChangeListener:function(h,Q){this._39I.remove(h,Q)},prepareRemove:function(r){zl(r)&&(r.setSource(S),r.setTarget(S)),r._70O&&r._70O.toList().each(this.remove,this),r._69O&&r._69O.toList().each(function(q){q.setHost(S)}),r._host&&r.setHost(S)},onAdded:function(k){this.isAutoAdjustIndex()&&this.adjustIndex(k)},onDataPropertyChanged:function(k,V){Ce[V.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(k)},isAdjustable:function(H){return af(H)||zl(H)},isAdjustedToBottom:function(U){return tl(U)?U.isExpanded()&&Um(U):!1},adjustIndex:function(f){var A=this;this.isHierarchicalRendering()||(A.isAdjustedToBottom(f)?(A.sendToBottom(f),f.eachChild(A.adjustIndex,A)):A.sendToTop(f))},sendToTop:function(l){var L=this;if(L.contains(l)&&L.isAdjustable(l)){var I=L._datas;if(l!==I.get(L.size()-1)){var v=I.indexOf(l);I.removeAt(v),I.add(l),L._76I(l,v,L.size()-1)}if(zl(l)){var i=l._40I;i&&!L.isAdjustedToBottom(i)&&L.sendToTop(i),i=l._41I,i&&!L.isAdjustedToBottom(i)&&L.sendToTop(i)}l._69O&&l._69O.each(function(M){M.isRelatedTo(l)||af(l)&&M.isLoopedHostOn(l)||L.sendToTop(M)}),l.ISubGraph||(!tl(l)||l.isExpanded())&&l._adjustChildrenToTop&&l.eachChild(function(X){zl(X)||L.sendToTop(X)})}},sendToBottom:function(a,K){var H=this;if(a!==K&&H.contains(a)&&H.isAdjustable(a)&&(!K||H.contains(K))){var M=H._datas,q=M.remove(a),D=K?H._datas.indexOf(K):0;if(M.add(a,D),q!==D){H._76I(a,q,D);var U=a._parent;!U||U.ISubGraph||zl(U)||H.sendToBottom(a._parent,a)}}}}),kk(Ep,{ms_edit:function(w){w._46O=function(s){var M=this,X=M.gv.dm(),j=M._index,_=M._89I,G=M._node,Y=M._shape,K=M._edge,E=M._77I;G&&_?(this.fi({kind:"endEditRect",event:s,data:G,direction:_}),X.endTransaction()):Y&&j>=0?(M.fi({kind:"endEditPoint",event:s,data:Y,index:j}),X.endTransaction()):K&&j>=0?(M.fi({kind:"endEditPoint",event:s,data:K,index:j}),X.endTransaction()):E&&(M.fi({kind:"endEditRotation",event:s,data:E}),X.endTransaction())},w._78I=function(k){var g=this;g.autoScroll(k);var N=g.gv.lp(k),M=g._index,O=g._89I,Y=g._node,r=g._shape,_=g._edge,y=g._77I;if(Y&&O)g._80O(N),g.fi({kind:"betweenEditRect",event:k,data:Y,direction:O});else if(r&&M>=0)N.e=r.getPoints().get(M).e,r.setPoint(M,N),g.fi({kind:"betweenEditPoint",event:k,data:r,index:M});else if(_&&M>=0){var P=_.s(Fd);N.e=P.get(M).e,P.set(M,N),_.fp(Fd,S,P),g.fi({kind:"betweenEditPoint",event:k,data:_,index:M})}else if(y){var f=y.p(),d=y.getScale(),c=Rr+db(N.y-f.y,N.x-f.x);d.y<0&&(c+=X),v(c)<.04&&(c=0),y.setRotation(c),g.fi({kind:"betweenEditRotation",event:k,data:y})}},w._80O=function(v){var a=this,T=a._node,X=a._rect,U=X.x,O=X.y,Z=X.width,J=X.height,Y=a._89I,q=a._anchor,P=a._matrix,v=P.tfi(v);"northwest"===Y?X=Wk(v,{x:U+Z,y:O+J}):Y===hj?X=Wk({x:U,y:v.y},{x:U+Z,y:O+J}):"northeast"===Y?X=Wk({x:U,y:v.y},{x:v.x,y:O+J}):Y===Dn?X=Wk({x:v.x,y:O},{x:U+Z,y:O+J}):Y===iq?X=Wk({x:U,y:O},{x:v.x,y:O+J}):"southwest"===Y?X=Wk({x:v.x,y:O},{x:U+Z,y:v.y}):"south"===Y?X=Wk({x:U,y:O},{x:U+Z,y:v.y}):"southeast"===Y&&(X=Wk({x:U,y:O},v)),T.setPosition(P.tf(X.x+X.width*q.x,X.y+X.height*q.y)),T.setWidth(X.width),T.setHeight(X.height)},w._80I=function(l,s,I,S){var M=this,n=M.gv._zoom,X=(M.gv.getEditPointSize()+2)/n;return Zk({x:s-X/2,y:I-X/2,width:X,height:X},l)?(M._89I!==S&&(M._89I=S),!0):!1},w._79I=function(k,r,A){var f=this,z=f.gv,G=r?z.getDataUI(r):S,P=G?G._55O:S;if(P){var b,V,i,u,Y=z._zoom,c=(z.getEditPointSize()+2)/Y,X=z.lp(k);if(af(r)){if(P._56O&&af(r)&&(V=P._98o,Zk({x:V.x-c/2,y:V.y-c/2,width:c,height:c},X)))return f._77I=r,A&&f.fi({kind:"beginEditRotation",event:k,data:r}),f.setCursor("crosshair"),!0;if(P._43O&&r instanceof Fb)for(i=r.getPoints(),b=i.size()-1;b>=0;b--)if(V=i.get(b),Zk({x:V.x-c/2,y:V.y-c/2,width:c,height:c},X))return f._index=b,f._shape=r,A&&f.fi({kind:"beginEditPoint",event:k,data:r,index:b}),f.setCursor("crosshair"),!0;if(P._42O)for(var F=r.getEditControlPoints(),C=["northwest",-1,-1,Dn,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,iq,1,0,"northeast",1,-1,hj,0,-1],b=0,u=F.length;u>b;b++){var Z=C[3*b],K=F[b];if(f._80I(X,K.x,K.y,Z)){f._node=r;var E=r.getWidth(),y=r.getHeight(),J=r.getAnchor();f._rect={x:-E*J.x,y:-y*J.y,width:E,height:y},f._anchor=J,f._matrix=r.getMatrix();var H=r.getRotation(),O=s(H),B=R(H),h=C[3*b+1]*uo(r.getScale().x),j=C[3*b+2]*uo(r.getScale().y),v=Math.atan2(-B*h-O*j,O*h-B*j),e=(Math.round(v/(Math.PI/4))+8)%8,W=[Yf,"nesw-resize",Gn,"nwse-resize",Yf,"nesw-resize",Gn,"nwse-resize"][e];return f.setCursor(W),A&&f.fi({kind:"beginEditRect",event:k,data:r,direction:f._89I}),!0}}}if(P._43O&&zl(r)&&r.s(bk)===We&&(i=r.s(Fd)))for(b=i.size()-1;b>=0;b--)if(V=i.get(b),Zk({x:V.x-c/2,y:V.y-c/2,width:c,height:c},X))return f._index=b,f._edge=r,A&&f.fi({kind:"beginEditPoint",event:k,data:r,index:b}),f.setCursor("crosshair"),!0}return!1}},ms_gv:function(J){J._currentSubGraph=S,J._initView=function(){this._fpsInfo={time:0,fps:0,frames:0}},J.upSubGraph=function(){this.setCurrentSubGraph(dm(this._currentSubGraph))},J.isVisible=function(b){var o=this;if(dm(b)!==o._currentSubGraph)return!1;if(zl(b)){var u=b._40I,r=b._41I;if(!u||!r)return!1;if(!(b.s("edge.independent")||o.isVisible(u)&&o.isVisible(r)))return!1;if(b.isEdgeGroupHidden())return!1}else for(var G=b._parent;G&&!G.ISubGraph;){if(tl(G)&&(!G.isExpanded()||!o.isVisible(G)))return!1;G=G._parent}if(b._parent instanceof $n&&!o.isVisible(b._parent))return!1;if(b._refGraph instanceof bs&&!o.isVisible(b._refGraph))return!1;if(o instanceof Es){if(!b.s("3d.visible"))return!1}else{var y=o.getLayersInfo();if(y){var q=y[b._layer];if(q&&q.visible===!1)return!1}if(!b.s("2d.visible"))return!1}return o._visibleFunc?o._visibleFunc(b):!0},J.handleSelectionChange=function(a){var $=this;a.datas.each(function(Y){$.invalidateData(Y);var j=Y._parent;tl(j)&&af(Y)&&Y.s(Xc)&&($.invalidateData(j),j._49I&&j._49I.each(function(T){$.invalidateData(T)}))}),$.onSelectionChanged(a)},J.onSelectionChanged=function(Z){var W=this,t=W.sm();if(1===t.size()&&("set"===Z.kind||"append"===Z.kind)){var m=t.ld();W.isAutoMakeVisible()&&W.makeVisible(m),W.adjustIndex&&W._dataModel.isAutoAdjustIndex()&&W.adjustIndex(m)}},J.makeVisible=function(z){if(z){var i=this,M=i.getDataUI?i.getDataUI(z):i.getData3dUI(z);if(M){var O=z,Q=dm(z);for(Q!==i._currentSubGraph&&i.setCurrentSubGraph(Q);(O=O._parent)&&O!==Q;)tl(O)&&O.setExpanded(!0);i._23I=z,i.iv()}}},J.getLabel=function(h){var k=h.getStyle(Jo);return k===W?h.getName():k},J.getLabelBackground=function(g){return g.getStyle("label.background")},J.getLabelColor=function(z){return z.getStyle("label.color")},J.getLabel2=function(H){return H.getStyle("label2")},J.getLabel2Background=function(I){return I.getStyle("label2.background")},J.getLabel2Color=function(b){return b.getStyle("label2.color")},J.getNote=function(f){return f.getStyle(Ml)},J.getNoteBackground=function(g){return g.getStyle("note.background")},J.getNote2=function(f){return f.getStyle(Eg)},J.getNote2Background=function(F){return F.getStyle("note2.background")},J.handleClick=function(Y,v,W){var r=this;v?(r.fi({kind:"clickData",event:Y,data:v,part:W}),r.onDataClicked(v,Y)):(r.fi({kind:"clickBackground",event:Y}),r.onBackgroundClicked(Y))
},J.handleDoubleClick=function(k,a,l){var q=this;yp(k)&&(a?(q.fi({kind:"doubleClickData",event:k,data:a,part:l}),q.onDataDoubleClicked(a,k,l),q.checkDoubleClickOnNote(k,a,l)||q.checkDoubleClickOnRotation&&q.checkDoubleClickOnRotation(k,a,l)||(zl(a)?q.onEdgeDoubleClicked(a,k,l):a.ISubGraph?q.onSubGraphDoubleClicked(a,k,l):tl(a)?q.onGroupDoubleClicked(a,k,l):a.IDoorWindow?q.onDoorWindowDoubleClicked(a,k,l):a.ICSGBox&&q.onCSGBoxDoubleClicked(a,k,l))):(q.fi({kind:"doubleClickBackground",event:k}),q.onBackgroundDoubleClicked(k)))},J.onSubGraphDoubleClicked=function(g){this.setCurrentSubGraph(g)},J.onEdgeDoubleClicked=function(W,P){this.isEditable(W)||(W.ISubGraph&&!Uj(P)?this.setCurrentSubGraph(W):W.s("edge.toggleable")&&W.toggle())},J._39Q=function(N){return this.isInteractive(N)?this.preventDefaultWhenInteractive(N):!1},J.preventDefaultWhenInteractive=function(M){return M.s("preventDefaultWhenInteractive")},J.onGroupDoubleClicked=function(E){E.s("group.toggleable")&&E.toggle()},J.onDoorWindowDoubleClicked=function(o){o.s("dw.toggleable")&&o.toggle(!0)},J.onCSGBoxDoubleClicked=function(J,e){var h=this;if(h instanceof Es){var O=h.intersectObject(e,J);O&&J.s(O.part+".toggleable")&&J.toggleFace(O.part,!0)}},J.onBackgroundClicked=function(){},J.onBackgroundDoubleClicked=function(){this.upSubGraph()},J.onDataClicked=function(){},J.onDataDoubleClicked=function(){},J.onAutoLayoutEnded=function(){},J.onMoveEnded=function(){},J.onPanEnded=function(){},J.onPinchEnded=function(){},J.onRectSelectEnded=function(){},J.onZoomEnded=function(){},J.serialize=function(M){return this.dm().serialize(M)},J.toJSON=function(){return this.dm().toJSON()},J.deserialize=function(c,j){var L=this;j=j instanceof gi?{rootParent:j}:an(j)?{setId:j}:Qj(j)?{finishFunc:j}:j||{},j.view=L;var r=L.dm();return j.reset&&(r.setAttrObject({}),r.setLayers(W),r.setName(W),r.setAutoAdjustIndex(!0),r.setHierarchicalRendering(!1),r.setBackground(W),r.setInit(W),r.setPostProcessingData(W),r.setEnvmap(W),r.setEnvmapType(W),L.disableToolTip(),L instanceof n.graph.GraphView?(L.setZoomable(H.graphViewZoomable),L.setPannable(H.graphViewPannable),L.setRectSelectable(H.graphViewRectSelectable)):L instanceof n.graph3d.Graph3dView&&(L.shadowMap.resetProperties(),L.setDashDisabled(H.graph3dViewDashDisabled),L.setUvClipEnabled(H.graph3dViewUvClipEnabled),L.getHighlightHelper().resetProperties(),L.resetHeadlightProperties(),L.resetFogProperties(),L.setBatchInfoMap({}),L.setBatchColorDisabled(H.graph3dViewBatchColorDisabled),L.setBatchInstancedDisabled(H.graph3dViewBatchInstancedDisabled),L.setBatchBlendDisabled(H.graph3dViewBatchBlendDisabled),L.setBatchBrightnessDisabled(H.graph3dViewBatchBrightnessDisabled),L.setFlowBlendMode(H.graph3dViewFlowBlendMode),L.setMoveStep(H.graph3dViewMoveStep),L.setRotateStep(H.graph3dViewRotateStep),L.setSortable(H.graph3dViewSortable),L.setSortFunc(W),L.setSkybox(W),ms(L))),j.__innerHandler__=function(M){if(an(r.a("toolTipEnable"))&&(r.a("toolTipEnable")?L.enableToolTip():L.disableToolTip()),L instanceof n.graph.GraphView&&(an(r.a("zoomable"))&&L.setZoomable&&L.setZoomable(r.a("zoomable")),an(r.a("pannable"))&&L.setPannable&&L.setPannable(r.a("pannable")),an(r.a("rectSelectable"))&&L.setRectSelectable&&L.setRectSelectable(r.a("rectSelectable")),r.a("fitContent")===!0&&L.fitContent&&L.fitContent(!0,0)),L instanceof n.graph3d.Graph3dView){var V=M.scene;V&&V.shadow!=S&&L.shadowMap.setShadow(V.shadow,V.shadowParams);var v=r.a("sceneContext");v?(v.eye&&L.setEye(v.eye),v.center&&L.setCenter(v.center),ff(v.far)&&L.setFar(v.far),ff(v.near)&&L.setNear(v.near)):(ff(r.a("sceneNear"))&&L.setNear(r.a("sceneNear")),ff(r.a("sceneFar"))&&L.setFar(r.a("sceneFar")),V&&(V.eye&&L.setEye(V.eye),V.center&&L.setCenter(V.center))),an(r.a("sceneShadowEnabled"))&&(r.a("sceneShadowEnabled")?L.enableShadow():L.disableShadow()),ff(r.a("sceneShadowDegreeX"))&&L.setShadowDegreeX(r.a("sceneShadowDegreeX")),ff(r.a("sceneShadowDegreeZ"))&&L.setShadowDegreeZ(r.a("sceneShadowDegreeZ")),ff(r.a("sceneShadowIntensity"))&&L.setShadowIntensity(r.a("sceneShadowIntensity")),r.a("sceneShadowQuality")!=S&&L.setShadowQuality(r.a("sceneShadowQuality")),r.a("sceneShadowType")&&L.setShadowType(r.a("sceneShadowType")),ff(r.a("sceneShadowRadius"))&&L.setShadowRadius(r.a("sceneShadowRadius")),ff(r.a("sceneShadowBias"))&&L.setShadowBias(r.a("sceneShadowBias")),an(r.a("sceneDashEnable"))&&L.setDashDisabled(!r.a("sceneDashEnable")),an(r.a("sceneUvClipEnabled"))&&L.setUvClipEnabled(r.a("sceneUvClipEnabled")),xd(r.a("sceneHighlightMode"))&&L.setHighlightMode(r.a("sceneHighlightMode")),ff(r.a("sceneHighlightWidth"))&&L.setHighlightWidth(r.a("sceneHighlightWidth")),r.a("sceneHighlightColor")&&L.setHighlightColor(r.a("sceneHighlightColor")),r.a("sceneHighlightType")&&L.setHighlightType(r.a("sceneHighlightType")),r.a("sceneHighlightGlow")&&L.setHighlightGlow(r.a("sceneHighlightGlow")),r.a("sceneHighlightStrength")&&L.setHighlightStrength(r.a("sceneHighlightStrength")),an(r.a("sceneHeadlightEnable"))&&L.setHeadlightDisabled(!r.a("sceneHeadlightEnable")),r.a("sceneHeadlightDirection")!=S&&L.setHeadlightDirection(r.a("sceneHeadlightDirection")),ff(r.a("sceneHeadlightRange"))&&L.setHeadlightRange(r.a("sceneHeadlightRange")),r.a("sceneHeadlightColor")&&L.setHeadlightColor(r.a("sceneHeadlightColor")),ff(r.a("sceneHeadlightIntensity"))&&L.setHeadlightIntensity(r.a("sceneHeadlightIntensity")),ff(r.a("sceneHeadlightAmbientIntensity"))&&L.setHeadlightAmbientIntensity(r.a("sceneHeadlightAmbientIntensity")),ff(r.a("sceneHeadlightGroup"))&&L.setHeadlightGroup(r.a("sceneHeadlightGroup")),an(r.a("sceneFogEnable"))&&L.setFogDisabled(!r.a("sceneFogEnable")),r.a("sceneFogMode")&&L.setFogMode(r.a("sceneFogMode")),ff(r.a("sceneFogDensity"))&&L.setFogDensity(r.a("sceneFogDensity")),r.a("sceneFogColor")&&L.setFogColor(r.a("sceneFogColor")),ff(r.a("sceneFogNear"))&&L.setFogNear(r.a("sceneFogNear")),ff(r.a("sceneFogFar"))&&L.setFogFar(r.a("sceneFogFar")),an(r.a("sceneBatchBrightnessDisabled"))&&L.setBatchBrightnessDisabled(r.a("sceneBatchBrightnessDisabled")),r.a("sceneFlowBlendMode")!==W&&L.setFlowBlendMode(r.a("sceneFlowBlendMode")),an(r.a("sceneBatchBlendDisabled"))&&L.setBatchBlendDisabled(r.a("sceneBatchBlendDisabled")),an(r.a("sceneBatchColorDisabled"))&&L.setBatchColorDisabled(r.a("sceneBatchColorDisabled")),an(r.a("sceneBatchInstancedDisabled"))&&L.setBatchInstancedDisabled(r.a("sceneBatchInstancedDisabled")),r.a("sceneBatchInfoMap")&&L.setBatchInfoMap(r.a("sceneBatchInfoMap")),ff(r.a("sceneMoveStep"))&&L.setMoveStep(r.a("sceneMoveStep")),ff(r.a("sceneRotateStep"))&&L.setRotateStep(r.a("sceneRotateStep")),an(r.a("sceneSortable"))&&L.setSortable(r.a("sceneSortable")),Qj(r.a("sceneSortFunc"))&&L.setSortFunc(r.a("sceneSortFunc"));var P=r.a("sceneSkyboxType")||"sphere";if(P!=S){var O={},B=!1;if("sphere"===P){O.shape3d=P;var R=r.a("sceneSkyboxImage");R&&(O["shape3d.image"]=R,B=!0)}else"cube"===P?(O.shape3d=W,["front","back","left","right","top","bottom"].forEach(function(m){var e=m+".image",u=m.charAt(0).toUpperCase()+m.slice(1),j=r.a("sceneSkybox"+u+"Image");j&&(O[e]=j,B=!0)})):"color"===P&&(B=!0);if(B){var I=new ci,o=r.a("sceneSkyboxDiameter");if(ff(o)?I.s3(o,o,o):I.s3(20,20,20),O["body.color"]=r.a("sceneSkyboxBodyColor"),O.envmap=r.a("sceneSkyboxEnvmap"),O["envmap.probe"]=r.a("sceneSkyboxEnvmapProbe"),O.roughness=r.a("sceneSkyboxRoughness"),O["shape3d.light"]=O["all.light"]=r.a("sceneSkyboxLight"),O["light.mask"]=r.a("sceneSkyboxLightMask"),O["headlight.ambientIntensity"]=r.a("sceneSkyboxHeadLightAmbientIntensity"),O["texture.wrap"]="clampToEdge",O["3d.clipbox.mask"]=Hp,O["effect.flow.mask"]=Hp,"color"===P){O.shape3d="sphere";var g=2,u=1024,R=I.s("shape3d.image"),A=R&&n.Default.getImage(R);A&&"CANVAS"===A.tagName||(A=m.createElement("canvas"),R=n.Math.generateUUID(),n.Default.setImage(R,A)),R&&L.getTextureMap()&&L.deleteTexture(R),n.Default.setCanvas(A,g,u,1);var b=A.getContext("2d");b.clearRect(0,0,g,u),b.beginPath(),b.rect(0,0,g,u),Id(b,r.a("sceneSkyboxColor"),function(X){return X},!1,{x:0,y:0,width:g,height:u}),b.fill(),b.restore(),O["shape3d.image"]=R}I.s(O),["X","Y","Z"].forEach(function(t){var s=r.a("sceneSkyboxRotation"+t);ff(s)&&I["setRotation"+t](s)}),L.setSkybox(I)}}}},r.deserialize(c,j.rootParent,j)},J.isDebugTipShowing=function(){return!!this._debugDiv},J.showDebugTip=function(){var X=this,N=X._debugDiv;if(!N){N=X._debugDiv=m.createElement("div"),N.style.position="absolute",N.style.overflow="hidden",N.style.font=H.debugTipLabelFont,N.style.padding="6px",N.style.backgroundColor=H.debugTipBackground,N.style.color=H.debugTipLabelColor;var p=X.getView();X._79O?p.insertBefore(N,X._79O):p.appendChild(N);var j=function(){X.redraw();var Y=X._canvas,n="FPS: "+X._fpsInfo.fps+"<br/>"+"Datas: "+X.dm().getDatas().length+(Y?"<br/>Size: "+Y.width+" * "+Y.height:""),d=X.dm()._historyManager;d&&(n+="<br/>Undoes: "+d.getHistories().length+" index: "+d.getHistoryIndex());var f=X.getDebugTip();f&&(n+="<hr>"+f),N.innerHTML=n,X._isDebugging&&requestAnimationFrame(j)};requestAnimationFrame(j),X._isDebugging=!0}},J.hideDebugTip=function(){var $=this,K=$._debugDiv;K&&(delete $._debugDiv,$.getView().removeChild(K),$._isDebugging=!1)},J.updateDOMAppendMatrix=function(){var N=this.getView();N&&(N.updateAppendMatrix=!0)},J.countFrame=function(){if(this._isDebugging){var e=Date.now(),o=this._fpsInfo;e-o.time>1e3?(o.fps=Math.round(1e5*(o.frames+1)/(e-o.time))/100,o.time=e,o.frames=0):o.frames++}}},ms_icons:function(h){h.getRotation=function(M){return M==S?0:M},h._15O=function(){var f=this,U=f.s(bp);if(U){var u=f,j=f.data||f._data,z=j.getRotation&&j.getRotation(),$=f._38o={icons:U,rects:{}};for(var P in U){var C=U[P],R=dd(C.shape3d,j,u);if(!(dd(C.visible,j,u)===!1||dd(C.for3d,j,u)&&!f.I3d||R&&!f.I3d)){var l=R?[R]:dd(C.names,j,u),Y=l?l.length:0,g=dd(C.position,j,u)||3,d=dd(C.offsetX,j,u)||0,p=dd(C.offsetY,j,u)||0,w=dd(C.direction,j,u)||iq,x=dd(C.gap,j,u),Q=x!=S?x:1,r=dd(C.rotation,j,u),t=dd(C.keepOrien,j,u),L=dd(C.rotationFixed,j,u)?r:f.getRotation(r,t,g),D=S,k=$.rects[P]=new Array(Y);ff(z)&&(ff(L)?L+=z:L=z),k.rotation=L;for(var F=0;Y>F;F++){var K,V,O,y,h=l[F];if(R)O=0,y=0;else{var W=Fr(h);O=dd(C.width,j,u),y=dd(C.height,j,u),O==S&&(O=lm(W,j)),y==S&&(y=qj(W,j))}if(D?w===iq?d+=O/2:w===Dn?d-=O/2:w===hj?p-=y/2:p+=y/2:D={width:O,height:y},f.I3d){var q=-O/2,Z=-y/2;V={width:O,height:y,mat:f._16O(dd(C.autorotate,j,u),g,D,dd(C.face,j,u)||sl,dd(C.t3,j,u),dd(C.r3,j,u),dd(C.rotationMode,j,u),d,p),vs:new mo([q,-Z,0,q,-Z-y,0,q+O,-Z-y,0,q+O,-Z,0])}}else K=f.getPosition(g,d,p,D,dd(C.positionFixed,j,u)),V={x:K.x-O/2,y:K.y-y/2,width:O,height:y},f._68o(V,L);k[F]=V,w===iq?d+=O/2+Q:w===Dn?d-=O/2+Q:w===hj?p-=y/2+Q:p+=y/2+Q}}}}}}});var ug={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},Th={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},Uc={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},Ce={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},ph={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},Zf={"edge.type":1,"edge.group":1},dn={rotation:1,rotationX:1,rotationZ:1,rotation3d:1},gq={rotation:1,position:1,width:1,height:1,anchor:1,scale:1,host:1},Hi={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},rc={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},nk={shape:1,thickness:1,position:1,anchor:1,scale:1},dm=function(g){if(!g)return S;if(zl(g)){var h=g._40I,d=g._41I;if(!h||!d)return S;var v=dm(h),E=dm(d);return v===E?v:S}for(var H=g._parent;zl(H)&&!H.ISubGraph;)H=H._parent;return H?H.ISubGraph?H:dm(H):S},rf=function(d,T,h,S){var W=T.getStyle(h)*S;W&&Qf(d,W),W=T.getStyle(h+".left")*S,W&&(d.x-=W,d.width+=W),W=T.getStyle(h+".right")*S,W&&(d.width+=W),W=T.getStyle(h+".top")*S,W&&(d.y-=W,d.height+=W),W=T.getStyle(h+".bottom")*S,W&&(d.height+=W),d.width<0&&(d.width=-d.width,d.x-=d.width),d.height<0&&(d.height=-d.height,d.y-=d.height)},Um=function(c){for(var O,Y=0,Q=c.size();Q>Y;Y++)if(O=c.getChildAt(Y),af(O)&&Um(O))return!0;return c.hasAgentEdges()},Gd=function(T){if(!T)return S;for(var R=T._parent;tl(R);){if(!tl(R._parent))return R.isExpanded()?T:R;R.isExpanded()||(T=R),R=R._parent}return T},qk=function(Z,x){if(!Z||!x)return S;var L,o,v,m=dm(Z),C=dm(x);if(m!==C){for(;C&&m!==C;)C=dm(C);if(m===C)return Z;L=new Xd,L.add(Z,0);for(var k=Z._parent;af(k)&&!x.isDescendantOf(k);)L.add(k,0),k=k._parent;for(v=L.size(),o=0;v>o;o++){var K=L.get(o);if(tl(K)&&!K.isExpanded())return K;if(K.ISubGraph)return K}return Z}return Z},ih=function(v){if(v.isLooped())return v._source;var q=Gd(v._source),o=Gd(v._target);return q===o?v._source:qk(q,o)},Jl=function(p){if(p.isLooped())return p._target;var m=Gd(p._source),P=Gd(p._target);return m===P?p._target:qk(P,m)},Xn=function(n,Z,q){"target"!==q&&(q="source");var p="target"===q?Z.getTargetAgent():Z.getSourceAgent(),T="edge."+q+".";if(zl(p)){var O=n.getDataUI(p);O._79o();var N=Z.s(T+"index");if(N>=0){var U=pk(O);return U[Math.max(0,Math.min(N,U.length-1))]}var l=Z.s(T+"percent")||0;l=Math.max(0,Math.min(l,1));var t=bl(O);return Hm(t,100*l)}return qp(n,p,Z.s(T+"position"),Z.s(T+"offset.x"),Z.s(T+"offset.y"),Z.s(T+"anchor.x"),Z.s(T+"anchor.y"))},qp=function(l,U,m,B,J,e,q){if(!U)return S;var D,A=U.getRotation?U.getRotation():0;if(e!==W||q!==W){e=e===W?.5:e,q=q===W?.5:q;var $=U.getScale();if(A&&!fm(U,l)||$.x<0||$.y<0){var P=U.getPosition(),g=U.getWidth(),Z=U.getHeight(),f=U.getAnchor(),N=new ur(A,P.x,P.y,$.x,$.y);m=N.tf((e-f.x)*g,(q-f.y)*Z)}else D=$q(l,U),m={x:D.x+e*D.width,y:D.y+q*D.height}}else m=Cs(m,$q(l,U));if(A){var F=s(A),V=R(A),y=B*F-J*V;J=B*V+J*F,B=y}return m.x+=B,m.y+=J,m},hp=function(X,P){if(!X||!P)return S;var t,y,i,l,e,H;if(X===P){if(l=X.getLoopedEdges(),!l)return S;l=new Xd(l)}else{if(e=X.getAgentEdges(),H=P.getAgentEdges(),!e||!H)return S;for(y=e.size(),t=0;y>t;t++)i=e.get(t),H.contains(i)&&(l||(l=new Xd),l.add(i))}if(l)for(t=0;t<l.size();t++)i=l.get(t),i.getStyle(bk)===We&&(i._22I(S),l.removeAt(t),t--);return l},Gk=function(R,W){var F=hp(R,W);if(F&&!F.isEmpty()){if(1===F.size())return F.get(0)._22I(S),void 0;var Q=new Xd,K=new Xd;F.each(function(f){var M=f.s("edge.group");Q.contains(M)||Q.add(M)}),Q.sort(),Q.each(function(m){K.add(new n.EdgeGroup(F.toList(function(k){return m===k.s("edge.group")}),K))}),K.each(function(K){K.each(function(i){i._22I(K)})})}},Lf=function(g,T,B){var E=g._canvas;g._zoom;var C=Ib(T,E),b=Ib(B,E);return{x:C.x-b.x,y:C.y-b.y}},Ro=function(o,J){if(J){var x=J.rect,e=J.color,v=J.rotation,r=J.labelWidth,W=J.background,R=J.opacity,b=J.scale,g=b!=S&&1!==b;if(R!=S){var i=o.globalAlpha;o.globalAlpha*=R}if(v||g){o.save();var h=x.x+x.width/2,z=x.y+x.height/2;Tc(o,h,z),v&&ef(o,v),g&&o.scale(b,b),Tc(o,-h,-z)}if(W&&Xf(o,x.x,x.y,x.width,x.height,W),r){var p=x.width,N=o.createLinearGradient(x.x,x.y,x.x+p,x.y);N.addColorStop(0,e),N.addColorStop(.9,e),N.addColorStop(1,te),e=N,x.width=r}rg(o,J.ss,x,J.font,e,J.align,J.decoration),r&&(x.width=p),(v||g)&&o.restore(),R!=S&&(o.globalAlpha=i)}},Am=function(q,f){if(f){var o=f.rect,P=o.x,F=o.y,Y=o.width,g=o.height,i=f.background,h=f.backgroundImage,a=f.borderWidth,E=f.borderColor,I=f.labelWidth,C=f.opacity,H=f.scale,B=H!=S&&1!==H;if(C!=S){var L=q.globalAlpha;q.globalAlpha*=C}if(B){q.save();var e=o.x+o.width/2,J=o.y+o.height/2;Tc(q,e,J),q.scale(H,H),Tc(q,-e,-J)}if(f.expanded){var U=_(8,Y/4),R=F+g-8;if(q.fillStyle=i,q.beginPath(),q.moveTo(P,F),q.lineTo(P,R),q.lineTo(P+Y/2,R),q.lineTo(P+Y/2,F+g),q.lineTo(P+Y/2+U,R),q.lineTo(P+Y,R),q.lineTo(P+Y,F),q.closePath(),q.fill(),a&&(q.lineWidth=a,q.lineJoin="round",q.lineCap="round",E?(q.strokeStyle=E,q.stroke()):(q.strokeStyle=tb(i),q.beginPath(),q.moveTo(P+Y,F),q.lineTo(P+Y,R),q.lineTo(P+Y/2+U,R),q.lineTo(P+Y/2,F+g),q.stroke(),q.strokeStyle=Vd(i),q.beginPath(),q.moveTo(P+Y,F),q.lineTo(P,F),q.lineTo(P,R),q.lineTo(P+Y/2,R),q.lineTo(P+Y/2,F+g),q.stroke())),h)xe(q,Fr(h),Eh,o.x,o.y,o.width,o.height-8,f.data,f.view);else{if(o.height-=8,i=f.color,I){var j=Y,O=q.createLinearGradient(P,F,P+j,F);O.addColorStop(0,i),O.addColorStop(.9,i),O.addColorStop(1,te),i=O,o.width=I}rg(q,f.ss,o,f.font,i,f.align),I&&(o.width=j),o.height+=8}}else if(f.icon)hl(q,Fr(f.icon),P,F,Y,g,f.data,f.view);else{var l=Y/2;a&&(q.lineWidth=a,q.lineJoin="round",q.lineCap="round",q.strokeStyle=E?E:tb(i),q.beginPath(),q.arc(P+l,F+l,l,Rr,1.6*X,!0),q.moveTo(P+l,F+g),q.lineTo(P+Y-l/5,F+l),q.stroke(),q.strokeStyle=E?E:Vd(i),q.beginPath(),q.arc(P+l,F+l,l,1.6*X,Rr,!0),q.moveTo(P+l,F+g),q.lineTo(P+l/5,F+l),q.stroke()),q.fillStyle=i,q.beginPath(),q.arc(P+l,F+l,l,0,z,!0),q.moveTo(P+l,F+g),q.lineTo(P+Y-l/5,F+l),q.lineTo(P+l/5,F+l),q.closePath(),q.fill(),q.fillStyle=f.color,q.beginPath(),q.arc(P+l,F+l,l/3,0,z,!0),q.fill()}B&&q.restore(),C!=S&&(q.globalAlpha=L)}},Wn=function(l,G){return G>2*l?l:G/2},Ic=function(K,$,M,O){if(!K||!$)return 0;var D=db($.y-K.y,$.x-K.x);return M||(D=$.x<K.x?D+X:D),D+O},Fe=function(i,C,Q,B,k,I,P){P&&(i.x>C.x||i.x===C.x&&i.y>C.y)&&(Q=Lq[Q],k=-k);var u=Cs(Q,{x:0,y:0,width:_h(i,C),height:0},I);return u.x+=B,u.y+=k,u=new ur(db(C.y-i.y,C.x-i.x)).tf(u),u.x+=i.x,u.y+=i.y,u},us=function(K,v,l,E,U){if(K._19Q=!0,!l.getEdgeGroup())return E?l.s("edge.gap"):0;if(zl(l.getSourceAgent())||zl(l.getTargetAgent()))return 0;var o,D=0,s=0,y=0;if(l.getEdgeGroup().getSiblings().each(function(T){T.each(function(A){if(v.isVisible(A)&&A.s(bk)==U){var Y=A.s("edge.gap");o?(s+=y/2+Y/2,y=Y):(o=A,y=Y),A===l&&(D=s)}})}),E)return s-D+y;var F=D-s/2;return o&&l._40I!==o._40I&&(K._19Q=!1),F},yk=function(J){var y=J._getValidSelection();if(1===y.length){var I=y[0],s=I instanceof n.Edge;if(I instanceof n.Shape||s){if(s){var E=I.s("edge.type");if(E&&"points"!==E)return}var g=J.gv;if((!g.isPointEditable||g.isPointEditable(I))&&g.isEditable(I))return I}}},Kr=function(){var V=function(m){var E=[];return m.forEach(function(q){E.push({x:q.x,y:q.y}),E.push({x:q.x+q.width,y:q.y+q.height}),E.push({x:q.x+q.width,y:q.y}),E.push({x:q.x,y:q.y+q.height})}),E};return function(e,F,r){if("oval"===e){var a=0,E=r.height/r.width,j=E*E,H=r.x+r.width/2,v=r.y+r.height/2,d=V(F);d.forEach(function(I){var E=I.x-H,m=I.y-v,t=E*E+m*m/j;t>a&&(a=t)}),a=x(a);var i=E*a;return{x:H-a,y:v-i,width:2*a,height:2*i}}if("circle"===e){var N=0,H=r.x+r.width/2,v=r.y+r.height/2,d=V(F);return d.forEach(function(R){var m=R.x-H,O=R.y-v,D=m*m+O*O;D>N&&(N=D)}),N=x(N),{x:H-N,y:v-N,width:2*N,height:2*N}}return"roundRect"===e?(Qf(r,_(r.width,r.height)/16),r):r}}(),Sb=n.graph={},vs=function(T,l,U){Dh(V+".graph."+T,l,U)};n.layout={};var ke={},De=function(l,h,d,A,p,G,t,u){var U=t._zoom;if(U!==t._cacheZoom&&(t._cacheZoom=U,t._cacheImage={}),U*=mf,A=Math.ceil(A),p=Math.ceil(p),A*U>2048||p*U>2048)return h;var x=[h.uuid,A,p,d].join("_");if(h.cacheRule){var V;V=Qj(h.cacheRule)?h.cacheRule(G,t):dd(h.cacheRule,G,t),x+="_"+V}var z,y=1;p>=A&&y>A*U?(z=p/A,A=y/U,p=A*z):A>=p&&y>p*U&&(z=A/p,p=y/U,A=p*z),A=Math.ceil(A),p=Math.ceil(p);var R=t._cacheImage[x];if(!R){if(Bi(),R=n.Default.toCanvas(h,A,p,d,G,t,u,U),!zi())return h;t._cacheImage[x]=R}return R};kk(H,{setImageCacheRule:function(j,U){var S;U||"object"!=typeof j?(S={},S[j]=U):S=j;for(var a in S){var n=S[a];xd(a)?(Dh=Fr(a),Dh?Dh.cacheRule=n:ke[a]=n):a.cacheRule=n}}});var Ec={comps:[{type:Zb,points:[85,50,70,115,100,71,86,107,88,49,56,73,114,105,52,66,89,51,118,106,116,101,86,47,120,112,78,65,122,100,107,100,116,98,101,84,65,51,104,120,76,119,81,61],borderWidth:1,borderColor:S}]};if(Ec[ye]=Ec[yg]=160,e.Image){var eo=new e.Image;eo.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",oi("default_blank",eo)}oi("node_image",Rn(30,30,[{type:Fi,rect:[4,5,22,16],gradient:qg,gradientColor:kl,background:sr},{type:Fi,rect:[2,3,26,20],borderWidth:1,borderColor:sr},{type:Fi,rect:[11,23,8,4],background:sr},{type:Fi,rect:[6,27,18,2],background:sr}])),oi("node_icon",Rn(16,16,[{type:Fi,rect:[2,2,12,10],gradient:qg,gradientColor:kl,background:sr},{type:tk,rect:[2,2,12,10],width:1,color:sr},{type:Fi,rect:[6,12,4,2],background:sr},{type:Fi,rect:[4,14,8,1],background:sr}])),oi("block_icon",Rn(16,16,[{type:tk,rect:[1,1,14,14],width:1,color:sr}])),oi("group_image",Rn(66,39,[{type:Fi,rect:[44.3,18,18.1,12.8],gradient:qg,gradientColor:kl,background:sr},{type:Fi,rect:[3.3,17.8,18.1,12.8],gradient:qg,gradientColor:kl,background:sr},{type:Fi,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:sr,gradient:qg,gradientColor:kl,background:sr},{type:Fi,rect:[26.2,29.4,12.8,4.2],background:sr},{type:Fi,rect:[21.3,33.5,22.5,2.3],background:sr},{type:Fi,rect:[5.3,32.7,14.1,2.1],background:sr},{type:Fi,rect:[9,30.4,6.7,2.4],background:sr},{type:Fi,rect:[50,30.7,6.7,2.4],background:sr},{type:Fi,rect:[46.3,33,14.1,2.1],background:sr}])),oi("group_icon",Rn(16,16,[{type:Fi,rect:[4,12,4,2],background:sr},{type:Fi,rect:[2,13,8,1],background:sr},{type:Fi,rect:[12,12,2,1],background:sr},{type:Fi,rect:[11,13,4,1],background:sr},{type:Fi,rect:[10,7,6,5],gradient:qg,gradientColor:kl,background:sr},{type:Fi,rect:[1,2,10,10],gradient:qg,gradientColor:kl,background:sr},{type:tk,rect:[1,2,10,10],width:1,color:sr}])),oi("refGraph_icon",Rn(16,16,[{type:"shape",borderWidth:1,borderColor:sr,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:sr,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),oi("edge_icon",Rn(16,16,[{type:Fi,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:qg,gradientColor:kl,background:sr},{type:Fi,rect:[10.8,1,4,4],background:sr},{type:Fi,rect:[1,11,4,4],background:sr}])),oi("subGraph_image",Rn(72,45,[{type:Zb,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:qg,gradientColor:kl,background:sr},{type:Fi,rect:[29.6,30.7,3.6,1.8],background:sr},{type:Fi,rect:[28.4,32.3,6,1.2],background:sr},{type:Fi,rect:[37.3,32,10.8,1.8],background:sr},{type:Fi,rect:[39.1,29.9,7.2,2.3],background:sr},{type:Fi,rect:[26.6,23.7,9.6,7.2],gradient:qg,gradientColor:kl,background:sr},{type:Fi,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:sr,gradient:qg,gradientColor:kl,background:sr}])),oi("subGraph_icon",Rn(17,17,[{type:Zb,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:qg,gradientColor:kl,background:sr}])),oi("shape_icon",Rn(16,16,[{type:Zb,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:sr}])),oi("polyline_icon",Rn(16,16,[{type:Zb,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:sr},Yr(7.5,.4),Yr(7.5,6.3),Yr(13.6,6.3),Yr(13.6,14),Yr(.7,13.9),Yr(.7,.3)])),oi("grid_icon",Rn(16,16,[{type:Fi,rect:[1,1,4,4],background:sr,gradient:qg,gradientColor:kl},{type:Fi,rect:[6,1,4,4],background:sr,gradient:qg,gradientColor:kl},{type:Fi,rect:[11,1,4,4],background:sr,gradient:qg,gradientColor:kl},{type:Fi,rect:[11,6,4,4],background:sr,gradient:qg,gradientColor:kl},{type:Fi,rect:[6,6,4,4],background:sr,gradient:qg,gradientColor:kl},{type:Fi,rect:[1,6,4,4],background:sr,gradient:qg,gradientColor:kl},{type:Fi,rect:[11,11,4,4],background:sr,gradient:qg,gradientColor:kl},{type:Fi,rect:[6,11,4,4],background:sr,gradient:qg,gradientColor:kl},{type:Fi,rect:[1,11,4,4],background:sr,gradient:qg,gradientColor:kl}])),oi("light_icon",Rn(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:sr},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:sr,gradient:qg,gradientColor:kl,background:{func:function(Z){var k=Z?Z.s(og):S;return Td(k)?"rgb("+fl(255*k[0])+","+fl(255*k[1])+","+fl(255*k[2])+")":k||sr}}}])),oi("text_icon",Rn(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:sr}])),oi("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),oi("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),oi("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),oi("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var So=function(v,T,w,C,q,Z){var j,a,i,B,I,A,z,n,N,m,S,$=[];if(Math.abs(C)>2*Math.PI&&(C=2*Math.PI),I=Math.ceil(Math.abs(C)/(Math.PI/4)),j=C/I,a=-j,i=-w,I>0){A=v+Math.cos(w)*q,z=T+Math.sin(-w)*Z,$.push({x:A,y:z});for(var X=0;I>X;X++)i+=a,B=i-a/2,n=v+Math.cos(i)*q,N=T+Math.sin(i)*Z,m=v+Math.cos(B)*(q/Math.cos(a/2)),S=T+Math.sin(B)*(Z/Math.cos(a/2)),$.push({x:m,y:S}),$.push({x:n,y:N})}return $},fp=function(h){if(h){var $=h._data;if($ instanceof n.Shape)return{points:$.getPoints(),segments:$.getSegments()};var e;if($ instanceof n.Edge&&(e=h._78o)){var L,y,b=e.type,p=e.points,H=e.segments,E=e.edgeTypeInfo;if(!b||p){var Q=e.sourcePoint,G=Q.x,N=Q.y,O=e.targetPoint,T=O.x,I=O.y;if(b)H?(L=new Xd({x:G,y:N}),L.addAll(p),L.add({x:T,y:I}),y=new Xd(H._as)):(L=new Xd({x:G,y:N}),p.each(function(n){L.add(n)}),L.add({x:T,y:I}));else if(e.looped){L=new Xd(So(G,N,0,2*Math.PI,e.radius,e.radius)),y=new Xd([1]);for(var R=0;R<(L.size()-1)/2;R++)y.add(3)}else L=new Xd,e.center?(L.add({x:e.c1.x,y:e.c1.y}),L.add({x:G,y:N}),L.add({x:T,y:I}),L.add({x:e.c2.x,y:e.c2.y})):(L.add({x:G,y:N}),L.add({x:T,y:I}))}else E&&(L=new Xd(E.points._as),E.segments&&(y=new Xd(E.segments._as)));return{points:L,segments:y}}}},bl=function(F,i,Y){if(null==i){var V=fp(F);if(!V)return;i=V.points,Y=V.segments}if(i){if(Array.isArray(i)&&(i=new Xd(i)),"number"==typeof i.get(0)){for(var z=new n.List,k=0;k<i.size();k+=2)z.add({x:i.get(k),y:i.get(k+1)});i=z}if(!Y){Y=[1];for(var l=i.length-1;l>0;l--)Y.push(2)}Array.isArray(Y)&&(Y=new Xd(Y));for(var N=Wo(i._as,Y._as,50),x=N.length,y=[],k=0;x>k;k++){var d=N[k];d.length>1&&y.push(d)}return y}},ul=function(M){for(var w=0,K=M.length-1,q=0;K>q;q++){var p=M[q],D=M[q+1],a=D.x-p.x,t=D.y-p.y;w+=Math.sqrt(a*a+t*t)}return w},Gb=function(h,Z){for(var e=0,J=Z.length,x=0;J>x;x++){var j=Z[x];if(e+=j,e>h)return x}return Math.min(x,J-1)},sg=function(x,f){for(var U=0,c=0,q=0,s=x.length-1,F=0;s>F;F++){var t=x[F],J=x[F+1],Z=J.x-t.x,h=J.y-t.y;if(q=Math.sqrt(Z*Z+h*h),U+=q,U>f){U-=q,c=F;break}}var A=x[c],G=x[c+1],W=Math.atan2(G.y-A.y,G.x-A.x),v=f-U,h=Math.sin(W)*v,Z=Math.cos(W)*v;return{x:A.x+Z,y:A.y+h}},Hm=function(L,k){if(L){var F;if(0===k)F=L[0][0];else if(100===k)L=L[L.length-1],F=L[L.length-1];else{for(var E=0,W=[],K=L.length,x=0;K>x;x++){var S=L[x],s=ul(S);E+=s,W.push(s)}for(var n=E*k/100,D=Gb(n,W),N=0,t=0;D>t;t++)N+=W[t];n-=N,F=sg(L[D],n)}return F}},pk=function(D){var t,M;if(D instanceof Ag){var i=fp(D);t=i.points,M=i.segments}else t=arguments[0],M=arguments[1];var Z,V,e,Y,z=[],q=-1;for(V=0,e=M?M.length:t.length;e>V;V++){if(Z=M?M.get(V):1,3===Z)Y=2;else if(4===Z)Y=3;else{if(5===Z)continue;Y=1}q+=Y,z.push(t.get(q))}return z},am=function(L,F,A,y){function J(U){if(U>=0&&1>=U){Z=F(U);var V=(L.x-Z.x)*(L.x-Z.x)+(L.y-Z.y)*(L.y-Z.y);return s>V?(s=V,C=U,!0):!1}}A=A||100,y=y||1e-5;for(var s=1/0,C=0,Z=new Ai,G=0;A>G;++G)J(G/A);for(var f=1/(2*A);f>y;)J(C-f)||J(C+f)||(f/=2);return C};kk(H,{_edgeProtectMethod:{getStraightLinePoints:bl,calculateLineLength:ul,calcSegmentIndexByDistance:Gb,calculatePointAlongLine:sg,getPercentPosition:Hm,getRealPointsFromDataUI:pk}});var Dp=function(B,l){for(var p=B.vertices,J=0;J<p.length;J++){var g=p[J],q=g.y;g.y=g.z,g.z=-q,l&&(g.y+=l)}},no=function(V){for(var A,P,T,t,u,d,J=[],E=[],x=[],Y=V.faces,M=0,r=0,B=0,D=Y.length;D>M;M++,r+=6,B+=9){var R=Y[M];1===R.i?(A||(A=[],P=[],T=[]),Zg(R,M,r,B,V,A,T,P)):2===R.i?(t||(t=[],u=[],d=[]),Zg(R,M,r,B,V,t,d,u)):Zg(R,M,r,B,V,J,x,E)}return{vs:J,uv:E,ns:x,top_vs:A,top_uv:P,top_ns:T,bottom_vs:t,bottom_uv:u,bottom_ns:d}},Zg=function(U,R,C,P,o,J,w,f){var $=o.vertices,m=o.faceVertexUvs,Q=$[U.a],B=$[U.b],W=$[U.c];J.push(Q.x,Q.y,Q.z,B.x,B.y,B.z,W.x,W.y,W.z);var Y,d,t,I=U.vertexNormals;3===I.length?(Y=I[0],d=I[1],t=I[2]):Y=d=t=U.normal,w.push(Y.x,Y.y,Y.z,d.x,d.y,d.z,t.x,t.y,t.z);var T=m[0][R][0],M=m[0][R][1],D=m[0][R][2];f.push(T.x,T.y,M.x,M.y,D.x,D.y)},Nf=function(d){var I;I=Td(d)?d:[d];var N,b,u,f,t,J,r,h,H=1/0,A=1/0,K=1/0,q=-1/0,i=-1/0,j=-1/0,T=["vs","top_vs","bottom_vs"];for(N=0,b=I.length;b>N;N++)for(h=I[N],u=0,f=T.length;f>u;u++)if(r=h[T[u]])for(t=0,J=r.length;J>t;t+=3)H=_(H,r[t]),A=_(A,r[t+1]),K=_(K,r[t+2]),q=g(q,r[t]),i=g(i,r[t+1]),j=g(j,r[t+2]);var p={min:{x:H,y:A,z:K},max:{x:q,y:i,z:j}};return d.boundingBox=p,p},Im=function(){function $(d,I){return d.dot(I)>0}function x(T,K,z,o,n,N,E){for(var W,S,b=[K,z,o],s=[n,N,E],g=[],I=b.length,L=!0;I--&&L;){for(var F=b[I],B=s.length,R=!1;B--;)if(F.equals(s[B])){s.splice(B,1),g.push(F),R=!0;break}if(!R){if(W){L=!1;break}W=F}}return L&&2===g.length&&(S=s[0],v.subVectors(W,g[0]),f.subVectors(S,g[0]),c.subVectors(W,g[1]),v.x*c.y*f.z+c.x*f.y*v.z+f.x*v.y*c.z-f.x*c.y*v.z-f.y*c.z*v.x-f.z*c.x*v.y<1e-6&&(M.subVectors(S,g[1]),U.subVectors(g[1],g[0]),$(U,v)&&$(U,f)&&(U.negate(),$(U,c)&&$(U,M))))?(T.push(g[1].x,g[1].y,g[1].z),T.push(W.x,W.y,W.z),T.push(W.x,W.y,W.z),T.push(g[0].x,g[0].y,g[0].z),T.push(g[0].x,g[0].y,g[0].z),T.push(S.x,S.y,S.z),T.push(S.x,S.y,S.z),T.push(g[1].x,g[1].y,g[1].z),2):(T.push(K.x,K.y,K.z),T.push(z.x,z.y,z.z),T.push(z.x,z.y,z.z),T.push(o.x,o.y,o.z),T.push(o.x,o.y,o.z),T.push(K.x,K.y,K.z),1)}function k(){this._vertexMap={},this._lineMap={},this._lineList=[]}function n(f,d,z,V,w,M,y){var G=[z,w];f[0]===V&&G.reverse();var N=[G[0]._key,G[1]._key].join("|"),o=f._triangles[N];o||(f._triangles[N]=o={});var v=[M._key,y._key].join("|");o[v]||(o[v]=[M,y])}function J(s,E,I){var Y=s._planes[I._key];if(!Y)for(var l in s._planes){var i=s._planes[l];if(i._normal.angleTo(I)<.001){Y=i;break}}return Y?(Y._vertices.indexOf(E)<0&&Y._vertices.push(E),void 0):(s._planes[I._key]={_normal:I,_vertices:[E]},void 0)}function Q(H,D){return 0===D?"0|0|0":1/0===Math.abs(D)?[H.x,H.y,H.z].join("|"):[Math.round(m.angleTo(H)*D),Math.round(b.angleTo(H)*D),Math.round(F.angleTo(H)*D)].join("|")}function T(I,V){var R=I._ctlineModel;if(R||(I._ctlineModel=R=[]),R[0])return R[0];var r;r=Td(I)?I:[I];var v,o,i,f,w,G,B,A,D,T,b,J,p,g,F,C,Y,S,E,Q=["","top_","bottom_"];
R=[];var H=[];for(Qi(r,V,H),v=0,o=H.length;o>v;v++)if(T=H[v])for(Sm(T),i=0,f=Q.length;f>i;i++)if(D=T[Q[i]+"lvs"])for(Y=R.length,S=D.length,R.length=Y+S,E=0;S>E;++E,++Y)R[Y]=D[E];else if(B=T[Q[i]+"vs"]){A=T[Q[i]+"is"],G=A?A.length:B.length/3;for(var w=0;G-1>w;)A?(b=A[w],J=A[w+1],p=A[w+2],g=A[w+3],F=A[w+4],C=A[w+5]):(b=w,J=w+1,p=w+2,g=w+3,F=w+4,C=w+5),N.fromArray(B,3*b),P.fromArray(B,3*J),d.fromArray(B,3*p),K.fromArray(B,3*g),s.fromArray(B,3*F),z.fromArray(B,3*C),w+=3*x(R,N,P,d,K,s,z);G>w&&(A?(b=A[w],J=A[w+1],p=A[w+2]):(b=w,J=w+1,p=w+2),N.fromArray(B,3*b),P.fromArray(B,3*J),d.fromArray(B,3*p),R.push(N.x,N.y,N.z),R.push(P.x,P.y,P.z),R.push(P.x,P.y,P.z),R.push(d.x,d.y,d.z),R.push(d.x,d.y,d.z),R.push(N.x,N.y,N.z))}return I._ctlineModel[0]=R,R}function j(E,z,d){var h=E._ctlineModel;h||(E._ctlineModel=h=[]);var e=h[1];if(e&&e.epsilon===d)return e;e=[],e.epsilon=d;var Z;Z=Td(E)?E:[E];var s,F,V,w,$,j,f,m,p,Q,P,T,g=["","top_","bottom_"],N=new k,C=[];for(Qi(Z,z,C),s=0,F=C.length;F>s;s++)if(p=C[s])for(Sm(p),V=0,w=g.length;w>V;V++)if(f=p[g[V]+"vs"]){m=p[g[V]+"is"],j=m?m.length:f.length/3;for(var $=0,$=0;j>$;$+=3)m?(Q=m[$],P=m[$+1],T=m[$+2]):(Q=$,P=$+1,T=$+2),N._addTriangle(f,W,Q,P,T,d)}return N._toLineVS(e),E._ctlineModel[1]=e,e}function O(l,h,L){var T=l._ctlineModel;T||(l._ctlineModel=T=[]);var I=T[2];if(I&&I.epsilon===L)return I;I=[],I.epsilon=L;var S;S=Td(l)?l:[l];var q,v,y,r,K,f,F,C,p,J,U,$,b,X=["","top_","bottom_"],x=new k,u=[];for(Qi(S,h,u),q=0,v=u.length;v>q;q++)if(J=u[q])for(Sm(J),y=0,r=X.length;r>y;y++)if(F=J[X[y]+"vs"]){C=J[X[y]+"is"],p=J[X[y]+"ns"],f=C?C.length:F.length/3;for(var K=0,K=0;f>K;K+=3)C?(U=C[K],$=C[K+1],b=C[K+2]):(U=K,$=K+1,b=K+2),x._addTriangle(F,p,U,$,b,L)}return x._toLineVS(I),l._ctlineModel[2]=I,I}var N=new se,P=new se,d=new se,K=new se,s=new se,z=new se,v=new se,c=new se,f=new se,M=new se,U=new se,B=new se;k.prototype._findVertex=function(C,T){B.fromArray(C,3*T);var L=[B.x,B.y,B.z].join(","),t=this._vertexMap[L];if(!t){var l=B.clone();l._key=L,this._vertexMap[L]=t=l}return t},k.prototype._findLine=function(D,h){var i=[D,h];D._key>h._key&&i.reverse(),i._key=[i[0]._key,i[1]._key].join("|");var S=this._lineMap[i._key];return S||(this._lineMap[i._key]=S=i,i._triangles={},i._planes={},this._lineList.push(i)),S};var m=new se(1,0,0),b=new se(0,1,0),F=new se(0,0,1),R=new se,u=new se;return k.prototype._addTriangle=function(p,j,d,X,x,h){var Y,E,c,l=this._findVertex(p,d),K=this._findVertex(p,X),z=this._findVertex(p,x),o=this._findLine(l,K),$=this._findLine(K,z),G=this._findLine(z,l);j?(Y=(new se).fromArray(j,3*d),Y._key=Q(Y,h),E=(new se).fromArray(j,3*X),E._key=Q(E,h),c=(new se).fromArray(j,3*x),c._key=Q(c,h),n(o,l,Y,K,E,z,c),n($,K,E,z,c,l,Y),n(G,z,c,l,Y,K,E)):(u.subVectors(z,K),R.subVectors(K,l),Y=(new se).crossVectors(R,u),Y._key=Q(Y,h),J(o,z,Y),J($,l,Y),J(G,K,Y))},k.prototype._toLineVS=function(j){for(var K=this._lineList,B=0,t=K.length;t>B;++B){var C=K[B],E=!1;for(var N in C._triangles)if(1==o.keys(C._triangles[N]).length){j.push(C[0].x,C[0].y,C[0].z,C[1].x,C[1].y,C[1].z),E=!0;break}if(!E)for(var n in C._planes)if(1==C._planes[n]._vertices.length){j.push(C[0].x,C[0].y,C[0].z,C[1].x,C[1].y,C[1].z),E=!0;break}}},[T,j,O]}(),Jm=function(z,X){var C=z._lineModel;if(C)return C;var q;q=Td(z)?z:[z];var I,g,D,G,T,e,t,d,Y,k,x,c,u=["","top_","bottom_"];C=[];var B=[];for(Qi(z,X,B),I=0,g=B.length;g>I;I++)if(Y=B[I])for(D=0,G=u.length;G>D;D++)if(t=Y[u[D]+"vs"]){d=Y[u[D]+"is"],e=d?d.length:t.length/3;for(var T=0;e>T;T+=3)d?(k=d[T],x=d[T+1],c=d[T+2]):(k=T,x=T+1,c=T+2),k*=3,x*=3,c*=3,C.push(t[k],t[k+1],t[k+2],t[x],t[x+1],t[x+2],t[x],t[x+1],t[x+2],t[c],t[c+1],t[c+2],t[c],t[c+1],t[c+2],t[k],t[k+1],t[k+2])}return z._lineModel=C,C},Go=function(q,H,Y,J,X,B,c,G,Q,i){Y==S&&(Y=!0),J==S&&(J=!0),c==S&&(c=1),G==S&&(G=0);var v=new lp;$j(v,q,H,Q),v=v.toShapes();var e=W;return i&&(i.length?e={minX:i[0],minY:-i[3],maxX:i[2],maxY:-i[1]}:(e={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},v.forEach(function(T){var $=T.getBoundingBox();e.minX=_($.minX,e.minX),e.minY=_($.minY,e.minY),e.maxX=g($.maxX,e.maxX),e.maxY=g($.maxY,e.maxY)}))),no(new Yg(v,{top:Y,bottom:J,curveSegments:X,amount:c,repeatUVLength:B,boundingBox:e},-c/2+G))},Rj=function(x,X){this.repeatUVLength=x,this._bb=X};Rj.prototype={generateTopUV:function(k,Q,u,h,j,H,K){var L,O,p,Z,Y=k.vertices,D=Y[h].x,V=Y[h].y,I=Y[j].x,R=Y[j].y,y=Y[H].x,$=Y[H].y,S=this.repeatUVLength;if(S)L=0,O=0,p=S,Z=S;else{this._bb||(this._bb=Q.getBoundingBox());var t=this._bb;L=t.minX,O=t.minY,p=t.maxX-L,Z=t.maxY-O}return K?[new _d((D-L)/p,(V-O)/Z),new _d((I-L)/p,(R-O)/Z),new _d((y-L)/p,($-O)/Z)]:[new _d((D-L)/p,1-(V-O)/Z),new _d((I-L)/p,1-(R-O)/Z),new _d((y-L)/p,1-($-O)/Z)]},generateBottomUV:function(e,n,w,F,P,W){return this.generateTopUV(e,n,w,F,P,W,!0)},generateSideWallUV:function(U,V,q,i,S,o,Q,l,r,G,z,T){if(!this._cl){for(var J,b,_=[],N=0,e=q.length,X=0;e>X;X++){J=q[X],b=q[(X+1)%e];var R=J.x-b.x,H=J.y-b.y,C=x(R*R+H*H);_.push(N),N+=C}for(var X=0;e>X;X++)_[X]/=N;this._cl=_}var _=this._cl,j=1-r/G,f=1-(r+1)/G,k=_[z],W=_[T];return W>k&&(k+=1),[new _d(k,j),new _d(W,j),new _d(W,f),new _d(k,f)]}};var gm=function(R,k,L,C,e,X){this.a=R,this.b=k,this.c=L,this.i=X,this.normal=C instanceof er?C:new er,this.vertexNormals=C instanceof Array?C:[]};gm.prototype={constructor:gm};var wl=[-8,14,-2,8,0,8,1,2,-1],Uf=function(){if(Uf[Xj]!=S)return Uf[Xj];for(var V=gk[Xj],l=wl,w=gi.prototype.getClassName(),v='"',d=0,t="",$=!1,O=+new(e[w.substr(3,3)+Yf[d]]),i=d;i<l.length;i++){var E=l.length-i;t+=i%2===d?l[i]+E+"":l[i]-E+""}for(var i=d;4>i;i++)t+=d;if(t=t*t.length/t.length,O>t){if(V&&V[d]&&V[4/Fi.length]){for(var q,z,b,W,M,P,k,L,Y=V[0],f=V[1],c="",J=0,i=0;i<f.length;i++)f[i]===v?L?(L=!1,0!==J%2&&(q==S?q=c:z==S?z=c:b==S?b=c:W==S?W=c:M==S?M=c:P==S?P=c:k==S&&(k=c)),J++,c=""):L=!0:L&&(c+=f[i]);for(var j,D,n,p="",y=0,i=0;i<Y.length;i++)Y[i]===v?j?(j=!1,0!==y%2&&(D==S?D=p:n==S&&(n=p)),y++,p=""):j=!0:j&&(p+=Y[i]);var I=q+z+b+W+M+P,R=!P||P===Hc;if(!R&&P)for(var T,i=0,_=P.length;_>i;i++)P[i]===Rd[4]?T===Hc?R=pm:T[0]===nh[7]&&Hc&&Hc.indexOf(T.substr(1))>=0?R=Lm:T=S:(T==S?T=P[i]:T+=P[i],i===_-1&&(T===Hc?R=pm:T[0]===nh[7]&&Hc&&Hc.indexOf(T.substr(1))>=0&&(R=Lm)));($=Pj(I,k)&&Pj(D,n)&&D===q&&R&&(!M||M>O))&&b.indexOf(nb[0])>=0&&(Uf[nb[0]]=1),$&&b.indexOf(1)>=0&&(Uf[1]=1),$&&b.indexOf(3)>=0&&(Uf[2]=1),$&&b.indexOf(4)>=0&&(Uf[3]=1),$&&b.indexOf(7)>=0&&(Uf[4]=1),$&&b.indexOf(hb[1])>=0&&(Uf[hb[1]]=1)}}else $=!0,Uf[nb[0]]=Uf[1]=Uf[2]=Uf[3]=Uf[4]=Uf[hb[1]]=1;return Uf[Xj]=$,$},wm=function(){},zd=wm.prototype;zd.getPointAt=function(k){var K=this.getUtoTmapping(k);return this.getPoint(K)},zd.getPoints=function(Y){Y||(Y=5);var U,r=[];for(U=0;Y>=U;U++)r.push(this.getPoint(U/Y));return r},zd.getSpacedPoints=function(c){c||(c=5);var l,t=[];for(l=0;c>=l;l++)t.push(this.getPointAt(l/c));return t},zd.getLength=function(){var T=this.getLengths();return T[T.length-1]},zd.getLengths=function(E){if(E||(E=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==E+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var s,u,T=[],I=this.getPoint(0),L=0;for(T.push(0),u=1;E>=u;u++)s=this.getPoint(u/E),L+=s.distanceTo(I),T.push(L),I=s;return this.cacheArcLengths=T,T},zd.getUtoTmapping=function(n,q){var h,b=this.getLengths(),z=0,Y=b.length;h=q?q:n*b[Y-1];for(var l,Z=0,M=Y-1;M>=Z;)if(z=j(Z+(M-Z)/2),l=b[z]-h,0>l)Z=z+1;else{if(!(l>0)){M=z;break}M=z-1}if(z=M,b[z]==h){var w=z/(Y-1);return w}var V=b[z],y=b[z+1],B=y-V,S=(h-V)/B,w=(z+S)/(Y-1);return w},zd.getTangent=function(V){var d=1e-4,T=V-d,X=V+d;0>T&&(T=0),X>1&&(X=1);var a=this.getPoint(T),R=this.getPoint(X),v=R.clone().sub(a);return v.normalize()},zd.getTangentAt=function(Z){var P=this.getUtoTmapping(Z);return this.getTangent(P)},wm.create=function(c,H){return c.prototype=wc(wm.prototype),c.prototype.getPoint=H,c};var Ae=function(){this.curves=[],this.autoClose=!1},Fg=Ae.prototype=wc(zd);Fg.add=function(k){this.curves.push(k)},Fg.closePath=function(){var U=this.curves[0].getPoint(0),R=this.curves[this.curves.length-1].getPoint(1);U.equals(R)||this.curves.push(new bn(R,U))},Fg.getPoint=function(f){for(var u,T,y=f*this.getLength(),C=this.getCurveLengths(),r=0;r<C.length;){if(C[r]>=y){u=C[r]-y,T=this.curves[r];var J=1-u/T.getLength();return T.getPointAt(J)}r++}return null},Fg.getLength=function(){var Z=this.getCurveLengths();return Z[Z.length-1]},Fg.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var F,b=[],M=0,D=this.curves.length;for(F=0;D>F;F++)M+=this.curves[F].getLength(),b.push(M);return this.cacheLengths=b,b},Fg.getTransformedPoints=function(Z){return this.getPoints(Z)},Fg.getBoundingBox=function(){var n,K,$,l,T,P,I=this.getPoints();n=K=Number.NEGATIVE_INFINITY,l=T=Number.POSITIVE_INFINITY;var q,C,X,w,s=I[0]instanceof er;for(w=s?new er:new _d,C=0,X=I.length;X>C;C++)q=I[C],q.x>n&&(n=q.x),q.x<l&&(l=q.x),q.y>K&&(K=q.y),q.y<T&&(T=q.y),s&&(q.z>$&&($=q.z),q.z<P&&(P=q.z)),w.add(q);var Q={minX:l,minY:T,maxX:n,maxY:K};return s&&(Q.maxZ=$,Q.minZ=P),Q};var zh=function($){Ae.call(this),this.actions=[],$&&this.fromPoints($)},hk=zh.prototype=wc(Ae.prototype),Tn="moveTo",gn="lineTo",Om="quadraticCurveTo",ng="bezierCurveTo",$l="arc",ji="ellipse";hk.fromPoints=function(D){this.moveTo(D[0].x,D[0].y);for(var Y=1,J=D.length;J>Y;Y++)this.lineTo(D[Y].x,D[Y].y)},hk.moveTo=function(){var K=Array.prototype.slice.call(arguments);this.actions.push({action:Tn,args:K})},hk.lineTo=function(j,u){var c=Array.prototype.slice.call(arguments),p=this.actions[this.actions.length-1].args,T=p[p.length-2],e=p[p.length-1],y=new bn(new _d(T,e),new _d(j,u));this.curves.push(y),this.actions.push({action:gn,args:c})},hk.quadraticCurveTo=function(M,q,v,l){var z=Array.prototype.slice.call(arguments),G=this.actions[this.actions.length-1].args,t=G[G.length-2],F=G[G.length-1],Q=new Al(new _d(t,F),new _d(M,q),new _d(v,l));this.curves.push(Q),this.actions.push({action:Om,args:z})},hk.bezierCurveTo=function(W,B,C,_,a,d){var t=Array.prototype.slice.call(arguments),q=this.actions[this.actions.length-1].args,R=q[q.length-2],h=q[q.length-1],V=new Kk(new _d(R,h),new _d(W,B),new _d(C,_),new _d(a,d));this.curves.push(V),this.actions.push({action:ng,args:t})},hk.arc=function(H,b,r,x,Y,M){var W=this.actions[this.actions.length-1].args,X=W[W.length-2],z=W[W.length-1];this.absarc(H+X,b+z,r,x,Y,M)},hk.absarc=function(L,w,a,R,j,S){this.absellipse(L,w,a,a,R,j,S)},hk.ellipse=function(U,x,B,f,c,V,D){var s=this.actions[this.actions.length-1].args,y=s[s.length-2],X=s[s.length-1];this.absellipse(U+y,x+X,B,f,c,V,D)},hk.absellipse=function(w,k,r,q,F,X,P){var i=Array.prototype.slice.call(arguments),m=new Fl(w,k,r,q,F,X,P);this.curves.push(m);var b=m.getPoint(1);i.push(b.x),i.push(b.y),this.actions.push({action:ji,args:i})},hk.getSpacedPoints=function(U){U||(U=40);for(var W=[],I=0;U>I;I++)W.push(this.getPoint(I/U));return W},hk.getPoints=function(j,w){j=j||12;var W,o,g,Y,E,X,a,N,u,t,l,r,G,p,T,P,d,K,y=[];for(W=0,o=this.actions.length;o>W;W++)switch(g=this.actions[W],Y=g.action,E=g.args,Y){case Tn:y.push(new _d(E[0],E[1]));break;case gn:y.push(new _d(E[0],E[1]));break;case Om:for(X=E[2],a=E[3],t=E[0],l=E[1],y.length>0?(p=y[y.length-1],r=p.x,G=p.y):(p=this.actions[W-1].args,r=p[p.length-2],G=p[p.length-1]),T=1;j>=T;T++)P=T/j,d=de.b2(P,r,t,X),K=de.b2(P,G,l,a),y.push(new _d(d,K));break;case ng:for(X=E[4],a=E[5],t=E[0],l=E[1],N=E[2],u=E[3],y.length>0?(p=y[y.length-1],r=p.x,G=p.y):(p=this.actions[W-1].args,r=p[p.length-2],G=p[p.length-1]),T=1;j>=T;T++)P=T/j,d=de.b3(P,r,t,N,X),K=de.b3(P,G,l,u,a),y.push(new _d(d,K));break;case $l:var x,C=E[0],V=E[1],$=E[2],f=E[3],S=E[4],I=!!E[5],U=S-f,J=2*j;for(T=1;J>=T;T++)P=T/J,I||(P=1-P),x=f+P*U,d=C+$*s(x),K=V+$*R(x),y.push(new _d(d,K));break;case ji:var x,C=E[0],V=E[1],Z=E[2],e=E[3],f=E[4],S=E[5],I=!!E[6],U=S-f,J=2*j;for(T=1;J>=T;T++)P=T/J,I||(P=1-P),x=f+P*U,d=C+Z*s(x),K=V+e*R(x),y.push(new _d(d,K))}var A,O,q=D["shape3d.point.epsilon"],M=!1;for(o=y.length,W=0,o=y.length;o>W;W++)A=y[W],O=W===o-1?y[0]:y[W+1],A&&O&&v(A.x-O.x)<q&&v(A.y-O.y)<q&&(M=!0,y[W]=null);if(M){var n=[];for(W=0;o>W;W++)y[W]&&n.push(y[W]);y=n}return w&&y.push(y[0]),y},hk.toShapes=function(R,Z){function x(Y){var h,w,u,X,G,d=[],q=new zh;for(h=0,w=Y.length;w>h;h++)u=Y[h],G=u.args,X=u.action,X==Tn&&0!=q.actions.length&&(d.push(q),q=new zh),q[X].apply(q,G);return 0!=q.actions.length&&d.push(q),d}function d(f){for(var b=[],L=0,T=f.length;T>L;L++){var E=f[L],M=new lp;M.actions=E.actions,M.curves=E.curves,b.push(M)}return b}function y(a,k){for(var i=1e-10,E=k.length,W=!1,$=E-1,K=0;E>K;$=K++){var s=k[$],M=k[K],w=M.x-s.x,p=M.y-s.y;if(v(p)>i){if(0>p&&(s=k[K],w=-w,M=k[$],p=-p),a.y<s.y||a.y>M.y)continue;if(a.y==s.y){if(a.x==s.x)return!0}else{var e=p*(a.x-s.x)-w*(a.y-s.y);if(0==e)return!0;if(0>e)continue;W=!W}}else{if(a.y!=s.y)continue;if(M.x<=a.x&&a.x<=s.x||s.x<=a.x&&a.x<=M.x)return!0}}return W}var p=x(this.actions);if(0==p.length)return[];if(Z===!0)return d(p);var H,g,E,f=[];if(1==p.length)return g=p[0],E=new lp,E.actions=g.actions,E.curves=g.curves,f.push(E),f;var I=!de.isClockWise(p[0].getPoints());I=R?!I:I;var K,J=[],U=[],G=[],Q=0;U[Q]=W,G[Q]=[];var F,l;for(F=0,l=p.length;l>F;F++)g=p[F],K=g.getPoints(),H=de.isClockWise(K),H=R?!H:H,H?(!I&&U[Q]&&Q++,U[Q]={s:new lp,p:K},U[Q].s.actions=g.actions,U[Q].s.curves=g.curves,I&&Q++,G[Q]=[]):G[Q].push({h:g,p:K[0]});if(!U[0])return d(p);if(U.length>1){for(var X=!1,V=[],z=0,$=U.length;$>z;z++)J[z]=[];for(var z=0,$=U.length;$>z;z++){U[z];for(var b=G[z],h=0;h<b.length;h++){for(var B=b[h],t=!0,a=0;a<U.length;a++)y(B.p,U[a].p)&&(z!=a&&V.push({froms:z,tos:a,hole:h}),t?(t=!1,J[a].push(B)):X=!0);t&&J[z].push(B)}}V.length>0&&(X||(G=J))}var n,q,P;for(F=0,l=U.length;l>F;F++)for(E=U[F].s,f.push(E),n=G[F],q=0,P=n.length;P>q;q++)E.holes.push(n[q].h);return f};var lp=function(){zh.apply(this,arguments),this.holes=[]},wp=lp.prototype=wc(hk);wp.getPointsHoles=function(B){var C,n=this.holes.length,X=[];for(C=0;n>C;C++)X[C]=this.holes[C].getTransformedPoints(B);return X},wp.extractAllPoints=function(g){return{shape:this.getTransformedPoints(g),holes:this.getPointsHoles(g)}},wp.extractPoints=function(q){return this.extractAllPoints(q)};var de={triangulateShape:function(G,j){function o(T,S,b){return T.x!=S.x?T.x<S.x?T.x<=b.x&&b.x<=S.x:S.x<=b.x&&b.x<=T.x:T.y<S.y?T.y<=b.y&&b.y<=S.y:S.y<=b.y&&b.y<=T.y}function Q(J,Y,n,h,M){var r=1e-10,c=Y.x-J.x,F=Y.y-J.y,u=h.x-n.x,O=h.y-n.y,t=J.x-n.x,a=J.y-n.y,U=F*u-c*O,A=F*t-c*a;if(v(U)>r){var E;if(U>0){if(0>A||A>U)return[];if(E=O*t-u*a,0>E||E>U)return[]}else{if(A>0||U>A)return[];if(E=O*t-u*a,E>0||U>E)return[]}if(0==E)return!M||0!=A&&A!=U?[J]:[];if(E==U)return!M||0!=A&&A!=U?[Y]:[];if(0==A)return[n];if(A==U)return[h];var V=E/U;return[{x:J.x+V*c,y:J.y+V*F}]}if(0!=A||O*t!=u*a)return[];var l=0==c&&0==F,z=0==u&&0==O;if(l&&z)return J.x!=n.x||J.y!=n.y?[]:[J];if(l)return o(n,h,J)?[J]:[];if(z)return o(J,Y,n)?[n]:[];var b,W,g,S,j,K,p,N;return 0!=c?(J.x<Y.x?(b=J,g=J.x,W=Y,S=Y.x):(b=Y,g=Y.x,W=J,S=J.x),n.x<h.x?(j=n,p=n.x,K=h,N=h.x):(j=h,p=h.x,K=n,N=n.x)):(J.y<Y.y?(b=J,g=J.y,W=Y,S=Y.y):(b=Y,g=Y.y,W=J,S=J.y),n.y<h.y?(j=n,p=n.y,K=h,N=h.y):(j=h,p=h.y,K=n,N=n.y)),p>=g?p>S?[]:S==p?M?[]:[j]:N>=S?[j,W]:[j,K]:g>N?[]:g==N?M?[]:[b]:N>=S?[b,W]:[b,K]}function H($,o,J,G){var q=1e-10,P=o.x-$.x,M=o.y-$.y,d=J.x-$.x,c=J.y-$.y,Y=G.x-$.x,s=G.y-$.y,Q=P*c-M*d,l=P*s-M*Y;if(v(Q)>q){var y=Y*c-s*d;return Q>0?l>=0&&y>=0:l>=0||y>=0}return l>0}function B(X,$){function q(F,i){var v=K.length-1,O=F-1;0>O&&(O=v);var m=F+1;m>v&&(m=0);var S=H(K[F],K[O],K[m],k[i]);if(!S)return!1;var l=k.length-1,D=i-1;0>D&&(D=l);var X=i+1;return X>l&&(X=0),S=H(k[i],k[D],k[X],K[F]),S?!0:!1}function D(R,j){var s,N,n;for(s=0;s<K.length;s++)if(N=s+1,N%=K.length,n=Q(R,j,K[s],K[N],!0),n.length>0)return!0;return!1}function d(i,w){var v,H,X,O,h;for(v=0;v<I.length;v++)for(H=$[I[v]],X=0;X<H.length;X++)if(O=X+1,O%=H.length,h=Q(i,w,H[X],H[O],!0),h.length>0)return!0;return!1}for(var k,U,Z,h,x,Y,V,r,j,t,z,K=X.concat(),I=[],E=[],u=0,G=$.length;G>u;u++)I.push(u);for(var s=0,g=2*I.length;I.length>0&&(g--,!(0>g));)for(Z=s;Z<K.length;Z++){h=K[Z],U=-1;for(var u=0;u<I.length;u++)if(Y=I[u],V=h.x+":"+h.y+":"+Y,E[V]===W){k=$[Y];for(var T=0;T<k.length;T++)if(x=k[T],q(Z,T)&&!D(h,x)&&!d(h,x)){U=T,I.splice(u,1),r=K.slice(0,Z+1),j=K.slice(Z),t=k.slice(U),z=k.slice(0,U+1),K=r.concat(t).concat(z).concat(j),s=Z;break}if(U>=0)break;E[V]=!0}if(U>=0)break}return K}for(var a,h,A,Y,z,p,N={},J=G.concat(),Z=0,I=j.length;I>Z;Z++)Array.prototype.push.apply(J,j[Z]);for(a=0,h=J.length;h>a;a++)z=J[a].x+":"+J[a].y,N[z]!==W,N[z]=a;var d=B(G,j),b=xh.Triangulate(d,!1);for(a=0,h=b.length;h>a;a++)for(Y=b[a],A=0;3>A;A++)z=Y[A].x+":"+Y[A].y,p=N[z],p!==W&&(Y[A]=p);return b.concat()},isClockWise:function(V){return xh.Triangulate.area(V)<0},b2p0:function(b,d){var j=1-b;return j*j*d},b2p1:function(E,P){return 2*(1-E)*E*P},b2p2:function(x,a){return x*x*a},b2:function(y,G,z,P){return this.b2p0(y,G)+this.b2p1(y,z)+this.b2p2(y,P)},b3p0:function(C,U){var W=1-C;return W*W*W*U},b3p1:function(m,d){var u=1-m;return 3*u*u*m*d},b3p2:function(X,W){var h=1-X;return 3*h*X*X*W},b3p3:function(A,v){return A*A*A*v},b3:function(J,F,D,j,L){return this.b3p0(J,F)+this.b3p1(J,D)+this.b3p2(J,j)+this.b3p3(J,L)}},xh={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var G=o.keys(this.faces);return G.length?G[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(x){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(Z){var U=Z.familyName.toLowerCase(),P=this;return P.faces[U]=P.faces[U]||{},P.faces[U][Z.cssFontWeight]=P.faces[U][Z.cssFontWeight]||{},P.faces[U][Z.cssFontWeight][Z.cssFontStyle]=Z,Z},drawText:function(n){var y,C=this.getFace(),i=this.size/C.resolution,K=0,$=String(n).split(""),V=$.length,T=[];for(y=0;V>y;y++){var r=new zh,Z=this.extractGlyphPoints($[y],C,i,K,r);Z&&(K+=Z.offset*this.spacing,T.push(Z.path))}var M=K/2;return{paths:T,offset:M}},extractGlyphPoints:function(o,F,Q,A,r){var y,M,d,K,l,S,u,s,T,D,x,L,W,H,R,m,g,b,f,e=[],J=F.glyphs[o]||F.glyphs["?"];if(J){if(J.o)for(K=J._cachedOutline||(J._cachedOutline=J.o.split(" ")),S=K.length,u=Q,s=Q,y=0;S>y;)switch(l=K[y++]){case"m":T=K[y++]*u+A,D=K[y++]*s,r.moveTo(T,D);break;case"l":T=K[y++]*u+A,D=K[y++]*s,r.lineTo(T,D);break;case"q":if(x=K[y++]*u+A,L=K[y++]*s,R=K[y++]*u+A,m=K[y++]*s,r.quadraticCurveTo(R,m,x,L),f=e[e.length-1])for(W=f.x,H=f.y,M=1,d=this.divisions;d>=M;M++){var Z=M/d;de.b2(Z,W,R,x),de.b2(Z,H,m,L)}break;case"b":if(x=K[y++]*u+A,L=K[y++]*s,R=K[y++]*u+A,m=K[y++]*s,g=K[y++]*u+A,b=K[y++]*s,r.bezierCurveTo(R,m,g,b,x,L),f=e[e.length-1])for(W=f.x,H=f.y,M=1,d=this.divisions;d>=M;M++){var Z=M/d;de.b3(Z,W,R,g,x),de.b3(Z,H,m,b,L)}}return{offset:J.ha*Q,path:r}}}};xh.generateShapes=function(O,A){A=A||{};var F=A.font;if(F===W&&(F=xh.getDefaultFont(),!F))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var H=A.size!==W?A.size:1,x=A.curveSegments!==W?A.curveSegments:4,G=A.spacing!==W?A.spacing:1,Q=A.weight!==W?A.weight:"normal",b=A.style!==W?A.style:"normal";xh.size=H,xh.divisions=x,xh.face=F,xh.weight=Q,xh.style=b,xh.spacing=G;for(var z=xh.drawText(O),E=z.paths,Y=[],V=0,y=E.length;y>V;V++)Array.prototype.push.apply(Y,E[V].toShapes());return Y},function(R){var A=1e-10,x=function(F,c){var q=F.length;if(3>q)return null;var f,V,z,_=[],D=[],b=[];if(I(F)>0)for(V=0;q>V;V++)D[V]=V;else for(V=0;q>V;V++)D[V]=q-1-V;var w=q,j=2*w;for(V=w-1;w>2;){if(j--<=0)return c?b:_;if(f=V,f>=w&&(f=0),V=f+1,V>=w&&(V=0),z=V+1,z>=w&&(z=0),t(F,f,V,z,w,D)){var Y,K,a,r,T;for(Y=D[f],K=D[V],a=D[z],_.push([F[Y],F[K],F[a]]),b.push([D[f],D[V],D[z]]),r=V,T=V+1;w>T;r++,T++)D[r]=D[T];w--,j=2*w}}return c?b:_},I=function(s){for(var z=s.length,E=0,g=z-1,p=0;z>p;g=p++)E+=s[g].x*s[p].y-s[p].x*s[g].y;return.5*E},t=function(Q,T,$,b,F,L){var q,f,i,z,y,H,R,P,_;if(f=Q[L[T]].x,i=Q[L[T]].y,z=Q[L[$]].x,y=Q[L[$]].y,H=Q[L[b]].x,R=Q[L[b]].y,A>(z-f)*(R-i)-(y-i)*(H-f))return!1;var c,J,v,S,m,l,j,E,O,V,w,t,N,C,d;for(c=H-z,J=R-y,v=f-H,S=i-R,m=z-f,l=y-i,q=0;F>q;q++)if(P=Q[L[q]].x,_=Q[L[q]].y,!(P===f&&_===i||P===z&&_===y||P===H&&_===R)&&(j=P-f,E=_-i,O=P-z,V=_-y,w=P-H,t=_-R,d=c*V-J*O,N=m*E-l*j,C=v*t-S*w,d>=-A&&C>=-A&&N>=-A))return!1;return!0};return R.Triangulate=x,R.Triangulate.area=I,R}(xh),e._typeface_js={faces:xh.faces,loadFace:xh.loadFace};var uj=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},km=uj.prototype={constructor:uj,computeFaceNormals:function(){for(var F=new er,o=new er,T=0,v=this.faces.length;v>T;T++){var D=this.faces[T],s=this.vertices[D.a],r=this.vertices[D.b],S=this.vertices[D.c];F.subVectors(S,r),o.subVectors(s,r),F.cross(o),F.normalize(),D.normal.copy(F)}},computeVertexNormals:function(S){var c,A,$,d,E,b;for(b=new Array(this.vertices.length),c=0,A=this.vertices.length;A>c;c++)b[c]=new er;if(S){var N,o,Z,Q=new er,O=new er;for($=0,d=this.faces.length;d>$;$++)E=this.faces[$],N=this.vertices[E.a],o=this.vertices[E.b],Z=this.vertices[E.c],Q.subVectors(Z,o),O.subVectors(N,o),Q.cross(O),b[E.a].add(Q),b[E.b].add(Q),b[E.c].add(Q)}else for($=0,d=this.faces.length;d>$;$++)E=this.faces[$],b[E.a].add(E.normal),b[E.b].add(E.normal),b[E.c].add(E.normal);for(c=0,A=this.vertices.length;A>c;c++)b[c].normalize();for($=0,d=this.faces.length;d>$;$++)E=this.faces[$],E.vertexNormals[0]=b[E.a].clone(),E.vertexNormals[1]=b[E.b].clone(),E.vertexNormals[2]=b[E.c].clone()},mergeVertices:function(){var e,Z,X,J,E,y,z,M,Q={},G=[],V=[],F=4,r=t(10,F);for(X=0,J=this.vertices.length;J>X;X++)e=this.vertices[X],Z=b(e.x*r)+"_"+b(e.y*r)+"_"+b(e.z*r),Q[Z]===W?(Q[Z]=X,G.push(this.vertices[X]),V[X]=G.length-1):V[X]=V[Q[Z]];var u=[];for(X=0,J=this.faces.length;J>X;X++){E=this.faces[X],E.a=V[E.a],E.b=V[E.b],E.c=V[E.c],y=[E.a,E.b,E.c];for(var _=0;3>_;_++)if(y[_]==y[(_+1)%3]){u.push(X);break}}for(X=u.length-1;X>=0;X--){var Y=u[X];for(this.faces.splice(Y,1),z=0,M=this.faceVertexUvs.length;M>z;z++)this.faceVertexUvs[z].splice(Y,1)}var o=this.vertices.length-G.length;return this.vertices=G,o}},Fl=function(C,k,r,R,x,z,H){this.aX=C,this.aY=k,this.xRadius=r,this.yRadius=R,this.aStartAngle=x,this.aEndAngle=z,this.aClockwise=H};Fl.prototype=wc(zd),Fl.prototype.getPoint=function(J){var d,L=this.aEndAngle-this.aStartAngle;0>L&&(L+=z),L>z&&(L-=z),d=this.aClockwise===!0?this.aEndAngle+(1-J)*(z-L):this.aStartAngle+J*L;var P=this.aX+this.xRadius*s(d),e=this.aY+this.yRadius*R(d);return new _d(P,e)};var bn=function(R,E){this.v1=R,this.v2=E},Xr=bn.prototype=wc(zd);Xr.getPoint=function(i){var N=this.v2.clone().sub(this.v1);return N.multiplyScalar(i).add(this.v1),N},Xr.getPointAt=function(Y){return this.getPoint(Y)},Xr.getTangent=function(){var A=this.v2.clone().sub(this.v1);return A.normalize()};var Al=function(W,b,S){this.v0=W,this.v1=b,this.v2=S};Al.prototype=wc(zd),Al.prototype.getPoint=function(F){var l,E;return l=de.b2(F,this.v0.x,this.v1.x,this.v2.x),E=de.b2(F,this.v0.y,this.v1.y,this.v2.y),new _d(l,E)};var Kk=function(N,E,Q,o){this.v0=N,this.v1=E,this.v2=Q,this.v3=o};Kk.prototype=wc(zd),Kk.prototype.getPoint=function(Y){var p,y;return p=de.b3(Y,this.v0.x,this.v1.x,this.v2.x,this.v3.x),y=de.b3(Y,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new _d(p,y)},wm.create(function(d,Q){this.v1=d,this.v2=Q},function(R){var h=new er;return h.subVectors(this.v2,this.v1),h.multiplyScalar(R),h.add(this.v1),h});var vn=wm.create(function(K,l,j){this.v0=K,this.v1=l,this.v2=j},function(n){var U,L,C;return U=de.b2(n,this.v0.x,this.v1.x,this.v2.x),L=de.b2(n,this.v0.y,this.v1.y,this.v2.y),C=de.b2(n,this.v0.z,this.v1.z,this.v2.z),new er(U,L,C)}),ab=wm.create(function(V,s,j,e){this.v0=V,this.v1=s,this.v2=j,this.v3=e},function(C){var y,u,T;return y=de.b3(C,this.v0.x,this.v1.x,this.v2.x,this.v3.x),u=de.b3(C,this.v0.y,this.v1.y,this.v2.y,this.v3.y),T=de.b3(C,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new er(y,u,T)}),ch=function(d,C,O,p,g,E,Z,h){uj.call(this),p=p!==W?p:.5,g=g!==W?g:.5,h=h!==W?h:1,d=d||8,E=E||0,Z=Z||z;var n,j,B=1,J=h/2,f=[],N=[],F=this.vertices,r=this.faces,k=this.faceVertexUvs;for(j=0;B>=j;j++){var a=[],U=[],e=j/B,K=e*(g-p)+p;for(n=0;d>=n;n++){var o=n/d,P=new er,m=-(o*Z+E);P.z=K*R(m),P.y=-e*h+J,P.x=K*s(m),F.push(P),a.push(F.length-1),U.push(new _d(o,e))}f.push(a),N.push(U)}var l,q,t=(g-p)/h;for(n=0;d>n;n++)for(0!==p?(l=F[f[0][n]].clone(),q=F[f[0][n+1]].clone()):(l=F[f[1][n]].clone(),q=F[f[1][n+1]].clone()),l.setY(x(l.x*l.x+l.z*l.z)*t).normalize(),q.setY(x(q.x*q.x+q.z*q.z)*t).normalize(),j=0;B>j;j++){var G=f[j][n],w=f[j+1][n],y=f[j+1][n+1],v=f[j][n+1],V=l.clone(),i=l.clone(),S=q.clone(),I=q.clone(),X=N[j][n].clone(),b=N[j+1][n].clone(),M=N[j+1][n+1].clone(),T=N[j][n+1].clone();r.push(new gm(G,w,v,[V,i,I])),k[0].push([X,b,T]),r.push(new gm(w,y,v,[i.clone(),S,I.clone()])),k[0].push([b.clone(),M,T.clone()])}if(C&&p>0)for(this.vertices.push(new er(0,J,0)),n=0;d>n;n++){var G=f[0][n],w=f[0][n+1],y=this.vertices.length-1,V=new er(0,1,0),i=new er(0,1,0),S=new er(0,1,0),X=N[0][n].clone(),b=N[0][n+1].clone(),M=new _d(b.x,0);r.push(new gm(G,w,y,[V,i,S],null,1));var A=n/d*z,u=s(A),$=R(A),D=(n+1)/d*z,Q=s(D),_=R(D);k[0].push([new _d(.5+.5*u,.5+.5*$),new _d(.5+.5*Q,.5+.5*_),new _d(.5,.5)])}if(O&&g>0)for(this.vertices.push(new er(0,-J,0)),n=0;d>n;n++){var G=f[j][n+1],w=f[j][n],y=F.length-1,V=new er(0,-1,0),i=new er(0,-1,0),S=new er(0,-1,0),X=N[j][n+1].clone(),b=N[j][n].clone();r.push(new gm(G,w,y,[V,i,S],null,2));var A=n/d*z,u=s(A),$=R(A),D=(n+1)/d*z,Q=s(D),_=R(D);k[0].push([new _d(.5+.5*Q,.5-.5*_),new _d(.5+.5*u,.5-.5*$),new _d(.5,.5)])}};ch.prototype=wc(km);var pc=function(q,w,S,o,L,D,j){uj.call(this),j=j||.5,q=q||16,w=w||16,S=(S!==W?S:0)-X,o=o!==W?o:z,L=L!==W?L:0,D=D!==W?D:X;var Z,O,P=[],U=[],e=this.vertices,p=this.faces,m=this.faceVertexUvs;for(O=0;w>=O;O++){var t=[],u=[];for(Z=0;q>=Z;Z++){var d=Z/q,I=O/w,k=new er;k.x=-j*s(S+d*o)*R(L+I*D),k.y=j*s(L+I*D),k.z=j*R(S+d*o)*R(L+I*D),e.push(k),t.push(e.length-1),u.push(new _d(d,I))}P.push(t),U.push(u)}for(O=0;w>O;O++)for(Z=0;q>Z;Z++){var F=P[O][Z+1],y=P[O][Z],a=P[O+1][Z],N=P[O+1][Z+1],n=e[F].clone().normalize(),r=e[y].clone().normalize(),K=e[a].clone().normalize(),V=e[N].clone().normalize(),G=U[O][Z+1].clone(),_=U[O][Z].clone(),f=U[O+1][Z].clone(),T=U[O+1][Z+1].clone();v(e[F].y)===j?(G.x=(G.x+_.x)/2,p.push(new gm(F,a,N,[n,K,V])),m[0].push([G,f,T])):v(e[a].y)===j?(f.x=(f.x+T.x)/2,p.push(new gm(F,y,a,[n,r,K])),m[0].push([G,_,f])):(p.push(new gm(F,y,N,[n,r,V])),m[0].push([G,_,T]),p.push(new gm(y,a,N,[r.clone(),K,V.clone()])),m[0].push([_.clone(),f,T.clone()]))}};pc.prototype=wc(km);var mi=function(x,$,n,L,A,P){uj.call(this),x=x||.33,$=$||.17,L=L||8,n=n||6,A=A||0,P=P||z;for(var j=new er,O=[],I=[],m=0;L>=m;m++)for(var Z=m/L*z+X,J=0;n>=J;J++){var u=J/n*P+A;j.x=x*s(u),j.z=-x*R(u);var w=new er,d=x+$*s(Z);w.x=d*s(u),w.z=-d*R(u),w.y=$*R(Z),this.vertices.push(w),O.push(new _d(J/n,1-m/L)),I.push(w.clone().sub(j).normalize())}for(var m=1;L>=m;m++)for(var J=1;n>=J;J++){var v=(n+1)*m+J-1,_=(n+1)*(m-1)+J-1,b=(n+1)*(m-1)+J,C=(n+1)*m+J,U=new gm(v,_,C,[I[v].clone(),I[_].clone(),I[C].clone()]);this.faces.push(U),this.faceVertexUvs[0].push([O[v].clone(),O[_].clone(),O[C].clone()]),U=new gm(_,b,C,[I[_].clone(),I[b].clone(),I[C].clone()]),this.faces.push(U),this.faceVertexUvs[0].push([O[_].clone(),O[b].clone(),O[C].clone()])}this.computeFaceNormals()};mi.prototype=wc(km);var Yg=function(u,K,w){return u?(uj.call(this),u=u instanceof Array?u:[u],this.addShapeList(u,K),K.convertYZ!==!1&&Dp(this,w),this.computeFaceNormals(),void 0):(u=[],void 0)},Sc=Yg.prototype=wc(uj.prototype);Sc.addShapeList=function(F,m){for(var Z=F.length,n=0;Z>n;n++){var C=F[n];this.addShape(C,m)}},Sc.addShape=function(P,d){function w(){if(d.bottom)for(var $=0;z>$;$++)F=l[$],v(F[2],F[1],F[0],!0);if(d.top)for($=0;z>$;$++)F=l[$],v(F[0]+N*Q,F[1]+N*Q,F[2]+N*Q,!1)}function x(){var v=0;for(p(b,v),v+=b.length,c=0,J=D.length;J>c;c++)i=D[c],p(i,v),v+=i.length}function p(l,D){for(var i,d,m=l.length;--m>=0;){i=m,d=m-1,0>d&&(d=l.length-1);var P=0,c=Q;for(P=0;c>P;P++){var C=N*P,u=N*(P+1),e=D+i+C,f=D+d+C,g=D+d+u,V=D+i+u;k(e,f,g,V,l,P,c,i,d)}}}function V(m,y,U){O.vertices.push(new er(m,y,U))}function v(g,X,J,L){g+=Y,X+=Y,J+=Y,O.faces.push(new gm(g,X,J,null,null,L?2:1));var t=L?m.generateBottomUV(O,P,d,g,X,J):m.generateTopUV(O,P,d,g,X,J);O.faceVertexUvs[0].push(t)}function k(z,i,M,R,C,Z,o,D,X){z+=Y,i+=Y,M+=Y,R+=Y,O.faces.push(new gm(z,i,R)),O.faces.push(new gm(i,M,R));var w=m.generateSideWallUV(O,P,C,d,z,i,M,R,Z,o,D,X);O.faceVertexUvs[0].push([w[0],w[1],w[3]]),O.faceVertexUvs[0].push([w[1],w[2],w[3]])}var B,X,y,o,A,I=d.amount,r=d.curveSegments||aq,Q=d.steps||1,a=d.extrudePath,h=!1,m=new Rj(d.repeatUVLength,d.boundingBox);a&&(B=a.getSpacedPoints(Q),h=!0,X=d.frames!==W?d.frames:new ve.FrenetFrames(a,Q,!1),y=new er,o=new er,A=new er);var i,c,J,O=this,Y=this.vertices.length,T=P.extractPoints(r),L=T.shape,D=T.holes,$=!de.isClockWise(L);if($){for(L=L.reverse(),c=0,J=D.length;J>c;c++)i=D[c],de.isClockWise(i)&&(D[c]=i.reverse());$=!1}var l=de.triangulateShape(L,D),b=L;for(c=0,J=D.length;J>c;c++)i=D[c],L=L.concat(i);for(var g,F,N=L.length,z=l.length,R=0;N>R;R++)g=L[R],h?(o.copy(X.normals[0]).multiplyScalar(g.x),y.copy(X.binormals[0]).multiplyScalar(g.y),A.copy(B[0]).add(o).add(y),V(A.x,A.y,A.z)):V(g.x,g.y,0);var f;for(f=1;Q>=f;f++)for(R=0;N>R;R++)g=L[R],h?(o.copy(X.normals[f]).multiplyScalar(g.x),y.copy(X.binormals[f]).multiplyScalar(g.y),A.copy(B[f]).add(o).add(y),V(A.x,A.y,A.z)):V(g.x,g.y,I/Q*f);w(),x()};var ve=function(C,P,J,V,X){function O(J,v,C){return c.vertices.push(new er(J,v,C))-1}uj.call(this),P=P||64,J=J||1,V=V||8,X=X||!1;var w,Q,g,n,r,E,o,u,e,j,q,W,K,M,i,v,$,k,N,p,G=[],c=this,_=P+1,D=new er,B=new ve.FrenetFrames(C,P,X),I=B.tangents,S=B.normals,T=B.binormals;for(this.tangents=I,this.normals=S,this.binormals=T,e=0;_>e;e++)for(G[e]=[],n=e/(_-1),u=C.getPointAt(n),w=I[e],Q=S[e],g=T[e],j=0;V>j;j++)r=j/V*z,E=-J*s(r),o=J*R(r),D.copy(u),D.x+=E*Q.x+o*g.x,D.y+=E*Q.y+o*g.y,D.z+=E*Q.z+o*g.z,G[e][j]=O(D.x,D.y,D.z);for(e=0;P>e;e++)for(j=0;V>j;j++)q=X?(e+1)%P:e+1,W=(j+1)%V,K=G[e][j],M=G[q][j],i=G[q][W],v=G[e][W],$=new _d(e/P,j/V),k=new _d((e+1)/P,j/V),N=new _d((e+1)/P,(j+1)/V),p=new _d(e/P,(j+1)/V),this.faces.push(new gm(K,M,v)),this.faceVertexUvs[0].push([$,k,p]),this.faces.push(new gm(M,i,v)),this.faceVertexUvs[0].push([k.clone(),N,p.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};ve.prototype=wc(km),ve.FrenetFrames=function(k,g,c){function m(){j[0]=new er,f[0]=new er,z=Number.MAX_VALUE,J=v(l[0].x),O=v(l[0].y),C=v(l[0].z),z>=J&&(z=J,o.set(1,0,0)),z>=O&&(z=O,o.set(0,1,0)),z>=C&&o.set(0,0,1),X.crossVectors(l[0],o).normalize(),j[0].crossVectors(l[0],X),f[0].crossVectors(l[0],j[0])}var b,z,J,O,C,h,w,o=new er,l=[],j=[],f=[],X=new er,A=new xn,U=g+1,Q=1e-4;for(this.tangents=l,this.normals=j,this.binormals=f,h=0;U>h;h++)w=h/(U-1),l[h]=k.getTangentAt(w),l[h].normalize();for(m(),h=1;U>h;h++)j[h]=j[h-1].clone(),f[h]=f[h-1].clone(),X.crossVectors(l[h-1],l[h]),X.length()>Q&&(X.normalize(),b=d(Ki(l[h-1].dot(l[h]),-1,1)),j[h].applyMatrix4(A.makeRotationAxis(X,b))),f[h].crossVectors(l[h],j[h]);if(c)for(b=d(Ki(j[0].dot(j[U-1]),-1,1)),b/=U-1,l[0].dot(X.crossVectors(j[0],j[U-1]))>0&&(b=-b),h=1;U>h;h++)j[h].applyMatrix4(A.makeRotationAxis(l[h],b*h)),f[h].crossVectors(l[h],j[h])};var tf=function(N,j,Q,d){uj.call(this),j=j||18,Q=Q||0,d=d==S?z:d;for(var $=1/(N.length-1),i=1/j,W=0,A=j;A>=W;W++)for(var n=Q+W*i*d,k=s(n),G=R(n),J=0,o=N.length;o>J;J++){var X=N[J],w=new er;w.x=k*X.x-G*X.y,w.y=G*X.x+k*X.y,w.z=X.z,this.vertices.push(w)}for(var g=N.length,W=0,A=j;A>W;W++)for(var J=0,o=N.length-1;o>J;J++){var y=J+g*W,a=y,O=y+g,k=y+1+g,U=y+1,m=W*i,_=J*$,c=m+i,B=_+$;this.faces.push(new gm(a,U,O)),this.faceVertexUvs[0].push([new _d(m,_),new _d(m,B),new _d(c,_)]),this.faces.push(new gm(O,U,k)),this.faceVertexUvs[0].push([new _d(c,_),new _d(m,B),new _d(c,B)])}this.mergeVertices(),Dp(this),this.computeFaceNormals(),this.computeVertexNormals()};tf.prototype=wc(km);var Mf=function(t,a){a=a||{};var h=xh.generateShapes(t,a);a.amount=a.amount!==W?a.amount:.5,a.convertYZ=!1,a.fill!==!1&&(a.bottom=!0,a.top=!0),Yg.call(this,h,a)
};Mf.prototype=wc(Sc);var ci=n.Node=function(){fb(ci,this)},Zq={X:gr,Y:pj,Z:th},Ad={X:0,Y:1,Z:2},Xo={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},bj=new Mq,Tp="xzy",fs=function(A,q,K){if(q){var r=q[0],P=q[1],F=q[2];"xzy"===K?(pj(A,P),th(A,F),gr(A,r)):"xyz"===K?(th(A,F),pj(A,P),gr(A,r)):"yxz"===K?(th(A,F),gr(A,r),pj(A,P)):"yzx"===K?(gr(A,r),th(A,F),pj(A,P)):"zxy"===K?(pj(A,P),gr(A,r),th(A,F)):"zyx"===K?(gr(A,r),pj(A,P),th(A,F)):(pj(A,P),th(A,F),gr(A,r))}};jj("Node",gi,{ms_ac:["rotationMode","anchorElevation"],ms_edge:!0,_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:Tp,_64O:0,_rotationX:0,_53O:0,_host:S,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return is},_22Q:function(){return jt},getX:function(){return this.p().x},setX:function(W){this.p(W,this.p().y)},getY:function(){return this.p().y},setY:function(a){this.p(this.p().x,a)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(a){this.setAnchor(a,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(u){this.setAnchor(this.getAnchor().x,u)},getScaleX:function(){return this.getScale().x},setScaleX:function(N){this.setScale(N,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(_){this.setScale(this.getScale().x,_)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},setQuaternion:function(p){var $=(new pq).setFromQuaternion(p,pq.ReverseOrder(this.getRotationMode()));return this._applyClosestR3($.x,$.y,$.z)},getQuaternion:function(){var J=new pq,m=new pq,E=new Mq;return function(i){return i||(i=new Mq),this.getEuler(J),J.equals(m)?i.copy(E):i.copy(E.setFromEuler(m.copy(J)))}}(),getEuler:function(v){var W=this.r3();return v||(v=new pq),v.set(W[0],W[1],W[2],pq.ReverseOrder(this.getRotationMode()))},setEuler:function(n){return n=n.clone().reorder(pq.ReverseOrder(this.getRotationMode())),this.r3(n.x,n.y,n.z)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(y,M){ak(y,um(S,S,this.r3(),this.getRotationMode())),this.translate3d(y[0]*M,y[1]*M,y[2]*M)},translateFront:function(t){this.translate3dBy([0,0,1],t)},translateBack:function(P){this.translate3dBy([0,0,-1],P)},translateLeft:function(G){this.translate3dBy([-1,0,0],G)},translateRight:function(B){this.translate3dBy([1,0,0],B)},translateTop:function(o){this.translate3dBy([0,1,0],o)},translateBottom:function(L){this.translate3dBy([0,-1,0],L)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(v,G,J){1===arguments.length&&(G=v[1],J=v[2],v=v[0]),this.p(v,J),this.setElevation(G)},translate3d:function(X,d,R){1===arguments.length&&(d=X[1],R=X[2],X=X[0]),this.translate(X,R),this.setElevation(this._54O+d)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(a,N,Q){1===arguments.length&&(N=a[1],Q=a[2],a=a[0]),this.setSize(a,Q),this.setTall(N)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(e,P,E){var $=this;if(!$._updatingRotation3d){$._updatingRotation3d=1,1===arguments.length&&(P=e[1],E=e[2],e=e[0]);var H=[$._rotationX,-$._64O,$._53O];$._rotationX=e,$._64O=-P,$._53O=E,$.fp("rotation3d",H,[e,P,E]),delete $._updatingRotation3d}},_applyClosestR3:function(){function C(v){return v%=z,0>v&&(v+=z),v>X?z-v:v}function G(b,E){return C(b[0]-E[0])+C(b[1]-E[1])+C(b[2]-E[2])}return function(C,V,Z){var U,A,z,v=this.r3(),W=this.getRotationMode();"xzy"===W||"yzx"===W?(U=C>0?C-X:C+X,A=V>0?V-X:V+X,z=Z>0?X-Z:-X-Z):"xyz"===W||"zyx"===W?(U=C>0?C-X:C+X,z=Z>0?Z-X:Z+X,A=V>0?X-V:-X-V):("yxz"===W||"zxy"===W)&&(z=Z>0?Z-X:Z+X,A=V>0?V-X:V+X,U=C>0?X-C:-X-C),G([U,A,z],v)<G([C,V,Z],v)?this.r3(U,A,z):this.r3(C,V,Z)}}(),setRotationY:function($){this.setRotation(-$)},getRotationY:function(){return-this._64O},lookAtDirection:function(u,Y){Y=Y||sl;var $=this,V=_h(u);Y===sl?($.r3([-U(u[1]/V),-db(u[2],u[0])+Rr,0]),$.setRotationMode("xzy")):Y===_k?($.r3(0,-db(u[2],u[0]),U(u[1]/V)),$.setRotationMode("zyx")):Y===Vn?($.r3(0,-db(u[2],u[0])+X,-U(u[1]/V)),$.setRotationMode("zyx")):Y===Dr?($.r3([-U(u[1]/V)+Rr,-db(u[2],u[0])+Rr,0]),$.setRotationMode("xzy")):Y===Er&&($.r3([-U(u[1]/V)-Rr,-db(u[2],u[0])+Rr,0]),$.setRotationMode("xzy")),Y===$i&&($.r3([-U(u[1]/V)+X,-db(u[2],u[0])+Rr,X]),$.setRotationMode("zxy"))},lookAt:function(R,P){return this.lookAtDirection(Od(R,this.p3()),P)},lookAtX:function(){var i=new se,P=new se,Q=new se,o=new xn,j=new xn,r=new pq;return function(D,L){var t=tp(this);if(o.fromArray(t),Q.copy(this.p3()),i.copy(D).sub(Q),!(i.lengthSq()<1e-6)){i.normalize(),L=L||sl,"string"==typeof L?L===sl?P.set(0,0,1):L===$i?P.set(0,0,-1):L===Vn?P.set(-1,0,0):L===_k?P.set(1,0,0):L===Dr?P.set(0,1,0):L===Er&&P.set(0,-1,0):P.copy(L).normalize(),P.applyMatrix4(o).sub(Q).normalize();var A=Math.acos(i.dot(P));if(A){var h=i.clone().cross(P);h.lengthSq()<1e-6&&(L===Dr||L===Er||0===L[0]&&0===L[1]?h.set(0,0,1).applyMatrix4(o).sub(Q):h.set(0,1,0).applyMatrix4(o).sub(Q)),h.normalize(),r.set(this.r3(),this.getRotationMode(),!0),o.makeRotationFromEuler(r),j.makeRotationAxis(h,-A),r.setFromRotationMatrix(j.multiply(o)),this._applyClosestR3(r.x,r.y,r.z)}}}}(),getHost:function(){return this._host},setHost:function(u){var Q=this;if(Q!==u&&Q._host!==u){var f=Q._host;f&&(f._removeAttach(Q),f.updateLayoutAttaches()),Q._host=u,Q._host&&(Q._host._addAttach(Q),Q._host.updateLayoutAttaches()),Q.fp("host",f,u),Q.onHostChanged(f,u)}},getAttaches:function(){return this._69O},_addAttach:function(e){var A=this;A._69O||(A._69O=new Xd),A._69O.add(e),A.fp("attaches",S,e)},_removeAttach:function(Z){var k=this;k._69O.remove(Z),k._69O.isEmpty()&&delete k._69O,k.fp("attaches",Z,S)},getImage:function(){if(this._pendingCheckImageJSON){var D=H.getImage(this._image);D&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof bs&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(Z){var T=this,L=T._image,v=T.getWidth(),I=T.getHeight();if(T._image=Z,T.fp("image",L,Z)){if(null!=Z&&(Il(Z)||xd(Z)&&/\.json$/i.test(Z))&&(this._pendingCheckImageJSON=!0),Dg)return;T.fp(ye,v,T.getWidth()),T.fp(yg,I,T.getHeight())}},getElevation:function(){return this._54O},setElevation:function(p){var f=this;if(!f._50O){f._50O=1;var z=f._54O;f._54O=p,f.fp(Ee,z,p),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(y){var m=this;if(!m._49O){m._49O=1;var i=m._64O;m._64O=y,m.fp(vm,i,y),delete m._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(t){var H=this;if(!H._51O){H._51O=1;var d=H._rotationX;H._rotationX=t,H.fp("rotationX",d,t),delete H._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(I){var K=this;if(!K._52O){K._52O=1;var A=K._53O;K._53O=I,K.fp("rotationZ",A,I),delete K._52O}},getPosition:function(){return this._position},setPosition:function(M,y){var D=this;if(!D._50I){D._50I=1;var u;if(u=2===arguments.length?{x:M,y:y}:M,u.x!==D._position.x||u.y!==D._position.y){var Q=D._position;D._position=u,D.fp(ks,Q,u)}delete D._50I}},translate:function(q,z){var D=this._position;this.p(D.x+q,D.y+z)},hasInheritedSize:function(){var E=this,Z=E.getStyle("shape3d");if(Z){var U=Wq(Z);if(U&&U.rawS3)return!0;if(("billboard"===Z||"plane"===Z)&&Fr(E.getStyle("shape3d.image")))return!0}return E.hasOwnProperty("_image")&&Fr(E._image)?!0:!1},getWidth:function(){var v=this;if(v._width>=0)return v._width;var t=v.getStyle("shape3d");if(t){var Y=Wq(t);if(Y&&Y.rawS3)return Y.rawS3[0];if("billboard"===t||"plane"===t){var y=Fr(v.getStyle("shape3d.image"));return y?lm(y,v):20}}var y=Fr(v._image);return y?lm(y,v):20},setWidth:function(O){var v=this,g=v._width;v._width=O,v.fp(ye,g,O)},getHeight:function(){var T=this;if(T._height>=0)return T._height;var P=T.getStyle("shape3d");if(P){var O=Wq(P);if(O&&O.rawS3)return O.rawS3[2];if("plane"===P){var L=Fr(T.getStyle("shape3d.image"));return L?qj(L,T):20}if("billboard"===P)return 2}var L=Fr(T._image);return L?qj(L,T):20},setHeight:function(l){var b=this,A=b._height;b._height=l,b.fp(yg,A,l)},getTall:function(){var Z=this;if(Z._tall>=0)return Z._tall;var O=Z.getStyle("shape3d");if(O){var f=Wq(O);if(f&&f.rawS3)return f.rawS3[1];if("billboard"===O){var n=Fr(Z.getStyle("shape3d.image"));return n?qj(n,Z):20}if("plane"===O)return 2}return 20},setTall:function(z){var Z=this,r=Z._tall;Z._tall=z,Z.fp("tall",r,z)},setSize:function(h,o){var r=this;2===arguments.length?(r.setWidth(h),r.setHeight(o)):(r.setWidth(h.width),r.setHeight(h.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(I,O,E,m,r){var v=this,x=v.getAnchor(),A=v.getScale();arguments.length<=2&&(r=O,O=I.y,E=I.width,m=I.height,I=I.x);var o=r&&A.x<0?1-x.x:x.x,C=r&&A.y<0?1-x.y:x.y;v.p(I+E*o,O+m*C),r&&(E/=Math.abs(A.x),m/=Math.abs(A.y)),v.setWidth(E),v.setHeight(m)},getMatrix:function(){var l=this,J=l._64O,k=l._position,m=l.getScale();return new ur(J,k.x,k.y,m.x,m.y)},getMatrix4:function(){var a=new se,f=new Mq,c=new se;return function(C){return this.getQuaternion(f),a.copy(this.p3()),c.copy(this.getFinalScale3d()),C||(C=new xn),C.compose(a,f,c)}}(),getAnchorRect:function(){var t=this,s=t.getWidth(),T=t.getHeight(),o=t.getAnchor();return{x:-s*o.x,y:-T*o.y,width:s,height:T}},toLocal:function(o){return this.getMatrix().tfi(o)},toGlobal:function(Y){return this.getMatrix().tf(Y)},getAttachPosition:function(){var M=new ur;return function(T,x,P,$){P=P||0,$=$||0;var V=this,g=V.getAnchor(),e=V._64O,A=V._position,i=V.getScale();return M.setFromTransform(e,A.x,A.y).tf({x:P+i.x*V.getWidth()*(T-g.x),y:$+i.y*V.getHeight()*(x-g.y)})}}(),isInRect:function(d){d=this.toLocal(d);var S=this.getWidth(),n=this.getHeight();return d.x+=S*this.getAnchorX(),d.y+=n*this.getAnchorY(),!(d.x<0||d.y<0||d.x>S||d.y>n)},getRect:function(){var o=this,f=o.getWidth(),s=o.getHeight(),t=o.getAnchor(),_={x:-f*t.x,y:-s*t.y,width:f,height:s},O=o.getMatrix();return _=Wk([O.tf(_.x,_.y),O.tf(_.x+_.width,_.y),O.tf(_.x+_.width,_.y+_.height),O.tf(_.x,_.y+_.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var g=this,P=g.getAnchor(),s=g._anchorElevation;return{x:P.x,y:s,z:P.y}},setAnchorElevation:function(c){var p=this,U=p._anchorElevation;return U!==c?(p._anchorElevation=c,p.fp("anchorElevation",U,c),!0):!1},setAnchor3d:function(h,x,z,D){var A,X=this;"number"==typeof h?A={x:h,y:x,z:z}:(A=h.length?{x:h[0],y:h[1],z:h[2]}:h,D=x),X.beginTransaction();var P=X.getAnchor3d(),w=X.setAnchor(A.x,A.z);if(X.setAnchorElevation(A.y)&&(w=!0),w&&D&&!Dg){X.getAnchor3d();var u=tp(X),T=ak([A.x-P.x,A.y-P.y,A.z-P.z],u);X.p3(T)}return X.endTransaction(),w},getAnchor:function(){var q=this;if(q.hasOwnProperty("_anchor"))return q._anchor;var c=Fr(q._image);return c&&c.anchorX!==W?{x:c.anchorX,y:c.anchorY}:q._anchor},setAnchor:function(M,t,O){var f,V=this;"number"==typeof M?f={x:M,y:t}:(f=M.length?{x:M[0],y:M[1]}:M,O=t);var b=V.getAnchor();if(b.x!==f.x||b.y!==f.y){if(V.beginTransaction(),V._anchor=f,V.fp("anchor",b,f),O&&!Dg){var v=V.getPosition(),L=V.getSize(),n=V.getRotation(),r=V.getScale(),U=-L.width*(b.x-f.x)*r.x,z=-L.height*(b.y-f.y)*r.y,o=R(n),_=s(n);V.setPosition(v.x+_*U-o*z,v.y+o*U+_*z)}return V.endTransaction(),!0}return!1},getLocalQuaternion:function(i){var j=this,g=j.getHost();if(!g)return j.getQuaternion(i);var h=g.getQuaternion(),I=j.getQuaternion();return i||(i=new Mq),i.copy(h).inverse().multiply(I)},setLocalQuaternion:function(Q){var e=this,d=e.getHost();if(!d)return e.setQuaternion(Q);var A=d.getQuaternion();e.setQuaternion(A.clone().multiply(Q))},getLocalEuler:function(){var G=new Mq;return function(k){var e=this,y=e.getHost();return y?(e.getLocalQuaternion(G),k||(k=new pq),k.setFromQuaternion(G,pq.ReverseOrder(this.getRotationMode()))):e.getEuler(k)}}(),setLocalEuler:function(){var y=new Mq;return function(C){var s=this,G=s.getHost();return G?(y.setFromEuler(C),s.setLocalQuaternion(y)):s.setEuler(C)}}(),getLocalPosition3d:function(B){var P=this;B||(B=new se),B.copy(P.p3());var M=P.getHost();if(!M)return B;var O=M.getMatrix4();return B.applyMatrix4(O.getInverse(O))},setLocalPosition3d:function(n){var j=this,i=j.getHost();if(!i)return n.x!==W?j.p3(n.x,n.y,n.z):j.p3(n),void 0;var F=i.getMatrix4(),o=new se(n);o.applyMatrix4(F),j.p3(o.x,o.y,o.z)},getScale:function(){return this._scale},setScale:function(Y,F){var Q,M=this;Q=2===arguments.length?{x:Y,y:F}:Y;var i=M.getScale();(i.x!==Q.x||i.y!==Q.y)&&(M._scale=Q,M.fp("scale",i,Q))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var f=this,H=f._scaleTall,v=f.getScale();return[v.x,H,v.y]},getFinalScale3d:function(){var r=this,G=r.s3(),_=r._dynamicScale3d,U=r.getScale3d();return G&&(U[0]*=G[0],U[1]*=G[1],U[2]*=G[2]),_&&(U[0]*=_[0],U[1]*=_[1],U[2]*=_[2]),U},getFinalRotation3d:function(){var u=this;return u._dynamicRotation||u.r3()},setScaleTall:function(y){var w=this,O=w._scaleTall;O!==y&&(w._scaleTall=y,w.fp("scaleTall",O,y))},setScale3d:function(z,v,$){var A,P=this;A="number"==typeof z?{x:z,y:v,z:$}:z.length?{x:z[0],y:z[1],z:z[2]}:z,P.setScaleTall(A.y),P.setScale(A.x,A.z)},getCorners:function(U,H){U==S&&(U=0),H==S&&(H=U);var r=this,C=r.getAnchor(),c=r.getWidth(),t=r.getHeight(),j=-c*C.x-U,a=-t*C.y-H,Z=c+2*U,o=t+2*H,D=r.getMatrix();return[D.tf(j,a),D.tf(j,a+o),D.tf(j+Z,a+o),D.tf(j+Z,a)]},getEditControlPoints:function(X,J,B){J==S&&(J=0),B==S&&(B=J);var E=this,k=E.getAnchor(),M=E.getWidth(),G=E.getHeight(),x=-M*k.x-J,j=-G*k.y-B,c=M+2*J,m=G+2*B;if(X)return[{x:x,y:j},{x:x,y:0},{x:x,y:j+m},{x:0,y:j+m},{x:x+c,y:j+m},{x:x+c,y:0},{x:x+c,y:j},{x:0,y:j}];var v=E.getMatrix();return[v.tf(x,j),v.tf(x,0),v.tf(x,j+m),v.tf(0,j+m),v.tf(x+c,j+m),v.tf(x+c,0),v.tf(x+c,j),v.tf(0,j)]},rotateAt:function(D,K,P){var n=this,m=n._position,U=n._64O,O=new ur(U,m.x,m.y).tf(D,K),c=x(D*D+K*K),T=db(m.y-O.y,m.x-O.x)+P;n.setRotation(U+P),n.p(O.x+c*s(T),O.y+c*R(T))},rotateAroundAxis:function(b,h){this.setQuaternion(this.getQuaternion().multiply(bj.setFromAxisAngle(b,h)))},rotateAroundWorldAxis:function(B,e){this.setQuaternion(this.getQuaternion().premultiply(bj.setFromAxisAngle(B,e)))},rotateX:function(u){return this.rotateAroundAxis(se.AxisX,u)},rotateY:function(R){return this.rotateAroundAxis(se.AxisY,R)},rotateZ:function(o){return this.rotateAroundAxis(se.AxisZ,o)},onParentChanged:function(){ci.superClass.onParentChanged.apply(this,arguments),this._8I()},onPropertyChanged:function(){var T={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(E){T[E]=!0}),function(v){var f=this;ci.superClass.onPropertyChanged.call(f,v);var L=v.property;if(T[L]&&!f._layoutUpdating&&f.updateLayoutParameters(null,L),f._69O&&f._69O.each(function(V){V.handleHostPropertyChange(v)}),f._49I&&f._49I.each(function(z){z.fp("agentChange",!0,!1)}),gq[L]&&this.updateLayoutAttaches(),"a:layout"===L.substring(0,8)){this.updateLayoutAttaches();var q=f._host;q&&q.updateLayoutAttaches()}("s:shape3d.autorotate"===L||"s:autorotate"===L||"s:shape3d.fixSizeOnScreen"===L||"s:fixSizeOnScreen"===L||"s:hide.overlapping.group"===L)&&(f._47Q=f.s("autorotate")||f.s("shape3d.autorotate")||f.s("fixSizeOnScreen")||f.s("shape3d.fixSizeOnScreen")||f.s("hide.overlapping.group"))}}(),onHostChanged:function(){this.updateAttach(),this.updateLayoutParameters()},handleHostPropertyChange:function(N){this.updateAttach(N)},onStyleChanged:function(Y){ci.superClass.onStyleChanged.apply(this,arguments),rc[Y]&&this.updateAttach()},updateLayoutAttaches:function(){if(!Dg&&this.s("vector.layoutable")){var z,X,C=this;return z=Fr(C.getImage()),z&&z.layoutAttach&&(X=z.layoutAttach,X&&X(C))?!0:void 0}},updateAttach:function(I){var K=this;return Dg?(K.updateLayoutParameters(),void 0):(K._51I||(K._51I=1,K._71O(I),delete K._51I),void 0)},_71O:function(Z){var R,V,X,r,L,h,B=this,g=B._host,E=Z?Z.property:S,A=Z?Z.oldValue:S,i=Z?Z.newValue:S;if(g instanceof ci&&(!Z||gq[E])){var T;if(T=Fr(g.getImage()),T&&T.layoutAttach)return}if(g instanceof n.Grid){if(E===Ee)B.setElevation(B._54O+i-A);else if(!Z||Hi[E]){if(R=B.s("attach.row.index"),V=B.s("attach.column.index"),X=g.getCellRect(R,V),!X)return;r=B.s("attach.row.span"),L=B.s("attach.column.span"),(1!==r||1!==L)&&(X=Mc(X,g.getCellRect(R+r-1,V+L-1))),rf(X,B,"attach.padding",1),B.setRect(X)}}else if(g instanceof Fb&&(h=B.s("attach.index"))>=0&&(!Z||nk[E])){var C=B.s("attach.thickness"),p=g.getScale(),G=Math.max(p.x,p.y);C>0&&B.setHeight(g.getThickness()*C*G);var D=B.s("attach.offset"),c=g.getPoints(),y=c.size();if(y>h){var H=g.getPointsMatrix2d(),w=c.get(h),d=y===h+1?c.get(0):c.get(h+1);w=H.apply(w),d=H.apply(d);var m=[d.x-w.x,d.y-w.y],l=_h(m);if(l){B.s("attach.offset.relative")&&(D*=l),B.s("attach.offset.opposite")&&(D=l-D);var M={x:w.x+m[0]/l*D,y:w.y+m[1]/l*D},$=B.s("attach.gap");$&&(B.s("attach.gap.relative")&&($*=g.getThickness()*G),M=Mo(S,M,d,$)),B.p(M),B.setRotation(db(m[1],m[0]))}}}else Z&&(E===ks?B.translate(i.x-A.x,i.y-A.y):E===Ee?B.setElevation(B._54O+i-A):dn[E]?"rotation3d"===E?B.syncRotation3d(g,i,A):B._11Q(g,E,i-A):("anchor"===E||"width"===E||"height"===E||"scale"===E)&&B.layout(g))},_11Q:function(){var P=new n.Math.Euler,o=n.Math.Euler.ReverseOrder,R=new n.Math.Vector2,p=new n.Math.Vector2;return function(g,D,z){var H=this,u=g.p3(),A=g.r3(),e=H.p3(),w=H.r3();if(D===vm&&(D="rotationY",z=-z),(D===vm||"rotationY"===D)&&0===w[0]&&0===w[2]&&0===A[0]&&0===A[2]&&0===e[1]&&0===u[1])return H.setRotation(-w[1]-z),R.set(e[0],e[2]).rotateAround(p.set(u[0],u[2]),-z),H.p(R.x,R.y),void 0;var Q=Xo[g.getRotationMode()],J=Q[0],s=Q[1],i=Q[2],S=Zq[J],U=Zq[s],j=Zq[i],f=Pb();D===vm+J?(j(f,A[Ad[i]]),U(f,A[Ad[s]]),S(f,z),U(f,-A[Ad[s]]),j(f,-A[Ad[i]])):D===vm+s?(j(f,A[Ad[i]]),U(f,z),j(f,-A[Ad[i]])):D===vm+i&&j(f,z);var l=Od(e,u);ak(l,f),H.p3(u[0]+l[0],u[1]+l[1],u[2]+l[2]);var G=H.getRotationMode();fs(f,H.r3(),G),P.setFromRotationMatrix(f,o(G)),H.r3([P.x,P.y,P.z])}}(),syncRotation3d:function(){var c=new Mq,F=new pq,u=new se;return function(b,l,$){var q=this;if($[0]!==l[0]||$[1]!==l[1]||$[2]!==l[2]){var R=pq.ReverseOrder(b.getRotationMode());bj.setFromEuler(F.set($[0],$[1],$[2],R)),c.setFromEuler(F.set(l[0],l[1],l[2],R)),c.multiply(bj.inverse());var N=b.p3(),D=q.p3();u.set(D[0]-N[0],D[1]-N[1],D[2]-N[2]).applyQuaternion(c),q.p3(N[0]+u.x,N[1]+u.y,N[2]+u.z),q.setQuaternion(q.getQuaternion(bj).premultiply(c))}}}(),isHostOn:function(R){var C=this;if(C._host&&R&&R._69O)for(var Y={},U=C._host;U&&U!==C&&!Y[U._id];){if(U===R)return!0;Y[U._id]=U,U=U._host}return!1},isLoopedHostOn:function(m){return this.isHostOn(m)&&m.isHostOn(this)},getScaledSize:function(){var N=this.getSize(),l=this.getScale();return N.width*=Math.abs(l.x),N.height*=Math.abs(l.y),N},layout:function(E){if(E=E||this.getHost()){var h=this,I=h.s("layout.h")||"center",z=h.s("layout.v")||"center";if("center"!==I||"center"!==z){var T=new n.Math.Vector2,P=E.getPosition(),p=E.getAnchor(),d=E.getScaledSize();h.getPosition();var M,r,A,l,j,y=1,Q=1;switch(h._layoutUpdating=!0,I){case"left":T.setX(h._layoutHValue-p.x*d.width);break;case"right":T.setX((1-p.x)*d.width-h._layoutHValue);break;case"leftright":M=d.width-h._layoutHValue[2],A=h.getRotation()-E.getRotation(),l=Math.abs(Math.sin(A)),j=Math.abs(Math.cos(A)),y+=j*M/h._layoutHValue[3],Q+=l*M/h._layoutHValue[4],T.setX(h._layoutHValue[1]+(h._layoutHValue[5]-p.x)*d.width);break;case"center":T.setX((.5-p.x)*d.width-h._layoutHValue);break;case"scale":A=h.getRotation()-E.getRotation(),l=Math.abs(Math.sin(A)),j=Math.abs(Math.cos(A)),T.setX((.5-p.x)*d.width-h._layoutHValue[1]*d.width/h._layoutHValue[0]),r=d.width/h._layoutHValue[2]-1,y+=j*r,Q+=l*r}switch(z){case"top":T.setY(h._layoutVValue-p.y*d.height);break;case"bottom":T.setY((1-p.y)*d.height-h._layoutVValue);break;case"topbottom":A||(A=h.getRotation()-E.getRotation(),l=Math.abs(Math.sin(A)),j=Math.abs(Math.cos(A))),M=d.height-h._layoutVValue[2],y+=l*M/h._layoutVValue[3],Q+=j*M/h._layoutVValue[4],T.setY(h._layoutVValue[1]+(h._layoutVValue[5]-p.y)*d.height);break;case"center":T.setY((.5-p.y)*d.height-h._layoutVValue);break;case"scale":A||(A=h.getRotation()-E.getRotation(),l=Math.abs(Math.sin(A)),j=Math.abs(Math.cos(A))),T.setY((.5-p.y)*d.height-h._layoutVValue[1]*d.height/h._layoutVValue[0]),r=d.height/h._layoutVValue[2]-1,y+=l*r,Q+=j*r}if("leftright"===I||"scale"===I||"topbottom"===z||"scale"===z){var X=this.getScale(),G=Math.abs(X.x),b=Math.abs(X.y);"leftright"===I||"scale"===I?h.setSize(h._layoutHValue[3]*y/G,h._layoutHValue[4]*Q/b):h.setSize(h._layoutVValue[3]*y/G,h._layoutVValue[4]*Q/b)}T.rotateAround(null,E.getRotation()),this.setPosition(T.x+P.x,T.y+P.y),h._layoutUpdating=W}}},updateLayoutParameters:function(d,f){if(d=d||this.getHost()){var M=this,H=M.s("layout.h"),N=M.s("layout.v");if(H||N){var w,q,x,T,u,V,s=new n.Math.Vector2,I=d.getPosition(),D=d.getAnchor(),e=d.getScaledSize(),U=M.getPosition(),G=M.getScaledSize();switch(s.set(U.x-I.x,U.y-I.y),s.rotateAround(null,-d.getRotation()),H){case"left":M._layoutHValue=s.x+D.x*e.width;break;case"right":M._layoutHValue=-s.x+(1-D.x)*e.width;break;case"center":M._layoutHValue=-s.x+(.5-D.x)*e.width;break;case"leftright":case"scale":"scale"===H?w=-s.x+(.5-D.x)*e.width:(q=M.getAnchor(),x=M.getRotation()-d.getRotation(),T=Math.cos(x),u=Math.sin(x),V=-Math.min(-q.x*T+q.y*u,-q.x*T-(1-q.y)*u,(1-q.x)*T+q.y*u,(1-q.x)*T-(1-q.y)*u),w=s.x-(V-D.x)*e.width),"position"===f&&"object"==typeof M._layoutHValue?(M._layoutHValue[0]=e.width,M._layoutHValue[1]=w):M._layoutHValue=[e.width,w,e.width,G.width,G.height,V]}switch(N){case"top":M._layoutVValue=s.y+D.y*e.height;break;case"bottom":M._layoutVValue=-s.y+(1-D.y)*e.height;break;case"center":M._layoutVValue=-s.y+(.5-D.y)*e.height;break;case"topbottom":case"scale":"scale"===N?w=-s.y+(.5-D.y)*e.height:(x||(q=M.getAnchor(),x=M.getRotation()-d.getRotation(),T=Math.cos(x),u=Math.sin(x)),V=-Math.min(-q.x*u-q.y*T,-q.x*u+(1-q.y)*T,(1-q.x)*u-q.y*T,(1-q.x)*u+(1-q.y)*T),w=s.y-(V-D.y)*e.height),"position"===f&&"object"==typeof M._layoutVValue?(M._layoutVValue[0]=e.height,M._layoutVValue[1]=w):M._layoutVValue=[e.height,w,e.height,G.width,G.height,V]}}}},getSerializableProperties:function(){var K=ci.superClass.getSerializableProperties.call(this);return kk(K,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),K}});var vb=n.Edge=function(k,l){var M=this;fb(vb,M),M.setSource(k),M.setTarget(l)};jj("Edge",gi,{ms_edge:!0,_icon:"edge_icon",getUIClass:function(){return zk},_22Q:function(){return lt},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},canSetSourceTarget:function(G){if(G===this)return!1;if(af(G))return!0;for(var N,l,x,d,p,Q=[this],s=-1,o=0;o>s;)if(s++,N=Q[s],l=N._44I)for(l=l.getArray(),d=0,p=l.length;p>d;d++)if(x=l[d],zl(x)&&!(Q.indexOf(x)>=0)){if(x===G)return!1;Q.push(x),o++}return!0},setSource:function(w){var O=this;if(O._source!==w&&O.canSetSourceTarget(w)){var N=O._source;O._source=w,N&&N._16I(O),w&&w._2I(O),O._7I(),O.fp("source",N,w)}},setTarget:function(v){var y=this;if(y._target!==v&&y.canSetSourceTarget(v)){var o=y._target;y._target=v,o&&o._18I(y),v&&v._4I(y),y._7I(),y.fp("target",o,v)}},isLooped:function(){var h=this;return h._source===h._target&&af(h._source)&&af(h._target)},onPropertyChanged:function(B){var F=this;F._49I&&F._49I.each(function(F){F.fp("agentChange",!0,!1)}),("s:alwaysOnTop"===B.property||"s:shape3d.alwaysOnTop"===B.property)&&(B.newValue?this.setRenderLayer("top"):this.setRenderLayer(W))},_7I:function(){var N,w=this,X=ih(w);w._40I!==X&&(N=this._40I,N&&N._15I(w),w._40I=X,X&&X._1I(w),w.fp("sourceAgent",N,X),Gk(N,w._41I),Gk(X,w._41I));var L=Jl(w);w._41I!==L&&(N=w._41I,N&&N._17I(w),w._41I=L,L&&L._3I(w),w.fp("targetAgent",N,L),Gk(N,w._40I),Gk(L,w._40I))},_22I:function(d){this._52I=d,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var o=this;return o._52I&&o._52I.get(0)!==o&&!o.getStyle(Up)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var b=this,Q=b._52I;return Q&&!b.getStyle(Up)&&Q.size()>1&&b===Q.get(0)},toggle:function(){this.beginTransaction();var E=this._52I,A=!this.s(Up);E&&E.size()>1&&(E.each(function(y){y.s(Up,A)}),E.getSiblings().each(function(m){m!==E&&m.each(function(N){N.fp("edgeGroup",S,m)})})),this.endTransaction()},setStyle:function(x,j){(x===Fd||"edge.segments"===x)&&(j=Lh(j)),vb.superClass.setStyle.call(this,x,j)},onStyleChanged:function(T){vb.superClass.onStyleChanged.apply(this,arguments),Zf[T]&&Gk(this._41I,this._40I)},getSerializableProperties:function(){var z=vb.superClass.getSerializableProperties.call(this);return kk(z,{source:1,target:1}),z}});var Fp=n.Group=function(){fb(Fp,this)};jj("Group",ci,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return Ek},onChildAdded:function(){Fp.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){Fp.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var q=this;if(!q._54I&&!Dg){var P=q.getChildrenRect();P&&(q._53I=1,q.p(Cs(q.s("group.position"),P,q.getSize())),delete q._53I)}},getChildrenRect:function(){var y,z=this;return z.eachChild(function(T){af(T)&&(y=Mc(y,z.getChildRect(T)))}),y},getChildRect:function(N){var w;return af(N)&&N.s(Xc)&&(tl(N)&&N.isExpanded()&&N.eachChild(function(W){w=Mc(w,N.getChildRect(W))}),!w&&N.getRect&&(w=N.getRect())),w},setPosition:function(Z,S){var Y=this;if(!Y._54I){var w;w=2===arguments.length?{x:Z,y:S}:Z,Dg||Y._53I||(Y._54I=1,Qk(Y._children,w.x-Y._position.x,w.y-Y._position.y),delete Y._54I),Fp.superClass.setPosition.call(this,w)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(b){var X=this;if(X._57O!==b){var G=X._57O;X._57O=b,X.fp("expanded",G,X._57O),X._fireInvalidateDeep(),X._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(Z){tl(Z)?Z._fireInvalidateDeep():Z.iv()})},_8I:function(){Fp.superClass._8I.call(this),this.eachChild(function(V){af(V)&&V._8I()})},onStyleChanged:function(v){Fp.superClass.onStyleChanged.apply(this,arguments),"group.position"===v&&this._81I()},getSerializableProperties:function(){var X=Fp.superClass.getSerializableProperties.call(this);return X.expanded=1,X}});var Gr=n.Camera=function(){fb(Gr,this),this.s({"shadow.cast":!1,"shadow.receive":!1,shape3d:"billboard"}),this._viewMatrix=new Po.Matrix4,this._projectMatrix=new Po.Matrix4,this.setScale3d(1,1,-1),this.setCullingMask("main,top"),this._projectMatrixDirty=!0};Gr.CubeDirectionParam=[1,0,0,0,-1,0,-1,0,0,0,-1,0,0,1,0,0,0,1,0,-1,0,0,0,-1,0,0,1,0,-1,0,0,0,-1,0,-1,0],jj("Camera",ci,{_22Q:function(){return Camera3dUI},attachRenderTarget:function(t){this._projectMatrixDirty=!0,this.renderTarget=t},detachRenderTarget:function(){this._projectMatrixDirty=!0,this.renderTarget=null},setCullingMask:function(M){var C=M.split(",");this._cullingMask=If(C)},isLayerVisible:function(b){var u=ej[b];return u&&Lr(this._cullingMask,u.mask)},isOrtho:function(){return"ortho"===this.s("camera.type")&&!this.isCube()},isCube:function(){return this.renderTarget&&this.renderTarget.isCube()},isPerspective:function(){return!this.isOrtho()},setViewMatrix:function(){var W=new n.Math.Matrix4,i=new n.Math.Euler;return function(k){var y=this;k.isMatrix4?y._viewMatrix.copy(k):y._viewMatrix.fromArray(k),W.getInverse(y._viewMatrix),y.p3(W.getPosition().toArray()),i.set(0,0,0,y.getRotationMode(),!0).setFromRotationMatrix(W),y.r3([i.x,i.y,i.z])}}(),getViewMatrix:function(G){var n=this,K=um(null,null,n.r3(),n.getRotationMode(),n.p3()),N=n._viewMatrix;return N.fromArray(K).getInverse(N),N.toArray(G)},setProjectMatrix:function(i){var l=this;i.isMatrix4?l._projectMatrix.copy(i):l._projectMatrix.fromArray(i),i=l._projectMatrix.getElements(),l.isOrtho()?l.s({"camera.near":(i[14]+1)/i[10],"camera.far":(i[14]-1)/i[10],"camera.ortho.width":2/i[0]}):l.s({"camera.near":i[14]/(i[10]-1),"camera.far":i[14]/(i[10]+1),"camera.fovy":2*Math.atan(1/i[5]),"camera.aspect":i[5]/i[0]}),l._projectMatrixDirty=!1},onPropertyChanged:function(H){var p=this;Gr.superClass.onPropertyChanged.call(p,H);var _=H.property;("s:camera.near"===_||"s:camera.far"===_||"s:camera.fovy"===_||"s:camera.aspect"===_||"s:camera.ortho.width"===_)&&(p._projectMatrixDirty=!0)},getProjectMatrix:function(){var b=this;if(b._projectMatrixDirty){var a=b.gv,h=b.isCube(),t=h?1:b.s("camera.aspect")||(a?a.getAspect():null)||H.graph3dViewAspect,A=b.s("camera.near")||(a?a.getNear():null)||H.graph3dViewNear,d=b.s("camera.far")||(a?a.getFar():null)||H.graph3dViewFar,l=Pb();if(b.isOrtho()){var r=b.s("camera.ortho.width")||(a?a.getOrthoWidth():null)||H.graph3dViewOrthoWidth,z=r/2,$=z/t;Jh(l,-z,z,-$,$,A,d)}else{var R=h?Math.PI/2:b.s("camera.fovy")||(a?a.getFovy():null)||H.graph3dViewFovy;Vo(l,R,t,A,d)}b._projectMatrix.fromArray(l),b._projectMatrixDirty=!1}return b._projectMatrix.toArray()},lookAt:function(f,c){var v=this.p3();return f.x?this.lookAtDirection([f.x-v[0],f.y-v[1],f.z-v[2]],c):this.lookAtDirection([f[0]-v[0],f[1]-v[1],f[2]-v[2]],c)},lookAtDirection:function(){var o=new n.Math.Matrix4,H=new n.Math.Euler,J=new n.Math.Vector3,D=new n.Math.Vector3;return function(S,P){o.lookAtDirection(J.copy(S).multiplyScalar(-1),P?D.copy(P):D.set(0,1,0)),H.set(0,0,0,this.getRotationMode(),!0).setFromRotationMatrix(o),this.r3([H.x,H.y,H.z])}}(),updateAndRender:function(K){return K.syncRenderState(),K.updateScene(),this.render(K)},render:function(Y){var l=this,m=Y.getGL();if(!m)return!1;var s,S,B=l.renderTarget;if(B)s=B.width,S=B.height;else{var p=Y.getDevicePixelRatio();s=Y.getWidth()*p,S=Y.getHeight()*p}l.gv=Y,Y._camera=l;var R=Y._frameState.renderState.glState,K=R.color.clear.slice(0);uq(m,l.s("camera.background"));var G=Y.getEye;if(Y.getEye=function(){return l.p3()},l.isCube())for(var u=Gr.CubeDirectionParam,E=0;6>E;E++)B&&B.bind(m,E),l.lookAtDirection([u[6*E+0],u[6*E+1],u[6*E+2]],[u[6*E+3],u[6*E+4],u[6*E+5]]),l.s("camera.clear")!==!1&&m.clear(m.COLOR_BUFFER_BIT),Y.setViewport(m,0,0,s,S),l.s("camera.onlySky")?Y.renderSky():Y.renderScene({renderAxis:l.s("camera.renderAxis"),renderGrid:l.s("camera.renderGrid"),renderEdit:l.s("camera.renderEdit"),renderReflector:!1}),B&&B.unbind(m);else B&&B.bind(m),l.s("camera.clear")!==!1&&m.clear(m.COLOR_BUFFER_BIT),Y.overlappingBox.clear(),Y.setViewport(m,0,0,s,S),l.s("camera.onlySky")?Y.renderSky():Y.renderScene({renderAxis:l.s("camera.renderAxis"),renderGrid:l.s("camera.renderGrid"),renderEdit:l.s("camera.renderEdit")}),B&&B.unbind(m);return Y.getEye=G,uq(m,K),Y._camera=null,l.gv=null,!0}});var $n=n.Block=function(){fb($n,this),this.s({"shadow.cast":!1,"shadow.receive":!1})};jj("Block",ci,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return Tk},_22Q:function(){return kt},onChildAdded:function(){$n.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){$n.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},_getBoundingBox:function(){function F(j,D,Q){A.fromArray(tp(D));var I=D.getAnchor3d();j.push((new se).set(0-I.x,0-I.y,0-I.z).applyMatrix4(A).applyMatrix4(Q)),j.push((new se).set(0-I.x,0-I.y,1-I.z).applyMatrix4(A).applyMatrix4(Q)),j.push((new se).set(0-I.x,1-I.y,0-I.z).applyMatrix4(A).applyMatrix4(Q)),j.push((new se).set(0-I.x,1-I.y,1-I.z).applyMatrix4(A).applyMatrix4(Q)),j.push((new se).set(1-I.x,0-I.y,0-I.z).applyMatrix4(A).applyMatrix4(Q)),j.push((new se).set(1-I.x,0-I.y,1-I.z).applyMatrix4(A).applyMatrix4(Q)),j.push((new se).set(1-I.x,1-I.y,0-I.z).applyMatrix4(A).applyMatrix4(Q)),j.push((new se).set(1-I.x,1-I.y,1-I.z).applyMatrix4(A).applyMatrix4(Q))
}function N(Z,C){var J=(new xn).makeRotationFromEuler(this.getEuler()).setPosition((new se).fromArray(this.p3()));J.getInverse(J),Z.forEach(function(r){af(r)&&F(C,r,J)})}var A=new xn;return function(C,Y){if(C instanceof ci&&(C=[C]),!C||0===C.length)return S;var Y=[];N.call(this,C,Y);var L=[1/0,1/0,1/0],l=[-1/0,-1/0,-1/0];return Y.forEach(function(v){L[0]=Math.min(v.x,L[0]),L[1]=Math.min(v.y,L[1]),L[2]=Math.min(v.z,L[2]),l[0]=Math.max(v.x,l[0]),l[1]=Math.max(v.y,l[1]),l[2]=Math.max(v.z,l[2])}),{min:L,max:l}}}(),updateFromChildren:function(){var U=this;if(!Dg&&!U._updatingToChildren&&U._syncSize&&0!==U.size()&&!U._freezeSyncFromChildren){var o=this._getBoundingBox(U.toChildren(af));if(o){U._updatingFromChildren=1;var a=(new se).fromArray(this.getScale3d()),E=(new se).fromArray(o.min),R=(new se).fromArray(o.max),i=H.blockMinSize,j=new se,M=R.clone().sub(E);0===M.x&&j.setX(.5),0===M.y&&j.setY(.5),0===M.z&&j.setZ(.5);var $=this._width==S||-1===this._width,m=new se(this.getAnchor3d()),z=a.clone().multiply((new se).fromArray(this.s3())),J=M.clone();0===J.x&&J.setX(i),0===J.y&&J.setY(i),0===J.z&&J.setZ(i);var _=m.clone().multiply(z),d=_.clone().multiplyScalar(-1).sub(E).divide(J).add(_.divide(J)).add(j),P=this.s("keepPosition");if($||this._anchorChanged||this._scaleChanged||!P){!$&&P&&(m=d);var r=m.clone().multiply(M).add(E).applyEuler(this.getEuler()).add((new se).fromArray(this.p3()));this.p3([r.x,r.y,r.z])}else this.setAnchor3d(d.x,d.y,d.z);var p=new se(1,1,1).divide(a).multiply(M);this.s3(Math.abs(p.x),Math.abs(p.y),Math.abs(p.z)),delete U._updatingFromChildren}}},setPosition:function(s,p){var _=this;if(!_._updatingToChildren){var O;O=2===arguments.length?{x:s,y:p}:s,Dg||_._updatingFromChildren||(_._updatingToChildren=1,Qk(_._children,O.x-_._position.x,O.y-_._position.y),delete _._updatingToChildren),$n.superClass.setPosition.call(this,O)}},setSize3d:function(){this.beginTransaction(),$n.superClass.setSize3d.apply(this,arguments),this.endTransaction()},setTall:function(A){var t=this;if(!t._updatingToChildren){this.beginTransaction(),A=g(A,H.blockMinSize);var E=t.getTall();if(A!==E&&$n.superClass.setTall.call(t,A),!Dg&&!t._updatingFromChildren){t._updatingToChildren=1;var Q=A/E;t._adjustChildTallOrScale(Q,"size"),delete t._updatingToChildren,t.updateFromChildren()}this.endTransaction()}},setWidth:function(q){return this.setSize(q,this.getHeight())},setHeight:function(A){return this.setSize(this.getWidth(),A)},setSize:function(k,m){var q=H.blockMinSize;k=g(k,q),m=g(m,q);var n=this;if(!n._updatingToChildren){2!==arguments.length&&(m=k.height,k=k.width),this.beginTransaction();var w=n.getWidth(),N=n.getHeight();if(k!==w&&$n.superClass.setWidth.call(n,k),m!==N&&$n.superClass.setHeight.call(n,m),!Dg&&!n._updatingFromChildren){n._updatingToChildren=1;var T=k/w,e=m/N;n._adjustChildScaleOrSize(T,e,"size"),delete n._updatingToChildren,n.updateFromChildren()}this.endTransaction()}},_adjustChildScaleOrSize:function(e,B,I){var A=this;if(A._syncSize){var Y=A.getPosition(),W=A.getRotation();A.eachChild(function(g){if(af(g)){var o=g.getPosition(),M=g.getRotation(),p=g.getWidth(),l=g.getHeight(),f=g.getScale(),S=f.x*p,U=f.y*l;if(0!==S&&0!==U){0>e*B&&g.setRotation(-1*M);var N=new ur(M,o.x,o.y,S,U);N.translate(-Y.x,-Y.y),N.rotate(-W),M=db(N.b*Math.sign(S),N.a*Math.sign(S)),N.scale(e,B);var H,L,O,q=s(M);if(Math.abs(q)<.001?(H=R(M),L=N.b/H,O=-N.c/H):(L=N.a/q,O=N.d/q),"scale"===I)g.setScale(L/p,O/l);else if("size"===I){var j=L/f.x,r=O/f.y;g.setScale(uo(L)*Math.abs(f.x),uo(O)*Math.abs(f.y)),g instanceof n.Shape?(g.setWidthForce(Math.max(Math.abs(j),1e-5)),g.setHeightForce(Math.max(Math.abs(r),1e-5))):g.setSize(Math.max(.01,Math.abs(j)),Math.max(.01,Math.abs(r)))}N.rotate(W),N.translate(Y.x,Y.y),g.setPosition(N.tx,N.ty)}}})}},_calcChangeFactor:function(d,M,y,h){var X,J,P,Y;return X=v(d),J=v(y),P=X>J?X/J:J/X,X=v(M),J=v(h),Y=X>J?X/J:J/X,g(P,Y)},setElevation:function(v){var L=this;if(!L._updatingToChildren){var j=L.getElevation(),e=v-j;0!==e&&(Dg||L._updatingFromChildren||(L._updatingToChildren=1,Qk(L._children,0,e,0),delete L._updatingToChildren),$n.superClass.setElevation.apply(L,arguments))}},setScaleTall:function(X){var E=this;if(!E._updatingToChildren){var T=E.getScaleTall();if(v(X)<.01&&(X=.01*(uo(X)||uo(T))),$n.superClass.setScaleTall.call(E,X),!Dg&&!E._updatingFromChildren){E._updatingToChildren=1;var l=X/T;E._adjustChildTallOrScale(l,"scale"),delete E._updatingToChildren,E._scaleChanged=1,this.updateFromChildren(),delete E._scaleChanged}}},_adjustChildTallOrScale:function(E,z){var K=this;if(K._syncSize){var S=K.getElevation();K.eachChild(function(v){if(af(v)){if("size"===z){var l=v.getTall();0>E&&v.setScaleTall(-1*v.getScaleTall()),v.setTall(Math.max(.01,Math.abs(l*E)))}else{var A=v.getScaleTall();v.setScaleTall(A*E)}v.setElevation(S+(v.getElevation()-S)*E)}})}},setAnchor3d:function(){if(!this._updatingToChildren){this.beginTransaction();var p=$n.superClass.setAnchor3d.apply(this,arguments);return p&&!Dg&&!this._updatingFromChildren&&this._syncSize&&(this._anchorChanged=1,this.updateFromChildren(),delete this._anchorChanged),this.endTransaction(),p}},setAnchor:function(){var E=this;if(!E._updatingToChildren){var H=E.getAnchor(),Z=$n.superClass.setAnchor.apply(E,arguments);if(Dg||E._updatingFromChildren||!E._syncSize)return Z;E._updatingToChildren=1;var J=E.getAnchor(),O=E.getSize(),h=O.width*(H.x-J.x),K=O.height*(H.y-J.y),R=(new xn).compose(new se,this.getQuaternion(),new se(this.getScale3d())),n=new se(h,0,K).applyMatrix4(R);return E.eachChild(function(j){if(af(j)){var B=new se(j.p3());j.p3(B.add(n).toArray())}}),delete E._updatingToChildren,Z}},setAnchorElevation:function(){var s=this;if(!s._updatingToChildren){var w=s.getAnchorElevation(),z=$n.superClass.setAnchorElevation.apply(s,arguments);if(Dg||s._updatingFromChildren||!s._syncSize)return z;s._updatingToChildren=1;var $=s.getAnchorElevation(),R=s.getTall()*(w-$),M=(new xn).compose(new se,this.getQuaternion(),new se(this.getScale3d())),e=new se(0,R,0).applyMatrix4(M);return s.eachChild(function(T){if(af(T)){var L=new se(T.p3());T.p3(L.add(e).toArray())}}),delete s._updatingToChildren,z}},setRotation:function(y){this._updateChildrenRotation3d("rotation",y)},setRotationX:function(u){this._updateChildrenRotation3d("rotationX",u)},setRotationZ:function(s){this._updateChildrenRotation3d("rotationZ",s)},setRotation3d:function(){var s=this;if(!s._updatingToChildren){var A=s.r3();$n.superClass.setRotation3d.apply(s,arguments);var n=s.r3();Dg||s._updatingFromChildren||(s._updatingToChildren=1,s.eachChild(function(M){af(M)&&M.syncRotation3d(s,n,A)}),delete s._updatingToChildren)}},_updateChildrenRotation3d:function($,h){var B=this;if(!B._updatingToChildren){var n=B[lc($)]();$n.superClass[Bc($)].call(B,h),Dg||B._updatingFromChildren||this._updateRotationToChildren($,h-n)}},_updateRotationToChildren:function(C,b){var F=this;F._updatingToChildren=1,F.eachChild(function(V){af(V)&&V._11Q(F,C,b)}),delete F._updatingToChildren},setScale:function(j,X){var Y=this;if(!Y._updatingToChildren){null==X&&(X=j.y,j=j.x);var I=Y.getScale();if(v(j)<.01&&(j=.01*(uo(j)||uo(I.x))),v(X)<.01&&(X=.01*(uo(X)||uo(I.y))),$n.superClass.setScale.call(Y,j,X),!Dg&&!Y._updatingFromChildren){Y._updatingToChildren=1;var C=j/I.x,z=X/I.y;Y._adjustChildScaleOrSize(C,z,"scale"),delete Y._updatingToChildren,Y._scaleChanged=1,Y.updateFromChildren(),delete Y._scaleChanged}}},onPropertyChanged:function(L){$n.superClass.onPropertyChanged.call(this,L),"s:3d.visible"===L.property&&this._invalidateChildrenBatch()},_invalidateChildrenBatch:function(){this.eachChild(function(s){(s.s("batch")||s.s("wf.geometry")||s.s("wf.visible"))&&s.iv(),s instanceof $n&&s._invalidateChildrenBatch()})},getSerializableProperties:function(){var V=$n.superClass.getSerializableProperties.call(this);return V.clickThroughEnabled=1,V.syncSize=1,V}});var Nd=n.Grid=function(){fb(n.Grid,this)};jj("Grid",ci,{IRotatable:!1,_icon:"grid_icon",_image:S,getUIClass:function(){return qo},setRotation:function(){},getCellRect:function(A,Q){var E=this,y=E.s("grid.row.count"),t=E.s("grid.column.count");if(0>=y||0>=t||0>A||A>=y||0>Q||Q>=t)return S;var w,$,B,b=E.getRect(),D=E.s("grid.row.percents"),U=E.s("grid.column.percents");if(rf(b,E,"grid.border",-1),D&&D._as&&(D=D._as),U&&U._as&&(U=U._as),D&&D.length===y){for(B=0,w=0;A>w;w++)B+=b.height*D[w];b.y+=B,b.height=b.height*D[A]}else b.height=b.height/y,b.y+=b.height*A;if(U&&U.length===t){for($=0,w=0;Q>w;w++)$+=b.width*U[w];b.x+=$,b.width=b.width*U[Q]}else b.width=b.width/t,b.x+=b.width*Q;return Qf(b,-E.s("grid.gap")),b}});var To=n.Text=function(){fb(To,this),this.setSize(100,50),this.s("text","TEXT")};jj("Text",ci,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return Gf},setWidth:function(p){p||(p=.001),To.superClass.setWidth.call(this,p)},setHeight:function(K){K||(K=.001),To.superClass.setHeight.call(this,K)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),oi("__text__",{width:{value:100,isSafeFunc:!0,func:function(F){return F?F._width:100}},height:{value:50,isSafeFunc:!0,func:function(Q){return Q?Q._height:50}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"},gradient:{func:"style@text.gradient"},gradientColor:{func:"style@text.gradient.color"},gradientPack:{func:"style@text.gradient.pack"},decoration:{func:"style@text.decoration"},vertical:{func:"style@text.vertical"},verticalGap:{func:"style@text.vertical.gap"},wrap:{func:"style@text.wrap"},letterGap:{func:"style@text.letter.gap"},borderWidth:{func:"style@text.border.width"},borderColor:{func:"style@text.border.color"}}]});var Fb=n.Shape=function(){fb(Fb,this),this._59O=new Xd};Fb.__de__=Ec,jj("Shape",ci,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return Jk},_22Q:function(){return mt},getLength:function(W){return Ke(Wo(this._59O,this._58O,W,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var k=this._58O;return k?new Xd(k._as.slice(0)):k},setSegments:function(g){var S=this._58O;g=g?Td(g)?new Xd(g.slice(0)):new Xd(g._as.slice(0)):null,(S&&g&&S._as.join(",")!==g._as.join(",")||S!==g)&&(this._58O=g,this.fp("segments",S,g))},getPoints:function(){return this._59O},toPoints:function(){var c=this._59O;return new Xd(c._as.slice(0))},getPointsMatrix2d:function(){var n=this,H=new Po.Matrix2d,_=n.getPosition(),b=n.getScale(),q=n.getRotation();return H.translate(-_.x,-_.y).scale(b.x,b.y).rotate(q).translate(_.x,_.y),H},getPointsMatrix3d:function(){return function(){var X=this,E=new Po.Matrix4,C=E.getElements(),u=X.p3();Je(C,u),fs(C,X.getFinalRotation3d(),X.getRotationMode());var A=X.getScale3d(),K=X._dynamicScale3d;return K&&(A[0]*=K[0],A[1]*=K[1],A[2]*=K[2]),Hr(C,A),Je(C,Sn(u)),E}}(),setPoints:function(f,T){var s=this,g=s._59O;f=f?Td(f)?new Xd(f.slice(0)):new Xd(f._as.slice(0)):new Xd;var P,G,o,Y,y,I;T&&(P=s.getPosition(),I=new ur(s.getRotation(),0,0,s.getScale().x,s.getScale().y)),(g&&f&&g._as.join(",")!==f._as.join(",")||g!==f)&&(s._59O=f,s.fs(),s.fp("points",g,f)),T&&(G=s.getPosition(),o=G.x-P.x,Y=G.y-P.y,y=I.tf(o,Y),s.setPosition(G.x-o+y.x,G.y-Y+y.y))},setPoints3d:function(U,D){var d=new se(this.p3()),n=this.getPointsMatrix3d();if(n.setPosition(new se),qb.superClass.setPoints.call(this,U),D){var L=new se(this.p3()),T=L.clone().sub(d).applyMatrix4(n);d.add(T),this.p3(d.x,d.y,d.z)}},addPoint:function(P,v,e){var b=this.toPoints();b.add(P,v),this.setPoints(b,e)},setPoint:function(S,H,n){var k=this.toPoints();k.set(S,H),this.setPoints(k,n)},removePointAt:function(V){var P=this.toPoints();P.removeAt(V),this.setPoints(P)},setWidthForce:function(q){var P=this;if(!P._55I&&!Dg&&P.getWidth()){P._55I=1;var p=P._position.x,R=q/P.getWidth(),C=P.toPoints(),D=new Xd;1!==R&&(C.each(function(s){D.add({x:(s.x-p)*R+p,y:s.y,e:s.e})}),P.setPoints(D),qs(P,[R,0,0,1,p*(1-R),0]),P.fs()),delete P._55I}Fb.superClass.setWidth.call(P,q)},setWidth:function(O){return this.setWidthForce(Gq>O?Gq:O)},setHeightForce:function(e){var w=this;if(!w._55I&&!Dg&&w.getHeight()){w._55I=1;var E=w._position.y,m=e/w.getHeight(),X=w.toPoints(),q=new Xd;1!==m&&(X.each(function(i){q.add({x:i.x,y:(i.y-E)*m+E,e:i.e})}),w.setPoints(q),qs(w,[1,0,0,m,0,E*(1-m)]),w.fs()),delete w._55I}Fb.superClass.setHeight.call(w,e)},setHeight:function(d){return this.setHeightForce(Gq>d?Gq:d)},setAnchorElevation:function(p){var H=this;H._55I=!0;var n=H._updatingAnchor3d,b=!Dg&&!n;if(b){var m,y=p,t=H.getAnchorElevation(),l=H.getTall();m=l*(t-y),0!==m&&H.shiftPointsElevation(m)}var S=Fb.superClass.setAnchorElevation.apply(H,arguments);return n||delete H._55I,S},getShapeElevation:function(){var F=this,O=F._54O;return O-(F.getTall()||0)*(F._anchorElevation-.5)},setAnchor3d:function($,Q,q,O){var K,c=this;if("number"==typeof $?K={x:$,y:Q,z:q}:(K=$.length?{x:$[0],y:$[1],z:$[2]}:$,O=Q),c._55I=!0,c._updatingAnchor3d=!0,c.beginTransaction(),!Dg){var E=c.getAnchor3d(),k=c.getSize(),r=c.getTall(),e=k.width*(E.x-K.x),V=k.height*(E.z-K.z),p=r*(E.y-K.y);O||c.shiftPoints(e,V,p);var Z=c.p3()}var Y=Fb.superClass.setAnchor3d.apply(c,arguments);if(!Dg&&O){var _=c.p3();c.shiftPoints(_[0]-Z[0]+e,_[2]-Z[2]+V,_[1]-Z[1]+p)}return c.endTransaction(),delete c._updatingAnchor3d,delete c._55I,Y},setAnchor:function(L,j,i){var Q=this;Q._55I=!0;var x=Q._updatingAnchor3d,w=!Dg&&!x;if(w){var X,I,W;"number"==typeof L?W={x:L,y:j}:(W=L.length?{x:L[0],y:L[1]}:L,i=j);var $=Q.getAnchor(),b=Q.getSize();X=b.width*($.x-W.x),I=b.height*($.y-W.y),i||Q.shiftPoints(X,I);var A=Q.getPosition()}var y=Fb.superClass.setAnchor.apply(Q,arguments);if(w){var N=Q.getPosition();i&&Q.shiftPoints(N.x-A.x+X,N.y-A.y+I)}return x||delete Q._55I,y},shiftPoints:function(_,h,b){if(_||h||b){var W=this,g=W.getElevation()||0,l=W.toPoints(),w=new Xd;l.each(function(G){var u=G.e;b&&(u=(u==S?g:u)+b),w.add({x:G.x+_,y:G.y+h,e:u})}),W.setPoints(w),W.fs()}},shiftPointsElevation:function(C){return this.shiftPoints(0,0,C)},setPosition:function(R,n){var Q,I=this;if(!I._28Q){if(I._28Q=1,!I._55I&&!Dg){Q=2===arguments.length?{x:R,y:n}:R;var M=Q.x-I._position.x,e=Q.y-I._position.y;if(0===M&&0===e)return delete I._28Q,void 0;I._55I=1,I.shiftPoints(M,e),qs(I,[1,0,0,1,M,e]),delete I._55I}Fb.superClass.setPosition.apply(I,arguments),delete I._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var E=this;if(2!==E._59O.size())return!1;var Y=E._58O;return Y?2===Y.size()&&1===Y.get(0)&&2===Y.get(1)?!0:!1:!0},fireShapeChange:function(){var k=this;if(!k._55I&&!Dg){var b=Wk(k._59O);b&&(k._55I=1,k.setRect(b),delete k._55I)}k.fp(Zb,!1,!0)},getSerializableProperties:function(){var h=Fb.superClass.getSerializableProperties.call(this);return h.segments=1,h.points=1,h.thickness=1,h.closePath=1,h}});var sq=n.Points=function(){fb(sq,this)};jj("Points",ci,{_59O:[],_colors:[],_sizes:[],_uvoffsets:[],_22Q:function(){return nt},getPoints:function(){return this._59O},setPoints:function(P){var c=this._59O;P=P?P.slice(0):[];var e=P[0];if(ff(e)){var s=P;P=[];for(var t=0,A=s.length;A>t;t+=3)P.push({x:s[t],e:s[t+1],y:s[t+2]})}this._59O=P,this._pointsDirty=!0,this.fp("points",c,this._59O)},setPoint:function(K,b){var h=this._59O.slice(0);h[K]=b,this.setPoints(h)},addPoint:function(Z){this.setPoint(this._59O.length,Z)},getColors:function(){return this._colors},setColors:function(k){var T=this._colors;k=k?k.slice(0):[],this._colors=k,this._colorsDirty=!0,this.fp("colors",T,k)},setPointColor:function(l,h){var Q=this._colors.slice(0);Q[l]=h,this.setColors(Q)},getSizes:function(){return this._sizes},setSizes:function(W){var p=this._sizes;W=W?W.slice(0):[],this._sizes=W,this._sizesDirty=!0,this.fp("sizes",p,this._sizes)},setPointSize:function(h,v){var n=this._sizes.slice(0);n[h]=v,this.setSizes(n)},getUvoffsets:function(){return this._uvoffsets},setUvoffsets:function(H){var s=this._uvoffsets;H=H?H.slice(0):[],this._uvoffsets=H,this._offsetsDirty=!0,this.fp("uvoffsets",s,this._uvoffsets)},setPointUvoffset:function(E,s,b){var I;"object"==typeof s?(I=s[0],b=s[1]):I=s;var O=this._uvoffsets.slice(0);O[2*E+0]=I,O[2*E+1]=b,this.setUvoffsets(O)},getPointInfo:function(n){var m=this.getPoints();if(!m||m[n]==S)return S;var M=m[n],J=[M.x,M.e,M.y],A=this.mat||tp(this),R=[J[0],J[1],J[2]];ak(R,A);var D=this.getColors(),W=D[n]||this.s("points.color"),t=this.getSizes(),X=t[n];return{size:X==S?this.s("points.size"):X,color:W,local:J,world:R}},getSerializableProperties:function(){var V=sq.superClass.getSerializableProperties.call(this);return V.points=1,V.colors=1,V.sizes=1,V.uvoffsets=1,V},onPropertyChanged:function(v){sq.superClass.onPropertyChanged.call(this,v);var d=v.property;"s:points.color"===d?this._colorsDirty=!0:"s:points.size"===d?this._sizesDirty=!0:"s:points.model"===d&&(this._modelDirty=!0)},getWidth:function(){var q=this;if(q._width>=0)return q._width;var l=q.getStyle("points.model");if(l){var M=Wq(l);if(M&&M.rawS3)return M.rawS3[0]}return 1},getHeight:function(){var I=this;if(I._height>=0)return I._height;var v=I.getStyle("points.model");if(v){var S=Wq(v);if(S&&S.rawS3)return S.rawS3[2]}return 1},getTall:function(){var w=this;if(w._tall>=0)return w._tall;var Y=w.getStyle("points.model");if(Y){var C=Wq(Y);if(C&&C.rawS3)return C.rawS3[1]}return 1}});var qb=n.Polyline=function(){fb(qb,this),this.s({"shape.background":null,"shape.border.width":2})};jj("Polyline",Fb,{_icon:"polyline_icon",_22Q:function(){return qt},getUIClass:function(){return fh},setClosePath:function(){},setTall:function(m){var x=this;if(x.beginTransaction(),!x._55I&&!x._24Q&&!Dg&&x.getTall()){x._24Q=1;var e=x._54O,g=m/x.getTall();if(1!==g){var K=x.toPoints(),Q=new Xd;K.each(function(u){Q.add({x:u.x,y:u.y,e:u.e==S?u.e:(u.e-e)*g+e})}),x.setPoints(Q),x.fs()}delete x._24Q}qb.superClass.setTall.call(x,m),x.endTransaction()},setElevation:function(E){var d=this;if(d.beginTransaction(),!d._55I&&!d._24Q&&!Dg){d._24Q=1;var O=E-d._54O;0!==O&&d.shiftPointsElevation(O),delete d._24Q}qb.superClass.setElevation.apply(d,arguments),d.endTransaction()},fireShapeChange:function(){var e=this,D=e._59O;if(!e._55I&&!e._24Q&&!Dg){var Y=D.size();if(Y){var m=1,o=D.get(0),a=e._54O;o.e==S&&(o.e=a);for(var V=o.e,c=0;Y>m;m++){o=D.get(m),o.e==S&&(o.e=a);var h=_(V,o.e),x=g(V+c,o.e);V=h,c=x-h}e._24Q=1,e.setTall(c),e.setElevation(V+c*e._anchorElevation),delete e._24Q}}qb.superClass.fireShapeChange.apply(e,arguments)}});var Pr=n.SubGraph=function(){fb(Pr,this)};jj("SubGraph",ci,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){Pr.superClass._8I.call(this),this.eachChild(function(S){af(S)&&S._8I()})}}),H.loadingRefGraph=0;var bs=n.RefGraph=function(){fb(bs,this)};jj("RefGraph",$n,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(X){var G=this._ref;this._ref=X,this.fp("ref",G,X),this.updateRef()},_21I:function(){bs.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var W=this;if(H.loadingRefGraph++,W.clearChildrenFromDataModel(),H.loadingRefGraph--,W._ref&&W._dataModel){W._xhrLoadHandler&&(W._xhrLoadHandler.cancel=!0);var _=Dg,T=W._xhrLoadHandler=function(p){if(p&&W._dataModel){H.loadingRefGraph++;var B=W._pendingUpdateInfo={needToRestore:_};_&&(B.p3=W.p3(),B.s3=W.s3(),B.r3=W.r3(),B.anchor3d=W.getAnchor3d(),B.scale3d=W.getScale3d()),W.r3(0,0,0),W.setScale3d(1,1,1),W.setAnchor3d(.5,.5,.5),W.p3(0,0,0);var d=H.parse(p),L=W._dataModel.deserialize(d,W,{justDatas:!0});L.each(function(d){d._refGraph=W}),W.checkPendingUpdateInfo(),H.loadingRefGraph--,H.handleRefGraphLoaded(W,L,d)}};T.xhrLoadCalled=!1,H.load(W._ref,function(A){T.cancel||(T.xhrLoadCalled?T(A):Pm(function(){T(A)}))}),T.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var x=this,S=x._pendingUpdateInfo;if(!S)return x.onPendingUpdated&&(H.loadingRefGraph++,x.onPendingUpdated(),H.loadingRefGraph--),void 0;var b=!0;this.eachChild(function(u){(u._pendingCheckImageJSON||u._pendingUpdateInfo)&&(b=!1)}),b&&(H.loadingRefGraph++,x._pendingUpdateInfo=null,x.updateFromChildren(),S.needToRestore&&(x.setAnchor3d(S.anchor3d),x.setScale3d(S.scale3d),x.r3(S.r3),x.p3(S.p3)),this.getParent()instanceof bs&&this.getParent().checkPendingUpdateInfo(),x.onPendingUpdated&&x.onPendingUpdated(),H.loadingRefGraph--)},getSerializableProperties:function(){var P=bs.superClass.getSerializableProperties.call(this);return P.ref=1,P}}),n.EdgeGroup=function(q,k){this._70O=q,this._siblings=k;for(var g,z,x=0,P=q.size(),W=D[Up];P>x;x++)if(g=q.get(x).getStyle(Up,!1),g!=S){W=g;break}W==S&&(W=!0);var R=H.edgeGroupAgentFunc;for(R&&(z=R(q),z&&z!==q.get(0)&&(q.remove(z),q.add(z,0))),x=0;P>x;x++)q.get(x).s(Up,W)},jj("EdgeGroup",o,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(L){return this._70O.get(L)},indexOf:function(m){return this._70O.indexOf(m)},each:function(Q,e){this._70O.each(Q,e)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(e,i){this._siblings.each(function(b){b._70O.each(e,i)})}});var pl=function(L,O,R){var x=jd[L]={type:L,action:O};if(R)for(var X in R)x[X]=R[X]};kk(H,{setConnectAction:pl,getConnectAction:function(j,P){if(!P){if(!j)return null;P=j.getCurrentConnectActionType()}return jd[P]},doConnectAction:function(C,J,u,A){A=A||C.getCurrentConnectActionType();var B=jd[A];if(!B)return!1;var p=B.action;return p?(J instanceof mq.Group?C.sm().getSelection().each(function(j){p.call(null,C,j,u)}):p.call(null,C,J,u),!0):!1},doDeleteConnectionAction:function(n,o,r){r=r||n.getCurrentConnectActionType();var Y=jd[r];if(!Y||!Y.delete)return!1;var u=Y.delete.action;return u?(o instanceof mq.Group?n.sm().getSelection().each(function(B){u.call(null,n,B)}):u.call(null,n,o),!0):!1}});var Tm=n.JSONSerializer=function(R,u){this.dm=this._dataModel=R,this._hierarchical=H.forceHierarchicalSerialization?!0:u==S?R.isHierarchicalRendering():u};jj("JSONSerializer",o,{ms_ac:["hierarchical"],serialize:function(l){return H.stringify(this.toJSON(),l)},toJSON:function(){var x,P=this,B=P.dm,v=B.getRoots(),D=P.json={v:H.getVersion(),p:{},a:{},d:[]},t=B.getSerializableAttrs();(x=B.getInit())&&(D.init=x),(x=B.getName())&&(D.p.name=x),(x=B.getBackground())&&(D.p.background=x),(x=B.getLayers())&&(D.p.layers=x),(x=B.getEnvmap())&&(D.p.envmap=x),(x=B.getEnvmapType())&&(D.p.envmapType=x),D.p.autoAdjustIndex=B.isAutoAdjustIndex(),D.p.hierarchicalRendering=B.isHierarchicalRendering();for(var X in t){var S=B.a(X);S!==W&&P[ql](X,S,D.a)}return to(D.a)&&delete D.a,P._hierarchical?v.each(P.serializeData,this):B.each(function(h){P.serializeData(h)}),B.fireSerializeEvent({type:"serialize",json:D}),B.getPostProcessingData()&&(D.p.postProcessingData=B.getPostProcessingData()),D},isSerializable:function(){return!0},getProperties:function(T){return T.getSerializableProperties()},getStyles:function(U){return U.getSerializableStyles()},getAttrs:function(v){return v.getSerializableAttrs()},serializeData:function(h){var Y=this;if(Y.isSerializable(h)&&!h._refGraph){var j,M,y,A,X,D,e=td(h.getClassName())||h.getClass(),K=new e,U={c:h.getClassName(),i:h.getId(),p:{},s:{},a:{}};Y.json.d.push(U),j=Y.getProperties(h);for(M in j)if(/^_/.test(M)){if(y=h[M],!("_width"!==M&&"_height"!==M||y!=S&&-1!==y)){if(X==W){var V;D=(h.s("layout.h")||h.s("layout.v"))&&h.getHost()||h instanceof n.Node&&(V=h.getParent())&&V instanceof n.Block||h.s("fullscreen"),X=h.hasInheritedSize()}D&&X&&(y=h[M]="_width"===M?h.getWidth():h.getHeight())}y!==K[M]&&Y[ql](M.substr(1),y,U.p)}else A=lc(M),h[A]&&(y=h[A](),y!==K[A]()&&Y[ql](M,y,U.p));j=Y.getStyles(h);for(M in j)y=h.s(M),y!==K.s(M)&&Y[ql](M,y,U.s);j=Y.getAttrs(h);for(M in j)y=h.a(M),y!==K.a(M)&&Y[ql](M,y,U.a);to(U.p)&&delete U.p,to(U.s)&&delete U.s,to(U.a)&&delete U.a}Y._hierarchical&&h.getChildren().each(Y.serializeData,Y)},serializeValue:function(S,O,w){No(O)?O={__a:O._as}:O instanceof gi?O={__i:O.getId()}:O instanceof es&&(O={__dm:O.serialize(0)}),w[S]=O},deserialize:function(G,J,K){var S=this;return xd(G)&&/.json$/.test(G)?(H.xhrLoad(G,function(I){S.deserializeImpl(I,J,K)}),void 0):S.deserializeImpl(G,J,K)},deserializeImpl:function(U,p,x){var L=this,k=L.dm;k.setDeserializing(!0),x=an(x)?{setId:x}:Qj(x)?{finishFunc:x}:x||{},U=L.json=xd(U)?H.parse(U):U,!x.justDatas&&U.a&&U.a.onPreDeserialize&&!x.disableOnPreDeserialize&&U.a.onPreDeserialize(U,k,x.view),k.beginTransaction(),Dg++,L._82I={};var D=new Xd,B=new Xd,f=0,l=U.d.length;if(x.justDatas||(!x.disableInit&&Qj(U.init)&&U.init(k),k.setInit(U.init)),!x.justDatas){for(var i in U.a)k.a(i,L[ml](U.a[i]));for(var v in U.p)k[Bc(v)](U.p[v])}for(;l>f;f++){var h=U.d[f],W=td(h.c),T=new W,I=h.i;x.setId&&I!=S&&(T._id=I),L._82I[I]=T,D.add(T),B.add(h)}for(f=0;l>f;f++)L.deserializeData(D.get(f),B.get(f));return D.each(function(r){p&&!r.getParent()&&r.setParent(p),k.add(r)}),x.__innerHandler__&&x.__innerHandler__(U,k,x.view,D),k.fireSerializeEvent({type:"deserialize",json:U}),Dg--,k.endTransaction(),!x.justDatas&&U.a&&U.a.onPostDeserialize&&!x.disableOnPostDeserialize&&U.a.onPostDeserialize(U,k,x.view,D),x.finishFunc&&x.finishFunc(U,k,x.view,D),k.setDeserializing(!1),D},deserializeData:function(i,S){for(var l in S.p)i[Bc(l)](this[ml](S.p[l]));for(l in S.s)i.s(l,this[ml](S.s[l]));for(l in S.a)i.a(l,this[ml](S.a[l]))},deserializeValue:function(c){if(Il(c)){var e=c.__i;if(e!=S)return this._82I[e];if(e=c.__dm,e!=S){var H=new n.DataModel;return H.deserialize(e),H}if(e=c.__a,Td(e))return new Xd(e)}return c}}),kk(es,{serialize:function(J,s){return new Tm(this,s).serialize(J)},toJSON:function(k){return new Tm(this,k).toJSON()},deserialize:function(y,g,$){return new Tm(this).deserialize(y,g,$)}});var Dd=n.OverlappingBox=function(w){this.gv=w,this.boxes={}};jj("OverlappingBox",o,{clear:function(){var w,U,t=this.boxes;for(w in t)U=t[w],U.length=0},isOverlapping:function(q,Z){var f,b,z=this,$=z.boxes,g=$[q];g?(f=g.rects,b=g.length):g=$[q]={rects:f=[],length:b=0};var S,C,Z;for(S=0;b>S;S++)if(C=f[S],C.x<Z.x+Z.w&&C.x+C.w>Z.x&&C.y<Z.y+Z.h&&C.h+C.y>Z.y)return!0;return f.length<=b?(f.push(Z),g.length++):f[g.length++]=Z,!1}}),kk(H,{fetch:function(q,g){var _="GET",H=!1,X=null,S="";g&&(_=g.method||"GET",H=g.sync,S=g.url,X=g.data||null),q.open(_,S,!H),g.responseType?q.responseType=g.responseType:g.overrideMimeType&&q.overrideMimeType&&q.overrideMimeType(g.overrideMimeType),q.send(X)},convertImageSrc:function($,r){r&&"function"==typeof r||(r=function(){}),r($)}});var xc=n.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};jj("Request",o,{_responseType:null,_overrideMimeType:"text/plain",send:function($){var y=this._xhr,R=this.onload,I=this.onerror;this.getResponseType()?$.responseType=this.getResponseType():this.getOverrideMimeType()&&($.overrideMimeType=this.getOverrideMimeType()),y.onload=R,y.onerror=I,H.fetch(y,$)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(P){this._responseType=P},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(b){this._overrideMimeType=b},getResponseText:function(){var s=this._xhr;return s.response||s.responseText}}),Sb.GraphView=function(s){var d=this;d._24I={},d._34I=new Xd,d.enableDirtyRect(),d._25I={},d._56I={},d._view=Xk(1,d),d._canvas=Zj(d._view),d.dm(s?s:new es),this._coreInteractor=new oe(this),d.setEditable(!1),d.setScrollBarVisible(H.graphViewScrollBarVisible),d._initView()},vs("GraphView",o,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[Kq,qc,ib,Gh,"resettable","editInteractor",nh,"zoomable","pannable","rectSelectable","autoScrollZone",_n,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:H.graphViewZoomable,_resettable:H.graphViewResettable,_pannable:H.graphViewPannable,_rectSelectable:H.graphViewRectSelectable,_autoScrollZone:H.graphViewAutoScrollZone,_rectSelectBackground:H.graphViewRectSelectBackground,_rectSelectBorderColor:H.graphViewRectSelectBorderColor,_editPointSize:H.graphViewEditPointSize,_editPointBorderColor:H.graphViewEditPointBorderColor,_editPointBackground:H.graphViewEditPointBackground,_scrollBarColor:ar,_scrollBarSize:lj,_autoHideScrollBar:Rb,_autoMakeVisible:Oq,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(l){this._dataModel.setLayers(l)},setEditable:function(d){var C=this,A=C.__interactorMap__;if(!A){var H=Sb.XEditInteractor;A=C.__interactorMap__={scrollBar:new Ok(C),select:new Sk(C),edit:H?new H(C):new Vr(C),text:new Hj(C),move:new xr(C),"default":new Sr(C),touch:new uc(C,{editable:!1})}}d?(C._uieditable=!0,C.setInteractors([A.scrollBar,A.select,A.edit,A.text,A.move,A.default,A.touch])):(C._uieditable=!1,C.setInteractors([A.scrollBar,A.select,A.move,A.default,A.touch]))},getCanvas:function(){return this._canvas},_33I:function(G){var M=G.getUIClass();return M?new M(this,G):S},getDataUI:function(d){var j=this,q=j._25I[d._id];return q===W&&(q=j._33I(d),j._25I[d._id]=q),q},getNodeRect:function(j){return H.getNodeRect(this,j)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(R){var Y=this.getDataUI(R);return Y?(Y._79o(),Y._78o):null},getEdgeSourcePosition:function(t){var U=this,j=U.getDataUI(t),V=j.s,u=j._data._40I;return qp(U,u,V("edge.source.position"),V("edge.source.offset.x"),V("edge.source.offset.y"),V("edge.source.anchor.x"),V("edge.source.anchor.y"))},getEdgeTargetPosition:function(C){var f=this,O=f.getDataUI(C),c=O.s,T=O._data._41I;return qp(f,T,c("edge.target.position"),c("edge.target.offset.x"),c("edge.target.offset.y"),c("edge.target.anchor.x"),c("edge.target.anchor.y"))},invalidateAll:function(C){var m=this;if(C){for(var d in m._25I){var k=m._25I[d];k&&k.dispose()}m._25I={},m._56I={},m._24I={},m._34I.clear(),m.redraw()}else m.dm().each(function(O){m.invalidateData(O)})},invalidateSelection:function(){var D=this;D.sm().each(function(B){D.invalidateData(B)})},invalidateData:function(d){var z=this;z._24I[d._id]=d,z._21Q(d),z.iv()},_21Q:function(N){var J=this,Z=J._24I;if(zl(N)&&rn[N.s(bk)]){var b=N.getSourceAgent();b&&b.getAgentEdges().each(function(q){Z[q._id]=q}),b=N.getTargetAgent(),b&&b.getAgentEdges().each(function(i){Z[i._id]=i}),J.iv()}},redraw:function(k){var S=this;S._32I||(k?S._34I.add(k):(S._32I=1,S._34I.clear()),S.iv())},each:function(z,y){var A,I,U,c=0,T=this.getLayers(),H=this._dataModel,J=H._datas._as,O=J.length;if(T){var r,S={};H.isHierarchicalRendering()&&H.eachByHierarchical(function(D){U=D._layer,r=S[U],r||(r=S[U]=[]),r.push(D)});for(var D=T.length;D>c;c++)if(U=T[c],Il(U)&&(U=U.name),H.isHierarchicalRendering()){r=S[U];var m,A,o;if(r&&(m=r.length)>0)for(var s=0;m>s;s++)if(A=r[s],o=y?z.call(y,A):z(A),o===!1)return}else for(var s=0;O>s;s++)if(A=J[s],A._layer===U&&(I=y?z.call(y,A):z(A),I===!1))return}else if(H.isHierarchicalRendering())this._dataModel.eachByHierarchical(z,null,y);else for(;O>c;c++)if(A=J[c],I=y?z.call(y,A):z(A),I===!1)return},reverseEach:function(m,e){var Q,q,T,V,f=this._dataModel,F=f._layers,I=f._datas._as,t=I.length;if(F){var R,d={};for(f.isHierarchicalRendering()&&f.reverseEachByHierarchical(function(H){V=H._layer,R=d[V],R||(R=d[V]=[]),R.push(H)}),Q=F.length-1;Q>=0;Q--)if(V=F[Q],Il(V)&&(V=V.name),f.isHierarchicalRendering()){R=d[V];var b,q,X;if(R&&(b=R.length)>0)for(var P=0;b>P;P++)if(q=R[P],X=e?m.call(e,q):m(q),X===!1)return}else for(var P=t-1;P>=0;P--)if(q=I[P],q._layer===V&&(T=e?m.call(e,q):m(q),T===!1))return}else if(f.isHierarchicalRendering())f.reverseEachByHierarchical(m,null,e);
else for(Q=t-1;Q>=0;Q--)if(q=I[Q],T=e?m.call(e,q):m(q),T===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var A=this,Z=A._84I;if(!Z){var e=this.dm().a("width"),s=this.dm().a("height");e>0&&s>0?A._84I={x:0,y:0,width:e,height:s}:(A.each(function(t){A.isVisible(t)&&(Z=Mc(Z,A.getDataUIBounds(t)))}),A._84I=Z?Z:kq)}return A._84I},getScrollRect:function(){return Mc(this.getContentRect(),this._29I)},makeCenter:function(g,S,c){var G=this;if(!G.getWidth()||!G.getHeight())return c||Pm(G.makeCenter,G,[g,S,!0],500),void 0;G.makeVisible(g),G.validate();var p=G.getDataUIBounds(g);if(p){var A=G.getWidth(),X=G.getHeight(),o=p.x+p.width/2,e=p.y+p.height/2,J=-o*G._zoom+A/2,l=-e*G._zoom+X/2;G.setTranslate(J,l,S)}},fitData:function(e,R,m,A,q){var x=this;if(!x.getWidth()||!x.getHeight())return q||Pm(x.fitData,x,[e,R,m,A,!0],500),void 0;var o=function(){x.makeVisible(e),x.validate();var k=x.getDataUIBounds(e);k&&(k=Dl(k),Qf(k,m==S?20:m),x.fitRect(k,R,A))};R?H.callWhenLoaded(o):o()},fitContent:function(o,b,B,u){var e=this;if(!e.getWidth()||!e.getHeight())return u||Pm(e.fitContent,e,[o,b,B,!0],500),void 0;var m=function(){e.validate();var p=Dl(e.getContentRect());Qf(p,b==S?20:b),e.fitRect(p,o,B)};o?H.callWhenLoaded(m):m()},fitRect:function(u,a,$){var y=this,m=y.getWidth(),d=y.getHeight(),B=u.x+u.width/2,e=u.y+u.height/2,H=_(m/u.width,d/u.height),g=y._zoom,A=-B*g+m/2,n=-e*g+d/2;0===H||isNaN(H)||($&&(H=_(1,H)),a?(y._65I&&(delete y._65I.finishFunc,y._65I.stop(!0)),y._14o&&y._14o.stop(!0),y.setTranslate(A,n,{finishFunc:function(){y.setZoom(H,a)}})):(y.setTranslate(A,n),y.setZoom(H)))},fitSelection:function(D,q,J){var $=this,k=$.sm(),m=null;k.size()&&(k.each(function(A){m=Mc($.getDataUIBounds(A),m)}),D&&Qf(m,D),$.fitRect(m,q,J))},toCanvas:function(n,i,r){i=i||this._zoom,this.validateImpl();var h=this,R=h.getContentRect();r&&Qf(R,r),R.width||(R.width=10),R.height||(R.height=10);var S=Zj(),K=R.x*i,j=R.y*i,A=Math.ceil(R.width*i),Y=Math.ceil(R.height*i);Vj(S,A,Y,1);var q=ed(S);n=n||this._dataModel.getBackground(),n&&Xf(q,0,0,A,Y,n),Tc(q,-K,-j),q.scale(i,i);var J=this._zoom;return this._zoom=i,h._42(q),this._zoom=J,q.restore(),S},toDataURL:function(E,J,Y,r){return this.toCanvas(E,Y,r).toDataURL(J||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(Y,e){var u=this,U=u.dm().getBackground();if(U){var x=u.dm().a("width"),Z=u.dm().a("height");x>0&&Z>0&&Xf(Y,0,0,x,Z,U)}var F=u.__htmlOrderList,r=[],A=u._forcedLayoutHTML;if(u._93db(Y,e),u.each(function($){var D=u.getDataUI($);if(D){var V=u._56I[$._id],P=D._htmlView;if(V){var J=D._79o();if(P=D._htmlView,n.HtmlNode&&$ instanceof n.HtmlNode)D._42(Y);else{var K=u.getViewRect(),t=P&&P.layoutHTML;!e||Br(e,J)?(t&&(P.layoutHTML(),D.__outerLayout&&delete D.__outerLayout),D._42(Y)):Br(K,J)||!t||D.__outerLayout&&!A||(P.layoutHTML(),D.__outerLayout=!0)}}P&&(r.push(P),P.getView&&(P=P.getView()),P.style.display=V?"block":Uh)}}),F&&r.length>0){var g=!1;if(F.length!==r.length)g=!0;else for(var m=0;m<r.length;m++)if(r[m]!==F[m]){g=!0;break}g&&(r.forEach(function(s){s.autoAdjustIndex!==!1&&u.appendHTML(s,!0)}),this.__htmlOrderList=r)}else this.__htmlOrderList=r;u._92db(Y,e)},disableDirtyRect:function(){this._shouldRedrawAll=C},enableDirtyRect:function(){var w=this;w._shouldRedrawAll=function(){return w._32I}},validateImpl:function(){this.tryUpdateRootData();var P,n,F,G,W,S=this,b=S.tx(),u=S.ty(),N=S._zoom,t=S._canvas,Y=this.getWidth(),i=this.getHeight(),Q=S._29I,D={x:-b/N,y:-u/N,width:Y/N,height:i/N},s={},B=S._34I,x=S._24I,d=S._shouldRedrawAll(),w=S._23I;S._24I={},(Y!==t.clientWidth||i!==t.clientHeight)&&(Vj(t,Y,i),d=1,S._forcedLayoutHTML=1),d||hf(D,Q)||(d=1,S._forcedLayoutHTML=1),S._29I=D,S.each(function(W){n=W._id;var U=s[n]=S.isVisible(W);U!==S._56I[n]&&(x[n]=W,F=S.getDataUI(x[n]),F&&F._84o(U),S._84o(W,U))},S);for(n in x)F=S.getDataUI(x[n]),F&&(!d&&S._56I[n]&&(W=F._79o(),W&&B.add(W)),F.invalidate()),S._83I=1;if(S._56I=s,!d)for(n in x)s[n]&&(F=S.getDataUI(x[n]),F&&(W=F._79o(),W&&B.add(W)));if(d?G=D:(B.each(function(w){Br(D,w)&&(G=Mc(G,w))}),G&&(Qf(G,g(1,1/N)),G.x=j(G.x*N)/N,G.y=j(G.y*N)/N,G.width=k(G.width*N)/N,G.height=k(G.height*N)/N,G=fe(D,G))),S._74O=G,G&&0!==G.width&&0!==G.height){P=ed(t);var E=G.x,r=G.y,Z=G.width,e=G.height;E=Math.floor((E*N+b)*mf),r=Math.floor((r*N+u)*mf),Z=Math.ceil(Z*N*mf)+1,e=Math.ceil(e*N*mf)+1,d||(G.x=(E/mf-b)/N,G.y=(r/mf-u)/N,G.width=Z/mf/N,G.height=e/mf/N),P.beginPath(),P.rect(E,r,Z,e),P.clip(),P.clearRect(E,r,Z,e),of(P,b,u,N),S._42(P,G),P.restore(),delete S._74O}if(B.clear(),delete S._32I,delete S._forcedLayoutHTML,w&&Y>0&&i>0){var F=S.getDataUI(w);if(F){var W=F._79o(),p=S._29I,V=p.x,K=p.y,h=p.width,X=p.height,N=S._zoom;W&&!Br(W,p)&&(W.x+W.width<V&&S.tx(-W.x*N),W.x>V+h&&S.tx(-(W.x+W.width-h)*N),W.y+W.height<K&&S.ty(-W.y*N),W.y>K+X&&S.ty(-(W.y+W.height-X)*N))}delete S._23I}S._83I&&(delete S._83I,delete S._84I),S._98O(),S.countFrame(),to(S._24I)||Pm(S.iv,S)},isValidGuideLineSource:function(){return!0},tryUpdateRootData:function(){if(!this._rootDataUpdating){this._rootDataUpdating=!0;var z,e=this.getFullscreenDatas();for(var h in e)z=e[h],this.scaleRootData(z);this.onRootDataUpdated&&this.onRootDataUpdated(),this._rootDataUpdating=!1}},scaleRootData:function(v){var I=v.s("fullscreen");if("uniform"===I||"fill"===I){v.getRotation()&&v.setRotation(0);var T=v.s("fullscreen.gap")||0,z=this.getWidth(),l=this.getHeight();if(z&&l){var w,$,j,A=z-2*T,m=l-2*T,E=v.getAnchor(),P=v.getScaledSize(),i=P.width,G=P.height,H=v.s("fullscreen.lock");if(H)return"uniform"===I?A/m>i/G?(w=m/G,i=G*A/m):(w=A/i,G=i*m/A):"v"===H?(w=m/G,i=A/w,v.getWidth()!==i&&v.setWidth(i)):(w=A/i,G=m/w,v.getHeight()!==G&&v.setHeight(G)),this.setZoom(w),$=T-(v.getX()-E.x*i)*w,j=T-(v.getY()-E.y*G)*w,$!==this.tx()&&this.tx($),j!==this.ty()&&this.ty(j),void 0;$=this.tx(),j=this.ty(),w=this._zoom;var a={x:(-$+T)/w,y:(-j+T)/w,width:A/w,height:m/w};if("uniform"===I){var d=i/G,e=Math.min(a.width,a.height*d),B=e/d;a.x+=.5*(a.width-e),a.y+=.5*(a.height-B),a.width=e,a.height=B}A=a.width/v.getScaleX(),m=a.height/v.getScaleY(),(v.getWidth()!=A||v.getHeight()!==m)&&v.setSize(A,m);var O=a.x+E.x*a.width,X=a.y+E.y*a.height,J=v.getPosition();(O!==J.x||X!==J.y)&&v.setPosition(O,X)}}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(P){var s=this;P!==s.isScrollBarVisible()&&(P?(wf(s._view,s._79O=ue()),wf(s._79O,s._27I=ue()),wf(s._79O,s._28I=ue())):(re(s._79O),delete s._79O,delete s._27I,delete s._28I),s.fp("scrollBarVisible",!P,P))},getDebugTip:function(){return""},showScrollBar:function(){var s=this;s._79O&&(s._85I||(Yk(function(){s._86I()},Op),s.iv()),s._85I=new Date)},_86I:function(){var K=this;if(K._85I){var T=new Date,A=T.getTime();A-K._85I.getTime()>=Op?(delete K._85I,K.iv()):Yk(function(){K._86I()},Op)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var G=this,p=this._27I,$=this._28I;if(G._79O){if(G._autoHideScrollBar&&!G._85I)return p.style.visibility=Ef,$.style.visibility=Ef,void 0;var o=G.getScrollBarColor(),R=G._zoom,U=G.getScrollBarSize(),b=G.getViewRect(),Z=G.getScrollRect(),T=b.height*R,n=Z.height*R,F=b.width*R-U-2,Y=T*((b.y-Z.y)*R/n),h=T*(T/n),j=p.style;n-.5>T?(ie>h&&(Y=Y+h/2-ie/2,0>Y&&(Y=0),Y+ie>T&&(Y=T-ie),h=ie),Pg(p,F,Y,U,h),j.visibility=jh,j.background=o,j.borderRadius=U/2+Kl):j.visibility=Ef;var s=b.width*R,H=Z.width*R,Y=b.height*R-U-2,F=s*((b.x-Z.x)*R/H),A=s*(s/H),j=$.style;H-.5>s?(ie>A&&(F=F+A/2-ie/2,0>F&&(F=0),F+ie>s&&(F=s-ie),A=ie),Pg($,F,Y,A,U),j.visibility=jh,j.background=o,j.borderRadius=U/2+Kl):j.visibility=Ef}},setDataModel:function(t){var R=this,v=R._dataModel,s=R._selectionModel;v!==t&&(v&&(v.ump(R.handleDataModelPropertyChange,R),v.umm(R.handleDataModelChange,R),v.umd(R.handleDataPropertyChange,R),v.removeIndexChangeListener(R._75O,R),v.removeHierarchyChangeListener(R.handleHierarchyChange,R),s||v.sm().ums(R.handleSelectionChange,R)),R._dataModel=t,t.mp(R.handleDataModelPropertyChange,R),t.mm(R.handleDataModelChange,R),t.md(R.handleDataPropertyChange,R),t.addIndexChangeListener(R._75O,R),t.addHierarchyChangeListener(R.handleHierarchyChange,R),s?s._21I(t):t.sm().ms(R.handleSelectionChange,R),R.invalidateAll(!0),R.fp(hb,v,t),R.updateBackground())},getLayersInfo:function(){if(this._layersInfo===W){var r=this.getLayers();r?(this._layersInfo={},r.forEach(function(_){var J=Il(_)?_.name:_;this._layersInfo[J]=_},this)):this._layersInfo=null}return this._layersInfo},calculateEdgePosition:function(T,x,q){var k,Z,G,A,L=this;T instanceof n.Data?(A=L.getDataUI(T),G=bl(A)):(G=bl(null,arguments[0],arguments[1]),x=arguments[2],q=arguments[3]),2===x.length&&(x=new Ai(x[0],x[1]));var o=am(x,function(n){return Hm(G,100*n)},100,.001),b=Hm(G,100*o);if(!q){var I=A?pk(A):pk(arguments[0],arguments[1]),m=new Ai(b.x,b.y),D=49/(L._zoom*L._zoom);for(k=0,Z=I.length;Z>k;k++)if(m.distanceToSquared(I[k])<D)return{index:k,point:I[k],distance:Math.sqrt((I[k].x-x.x)*(I[k].x-x.x)+(I[k].y-x.y)*(I[k].y-x.y))}}return{percent:o,point:b,distance:Math.sqrt((b.x-x.x)*(b.x-x.x)+(b.y-x.y)*(b.y-x.y))}},getPercentPositionOfPath:function(A,g){var V;if(A instanceof n.Data){var M=this.getDataUI(A);V=bl(M)}else V=bl(null,arguments[0],arguments[1]),g=arguments[2];return Hm(V,g)},getNeareastPositionOfPath:function(){return this.calculateEdgePosition.apply(this,arguments)},getPointsOfPath:function(){function w(a,z,Y,L,P,H){var w=new Ai(z.get(Y)),C=H.apply(w);a.push({local:w,world:C,type:P,index:Y,realIndex:L})}return function(e){var C,o;if(e instanceof n.Data){var q=this.getDataUI(e),B=fp(q);C=B.points,o=B.segments}else C=arguments[0],o=arguments[1];var g,R,k,W=e instanceof n.Shape?e.getPointsMatrix2d():new Po.Matrix2d,u=[],t=-1,O=-1;for(R=0,k=o?o.length:C.length;k>R;R++)g=o?o.get(R):1,5!==g&&(O++,3===g?(w(u,C,t+1,O,"C",W),w(u,C,t+2,O,"M",W),t+=2):4===g?(w(u,C,t+1,O-1,"R",W),w(u,C,t+2,O,"L",W),w(u,C,t+3,O,"M",W),t+=3):(w(u,C,t+1,O,"M",W),t+=1));return u}}(),calculateAttachPoint:function(){var u=new Ai,J=new Ai,A=new Ai;return function(E,q){var T=this.getAttachPoints(E);if(!T||!T.length)return null;A.set(q.x,q.y);for(var z,s,L,r,g,I=1/0,C=0,p=T.length;p>C;C++)L=T[C],J.x=L.x,J.y=L.y,u.x=L.offsetX||0,u.y=L.offsetY||0,r=qp(this,E,0,u.x,u.y,J.x,J.y),s=A.distanceToSquared(r),I>s&&(z=C,I=s,g=r);I=Math.sqrt(I);var $=this.getAttachStyle(E);if("close"===$){var D=E.s("attach.close.threshold")/this._zoom;if(I>D)return null}return{index:z,distance:I,info:T[z],point:g}}}(),getAttachPoints:function(N){var L=N.s("attach.points");if(L)return L;var c=Fr(N._image);return c?dd(c.attachPoints,N,this)||null:void 0},getAttachStyle:function(F){var q=F.s("attach.style");if(q)return q;var v=Fr(F._image);return v?dd(v.attachStyle,F,this)||"close":void 0},updateLayers:function(){this._layersInfo=W,this.invalidateSelection(),this.redraw()},updateBackground:function(){var W=this.dm().a("width"),u=this.dm().a("height");this._canvas.style.background=W>0&&u>0?"":this.dm().getBackground()||""},handleDataModelPropertyChange:function(k){if("background"===k.property){var R=this._canvas.style.background,V=k.newValue||"";this.updateBackground(),this.fp("canvasBackground",R,V),this.redraw()}else"a:width"===k.property||"a:height"===k.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===k.property?this.updateLayers():"hierarchicalRendering"===k.property&&this.redraw()},handleDataPropertyChange:function(q){this.dm().isHierarchicalRendering()&&"parent"===q.property&&q.data.hasChildren()&&this.redraw(),this.invalidateData(q.data)},onPropertyChanged:function(o){var J=this,c=o.property;if(J.redraw(),"zoom"===c){var u=J.sm().getSelection();u.size()&&u.each(function(F){F.invalidate()})}else"dataModel"===c&&(J._83I=1);Uc[c]?J.showScrollBar():c===nh&&J.onCurrentSubGraphChanged(o)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(m){var n=this,E=m.kind,Y=m.data;if(n._83I=1,"add"===E)n.invalidateData(Y),zl(Y)&&Y.getEdgeGroup()&&Y.getEdgeGroup().eachSiblingEdge(n.invalidateData,n),Y.getHost&&Y.getHost()&&Y.getHost().updateLayoutAttaches();else if(E===Wh){n._21Q(Y);var M=Y._id,s=n._25I[M];if(s){if(n._56I[M]){var W=s._79o();W&&n.redraw(W)}s.dispose(),delete n._25I[M],delete n._24I[M],delete n._56I[M]}Y===n._currentSubGraph&&n.setCurrentSubGraph(S)}else E===rs&&(n.invalidateAll(!0),n.setCurrentSubGraph(S))},_75O:function(g){this.invalidateData(g.data)},handleHierarchyChange:function(N){this.dm().isHierarchicalRendering()&&N.data.hasChildren()&&this.redraw(),this.invalidateData(N.data)},adjustIndex:function(T){var m=this;if(m.isVisible(T)){m.dm().beginTransaction();for(var v=T;v._parent&&m.isVisible(v._parent);)v=v._parent;v&&v!==T&&m._dataModel.adjustIndex(v),m._dataModel.adjustIndex(T),m.dm().endTransaction()}},getImage:function(b){return b.getImage?b.getImage():W},getSelectWidth:function(E){var I=Fr(this.getImage(E));return I&&dd(I.disableSelectedBorder,E,this)?0:E.s("select.width")},getSelectColor:function(J){return J.s("select.color")},isSelectable:function(i,a){if(this.isSelected(i))return!0;if(!a&&i.getParent()instanceof $n&&this.isSelectable(i.getParent(),!0)&&i.getParent().isSyncSize())return!1;var C=this.getLayersInfo();if(C){var Z=C[i._layer];if(Z&&Z.selectable===!1)return!1}return i.s("2d.selectable")&&this.sm().isSelectable(i)},isMovable:function(E){var U=this;if(zl(E)&&E.getStyle(bk)!==We)return!1;var k=this.getLayersInfo();if(k){var v=k[E._layer];if(v&&v.movable===!1)return!1}return E.s("2d.movable")?U._movableFunc?U._movableFunc(E):!0:!1},isEditable:function(N){var s=this;if(n._uiSerializing)return s._uieditable;if(!s._editInteractor||!s.isSelected(N))return!1;if(tl(N)){var S=s.getDataUI(N);if(!S||S._88I)return!1}if(zl(N)&&N.getStyle(bk)!==We)return!1;var o=this.getLayersInfo();if(o){var R=o[N._layer];if(R&&R.editable===!1)return!1}return N.s("2d.editable")?s._editableFunc?s._editableFunc(N):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(s){return af(s)&&0!==s.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(s):!0},isRectEditable:function(s){return this._rectEditableFunc?this._rectEditableFunc(s):!0},isAnchorEditable:function(K){return this._anchorEditableFunc?this._anchorEditableFunc(K):!0},isRotationEditable:function(i){return i.setRotation&&i.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(i):!0:!1},isSourceTargetEditable:function(){return!0},getRotationPoint:function(Y){var c=Y.getAnchor(),g=Y.getScale(),d=this._zoom,e=rd(Y.getRotation(),0,-Y.getHeight()*g.y*c.y-(g.y<0?-1:1)*(bc?32:16)/d),y=Y.p();return e.x+=y.x,e.y+=y.y,e},getLogicalPoint:function(A){var v=this;return Ib(A,v._canvas,v.tx(),v.ty(),v._zoom,v._zoom)},getScreenPoint:function(l,X){var n,T=this;return"object"==typeof l?l.x!==W?(n=l.x,X=l.y):(n=l[0],X=l[1]):n=l,Ah(n,X,T._canvas,T.tx(),T.ty(),T._zoom,T._zoom)},getSelectedDataAt:function(M){var j=this;return this.getDataAt(M,function(I){return j.isSelected(I)})},getDataInfoAt:function(F,B,z){var X,l=this.lp(F),J=this.getDataAt(l,B,z);if(J){var e=this.getDataUI(J);X={data:J,ui:e,point:l};var k=e._38o;if(k){var A=k.icons;for(var i in A){var p=A[i],v=k.rects[i];if(v)for(var H=dd(p.names,J,this),j=H?H.length:0,q=v.rotation,G=j-1;G>=0;G--){var K=H[G],y=v[G];if(Zk(y,l,q))return X.part="icons",X.name=i,X.icon=K,X.rect=y,X.index=G,X.rotation=q,X}}}if(this.isNoteVisible(J)){if(e.note2Info&&Zk(e.note2Info.clickRect,l,S,e.note2Info.scale))return X.part="note2",X;if(e.noteInfo&&Zk(e.noteInfo.clickRect,l,S,e.noteInfo.scale))return X.part="note",X}if(this.isLabelVisible(J)){if(e.label2Info&&Zk(e.label2Info.rect,l,e.label2Info.rotation,e.label2Info.scale))return X.part="label2",X;if(e.labelInfo&&Zk(e.labelInfo.rect,l,e.labelInfo.rotation,e.labelInfo.scale))return X.part="label",X}if(J.isInRect&&J.isInRect(l))return X.part="body",X}return X},getDataAt:function(Z,o,w){Z.target&&(Z=this.lp(Z));var D,K=this._zoom;return this.reverseEach(function(S){return(o?o(S):this.isSelectable(S))&&this.rectIntersects(S,cd(Z.x,Z.y,w,K))?(D=S,!1):void 0},this),D},getIconInfoAt:function(w,L){var s=this;if(w.target&&(w=s.lp(w)),L||(L=s.getDataAt(w)),L){var H=s.getDataUI(L);if(H&&H._38o){var Z,B=H._38o,j=new Xd;for(Z in B.icons)j.add(Z);for(var N=j.size()-1;N>=0;N--){Z=j.get(N);for(var b=B.rects[Z],n=b.rotation,l=b.length-1;l>=0;l--){var R=b[l],T=R.width,u=R.height,U={x:w.x-R.x-T/2,y:w.y-R.y-u/2};n!=S&&(U=rd(-n,U.x,U.y));var R={x:-T/2,y:-u/2,width:T,height:u};if(Zk(R,U))return{key:Z,index:l,name:B.icons[Z].names[l],rect:b[l],point:w,rotation:n,relativeRect:R,relativePoint:U,data:L}}}}}return S},getDatasInRect:function(e,V,Z){Z===W&&(Z=1);var d=this,X=new Xd;return d.reverseEach(function(p){Z&&!d.isSelectable(p)||(V?d.rectIntersects(p,e):d.rectContains(p,e))&&X.add(p)}),X},moveSelection:function(F,K){var s=this;s.dm().beginTransaction(),Qk(s.sm().toSelection(s.isMovable,s),F,K),s.dm().endTransaction()},moveDatas:function(t,r,e){var h=this;h.dm().beginTransaction(),t instanceof Xd||(t=new Xd(t)),Qk(t,r,e),h.dm().endTransaction()},getDataUIBounds:function(A){var j=this.getDataUI(A);return j?j._79o():S},drawData:function(f,W,o){var $=this.getDataUI(W);if($){var t=$._79o();(!o||Br(o,t))&&($._42(f),W instanceof n.Block&&W.eachChild(function(l){this.isVisible(l)&&this.drawData(f,l,o)},this))}},getBoundsForGroup:function(c){return c.s(Xc)?this.getDataUIBounds(c):S},isPixelPerfect:function(i){return i.s("pixelPerfect")},rectIntersects:function(m,e){this.validate();var D=S;if(this._56I[m._id]){var T=this._25I[m._id];if(T){var i=T._79o();if(Ip(e,i))D=!0;else if((e=fe(e,i))&&(T.rectIntersects&&(D=T.rectIntersects(e)),D==S)){if(!this.isPixelPerfect(m))return!0;var V=e.x,X=e.y,w=e.width,Z=e.height,G=this._zoom,p=H.hitMaxArea,R=w*Z*G*G;if(R>p){var u=Math.sqrt(p/R);G*=u}w*=G,Z*=G,2>w&&(w=2),2>Z&&(Z=2),V*=G,X*=G;var I=mp(w,Z);Tc(I,-V,-X),I.scale(G,G),this._drawForChecking=!0,this.drawData(I,m,e),this._drawForChecking=!1;try{for(var j=0,l=I.getImageData(0,0,w,Z).data;j<l.length;j+=4)if(0!==l[j+3]){D=!0;break}I.restore()}catch(f){Qe=S,D=!1}}}}return D?!0:!1},rectContains:function(q,H){if(this._56I[q._id]){var l=this._25I[q._id];if(l)return Ip(H,l._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(K){if(!H.isInput(K.target)){var B=this,x=B._focusData,D=x&&B._25I[x._id],j=0,J=B._dataModel._datas;if(!(x&&x._enabled&&x._editable&&D&&D.onKeyDown&&D.onKeyDown(K)===!0))if(9===K.keyCode&&(x&&(j=J.indexOf(x),nr(K)?-1===--j&&(j=0):++j===J.size()&&(j=0)),B._focusData=x=J.get(j),B.sm().setSelection(x)),xo(K)?B.selectAll():vr(K)&&B.isResettable()&&B.reset(),B.sm().isEmpty()){if(B._editing)return;var G=B.tx(),o=B.ty(),V=!1,Z=nr()?100:10;Lp(K)&&(G-=Z,V=!0),dl(K)&&(o-=Z,V=!0),Nr(K)&&(G+=Z,V=!0),Se(K)&&(o+=Z,V=!0),V&&B.setTranslate(G,o)}else{zn(K)&&B.handleDelete(K);var s=nr()?10:1;Lp(K)&&(B.moveSelection(-s,0),B.fi({kind:"moveLeft"})),dl(K)&&(B.moveSelection(0,-s),B.fi({kind:"moveUp"})),Nr(K)&&(B.moveSelection(s,0),B.fi({kind:"moveRight"})),Se(K)&&(B.moveSelection(0,s),B.fi({kind:"moveDown"}))}}},handleScroll:function(Z,F){if(as(Z),this.isZoomable()){if(!this.getEditInteractor()){var m=this.getDataAt(Z);if(m){var o=Fr(this.getImage(m));if(o&&dd(o.scrollable,m,this))return}}var q=this.getFullscreenDatas();for(var I in q)if(q[I].s("fullscreen.lock"))return;var h=this.lp(Z);F>0?this.scrollZoomIn(h):0>F&&this.scrollZoomOut(h)}},handlePinch:function(_,e,V){this.isZoomable()&&(Math.abs(e-V)<H.pinchZoomThreshold||(e>V?this.pinchZoomIn(_):this.pinchZoomOut(_)))},checkDoubleClickOnNote:function(K,e){var k=this,H=k.lp(K),V=k.getDataUI(e),s=V.note2Info;return s&&e.s("note2.toggleable")&&Zk(s.clickRect,H)?(e.s(li,!e.s(li)),k.fi({kind:"toggleNote2",event:K,data:e}),!0):(s=V.noteInfo,s&&e.s("note.toggleable")&&Zk(s.clickRect,H)?(e.s(Rg,!e.s(Rg)),k.fi({kind:"toggleNote",event:K,data:e}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(e,X){var M=this,H=M.getAutoScrollZone(),R=H/M.getZoom(),g=H/4,Q=M._29I,h=M.lp(e),p={x:M.tx(),y:M.ty()};return h&&H>0&&Q&&(h.x-Q.x<R?M.translate(g,0):Q.x+Q.width-h.x<R&&M.translate(-g,0),h.y-Q.y<R?M.translate(0,g):Q.y+Q.height-h.y<R&&M.translate(0,-g)),p.x=M.tx()-p.x,p.y=M.ty()-p.y,X&&(X.x+=p.x,X.y+=p.y),p},getMoveMode:function(K,c){var f=c.s("2d.move.mode");return f?f:$f["88"]?"x":$f["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(f,r,_){var p=this;return"currentSubGraph"===r?{__i:f.getId()}:_.serializeProperty(f,r,p)},deserializeProperty:function(U,d,V){var Z=this;if("currentSubGraph"===d){var p=Z.dm(),z=p.__idMap;return z[U.__i]}return V.deserializeProperty(U,d,Z)},setDefaultCursor:function(E,l){this._defaultCursor=E,l!==!1&&this.setCursor(E)},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(K){return K===S||H.getConnectAction(null,K)?(this._currentActionType=K,this.redraw(),!0):!1},getEditStyle:function(H){var c=this.getEditInteractor();return c?c.getStyle(H):W},setEditStyle:function(C,O,s){var L=this.getEditInteractor();return L?(L.setStyle(C,O,s),!0):!1},isConnectActionVisible:function(h){var q=H.getConnectAction(this);if(!q)return!1;var E=q.visible;return Qj(E)&&(E=E(this,h)),E},isInteractive:function(T){if(this._drawForChecking)return!1;var c=Fr(this.getImage(T));return c&&dd(c.interactive,T,this)?!0:T.s("interactive")},getRenderingStyleIconName:function(){return jq},appendHTML:function(e,f){var q=this.getView();if(!(f||e&&e.parentNode!==q))return!1;var L=e.getView&&e.getView(),R=e.beforeCanvas;if(!f&&L&&L.parentNode===q)return!1;(e.getView||e.isSelfViewEvent)&&(e=e.getView());var Y=this.getEditInteractor();return R?q.insertBefore(e,this.getCanvas()):Y&&Y._canvas?q.insertBefore(e,Y._canvas):this.isScrollBarVisible()?q.insertBefore(e,this.getView().lastChild):wf(q,e),!0},_layoutHTMLImpl:function(Y,K,z){if(arguments.length>1){var M,N=this,Z=N._zoom;if(K.getView&&(M=K,K=K.getView()),K.style.position="absolute",z){var J=Y.getRect();Pg(M||K,N.tx()+J.x*Z,N.ty()+J.y*Z,J.width*Z,J.height*Z)}else{var A=new Vb,J=Y.getAnchorRect(),p=Y.getPosition(),B=Y.getScale(),E=K.style;Pg(M||K,J),A.appendTranslate(N.tx(),N.ty()),A.appendScale(Z,Z),A.append(new Vb(Y.getRotation(),p.x,p.y,B.x,B.y)),Ll(E,"transform","matrix("+A.a.toFixed(5)+", "+A.b.toFixed(5)+", "+A.c.toFixed(5)+",\n    "+A.d.toFixed(5)+", "+A.tx.toFixed(5)+", "+A.ty.toFixed(5)+")"),Ll(E,"transformOrigin",(-J.x).toFixed(5)+"px "+(-J.y).toFixed(5)+"px"),K.updateAppendMatrix=!0}}else this._layoutHTML&&this._layoutHTML()},getTextEditInfo:function(C){return C instanceof To?{name:"text",accessType:"s",font:C.s("text.font"),isMultiline:!0}:void 0},getState:function(o){var w="state",U=o.s(w);if(U)return U;var m=Fr(o._image);return m?dd(m[w],o,this)||null:void 0},getShape:function(K){return K.getStyle(Zb)}}),o.defineProperties(Sb.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(N){this._layoutHTML=N}}});var Ag=function(O,n){var f=this;f.gv=O,f.s=function(o){return n.getStyle(o)},f._data=n,f._87I=new Xd},jq=S;Dh(Ag,o,{_6I:S,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var n=this,Z=n.gv.isSelected(n._data);return!Z||n.isShadowed()?0:n.gv.getSelectWidth(n._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(X){var Y=this._data,p=this.gv.getBodyColor(Y);return p?p:X?Y.getStyle(X):S},_2Q:function(u){return this.s(u)},_1Q:function(E,i,U,u){var Z=this.s,D=Z("2d.gray"),C=Z(i+".dash.color");if(D&&(C=H.toGrayColor(C)),E.strokeStyle=C,E.lineWidth=U,E.stroke(),Z(i+".dash.3d")){var o=Z(i+".dash.3d.color");vl(E,C,D?H.toGrayColor(o):o,U,this.gv._zoom,Z(i+".dash.3d.accuracy"))}qm(E,u)},invalidate:function(){this._6I=S},_79o:function(){var t=this;if(!t._6I){var D=t._data,L=t.gv;t.labelInfo=t.label2Info=t.noteInfo=t.note2Info=t._38o=S,t._87I.clear(),t.interactiveInfo=L.isInteractive(D)?{}:S,t._3O(),t._55O=L.isEditable(D)?{_42O:L.isRectEditable(D),_43O:L.isPointEditable(D),_56O:L.isRotationEditable(D)}:S,t._6I=t._81o()}return t._6I},_3O:function(){},getPosition:function(){return kq},_68o:function(u,G){u&&this._87I.add($m(u,G))},_81o:function(){var w=this,E=w.s;w._24O(Jo,"getLabel"),w._24O(tj,"getLabel2"),w._26O(Ml,"getNote"),w._26O(Eg,"getNote2"),w._15O(),w._55O&&w._48O();var d;if(w._87I.each(function(C){d=Mc(d,C)}),d&&E("shadow.interactable")){var I=w.isShadowed(),Y=E("shadow2"),L=Dl(d);Y?(L.x+=E("shadow2.offset.x"),L.y+=E("shadow2.offset.y"),Qf(L,E("shadow2.blur"))):I&&(L.x+=E("shadow.offset.x"),L.y+=E("shadow.offset.y"),Qf(L,E("shadow.blur"))),d=Mc(d,L)}return w._87I.clear(),d},_42:function(s){var a=this,y=a._data,Q=a.gv,K=a.s,L=K("opacity"),m=this.isShadowed(),e=K("shadow2");if(m||e){var P=s.shadowOffsetX,B=s.shadowOffsetY,O=s.shadowBlur,X=s.shadowColor,D=Q.getZoom()*H.devicePixelRatio,h=m?"shadow":"shadow2";s.shadowOffsetX=K(h+".offset.x")*D,s.shadowOffsetY=K(h+".offset.y")*D,s.shadowBlur=K(h+".blur")*D,s.shadowColor=m?a.getSelectColor():K(h+".color")}if(L!=S){var p=s.globalAlpha;s.globalAlpha=L}a._80o(s),Q.isLabelVisible(y)&&((!Q._drawForChecking||K("label.selectable"))&&Ro(s,a.labelInfo),(!Q._drawForChecking||K("label2.selectable"))&&Ro(s,a.label2Info)),Q.isNoteVisible(y)&&(Am(s,a.noteInfo),Am(s,a.note2Info)),a._99O(s),L!=S&&(s.globalAlpha=p),(m||e)&&(s.shadowOffsetX=P,s.shadowOffsetY=B,s.shadowBlur=O,s.shadowColor=X)},_80o:function(){},_47O:function(){},_24O:function(m,$){var e=this,G=e._data,a=e.gv,T=e.s,f=a[$](G);if(f!=S){var l=T(m+".scale"),Y=T(m+".max"),w=T(m+".position"),k=e[m+"Info"]={label:f,scale:l,color:a[$+"Color"](G),font:T(m+".font"),opacity:T(m+".opacity"),align:T(m+".align"),decoration:T(m+".decoration"),rotation:e.getRotation(T(m+".rotation"),!1,w),background:a[$+"Background"](G)},O=yf(k,f);Y>0&&Y<O.width&&(k.labelWidth=O.width,O.width=Y),1!==l&&(O.width*=l,O.height*=l);var B=e.getPosition(w,T(m+".offset.x"),T(m+".offset.y"),O,T(m+".position.fixed"));if(O.x=B.x-O.width/2,O.y=B.y-O.height/2,e._68o(k.rect=O,k.rotation),1!==l){var E=O.width/l,X=O.height/l;k.rect={x:B.x-E/2,y:B.y-X/2,width:E,height:X}}}},_26O:function($,q){var B=this,T=B.gv,g=B._data,I=B.s,G=T[q](g);if(G!=S){var E,j,i=I($+".scale"),x=B[$+"Info"]={note:G,scale:i,data:g,view:T,expanded:I($+".expanded"),font:I($+".font"),color:I($+".color"),opacity:I($+".opacity"),align:I($+".align"),icon:I($+".icon"),backgroundImage:I($+".backgroundImage"),borderWidth:I($+".border.width"),borderColor:I($+".border.color"),background:T[q+"Background"](g)},F=B.getPosition(I($+".position"),I($+".offset.x"),I($+".offset.y")),n=F.x,H=F.y;if(x.expanded){var _,v=I($+".max"),l=I($+".backgroundImage");l?(l=Fr(l),_={width:lm(l,g),height:qj(l,g)}):_=yf(x,G),_.width+=6,_.height+=2,v>0&&v<_.width&&(x.labelWidth=_.width,_.width=v),E=_.width,j=_.height+8,x.clickRect={x:n-E*i/2,y:H-j*i,width:E*i,height:j*i*_.height/j}}else{var p=I($+".icon");p?(p=Fr(p),E=lm(p,g),j=qj(p,g)):(E=12,j=18),x.clickRect={x:n-E*i/2,y:H-j*i,width:E*i,height:j*i}}x.rect={x:n-E/2,y:H-j*i/2-j/2,width:E,height:j};var J=k(x.borderWidth/2)*i;B._68o({x:n-E*i/2-J,y:H-j*i-J,width:E*i+2*J,height:j*i+2*J})}},_48O:function(){},_99O:function(N){var U=this,m=U._38o;if(m){var X=U.gv,f=U._data,G=m.icons,Y=U.interactiveInfo;Y&&(Y._38o={});for(var l in G){var E=G[l],b=m.rects[l];if(b){Y&&(Y._38o[l]=[]);var H=dd(E.opacity,f,X),w=dd(E.names,f,X),C=w?w.length:0,W=b.rotation;if(H!=S){var F=N.globalAlpha;N.globalAlpha*=H}for(var r=0;C>r;r++){var I=w[r],a=Fr(I),Z=b[r];if(W){var A=Z.x+Z.width/2,g=Z.y+Z.height/2;N.save(),Tc(N,A,g),ef(N,W),Tc(N,-A,-g)}Y&&Y._38o[l].push(N.interactiveInfo={compInfos:[],matrix:W?new Vb(W,A,g).appendTranslate(-A,-g):new Vb});var h=jq;jq=l,xe(N,a,dd(E.stretch,f,X),Z.x,Z.y,Z.width,Z.height,U._data,U.gv),jq=h,N.interactiveInfo=S,W&&N.restore()}H!=S&&(N.globalAlpha=F)}}}}});var is=function(S,N){fb(is,this,[S,N])};Dh(is,Ag,{_checkEmptyRect:!0,_40O:function(Y,Z){var G=this,T=G.s,t=Y.rect;(Y.borderColor=G.gv.getBorderColor(G._data))&&(Y.borderType=T("border.type"),Y.borderWidth=T("border.width"),Y.borderPadding=T("border.padding"),Z=g(Z,Y.borderPadding+Y.borderWidth/2));var j=G._data.getScale(),l=g(1,g(v(j.x),v(j.y)));if(Y.selectWidth=G.getSelectWidth()){var z=G.gv._zoom;Y.selectType=T("select.type"),Y._97o=G.getSelectColor(),Y.selectPadding=T("select.padding"),Z=g(Z,(Y.selectPadding+Y.selectWidth/2/z)/l)}Z>0&&(Z*=l,t=Dl(t),Qf(t,Z)),G._68o(t)},_39O:function(M,N){var p,E=this,C=N.rect;if(N.borderWidth>0&&(p=N.borderPadding,M.strokeStyle=N.borderColor,M.lineWidth=N.borderWidth,Dj(M,N.borderType,{x:C.x-p,y:C.y-p,width:C.width+2*p,height:C.height+2*p}),M.stroke()),N.selectWidth>0){var F=E.gv._zoom;if(p=N.selectPadding,M.strokeStyle=N._97o,M.lineWidth=N.selectWidth/F,N.rotation!=S){M.save(),M.translate(N.position.x,N.position.y),M.rotate(N.rotation);var l=E._data,P=l.getWidth(),H=l.getHeight(),Y=N.scale,q=N.anchor;C={x:Y.x*-P*q.x,y:Y.y*-H*q.y,width:Y.x*P,height:Y.y*H}}Dj(M,N.selectType,{x:C.x-p,y:C.y-p,width:C.width+2*p,height:C.height+2*p}),N.rotation!=S&&M.restore(),M.stroke()}},dispose:function(){var G=this,u=G._htmlView;is.superClass.dispose.call(G),u&&(u.onHTMLRemoved&&u.onHTMLRemoved(),re(u))},_3O:function(){var q,C=this,y=C.s,s=C._data,I=C.gv,d=I.getShape(s),o=C.getBodyColor(),L=y("shape.border.color"),p=C._83o=d?{shape:d,_53o:C.getBodyColor("shape.background"),_27Q:Fr(y("shape.repeat.image"),o),shapeGradientPack:y("shape.gradient.pack"),shapeBorderGradientPack:y("shape.border.gradient.pack"),_54o:y("shape.border.width"),_55o:L,shapeBorderRepeatImage:Fr(y("shape.border.repeat.image"),L),_56o:y("shape.border.3d"),_57o:y("shape.border.3d.color"),_58o:y("shape.border.3d.accuracy"),shapeGradient:y("shape.gradient"),_59o:y("shape.gradient.color"),_60o:y("shape.border.pattern"),_61o:y("shape.border.cap"),_62o:y("shape.border.join"),shapeForeground:y("shape.foreground"),bodyColor:o,gray:y("2d.gray")}:{img:Fr(I.getImage(s),o),bodyColor:o,gray:y("2d.gray"),stretch:y("image.stretch")},R=p.img;R&&R.renderHTML?(C._htmlInfo&&C._htmlInfo.img!==R&&(C._htmlInfo=S),C._htmlInfo||(C._htmlInfo={img:R,cache:{}}),q=R.renderHTML(s,I,C._htmlInfo.cache)):C._htmlInfo=S,C._htmlView&&C._htmlView!==q&&(C._htmlView.onHTMLRemoved&&C._htmlView.onHTMLRemoved(),re(C._htmlView.getView?C._htmlView.getView():C._htmlView)),(C._htmlView=q)&&I.appendHTML(q)&&(q.onHTMLAddedSync&&q.onHTMLAddedSync(),q.onHTMLAdded&&Pm(q.onHTMLAdded)),p.rect=s.getRect(),p.position=s.p(),p.scale=s.getScale(),p.anchor=s.getAnchor(),p.rotation=s.getRotation(),d===Fi&&(p._63o=y("shape.depth"));var E=0;if(d)E=gk(S,p._54o/2,p._62o),C.s("shape.dash")&&(E=g(E,(C.s("shape.dash.width")||p._54o)/2));else if(R&&R.boundExtend)if(E=dd(R.boundExtend,s,I),R.boundExtendAbsolute){var n=s.getScale();E/=I._zoom*g(1,g(v(n.x),v(n.y)))}else if(!dd(R.fitSize,s,I)){var G=dd(R.width,s,I),f=dd(R.height,s,I);E*=g(s.getWidth()/G,s.getHeight()/f)}C._40O(p,E);var b=y("clip.percentage");if(b!=W&&(p.clipRect=oh(s.getAnchorRect(),y("clip.direction"),b)),d){var i=y("shape.fill.clip.percentage");i!=W&&(p.shapeClipRect=oh(s.getAnchorRect(),y("shape.fill.clip.direction"),i));var D=y("shape.foreground.clip.percentage");D!=W&&(p.shapeForegroundClipRect=oh(s.getAnchorRect(),y("shape.foreground.clip.direction"),D))
}},getPosition:function(n,m,g,_){var d=Cs(n,this._83o.rect,_);return d.x+=m,d.y+=g,d},_80o:function(D){var m=this,v=m.s,s=m.gv,y=m._data,N=m._83o,j=N.rect,x=N.position,g=N.rotation,k=N.anchor,i=N.scale,u=N.shape,Q=N.clipRect;if(!m._checkEmptyRect||j.width>0&&j.height>0){var C=y.getSize();if(C.x=-C.width*k.x,C.y=-C.height*k.y,Pk&&!Lc&&Tc(D,C.width,C.height),D.save(),Tc(D,x.x,x.y),ef(D,g),Sp(D,i.x,i.y),Q&&(D.beginPath(),D.rect(Q.x,Q.y,Q.width,Q.height),D.clip()),s._drawForChecking&&N.img&&dd(N.img.pixelPerfect,y,s)===!1)Xf(D,C.x,C.y,C.width,C.height,"#888888");else if(m.freeDraw)m.freeDraw(D,C,N);else if(u){var q,d,A,Y,_=N._60o,U=Tr(D,_),E=N._27Q,r=N._54o,F=N.shapeGradientPack,K=N.gray,z=D.lineJoin,W=D.lineCap,G=function(Q){return K?H.toGrayColor(Q):Q};"roundRect"===u?q=v("shape.corner.radius"):"polygon"===u?(q=v("shape.polygon.side"),d=v("shape.corner.radius"),A=v("shape.regular")):"arc"===u&&(q=v("shape.arc.from"),d=v("shape.arc.to"),A=v("shape.arc.close"),Y=v("shape.arc.oval")),D.lineJoin=N._62o,D.lineCap=N._61o;var Z=G(N._53o);if(Z||E||F){var p=N.shapeClipRect;p&&(D.save(),D.beginPath(),D.rect(p.x,p.y,p.width,p.height),D.clip()),Dj(D,u,C,q,d,A,Y),F?Id(D,F,function(Q){return Yn(Q,N.bodyColor)},!1,C):E?Cb(D,E,G(N.bodyColor),null,y,s):vh(D,Z,N.shapeGradient,G(N._59o),C),D.fill(),F&&D.restore(),p&&D.restore(),D!==U&&Dj(U,u,C,q,d,A,Y)}else Dj(U,u,C,q,d,A,Y);var T=N.shapeForeground;if(T){D.save();var a=N.shapeForegroundClipRect;a&&(D.beginPath(),D.rect(a.x,a.y,a.width,a.height),D.clip()),Dj(D,u,C,q,d,A,Y),vh(D,T,v("shape.foreground.gradient"),G(v("shape.foreground.gradient.color")),C),D.fill(),D.restore()}if(r>0){var O=v("shape.border.width.absolute");O&&(D.save(),D.setTransform(1,0,0,1,0,0)),D.lineWidth=r;var J=G(N._55o),w=N.shapeBorderGradientPack;w?Id(D,w,G,!0,C):N.shapeBorderRepeatImage?ro(D,N.shapeBorderRepeatImage,J,null,y,s):D.strokeStyle=J,D.stroke(),w&&D.restore(),O&&D.restore(),N._56o&&vl(D,J,G(N._57o),r,s._zoom,N._58o)}if(qm(D,_),v("shape.dash")){var t=v("shape.dash.width")||r;if(t>0){_=v("shape.dash.pattern");var U=Tr(D,_,m._2Q("shape.dash.offset"));U!==D&&Dj(U,u,C,q,d,A,Y),m._1Q(D,"shape",t,_)}}Ug(D,Z,N._63o,C),D.lineJoin=z,D.lineCap=W}else{var $=m.interactiveInfo;$&&(D.interactiveInfo=$.bodyInfo={compInfos:[],matrix:new Vb(g,x.x,x.y,i.x,i.y)}),N.gray&&(D.compGray=!0);var c=N.img;c&&c.cacheRule!=S&&(c=De(D,c,N.stretch,C.width,C.height,y,s,N.bodyColor)),xe(D,c,N.stretch,C.x,C.y,C.width,C.height,y,s,N.bodyColor),D.compGray=!1,D.interactiveInfo=S}D.restore()}m._39O(D,N)},_48O:function(){},_47O:function(){}});var zk=function(y,c){fb(zk,this,[y,c])},Df=function(J,H,z,t){var q=_h(J,H);return z=t?_(z,q):Wn(z,q),q?z/=q:z=0,{x:J.x+(H.x-J.x)*z,y:J.y+(H.y-J.y)*z}};Dh(zk,Ag,{_3O:function(){var B,L=this,r=L._data,s=L.gv,_=L.s,I=_(bk),A=r.isLooped(),M=_("edge.width"),v=L.getBodyColor("edge.color"),$=_("edge.center"),l=_("edge.offset"),u=s.getBorderColor(r),Y=u?_("border.width"):0,K=L.getSelectWidth(),t=r._40I,C=r._41I,J=L._78o=t&&C?{looped:A,type:I,width:M,center:$,color:v,repeatImage:Fr(_("edge.repeat.image"),v),borderColor:u,borderWidth:Y,_97o:K?L.getSelectColor():S,selectWidth:K,pattern:_("edge.pattern"),cap:_("edge.cap"),join:_("edge.join"),is3d:_("edge.3d"),_67o:_("edge.3d.color"),_66o:_("edge.3d.accuracy"),gray:_("2d.gray")}:S;if(J){var m=H.getEdgeType(I);if(m){var j=m(r,us(L,s,r,A,I),s,L._19Q);j.points&&j.points.size()>1?(J.edgeTypeInfo=j,B=Wk(J.edgeTypeInfo.points)):j[jf]&&j.rect&&(J.edgeTypeInfo=j,B=j.rect)}else{var p=_("edge.source.anchor.x"),h=_("edge.source.anchor.y"),R=_("edge.target.anchor.x"),Q=_("edge.target.anchor.y"),o=Xn(s,r,"source"),f=Xn(s,r,"target");if(I===We){var O=J.points=_(Fd)||Ve,P=O.size();J.segments=_("edge.segments");var a=p!==W||h!==W||zl(t),T=R!==W||Q!==W||zl(C);if(!$)if(l)a||(o=Df(o,P?O.get(0):f,l,P)),T||(f=Df(f,P?O.get(P-1):o,l,P));else{var k;a||(k=Ko(o,P?O.get(0):f,$q(s,t)),k&&(o={x:k[0],y:k[1]})),T||(k=Ko(P?O.get(P-1):o,f,$q(s,C)),k&&(f={x:k[0],y:k[1]}))}B=Mc(Wk(J.points),Wk(o,f))}else{var D=us(L,s,r,A,I);if(L._19Q||(D=-D),A)o=Dl(o),o.x=s.getNodeRect(t).x,J.radius=D,B={x:o.x-D,y:o.y-D,width:2*D,height:2*D};else{var x=_h(o,f),V=Wn(l,x),z={x:V,y:D},U={x:x-V,y:D},y=db(f.y-o.y,f.x-o.x),G=J.mat=new ur(y);if(J.orienAngle=y,J.angle=f.x<o.x?y+X:y,J.rect={x:z.x,y:z.y,width:U.x-z.x,height:0},J.origin=o,z=G.tf(z),z.x+=o.x,z.y+=o.y,U=G.tf(U),U.x+=o.x,U.y+=o.y,$){var Z={x:x,y:0};Z=G.tf(Z),Z.x+=o.x,Z.y+=o.y,B=Wk([o,z,U,Z]),J.c1=o,J.c2=Z}else B=Wk(z,U);o=z,f=U}}J.sourcePoint=o,J.targetPoint=f,r._lastSourcePoint=o,r._lastTargetPoint=f}var E=0;_("edge.dash")&&(E=_("edge.dash.width")||M);var e="square"===J.cap?.71:.5;gk(B,g(E*e,M*e+Y+K),J.join),L._68o(B)}},getRotation:function(Q,K,h){Q=Q||0;var T=this._78o;if(T){var n,g=T.angle,P=T.points,s=T.edgeTypeInfo;if(g!=S)return K?T.orienAngle+Q:g+Q;if(s&&s[jf])return s.getRotation?s.getRotation(this,Q,K,h):0;if(s&&s.points){var A=s.points;return n=A.size(),Th[h]?n&&0===n%2?Ic(A.get(n/2-1),A.get(n/2),K,Q):Q:ug[h]?Ic(A.get(0),A.get(1),K,Q):Ic(A.get(n-2),A.get(n-1),K,Q)}if(P)return n=P.size(),Th[h]?n&&0===n%2?Ic(P.get(n/2-1),P.get(n/2),K,Q):0===n?Ic(T.sourcePoint,T.targetPoint,K,Q):Q:ug[h]?Ic(T.sourcePoint,n?P.get(0):T.targetPoint,K,Q):Ic(n?P.get(n-1):T.sourcePoint,T.targetPoint,K,Q)}return Q},getPosition:function(y,b,O,m,u){var d=this._78o;if(d){var w,t=d.type,J=d.points,z=d.edgeTypeInfo,Z=d.sourcePoint,U=d.targetPoint;if(!t)return d.looped?{x:Z.x-d.radius+b,y:Z.y+O}:(u&&Z&&U&&(Z.x>U.x||Z.x===U.x&&Z.y>U.y)&&(y=Lq[y],O=-O),w=Cs(y,d.rect,m),w.x+=b,w.y+=O,w=d.mat.tf(w),w.x+=d.origin.x,w.y+=d.origin.y,w);if(z&&z[jf])return z.getPosition?z.getPosition(this,y,b,O,m,u):{x:(Z.x+U.x)/2,y:(Z.y+U.y)/2};if(J){var w,a=J.size();if(Th[y]){if(a){var $=a%2;if(0===$)return Fe(J.get(a/2-1),J.get(a/2),y,b,O,m,u);w=J.get((a-$)/2)}else w={x:(Z.x+U.x)/2,y:(Z.y+U.y)/2};return w=Cs(y,{x:w.x,y:w.y,width:0,height:0},m),w.x+=b,w.y+=O,w}return ug[y]?Fe(Z,a?J.get(0):U,y,b,O,m,u):Fe(a?J.get(a-1):Z,U,y,b,O,m,u)}if(z){var e=z.points,a=e.size();if(Th[y]){var $=a%2;return 0===$?Fe(e.get(a/2-1),e.get(a/2),y,b,O,m,u):(w=e.get((a-$)/2),w=Cs(y,{x:w.x,y:w.y,width:0,height:0},m),w.x+=b,w.y+=O,w)}return ug[y]?Fe(e.get(0),e.get(1),y,b,O,m,u):Fe(e.get(a-2),e.get(a-1),y,b,O,m,u)}}return kq},_42:function(I){this._78o&&zk.superClass._42.call(this,I)},drawPath:function(Z,p){Z.beginPath();var m=p.type,E=p.points,j=p.segments,M=p.edgeTypeInfo;if(!m||E){var W=p.sourcePoint,b=W.x,R=W.y,o=p.targetPoint,s=o.x,A=o.y;if(m)if(j){var B=new Xd({x:b,y:R});B.addAll(E),B.add({x:s,y:A}),$j(Z,B,j)}else Z.moveTo(b,R),E.each(function(G){Z.lineTo(G.x,G.y)}),Z.lineTo(s,A);else p.looped?Z.arc(b,R,p.radius,0,z,!0):p.center?(Z.moveTo(p.c1.x,p.c1.y),Z.lineTo(b,R),Z.lineTo(s,A),Z.lineTo(p.c2.x,p.c2.y)):(Z.moveTo(b,R),Z.lineTo(s,A))}else M&&(M.points?$j(Z,M.points,M.segments):M[jf]&&M[jf](Z,M))},_80o:function(c){var X=this,B=X.s,i=X._78o,z=i.width,x=i.selectWidth,G=i.borderWidth,S=i.repeatImage,W=c.lineJoin,Z=c.lineCap,g=i.gray,F=i.pattern;c.lineJoin=i.join,c.lineCap=i.cap,X.drawPath(Tr(c,F),i);var s=B("edge.width.absolute");s&&(c.save(),c.setTransform(1,0,0,1,0,0)),x&&(c.strokeStyle=i._97o,c.lineWidth=z+2*(G+x),c.stroke()),G&&(c.strokeStyle=g?H.toGrayColor(i.borderColor):i.borderColor,c.lineWidth=z+2*G,c.stroke());var v=g?H.toGrayColor(i.color):i.color;if(S?ro(c,S,v,null,X._data,X.gv):c.strokeStyle=v,c.lineWidth=z,c.stroke(),i.is3d){var t=g?H.toGrayColor(i._67o):i._67o;vl(c,v,t,z,X.gv._zoom,i._66o)}if(qm(c,F),B("edge.dash")){F=B("edge.dash.pattern");var E=Tr(c,F,X._2Q("edge.dash.offset"));E!==c&&X.drawPath(E,i),X._1Q(c,"edge",B("edge.dash.width")||z,F)}s&&c.restore(),c.lineJoin=W,c.lineCap=Z},_48O:function(){},_47O:function(){}});var Ek=function(e,r){fb(Ek,this,[e,r])};Dh(Ek,is,{_3O:function(){var j,f,O=this,n=O.s,k=O._data,T=O.gv;if(O._88I=S,k.isExpanded()&&k.eachChild(function(b){if(af(b)){var O=T.getBoundsForGroup(b);O&&(f||(f=[]),f.push(O),j=Mc(j,O))}}),j){var d=T.getLabel(k),$=n("group.type"),G=n("group.border.width")||0,t=n("group.border.width.absolute"),p=G/2;t&&(G/=T._zoom),j=Kr($,f,j),rf(j,k,"group.padding",1),Qf(j,G);var W=O._88I={type:$,rect:j,_64o:j};if(!$&&d!=S){var u,X=O.labelInfo={label:d,color:n("group.title.color"),font:n("group.title.font"),align:n("group.title.align")},a=yf(X,d),y=a.width+G,E=a.height+G,I=n("group.title.align"),J=n("group.title.orientation");if(J===Dr||J===Er?(j.height+=G,y>j.width&&(j.width=y)):(J===Vn||J===_k)&&(j.width+=G,y>j.height&&(j.height=y)),u=I===Vn?j.x:I===_k?j.x+j.width-y:j.x+j.width/2-y/2,J===Er)W.titleRect={x:j.x,y:j.y+j.height,width:j.width,height:E},W.rect={x:j.x,y:j.y,width:j.width,height:j.height+E},X.rect={x:u,y:j.y+j.height,width:y,height:E};else if(J===Vn){var P=W.titleRect={x:j.x-E,y:j.y,width:E,height:j.height};W.rect={x:j.x-E,y:j.y,width:j.width+E,height:j.height},X.rect={x:P.x+E/2-j.height/2,y:P.y+j.height/2-E/2,width:j.height,height:E},X.rotation=-Math.PI/2}else if(J===_k){var P=W.titleRect={x:j.x+j.width,y:j.y,width:E,height:j.height};W.rect={x:j.x,y:j.y,width:j.width+E,height:j.height},X.rect={x:P.x+E/2-j.height/2,y:P.y+j.height/2-E/2,width:j.height,height:E},X.rotation=Math.PI/2}else W.titleRect={x:j.x,y:j.y-E,width:j.width,height:E},W.rect={x:j.x,y:j.y-E,width:j.width,height:j.height+E},X.rect={x:u,y:j.y-E-p,width:y,height:E+G}}O._40O(W,n("group.border.width")/2)}else Ek.superClass._3O.call(O)},getPosition:function(L,q,T,D){var M=this._88I;if(M){var s=Cs(L,M.rect,D);return s.x+=q,s.y+=T,s}return Ek.superClass.getPosition.apply(this,arguments)},_24O:function(t,z){var r=this._88I;(!r||r.type||"label2"===t)&&Ek.superClass._24O.call(this,t,z)},_80o:function(Z){var l=this,e=l._88I;if(e){var v=l._data,E=l.s,H=l.gv,u=e.type,K=e.rect,x=e._64o,d=e.titleRect,$=l.getBodyColor(),J=Fr(E("group.image"),$),P=E("group.image.stretch"),T=l.getBodyColor("group.background"),X=Fr(E("group.repeat.image"),$),m=E("group.gradient.pack"),S=E("group.gradient"),Y=E("group.gradient.color"),L=E("group.border.width"),s=E("group.border.color"),b=E("group.border.pattern"),W=E("group.title.orientation"),O=E("group.depth"),g=E("group.border.radius"),G=E("group.border.join"),r=E("group.border.cap"),C=E("group.border.width.absolute");C&&(L/=H._zoom);var c=s,z=E("group.border.repeat.image");if(z&&(z=Fr(z,s))&&(c=Ho(Z,z,s,null,v,H)),u){var I=Z.lineJoin,w=Z.lineCap;if(Z.lineJoin=G,Z.lineCap=r,J){if(Z.save(),Dj(Z,u,K,g),Z.clip(),xe(Z,J,P,K.x,K.y,K.width,K.height,v,H,$),Z.restore(),L>0){var a=Tr(Z,b);Dj(a,u,K,g),Z.lineWidth=L,Z.strokeStyle=c,Z.stroke(),qm(Z,b)}}else{var a=Tr(Z,b);T||X||m?(Dj(Z,u,K,g),m?Id(Z,m,function(f){return Yn(f,$)},!1,K):X?Cb(Z,X,$,null,v,H):vh(Z,T,S,Y,K),Z.fill(),m&&Z.restore(),Z!==a&&Dj(a,u,K,g)):Dj(a,u,K,g),L>0&&(Z.lineWidth=L,Z.strokeStyle=c,Z.stroke()),qm(Z,b),u===Fi&&Ug(Z,T,O,K)}Z.lineJoin=I,Z.lineCap=w}else{var D=E("group.title.background");if((!g||0>g)&&(g=0),J)xe(Z,J,P,x.x,x.y,x.width,x.height,v,H,l.getBodyColor());else if(T||X)if(X?Cb(Z,X,$,null,v,H):vh(Z,T,S,Y,x),0===L)Dj(Z,Fi,x),Z.fill(),Ug(Z,T,O,x);else{switch(Z.beginPath(),W){case Er:Hf(Z,x.x,x.y,x.width,x.height,g,g,0,0);break;case Vn:Hf(Z,x.x,x.y,x.width,x.height,0,g,0,g);break;case _k:Hf(Z,x.x,x.y,x.width,x.height,g,0,g,0);break;case Dr:Hf(Z,x.x,x.y,x.width,x.height,0,0,g,g)}Z.fill()}if(d&&D)if(0===L)Xf(Z,d.x,d.y,d.width,d.height,D),Ug(Z,D,O,d);else{switch(Z.beginPath(),Z.fillStyle=D,W){case Er:Hf(Z,d.x,d.y,d.width,d.height,0,0,g,g);break;case Vn:Hf(Z,d.x,d.y,d.width,d.height,g,0,g,0);break;case _k:Hf(Z,d.x,d.y,d.width,d.height,0,g,0,g);break;case Dr:Hf(Z,d.x,d.y,d.width,d.height,g,g,0,0)}Z.fill()}if(L>0){var a=Tr(Z,b);if(Dj(a,"roundRect",K,g),Z.save(),Z.lineWidth=L,Z.strokeStyle=c,Z.lineJoin=G,Z.lineCap=r,Z.closePath(),Z.stroke(),d&&E("group.splitLine")){var y=d.x,F=d.y,Q=d.width,j=d.height;Z.beginPath(),W===Er?(Z.moveTo(y,F),Z.lineTo(y+Q,F)):W===Vn?(Z.moveTo(y+Q,F),Z.lineTo(y+Q,F+j)):W===_k?(Z.moveTo(y,F),Z.lineTo(y,F+j)):(Z.moveTo(y,F+j),Z.lineTo(y+Q,F+j))}Z.stroke(),Z.restore(),qm(a,b)}}l._39O(Z,e)}else Ek.superClass._80o.call(l,Z)}});var Tk=function(O,b){fb(Tk,this,[O,b])};Dh(Tk,is,{_80o:function(s){this._39O(s,this._83o)}});var Jk=function(j,w){fb(Jk,this,[j,w])};Dh(Jk,is,{_3O:function(){var k=this,u=k._data,U=k.s,y=k.gv,w=u.getPoints(),A=y.getBorderColor(u),f=A?U("border.width"):0,J=k.getSelectWidth(),B=U("shape.border.width"),_=u.getRect(),o=u.getAnchorRect(),m=y.getBodyColor(u),Z=U("shape.border.color"),M=k._99o=w.isEmpty()?S:{rect:_,rotation:u.getRotation(),fillRule:U("shape.fill.rule"),scale:u.getScale(),position:u.p(),points:w,segments:u.getSegments(),bodyColor:m,borderColor:A,borderWidth:f,_94o:U("shape.border.3d"),_95o:U("shape.border.3d.color"),_96o:U("shape.border.3d.accuracy"),_97o:J?k.getSelectColor():S,selectWidth:J,_53o:U("shape.background"),_27Q:Fr(U("shape.repeat.image"),m),shapeGradientPack:U("shape.gradient.pack"),shapeBorderGradientPack:U("shape.border.gradient.pack"),_54o:B,_55o:Z,shapeBorderRepeatImage:Fr(U("shape.border.repeat.image"),Z),shapeGradient:U("shape.gradient"),_59o:U("shape.gradient.color"),_60o:U("shape.border.pattern"),_61o:U("shape.border.cap"),_62o:U("shape.border.join"),shapeForeground:U("shape.foreground"),gray:U("2d.gray")};if(M){o.x+=M.position.x,o.y+=M.position.y,M.gradientRect=o;var t=u.getScale(),G=g(1,g(v(t.x),v(t.y)));U("shape.dash")&&U("shape.dash.width")>B&&(B=U("shape.dash.width"));var c,a=U("shape.border.width.absolute");c=a?(B+f+J)/k.gv._zoom/G:B*("square"===M._61o?.71:.5)+f+J/k.gv._zoom/G,c&&(c*=G,_=Dl(_),gk(_,c,M._62o)),k._68o(_);var s=U("clip.percentage");s!=W&&(M.clipRect=oh(u.getAnchorRect(),U("clip.direction"),s));var C=U("shape.fill.clip.percentage");C!=W&&(M.shapeClipRect=oh(u.getAnchorRect(),U("shape.fill.clip.direction"),C));var K=U("shape.foreground.clip.percentage");K!=W&&(M.shapeForegroundClipRect=oh(u.getAnchorRect(),U("shape.foreground.clip.direction"),K))}},getPosition:function(F,j,N,L){var d=this._99o;if(d){var C=Cs(F,d.rect,L);return C.x+=j,C.y+=N,C}return kq},_42:function(W){this._99o&&Jk.superClass._42.call(this,W)},_80o:function(R){var m,j=this,c=j.s,F=j._99o,a=F.position,i=F.scale,b=F.rotation,s=F.borderWidth,l=j.gv._zoom,C=F.selectWidth/l,E=F._27Q,u=F.shapeGradientPack,h=F._54o,p=F.clipRect,d=F.shapeClipRect,P=F.points,V=F.segments,J=j._data.isClosePath(),Q=F.fillRule,Y=F.gray,G=function(K){return Y?H.toGrayColor(K):K},W=G(F._53o),I=W||E||u;R.save(),Tc(R,a.x,a.y),ef(R,b),Sp(R,i.x,i.y),p&&(R.beginPath(),R.rect(p.x,p.y,p.width,p.height),R.clip()),I&&d&&(R.save(),R.beginPath(),R.rect(d.x,d.y,d.width,d.height),R.clip()),n.Default.extractShapeTranslation?(P=Dl(P),P.forEach(function(u){u.x-=a.x,u.y-=a.y})):Tc(R,-a.x,-a.y);var T=c("shape.border.width.absolute"),B=F._60o;T&&B&&(B=B.map(function(V){return V*l}));var U=Tr(R,B),A=R.lineJoin,K=R.lineCap;R.lineJoin=F._62o,R.lineCap=F._61o;var X=G(F.bodyColor);I?($j(R,P,V,J),u?Id(R,u,function(o){return Yn(o,F.bodyColor)},!1,F.rect):E?Cb(R,E,X,null,j._data,j.gv):(m=X?X:W,vh(R,m,F.shapeGradient,G(F._59o),F.gradientRect)),R.fill(Q),u&&R.restore(),d&&(R.restore(),Tc(R,-a.x,-a.y)),U!==R&&$j(U,P,V,J)):$j(U,P,V,J);var q=F.shapeForeground;if(q){R.save();var Z=F.shapeForegroundClipRect;Z&&(Tc(R,a.x,a.y),R.beginPath(),R.rect(Z.x,Z.y,Z.width,Z.height),R.clip(),Tc(R,-a.x,-a.y)),$j(R,P,V,J),vh(R,q,c("shape.foreground.gradient"),G(c("shape.foreground.gradient.color")),F.gradientRect),R.fill(Q),R.restore()}if(T&&(R.save(),R.setTransform(1,0,0,1,0,0)),C&&(R.strokeStyle=F._97o,R.lineWidth=h+2*(s+C),R.stroke()),s&&(R.strokeStyle=G(F.borderColor),R.lineWidth=h+2*s,R.stroke()),h){m=G(F._55o);var L=F.shapeBorderGradientPack;L?Id(R,L,G,!0,F.rect):F.shapeBorderRepeatImage?ro(R,F.shapeBorderRepeatImage,m,null,j._data,j.gv):(!W&&X&&(m=X),R.strokeStyle=m),R.lineWidth=h,R.stroke(),L&&R.restore(),F._94o&&vl(R,m,G(F._95o),h,l,F._96o)}if(qm(R,B),c("shape.dash")){var f=c("shape.dash.width")||h;if(f>0){B=c("shape.dash.pattern"),T&&(B=B.map(function(A){return A*l}));var U=Tr(R,B,j._2Q("shape.dash.offset"));U!==R&&$j(U,P,V,J),j._1Q(R,"shape",f,B)}}T&&R.restore(),R.lineJoin=A,R.lineCap=K,R.restore()},_48O:function(){},_47O:function(){}});var fh=function(c,D){fb(fh,this,[c,D])};Dh(fh,Jk,{getRotation:function(){var X=new Ai,W=new Ai,L=new Vb;return function(V,Z,x){V=V||0;var y=this._data,D=y.getPoints(),o=D.size();if(o>1){var w,u,i=y.p(),g=y.getScale();if(L.identity().translate(-i.x,-i.y).scale(g.x,g.y).translate(i.x,i.y),Th[x]){var h=o%2,C=(o-h)/2;w=D.get(C-1),u=D.get(C)}else ug[x]?(w=D.get(0),u=D.get(1)):(w=D.get(o-2),u=D.get(o-1));return L.apply(w,X),L.apply(u,W),Ic(X,W,Z,V)}return V}}(),getPosition:function(){var F=new Ai,E=new Ai,M=new Ai;return function(R,k,y,w,b){var N=this._data,r=N.getPoints(),Q=r.size();if(Q>1){var U,p,C=N.getPointsMatrix2d();if(Th[R]){var d=Q%2,t=(Q-d)/2;if(U=r.get(t-1),p=r.get(t),0!==d){var v=Cs(R,kq,w);return v.x+=k,v.y+=y,C.apply(U,F),C.apply(p,E),C.identity().rotate(M.copy(E).sub(F).angle()).tf(v).add(E)}}else ug[R]?(U=r.get(0),p=r.get(1)):(U=r.get(Q-2),p=r.get(Q-1));return C.apply(U,F),C.apply(p,E),Fe(F,E,R,k,y,w,b)}return kq}}()});var qo=function(y,Q){fb(qo,this,[y,Q])};Dh(qo,is,{_3O:function(){var L=this;qo.superClass._3O.call(L);var _=L.s,m=L._83o;L._82o=m.img||m.shape?S:{background:L.getBodyColor("grid.background"),depth:_("grid.depth"),rect:m.rect,_88o:_("grid.cell.depth"),cellBorderColor:_("grid.cell.border.color"),_89o:_("grid.row.count"),_90o:_("grid.column.count"),block:_("grid.block"),_91o:_("grid.block.color"),_92o:_("grid.block.padding"),_93o:_("grid.block.width")}},_80o:function(C){var T=this,W=T._82o;if(!W)return qo.superClass._80o.call(T,C),void 0;var l,B,U=T._data,v=W.background,h=W.rect,M=W.block,b=W._91o,J=W._92o,w=W._93o,x=W._88o,H=W.cellBorderColor,E=W._89o,N=W._90o;if(v)if(Xf(C,h.x,h.y,h.width,h.height,v),Ug(C,v,W.depth,h),x)for(l=0;E>l;l++)for(B=0;N>B;B++)h=U.getCellRect(l,B),h&&Ug(C,v,x,h);else if(H){for(C.beginPath(),l=0;E>l;l++)for(B=0;N>B;B++)h=U.getCellRect(l,B),h&&C.rect(h.x,h.y,h.width,h.height);C.strokeStyle=H,C.lineWidth=1,C.stroke()}if("h"===M)for(l=0;E>l;l++)h=Mc(U.getCellRect(l,0),U.getCellRect(l,N-1)),Qf(h,J),Qd(C,b,h.x,h.y,h.width,h.height,w);else if("v"===M)for(B=0;N>B;B++)h=Mc(U.getCellRect(0,B),U.getCellRect(E-1,B)),Qf(h,J),Qd(C,b,h.x,h.y,h.width,h.height,w);T._39O(C,T._83o)}});var Gf=function(Q,n){fb(Gf,this,[Q,n])},un=m?Zj().getContext("2d"):S;Dh(Gf,is,{_checkEmptyRect:!1,_81o:function(){var H=this._data,$=Gf.superClass._81o.call(this),Y=H.s("text");if(Y!=S){Y+="";var Z,K=H.s("text.font"),m=H.s("text.align"),C=H.s("text.vAlign"),e=H.s("text.wrap"),q=H.s("text.vertical"),y=H.s("text.vertical.gap"),u=H.s("text.letter.gap")||0,t=H.getWidth(),f=H.getHeight();if(null==y&&(y=1),q){var k;k=e?kh(Y,f,K,u,q,y):[Y];var F=(k.length-1)*u,x=0;un.textBaseline=Dr,un.font=K,k.forEach(function(e){for(var C=e.length,S=0,o=(C-1)*y,s=0;C>s;s++){var J=un.measureText(e[s]);o+=J.fontBoundingBoxDescent||xs(K,e[s]).height,S=g(S,J.width)}F+=S,x=g(o,x)});var j=(k.length-1)*u;k.forEach(function(J){j+=J}),Z={width:F,height:x}}else{var k=e?kh(Y,t,K,u,q,y):Y.split("\n"),h=k.length;if(h>1){var M=xs(K,Y).height,F=0,x=M*h+y*(h-1);k.forEach(function(d){F=g(F,xs(K,d).width)}),Z={width:F,height:x}}else Z=xs(K,Y),u&&(Z.width+=(Y.length-1)*u)}var P,Q,L=Z.width,N=Z.height,D=H.getAnchor();"left"===m?P=-t*D.x:"center"===m?P=-t*D.x+(t-L)/2:"right"===m&&(P=t*(1-D.x)-Z.width),"top"===C?Q=-f*D.y:"middle"===C?Q=-f*D.y+(f-N)/2:"bottom"===C&&(Q=f*(1-D.y)-Z.height);var r,R=H.getMatrix();if(r=Wk([R.tf(P,Q),R.tf(P+L,Q),R.tf(P+L,Q+N),R.tf(P,Q+N)]),$=Mc($,r),$&&H.s("text.shadow")){var i=Dl($);i.x+=H.s("text.shadow.offset.x"),i.y+=H.s("text.shadow.offset.y"),Qf(i,H.s("text.shadow.blur")),$=Mc($,i)}}return $}});var Hg=Sb.Interactor=function(Z){this.gv=this._graphView=Z};vs("Interactor",o,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(y){this.gv.fi(y)},setCursor:function(q){bc||this.gv.setCursor(q)},startDragging:function(R){var p=this;p._lastClientPoint=Rh(R),p._lastLogicalPoint=p.gv.lp(R),xl(p,R)},clearDragging:function(){var B=this;B._lastClientPoint=B._lastLogicalPoint=B._logicalPoint=S},autoScroll:function(l){return this.gv.autoScroll(l,this._lastClientPoint)}});var lo=S,io=function(o){lo.handleWindowTouchMove(o)},Sg=function(X){lo.handleWindowTouchEnd(X),N(e,nd,io),N(e,hs,Sg),lo=S},_r=function(j){lo.handleWindowMouseMove(j)},xk=function(_){lo.handleWindowMouseUp(_),N(e,ag,_r),N(e,Cp,xk),lo=S},ns=function(s,E){if(s!==lo){var t=Aq(E);lo?t?lo.handleWindowTouchEnd(E):lo.handleWindowMouseUp(E):t?(Z(e,nd,io),Z(e,hs,Sg)):(Z(e,ag,_r),Z(e,Cp,xk)),lo=s}},oe=function(d){var f=this;f.gv=d,f._is2d=d instanceof Sb.GraphView,f._eventListeners={},["mousedown","mousemove","mouseleave","touchstart","touchmove",tr,"wheel"].forEach(function(G){f.addListener(G)}),f.initImageResource()};Dh(oe,Hg,{enableVR:function(g){var w=this;!!w._vrEnable!==g&&(w._vrEnable=g,g?w.gv.vr.mp(w.onVRControllerChange,w):w.gv.vr.ump(w.onVRControllerChange,w))},onVRControllerChange:function(s){var g=this,b=s.property,z=s.newValue,w=z.id,C=g.gv.vr.getController(w),O=C.getRay();if(O){O.controllerId=w;var k=g.gv.vr.getRayEventType(O,b,z._62O);switch(k){case"down":g.handle_mousedown(O);break;case"up":lo&&xk(O);break;case"move":g.handle_mousemove(O),lo&&g.handleWindowMouseMove(O)}}},setPreventEventDefault:function(_,i){var Z=this,B=Z._eventListeners[_];B?B._prevent=i:Z._eventListeners[_]=B={_removal:W,_prevent:i}},removeListener:function(G){var b=this,t=b._eventListeners[G];t&&t._removal&&(t._removal(),t._removal=W)},addListener:function(s){var V=this,j=V._eventListeners[s];if(j||(V._eventListeners[s]=j={_removal:W,_prevent:!0}),!j||!j._removal){var Q=function(h){j._prevent&&H.preventDefault(h),V.disabled||V.gv._48Q||("wheel"===s?fc(V,h):V["handle_"+s](h))};Z(V.gv.getView(),s,Q),j._removal=function(){N(V.gv.getView(),s,Q)}}},handleWindowTouchMove:function(F){this.handleWindowMouseMove(F)},handleWindowMouseMove:function(M){return!this.downInfo||Aq(M)&&1!==Nc(M)?(this.isDragging&&(this.handleDownInfo("onEndDrag",M),this.isDragging=!1),void 0):(this.isDragging?this.handleDownInfo("onDrag",M):(this.handleDownInfo("onBeginDrag",M),this.isDragging=!0),void 0)},handleWindowTouchEnd:function(D){this.handleWindowMouseUp(D)},handleWindowMouseUp:function(m){if(this.isDragging&&(this.handleDownInfo("onEndDrag",m),this.isDragging=!1),this.downInfo){var h=this.handle("onUp",m);if(h&&h.data===this.downInfo.data){this.handleMissingUp(m);var X=this,O=2===m.button?"onContextMenu":"onClick";if(!X._dbclickTimer)return X._dbclickTimer=Yk(function(){delete X._dbclickTimer,X.handleClick(m,O,h),this.downInfo=S},H.clickDelay),void 0;gp(X._dbclickTimer),delete X._dbclickTimer,O="onDoubleClick",X.handleClick(m,O,h)}else this.handleDownInfo("onUp",m);this.downInfo=S,this.downComps=S}},handle_mouseleave:function(i){var F=this,K=F.gv;F._hoverTimer&&(gp(F._hoverTimer),delete F._hoverTimer);var x=F.currentInfo?F.currentInfo.data:S;if(x){x.s("onLeave")&&x.s("onLeave")(i,x,K),F.fire("data","onLeave",i,x);var P=F.currentInfo?F.currentInfo.hits:S;if(P)for(var R in P)F.handleLeave(i,R);F.currentInfo=S}},handle_mousewheel:function(u){u.scrollDelta=u.wheelDelta/40,this.handle("onScroll",u)},handle_DOMMouseScroll:function(q){q.scrollDelta=2===q.axis?-q.detail:0,this.handle("onScroll",q)},handle_touchstart:function(q){this.handle_mousedown(q)},handle_touchmove:function(y){this.handle("onMove",y)},handle_mousedown:function(n){this.isDragging&&(this.handleDownInfo("onEndDrag",n),this.isDragging=!1),this.downComps=[],this.downInfo=this.handle("onDown",n),this.downInfo&&ns(this,n)},handle_mousemove:function(G){var t=this,W=t.gv;if(t._hoverTimer&&(gp(t._hoverTimer),delete t._hoverTimer),!W._panning&&!W._moving){var V,Q,F,u=t.handle("onMove",G),n=this.currentInfo?this.currentInfo.data:S,z=this.currentInfo?this.currentInfo.hits:S;if(u&&(Q=u.data,F=u.hits,t._hoverTimer=Yk(function(){gp(t._hoverTimer),delete t._hoverTimer,t.handle("onHover",G,u)},W.getHoverDelay()||H.hoverDelay)),Q!==n){if(n&&(n.s("onLeave")&&n.s("onLeave")(G,n,W),this.fire("data","onLeave",G,n)),Q&&(Q.s("onEnter")&&Q.s("onEnter")(G,Q,W),this.fire("data","onEnter",G,Q)),z)for(V in z)this.handleLeave(G,V);if(F)for(V in F){var e=F[V],A=Q._interactPrefix=e.prefix,a=A&&Q.a(A+"onEnter")||e.target.onEnter;a&&a.call(e.target,G,Q,W,e.point,e.width,e.height),this.fire(e.type,"onEnter",e.event,e.data,e.image,e.comp,e.point,e),Q._interactPrefix=null}}else{if(z)for(V in z)F&&F[V]||this.handleLeave(G,V);if(F)for(V in F)if(!z||!z[V]){var e=F[V],A=Q._interactPrefix=e.prefix,a=A&&Q.a(A+"onEnter")||e.target.onEnter;a&&a.call(e.target,G,Q,W,e.point,e.width,e.height),this.fire(e.type,"onEnter",e.event,e.data,e.image,e.comp,e.point,e),Q._interactPrefix=null}}this.currentInfo=u}},handle:function(S,M,E){var m,D=this,x=D.gv;if(D._is2d){if(E=E||x.getDataInfoAt(M),!E||!x.isInteractive(E.data))return;if(m=E.ui.interactiveInfo){var A,N=E.data;if(N.s(S)&&N.s(S)(M,N,x),this.fire("data",S,M,N),"body"===E.part&&m.bodyInfo)A="body",E.hits=this.handleImage(A,x.getImage(N),S,M,N,E.point,m.bodyInfo);else if("icons"===E.part&&m._38o){var R=m._38o[E.name];R&&R[E.index]&&(A="icons|"+E.name+"|"+E.index,E.hits=this.handleImage(A,E.icon,S,M,N,E.point,R[E.index]))}}return E}var N,t;if(!E)if(M&&M instanceof n.Math.Ray&&x.isVREnabled()){var b=x.vr.intersectWorld(M);if(N=b.data,t=b.intersect,x.vr.renderRayDuringInteraction(M,N,t),!N)return;var P=x.getData3dUI(N);if(m=P.interactiveInfo,!m)return;E={data:N,part:t.part,ui:P}}else{if(E=this.getDataInfoAt(M),!E)return;E&&(E={data:E.data,part:E.part})}if(x.isInteractive(E.data)){if(!t){N=E.data;var P=x.getData3dUI(N);if(E.ui=P,m=P.interactiveInfo,!m)return E;if(t=x.intersectObject(M,N),!t)return E}N.s(S)&&N.s(S)(M,N,x),this.fire("data",S,M,N);var K,h=t.part;return"body"!==h&&(K=N.s(h+".image")||N.s("shape3d."+h+".image")),K||(K=N.s("all.image")||N.s("shape3d.image")),K?(m="object"==typeof K?m[K.uuid]:m[K],m&&m.bodyInfo?(E.part="body",E.interactiveInfo=m,E.point=this._convertUVToPoint(t.uv,m),E.image=K,E.hits=this.handleImage("body",K,S,M,N,E.point,m.bodyInfo),E):E):E}},_handleLeaveOrMissing:function(k,T,N){var m="leave"===k?this.currentInfo:this.downInfo;if(m){var o=m.interactiveInfo||m.ui.interactiveInfo;if(o){var c,x,C=m.data;if(this._is2d){if(x=this.gv.lp(T),"body"===m.part&&o.bodyInfo)c="body","leave"===k?this.handleLeaveImage(N,c,this.gv.getImage(C),T,C,x,o.bodyInfo):this.handleMissingUpImage(c,this.gv.getImage(C),T,C,x,o.bodyInfo);else if("icons"===m.part&&o._38o){var E=o._38o[m.name];E&&E[m.index]&&(c="icons|"+m.name+"|"+m.index,"leave"===k?this.handleLeaveImage(N,c,m.icon,T,C,x,E[m.index]):this.handleMissingUpImage(c,m.icon,T,C,x,E[m.index]))}}else{if(!o.bodyInfo)return;var J=this.gv.intersectObject(T,C);x=J&&J.uv?this._convertUVToPoint(J.uv,o):{x:1/0,y:1/0},"leave"===k?this.handleLeaveImage(N,"body",m.image,T,C,x,o.bodyInfo):this.handleMissingUpImage("body",m.image,T,C,x,o.bodyInfo)}}}},handleClick:function(y,h,J){var k=this,B=this.downInfo;if(B&&J){var w,i=J.interactiveInfo||J.ui.interactiveInfo,M=J.data,t=this.gv;if(M.s(h)&&M.s(h)(y,M,t),k.fire("data",h,y,M),i)if(this._is2d){if(B.part===J.part){var R=t.lp(y);"body"===J.part&&i.bodyInfo&&(w="body",this.handleClickImage(w,t.getImage(M),h,y,M,R,i.bodyInfo,J))}}else{if(!i.bodyInfo)return;var L=t.intersectObject(y,M);if(!L)return;R=this._convertUVToPoint(L.uv,i),this.handleClickImage("body",B.image,h,y,M,R,i.bodyInfo,J)}}},handleDownInfo:function(I,t){if(this.downInfo){var $=this.downInfo,L=this.gv,q=$.interactiveInfo||$.ui.interactiveInfo;if(q){var v,K=$.data;if(K.s(I)&&K.s(I)(t,K,L),this.fire("data",I,t,K),this._is2d){var H=L.lp(t);if("body"===$.part&&q.bodyInfo)v="body",this.handleDownInfoImage(v,L.getImage(K),I,t,K,H,q.bodyInfo);else if("icons"===$.part&&q._38o){var X=q._38o[$.name];X&&X[$.index]&&(v="icons|"+$.name+"|"+$.index,this.handleDownInfoImage(v,$.icon,I,t,K,H,X[$.index]))}}else{if(!q.bodyInfo)return;var V;if("onBeginDrag"===I?(V=L._raycaster.intersectObjectAndRecordTriangle(t,K),V&&(q.beginDragIntersectInfo=V.triangleInfo)):V=L.intersectObject(t,K),!V&&("onDrag"!==I&&"onEndDrag"!==I||!q.beginDragIntersectInfo||(V=L._raycaster.intersectLastTriangle(t,q.beginDragIntersectInfo)),!V))return;H=this._convertUVToPoint(V.uv,q),this.handleDownInfoImage("body",$.image,I,t,K,H,q.bodyInfo)}}}},fire:function(A,x,L,U,O,F,q,H){this.gv.fi({kind:x,type:A,event:L,data:U,image:O,comp:F,view:this.gv,point:q,width:H?H.width:W,height:H?H.height:W})},handleImage:function(i,R,k,D,y,c,r){var P={};if(R&&(R=Fr(R))){var K=this.gv,Q=r.rect,t=this.convertPoint(c,r);t.inRect&&(R[k]&&R[k](D,y,K,t,Q.width,Q.height),this.fire("image",k,D,y,R,W,t,Q),P[i+"|image"]={target:R,type:"image",image:R,data:y,event:D,point:t,width:Q.width,height:Q.height});for(var a,V=r.compInfos,G=R,O=V.length-1;O>=0;O--){var j=V[O],C=j.comp;if(t=this.convertPoint(c,j,G,C,K,y),t.inRect){Q=j.rect;var B=y._interactPrefix=j.prefix,$=B&&y.a(B+k)||C[k];if($&&(a=$.call(C,D,y,K,t,Q.width,Q.height)),this.fire("comp",k,D,y,R,C,t,Q),a!==!0&&(R=Q.image)&&(R[k]&&(a=R[k](D,y,K,t,Q.width,Q.height)),this.fire("image",k,D,y,R,W,t,Q)),y._interactPrefix=null,P[i+"|"+O]={target:C,type:"comp",comp:C,image:R,data:y,event:D,point:t,width:Q.width,height:Q.height,prefix:B},this.downComps&&this.downComps.push(C),R&&(P[i+"|"+O+"|image"]={target:R,type:"image",image:R,data:y,event:D,point:t,width:Q.width,height:Q.height,prefix:B}),a===!0)break}}}return P},handleLeave:function(F,$){return this._handleLeaveOrMissing("leave",F,$)},handleMissingUp:function(n){return this._handleLeaveOrMissing("missing",n)},handleLeaveImage:function(b,M,I,Y,H,x,p){if(I&&(I=Fr(I))){var V=this.gv,R=p.rect,m=this.convertPoint(x,p);b===M+"|image"&&(I.onLeave&&I.onLeave(Y,H,V,m,R.width,R.height),this.fire("image","onLeave",Y,H,I,W,m,R));for(var c,n=p.compInfos,e=I,h=n.length-1;h>=0;h--){var E=n[h],w=E.comp;m=this.convertPoint(x,E,e,w,V,H),R=E.rect;var U=H._interactPrefix=E.prefix;if(b===M+"|"+h){var t=U&&H.a(U+"onLeave")||w.onLeave;t&&(c=t.call(w,Y,H,V,m,R.width,R.height)),this.fire("comp","onLeave",Y,H,I,w,m,R)}if(c!==!0&&(I=R.image)&&b===M+"|"+h+"|image"&&(I.onLeave&&(c=I.onLeave(Y,H,V,m,R.width,R.height)),this.fire("image","onLeave",Y,H,I,W,m,R)),H._interactPrefix=null,c===!0)break}}},handleMissingUpImage:function(n,h,Q,M,o,I){var k="onUp",m=this.downInfo.hits;if(m&&h&&(h=Fr(h))){var V=this.gv,T=I.rect,d=this.convertPoint(o,I);!d.inRect&&m[n+"|image"]&&(h[k]&&h[k](Q,M,V,d,T.width,T.height),this.fire("image",k,Q,M,h,W,d,T));for(var s,H=I.compInfos,j=h,i=H.length-1;i>=0;i--){var w=H[i],b=w.comp;if(d=this.convertPoint(o,w,j,b,V,M),!d.inRect){T=w.rect;var P=M._interactPrefix=w.prefix;if(m[n+"|"+i]){var v=P&&M.a(P+k)||b[k];v&&(s=v.call(b,Q,M,V,d,T.width,T.height)),this.fire("comp",k,Q,M,h,b,d,T)}if(s!==!0&&(h=T.image)&&m[n+"|"+i+"|image"]&&(h[k]&&(s=h[k](Q,M,V,d,T.width,T.height)),this.fire("image",k,Q,M,h,W,d,T)),M._interactPrefix=null,s===!0)break}}}},handleDownInfoImage:function(u,e,P,N,q,E,M){var K=this.downInfo.hits;if(K&&e&&(e=Fr(e))){var H=this.gv,t=M.rect,U=this.convertPoint(E,M);K[u+"|image"]&&(e[P]&&e[P](N,q,H,U,t.width,t.height),this.fire("image",P,N,q,e,W,U,t));for(var s,G=M.compInfos,v=e,O=G.length-1;O>=0;O--){var o=G[O],c=o.comp;U=this.convertPoint(E,o,v,c,H,q),t=o.rect;var $=q._interactPrefix=o.prefix,Q=["onDrag","onEndDrag"].indexOf(P)>=0;if(!Q&&K[u+"|"+O]||Q&&this.downComps&&this.downComps.indexOf(c)>=0){var D=$&&q.a($+P)||c[P];D&&(s=D.call(c,N,q,H,U,t.width,t.height)),this.fire("comp",P,N,q,e,c,U,t)}if(s!==!0&&(e=t.image)&&K[u+"|"+O+"|image"]&&(e[P]&&(s=e[P](N,q,H,U,t.width,t.height)),this.fire("image",P,N,q,e,W,U,t)),q._interactPrefix=null,s===!0)break}}},handleClickImage:function(n,Y,P,u,g,N,B,l){var C=this.downInfo.hits,p=l.hits;if(C&&Y&&(Y=Fr(Y))){var L=this.gv,E=B.rect,Z=this.convertPoint(N,B);C[n+"|image"]&&(Y[P]&&Y[P](u,g,L,Z,E.width,E.height),this.fire("image",P,u,g,Y,W,Z,E));for(var V,F=B.compInfos,I=Y,x=F.length-1;x>=0;x--){var $=F[x],m=$.comp;Z=this.convertPoint(N,$,I,m,L,g),E=$.rect;var e=g._interactPrefix=$.prefix;
if(C[n+"|"+x]&&p[n+"|"+x]){var s=e&&g.a(e+P)||m[P];s&&(V=s.call(m,u,g,L,Z,E.width,E.height)),this.fire("comp",P,u,g,Y,m,Z,E)}if(V!==!0&&(Y=E.image)&&C[n+"|"+x+"|image"]&&(Y[P]&&(V=Y[P](u,g,L,Z,E.width,E.height)),this.fire("image",P,u,g,Y,W,Z,E)),g._interactPrefix=null,V===!0)break}}},initImageResource:function(){H.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},_convertUVToPoint:function(Z,B){if(!Z)return{x:1/0,y:1/0};var H=B.bodyInfo.rect,W=Z.clone(),y=Z.multiply({x:H.width,y:H.height});return y.local=W,y},convertPoint:function(_,X,t,m,b,F){var C=X.rect,o=X.matrix.applyInverse(_).sub(C),T=o.x>=0&&o.y>=0&&o.x<=C.width&&o.y<=C.height;if(!T)return o;if(m&&dd(m.pixelPerfect,F,b)){var C,$=1;this._is2d?($=b.getZoom(),C=cd(_.x,_.y,W,$)):C=cd(_.x,_.y);var d=!1,f=C.x,c=C.y,L=C.width,I=C.height,l=H.hitMaxArea,e=L*I*$*$;if(e>l){var G=Math.sqrt(l/e);$*=G}L*=$,I*=$,2>L&&(L=2),2>I&&(I=2),f*=$,c*=$;var B=mp(L,I),y=new Vb(0,-f,-c,$,$);y.append(X.matrix),b._drawForChecking=!0,m.transform=y;var q=t.fitSize;X.refRect&&X.refRect.fitSize?(m.refRect=X.refRect,t.fitSize=!0):t.fitSize=!1;var p=t.comps;t.comps=[m],hl(B,t,0,0,L,I,F,self),t.comps=p,t.fitSize=q,delete m.refRect,delete m.unionRect,delete m.transform,b._drawForChecking=!1;try{for(var Q=0,n=B.getImageData(0,0,L,I).data;Q<n.length;Q+=4)if(0!==n[Q+3]){d=!0;break}B.restore()}catch(i){Qe=S,d=!1}o.inRect=d}else o.inRect=!0;return o},getDataInfoAt:function(Z,J){return Os.prototype.getDataInfoAt.call(this,Z,J)}});var Sr=Sb.DefaultInteractor=function(P){fb(Sr,this,[P])};vs("DefaultInteractor",Hg,{handle_mousedown:function(f){as(f);var D=this,q=D.gv,W=q.getDataAt(f);if(q.setFocus(f)&&!q._editing&&!q._scrolling){tg(f)?q.handleDoubleClick(f,W):q.handleClick(f,W);var u=sc(f);!vr()&&!u&&W&&(q.isMovable(W)||q._39Q(W))||!q.isPannable()||!yp(f)&&!u||Uj(f)||(D._tx=q.tx(),D._ty=q.ty(),D.startDragging(f))}},handleWindowMouseUp:function(v){var J=this,p=J.gv;p._panning&&(delete p._panning,p.onPanEnded(),J.fi({kind:"endPan",event:v})),delete J._tx,delete J._ty,J.clearDragging()},handle_mousemove:function(Y){var F=this,X=F.gv;F._hoverTimer&&(gp(F._hoverTimer),delete F._hoverTimer),F._hoverTimer=Yk(function(){F.fi({kind:"hover",event:Y}),gp(F._hoverTimer),delete F._hoverTimer},X.getHoverDelay()||H.hoverDelay)},handle_mouseleave:function(){var T=this;T._hoverTimer&&(gp(T._hoverTimer),delete T._hoverTimer)},handleWindowMouseMove:function(z){var a=this,E=a.gv;a.fi({kind:E._panning?"betweenPan":"beginPan",event:z}),E._panning=1;var f=Lf(E,z,a._lastClientPoint);E.setTranslate(a._tx+f.x,a._ty+f.y)},handle_mousewheel:function(O){this.gv.handleScroll(O,O.wheelDelta)},handle_DOMMouseScroll:function(T){2===T.axis&&this.gv.handleScroll(T,-T.detail)},handle_keydown:function(i){this.gv.handleKeyDown(i)}});var Sk=Sb.SelectInteractor=function(q){fb(Sk,this,[q])};vs("SelectInteractor",Hg,{_42:function(){var x=this,s=x.gv,N=s.getZoom(),m=x.mark,A=x.div;A||(A=x.div=ue(),wf(x.getView(),A));var I={};I.x=m.x*N+s.tx(),I.y=m.y*N+s.ty(),I.width=m.width*N,I.height=m.height*N,Pg(A,I),this.intersects()?(A.style.border="",A.style.background=s.getRectSelectBackground()):(A.style.background="",A.style.border="1px solid "+s.getRectSelectBorderColor())},handle_mousedown:function(g){var n=this,A=n.gv;if(n._57I=S,n.pendingClickThrough=S,!(A._editing||A._scrolling||vr()||sc(g))){var p=A.getDataAt(g),f=A.sm();p?Uj(g)?f.co(p)?f.rs(p):f.as(p):f.co(p)?p instanceof $n&&p.isClickThroughEnabled()&&yp(g)&&(n.pendingClickThrough=Rh(g)):f.ss(p):Uj(g)||!A.isPannable()?yp(g)&&(Uj(g)||f.cs(),A.isRectSelectable()&&(n.startDragging(g),A._77O=1)):yp(g)&&(n._57I=Rh(g))}},handle_mouseup:function(g){var J=this,r=J.gv,x=J._57I;if(x&&(_h(x,Rh(g))<=1&&r.sm().cs(),J._57I=S),J.pendingClickThrough){if(_h(J.pendingClickThrough,Rh(g))<=1){var Q=r.getDataAt(g);if(Q instanceof $n&&Q.isClickThroughEnabled()){var c=r.getDataAt(g,function(b){var K=b.getParent()===Q&&r.isSelectable(b,!0);return K});c&&(g.clickThrough=!0,r.sm().ss(c))}}J.pendingClickThrough=S}},handleWindowMouseUp:function(m){this.clear(m)},handleWindowMouseMove:function(c){var O=this,V=O.gv;O._logicalPoint=V.lp(c),O.mark?(O.fi({kind:"betweenRectSelect",event:c}),V.isPannable()&&O.autoScroll(c),O.redraw()):O.fi({kind:"beginRectSelect",event:c}),O.mark=Wk(O._lastLogicalPoint,O._logicalPoint),O.redraw()},intersects:function(){var Y=this,b=Y._lastLogicalPoint,Q=Y._logicalPoint;return b.x>Q.x||b.y>Q.y},clear:function(s){var C=this,j=C.gv,V=C.mark;if(C._57I=S,C.pendingClickThrough=S,C._lastLogicalPoint){if(V){if(0!==V.width&&0!==V.height){var F=j.getDatasInRect(V,C.intersects());if(!F.isEmpty()){var K=j.sm(),Z=K.toSelection(),Y=nr(s),t=s.altKey;F.each(function(H){K.co(H)?(!Y||Y&&t)&&Z.remove(H):(!t||Y&&t)&&Z.add(H)}),K.ss(Z)}}re(C.div),delete C.div,delete C.mark,C.redraw(),C.fi({kind:"endRectSelect",event:s}),j.onRectSelectEnded()}C.clearDragging(),delete j._77O}},redraw:function(){var r=this;r._draw||(r._draw=1,Yk(function(){r.mark&&r._42(),delete r._draw},16))}});var xr=Sb.MoveInteractor=function(a){fb(xr,this,[a])};vs("MoveInteractor",Hg,{handle_mousedown:function(l){var o=this,p=o.gv;if(yp(l)&&!p._editing&&!p._scrolling&&!vr()){var Q=p.getSelectedDataAt(l);!Q||p._39Q(Q)&&!p.isMovable(Q)?p._focusData=S:(o._data=Q,p.handleMouseDown&&p.handleMouseDown(l,Q),o.startDragging(l),p.isMovable(Q)&&(p._moving=1))}},handleWindowMouseUp:function(B){var h=this,Y=h.gv;Y.handleMouseUp&&Y.handleMouseUp(B,h._data),h.clear(B)},handleWindowMouseMove:function(Q){var Y=this,a=Y._data,O=Y.gv;if((!O._93O||!O._93O(Q,a))&&O._moving){Y._logicalPoint||Y.fi({kind:"prepareMove",event:Q});var G=Y._logicalPoint?"betweenMove":"beginMove",s={kind:G,event:Q},Z=Y._logicalPoint=O.lp(Q);"beginMove"!==G||Y._alreadyBeginTransaction||(Y._alreadyBeginTransaction=!0,O.getDataModel().beginTransaction());var B=Y._calcShift(G,Q),y=B.x,E=B.y,f=Y.gv.getMoveMode(Q,a);f&&("x"===f?E=0:"y"===f?y=0:"xy"!==f&&(y=E=0)),O.moveSelection(y,E),Y._lastLogicalPoint=Z,Y.autoScroll(Q),Y.fi(s)}},_calcShift:function(){var E=this,Y=E._logicalPoint,L=E._lastLogicalPoint,D=Y.x-L.x,W=Y.y-L.y;return{x:D,y:W}},clear:function(H){var F=this,j=F.gv;F._lastLogicalPoint&&(F._lastLogicalPoint=F._data=j._moving=S,F._logicalPoint&&(F.fi({kind:"endMove",event:H}),j.onMoveEnded()),F.clearDragging()),F._alreadyBeginTransaction&&(F._alreadyBeginTransaction=!1,j.getDataModel().endTransaction())}});var Hj=Sb.TextEditInteractor=function(F){fb(Hj,this,[F]),this.init()};vs("TextEditInteractor",Hg,{setUp:function(){var J=this;Hj.superClass.setUp.call(J),J.gv.mp(J.handleGvPropertyChange,J)},teatDown:function(){var z=this;Hj.superClass.teatDown.call(z),z.gv.ump(z.handleGvPropertyChange,z)},handleGvPropertyChange:function(){this._editTarget&&this.endTextEdit()},init:function(){var u=this,h=this.input=m.createElement("input"),H=h.style;h.text="text",H.border="1px solid #d8d8d8",H.position="absolute",H.padding="2px 3px",H.outline="none",H.marginLeft="-90px",H.marginTop="-16px",H.backgroundColor="rgba(255,255,255, 1)",H.fontSize="14px",H.width="180px",H.height="32px",H.boxShadow="0 0 13px rgba(16,142,233, 0.5)",H.textAlign="center",H.boxSizing="border-box",Z(h,"keyup",function(g){return Db(g)&&u.endTextEdit(),Jr(g)?(u.endTextEdit(!0),void 0):void 0}),Z(h,"focus",function(){h.select()});var b=this.textarea=m.createElement("textarea"),w=this.wrap=m.createElement("div");w.appendChild(b),H=b.style,H.margin=0,H.padding="4px",H.overflow="hidden",H.boxSizing="border-box",H.position="absolute",H.outline="none",H.backgroundColor="transparent",H.resize="none",H.textAlign="center",H.fontSize="14px",H.borderWidth=0,H.width="100%",H=w.style,H.boxSizing="border-box",H.margin=0,H.padding=0,H.position="absolute",H.boxShadow="0 0 13px rgba(16,142,233, 0.5)",H.border="1px solid #d8d8d8",H.backgroundColor="rgba(255,255,255, 1)",H.zIndex="10",Z(b,"keydown",function(F){return(nr()||Uj())&&Db(F)?(u.endTextEdit(),void 0):Jr(F)?(u.endTextEdit(!0),void 0):(u._editTarget instanceof To||u.calculateTextareaHeight(String.fromCharCode(F.keyCode)),void 0)}),Z(b,"focus",function(){b.select()});var y=function(Y){Y.stopPropagation()};Z(h,"mousedown",y),Z(h,"touchstart",y),Z(b,"mousedown",y),Z(b,"touchstart",y),Z(b,"click",y),u.SIZING_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],u.HIDDEN_TEXTAREA_STYLE="visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important",u.handleWindowClick=function(T){var J=u._editingDOM;if(J){var k=J.getBoundingClientRect(),m=Rh(T);Zk(k,m)||u.endTextEdit()}}},handle_mousedown:function(b){var j=this,i=j.gv;if(tg(b)&&!i._editing){var A=i.getDataAt(b);if(A){var v=i.getTextEditInfo(A);v&&(this._editInfo=v,this._editTarget=A,i._editing=!0,v.isMultiline?this.handleMultilineEdit():this.handleTextEdit())}}},handleMultilineEdit:function(){var z=this,R=z.gv,D=z._editTarget,m=z.getTargetValue(),S=z.textarea,q=z.wrap,N=this._editInfo;this.hiddenTextarea||this.createHiddenTextarea(),(null===m||m===W)&&(m=""),S.value=m,N.font&&(S.style.font=N.font),z._editingDOM=S,R.appendHTML(q),this.layoutHTML(q,D),D instanceof To?S.style.height="100%":(S.style.height="auto",this.calculateTextareaHeight()),Yk(function(){S.focus(),Z(e,"mousedown",z.handleWindowClick),Z(e,"touchstart",z.handleWindowClick)},10)},handleTextEdit:function(){var g=this,b=g.gv,_=g._editTarget,c=g.getTargetValue(),r=g.input;(null===c||c===W)&&(c=""),r.value=c,g._editingDOM=r,b.getView().appendChild(r),this.layoutHTML(r,_),Yk(function(){r.focus(),Z(e,"mousedown",g.handleWindowClick),Z(e,"touchstart",g.handleWindowClick)},10)},layoutHTML:function(f,C){var N=this.gv,t=N.getZoom();if(C instanceof To){var a=N.getDataUI(C),y=a._6I,i=C.getScale(),Y=f.style;f.style.left=y.x*t+N.tx()+"px",f.style.top=y.y*t+N.ty()+"px",f.style.width=a._6I.width+"px",f.style.height=a._6I.height+"px",Ll(Y,"transform","scale("+t*i.x+","+t*i.y+")"),Ll(Y,"transformOrigin","0px 0px")}else if(C instanceof ci){var y=C.getRect(),K=y.width*t;f.style.left=(y.x+y.width/2)*t+N.tx()+"px",f.style.top=(y.y+y.height/2)*t+N.ty()+"px",f.style.width=K+"px",f.style.marginLeft=-K/2+"px"}else if(C instanceof n.Edge){var a=N.getDataUI(C),y=a._6I;f.style.left=(y.x+y.width/2)*t+N.tx()+"px",f.style.top=(y.y+y.height/2)*t+N.ty()+"px"}},endTextEdit:function(u){var P=this,Z=P._editInfo.isMultiline?P.wrap:P.input,J=P._editInfo.isMultiline?P.textarea:P.input;u||P.setTargetValue(J.value),P.gv.getView().removeChild(Z),P.gv._editing=!1,delete P._editingDOM,delete P._editTarget,N(e,"mousedown",P.handleWindowClick),N(e,"touchstart",P.handleWindowClick)},setTargetValue:function(g){var Q=this,m=Q._editTarget,L=Q._editInfo,$=L.accessType,p=L.name;if(p&&$||($="p",p="name"),"p"===$){var M=n.Default.setter(p);m[M](g)}else"a"===$?m.a(p,g):m.s(p,g)},getTargetValue:function(){var J=this,r=J._editTarget,s=J._editInfo,A=s.accessType,x=s.name;if(x&&A||(A="p",x="name"),"p"===A){var V=n.Default.getter(x);return r[V]()}return"a"===A?r.a(x):r.s(x)},createHiddenTextarea:function(){this.hiddenTextarea=m.createElement("textarea"),this.hiddenTextarea.setAttribute("style","margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;pointer-events: none;opacity:0;"),this.hiddenTextarea.setAttribute("rows","1"),this.gv.getView().appendChild(this.hiddenTextarea)},calculateHTMLStyle:function(U,W){if(W&&this.computedStyleCache)return this.computedStyleCache;var b=this,F=e.getComputedStyle(U),r=F.getPropertyValue("box-sizing")||F.getPropertyValue("-moz-box-sizing")||F.getPropertyValue("-webkit-box-sizing"),p=parseFloat(F.getPropertyValue("padding-bottom"))+parseFloat(F.getPropertyValue("padding-top")),m=parseFloat(F.getPropertyValue("border-bottom-width"))+parseFloat(F.getPropertyValue("border-top-width")),v=b.SIZING_STYLE.map(function(V){return V+":"+F.getPropertyValue(V)}).join(";"),z={sizingStyle:v,paddingSize:p,borderSize:m,boxSizing:r};return W&&(this.computedStyleCache=z),z},calculateTextareaHeight:function(J){J=J||"";var d=this,Q=d.textarea,k=d.hiddenTextarea,p=d.wrap,G=32,F=d.calculateHTMLStyle(Q,!1),_=F.paddingSize,n=F.borderSize,S=F.boxSizing,X=F.sizingStyle;k.setAttribute("style",X+";"+d.HIDDEN_TEXTAREA_STYLE),k.value=Q.value+J;var P=k.scrollHeight;"border-box"===S?P+=n:"content-box"===S&&(P-=_),Q.style.height=P+"px",p.style.height=Math.max(P,G)+"px",p.style.marginTop=P*-.5+"px"}});var Ok=Sb.ScrollBarInteractor=function(y){fb(Ok,this,[y])};vs("ScrollBarInteractor",Hg,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(H){var g=this.gv.getViewRect();return this._41o()&&(g.x+g.width-this.gv.lp(H).x)*this.gv.getZoom()<ii},isH:function(b){var A=this.gv.getViewRect();return this._40o()&&(A.y+A.height-this.gv.lp(b).y)*this.gv.getZoom()<ii},handle_mousemove:function(X){this.handle_touchmove(X)},handle_touchmove:function(t){if(!nm&&yp(t)&&this.gv.isScrollBarVisible()){var k=this,j=k.isV(t),g=k.isH(t);(j||g)&&k.gv.showScrollBar(),k.gv._scrolling=j||g}},handleWindowMouseUp:function(B){this.handleWindowTouchEnd(B)},handleWindowTouchEnd:function(b){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=S,this.fi({kind:"endScroll",event:b})},handle_mousedown:function(n){this.handle_touchstart(n)},handle_touchstart:function(K){var J=this;if(J.gv.setFocus(K),as(K),J.handle_touchmove(K),!(Nc(K)>1)&&J.gv._scrolling&&J.gv.isScrollBarVisible()){J._cp=Rh(K),J._tx=J.gv.tx(),J._ty=J.gv.ty();var E=J.isV(K);J._state=E?"vScroll":"hScroll",xl(J,K),J.fi({kind:"beginScroll",event:K})}},handleWindowMouseMove:function(W){this.handleWindowTouchMove(W)},handleWindowTouchMove:function(G){var e=Rh(G),P=this.gv.getViewRect(),f=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-e.y)*f.height/P.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-e.x)*f.width/P.width),this.fi({kind:"betweenScroll",event:G})}});var uc=Sb.TouchInteractor=function(L,j){j=j||{},j.selectable===W&&(j.selectable=!0),j.movable===W&&(j.movable=!0),j.pannable===W&&(j.pannable=!0),j.pinchable===W&&(j.pinchable=!0),j.editable===W&&(j.editable=!0),this.params=j,fb(uc,this,[L])};vs("TouchInteractor",Hg,{ms_edit:1,setUp:function(){var H=this;uc.superClass.setUp.call(H),bc&&H.params.editable&&H.gv.setEditInteractor(H)},tearDown:function(){var o=this;uc.superClass.tearDown.call(o),bc&&o.params.editable&&o.gv.setEditInteractor(S)},clear:function(C){var w=this,k=w.gv;k._moving&&(w.fi({kind:"endMove",event:C}),delete k._moving,k.onMoveEnded(),k.dm().endTransaction()),k._panning&&(w.fi({kind:"endPan",event:C}),delete k._panning,k.onPanEnded()),k._pinching&&(w.fi({kind:"endPinch",event:C}),delete k._pinching,k.onPinchEnded()),k._editing&&(w._46O(C),w._77I=w._node=w._edge=w._shape=w._rect=w._89I=w._index=k._editing=S),w.pendingClickThrough=w._moving=w._panning=w._pinching=w._editing=w._57I=w._data=w._beginHistory=S,w.clearDragging()},handle_touchstart:function(x){var n=this;if(!n.gv._editing){as(x),n._57I=S,n.pendingClickThrough=S;var X=n.params,N=n.gv,J=N.sm(),D=N.getDataAt(x),H=Nc(x);if(1===H){if(tg(x))return N.handleDoubleClick(x,D),void 0;N.handleClick(x,D),D&&(N.handleMouseDown&&N.handleMouseDown(x,D),n._data=D),X.selectable||(D=S),D&&(J.co(D)?D instanceof $n&&D.isClickThroughEnabled()&&(n.pendingClickThrough=Rh(x)):J.ss(D),X.editable&&N.isEditable(D)&&n._79I(x,D,!0)?(n._editing=1,n.startDragging(x)):X.movable&&N.isMovable(D)&&(n._moving=1,n.startDragging(x))),D&&(N.isMovable(D)||N._39Q(D))||(n._57I=Rh(x),X.pannable&&N.isPannable()&&(n._panning=1,n.startDragging(x),n._translate={x:N.tx(),y:N.ty()}))}else if(X.pinchable&&2===H){if(!N.getEditInteractor()&&D){var b=Fr(N.getImage(D));if(b&&dd(b.scrollable,D,this))return}n._pinching=1,n.startDragging(x);var p=N.getView(),L=N.getZoom(),r=p.getBoundingClientRect(),C=x.touches[0],Z=x.touches[1],K={x:(C.clientX+Z.clientX)/2-r.left,y:(C.clientY+Z.clientY)/2-r.top};K.x-=N.tx(),K.y-=N.ty(),K.x/=L,K.y/=L,n._p=K,n._d=Ur(x)}}},handle_touchend:function(A){var u=this,j=u.gv,X=u._57I,p=u._data;if(X&&(_h(X,Rh(A))<=1&&!j.getDataAt(A)&&j.sm().cs(),u._57I=S),p&&j.handleMouseUp&&j.handleMouseUp(A,p),u.pendingClickThrough){if(_h(u.pendingClickThrough,Rh(A))<=1){var p=j.getDataAt(A);if(p instanceof $n&&p.isClickThroughEnabled()){var Q=j.getDataAt(A,function(h){var x=h.getParent()===p&&j.isSelectable(h,!0);return x});Q&&(A.clickThrough=!0,j.sm().ss(Q))}}u.pendingClickThrough=S}},handleWindowTouchEnd:function(t){this.clear(t)},handleWindowTouchMove:function(Q){var N=this,Z=N.gv,X=Nc(Q);if(1===X){var t=Rh(Q),U=Lf(Z,t,N._lastClientPoint),W=_h({x:0,y:0},U);if(N._editing&&(N._beginHistory||(N._beginHistory=1,Z.dm().beginTransaction()),Z._editing=1,N._78I(Q)),N._moving){if(!Z._moving&&W<H.touchMoveThreshold)return;N._beginHistory||(N._beginHistory=1,Z.dm().beginTransaction()),N.handleMove(Q)}else if(N._panning){if(!Z._panning&&W<H.touchMoveThreshold)return;Z.setTranslate(N._translate.x+U.x,N._translate.y+U.y),N.fi({kind:Z._panning?"betweenPan":"beginPan",event:Q}),Z._panning=1}}else if(2===X&&N._pinching){var A=Ur(Q);Z.handlePinch(N._p,A,N._d),N._d=A,N.fi({kind:Z._pinching?"betweenPinch":"beginPinch",event:Q}),Z._pinching=1}},handleMove:function(g){var W=this,D=W.gv,s=D.lp(g);D._93O&&D._93O(g,W._data)||(D.moveSelection(s.x-W._lastLogicalPoint.x,s.y-W._lastLogicalPoint.y),W._lastLogicalPoint=s,W.autoScroll(g),W.fi({kind:D._moving?"betweenMove":"beginMove",event:g}),D._moving=1)}});var n=e.ht,mq=n.graph._editor={Math:n.Math,Guide:{}};mq.getStyle=function(n){var j,D=mq.StyleMap;return D&&(j=D[n],j!==W)?j:mq.DefaultStyleMap[n]},mq.setStyle=function(u,t){var E=mq.StyleMap;E||(E=mq.StyleMap={}),E[u]=t},mq.inEdit=function(L){return L._inXEdit===!0},mq.startEdit=function(x){x._inXEdit=!0,mq.Inject.doInject(x)},mq._46O=function(o){o._inXEdit=!1,mq.Inject.undoInject(o)},mq.toScreenPosition=function(R,B){var Y=R.tx(),c=R.ty(),E=R._zoom;return new mq.Math.Vector2(B.x*E+Y,B.y*E+c)},mq.checkHit=function(z,d,C){return z.distanceTo(d)<C?!0:!1},mq.toWorldPosition=function(e,M){var A=e.tx(),k=e.ty(),Q=e._zoom;return{x:(M.x-A)/Q,y:(M.y-k)/Q}},mq.setAntialias=function(U,q){for(var H,f=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],o=0,K=f.length;K>o&&(H=f[o],!(H in U));o++);U[H],U[H]=q},mq.getTargetCornersOnScreen=function(i,V){if(!V)return null;var K,X=[];if(fm(V,i)){var $=$q(i,V);K=[{x:$.x,y:$.y},{x:$.x+$.width,y:$.y},{x:$.x+$.width,y:$.y+$.height},{x:$.x,y:$.y+$.height}]}else{if(!V.getCorners)return null;K=V.getCorners()}return K.forEach(function(D){var A=mq.toScreenPosition(i,D);X.push(A.x,A.y)}),X},mq.log=function(){};var nn;mq.updateTipInfo=function(N,s,B){if(B){var v=n.Default.getLogicalPoint(N,s._canvas);v.x+=mq.Icons.TipShiftX,v.y+=mq.Icons.TipShiftY,nn={helperPos:v,text:B,size:B.length}}else nn=S},mq.drawTip=function(u,b){nn&&mq.Icons.DrawIcon(b,u,mq.Icons.TipHelper,nn)};var cf=mq.Inject={_modules:[]};cf.registAsModule=function(t,Z){var $={},q={};for(var a in t){var O=Z.prototype[a];$[a]=O}t.getBackup=function(U){return $[U]},t.getBackups=function(){return $},q.doInject=function(){for(var w in t)"getBackup"!==w&&(Z.prototype[w]=t[w])},q.undoInject=function(){for(var r in t)"getBackup"!==r&&(Z.prototype[r]=$[r])},cf._modules.push(q)},cf.doInject=function(E){for(var t,I=cf._modules,m=0,r=I.length;r>m;m++)t=I[m],t.doInject(E)},cf.undoInject=function(O){for(var D,Z=cf._modules,y=0,W=Z.length;W>y;y++)D=Z[y],D.undoInject(O)};var Hg=n.graph.EditInteractor=function(A){var g=this,s=m.createElement("canvas");s.className="editCanvas",s.style.position="absolute",g._uuid=n.Math.generateUUID(),g._styleMap={},g._canvas=s,g._context=s.getContext("2d"),Hg.superClass.constructor.call(g,A),this._editDetail=!1,mq.setAntialias(g._context,!1),g._subModules=g.initSubModule(),g._gridGuide=new mq.Guide.Grid(g),g._rectGuide=new mq.Guide.Rect(g),g._hoverGuide=new mq.Guide.Hover(g)},Vr=Hg;n.Default.def(Hg,n.graph.Interactor,{ms_edit:1,ms_fire:1}),o.defineProperties(Hg.prototype,{editDetail:{get:function(){var l=!!this._editDetail;return l},set:function(F){var g=this,u=g._editDetail;u!==F&&(g._editDetail=F,g.gv._editing=F,g.fp("editDetail",u,F),g.fp("pointsEditingMode",u,F),g.fi({kind:F?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(k){(!this._editDetail||k)&&(this.gv._editing=k,k||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(j){this._editing=j,this.gvEditing=j}},editingModule:{get:function(){return this._editMod}},pointsEditingMode:{get:function(){return this.editDetail},set:function(z){var v=this;v.editDetail!==z&&(z?v._tryEnterEditDetailMode():v._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var X=this._gridEnabled;if(!X)return!1;var M=this.gv;return M?!0:!0},set:function(y){y!==this._gridEnabled&&(this._gridEnabled=y,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(V){V!==this._agEnabled&&(this._agEnabled=V,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}},hoverGuide:{get:function(){return this._hoverGuide}}}),Hg.prototype.initSubModule=function(){var e=this;return[new mq.Anchor(e),new mq.RotateX(e),new mq.MoveDummy(e),new mq.Rect(e),new mq.Curve(e),new mq.MoveHelper(e)]},Hg.prototype.getSubModule=function(C){var n,l,N,h=this._subModules;for(l=0,N=h.length;N>l;l++)if(n=h[l],n.catalog===C)return n},Hg.prototype.invokeSubModule=function(c,_){for(var r,q,k,s=this,e=s._subModules,x=Array.prototype.slice.call(arguments,2),F=0,G=e.length;G>F;F++)if(r=e[F],q=r[c],q&&(k=q.apply(r,x),k!=W&&_))return r},Hg.prototype.invokeSubModuleInverse=function(M,P){var l=this,U=l._subModules;if(U)for(var L,e,v,C=Array.prototype.slice.call(arguments,2),h=U.length-1;h>=0;h--)if(L=U[h],e=L[M],e&&(v=e.apply(L,C),v!=W&&P))return L},Hg.prototype.setUp=function(){mq.log("setUp");var h=this,G=h.gv,I=G.getView(),m=h._canvas;Hg.superClass.setUp.call(h),G.setEditInteractor(h),G._79O?I.insertBefore(m,G._79O):I.appendChild(m),mq.startEdit(G),h.invokeSubModule("setUp"),G.dm().mm(h._onDataModelChanged,h),G.dm().md(h._onDataPropertyChanged,h)},Hg.prototype.tearDown=function(){mq.log("tearDown");var p=this,s=p.gv,c=s.getView();p._resetCustomCursorStyle(),Hg.superClass.tearDown.call(p),s.dm().umm(p._onDataModelChanged,p),s.dm().umd(p._onDataPropertyChanged,p),s.setEditInteractor(null),c.removeChild(p._canvas),p._drawTimer&&(gp(p._drawTimer),p._drawTimer=null),mq._46O(s),p.invokeSubModule("tearDown")},Hg.prototype._onDataModelChanged=function(Q){var W=this;("clear"===Q.kind||"remove"===Q.kind&&W.editDetail&&Q.data===W.getSubModule("Curve").target)&&(W.editDetail=!1,W._42())},Hg.prototype._onDataPropertyChanged=function(y){var i=this;if(i.editDetail){var N=i.getSubModule("Curve"),n=y.data;n===N.target&&(n._writing||N._handleDataChanged(y))}},Hg.prototype.clear=function(){mq.log("clear")},Hg.prototype.redraw=function(){this._42()},Hg.prototype._42=function(){var G=this;G._drawTimer||(G._drawTimer=Yk(function(){G._drawTimer=null,G.drawImpl()},0))},Hg.prototype.drawImpl=function(){var k;for(k in{_42:!0})break;return function(){var X=this,Q=X._canvas,g=X.gv,x=g.getWidth(),f=g.getHeight(),u=X._context,U=n.Default.getInternal(),T=H.devicePixelRatio;(Q.width!==x||Q.height!==f)&&U.setCanvas(Q,x,f,T),u.clearRect(0,0,Q.width,Q.height);var v=X._getValidSelection();u.save(),u.scale(T,T),X._gridGuide._42(),X.invokeSubModuleInverse(k,!1,u,g,v),X._rectGuide._42(),X._hoverGuide._42(),u.restore()}}(),Hg.prototype._getValidSelection=function(){var j=this,P=j.gv,L=P.sm().getSelection(),O=[];return L.each(function(T){P.isVisible(T)&&P.isEditable(T)&&O.push(T)}),O},Hg.prototype.handle_touchmove=function(b){return this.handle_mousemove(b)},Hg.prototype.handle_mousemove=function(J){if(!n.Default.isDragging()){var R=this;if((R.editDetail||!vr()&&!sc(J))&&!R.gv._externalEditing){if(R.gvEditing=!1,R._checkEdit(J))R.gvEditing=!0;else{if(!R.getStyle("hoverGuideVisible"))return;R.hoverData=R.gv.getDataAt(J)}R._42()}}},Hg.prototype.handle_touchstart=function(C){return this.handle_mousedown(C)},Hg.prototype.handle_mousedown=function(F){as(F);var d=this;if((d.editDetail||!vr()&&!sc(F))&&!d.gv._externalEditing){if(tg(F)&&!F.clickThrough){if(d.editDetail){if(d._tryQuitEditDetailMode(F))return}else if(d._tryEnterEditDetailMode())return;d.gv.dm().beginTransaction();var v=d.invokeSubModule("handleDoubleClick",!0,F);if(d.gv.dm().endTransaction(),v)return}var p=d._checkEdit(F);p&&(d._downPosition=d._getLogicalPoint(F),d.gv.dm().beginTransaction(),p.startEdit(d,F),d.editing=!0)}},Hg.prototype._checkEdit=function(x){var w=this,k=w.gv,d=w._getLogicalPoint(x),f=w.invokeSubModule("check",!0,k,x,d)||null;return w._editMod=f,f},Hg.prototype.handleWindowTouchMove=function(a){return this.handleWindowMouseMove(a)},Hg.prototype.handleWindowMouseMove=function(Y){var W=this,q=W._downPosition;if(q){var g=W._getLogicalPoint(Y);if(g.distanceTo(q)<W.getStyle("moveSensitivity"))return;delete W._downPosition}var u=W._editMod;u&&u.handleEdit(W.gv,Y),W.redraw()},Hg.prototype._getLogicalPoint=function(y){var i=this,e=n.Default.getLogicalPoint(y,i._canvas);return new mq.Math.Vector2(e)},Hg.prototype.handleWindowTouchEnd=function(N){return this.handleWindowMouseUp(N)},Hg.prototype.handleWindowMouseUp=function(){var v;for(v in{_46O:!0})break;return function(E){var u=this;u.editing=!1,u.setCursor("default"),u.invokeSubModule(v,!1,E),u._42(),u.gv.dm().endTransaction()}}(),Hg.prototype.handle_mousewheel=function(Y){var T=this;as(Y),T.invokeSubModule("preHandleScroll",!0)||T.gv.handleScroll(Y,Y.wheelDelta)},Hg.prototype.handleDelete=function(){var d=this;if(!d.editDetail){d.gv.dm().beginTransaction();var q=d.invokeSubModule("handleNormalStateDelete",!0);return d.gv.dm().endTransaction(),q||d.gv.removeSelection(),void 0}d.gv.dm().beginTransaction(),d.invokeSubModule("handleDelete",!0),d.gv.dm().endTransaction(),d._42()},Hg.prototype.handle_keydown=function(O){var y=this;if((O.metaKey||O.ctrlKey)&&y._42(),vr(O)&&!y.editing)return y.gvEditing=!1,y.setCursor("default"),y._42(),void 0;var H=Db(O);return y.editDetail?((H||Jr(O))&&(y.editDetail=!1,y._42()),y.gv.dm().beginTransaction(),y.invokeSubModule("handle_keydown",!0,O),y.gv.dm().endTransaction(),void 0):(y.gv.dm().beginTransaction(),y.invokeSubModule("handleNormalStateKeyDown",!0,O),y.gv.dm().endTransaction(),H&&y._tryEnterEditDetailMode(),void 0)},Hg.prototype.handle_keyup=function(X){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,X),this.gv.dm().endTransaction()},Hg.prototype._tryEnterEditDetailMode=function(){var $=this;return!$.editDetail&&$.invokeSubModule("canEnterEditDetailMode",!0)&&1===$._getValidSelection().length?($.editDetail=!0,$._42(),!0):void 0},Hg.prototype._tryQuitEditDetailMode=function(m){var v=this;return v.editDetail?!m||v.invokeSubModule("canQuitEditDetailMode",!0,m)?(v.editDetail=!1,v._42(),!0):!1:!1},Hg.prototype.setStyle=function(y,w,o){var E=this;o?mq.setStyle(y,w):E._styleMap[y]=w,"baseColor"===y&&(cs=w),E.fp("styleChanged",null,{key:y,value:w,base:o}),E._42()},Hg.prototype.getStyle=function(h){var E=this,g=E._styleMap[h];return g!==W?g:mq.getStyle(h)},Hg.prototype.setCursor=function(B){this._resetCustomCursorStyle(),n.graph.EditInteractor.superClass.setCursor.call(this,B)},Hg.prototype._drawHostGuide=function(p){var o=this,z=o._context,_=o.gv;mq.Icons.DrawIcon(o,z,mq.Icons.NodeHoverGuide,p.corners);var C=p.host;if(C){var Q=_.getAttachPoints(C);if(Q&&Q.length)for(var e=0,D=Q.length;D>e;e++){var M=Q[e],d=qp(_,C,0,M.offsetX||0,M.offsetY||0,M.x,M.y);d=mq.toScreenPosition(_,d),d.isAttach=p.attach===e,mq.Icons.DrawIcon(o,z,mq.Icons.AttachPoint,d)}}},Hg.prototype._resetCustomCursorStyle=function(){var u=this;if(u._customStyle){var F=this.gv.getView();F.classList&&F.classList.remove&&F.classList.remove(u._customStyle),u._customStyle=null}},Hg.prototype._setRotateCursor=function(f){var M=this,E=M._cursorFactory;E||(E=M._cursorFactory=new mq.CursorFactory(M));var x=E.getRotateCursor(f),Y=M.gv.getView();M._resetCustomCursorStyle(),M._customStyle=x,Y.classList&&Y.classList.add&&Y.classList.add(x)};var qn=mq.Group=function(h){var _=this;_._entities=h,_._64O=0,_._position={x:0,y:0},_._scale={x:1,y:1},_._anchor={x:.5,y:.5},_._anchor2={x:.5,y:.5}};qn.prototype={},qn.prototype.constructor=qn;var Wp=null,Yd=null;qn.findOrCreateGroup=function(M,C){if(Yd===C&&Wp&&Wp.checkIsMe(M))return Wp;Yd=C;var q=new mq.Group(M);return q.getKeyOb()?(Wp=q,q):void 0},qn.prototype.checkIsMe=function(R){var l=this._entities;if(l.length!==R.length)return!1;var T,j={},i=R.length;for(T=0;i>T;T++)j[R[T]._id]=!0;for(T=0;i>T;T++)if(!j[l[T]._id])return!1;return!0},qn.prototype.getRotation=function(){return this._64O},qn.prototype.getPosition=function(){return this._position},qn.prototype.getAnchor=function(){return this._anchor},qn.prototype.getWidth=function(){return this._width},qn.prototype.getScale=function(){return this._scale},qn.prototype.getSize=function(){return{width:this._width,height:this._height}},qn.prototype.getHeight=function(){return this._height},qn.prototype.getKeyOb=function(){for(var u=this._entities,S=u.length-1;S>=0;S--){var E=u[S];if(this.isNode(E))return E}},qn.prototype.getAnchor2=function(){var W=this,q=W.rotateCenter;if(q)return q;var C=W.getKeyOb();if(!C)return W._anchor;var s=W._anchor2,$=C.getMatrix();return $.tf({x:C.getWidth()*(s.x-C.getAnchor().x),y:C.getHeight()*(s.y-C.getAnchor().y)})},qn.prototype.setAnchor2=function(v,P){var X=this,c=X.getKeyOb();if(c){var F,G=c.getMatrix();F="number"==typeof v?{x:v,y:P}:v;var y=G.tfi(F);X._anchor2={x:c.getAnchor().x+y.x/c.getWidth(),y:c.getAnchor().y+y.y/c.getHeight()}}},qn.prototype.setRotation=function(){},qn.prototype.beginRotate=function(M){this.rotateCenter=M.pos,this.rotateMode=M.groupRotateMode},qn.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},qn.prototype.addRotation=function(N,r,Z){return"batch"===r?this._addRotationInBatchMode(N,Z):"block"===r?this._addRotationInBlockMode(N,Z):void 0},qn.prototype._addRotationInBlockMode=function(F,W){var l=this,X=l.rotateCenter||l.getPosition();l._entities.forEach(function(q){if(l.isNode(q)&&(!W||W(q))){var A=q.getMatrix();A.translate(-X.x,-X.y),A.rotate(F),A.translate(X.x,X.y);var u=Math.sign(q.getScale().x);q.setRotation(db(A.b*u,A.a*u)),q.setPosition(A.tx,A.ty)}})},qn.prototype._addRotationInBatchMode=function(k,y){var E=this,J=E._anchor2;E._entities.forEach(function(U){if(E.isNode(U)&&(!y||y(U))){var i=U.getAnchor(),Y=U.getMatrix(),f=Y.tf({x:U.getWidth()*(J.x-i.x),y:U.getHeight()*(J.y-i.y)}),z=new mq.Math.Matrix2d;z.set(Y.a,Y.b,Y.c,Y.d,Y.tx,Y.ty),z.translate(-f.x,-f.y),z.rotate(k),z.translate(f.x,f.y);var e=Math.sign(U.getScale().x);U.setRotation(db(z.b*e,z.a*e)),U.setPosition(z.tx,z.ty)}})},qn.prototype.setPosition=function(l){var I,v,_,$,M=this,u=M._position,c=l.x-u.x,g=l.y-u.y,n=M._entities;for(v=0,_=n.length;_>v;v++)I=n[v],af(I)&&($=I.getPosition(),I.setPosition($.x+c,$.y+g));M._position=l},qn.prototype.setScale=function(Q,w){var b=this,g=Q/b._scale.x,L=w/b._scale.y;b._adjustChildScaleOrSize(g,L,"size"),b._scale={x:Q,y:w}},qn.prototype.getRect=function(){var J=this,g=J._position,p=J._width,r=J._height;return{x:g.x-p/2,y:g.y-r/2,width:p,height:r}},qn.prototype.setSize=function(k,A){var W=this,k=Math.max(1,k),A=Math.max(1,A),Q=k/W._width,Z=A/W._height;
W._adjustChildScaleOrSize(Q,Z,"size"),W._width=k,W._height=A},qn.prototype._adjustChildScaleOrSize=function(u,X,o){var b,e,M,L,r,Y,S,k,j,P,K,O,E,$,Z=this,x=Z._position,Q=Z._entities,U=new mq.Math.Matrix2d;for(e=0,M=Q.length;M>e;e++)if(b=Q[e],Z.isNode(b)){if(L=b.getPosition(),r=b.getRotation(),Y=b.getWidth(),S=b.getHeight(),k=b.getScale(),K=k.x*Y,O=k.y*S,U.identity().scale(K,O).rotate(r).translate(L.x,L.y).translate(-x.x,-x.y).rotate(-Z._64O),r=db(U.b*Math.sign(K),U.a*Math.sign(K)),U.scale(u,X),j=Math.cos(r),P=Math.sin(r),Math.abs(j)<.001?(E=U.b/P,$=-U.c/P):(E=U.a/j,$=U.d/j),"scale"===o)b.setScale(E/Y,$/S);else if("size"===o){var g=E/k.x,d=$/k.y;b.setScale(uo(E)*Math.abs(k.x),uo($)*Math.abs(k.y)),b.setSize(Math.max(.1,Math.abs(g)),Math.max(.1,Math.abs(d)))}U.rotate(Z._64O).translate(x.x,x.y),b.setPosition(U.tx,U.ty)}},qn.prototype.getMatrix=function(){var W=this,K=W._position,N=n.Default.getInternal(),t=W._scale;return new N.Mat(W._64O,K.x,K.y,t.x,t.y)},qn.prototype.toGlobal=function(o){return this.getMatrix().tf(o)},qn.prototype.getCorners=function(){var j=this,K=j._width,V=j._height,d=j._anchor,u=-K*d.x,C=-V*d.y,E=j.getMatrix();return[E.tf(u,C),E.tf(u,C+V),E.tf(u+K,C+V),E.tf(u+K,C)]},qn.prototype.calcInfo=function(){var I,V,d,v,R,_,W=this,i=[],g=W._entities,U=W._64O;for(v=0,R=g.length;R>v;v++)_=g[v],W.isNode(_)&&_.getCorners&&i.push.apply(i,_.getCorners());if(i.length){var F=Math.cos(-U),B=Math.sin(-U),S=1/0,N=-1/0,n=1/0,c=-1/0;for(v=0,R=i.length;R>v;v++)d=i[v],I=d.x,V=d.y,d.x=F*I-B*V,d.y=B*I+F*V,S=Math.min(S,d.x),N=Math.max(N,d.x),n=Math.min(n,d.y),c=Math.max(c,d.y);W._width=(N-S)/W._scale.x,W._height=(c-n)/W._scale.y,F=Math.cos(U),B=Math.sin(U);var X=W._anchor;I=S+(N-S)*X.x,V=n+(c-n)*X.y,W._position={x:F*I-B*V,y:B*I+F*V}}},qn.prototype.isNode=function(s){return af(s)?fm(s)?s.size()?!1:!0:!0:!1},qn.prototype._42=function(h,n,X){var F,j,L,J,r,M,u,x,G=this,o=G._entities,D=G.rotateMode;for("batch"===D&&(x=G.getKeyOb()),F=0,j=o.length;j>F;F++)L=o[F],G.isNode(L)&&(M=L.getRect(),J=mq.toScreenPosition(X,{x:M.x,y:M.y}),r=mq.toScreenPosition(X,{x:M.x+M.width,y:M.y+M.height}),u={min:J,max:r},L===x&&(u.isKeyOb=!0),mq.Icons.DrawIcon(h,n,mq.Icons.GroupSubEntityRect,u))};var wb=mq.CurveActiving=function(y,m){this._curve=y,this._interactor=y._interactor,this.silent=!0;for(var h in m)this[h]=m[h];delete this.silent};wb.prototype={},wb.prototype.constructor=wb,o.defineProperties(wb.prototype,{point:{get:function(){return this._point},set:function(n){var X=this;X._point=n,X.editingCtrl||X.silent||X._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(E){var A=this;A._pairs=E,A.editingCtrl&&!A.silent&&A._firePointChange()}}}),wb.prototype._firePointChange=function(){var U=this,X=U.getCurrentEditingPoint(),E=U._interactor;if(!X)return E.fi({kind:"selectPoint"}),void 0;var G=this._curve.target;if(G){var Y=mq.getDataMatrix(G).invert(),K=X.e;X=Y.apply(mq.toWorldPosition(E.gv,X)),X.e=K;var y=U._lastFirePoint;y&&Math.abs(X.x-y.x)<1e-5&&Math.abs(X.y-y.y)<1e-5&&(X.e==W&&y.e==W||Math.abs(X.e-y.e)<1e-5)||(U._lastFirePoint=X,E.fi({kind:"selectPoint",x:X.x,y:X.y,e:X.e}))}},wb.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},wb.prototype.getCurrentEditingPoint=function(){var E=this,q=E.editingCtrl;if(q){var f=E.pairs;if(f){var A=f[q.pairId];if(A){var H=A[q.type];if(H)return H}}}return E._point};var hi=mq.CursorFactory=function(B){var $=this;$._interactor=B,$._rotateCursorStyles={}};hi.prototype={},hi.prototype.constructor=hi,hi.prototype.getRotateCursor=function(T){var U=this;0>T&&(T+=2*Math.PI);var c=U._interactor,L=c.getStyle("rotateCursorSize"),y=c.getStyle("rotateCursorRound"),X=Math.round(180*(T/Math.PI)/y);X*y>=360&&(X=0);var Q=U._rotateCursorStyles,Y="htCustomRotateStyle_"+L+"_"+y+"_"+X;return Q[Y]||(U._produceRotateCursor(Y,L,y,X),Q[Y]=!0),Y},hi.prototype._produceRotateCursor=function(e,Y,$,c){var q=this;q._interactor;var I=q._canvas;I||(I=q._canvas=m.createElement("canvas"));var v=H.devicePixelRatio;I.width=I.height=Y*v,I.style.width=I.style.height=Y+" px";var V=I.getContext("2d");mq.setAntialias(V,!1),V.scale(v,v);var o,Z,J,M,n,B=Math.round(Y/2),b=""+B+" "+B+",auto !important;",W=4;o=Math.PI/180*c*$,V.clearRect(0,0,Y,Y),V.save(),V.scale(Y/32,Y/32),V.translate(16,15),V.rotate(o+Math.PI/2),V.beginPath(),V.moveTo(-8,0),V.lineTo(-8,W),V.lineTo(-8+W,W),V.moveTo(8,0),V.lineTo(8,W),V.lineTo(8-W,W),V.moveTo(-8,W),V.quadraticCurveTo(0,-6,8,W),V.restore(),V.lineCap="round",V.lineJoin="miter",V.strokeStyle="white",V.lineWidth=4,V.stroke(),V.strokeStyle="black",V.lineWidth=2,V.stroke(),Z=JSON.stringify(I.toDataURL()),M="cursor:url("+Z+")"+b,1!==v&&(J='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+Y+'px" height="'+Y+'px"><image xlink:href='+Z+' width="'+Y+'" height="'+Y+'"/></svg>',M+="cursor:url(data:image/svg+xml;base64,"+btoa(J)+")"+b,M+="cursor:-webkit-image-set(url("+Z+")"+v+"x,url("+Z+")1x)"+b),n=m.createElement("style"),n.textContent="body."+e+" *, ."+e+"{"+M+"}",m.head.appendChild(n)};var Nd=mq.Guide.Grid=function(r){var l=this;l._interactor=r,l._alignmentGuideId=0,l._xAlignmentGuide=[],l._yAlignmentGuide=[]};Nd.prototype={},Nd.prototype.constructor=Nd,o.defineProperties(Nd.prototype,{gridBlockSize:{get:function(){var Q=this;return Q._gridBlockSize||Q._interactor.getStyle("gridBlockSize")},set:function(p){this._gridBlockSize=p,this._interactor._42()}},gridThickLinesEvery:{get:function(){var x=this;return x._gridThickLinesEvery||x._interactor.getStyle("gridThickLinesEvery")},set:function(c){this._gridThickLinesEvery=c,this._interactor._42()}},gridEnabled:{get:function(){var J=this,d=J._interactor;return d.gridEnabled&&J.isValidGrid()}}}),Nd.prototype._42=function(){var R=this,$=R._interactor;R.gridEnabled&&R.drawGrid(),$.alignmentGuideEnabled&&R.drawAlignmentGuide()},Nd.prototype.makeMatrix=function(){var P=this,u=P._interactor.getStyle("gridAngle"),v=P._interactor.getStyle("gridRotation"),H=new mq.Math.Matrix2d,m=Math.sin(u),T=Math.cos(u);return H.set(1,0,T,m,0,0),H.rotate(v),H},Nd.prototype.isValidGrid=function(){var E=this,X=Math.PI,K=E._interactor,J=K.gv;if(J._zoom<K.getStyle("gridZoomThreshold"))return!1;var i=K.getStyle("gridAngle"),t=Math.abs(180*(i%X/X)),p=1-1e-8;return p>t||t>180-p?!1:!0},Nd.prototype.drawAlignmentGuide=function(){var N=this,o=N._interactor,q=o.gv,Z=o._canvas,f=o._context,W=Z.width,l=Z.height,$=q.tx(),F=q.ty(),w=q._zoom;f.beginPath(),f.strokeStyle=o.getStyle("gridAlignmentGuideColor"),f.lineWidth=1,N._xAlignmentGuide.forEach(function(m){var g=m.p*w+$;f.moveTo(g,0),f.lineTo(g,l)}),N._yAlignmentGuide.forEach(function(V){var X=V.p*w+F;f.moveTo(0,X),f.lineTo(W,X)}),f.stroke()},Nd.prototype.drawGrid=function(){function D(D,A,M,v){var R=mq.toScreenPosition(d,I.apply({x:D,y:A})),k=mq.toScreenPosition(d,I.apply({x:M,y:v}));N.moveTo(R.x,R.y),N.lineTo(k.x,k.y)}var P=this,A=P._interactor,$=P.gridBlockSize,X=P.gridThickLinesEvery,c=A.getStyle("gridThickColor"),z=A.getStyle("gridLightColor"),d=A.gv,Q=A._canvas,N=A._context,q=Q.width,t=Q.height,I=P.makeMatrix(),x=I.applyInverse(mq.toWorldPosition(d,{x:0,y:0})),r=I.applyInverse(mq.toWorldPosition(d,{x:q,y:0})),w=I.applyInverse(mq.toWorldPosition(d,{x:0,y:t})),k=I.applyInverse(mq.toWorldPosition(d,{x:q,y:t})),R=Math.min(x.x,r.x,w.x,k.x),g=Math.max(x.x,r.x,w.x,k.x),m=Math.min(x.y,r.y,w.y,k.y),M=Math.max(x.y,r.y,w.y,k.y);q=g-R,t=M-m;var W=Math.ceil(R/$),F=Math.floor(g/$),b=Math.ceil(m/$),J=Math.floor(M/$);d.tx(),d.ty(),d._zoom;var h,K,B;for(N.save(),N.lineWidth=1,N.beginPath(),N.strokeStyle=c,B=Math.ceil(W/X)*X;F>=B;B+=X)h=B*$,D(h,m,h,M);for(B=Math.ceil(b/X)*X;J>=B;B+=X)K=B*$,D(R,K,g,K);for(N.stroke(),N.beginPath(),N.strokeStyle=z,B=W;F>=B;B++)0!==B%X&&(h=B*$,D(h,m,h,M));for(B=b;J>=B;B++)0!==B%X&&(K=B*$,D(R,K,g,K));N.stroke(),N.restore()},Nd.prototype.getAlignmentGuides=function(){var K=this;return{x:K._xAlignmentGuide,y:K._yAlignmentGuide}},Nd.prototype.addAlignmentGuide=function(P,D,O){var i=this,l="x"===P?i._xAlignmentGuide:i._yAlignmentGuide,O=O?O:++i._alignmentGuideId,v={p:D,id:O};if(l.length){var h=i._findClosestAlignmentGuide(v.p,l);h.dis<0?l.splice(h.index+1,0,v):l.splice(h.index,0,v)}else l.push(v);return i._interactor._42(),O},Nd.prototype.findClosest=function(f,k,N){var L=this,b=L._interactor,U=b.gv;N&&(f=mq.toWorldPosition(U,f));var Z,E,d,J=1/0,T=1/0,e=f.x,O=f.y;if(L.gridEnabled){var X=L.gridBlockSize,g=L.makeMatrix(),w=g.applyInverse(f);w=g.apply({x:Math.round(w.x/X)*X,y:Math.round(w.y/X)*X}),J=w.x-e,T=w.y-O,d=!0}if(b.alignmentGuideEnabled&&(Z=L._findClosestAlignmentGuide(e,L._xAlignmentGuide).dis,E=L._findClosestAlignmentGuide(O,L._yAlignmentGuide).dis,Math.abs(Z)<Math.abs(J)&&(J=Z,d=!0),Math.abs(E)<Math.abs(T)&&(T=E,d=!0)),d){d=!1;var H=U._zoom,G=b.getStyle("smartGuideThreshold")/H,m={};if(Math.abs(J)<G&&"y"!==k&&(m.x=N?J*H:J,d=!0),Math.abs(T)<G&&"x"!==k&&(m.y=N?T*H:T,d=!0),d)return m}},Nd.prototype._findClosestAlignmentGuide=function(v,X){if(!X.length)return{dis:1/0};for(var A,G=0,F=X.length-1;F-G>1;)A=Math.floor((G+F)/2),X[A].p<v?G=A:F=A;var z=X[G].p-v,n=X[F].p-v;return Math.abs(z)<=Math.abs(n)?{line:X[G],dis:z,index:G}:{line:X[F],dis:n,index:F}},Nd.prototype.removeAllAlignmentGuide=function(C){var d=this;"y"!==C&&(d._xAlignmentGuide=[]),"x"!==C&&(d._yAlignmentGuide=[]),d._interactor._42()},Nd.prototype.removeAlignmentGuide=function(J){for(var n,o,b,s=this,S=s._xAlignmentGuide,Z=0;2>Z;Z++)for(S=0===Z?s._xAlignmentGuide:s._yAlignmentGuide,n=0,o=S.length;o>n;n++)if(b=S[n],b.id===J)return S.splice(n,1),s._interactor._42(),{axis:0===Z?"x":"y",position:b.p};return!1},Nd.prototype.adjustAlignmentGuide=function(S,P){var V=this,D=V.removeAlignmentGuide(S);return D?(V.addAlignmentGuide(D.axis,P,S),!0):!1};var yc=mq.Guide.Rect=function(d){var D=this;D._interactor=d};yc.prototype={},yc.prototype.constructor=yc,yc.prototype.gatherRects=function(){var j,M,C,B,t=this,s=t._interactor.gv,Z=[],u=[],o={x:Z,y:u},r={},g=s.getDataModel(),d=g.a("width"),L=g.a("height");d&&L&&(j=0,M=0,C=d,B=L,Z.push({node:g,type:0,p:j},{node:g,type:1,p:j+C/2},{node:g,type:2,p:j+C}),u.push({node:g,type:0,p:M},{node:g,type:1,p:M+B/2},{node:g,type:2,p:M+B}),r[g._id||0]={x:j,y:M,width:C,height:B}),g.each(function(x){if(af(x)&&!s.isSelected(x)&&s.isVisible(x)&&s.isValidGuideLineSource(x)){var S=!1;if(s.sm().getSelection().each(function(I){S||(x.isHostOn(I)?S=!0:x.isDescendantOf(I)&&(S=!0))}),!S){var k=x.getRect();j=k.x,M=k.y,C=k.width,B=k.height,Z.push({node:x,type:0,p:j},{node:x,type:1,p:j+C/2},{node:x,type:2,p:j+C}),u.push({node:x,type:0,p:M},{node:x,type:1,p:M+B/2},{node:x,type:2,p:M+B}),r[x._id]=k}}}),Z.sort(function(Z,n){return Z.p-n.p}),u.sort(function(a,n){return a.p-n.p}),t._grid=o,t._87I=r},yc.prototype.gatherLines=function(m,B,C){var n,W,v,d,a,z,l,p,S,P,b,R,c=this,u=[c.findClosest({x:m.x,y:m.y},B),c.findClosest({x:m.x+m.w/2,y:m.y+m.h/2},B),c.findClosest({x:m.x+m.w,y:m.y+m.h},B)],r={},o=c._87I;C=C||255;var k,D;for(c._guideLine=[],n=0;2>n;n++)for(r={},0===n?(d="y",p=m.x,S=p+m.w):(d="x",p=m.y,S=p+m.h),W=0;3>W;W++)a=u[W],a&&isFinite(a[d])&&(k=1<<3*n+W,C&k&&(z=a[d+"Line"],l=z.node,D=l._id||0,r[D]||(r[D]=!0,R=o[D],"y"===d?(P=R.x,b=R.x+R.width):(P=R.y,b=R.y+R.height),v=z.p,c._guideLine.push({type:d,a:p,b:S,c:P,d:b,p:v,center:1===z.type}))))},yc.prototype._binarySearchClosest=function(l,g){if(!g.length)return{dis:1/0};for(var i,s=0,y=g.length-1;y-s>1;)i=Math.floor((s+y)/2),g[i].p<l?s=i:y=i;var E=g[s].p-l,L=g[y].p-l;return Math.abs(E)<=Math.abs(L)?{line:g[s],dis:E}:{line:g[y],dis:L}},yc.prototype.findClosest=function(h,O,W){var Q=this,q=Q._interactor,E=q.gv,_=Q._grid;W&&(h=mq.toWorldPosition(E,h));var G,X=Q._binarySearchClosest(h.x,_.x),V=Q._binarySearchClosest(h.y,_.y),x=X.dis,P=V.dis,a=E._zoom,S=q.getStyle("smartGuideThreshold")/a,r={};return Math.abs(x)<S&&"y"!==O&&(r.x=W?x*a:x,r.xLine=X.line,G=!0),Math.abs(P)<S&&"x"!==O&&(r.y=W?P*a:P,r.yLine=V.line,G=!0),G?r:void 0},yc.prototype._42=function(){var E=this,A=E._guideLine;if(A&&!n.Default.isCtrlDown()){var s=E._interactor;if(s.getStyle("guideLineVisible")){var l,a,b,m,k,y,z,X,Q,o,S,B,i,U,Z,q,N,v=s.gv,C=s._context,j=v.tx(),M=v.ty(),L=v._zoom,p=s.getStyle("guideLineTextSpacing");for(l=0,a=A.length;a>l;l++)b=A[l],X=b.type,Q=b.p,o=b.a,S=b.b,B=b.c,i=b.d,U=Math.min(o,B),Z=Math.max(S,i),"x"===X?(m=Q*L+j,k=U*L+M,y=m,z=Z*L+M):(m=U*L+j,k=Q*L+M,y=Z*L+j,z=k),mq.Icons.DrawIcon(s,C,mq.Icons.MoveLineGuide,{rect:[m,k,y,z],center:b.center}),i>=o&&S>=B||(U=o>i?i:S,Z=o>i?o:B,N=Z-U,"x"===X?(b.center2center||(m-=p,y=m),k=U*L+M,z=Z*L+M,q=mq.Icons.MoveLineGuideDistanceV):"y"===X&&(b.center2center||(k-=p,z=k),m=U*L+j,y=Z*L+j,q=mq.Icons.MoveLineGuideDistanceH),mq.Icons.DrawIcon(s,C,q,{x0:m,y0:k,x1:y,y1:z,dis:N}))}}},yc.prototype.clear=function(){this._guideLine=null};var nl=mq.Guide.Hover=function(c){var E=this;E._interactor=c};nl.prototype={},nl.prototype.constructor=nl,o.defineProperties(nl.prototype,{}),nl.prototype._42=function(){var D=this._interactor;if(D.getStyle("hoverGuideVisible")&&!D.gvEditing){var w=D.hoverData,X=D.gv;if(!af(w)||X.isSelected(w))return D.hoverData=null,void 0;var v=$q(X,w),q=mq.toScreenPosition(X,{x:v.x,y:v.y}),z=mq.toScreenPosition(X,{x:v.x+v.width,y:v.y+v.height});mq.Icons.DrawIcon(D,D._context,mq.Icons.HoverDataRect,{min:q,max:z,color:D.getStyle("hoverGuideColor")||D.getStyle("baseColor"),borderWidth:D.getStyle("hoverGuideBorderWidth")||1,borderPattern:D.getStyle("hoverGuideBorderPattern")||[1,4]})}},mq.DefaultStyleMap={baseColor:"rgb(51,153,255)",pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,moveDummyThreshold:32,moveDummyPosition:[0,0,-16,-16],moveDummyLineExtraShift:[-32,0],moveDummySensitivity:16,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,rotateTipVisible:!0,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideThreshold:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,edgeHostEdgeMaxDistance:12,edgeHostEdgeHighlighColor:"#5d5d5d",edgeHostPointHighlighColor:"red",edgeHostHighlighPeriod:1500,edgeElevationEditable:!1,attachThreshold:25,guideLineVisible:!0,guideLineTextSpacing:0,hoverGuideVisible:!1,hoverGuideColor:null,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],curveTipVisible:!0,connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var Kb=mq.Icons={},ge=1e4,ap=null,cs=mq.DefaultStyleMap.baseColor,tc="rgb(183,232,135)",em="rgb(255,204,153)",Zl=6;n.Default.setImage("Icons.RectPoint",{width:Zl,height:Zl,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return cs}},rect:[0,0,Zl,Zl]}]}),Kb.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var m=Kb.GroupSubEntityRect.data;if(!m)return[];var U=m.min,z=m.max;return[U.x,U.y,U.x,z.y,z.x,z.y,z.x,U.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Kb.GroupSubEntityRect.data.isKeyOb?cs:cs}}}]};var Ln=4;Kb.HoverDataRect={comps:[{type:"shape",points:{func:function(){var t=Kb.HoverDataRect.data;if(!t)return[];var q=t.min,V=t.max,n=Ln;return q.x-=n,q.y-=n,V.x+=n,V.y+=n,[q.x,q.y,q.x,V.y,V.x,V.y,V.x,q.y]}},segments:[1,2,2,2,5],background:null,borderWidth:{func:function(){return Kb.HoverDataRect.data.borderWidth}},borderColor:{func:function(){return Kb.HoverDataRect.data.color}},borderCap:"butt",borderPattern:{func:function(){return Kb.HoverDataRect.data.borderPattern}}}]},Kb.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Kb.Line.data.P1.x,Kb.Line.data.P1.y],Zl,Zl]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Kb.Line.data.P2.x,Kb.Line.data.P2.y],Zl,Zl]}}}]},Kb.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return Kb.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},Kb.Rect={comps:[{type:"shape",points:{func:function(){var G=Kb.Rect.data;if(!G)return[];var n=G.LT,M=G.LB,q=G.RB,m=G.RT;return[n.x,n.y,M.x,M.y,q.x,q.y,m.x,m.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return cs}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Kb.Rect.data.rotation}},rect:{func:function(){return[[Kb.Rect.data.LT.x,Kb.Rect.data.LT.y],Zl,Zl]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Kb.Rect.data.rotation}},rect:{func:function(){return[[Kb.Rect.data.LB.x,Kb.Rect.data.LB.y],Zl,Zl]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Kb.Rect.data.rotation}},rect:{func:function(){return[[Kb.Rect.data.RB.x,Kb.Rect.data.RB.y],Zl,Zl]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Kb.Rect.data.rotation}},rect:{func:function(){return[[Kb.Rect.data.RT.x,Kb.Rect.data.RT.y],Zl,Zl]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Kb.Rect.data.rotation}},visible:{func:function(){return Kb.Rect.data.L?!0:!1}},rect:{func:function(){return[[Kb.Rect.data.L.x,Kb.Rect.data.L.y],Zl,Zl]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Kb.Rect.data.rotation}},visible:{func:function(){return Kb.Rect.data.R?!0:!1}},rect:{func:function(){return[[Kb.Rect.data.R.x,Kb.Rect.data.R.y],Zl,Zl]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Kb.Rect.data.rotation}},visible:{func:function(){return Kb.Rect.data.T?!0:!1}},rect:{func:function(){return[[Kb.Rect.data.T.x,Kb.Rect.data.T.y],Zl,Zl]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Kb.Rect.data.rotation}},visible:{func:function(){return Kb.Rect.data.B?!0:!1}},rect:{func:function(){return[[Kb.Rect.data.B.x,Kb.Rect.data.B.y],Zl,Zl]}}}]};var wg=16;n.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:{func:function(){return cs}},borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:{func:function(){return cs}},shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),Kb.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[Kb.Anchor.data.POS.x,Kb.Anchor.data.POS.y],wg,wg]}}}]},Kb.TipShiftX=12,Kb.TipShiftY=12;var Ej=[8,28];Kb.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[Kb.TipHelper.data.helperPos.x,Kb.TipHelper.data.helperPos.y,Ej[0]*Kb.TipHelper.data.size,Ej[1]]}},background:{func:function(){return ap.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return Kb.TipHelper.data.text}},rect:{func:function(){return[Kb.TipHelper.data.helperPos.x,Kb.TipHelper.data.helperPos.y,Ej[0]*Kb.TipHelper.data.size,Ej[1]]}},color:{func:function(){return ap.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var Fo=7;Kb.ShapePoint={comps:[{type:"circle",visible:{func:function(){return!!Kb.ShapePoint.data.dynamicVisible}},rect:{func:function(){var N=Kb.ShapePoint.data.point,z=Kb.ShapePoint.data.size||Fo;return[N,z+10,z+10]}},background:{func:function(){var L=Date.now(),$=Kb.ShapePoint.data.dynamicPeriod||1500,J=Math.sin(L%$/$*Math.PI);return"rgba(27,124,22,"+.5*J+")"}},borderWidth:0},{type:"circle",rect:{func:function(){var V=Kb.ShapePoint.data.point,I=Kb.ShapePoint.data.size||Fo;return[V,I,I]}},background:{func:function(){var m=Kb.ShapePoint.data.isEnd;return m?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:{func:function(){return Kb.ShapePoint.data.color||cs}}},{type:"rect",visible:{func:function(){return!!Kb.ShapePoint.data.dynamicVisible}},background:"red",borderWidth:0,rotation:Math.PI/4,borderColor:{func:function(){return cs}},rect:{func:function(){var k=5;return[Kb.ShapePoint.data.point,k,k]}}}]},Kb.ShapeBgCurve={comps:[{type:"shape",visible:{func:function(){return!!Kb.ShapeBgCurve.data.dynamicVisible}},points:{func:function(){return Kb.ShapeBgCurve.data.P}},segments:{func:function(){return Kb.ShapeBgCurve.data.S}},background:null,borderWidth:6,borderColor:{func:function(){var F=Date.now(),n=Kb.ShapeBgCurve.data.dynamicPeriod||1500,C=Math.sin(F%n/n*Math.PI);return"rgba(27,124,22,"+.3*C+")"}}},{type:"shape",points:{func:function(){return Kb.ShapeBgCurve.data.P}},segments:{func:function(){return Kb.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:{func:function(){return Kb.ShapeBgCurve.data.color||cs}}}]};var Vp=8;Kb.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var d=Kb.ShapeHighlighPoint.data;return[[d.x,d.y],Vp,Vp]}},background:{func:function(){return ap.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var Ym=10;Kb.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var $=Kb.ShapeHighlighRealPoint.data;return[[$.x,$.y],Ym,Ym]}},background:"#ffffff",borderWidth:2,borderColor:{func:function(){return cs}}}]};var fg=8;Kb.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var b=Kb.ShapeHighlighCtrlPoint.data,E=b.x,L=b.y,c=fg/2;return[E-c,L-c,E-c,L+c,E+c,L+c,E+c,L-c]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return ap.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return ap.getStyle("shapeCtrlPointBorderColor")||cs}}}]};var _i=3;Kb.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return Kb.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:_i,borderColor:{func:function(){return ap.getStyle("curveHighlightColor")}}}]},Kb.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return Kb.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},Kb.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return Kb.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return Kb.MoveLineGuide.data.center?tc:em}}}]};var we=5;Kb.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var $=Kb.MoveLineGuideDistanceH.data,E=$.x0,Z=$.y0;return[E,Z-we,E,Z+we]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:em},{type:"shape",points:{func:function(){var X=Kb.MoveLineGuideDistanceH.data,Y=X.x1,r=X.y1;return[Y,r-we,Y,r+we]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:em},{type:"text",text:{func:function(){return Math.round(Kb.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var E=Kb.MoveLineGuideDistanceH.data;return[[(E.x0+E.x1)/2,E.y0-10],20,20]}},color:em,font:"12px Arial",align:"center"}]},Kb.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var d=Kb.MoveLineGuideDistanceV.data,w=d.x0,k=d.y0;return[w-we,k,w+we,k]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:em},{type:"shape",points:{func:function(){var U=Kb.MoveLineGuideDistanceV.data,Z=U.x1,w=U.y1;return[Z-we,w,Z+we,w]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:em},{type:"text",text:{func:function(){return Math.round(Kb.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var H=Kb.MoveLineGuideDistanceV.data;return[[H.x0-10,(H.y0+H.y1)/2],20,20]}},color:em,font:"12px Arial",align:"center"}]},n.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),Kb.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var U=Kb.EdgeElevationGuide.data,X=U.x,i=U.y,$=ap.getStyle("curveElevationIntersectSize"),p=ap.getStyle("curveElevationGuideShift");return X+=p[0],i+=p[1],[X-$,i-$,2*$,2*$]}}}]},n.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),n.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),Kb.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return Kb.ConnectGuide.data.rotation}},rect:{func:function(){var U=Kb.ConnectGuide.data.connect;U.x,U.y;var M=ap.getStyle("connectGuideIntersectSize");return[[U.x,U.y],2*M,2*M]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var t=Kb.ConnectGuide.data.cursorPos||Kb.ConnectGuide.data.connect,a=ap.getStyle("connectGuideIntersectSize");return[[t.x,t.y],2*a-2,2*a-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var d=Kb.ConnectGuide.data.connect,q=Kb.ConnectGuide.data.cursorPos||d;return[d.x,d.y,d.x+.5*(q.x-d.x),d.y,q.x+.5*(d.x-q.x),q.y,q.x,q.y]}}}]},n.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),n.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),Kb.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var R=Kb.ConnectGuideGarbage.data.hover;return R?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var s=Kb.ConnectGuideGarbage.data,N=ap.getStyle("connectGuideGarbageIntersectsize");return s.hover&&(N+=5),[[s.x,s.y],2*N,2*N]}}}]};var Vk=6;Kb.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return Kb.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var t=Kb.ShapeActivingCtrl.data;return[t.point.x,t.point.y,t.c1.x,t.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return cs}}},{type:"shape",visible:{func:function(){return Kb.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var z=Kb.ShapeActivingCtrl.data;return[z.point.x,z.point.y,z.c2.x,z.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return cs}}},{type:"shape",visible:{func:function(){return Kb.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var m=Kb.ShapeActivingCtrl.data.c1,Y=m.x,_=m.y,p=Vk/2;return"c1"===Kb.ShapeActivingCtrl.data.hl&&(p+=.5),[Y-p,_-p,Y-p,_+p,Y+p,_+p,Y+p,_-p]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return ap.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===Kb.ShapeActivingCtrl.data.hl?ap.getStyle("shapeCtrlPointHighlightBorder")||cs:ap.getStyle("shapeCtrlPointBorderColor")||cs}}},{type:"shape",visible:{func:function(){return Kb.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var E=Kb.ShapeActivingCtrl.data.c2,V=E.x,t=E.y,w=Vk/2;return"c2"===Kb.ShapeActivingCtrl.data.hl&&(w+=.5),[V-w,t-w,V-w,t+w,V+w,t+w,V+w,t-w]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return ap.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===Kb.ShapeActivingCtrl.data.hl?ap.getStyle("shapeCtrlPointHighlightBorder")||cs:ap.getStyle("shapeCtrlPointBorderColor")||cs}}}]},Kb.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return cs}},rect:{func:function(){return[[Kb.RoundPoint.data.x,Kb.RoundPoint.data.y],Zl,Zl]}}}]},Kb.AttachPoint={comps:[{type:"rect",background:{func:function(){return Kb.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:{func:function(){return cs}},rect:{func:function(){var Z=Kb.AttachPoint.data.isAttach?Zl+4:Zl;return[[Kb.AttachPoint.data.x,Kb.AttachPoint.data.y],Z,Z]}}}]},Kb.SimpleRect={comps:[{type:"rect",background:null,borderWidth:{func:function(){return Kb.SimpleRect.data.borderWidth||1}},borderColor:{func:function(){return Kb.SimpleRect.data.color||cs}},rect:{func:function(){var l=Kb.SimpleRect.data;return[l.x,l.y,l.width,l.height]}}}]},n.Default.setImage("Icons.MoveDummyImage",{width:32,height:32,boundExtend:12,attachStyle:"close",comps:[{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",shadow:!0,shadowColor:"rgba(0,0,0,0.25)",shadowOffsetX:0,rect:[0,0,32,32]},{type:"shape",background:"rgb(51,153,255)",pixelPerfect:!0,points:[8.65079,11.90713,9.05502,11.46921,9.70629,11.46921,10.11052,11.90713,10.51476,12.28891,10.51476,12.92895,10.11052,13.34441,8.49359,14.97258,12.2889,14.97258,12.85034,14.97258,13.29949,15.42172,13.29949,15.99439,13.29949,16.57828,12.85034,17.0162,12.2889,17.0162,8.49359,17.0162,10.11052,18.6556,10.51476,19.0486,10.51476,19.7111,10.11052,20.09288,9.70629,20.50834,9.05502,20.50834,8.65079,20.09288,5.32709,16.76917,5.28217,16.71303,4.87794,16.32002,4.87794,15.67998,5.28217,15.26452,8.65079,11.90713,8.65079,11.90713,8.65079,11.90713,13.3444,10.09931,13.3444,10.09931,12.94017,10.50354,12.2889,10.50354,11.88467,10.09931,11.48043,9.69507,11.48043,9.0438,11.88467,8.63957,15.27574,5.25973,15.66874,4.86672,16.32001,4.86672,16.73547,5.25973,16.76917,5.31586,20.10409,8.63957,20.50832,9.0438,20.50832,9.68385,20.10409,10.09931,19.69986,10.49231,19.07105,10.50354,18.64436,10.09931,17.02742,8.45991,17.02742,12.26646,17.02742,12.83912,16.55581,13.31072,15.99438,13.31072,15.43295,13.31072,14.98379,12.83912,14.98379,12.26646,14.96134,8.45991,13.3444,10.09931,13.3444,10.09931,13.3444,10.09931,21.90069,13.33318,21.90069,13.33318,21.49646,12.91771,21.49646,12.27768,21.90069,11.89591,22.31615,11.45798,22.94497,11.45798,23.36043,11.89591,26.72904,15.2533,27.12205,15.66876,27.12205,16.3088,26.72904,16.7018,26.6729,16.75794,23.36043,20.08165,22.94497,20.49711,22.31615,20.49711,21.90069,20.08165,21.49646,19.69987,21.49646,19.03737,21.90069,18.64437,23.51763,17.00498,19.72231,17.00498,19.14965,17.00498,18.71173,16.56705,18.71173,15.98316,18.71173,15.41049,19.14965,14.96135,19.72231,14.96135,23.51763,14.96135,21.90069,13.33318,21.90069,13.33318,21.90069,13.33318,11.88467,23.32675,11.88467,23.32675,11.48043,22.94498,11.48043,22.27125,11.88467,21.88948,12.2889,21.48523,12.94017,21.48523,13.3444,21.88948,14.96134,23.52887,14.98379,19.7111,14.98379,19.14966,15.43295,18.67805,15.99438,18.67805,16.55581,18.67805,17.02742,19.14966,17.02742,19.7111,17.02742,23.52887,18.64436,21.88948,19.07105,21.48523,19.69986,21.48523,20.10409,21.88948,20.50832,22.27125,20.50832,22.94498,20.10409,23.32675,16.76917,26.65045,16.73547,26.72905,16.32001,27.13329,15.66874,27.13329,15.27574,26.72905,11.88467,23.32675,11.88467,23.32675,11.88467,23.32675],segments:[1,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2]}]}),Kb.MoveDummy={comps:[{type:"image",name:"Icons.MoveDummyImage",rect:{func:function(){var D=Kb.MoveDummy.data;
return[[D.pos.x,D.pos.y],2*D.size,2*D.size]}}}]},mq.Icons.DrawIcon=function(z,K,D,r){D.width=D.height=ge,D.data=r,ap=z,n.Default.drawImage(K,D,0,0,ge,ge),ap=W},mq.Icons.MapPoints=function(p,Z){for(var _=0,O=p.length;O>_;_++)p[_]/=Z},mq.roundTo=function($,o,K){var x=Math.abs($%o);return K>x||K>o-x?o*Math.round($/o):$},mq.toFixed=function(f){return Math.round(100*f)/100},mq.getDataMatrix=function(h){if(h instanceof n.Shape){var A=new n.Math.Matrix2d,b=h.getPosition();return A.translate(-b.x,-b.y).scale(h.getScale().x,h.getScale().y).rotate(h.getRotation()).translate(b.x,b.y),A}return h.getMatrix?h.getMatrix():new n.Math.Matrix2d};var Ck=mq.Math.Curve=function(){this._curves=[]};Ck.prototype={},Ck.prototype.constructor=Ck,Ck.prototype.createFromHtShape=function(r,N,b){N instanceof n.List&&(N=N.toArray());var K,R,m,f,G,L,t,$=this,g=null,T=null,B=0,l=mq.Math.Vector2,P=mq.Math.CubicBezier,U=function(D){return new l(r[D],r[D+1],b?b[D/2]:W)};for(R=0,m=N.length;m>R;R++){switch(f=N[R],G=null,f){case 1:T=U(B),g=T,B+=2;break;case 2:K=U(B),B+=2,G=new P(T,T.clone(),K.clone(),K),T=K;break;case 3:L=U(B),K=U(B+2),B+=4,G=new P(T,L.clone().sub(T).multiplyScalar(2/3).add(T),L.clone().sub(K).multiplyScalar(2/3).add(K),K),T=K;break;case 4:L=U(B),t=U(B+2),K=U(B+4),B+=6,G=new P(T,L,t,K),T=K;break;case 5:if(!g)break;G=new P(T,T.clone(),g.clone(),g),T=null,g=null}G&&(G._index=$._curves.length,$._curves.push(G))}},Ck.prototype.checkPoint=function(D,W){var k,Y,H,i,V,f=this,U=f._curves;for(k=0,Y=U.length;Y>k;k++)if(i=U[k],V=i.intersectRect(D,W,W),V.length)return H=0,V.forEach(function(_){H+=_.t}),H/=V.length,D=i.getPointAt(H),D.t=H,{bezier:i,intersection:D}},Ck.prototype.insertKnot=function(v,U){var E=v.insertKnot(U),t=this,g=t._curves;g.splice(v._index,1,E[0],E[1])},Ck.prototype._isCloseEnough=function(f,d){return Math.abs(f.x-d.x)<1e-6&&Math.abs(f.y-d.y)<1e-6},Ck.prototype._isSamePoint=function(P,I){return P===I},Ck.prototype.moveRealPoint=function(K,p){var z=this,U=z._curves,q=p.clone().sub(K);U.forEach(function(n){var N=n._p1;n._p2,n._p3;var k=n._p4;z._isSamePoint(N,K)&&(n._p2.add(q),n._p1=p),z._isSamePoint(k,K)&&(n._p3.add(q),n._p4=p)})},Ck.prototype.moveCtrlDueToRealPointMovement=function(v,P){var Q=this,E=Q._curves,p=function(q){q.add(P),q.e&&P.e&&(q.e+=P.e)};E.forEach(function(r){var l=r._p1;r._p2,r._p3;var C=r._p4;Q._isSamePoint(l,v)&&p(r._p2),Q._isSamePoint(C,v)&&p(r._p3)})},Ck.prototype.moveCtrlPoint=function(E,X,m){var b=E[m];if(b){b.e!==W&&(X.e=b.e);var k=this,L=k._curves;X.clone().sub(b),L.forEach(function(O){var W;"c2"===m?W="_p2":"c1"===m&&(W="_p3"),k._isSamePoint(O[W],b)&&(O[W]=X)}),E[m]=X}},Ck.prototype.deleteRealPoint=function(v,K){var s,A,W,d,t,B,b,o=this,O=o._curves,k={},I=[],Z=mq.Math.CubicBezier;for(A=0,W=O.length;W>A;A++)s=O[A],d=s._p1,t=s._p2,B=s._p3,b=s._p4,(k[A]||!o._isSamePoint(d,v))&&(o._isSamePoint(b,v)?W>A+1&&o._isSamePoint(O[A+1]._p1,v)&&(K||I.push(new Z(d,t,O[A+1]._p3,O[A+1]._p4))):I.push(s));o._curves=I},Ck.prototype.findPairs=function(t,I){var Q,K,R,D,c,v,k,s,Y=this,Z=Y._curves,d={},B=[];for(K=0,R=Z.length;R>K;K++)Q=Z[K],D=Q._p1,c=Q._p2,v=Q._p3,k=Q._p4,!d[K]&&Y._isSamePoint(D,t)&&(I?B.push({point:D,r2:k}):B.push({point:D,c2:c})),Y._isSamePoint(k,t)&&(s=I?{point:k,r1:D}:{point:k,c1:v},R>K+1&&Y._isSamePoint(Z[K+1]._p1,t)&&(I?s.r2=Z[K+1]._p4:s.c2=Z[K+1]._p2,d[K+1]=!0),B.push(s));return B},Ck.prototype.toHtShape=function(){var w=this,n=w._curves,N=[],l=[],$={x:1/0,y:1/0};return n.forEach(function(n){var b=n._p1,d=n._p2,f=n._p3,q=n._p4;return w._isCloseEnough(b,$)||(N.push(1),l.push(b.clone())),$=q,w._isCloseEnough(b,d)&&w._isCloseEnough(f,q)?(N.push(2),l.push(q.clone()),void 0):(N.push(4),l.push(d.clone(),f.clone(),q.clone()),void 0)}),{segments:N,points:l}};var Re=mq.Math.CubicBezier=function(P,X,U,A){var x=this;x._id=mq.Math.CubicBezier._globalId++,x._p1=P,x._p2=X,x._p3=U,x._p4=A};Re._globalId=1,Re.prototype={},Re.prototype.constructor=Re,Re.prototype.toString=function(){return this._id},Re.prototype.intersectRect=function(N,S,o){var j=S/2,W=o/2,p=N.x,K=N.y,v=mq.Math.Vector2,E=new v(-j+p,-W+K),l=new v(j+p,W+K),e=new v(l.x,E.y),X=new v(E.x,l.y),g=this,J=g.intersectLine(E,e),P=g.intersectLine(e,l),n=g.intersectLine(l,X),Q=g.intersectLine(X,E),f=J.concat(P).concat(n).concat(Q);return f},Re.prototype.intersectLine=function(c,n){var x,j,l,L,t,_,I,G,q,J,i,W,P,z=this,d=c.clone().min(n),r=c.clone().max(n);L=z._p1,t=z._p2,_=z._p3,I=z._p4,x=L.clone().multiplyScalar(-1),j=t.clone().multiplyScalar(3),l=_.clone().multiplyScalar(-3),i=x.add(j).add(l).add(I),x=L.clone().multiplyScalar(3),j=t.clone().multiplyScalar(-6),l=_.clone().multiplyScalar(3),J=x.add(j).add(l),x=L.clone().multiplyScalar(-3),j=t.clone().multiplyScalar(3),q=x.add(j),G=L.clone(),P=new mq.Math.Vector2(c.y-n.y,n.x-c.x),W=c.x*n.y-n.x*c.y;for(var Z=z.getRoots(P.dot(i),P.dot(J),P.dot(q),P.dot(G)+W),k=new Array,w=0,m=Z.length;m>w;w++){var f=Z[w];if(!(0>f||f>1)){var g=z.getPointAt(f);g.t=f,c.x==n.x?d.y<=g.y&&g.y<=r.y&&k.push(g):c.y==n.y?d.x<=g.x&&g.x<=r.x&&k.push(g):g.x>=d.x&&g.y>=d.y&&g.x<=r.x&&g.y<=r.y&&k.push(g)}}return k},Re.prototype.solveTForPoint=function(o){var t,N,X,i,Z=this;t=Z._p1.x-o.x,N=Z._p2.x-o.x,X=Z._p3.x-o.x,i=Z._p4.x-o.x;for(var w=Z.getRoots(i-3*X+3*N-t,3*X-6*N+3*t,3*N-3*t,t),L=W,y=1/0,S=0,T=w.length;T>S;S++){var Q=w[S];if(!(0>Q||Q>1)){var l=Z.getPointAt(Q);l.t=Q;var C=Math.abs(l.y-o.y);y>C&&(y=C,L=l)}}return L},Re.prototype.getPointAt=function(V){var f=this,c=f._p1,p=f._p2,O=f._p3,k=f._p4,e=c.clone().lerp(p,V),o=p.clone().lerp(O,V),d=O.clone().lerp(k,V),M=e.lerp(o,V),W=o.lerp(d,V);return M.lerp(W,V)},Re.prototype.getPointByPercentage=function(_){var P=this.length*_,C=this._cacheLength,c=C.length;if(0===P)return C[0].point;if(_>=1)return C[c-1].point;for(var d=0;c>d;d++){var V=C[d];if(!(V.len<P)){var H=C[d-1];return V.point.clone().sub(H.point).setLength(P-H.len).add(H.point)}}},Re.prototype.getTByPercentage=function(K){var D=this.length*K,c=this._cacheLength,T=c.length;if(0===D||0>=K)return c[0].t;if(K>=1)return c[T-1].t;for(var s=0;T>s;s++){var M=c[s];if(!(M.len<D)){var g=c[s-1];return(D-g.len)/(M.len-g.len)*(M.t-g.t)+g.t}}},Re.prototype.getRoots=function(s,C,N,L){var W,A,V,c,i,r=new Array;if(Math.abs(s)<1e-6){var W=C,A=N/W,V=L/W,c=A*A-4*V;if(c>0){var i=Math.sqrt(c);r.push(.5*(-A+i)),r.push(.5*(-A-i))}else 0==c&&r.push(.5*-A)}C/=s,N/=s,L/=s,W=(3*N-C*C)/3,A=(2*C*C*C-9*N*C+27*L)/27;var D=C/3,Z=A*A/4+W*W*W/27,k=A/2;if(Math.abs(Z)<=1e-6&&(Z=0),Z>0){var G,B,i=Math.sqrt(Z);G=-k+i,B=G>=0?Math.pow(G,1/3):-Math.pow(-G,1/3),G=-k-i,G>=0?B+=Math.pow(G,1/3):B-=Math.pow(-G,1/3),r.push(B-D)}else if(0>Z){var a=Math.sqrt(-W/3),t=Math.atan2(Math.sqrt(-Z),-k)/3,v=Math.cos(t),O=Math.sin(t),M=Math.sqrt(3);r.push(2*a*v-D),r.push(-a*(v+M*O)-D),r.push(-a*(v-M*O)-D)}else{var G;G=k>=0?-Math.pow(k,1/3):Math.pow(-k,1/3),r.push(2*G-D),r.push(-G-D)}return r},Re.prototype._70I=function(){var c=this;return c._p1.distanceToSquared(c._p2)<1e-10&&c._p3.distanceToSquared(c._p4)<1e-10},Re.prototype.insertKnot=function(u){var t=this,S=t._p1,w=t._p2,J=t._p3,n=t._p4,K=S.clone().lerp(w,u),m=w.clone().lerp(J,u),U=J.clone().lerp(n,u),P=K.clone().lerp(m,u),Z=m.clone().lerp(U,u),X=P.clone().lerp(Z,u);return t._70I()?(S.clone().lerp(n,u),[new mq.Math.CubicBezier(S,S.clone(),X.clone(),X),new mq.Math.CubicBezier(X,X.clone(),n.clone(),n)]):[new mq.Math.CubicBezier(S,K,P,X),new mq.Math.CubicBezier(X,Z,U,n)]},o.defineProperties(Re.prototype,{length:{get:function(){var H=this._cacheLength;if(!H){H=this._cacheLength=[];for(var K=this._p1,w=0,A=0;1>=w;){var B=this.getPointAt(w+=.001);A+=B.clone().sub(K).length(),K=B,H.push({len:A,t:w,point:B.clone()})}}return H[H.length-1].len}},p1:{get:function(){return this._p1},set:function(M){this._p1=M,this._cacheLength=W}},p2:{get:function(){return this._p2},set:function(Q){this._p2=Q,this._cacheLength=W}},p3:{get:function(){return this._p3},set:function(F){this._p3=F,this._cacheLength=W}},p4:{get:function(){return this._p4},set:function(g){this._p4=g,this._cacheLength=W}}});var zk=n.Default.getInternal().ui().EdgeUI,wk={_47O:function(G){var d=this,z=wk.getBackups()._47O;mq.inEdit(d.gv)||z.call(d,G)}};mq.Inject.registAsModule(wk,zk);var is=n.Default.getInternal().ui().NodeUI,Lk={_47O:function(E){var c=this,V=Lk.getBackups()._47O;mq.inEdit(c.gv)||V.call(c,E)},getSelectWidth:function(){var q=this,F=q.gv,U=q._data;if(F.isEditable(U)&&mq.inEdit(F))return 0;var m=Lk.getBackup("getSelectWidth");return m.call(q)}};mq.Inject.registAsModule(Lk,is);var ij=n.graph.GraphView,sk={_editPointSize:function(){var m=n.Default.isTouchable,U=mq.getStyle("pointSize");return U[m?0:1]}(),isPointEditable:function(J){var U=this;if(mq.inEdit(U))return U._pointEditableFunc?U._pointEditableFunc(J):!0;var k=sk.getBackup("isPointEditable");k.call(U,J)},isEditable:function(t){var r,k=this,e=sk.getBackup("isEditable");if(r=t instanceof mq.Group?!0:e.call(k,t),!mq.inEdit(k))return r;if(!(t instanceof n.Edge))return r;if(!t.s("2d.editable"))return!1;var U=k.getEditableFunc();return U?U(t):!0},_42:function(B,e){var c=this,y=sk.getBackups()._42;if(y.call(c,B,e),mq.inEdit(c)){var m=c.getEditInteractor();m.drawImpl()}}};mq.Inject.registAsModule(sk,ij);var Jk=n.Default.getInternal().ui().ShapeUI,pr={_47O:function(I){var F=this,P=pr.getBackups()._47O;mq.inEdit(F.gv)||P.call(F,I)}};mq.Inject.registAsModule(pr,Jk);var Sr=n.graph.DefaultInteractor,Zn={handle_mousewheel:function(N){var A=this,V=Zn.getBackup("handle_mousewheel");mq.inEdit(A.gv)||V.call(A,N)}};mq.Inject.registAsModule(Zn,Sr);var xr=n.graph.MoveInteractor,sm={_calcShift:function(m,k){var F=this,t=sm.getBackup("_calcShift"),Q=F.gv;if(!mq.inEdit(Q))return t.call(F,m,k);var y=Q.getEditInteractor(),I=y.getSubModule("Move").calcShift(m,k,F);return I||t.call(F,m,k)},clear:function(V){var L=this,O=sm.getBackup("clear");O.call(L,V);var h=L.gv;if(mq.inEdit(h)){var Y=h.getEditInteractor();Y.getSubModule("Move").clear(V)}}};mq.Inject.registAsModule(sm,xr);var yc=mq.Rect=function(q){this.catalog="Rect",this._interactor=q};yc.prototype={},yc.prototype.constructor=yc,yc.prototype.gatherInfo=function(N,Z){var J=this;if(1===Z.length){var R=Z[0];return R instanceof n.Shape&&R._70I()?J.gatherLine(N,R):fm(R,N)?!1:J.gatherSingleTarget(N,R)}return Z.length>1?J.gatherMultiTargets(N,Z):!1},yc.prototype.gatherSingleTarget=function(m,w){if(w.getCorners){var H,q=this,E=q.info;q.target=w,H=q.screenInfo={};var x=w.getCorners();E.LT=new mq.Math.Vector2(x[0]),E.LB=new mq.Math.Vector2(x[1]),E.RB=new mq.Math.Vector2(x[2]),E.RT=new mq.Math.Vector2(x[3]),E.T=E.LT.clone().add(E.RT).divideScalar(2),E.B=E.LB.clone().add(E.RB).divideScalar(2),E.L=E.LT.clone().add(E.LB).divideScalar(2),E.R=E.RT.clone().add(E.RB).divideScalar(2);for(var M in E)H[M]=mq.toScreenPosition(m,E[M]);var F=q._interactor,W=F.getStyle("checkSize"),z=function(f,R,d){var O=R.clone().sub(f).setLength(-W),v=d.clone().sub(f).setLength(-W),C=O.add(v).add(f);return C};return H.rotLT=z(H.LT,H.RT,H.LB),H.rotLB=z(H.LB,H.LT,H.RB),H.rotRB=z(H.RB,H.LB,H.RT),H.rotRT=z(H.RT,H.LT,H.RB),H.rotT=H.rotLT.clone().add(H.rotRT).divideScalar(2),H.rotB=H.rotLB.clone().add(H.rotRB).divideScalar(2),H.rotL=H.rotLT.clone().add(H.rotLB).divideScalar(2),H.rotR=H.rotRT.clone().add(H.rotRB).divideScalar(2),H.rotation=w.getRotation(),q.gatherConnectInfo(),!0}},yc.prototype.gatherConnectInfo=function(){var H=this,h=H.target,U=H._interactor,s=H.screenInfo,N=U.gv;if(N.isConnectActionVisible(h)&&U.getStyle("connectGuideVisible")){var i;h.s&&(i=h.s("connectGuideShift")),i||(i=U.getStyle("connectGuideShift"));var F=h.getAnchor(),r=h.getSize(),K=h.toGlobal({x:r.width*(i[0]-F.x),y:r.height*(i[1]-F.y)});K=mq.toScreenPosition(N,K),s.P1?K.add(s.P2.clone().sub(s.P1).setLength(i[2])):(K.add(s.RT.clone().sub(s.LT).setLength(i[2])),K.add(s.LB.clone().sub(s.LT).setLength(i[3]))),s.connect=K}},yc.prototype.gatherMultiTargets=function(W,M){var B=mq.Group.findOrCreateGroup(M,this._interactor._uuid);if(!B)return!1;var u=this;return u.editing&&"rotate"!==u.editing.mode||B.calcInfo(),u.gatherSingleTarget(W,B)},yc.prototype.gatherLine=function(j,C){this.target=C;var K=this.screenInfo={},i=C.getPoints(),D=mq.getDataMatrix(C);return K.P1=mq.toScreenPosition(j,D.apply(i.get(0))),K.P2=mq.toScreenPosition(j,D.apply(i.get(1))),this.gatherConnectInfo(),!0},yc.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],yc.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],yc.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],yc.prototype.check=function(I,$,u){if(n.Default.isLeftButton($)){var N=this;if(N.editing=null,N.tipInfo=null,N.screenInfo){var K=N.target,r=I.isEditable(K),p=N.screenInfo;if(r&&p.connect){var C=N._checkConnect(u);if(C)return C}if(p.P1)return N._checkLine(u);var T,O,H,h=null,L=N._interactor,t=L.getStyle("checkSize");if(r&&I.isRectEditable(K))for(O=0;O<mq.Rect.ResizeKeys.length;O++)if(H=mq.Rect.ResizeKeys[O],mq.checkHit(u,p[H],t)){h=H,T="resize";break}if(!h&&r&&I.isRotationEditable(K)&&!L.getStyle("rotateAsClock")){var G=L.getStyle("rotateCheckSize");for(O=0;O<mq.Rect.RotateKeys.length;O++)if(H=mq.Rect.RotateKeys[O],mq.checkHit(u,p[H],G)){h=H,T="rotate";break}}if(!h)return L.setCursor("default"),void 0;if("rotate"===T){var w,B=I.lp($);if(K instanceof mq.Group){var e=L.getStyle("groupRotateModeKey");"string"==typeof e&&(e=[e]);for(var A=!1,c=0,R=e.length;R>c;c++)if($[e[c]]){A=!0;break}var E=L.getStyle("groupRotateModeDefault");w=A?"batch"===E?"block":"batch":E}var S="batch"===w?K.getAnchor2():K.getPosition(),Y=Math.atan2(B.y-S.y,B.x-S.x);L._setRotateCursor(Y),N.editing={mode:T,key:h,pos:S,flipY:K.getScale().y<0,rotation:K.getRotation(),hitRot:Y},w&&(N.editing.groupRotateMode=w)}else{var X=mq.Rect.ResizeKeys.indexOf(h),W=mq.Rect.ResizeDirection[X],Z=Math.cos(K.getRotation()),J=Math.sin(K.getRotation()),f=W.x*Math.sign(K.getScale().x),P=W.y*Math.sign(K.getScale().y),a=Math.atan2(-J*f-Z*P,Z*f-J*P),z=(Math.round(a/(Math.PI/4))+8)%8,y=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][z];this._interactor.setCursor(y);var l=K.getWidth(),s=K.getHeight(),F=K.getAnchor();N.editing={mode:T,key:h,rect:{x:-l*F.x,y:-s*F.y,width:l,height:s},anchor:F,matrix:K.getMatrix()}}return h}}},yc.prototype._checkLine=function(X){var W=this;W.screenInfo;var Y,c=W._interactor.getStyle("checkSize");if(mq.checkHit(X,W.screenInfo.P1,c))Y="P1";else{if(!mq.checkHit(X,W.screenInfo.P2,c))return this._interactor.setCursor("default"),void 0;Y="P2"}return W.editing={mode:"line",key:Y},Y},yc.prototype._checkConnect=function(L){var i=this,r=i.screenInfo,G=i._interactor,d=G.getStyle("connectGuideIntersectSize"),N=r.connect,f=L.x,l=N.x;if(l>f&&d>l-f&&Math.abs(N.y-L.y)<d||f>=l&&mq.checkHit(L,N,d)){var F="connect",D=H.getConnectAction(G.gv);if(i.editing={mode:F},D&&D.delete)if(i.target instanceof mq.Group){var y=!0;G.gv.sm().getSelection().each(function(b){D.delete.visible.call(null,G.gv,b)||(y=!1)}),i.editing.hasDeleteAction=y}else D.delete.visible.call(null,G.gv,i.target)&&(i.editing.hasDeleteAction=!0);return G.setCursor("default"),F}},yc.prototype._fireEditEvent=function(I,M){var W=this._interactor,Q=this.editing;if(Q){var g=Q.mode;g="rotate"===g?"Rotation":"connect"===g?"Connection":"resize"===g?"Rect":g[0].toUpperCase()+g.slice(1),W.fi({kind:I+"Edit"+g,event:M})}},yc.prototype.startEdit=function(C,h){C.startDragging(h);var J=this;J._interactor.fi({kind:"prepareEdit",event:h});var F=J.editing,G=J.target;if(F){if(J._fireEditEvent("begin",h),F.started=!0,"rotate"===F.mode)return F.groupRotateMode&&G.beginRotate(F),C._42(),void 0;if("connect"!==F.mode)("line"===F.mode||G&&0===G.getRotation())&&(J._inSmartGuide=!0,J._interactor.rectGuide.gatherRects());else if(F.hasDeleteAction){var X=C.gv,E=J._interactor.getStyle("connectGuideGarbageShift");F.garbageInfo={x:X.getWidth()*E[0]+E[2],y:X.getHeight()*E[1]+E[3],size:J._interactor.getStyle("connectGuideGarbageIntersectsize")},C._42()}}},yc.prototype._46O=function(c){var V,o,B=this,q=B.editing,a=B.target;if(q){if("connect"===q.mode&&!q.canceled&&!q.deleted)try{q.garbageInfo&&q.garbageInfo.hover?H.doDeleteConnectionAction(B._interactor.gv,a):H.doConnectAction(B._interactor.gv,a,q.target)}catch(X){console.error(X)}o=q.freezeFlag,V=B.editing.groupRotateMode,B._fireEditEvent("end",c),B.editing=null}B.tipInfo=null,B._inSmartGuide&&(B._interactor.rectGuide.clear(),B._inSmartGuide=!1),V&&a&&a.endRotate(),a instanceof n.Block&&(o===W?delete a._freezeSyncFromChildren:a._freezeSyncFromChildren=o,a.updateFromChildren())},yc.prototype.handleNormalStateDelete=function(){var o=this,K=o.editing;if(K&&"connect"===K.mode&&!K.canceled&&!K.deleted){if(K.garbageInfo){try{H.doDeleteConnectionAction(o._interactor.gv,o.target)}catch(m){console.error(m)}K.garbageInfo=null}return K.cursorPos=null,K.targetCorners=null,K.deleted=!0,o._interactor._42(),!0}},yc.prototype.handleNormalStateKeyDown=function(x){var l=this,D=l.editing;return!D||"connect"!==D.mode||D.canceled||D.deleted?void 0:n.Default.isEsc(x)?(D.cursorPos=null,D.targetCorners=null,D.canceled=!0,l._interactor._42(),!0):void 0},yc.prototype.handleEdit=function(k,U){var L=this,w=L.editing;if(w){var z,Y,o,r,q,X=L.target,G=w.key,f=w.mode,t=k.lp(U),F=L._interactor;if("connect"===f){if(w.canceled)return;if(w.deleted)return;w.cursorPos=F._getLogicalPoint(U);var j=w.garbageInfo;return j&&mq.checkHit(w.cursorPos,j,j.size)?(j.hover=!0,w.target=null,w.targetCorners=null):(j&&(j.hover=!1),w.target=k.getDataAt(t,function(G){return k.isSelectable(G)?af(G)?!0:!1:!1})||null,w.targetCorners=mq.getTargetCornersOnScreen(k,w.target)),F._42(),void 0}if("rotate"===f){var m,O,y=w.pos,l=Math.atan2(t.y-y.y,t.x-y.x);if(w.groupRotateMode?O=l-w.hitRot:(m=l-w.hitRot,O=w.rotation+m),O%=2*Math.PI,0>O&&(O+=2*Math.PI),!n.Default.isCtrlDown(U)){var E,u;nr(U)?(E=F.getStyle("shiftRotateRound"),u=E/2):(E=F.getStyle("rotateRound"),u=F.getStyle("rotateSensitivity")),O=mq.roundTo(O,E,u)}w.groupRotateMode?(m=O-(w.lastRotation||0),0!==m&&(X.addRotation(m,w.groupRotateMode,function(u){return k.isRotationEditable(u)}),w.lastRotation=O)):X.setRotation(O),F._setRotateCursor(l),O>Math.PI&&(O-=2*Math.PI);var e=180*(O/Math.PI);e=e.toFixed(2),z=""+e+""}else if("resize"===f){var S=w.rect;o=S.x,r=S.y;var M,Z=S.width,K=S.height,V=w.anchor,x=w.matrix,B=X.s&&X.s("keepAspectRatio")||F.getStyle("keepAspectRatio");nr(U)&&(B=!B);var _=L._unionPointMode1,C=L._unionPointMode2;if(L._inSmartGuide&&!n.Default.isCtrlDown(U)&&!B){var p;"L"===G||"R"===G?p="x":("T"===G||"B"===G)&&(p="y"),L._adsorbedToClosest(t,p),q=!0}M=x.tfi(t);var d;"LT"===G?(S=_(M,{x:o+Z,y:r+K},Z,K,B),d=9):"T"===G?(S=C({x:o,y:M.y},{x:o+Z,y:r+K},Z,K,B,"v"),d=1):"RT"===G?(S=_(M,{x:o,y:r+K},Z,K,B),d=33):"L"===G?(S=C({x:M.x,y:r},{x:o+Z,y:r+K},Z,K,B,"h"),d=8):"R"===G?(S=C({x:o,y:r},{x:M.x,y:r+K},Z,K,B,"h"),d=32):"LB"===G?(S=_(M,{x:o+Z,y:r},Z,K,B),d=12):"B"===G?(S=C({x:o,y:r},{x:o+Z,y:M.y},Z,K,B,"v"),d=4):"RB"===G&&(S=_(M,{x:o,y:r},Z,K,B),d=36);var J=x.tf(S.x+S.width*V.x,S.y+S.height*V.y);X instanceof n.Block&&(w.hasOwnProperty("freezeFlag")||(w.freezeFlag=X._freezeSyncFromChildren,X._freezeSyncFromChildren=!0)),X.setPosition(J),X.setSize(S.width,S.height),q&&(Y=X.getRect(),F.rectGuide.gatherLines({node:X,x:Y.x,y:Y.y,w:Y.width,h:Y.height},p,d)),z=""+Math.round(S.width)+" * "+Math.round(S.height)}else if("line"===f){if(nr(U)){var c=X.getPoints(),a="P1"===G?c.get(1):c.get(0),i={x:t.x-a.x,y:t.y-a.y},N=F.getStyle("shiftLineRotateRound"),Q=L._shiftDirList;if(!Q||L._shiftRotateRound!==N){L._shiftRotateRound=N,L._shiftDirList=Q=[];for(var b=0;b<Math.PI;b+=N)Q.push({x:R(b),y:s(b)})}for(var I,v=0,H=0,T=Q.length;T>H;H++){var A=Q[H],P=A.x*i.x+A.y*i.y;Math.abs(P)>Math.abs(v)&&(v=P,I=A)}t={x:a.x+I.x*v,y:a.y+I.y*v},F.rectGuide.clear()}else L._inSmartGuide&&!n.Default.isCtrlDown(U)&&(L._adsorbedToClosest(t),q=!0);var $=mq.getDataMatrix(X).applyInverse(t);X.setPoint("P1"===G?0:1,$,!0);var D=X.getPoints(),W=D.get(0),h=D.get(1);o=W.x-h.x,r=W.y-h.y,z=" "+Math.round(Math.sqrt(o*o+r*r))+" ",q&&(Y=X.getRect(),F.rectGuide.gatherLines({node:X,x:Y.x,y:Y.y,w:Y.width,h:Y.height}))}if(z){var g=n.Default.getLogicalPoint(U,F._canvas);g.x+=mq.Icons.TipShiftX,g.y+=mq.Icons.TipShiftY,L.tipInfo={helperPos:g,text:z,size:z.length}}L._fireEditEvent("between",U)}},yc.prototype._unionPointMode1=function(p,r,Z,K,y){if(y&&Z&&K){var N=p.x-r.x,S=p.y-r.y;Math.abs(N*K)<Math.abs(S*Z)?(S=Math.sign(S)*Math.abs(N*K/Z),p.y=r.y+S):(N=Math.sign(N)*Math.abs(S*Z/K),p.x=r.x+N)}return n.Default.unionPoint(p,r)},yc.prototype._unionPointMode2=function(p,L,I,C,j,D){var f=n.Default.unionPoint(p,L);if(j&&I&&C){var u;"v"===D?(u=f.x+f.width/2,f.width=I*f.height/C,f.x=u-f.width/2):(u=f.y+f.height/2,f.height=C*f.width/I,f.y=u-f.height/2)}return f},yc.prototype._adsorbedToClosest=function(C,K){var s=this,z=s._interactor,H=z.rectGuide.findClosest(C,K),i=z.gridGuide.findClosest(C,K),Z=1/0,G=1/0;H&&(isFinite(H.x)&&(Z=H.x),isFinite(H.y)&&(G=H.y)),i&&(isFinite(i.x)&&Math.abs(i.x)<Math.abs(Z)&&(Z=i.x),isFinite(i.y)&&Math.abs(i.y)<Math.abs(G)&&(G=i.y)),isFinite(Z)&&(C.x+=Z),isFinite(G)&&(C.y+=G)},yc.prototype._42=function(c,Y,U){var S=this;S.info={},S.screenInfo=null;var i=S._interactor;if(!i.editDetail&&S.gatherInfo(Y,U)){var f=S.editing,A=f?f.groupRotateMode:null,R=S.screenInfo;if("block"!==A||!f||!f.started){if(R.P1?mq.Icons.DrawIcon(i,c,mq.Icons.Line,R):mq.Icons.DrawIcon(i,c,mq.Icons.Rect,R),R.connect&&(mq.Icons.DrawIcon(i,c,mq.Icons.ConnectGuide,{rotation:R.rotation,connect:R.connect,cursorPos:f?f.cursorPos:null}),f)){if(f.targetCorners){for(var a={x:1/0,y:1/0},B={x:-1/0,y:-1/0},k=0,s=f.targetCorners.length;s>k;k+=2)a.x=Math.min(a.x,f.targetCorners[k]),B.x=Math.max(B.x,f.targetCorners[k]),a.y=Math.min(a.y,f.targetCorners[k+1]),B.y=Math.max(B.y,f.targetCorners[k+1]);mq.Icons.DrawIcon(i,c,mq.Icons.HoverDataRect,{min:a,max:B,color:i.getStyle("hoverGuideColor")||i.getStyle("baseColor")})}f.garbageInfo&&mq.Icons.DrawIcon(i,c,mq.Icons.ConnectGuideGarbage,f.garbageInfo)}i.getStyle("rotateTipVisible")&&S.tipInfo&&mq.Icons.DrawIcon(i,c,mq.Icons.TipHelper,S.tipInfo)}S.target instanceof mq.Group&&S.target._42(i,c,Y)}};var Hn=mq.Anchor=function(k){this.catalog="Anchor",this._interactor=k};Hn.prototype={},Hn.prototype.constructor=Hn,Hn.prototype.gatherInfo=function(E,P){var f=this;if(1===P.length){var Y=P[0];if(!Y.getAnchor)return;if(Y instanceof n.Shape&&Y._70I())return;if(fm(Y,E))return;return f.gatherSingleTarget(E,P[0])}return P.length>1?f.gatherMultiTargets(E,P):!1},Hn.prototype.gatherSingleTarget=function(s,A){var g=this;return g.info.POS=A.getPosition(),g.screenInfo.POS=mq.toScreenPosition(s,g.info.POS),g.target=A,!0},Hn.prototype.gatherMultiTargets=function(n,x){var A=this,S=mq.Group.findOrCreateGroup(x,this._interactor._uuid);return S?(A.screenInfo.POS=mq.toScreenPosition(n,S.getAnchor2()),A.target=S,!0):!1},Hn.prototype.isVisible=function(){var x=this,K=x._interactor;if(K.getStyle("anchorVisible")===!1)return!1;var N=x.target;if(N){if(this.editing)return!0;var L=N.getAnchor(),M=K.getStyle("anchorOutsideVisibleThreshold");if(L.x<-M||L.x>1+M||L.y<-M||L.y>1+M)return!0;var j=N.getSize(),_=N.getScale(),P=Math.min(Math.abs(j.width*_.x),Math.abs(j.height*_.y));if(P*K.gv._zoom<K.getStyle("anchorHideThreshold"))return!1}return!0},Hn.prototype.check=function(K,G,y){if(n.Default.isLeftButton(G)){var F=this,s=F._interactor;if(F.isVisible()&&s.getStyle("anchorMovable")!==!1){F.editing=null,F.tipInfo=null;var B=F.target;if(B&&K.isAnchorEditable(B)&&K.isEditable(B)){var J;if(F.screenInfo&&(J=F.screenInfo.POS)&&mq.checkHit(y,new mq.Math.Vector2(J),s.getStyle("checkSize"))){if(B instanceof mq.Group)return F.editing={},!0;var g=B.getWidth(),P=B.getHeight(),x=B.getAnchor();return F.editing={rect:{x:-g*x.x,y:-P*x.y,width:g,height:P},anchor:x,matrix:B.getMatrix()},!0}}}}},Hn.prototype.startEdit=function(U,Q){U.startDragging(Q),U.fi({kind:"beginEditAnchor",event:Q})},Hn.prototype._46O=function(q){var n=this;n.editing&&(n.editing=null,n._interactor.fi({kind:"endEditAnchor",event:q})),n.tipInfo=null},Hn.prototype.handleEdit=function(y,Y){var H=this,D=H.target;if(D){var Q=H.editing;if(Q){var i=y.lp(Y),J=H._interactor;if(D instanceof mq.Group)return D.setAnchor2(i),J._42(),void 0;var O=Q.matrix,h=O.tfi(i),I=Q.rect,A=(h.x-I.x)/I.width,K=(h.y-I.y)/I.height;if(!n.Default.isCtrlDown(Y)){var c=J.getStyle("anchorRound"),p=J.getStyle("anchorSensitivity");A=mq.roundTo(A,c,p),K=mq.roundTo(K,c,p)}D.setAnchor(A,K,!0);var W=n.Default.getLogicalPoint(Y,J._canvas);W.x+=mq.Icons.TipShiftX,W.y+=mq.Icons.TipShiftY;var o=""+A.toFixed(2)+", "+K.toFixed(2);H.tipInfo={helperPos:W,text:o,size:o.length},J.fi({kind:"betweenEditAnchor",event:Y})}}},Hn.prototype._42=function(i,U,w){var I=this;I.info={},I.screenInfo={};var Z=I._interactor;Z.editDetail||I.gatherInfo(U,w)&&I.isVisible()&&(mq.Icons.DrawIcon(Z,i,mq.Icons.Anchor,I.screenInfo),I.tipInfo&&mq.Icons.DrawIcon(Z,i,mq.Icons.TipHelper,I.tipInfo))};var Bb=mq.MoveDummy=function(G){this.catalog="MoveDummy",this._interactor=G};Bb.prototype={},Bb.prototype.constructor=Bb,Bb.prototype.gatherInfo=function(){var Y=this,O=this._interactor.getSubModule("Rect");if(O){var X=O.screenInfo;if(X){var P=Y._interactor,S=Y.getMovableTarget(O.target);if(S){var b=P.getStyle("moveDummyThreshold");if(b!==!1){var v=X.LT||X.P1,h=X.RT||X.P2,w=X.LB||v;if(v){var K=X.P1,z=Math.min(v.distanceTo(w),v.distanceTo(h));if(!(b!==!0&&z>b)){var B=P.getStyle("moveDummyPosition"),$=h.clone().sub(v),k=w.clone().sub(v),n=B[2],I=B[3];if(K){var F=P.getStyle("moveDummyLineExtraShift");F&&(n+=F[0],I+=F[1])}var J=v.clone().add($.clone().multiplyScalar(B[0])).add($.setLength(n)).add(k.clone().multiplyScalar(B[1])).add(k.setLength(I));return Y.screenInfo.pos=J,Y.screenInfo.size=P.getStyle("moveDummySensitivity"),!0}}}}}}},Bb.prototype.getMovableTarget=function(Y){var y=this._interactor.gv;if(af(Y)){if(y.isMovable(Y))return Y}else if(Y instanceof mq.Group)for(var Q=Y._entities,p=Q.length-1;p>=0;p--){var m=Q[p];if(af(m)&&y.isMovable(m))return m}return null},Bb.prototype.getMoveInteractor=function(){for(var I,s,Q,B=this._interactor.gv,l=B.getInteractors(),I=0,s=l.length;s>I;I++)if(Q=l.get(I),Q instanceof xr)return Q},Bb.prototype.startEdit=function(E,D){E.startDragging(D);var O=this.getMoveInteractor();if(O){var t=this.selectedTarget,U=E.gv;U._moving=1,O._data=t,U.handleMouseDown&&U.handleMouseDown(D,t)}},Bb.prototype._46O=function(S){var L=this,P=L.getMoveInteractor();P&&(P.handleWindowMouseUp(S),L.selectedTarget=null)},Bb.prototype.handleEdit=function(d,F){var b=this.getMoveInteractor();b&&b.handleWindowMouseMove(F)},Bb.prototype.check=function(P,l,q){if(this.selectedTarget=null,n.Default.isLeftButton(l)&&!P._scrolling&&!vr()){var f=this;if(f.screenInfo){var U=f.screenInfo.pos;if(U&&!(q.distanceTo(U)>f.screenInfo.size)){var e=f._interactor;return f.selectedTarget=f.getMovableTarget(e.getSubModule("Rect").target),e.setCursor("default"),!0}}}},Bb.prototype._42=function(e,b,d){var B=this;B.screenInfo={};var v=B._interactor;v.editDetail||B.gatherInfo(b,d)&&(!v.editing||B.selectedTarget)&&mq.Icons.DrawIcon(v,e,mq.Icons.MoveDummy,B.screenInfo)};var Tf=mq.RotateX=function(N){this.catalog="RotateX",this._interactor=N};Tf.prototype={},Tf.prototype.constructor=Tf,Tf.prototype.gatherInfo=function(u,I){var N=this;if(1===I.length){var M=I[0];return M instanceof n.Shape&&M._70I()||fm(M,u)?!1:N.gatherSingleTarget(u,M)}return I.length>1?N.gatherMultiTargets(u,I):!1},Tf.prototype.gatherSingleTarget=function(){var I=new n.Math.Vector2,M=new n.Math.Vector2,D=new n.Math.Vector2,X=new n.Math.Vector2,p=function(j,T){var y=j.x-T.x,N=j.y-T.y;return y*y+N*N};return function(t,T){if(T.getCorners){var P=this,K=T.getCorners(),L=15,h=T.getPosition();I.copy(K[0]),D.copy(K[1]),X.copy(K[3]),M.copy(I).add(X).divideScalar(2).add(I.sub(D).setLength(L/t.getZoom()));var V=Math.max(p(h,K[0]),p(h,K[1]),p(h,K[2]),p(h,K[3]));return P.info.POS=M.clone(),P.screenInfo.POS=mq.toScreenPosition(t,P.info.POS),P.screenInfo.LEN=Math.sqrt(V)*t.getZoom()+L,P.screenInfo.CENTER=mq.toScreenPosition(t,h),P.target=T,!0}}}(),Tf.prototype.gatherMultiTargets=function(a,m){var u=this,d=mq.Group.findOrCreateGroup(m,this._interactor._uuid);if(!d)return!1;var u=this;return u.gatherSingleTarget(a,d)},Tf.prototype.isVisible=function(){var c=this._interactor;if(!c.getStyle("rotateAsClock"))return!1;var y=this.target;if(!y)return!0;var S=c.gv;return S.isEditable(y)&&S.isRotationEditable(y)?!0:!1},Tf.prototype.check=function(w,y,i){var c=this,j=c._checkImpl(w,y,i);return(j||c._clockPainted)&&c._interactor._42(),j},Tf.prototype._checkImpl=function(c,d,B){if(n.Default.isLeftButton(d)){var x=this;x.editing=null,x.tipInfo=null;var g;if(x.screenInfo&&(g=x.screenInfo.POS)&&x.isVisible()){var H=x._interactor;if(mq.checkHit(B,g,H.getStyle("checkSize"))){var u=x.target,w=c.lp(d),S=u.getPosition(),C=Math.atan2(w.y-S.y,w.x-S.x);return H._setRotateCursor(C),x.editing={pos:S,rotation:u.getRotation(),hitRot:C,groupRotateMode:"block",screenInfo:{CENTER:x.screenInfo.CENTER,LEN:x.screenInfo.LEN}},!0}}}},Tf.prototype.startEdit=function(s,x){s.startDragging(x),s.fi({kind:"beginEditRotation",event:x}),this.target instanceof mq.Group&&this.target.beginRotate(this.editing)},Tf.prototype._46O=function(v){var V=this;V.editing&&(V.editing=null,V._interactor.fi({kind:"endEditRotation",event:v})),V.target instanceof mq.Group&&V.target.endRotate(),V.tipInfo=null},Tf.prototype.handleEdit=function(c,H){var $=this,i=$.editing;if(i){var j,R,T=$.target,e=c.lp(H),S=$._interactor,p=i.pos,v=Math.atan2(e.y-p.y,e.x-p.x),y=T instanceof mq.Group;if(y?R=v-i.hitRot:(j=v-i.hitRot,R=i.rotation+j),R%=2*Math.PI,0>R&&(R+=2*Math.PI),!n.Default.isCtrlDown(H)){var g,o;nr(H)?(g=S.getStyle("shiftRotateRound"),o=g/2):(g=S.getStyle("rotateRound"),o=S.getStyle("rotateSensitivity")),R=mq.roundTo(R,g,o)}y?(j=R-(i.lastRotation||0),0!==j&&(T.addRotation(j,i.groupRotateMode,function(x){return c.isRotationEditable(x)}),i.lastRotation=R)):T.setRotation(R),S._setRotateCursor(v),R>Math.PI&&(R-=2*Math.PI);var w=180*(R/Math.PI),A=""+w.toFixed(2)+"",O=n.Default.getLogicalPoint(H,S._canvas);O.x+=mq.Icons.TipShiftX,O.y+=mq.Icons.TipShiftY,$.tipInfo={helperPos:O,text:A,size:A.length},S.fi({kind:"betweenEditRotation",event:H})}},Tf.prototype._42=function(d,s,n){var D=this;D._clockPainted=!1,D.info={},D.screenInfo={};var O=D._interactor;O.editDetail||D.gatherInfo(s,n)&&D.isVisible()&&(mq.Icons.DrawIcon(O,d,mq.Icons.RoundPoint,D.screenInfo.POS),O.getStyle("rotateTipVisible")&&D.tipInfo&&mq.Icons.DrawIcon(O,d,mq.Icons.TipHelper,D.tipInfo),D.editing&&D.drawClock(d))},Tf.prototype.drawClock=function(E){E.save();var q=this;q._clockPainted=!0;var Y=q.editing||{},K=Y.screenInfo||q.screenInfo,M=K.LEN,w=M+8,S=M+18;E.save(),E.translate(K.CENTER.x,K.CENTER.y),E.beginPath(),E.strokeStyle="rgb(150, 150, 150)";for(var Z,f,k,V,c,j=0;360>j;j++)Z=j*Math.PI/180,0===j%5&&(f=s(Z)*M,k=R(Z)*M,V=s(Z)*w,c=R(Z)*w,E.moveTo(f,k),E.lineTo(V,c)),0===j%45&&(f=s(Z)*M,k=R(Z)*M,V=s(Z)*S,c=R(Z)*S,E.moveTo(f,k),E.lineTo(V,c));E.stroke(),E.rotate(-Rr);var L=Y.lastRotation||q.target.getRotation();E.beginPath(),E.fillStyle="rgba(255, 0, 0, 0.1)",E.strokeStyle="rgb(157, 157, 157)",E.moveTo(0,0),E.arc(0,0,S,0,L,!1),E.fill(),E.beginPath(),E.moveTo(0+S,0),E.arc(0,0,S,0,L,!1),E.stroke(),E.restore()};var Ck=mq.Curve=function(X){this.catalog="Curve",this._interactor=X};Ck.prototype={},Ck.prototype.constructor=Ck,o.defineProperties(Ck.prototype,{activing:{get:function(){return this._activing},set:function(X){var z=this;if(X)z._activing=new mq.CurveActiving(this,X),z.gatherSingleTarget(z._interactor.gv,z.target);else{var q=z._activing;q&&q.dispose(),z._activing=null}}}}),Ck.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},Ck.prototype.setUp=function(){var q=this,L=q._interactor;L&&L.gv.mp(q._onGraphviewPropertyChanged,q)},Ck.prototype._onGraphviewPropertyChanged=function(b){("zoom"===b.property||"translateX"===b.property||"translateY"===b.property)&&this._handleDataChanged()},Ck.prototype.tearDown=function(){var U=this,v=U._interactor;v&&v.gv.ump(U._onGraphviewPropertyChanged,U)
},Ck.prototype.canEnterEditDetailMode=function(){var k=yk(this._interactor);return k?this.target=k:void 0},Ck.prototype.canQuitEditDetailMode=function(G){var R=this,x=R._interactor._getLogicalPoint(G);return R._checkEditRealPoint(x)?void 0:R._interactor.gv.getDataAt(G)!==R.target?!0:void 0},Ck.prototype.preHandleScroll=function(){var T=this.editing;return T&&T.inEdit?!0:void 0},Ck.prototype.getCurrentSelectintStatus=function(){var M=this;if(M.activing&&!M.activing.selections){if(M.activing.status!=W)return M.activing.status;var g=function(C){var T=M.activing.status;M.activing.status=C,M._interactor.fp("shapePointStatus",T,C)},r=mq.Curve.PointType,z=M.activing.point,s=M.activing.pairs;if(!s||1!==s.length)return g(r.Mirrored);var q=s[0],K=q.c1&&q.c1.isNearEnough(z),G=q.c2&&q.c2.isNearEnough(z);if(!q.c1||!q.c2)return K||G?g(r.Straight):g(r.Disconnected);if(K&&G)return g(r.Straight);if(K||G)return g(r.Asymmetric);var b=q.c1.clone().sub(z),H=q.c2.clone().sub(z);return Math.abs(b.x*H.y-b.y*H.x)>1e-5||b.x*H.x>0?g(r.Disconnected):Math.abs(b.length()-H.length())>1e-5?g(r.Asymmetric):g(r.Mirrored)}},Ck.prototype.handle_keydown=function(J){var W=this;if(W._interactor.editDetail){var Q=mq.Curve.PointType;"1"===J.key?W._setCurrentSelectionStatus(Q.Straight):"2"===J.key?W._setCurrentSelectionStatus(Q.Mirrored):"3"===J.key?W._setCurrentSelectionStatus(Q.Disconnected):"4"===J.key&&W._setCurrentSelectionStatus(Q.Asymmetric)}},Ck.prototype.setCurrentSelectionStatus=function(a){var f=this,A=f._interactor;if(A){var Q=A.gv;Q.dm().beginTransaction(),this._setCurrentSelectionStatus(a),Q.dm().endTransaction()}},Ck.prototype._setCurrentSelectionStatus=function(V){var f=this,F=f.activing;if(F){var k=f.getCurrentSelectintStatus();if(null!==k&&k!==V){F.status=V;var M=f.activing.point,S=f.activing.pairs;if(S&&1===S.length){var j=S[0],w=f.screenInfo.curve,K=mq.Curve.PointType,X=f._interactor,Q=function(){f._writeToHt(),X.fp("shapePointStatus",k,V),f.check(X.gv,null,new mq.Math.Vector2(X._lastLogicalPoint))};if(V===K.Straight)return w.moveCtrlPoint(j,M,"c1"),w.moveCtrlPoint(j,M,"c2"),Q(),void 0;if(k===K.Straight){var J=w.findPairs(M,!0),C=J[0],y=C.r1||M,D=C.r2||M,s=D.clone().sub(y).multiplyScalar(.25);return w.moveCtrlPoint(j,M.clone().sub(s),"c1"),w.moveCtrlPoint(j,M.clone().add(s),"c2"),Q(),void 0}var L=j.c1,z=j.c2;if(L&&z){if(V===K.Mirrored)return w.moveCtrlPoint(j,M.clone().multiplyScalar(2).sub(z),"c1"),Q(),void 0;if(V===K.Asymmetric&&k===K.Disconnected){var Y=L.clone().sub(M).length(),s=M.clone().sub(z).setLength(Y).add(M);return w.moveCtrlPoint(j,s,"c1"),Q(),void 0}}F._firePointChange(),X.fp("shapePointStatus",k,V),f.check(X.gv,null,new mq.Math.Vector2(X._lastLogicalPoint))}}}},Ck.prototype._handleDataChanged=function(){var $="s:edge.points,s:edge.segments,points,segments,shape,position,rotation,scale".split(",");return function(m){var U=this;if(U.screenInfo&&U.target){if(m&&$.indexOf(m.property)<0)return;var L=U._interactor;U.gatherSingleTarget(L.gv,U.target,!0),U.check(L.gv,null,new mq.Math.Vector2(L._lastLogicalPoint)),L._42()}}}(),Ck.prototype.gatherSingleTarget=function(j,O,$){var Z,H,U=this;U.screenInfo&&U.screenInfo.curve&&(H=U.screenInfo.curve._curves);var T=U.editing;Z=T?U.screenInfo:U.screenInfo={};var X,C,I=O instanceof n.Edge;I?(X=O.s("edge.segments"),C=O.s("edge.points")||new n.List):(X=O._58O,C=O._59O),Z.S=X;var v,p=Z.P=[],m=mq.getDataMatrix(O);if(O instanceof n.Polyline||O instanceof n.Edge&&U._interactor.getStyle("edgeElevationEditable"))v=O.getElevation&&O.getElevation()||0,Z.E=[];else{var y=!1;C.each(function(t){t.e!==W&&(y=!0)}),y&&(Z.E=[])}if(C.each(function(D){Z.E&&Z.E.push(D.e!=W?D.e:v),D=m.apply(D);var h=mq.toScreenPosition(j,D);p.push(h.x,h.y)}),I){var D=p.length,q=mq.toScreenPosition(j,O._lastSourcePoint||(D?{x:p[0],y:p[1]}:{x:0,y:0})),Y=mq.toScreenPosition(j,O._lastTargetPoint||(D?{x:p[D-2],y:p[D-1]}:{x:0,y:0}));if(p.splice(0,0,q.x,q.y),p.push(Y.x,Y.y),Z.E){var t=O.getSourceAgent();t instanceof n.Edge?Z.E.splice(0,0,O.s("edge.source.offset.elevation")):Z.E.splice(0,0,((O.s("edge.source.anchor.elevation")||.5)-.5)*t.getTall()*t.getScaleTall()+t.getElevation()+O.s("edge.source.offset.elevation"));var N=O.getTargetAgent();N instanceof n.Edge?Z.E.push(O.s("edge.target.offset.elevation")):Z.E.push(((O.s("edge.target.anchor.elevation")||.5)-.5)*N.getTall()*N.getScaleTall()+N.getElevation()+O.s("edge.target.offset.elevation"))}}if(!Z.S||!Z.S.size()){Z.S=new n.List,Z.S.add(1);for(var Q=0;Q<p.length/2-1;Q++)Z.S.add(2)}if((!T||$)&&U.convertToCubicBezier(H),U.activing&&($||!U.editing||"realPoint"===U.editing.type)){var L=Z.curve.findPairs(U.activing.point);U.activing.pairs=L}},Ck.prototype._convertToNewPoint=function(n,l,X,F){var m,c,N;for(m=0,c=l.length;c>m;m++){if(N=l[m],N._p1.isNearEnough(n)&&(!F||F.indexOf(N._p1)<0))return N._p1;if(N._p4.isNearEnough(n)&&(!F||F.indexOf(N._p4)<0))return N._p4}if(X)for(m=0,c=Math.min(X.length,c);c>m;m++){if(N=X[m],N._p1===n&&(!F||F.indexOf(l[m]._p1)<0))return l[m]._p1;if(N._p4===n&&(!F||F.indexOf(l[m]._p4)<0))return l[m]._p4}},Ck.prototype.convertToCubicBezier=function(t){var H,h,Y=this,B=new mq.Math.Curve,j=Y.screenInfo;if(B.createFromHtShape(j.P,j.S,j.E),j.curve=B,Y.activing){var n=B._curves;H=Y.activing.point,h=Y._convertToNewPoint(H,n,t);var i=[];if(h&&(Y.activing.point=h,i.push(h)),Y.activing.selections){var Q=-1,p=Y.activing.selections;p.forEach(function(w){Q++,h=Y._convertToNewPoint(w,n,t,i),h&&(p[Q]=h,i.push(h))})}}},Ck.prototype.check=function(N,s,$){if(!s||yp(s)||sc(s)){var o=this;if(o._interactor.setCursor("default"),o.editing=null,o.highlight=null,o.tipInfo=null,o.edgeEditResult=null,o.screenInfo){if(vr()||s&&sc(s))return o._interactor._42(),!0;if(o._checkEditCtrlPoint($))return o._interactor._42(),!0;if(o._checkEditRealPoint($))return o._interactor._42(),!0;if(o._checkEditElevation($))return o._interactor._42(),!0;var m=o.screenInfo.curve,r=m.checkPoint($,o._interactor.getStyle("curveIntersectSize"));if(r){var P=o.highlight={};P.type="insertKnot",P.bezier=r.bezier,P.point=r.intersection}return o._interactor._42(),!0}}},Ck.prototype.getAdjacentBeziers=function(P){var K=this.screenInfo;if(K){var U,E,$,f=K.curve._curves,p=[],x=W;for(U=0,E=f.length;E>U;U++)if($=f[U],x===W){if($._p4.isNearEnough(P)){p.push($),x=U;continue}}else{if($._p1.isNearEnough(P))return p.push($),p;if($._p4.isNearEnough(P)){p[0]=$,x=U;continue}}}},Ck.prototype.roundCorner=function(j){if(this.activing&&this.screenInfo){var G=this.screenInfo.curve,W=G._curves,H=this.getAdjacentBeziers(this.activing.point),g=H[1],F=g._index;g=g.insertKnot(g.getTByPercentage(j/g.length))[1],W[F]=g;var S=g.p1,L=H[0],m=L._index;L=L.insertKnot(L.getTByPercentage(1-j/L.length))[0],W[m]=L;var q=L.p4,K=this.activing.point,Z=new mq.Math.CubicBezier(q,K.clone().sub(q).multiplyScalar(2/3).add(q),K.clone().sub(S).multiplyScalar(2/3).add(S),S);W.splice(F,0,Z),this._writeToHt(),this.activing=null,this._interactor._42()}},Ck.prototype._checkEditRealPoint=function(Y){var B,s,A,K,L,z,X=this,n=X.screenInfo.curve._curves,C=X._interactor.getStyle("curvePointIntersectSize"),T=1/0;for(C*=C,A=0,K=n.length;K>A;A++)B=n[A],L=B._p1,z=Y.distanceToSquared(L),T>z&&(T=z,s=L),L=B._p4,z=Y.distanceToSquared(L),T>z&&(T=z,s=L);if(T>C)return!1;var E=X.highlight={};return E.type="changeRealPoint",E.point=s,X.editing={type:"realPoint",point:s,shiftGuide:{point:s.clone(),dir:"x",limit:0}},X._interactor.setCursor("crosshair"),!0},Ck.prototype._checkEditElevation=function(h){var G=this;if(!G._interactor.getStyle("curveElevationVisible"))return!1;var A=G.target;if(A instanceof n.Edge&&!G._interactor.getStyle("edgeElevationEditable"))return!1;var I=G.activing;if(!I)return!1;var Z=I.getCurrentEditingPoint();if(!Z)return!1;var q=G._interactor,C=q.getStyle("curveElevationGuideShift"),c=q.getStyle("curveElevationIntersectSize"),b=h.distanceToSquared({x:Z.x+C[0],y:Z.y+C[1]});if(!(b>c*c)){var F=G.highlight={};F.type="elevation";var i=new mq.Math.Vector2(h.x,h.y,Z.e);return G.editing={type:"elevation",startPoint:i},G._interactor.setCursor("crosshair"),!0}},Ck.prototype._checkEditCtrlPoint=function(F){var a=this;if(a.activing&&!a.activing.selections){var N=a.getCurrentSelectintStatus();if(N!==mq.Curve.PointType.Straight){var m=a.activing.pairs;if(m){var c=a._interactor.getStyle("curvePointIntersectSize");c*=c;var D,V,p,z,Q,C,y,U,s,A=1/0;for(y=0,s=m.length;s>y;y++)for(z=m[y],U=0;2>U;U++)Q=0===U?"c1":"c2",z[Q]&&(C=F.distanceToSquared(z[Q]),A>C&&(A=C,D=z,V=y,p=Q));if(A>c)return!1;a.activing.hlpair=D,a.activing.hltype=p;var l=a.highlight={};return l.type="changeCtrlPoint",l.point=D[p],a.editing={type:"ctrlPoint",pair:D,pairId:V,ctrlType:p,direction:D[p].clone().sub(a.activing.point).normalize()},a._interactor.setCursor("crosshair"),!0}}}},Ck.prototype.startEdit=function(r,I){r.startDragging(I);var q=this;q.highlight&&"insertKnot"===q.highlight.type&&(q.insertKnot(),q.gatherSingleTarget(q._interactor.gv,q.target),q.activing=null,q._checkEditRealPoint(q._interactor._getLogicalPoint(I)));var B=q._activing;if(B){var k=q.editing?q.editing.type:null;"ctrlPoint"===k?B.editingCtrl={pairId:q.editing.pairId,type:B.hltype}:"realPoint"===k&&(B.editingCtrl=!1)}var w=q.highlight,A=n.Default.isCtrlDown(I);if(!w||vr()||sc(I)){var v=q._interactor.gv;if(!v.setFocus(I)||v._scrolling)return;return A?q._multiSelect={startPoint:v.lp(I)}:v.isPannable()&&(yp(I)||sc(I))&&(q._pan={tx:v.tx(),ty:v.ty()},r.fi({kind:"beginPan",event:I})),void 0}if("changeRealPoint"===w.type){var e,V=q.activing?q.activing.point:null,y=q.activing?q.activing.selections:null;if(A&&q.activing)V===w.point?(y?(q.activing={point:y[0]},y.length>1&&(y.splice(0,1),q.activing.selections=y)):q.activing=null,q.editing=null):y&&(e=y.indexOf(w.point))>=0?(y.length>1?y.splice(e,1):delete q.activing.selections,q.editing=null):y?(y.push(V),q.activing={point:w.point,selections:y}):q.activing={point:w.point,selections:[V]};else if(y)V===w.point||((e=y.indexOf(w.point))>=0?(y.splice(e,1,V),q.activing={point:w.point,selections:y}):q.activing={point:w.point});else{var x;V===w.point&&(x=q.activing.status),q.activing={point:w.point},x&&(q.activing.status=x)}r.fi({kind:"beginEditPoint",event:I})}},Ck.prototype.insertKnot=function(){var i=this,Q=i.highlight,O=i.screenInfo.curve;O.insertKnot(Q.bezier,Q.point.t),i._writeToHt()},Ck.prototype._writeToHt=function(){var R,i,t=this,b=t.screenInfo.curve,C=b.toHtShape(),q=C.points,A=[],O=C.segments,v=t._interactor.gv;v.dm().beginTransaction();var X,_,L=t.target,z=L instanceof n.Edge,S=mq.getDataMatrix(L).invert();_=L instanceof n.Polyline||z&&t._interactor.getStyle("edgeElevationEditable"),_&&(X=L.getElevation&&L.getElevation()||0);for(var c=0,x=q.length;x>c;c++)R=q[c],i=mq.toWorldPosition(v,R),i=S.apply(i),isFinite(R.e)&&R.e!==X&&(i.e=R.e),A.push(i);if(L._writing=!0,z){L.s("edge.type","points"),L.setStyle("edge.segments",O),L.setStyle("edge.points",A.slice(1,A.length-1)),L.setStyle("edge.source.offset.x",0),L.setStyle("edge.source.offset.y",0),L.setStyle("edge.target.offset.x",0),L.setStyle("edge.target.offset.y",0);var G=t._nextChangeEdgeHost;delete t._nextChangeEdgeHost,G&&("source"===G.type?L.setSource(G.host):L.setTarget(G.host)),t._writeEdgeHostAnchor("source",A[0]),t._writeEdgeHostAnchor("target",A[A.length-1])}else A.length?(L.setSegments(O),L.setPoints(A,!0)):L.removeFromDataModel();v.dm().endTransaction(),delete L._writing},Ck.prototype._writeEdgeHostAnchor=function(V,s){var N=this,i=N.target,U=N._calcHostAnchor(i,V,s);U.index!==W?(i.setStyle("edge."+V+".index",U.index),i.setStyle("edge."+V+".percent",W),i.setStyle("edge."+V+".anchor.x",W),i.setStyle("edge."+V+".anchor.y",W),i.setStyle("edge."+V+".anchor.elevation",W),i.setStyle("edge."+V+".offset.elevation",s.e)):U.percent!==W?(i.setStyle("edge."+V+".percent",U.percent),i.setStyle("edge."+V+".index",W),i.setStyle("edge."+V+".anchor.x",W),i.setStyle("edge."+V+".anchor.y",W),i.setStyle("edge."+V+".anchor.elevation",W),i.setStyle("edge."+V+".offset.elevation",s.e)):(i.s("edge."+V+".anchor.x",U.x),i.s("edge."+V+".anchor.y",U.y),i.s("edge."+V+".anchor.elevation",U.e),U.offsetX||U.offsetY||U.offsetElevation?(i.s("edge."+V+".offset.x",U.offsetX),i.s("edge."+V+".offset.y",U.offsetY),i.s("edge."+V+".offset.elevation",U.offsetElevation)):(i.s("edge."+V+".offset.x",0),i.s("edge."+V+".offset.y",0),i.s("edge."+V+".offset.elevation",0)))},Ck.prototype._calcHostAnchor=function(T,l,D,U){U||(U="source"===l?T.getSource():T.getTarget());var E=this._interactor.gv,u=E.calculateAttachPoint(U,D);if(u)return u.info;if(zl(U)){var P=E.calculateEdgePosition(U,D);return P}var n=U.getRotation(),S=U.getAnchor();fm(U,E)&&(n=0);var V=U.getElevation(),k=U.getTall()*U.getScaleTall();V=((D.e||0)-T.s("edge."+l+".offset.elevation")-V)/k+.5;var j=U.getScale();if(n||j.x<0||j.y<0){var o=U.getMatrix(),Z=o.tfi(D),m=U.getSize();return{x:Z.x/m.width+S.x,y:Z.y/m.height+S.y,e:V}}var O=$q(E,U),q={x:(D.x-O.x)/O.width,y:(D.y-O.y)/O.height,e:V};return q},Ck.prototype._handlePanning=function(Z){var q=this,$=q._pan;if($){$.started=!0;var A=q._interactor,V=A.gv,c=A._lastClientPoint,w=Rh(Z),s=Lf(V,w,c);V.setTranslate($.tx+s.x,$.ty+s.y),q.gatherSingleTarget(A.gv,q.target),A._42(),A.fi({kind:"betweenPan",event:Z})}},Ck.prototype.handleEdit=function(d,f){var j=this,Y=j.editing;if(j._pan)return j._handlePanning(f),void 0;if(j._multiSelect)return j._multiSelect.endPoint=d.lp(f),j._interactor.redraw(),void 0;if(Y){Y.inEdit=!0;var S,D,Q,F=j._interactor._getLogicalPoint(f),r=n.Default.isCtrlDown(f),C=n.Default.isShiftDown(f),L=Y.type,o=j.activing;if(j._guideInfo=null,"ctrlPoint"===L&&C){var G=j.editing.direction.clone();S=o.point;var s=G.dot(F.clone().sub(S));F=G.setLength(s).add(S)}else if("ctrlPoint"===L||"realPoint"===L){var G;if("realPoint"===L&&C){var J=j.editing.shiftGuide;D=J.point;var p=Math.abs(F.x-D.x),x=Math.abs(F.y-D.y);p>x&&p>J.limit&&"y"===J.dir&&(J.dir="x"),x>p&&x>J.limit&&"x"===J.dir&&(J.dir="y"),G=J.dir,"x"===G?(F.y=D.y,J.limit=Math.max(J.limit,p)):"y"===G&&(F.x=D.x,J.limit=Math.max(J.limit,x))}if(!r){var M,b=j._isEditEdgeSourceTarget();b&&(M=F.clone());var I=j._guidingToEdit(F,G),l="realPoint"===L?j._interactor.gridGuide.findClosest(F,G,!0):null,E=1/0,O=1/0;l&&(l.x&&(E=l.x),l.y&&(O=l.y));var A=!1;if(I&&(I.xList&&(Math.abs(I.x)<=Math.abs(E)?(A=!0,E=I.x):delete I.xList),I.yList&&(Math.abs(I.y)<=Math.abs(O)?(A=!0,O=I.y):delete I.yList),A&&(j._guideInfo=I)),isFinite(E)&&(F.x+=E),isFinite(O)&&(F.y+=O),A&&(I.v=F),b){var v=A?F.clone():null;F.copy(M);var m=j._editEdgeSourceTarget(b,F,r,v);m&&(j.edgeEditResult=m,Q=m.tipText,m.isFixed&&(j._guideInfo=null))}}}var u=j.screenInfo.curve;if("realPoint"===Y.type){S=Y.point,S.e!==W&&(F.e=S.e),u.moveRealPoint(S,F),Y.point=F,j.highlight.point=F;var t=o.status,q=o.selections;if(j.activing={point:F,status:t},q){var T=F.clone().sub(S),$=0;q.forEach(function(d){var E=d.clone().add(T);u.moveRealPoint(d,E),q[$++]=E}),j.activing.selections=q}}else if("ctrlPoint"===Y.type){var k=o.pairs,z=k[Y.pairId];u.moveCtrlPoint(z,F,Y.ctrlType);var a=o.status,i=mq.Curve.PointType;if((a===i.Mirrored||a===i.Asymmetric)&&z.c1&&z.c2){var S=new mq.Math.Vector2(o.point),X="c1"===Y.ctrlType?"c2":"c1";if(a===mq.Curve.PointType.Mirrored)u.moveCtrlPoint(z,S.clone().multiplyScalar(2).sub(F),X);else if(a===i.Asymmetric){var s=z[X].clone().sub(S).length(),w=S.clone().sub(z[Y.ctrlType]).setLength(s).add(S);isNaN(w.x)||u.moveCtrlPoint(z,w,X)}}o._firePointChange()}else if("elevation"===Y.type){D=Y.startPoint;var R=D.e+(D.y-F.y)/d._zoom;j._setCurrentPointImpl("e",R),o._firePointChange(),Q="E: "+mq.toFixed(R)}var g=n.Default.getLogicalPoint(f,j._interactor._canvas);if(g.x+=mq.Icons.TipShiftX,g.y+=mq.Icons.TipShiftY,!Q){var h=mq.toWorldPosition(d,F);Q=""+mq.toFixed(h.x)+", "+mq.toFixed(h.y)}j.tipInfo={helperPos:g,text:Q,size:Q.length},j._writeToHt(),j._interactor.fi({kind:"betweenEditPoint",event:f})}},Ck.prototype._setCurrentPointImpl=function(b,N){var I=this,X=I._activing;if(!X)return!1;var s=I.target;if(!s)return!1;var D=X.getCurrentEditingPoint();if(!D)return!1;var G=X.editingCtrl;if(!G)var w=D.clone();if("e"===b)D.e=N;else{var o;if("x"===b||"y"===b){var e=X._lastFirePoint;o="x"===b?{x:N,y:e?e.y:0}:{x:e?e.x:0,y:N}}else"object"==typeof b?(o=b,b.e!==W&&(D.e=b.e)):(o={x:arguments[0],y:arguments[1]},arguments[2]!==W&&(D.e=arguments[2]));var x=mq.getDataMatrix(s);o=mq.toScreenPosition(I._interactor.gv,x.apply(o)),D.x=o.x,D.y=o.y}if(!G){var B=w.multiplyScalar(-1).add(D);ff(D.e)&&ff(w.e)&&(B.e=D.e-w.e);var q=I.screenInfo.curve;q.moveCtrlDueToRealPointMovement(D,B);var H=X.selections;if(H){var p=0;H.forEach(function(N){var $=N.clone().add(B);isFinite(B.e)&&($.e=(isFinite(N.e)?N.e:s.getElevation()||0)+B.e),q.moveRealPoint(N,$),H[p++]=$}),X.selections=H}}return!0},Ck.prototype.setCurrentPoint=function(v,w){return this._setCurrentPointImpl(v,w)?(this._writeToHt(),!0):!1},Ck.prototype._isEditEdgeSourceTarget=function(){var M=this,i=M.target;if(!(i instanceof n.Edge))return!1;var O=M.editing.point,L=M.screenInfo.curve._curves;return O===L[0]._p1?"source":O===L[L.length-1]._p4?"target":!1},Ck.prototype._editEdgeSourceTarget=function(o,Z,N,t){var L,m=this,c=m.target;if(L="source"===o?c.getSource():c.getTarget()){var r,f=m._interactor.gv,B=mq.toWorldPosition(f,Z),n=m._calcHostAnchor(c,o,B,L);if(r=n.index!==W||n.percent!==W?n.distance*f.getZoom()>m._interactor.getStyle("edgeHostEdgeMaxDistance"):m._interactor.getStyle("edgeHostDetectPerFrame")?!0:n.x<0||n.x>1||n.y<0||n.y>1?!0:!1){var p=f.getDataAt(B,function(x){return f.isSelectable(x)?f.isSourceTargetEditable(c,x,o)?c.canSetSourceTarget(x,o)?!0:!1:!1:!1});if(p){var h=m._calcHostAnchor(c,o,B,p);L=p,m._nextChangeEdgeHost={type:o,host:p},n=h}}var V,w,z,q=!1;if(N||n.x===W)(n.percent!==W||n.index!==W)&&(q=!0,w=n.point);else{var P=m._interactor.getStyle("anchorRound"),b=m._interactor.getStyle("anchorSensitivity");V=f.calculateAttachPoint(L,B),V?(n=V.info,q=!0):(t&&(n=m._calcHostAnchor(c,o,mq.toWorldPosition(f,t),L)),n.x=mq.roundTo(n.x,P,b),n.y=mq.roundTo(n.y,P,b)),w=qp(f,L,0,n.offsetX||0,n.offsetY||0,n.x,n.y)}w&&(z=mq.toScreenPosition(f,w),Z.x=z.x,Z.y=z.y),m._edgeHostGuideInfo={corners:mq.getTargetCornersOnScreen(f,L),attach:V?V.index:-1,host:L};var d;return n.percent!==W?d="percent: "+n.percent.toFixed(2):n.index!==W?d="index: "+n.index:(d=""+n.x.toFixed(2)+", "+n.y.toFixed(2),(n.offsetX||n.offsetY)&&(d+=" offset: "+n.offsetX.toFixed(2)+", "+n.offsetY.toFixed(2))),{host:L,anchor:n,tipText:d,isFixed:q}}},Ck.prototype._guidingToEdit=function(L,_){var D,j,O=this;if(D=O.screenInfo.curve){j=D._curves;var Y,$,a,m,f,N,p,y,B=1/0,J=1/0,S=[];for(O.editing&&"realPoint"===O.editing.type&&(y=O.editing.point),f=0,N=2*j.length;N>f;f++)p=j[Math.floor(f/2)][f%2?"_p4":"_p1"],S.indexOf(p)>=0||(S.push(p),y&&y===p||(a=p.x-L.x,m=p.y-L.y,Math.abs(a)<Math.abs(B)?(B=a,Y=[p]):a===B&&Y.push(p),Math.abs(m)<Math.abs(J)?(J=m,$=[p]):m===J&&$.push(p)));var i=O._interactor.getStyle("smartGuideThreshold");if((Math.abs(B)>i||"y"===_)&&(Y=null),(Math.abs(J)>i||"x"===_)&&($=null),Y||$){var c=!1,Q={};if(Y&&(c=!0,Q.xList=Y,Q.x=B),$&&(c=!0,Q.yList=$,Q.y=J),c)return Q}}},Ck.prototype._46O=function(i){var N=this;N.editing&&(N.editing=null,N._interactor.fi({kind:"endEditPoint",event:i})),N._guideInfo=null,N._edgeHostGuideInfo=null,N._pan&&(N._pan=null,N._interactor.fi({kind:"endPan",event:i})),N._multiSelect&&(N._handleMultiSelect(N._multiSelect,i),N._multiSelect=null),N.tipInfo=null,N.edgeEditResult=null},Ck.prototype._handleMultiSelect=function(u,P){if(u.startPoint&&u.endPoint){var A,e,l,X,H,v,F=this,k=F._interactor,G=k.gv,m=mq.toScreenPosition(G,u.startPoint),i=mq.toScreenPosition(G,u.endPoint),a=n.Default.unionPoint(m,i),L=F.screenInfo.curve._curves,d=[],O=function(x){x.x>=a.x&&x.y>=a.y&&x.x<=a.x+a.width&&x.y<=a.y+a.height&&d.indexOf(x)<0&&d.push(x)};for(A=0,e=L.length;e>A;A++)H=L[A],O(H._p1),O(H._p4);if(d.length){var r=F.activing||{},w=r.selections||[];r.point&&w.push(r.point);var t=n.Default.isShiftDown(P),f=P.altKey;if(f&&!t)for(v=d,d=[],A=0,e=v.length;e>A;A++)l=v[A],X=w.indexOf(l),X>=0&&d.push(l);for(A=0,e=w.length;e>A;A++)l=w[A],X=d.indexOf(l),X>=0?(!t||t&&f)&&(d[X]=W):d.push(l);for(v=d,d=[],A=0,e=v.length;e>A;A++)v[A]&&d.push(v[A]);e=d.length,0===e?F.activing=null:1===e?F.activing={point:d[0]}:(l=d[e-1],F.activing={point:l,selections:d.splice(0,e-1)}),k.redraw()}}},Ck.prototype._canDeletePoint=function(v,O){var J=this.target;if(!(J instanceof n.Edge))return!0;var M=v._curves[0],r=v._curves[v._curves.length-1];return M._p1===O||r._p4===O?!1:!0},Ck.prototype.handleDelete=function(){var L=this;if(L.activing&&L.screenInfo){var K=n.Default.isShiftDown(),E=L.screenInfo.curve;L._canDeletePoint(E,L.activing.point)&&E.deleteRealPoint(L.activing.point,K),L.activing.selections&&L.activing.selections.forEach(function(m){L._canDeletePoint(E,m)&&E.deleteRealPoint(m,K)}),L.activing=null,delete L.editing,delete L.tipInfo,delete L.edgeEditResult,delete L._pan,delete L._multiSelect,L._writeToHt(),L._interactor.fp("deleteShapePoint",!1,!0)}},Ck.prototype.handleDoubleClick=function(l){var k=this,N=k._interactor._getLogicalPoint(l);if(k.screenInfo&&k._checkEditRealPoint(N)){var R=k.getCurrentSelectintStatus(),K=mq.Curve.PointType;return R=R===K.Mirrored?K.Straight:K.Mirrored,k._setCurrentSelectionStatus(R),k._interactor._42(),!0}},Ck.prototype._drawHighlight=function(Z){var D=this,i=D.highlight;if(i){var r=i.bezier,C=D._interactor;r&&mq.Icons.DrawIcon(C,Z,mq.Icons.ShapeHighlightCurve,[r._p1.x,r._p1.y,r._p2.x,r._p2.y,r._p3.x,r._p3.y,r._p4.x,r._p4.y]);var q=i.point;q&&"insertKnot"===i.type&&mq.Icons.DrawIcon(C,Z,mq.Icons.ShapeHighlighPoint,q)}},Ck.prototype._drawGuide=function(S){var R=this,s=R._guideInfo;if(s){var L,M,V,x,F=s.v;for(L=0;2>L;L++)if(x=0===L?s.xList:s.yList)for(M=0,V=x.length;V>M;M++)mq.Icons.DrawIcon(R._interactor,S,mq.Icons.ShapeGuideLine,[F.x,F.y,x[M].x,x[M].y])}},Ck.prototype._drawCurrentPoint=function(K){var b=this;if(b.activing){var D=b.activing,E=b.getCurrentSelectintStatus(),N=b._interactor;if(E!==mq.Curve.PointType.Straight){var U=D.pairs;D.hlpair,D.hltype;var n=D.selections,e=D.editingCtrl;if(U&&!n){var z,r,A;for(r=0,A=U.length;A>r;r++)z=U[r],e&&r===e.pairId&&z[e.type]?mq.Icons.DrawIcon(N,K,mq.Icons.ShapeActivingCtrl,{point:z.point,c1:z.c1,c2:z.c2,hl:e.type}):mq.Icons.DrawIcon(N,K,mq.Icons.ShapeActivingCtrl,z)}}mq.Icons.DrawIcon(N,K,mq.Icons.ShapeHighlighRealPoint,b.activing.point),n&&n.forEach(function(y){mq.Icons.DrawIcon(N,K,mq.Icons.ShapeHighlighRealPoint,y)})}},Ck.prototype.clear=function(){var Y=this;Y.editing=null,Y._guideInfo=null,Y.activing=null,Y.highlight=null},Ck.prototype._42=function(L){var g=this;g.info={},g.editing||(g.screenInfo=null);var J=g._interactor;if(!J.editDetail)return g.clear(),void 0;var y=J.gv;if(!g.target||!y.isSelected(g.target)||!y.isVisible(g.target))return J.editDetail=!1,g.clear(),void 0;if(g.gatherSingleTarget(y,g.target),mq.Icons.DrawIcon(J,L,mq.Icons.ShapeBgCurve,g.screenInfo),g._interactor.getStyle("curveElevationVisible")&&(g.target instanceof n.Polyline||g.target instanceof n.Edge&&g._interactor.getStyle("edgeElevationEditable"))&&g.activing){var h=g.activing.getCurrentEditingPoint();h&&"string"!=typeof h.e&&mq.Icons.DrawIcon(J,L,mq.Icons.EdgeElevationGuide,h)}if(g._drawHighlight(L),g._drawCurrentPoint(L),g._getRealPoint().forEach(function(E){mq.Icons.DrawIcon(J,L,mq.Icons.ShapePoint,E)}),g._drawGuide(L),g.tipInfo&&g._interactor.getStyle("curveTipVisible")&&mq.Icons.DrawIcon(J,L,mq.Icons.TipHelper,g.tipInfo),g._edgeHostGuideInfo&&J._drawHostGuide(g._edgeHostGuideInfo),g.edgeEditResult&&g._drawEdgeHostHighlight(L,g.edgeEditResult.host,g.edgeEditResult.anchor),g._multiSelect&&g._multiSelect.endPoint){var I=n.Default.unionPoint(mq.toScreenPosition(y,g._multiSelect.startPoint),mq.toScreenPosition(y,g._multiSelect.endPoint));I.color=y.getRectSelectBorderColor(),L.save(),L.setTransform(1,0,0,1,0,0);var j=H.devicePixelRatio,Y=I.borderWidth=Math.round(j);Y/=2,I.x=Math.round(I.x*j)+Y,I.y=Math.round(I.y*j)+Y,I.width=Math.round(I.width*j),I.height=Math.round(I.height*j),mq.Icons.DrawIcon(J,L,mq.Icons.SimpleRect,I),L.restore()}},Ck.prototype._drawEdgeHostHighlight=function(R,B,W){this.drawEdgeHostHighlight(R,B,W),this._interactor.redraw()},Ck.prototype.drawEdgeHostHighlight=function(R,q,P){if(zl(q)){var H,t,v,z,K=this,g=K._interactor,S=g.gv,E=S.getDataUI(q),Z=fp(E),d=[];for(v=0,z=Z.points.length;z>v;v++)t=mq.toScreenPosition(S,Z.points.get(v)),d.push(t.x,t.y);Z.segments&&(H=Z.segments.toArray());var y=g.getStyle("edgeHostHighlighPeriod"),o=g.getStyle("edgeHostEdgeHighlighColor");mq.Icons.DrawIcon(g,R,mq.Icons.ShapeBgCurve,{P:d,S:H,color:o,dynamicVisible:P.index===W,dynamicPeriod:y}),o=g.getStyle("edgeHostPointHighlighColor");var $=pk(E);for(v=0,z=$.length;z>v;v++){var X=$[v],l=mq.toScreenPosition(S,X);mq.Icons.DrawIcon(g,R,mq.Icons.ShapePoint,{point:{x:l.x,y:l.y},color:o,size:12,dynamicVisible:v===P.index,dynamicPeriod:y})}}},Ck.prototype._getRealPoint=function(){var M,i=this.screenInfo,q=i.P,u=i.S,h=-1,k=[],F=-1,R=u.length;return u.each(function(s){F++;var v=1;if(3===s)v=2;else if(4===s)v=3;else if(5===s)return;h+=v,M=F+1>=R?!0:1===u.get(F+1)?!0:!1,k.push({point:{x:q[2*h],y:q[2*h+1]},segmentIndex:F,pointIndex:h,isEnd:M})}),k},Ck.prototype.getEditingPointsInfo=function(K){var S=this,h=S.activing;if(!h)return!1;var Y=h.point;if(!Y)return!1;var Z=this._getRealPoint(),z=[{screen:Y}];h.selections&&h.selections.forEach(function(E){z.push({screen:E})});var T,P,H=Z.length;return z.forEach(function(N){for(T=0;H>T;T++)if(P=Z[T],N.screen.isNearEnough(P.point)){N.segmentIndex=P.segmentIndex,N.pointIndex=P.pointIndex,N.point=S.target.getPoints().get(P.pointIndex);break}}),K&&z.sort(function(S,V){return S.segmentIndex-V.segmentIndex}),z};var id=mq.MoveHelper=function(G){var v=this;v.catalog="Move",v._interactor=G};id.prototype={},id.prototype.constructor=id,id.prototype.calcShift=function(q,s,V){var z,x,W=this,L=W._interactor.gv,P=L.lp(s);if("beginMove"===q&&W._gatherGridInfo(V._lastLogicalPoint||P),z=W._target){var M=z.downPosition;if(M){var a=W._interactor.getStyle("moveSensitivity")/L._zoom;if(M.distanceTo(P)<a)return{x:0,y:0};delete z.downPosition}var b;x=n.Default.isShiftDown(s),x&&(P=W._dealShiftDown(P),b=z.shiftGuide.dir);var p,T=z.rawPos={x:z.pos.x+P.x-z.lp.x,y:z.pos.y+P.y-z.lp.y};if(n.Default.isCtrlDown(s)){if(p=W._calcShiftByAddon(),W._target.node instanceof mq.Group){var E=W._target.node;E._position.x+=p.x,E._position.y+=p.y}return p}var Q=W._interactor.rectGuide;if(z.node instanceof n.Data&&z.node.s("2d.attachable")){var d=W._calcAttachNodeShift(z.node,T);if(Q.clear(),d)return d}for(var _,N=z.x+T.x,u=z.y+T.y,h={x:N,y:u},y={x:N+z.w/2,y:u+z.h/2},D={x:N+z.w,y:u+z.h},k=W._interactor.gridGuide,e=[Q.findClosest(h,b),Q.findClosest(y,b),Q.findClosest(D,b),k.findClosest(h,b),k.findClosest(y,b),k.findClosest(D,b)],S=1/0,K=1/0,$=0,C=e.length;C>$;$++)_=e[$],_&&(N=_.x,u=_.y,isFinite(N)&&Math.abs(N)<Math.abs(S)&&(S=N),isFinite(u)&&Math.abs(u)<Math.abs(K)&&(K=u));if(isFinite(S)||(S=0),isFinite(K)||(K=0),p=W._calcShiftByAddon(S,K),W._target.node instanceof mq.Group){var E=W._target.node;E._position.x+=p.x,E._position.y+=p.y}var G=z.node;if(!fm(G,L)){var o=T.x+S,U=T.y+K;W._interactor.rectGuide.gatherLines({node:G,x:z.x+o,y:z.y+U,w:z.w,h:z.h},b)}return p}},id.prototype._calcShiftByAddon=function(i,I){var J=this._target,x=J.rawPos,b=J.node.getPosition();return i=i||0,I=I||0,{x:x.x-b.x+i,y:x.y-b.y+I}},id.prototype._dealShiftDown=function(u){var a=this,C=a._target.shiftGuide,I=a._target.lp,M=Math.abs(u.x-I.x),l=Math.abs(u.y-I.y);M>l&&M>C.limit&&"y"===C.dir&&(C.dir="x"),l>M&&l>C.limit&&"x"===C.dir&&(C.dir="y");var m=C.dir;return"x"===m?(u.y=I.y,C.limit=Math.max(C.limit,M)):"y"===m&&(u.x=I.x,C.limit=Math.max(C.limit,l)),u},id.prototype._isAttachableLineShape=function(q){if(!q.getSegments)return!1;var O=q.getSegments();if(!O)return!0;O instanceof n.List&&(O=O.getArray());for(var h=1,a=O.length;a>h;h++)if(2!==O[h])return!1;return!0},id.prototype._calcAttachNodeShift=function(){var V=new Ai,b=new Ai,m=new Ai,A=new Ai;return function(n,h){var L=this._interactor.gv,j=n.getHost(),f=L.getDataAt(h,function(E){return E.s("2d.hostable")?!0:!1});if(f&&j!==f&&n.setHost(f),!f)return this._edgeHostGuideInfo=null,n.setHost(null);var M=this._edgeHostGuideInfo={corners:mq.getTargetCornersOnScreen(L,f),host:f,attach:-1};if(this._isAttachableLineShape(f)){for(var p,W,s,u,Q,$,X=f.getPoints(),F=X.size(),B=f.getPointsMatrix2d(),t=1/0,Y=0;F>Y&&(Y!==F-1||f.isClosePath());Y++)0!==Y?b.copy(m):B.apply(X.get(Y),b),B.apply(Y===F-1?X.get(0):X.get(Y+1),m),V.copy(h).sub(b),A.copy(m).sub(b),p=A.length(),A.divideScalar(p),W=V.dot(A),0>W?W=0:W>p&&(W=p),A.multiplyScalar(W).add(b),s=V.copy(h).sub(A).lengthSq(),t>s&&(t=s,$=Y,u=W,Q=p);return Math.sqrt(t)*L.getZoom()>this._interactor.getStyle("attachThreshold")?(n.s({"attach.index":-1}),n.setHost(null),void 0):(n.s("attach.offset.opposite")&&(u=Q-u),n.s({"attach.index":$,"attach.offset":n.s("attach.offset.relative")?u/Q:u}),{x:0,y:0})}var H=L.calculateAttachPoint(f,h);if(H){var N=H.point;return M.attach=H.index,this._calcShiftByAddon(N.x-h.x,N.y-h.y)}}}(),id.prototype._gatherGridInfo=function(O){var T,u=this,f=u._interactor,j=f._getValidSelection();if(j.length){if(1===j.length){if(T=j[0],!T.getRect)return u._target=null,void 0}else if(T=mq.Group.findOrCreateGroup(j,f._uuid),!T)return u._target=null,void 0}else{var j=f.gv.sm().getSelection();if(j.length&&(T=j.get(0),!T.getRect))return u._target=null,void 0}if(T){var G=T.getPosition(),s=T.getRect();u._target={node:T,x:s.x-G.x,y:s.y-G.y,w:s.width,h:s.height,lp:{x:O.x,y:O.y},pos:{x:G.x,y:G.y},shiftGuide:{dir:"x",limit:0},downPosition:new mq.Math.Vector2(O)},f.rectGuide.gatherRects()}},id.prototype.clear=function(){var O=this;O._edgeHostGuideInfo=null,O._interactor.rectGuide.clear(),O._interactor._42()},id.prototype._42=function(){var o=this._edgeHostGuideInfo;o&&this._interactor._drawHostGuide(o)};var Of=o.freeze({DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,HALF_FLOAT_OES:36193,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047}),Mj=function(){function l(B,J){var o=W;
return function(){return o||(o=B.getExtension(J)),o}}function N(g,T){T==W&&(T={}),T.version=K&&(g instanceof WebGL2RenderingContext||o.prototype.toString.call(g)===n)?2:1,T.extensions=function(){for(var W={},m=g.getSupportedExtensions(),N=m.length;N--;)W[name]=l(g,m[N]);return W}();for(var e=o.keys(y),N=0,i=e.length;i>N;++N){var P=e[N];T[P]=g.getParameter(y[P])}if(T.version>1){e=o.keys(J);for(var N=0,i=e.length;i>N;++N){var P=e[N];T[P]=g.getParameter(J[P])}}return T}var K="undefined"!=typeof WebGL2RenderingContext,n="[object WebGL2RenderingContext]",y={aliasedLineWidthRange:Of.ALIASED_LINE_WIDTH_RANGE,aliasedPointSizeRange:Of.ALIASED_POINT_SIZE_RANGE,maxCombinedTextureImageUnits:Of.MAX_COMBINED_TEXTURE_IMAGE_UNITS,maxCubeMapTextureSize:Of.MAX_CUBE_MAP_TEXTURE_SIZE,maxFragmentUniformVectors:Of.MAX_FRAGMENT_UNIFORM_VECTORS,maxRenderBufferSize:Of.MAX_RENDERBUFFER_SIZE,maxTextureImageUnits:Of.MAX_TEXTURE_IMAGE_UNITS,maxTextureSize:Of.MAX_TEXTURE_SIZE,maxVaryingVectors:Of.MAX_VARYING_VECTORS,maxVertexAttribs:Of.MAX_VERTEX_ATTRIBS,maxVertexTextureImageUnits:Of.MAX_VERTEX_TEXTURE_IMAGE_UNITS,maxVertexUniformVectors:Of.MAX_VERTEX_UNIFORM_VECTORS,maxViewportDIMs:Of.MAX_VIEWPORT_DIMS},J={max3DTextureSize:Of.MAX_3D_TEXTURE_SIZE,maxArrayTextureLayers:Of.MAX_ARRAY_TEXTURE_LAYERS,maxColorAttachments:Of.MAX_COLOR_ATTACHMENTS,maxCombinedFragmentUniformComponents:Of.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS,maxCombinedUniformBlocks:Of.MAX_COMBINED_UNIFORM_BLOCKS,maxCombinedVertexUniformComponents:Of.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS,maxDrawBuffers:Of.MAX_DRAW_BUFFERS,maxElementIndex:Of.MAX_ELEMENT_INDEX,maxElementsIndices:Of.MAX_ELEMENTS_INDICES,maxElementsVertices:Of.MAX_ELEMENTS_VERTICES,maxFragmentInpuComponents:Of.MAX_FRAGMENT_INPUT_COMPONENTS,maxFragmentUniformBlocks:Of.MAX_FRAGMENT_UNIFORM_BLOCKS,maxFragmentUniformComponents:Of.MAX_FRAGMENT_UNIFORM_COMPONENTS,maxProgramTexelOffset:Of.MAX_PROGRAM_TEXEL_OFFSET,maxSamples:Of.MAX_SAMPLES,maxTextureLODBias:Of.MAX_TEXTURE_LOD_BIAS,maxTransformFeedbackInterleavedComponents:Of.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS,maxTransformFeedbackSeparateAttribs:Of.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS,maxTransformFeedbackSeparateComponents:Of.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS,maxUniformBlockSize:Of.MAX_UNIFORM_BLOCK_SIZE,maxUniformBufferBindings:Of.MAX_UNIFORM_BUFFER_BINDINGS,maxVaryingComponents:Of.MAX_VARYING_COMPONENTS,maxVertexOutputComponents:Of.MAX_VERTEX_OUTPUT_COMPONENTS,maxVertexUniformBlocks:Of.MAX_VERTEX_UNIFORM_BLOCKS,maxVertexUniformComponents:Of.MAX_VERTEX_UNIFORM_COMPONENTS,minProgramTexelOffset:Of.MIN_PROGRAM_TEXEL_OFFSET};return{"for":function(V){var p=V._info;return p||(V._info=p=N(V,p)),p}}}(),gh=function(){function N(b,r,w){return{def:b,getter:w?function(S){var x=Mj.for(S);return x.version>1?S.getParameter(r):b}:function(i){return i.getParameter(r)},setter:w?function(C,S){var D=Mj.for(C);D.version>1&&C.pixelStorei(r,S)}:function(v,M){v.pixelStorei(r,M)}}}function w($){return"string"==typeof $?Bp($):$.r!==W?(O[0]=$.r,O[1]=$.g,O[2]=$.b,O[3]=$.a,O):$.red!==W?(O[0]=$.red,O[1]=$.green,O[2]=$.blue,O[3]=$.alpha,O):$}function q(A){return M(A)?Array.prototype.slice.call(A,0):A}function G($,k,B){this.gl=k,this._record=B||{},this._branches={},this._leafSync={},this._struct=$;for(var G=$.children,I=G.length;I--;){var s=G[I],A=s.name;s.isLeaf?(this._leafSync[A]=!1,this._record[A]=q(s.desc.def)):this._record[A]={}}}function b(s){function j(W,K){G.call(this,s,W,K);for(var u=Y.length;u--;){var f=Y[u];this._branches[f._name]=new f._type(W,this._record[f._name])}}function $(w,E){function p(A,O){for(var D=J,k=!1;D--;)A[D]!==O[D]&&(A[D]=O[D],k=!0);return k}var Q=w.name,L=M(w.desc.def),J=L&&w.desc.def.length;if(w.isLeaf){var u=w.desc.setter,d=w.desc.parse;o.defineProperty(E,Q,{configurable:!1,enumerable:!0,get:function(){return this._record[Q]},set:L?function(V){d&&(V=d(V)),(p(this._record[Q],V)||!this._leafSync[Q])&&(u(this.gl,this._record[Q]),this._leafSync[Q]=!0)}:function(V){this._record[Q]===V&&this._leafSync[Q]||(u(this.gl,V),this._record[Q]=V,this._leafSync[Q]=!0)}})}else Y.push({_name:Q,_type:b(w)}),o.defineProperty(E,Q,{configurable:!1,enumerable:!0,get:function(){return this._branches[Q]},set:function(D){this._branches[Q].apply(D)}})}var Y=[];return Q(j,G),s.forEach($,j.prototype),j}var O="undefined"!=typeof Float32Array&&new Float32Array(4),E={viewport:{def:[0,0,0/0,0/0],getter:function(B){return B.getParameter(B.VIEWPORT)},setter:function(c,H){var i=H[2]!==H[2]?c.drawingBufferWidth-H[0]:H[2],f=H[3]!==H[3]?c.drawingBufferHeight-H[1]:H[3];c.viewport(H[0],H[1],i,f)}},dither:{def:!1,getter:function(r){return r.isEnabled(r.DITHER)},setter:function(I,t){t?I.enable(I.DITHER):I.disable(I.DITHER)}},rasterizerDiscard:{def:!1,getter:function(Q){var $=Mj.for(Q);return $.version>1&&Q.isEnabled(Q.RASTERIZER_DISCARD)},setter:function(C,Q){var E=Mj.for(C);1!==E.version&&(Q?C.enable(C.RASTERIZER_DISCARD):C.disable(C.RASTERIZER_DISCARD))}},lineWidth:{def:1,getter:function(p){return p.lineWidth?p.getParameter(p.LINE_WIDTH):1},setter:function(a,D){a.lineWidth&&a.lineWidth(D)}},color:{clear:{def:[0,0,0,0],getter:function(n){return n.getParameter(n.COLOR_CLEAR_VALUE)},setter:function(v,A){v.clearColor(A[0],A[1],A[2],A[3])},parse:w},mask:{def:[!0,!0,!0,!0],getter:function(H){return H.getParameter(H.COLOR_WRITEMASK)},setter:function(d,c){d.colorMask(c[0],c[1],c[2],c[3])}}},blend:{enabled:{def:!1,getter:function(G){return G.isEnabled(G.BLEND)},setter:function(l,n){n?l.enable(l.BLEND):l.disable(l.BLEND)}},color:{def:[0,0,0,0],getter:function(l){return l.getParameter(l.BLEND_COLOR)},setter:function(y,L){y.blendColor(L[0],L[1],L[2],L[3])},parse:w},equation:{def:[Of.FUNC_ADD,Of.FUNC_ADD],getter:function(K){return[K.getParameter(K.BLEND_EQUATION_RGB),K.getParameter(K.BLEND_EQUATION_ALPHA)]},setter:function(M,F){M.blendEquationSeparate(F[0],F[1])},parse:function(d){var j=d.length;return j>1?d:1===j?(O[1]=O[0]=d[0],O):(O[1]=O[0]=d,O)}},func:{def:[Of.ONE,Of.ZERO,Of.ONE,Of.ZERO],getter:function(o){return[o.getParameter(o.BLEND_SRC_RGB),o.getParameter(o.BLEND_DST_RGB),o.getParameter(o.BLEND_SRC_ALPHA),o.getParameter(o.BLEND_DST_ALPHA)]},setter:function(k,_){k.blendFuncSeparate(_[0],_[1],_[2],_[3])},parse:function(B){var t=B.length;return t>3?B:(O[2]=O[0]=B[0],O[3]=O[1]=B[1],O)}}},cullFace:{enabled:{def:!1,getter:function(O){return O.isEnabled(O.CULL_FACE)},setter:function(g,T){T?g.enable(g.CULL_FACE):g.disable(g.CULL_FACE)}},mode:{def:Of.BACK,getter:function(S){return S.getParameter(S.CULL_FACE_MODE)},setter:function(b,Q){b.cullFace(Q)}},frontFace:{def:Of.CCW,getter:function(A){return A.getParameter(A.FRONT_FACE)},setter:function(e,k){e.frontFace(k)}}},scissor:{enabled:{def:!1,getter:function(O){return O.isEnabled(O.SCISSOR_TEST)},setter:function(p,C){C?p.enable(p.SCISSOR_TEST):p.disable(p.SCISSOR_TEST)}},box:{def:[0,0,0/0,0/0],getter:function(T){return T.getParameter(T.SCISSOR_BOX)},setter:function(j,L){var i=L[2]!==L[2]?j.drawingBufferWidth-L[0]:L[2],U=L[3]!==L[3]?j.drawingBufferHeight-L[1]:L[3];j.scissor(L[0],L[1],i,U)}}},depth:{enabled:{def:!1,getter:function(f){return f.isEnabled(f.DEPTH_TEST)},setter:function(b,Q){Q?b.enable(b.DEPTH_TEST):b.disable(b.DEPTH_TEST)}},clear:{def:1,getter:function(j){return j.getParameter(j.DEPTH_CLEAR_VALUE)},setter:function(O,N){O.clearDepth(N)}},mask:{def:!0,getter:function(G){return G.getParameter(G.DEPTH_WRITEMASK)},setter:function(L,f){L.depthMask(f)}},range:{def:[-1,1],getter:function(I){return I.getParameter(I.DEPTH_RANGE)},setter:function(j,B){j.depthRange(B[0],B[1])}},func:{def:Of.LESS,getter:function(b){return b.getParameter(b.DEPTH_FUNC)},setter:function(d,r){d.depthFunc(r)}}},stencil:{enabled:{def:!1,getter:function(b){return b.isEnabled(b.STENCIL_TEST)},setter:function(u,K){K?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST)}},clear:{def:0,getter:function($){return $.getParameter($.STENCIL_CLEAR_VALUE)},setter:function(i,E){i.clearStencil(E)}},frontMask:{def:255,getter:function(o){return o.getParameter(o.STENCIL_WRITEMASK)},setter:function(e,w){e.stencilMaskSeparate(e.FRONT,w)}},frontOp:{def:[Of.KEEP,Of.KEEP,Of.KEEP],getter:function(x){return[x.getParameter(x.STENCIL_FAIL),x.getParameter(x.STENCIL_PASS_DEPTH_FAIL),x.getParameter(x.STENCIL_PASS_DEPTH_PASS)]},setter:function(z,s){z.stencilOpSeparate(z.FRONT,s[0],s[1],s[2])}},frontFunc:{def:[Of.ALWAYS,0,255],getter:function(o){return[o.getParameter(o.STENCIL_FUNC),o.getParameter(o.STENCIL_REF),o.getParameter(o.STENCIL_VALUE_MASK)]},setter:function(I,f){I.stencilFuncSeparate(I.FRONT,f[0],f[1],f[2])}},backMask:{def:255,getter:function(L){return L.getParameter(L.STENCIL_BACK_WRITEMASK)},setter:function(K,O){K.stencilMaskSeparate(K.BACK,O)}},backOp:{def:[Of.KEEP,Of.KEEP,Of.KEEP],getter:function(j){return[j.getParameter(j.STENCIL_BACK_FAIL),j.getParameter(j.STENCIL_BACK_PASS_DEPTH_FAIL),j.getParameter(j.STENCIL_BACK_PASS_DEPTH_PASS)]},setter:function(G,j){G.stencilOpSeparate(G.BACK,j[0],j[1],j[2])}},backFunc:{def:[Of.ALWAYS,0,255],getter:function(l){return[l.getParameter(l.STENCIL_BACK_FUNC),l.getParameter(l.STENCIL_BACK_REF),l.getParameter(l.STENCIL_BACK_VALUE_MASK)]},setter:function(m,L){m.stencilFuncSeparate(m.BACK,L[0],L[1],L[2])}}},hint:{generateMipmap:{def:Of.DONT_CARE,getter:function(W){return W.getParameter(W.GENERATE_MIPMAP_HINT)},setter:function(S,u){S.hint(S.GENERATE_MIPMAP_HINT,u)}},fragmentShaderDerivative:{def:Of.DONT_CARE,getter:function(V){var x=Mj.for(V);return 1!==x.version||x.extensions.OES_standard_derivatives?V.getParameter(Of.FRAGMENT_SHADER_DERIVATIVE_HINT):Of.DONT_CARE},setter:function(M,x){var i=Mj.for(M);return i.version>1||i.extensions.OES_standard_derivatives?(M.hint(Of.FRAGMENT_SHADER_DERIVATIVE_HINT,x),void 0):void 0}}},pixelStore:{packAlignment:N(4,Of.PACK_ALIGNMENT,!1),unpackAlignment:N(4,Of.UNPACK_ALIGNMENT,!1),unpackFlipY:N(!1,Of.UNPACK_FLIP_Y_WEBGL,!1),unpackPremultiplyAlpha:N(!1,Of.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),unpackColorspaceConversion:N(Of.BROWSER_DEFAULT_WEBGL,Of.UNPACK_COLORSPACE_CONVERSION_WEBGL,!1),packRowLength:N(0,Of.PACK_ROW_LENGTH,!0),packSkipPixels:N(0,Of.PACK_SKIP_PIXELS,!0),packSkipRows:N(0,Of.PACK_SKIP_ROWS,!0),unpackRowLength:N(0,Of.UNPACK_ROW_LENGTH,!0),unpackImageHeight:N(0,Of.UNPACK_IMAGE_HEIGHT,!0),unpackSkipPixels:N(0,Of.UNPACK_SKIP_PIXELS,!0),unpackSkipRows:N(0,Of.UNPACK_SKIP_ROWS,!0),unpackSkipImages:N(0,Of.UNPACK_SKIP_IMAGES,!0)},polygonOffset:{enabled:{def:!1,getter:function(d){return d.isEnabled(d.POLYGON_OFFSET_FILL)},setter:function(J,D){D?J.enable(J.POLYGON_OFFSET_FILL):J.disable(J.POLYGON_OFFSET_FILL)}},value:{def:[0,0],getter:function(h){return[h.getParameter(h.POLYGON_OFFSET_FACTOR),h.getParameter(h.POLYGON_OFFSET_UNITS)]},setter:function(Q,O){Q.polygonOffset(O[0],O[1])}}},sampleCoverage:{enabled:{def:!1,getter:function(n){return n.isEnabled(n.SAMPLE_COVERAGE)},setter:function(D,U){U?D.enable(D.SAMPLE_COVERAGE):D.disable(D.SAMPLE_COVERAGE)}},alpha:{def:!1,getter:function(z){return z.isEnabled(z.SAMPLE_ALPHA_TO_COVERAGE)},setter:function(A,v){v?A.enable(A.SAMPLE_ALPHA_TO_COVERAGE):A.disable(A.SAMPLE_ALPHA_TO_COVERAGE)}},value:{def:[1,!1],getter:function(Z){return[Z.getParameter(Z.SAMPLE_COVERAGE_VALUE),Z.getParameter(Z.SAMPLE_COVERAGE_INVERT)]},setter:function(G,l){G.sampleCoverage(l[0],l[1])}}}},v=Xb.create(E,function(W){return"def"in W});G.prototype.reset=function(){for(var I=this._struct.children,l=I.length;l--;){var h=I[l],Q=h.name;h.isLeaf?this[Q]=h.desc.def:this._branches[Q].reset()}},G.prototype.save=function(y){y==W&&(y={});for(var z=this._struct.children,c=z.length;c--;){var C=z[c],r=C.name;if(C.isLeaf)y[r]=q(this._record[r]);else{var w=y[r];w==W&&(y[r]=w={}),this._branches[r].save(w)}}return y},G.prototype.sync=function(B,p){for(var l=this._struct.children,g=l.length;g--;){var c=l[g],V=c.name;c.isLeaf?(p||!this._leafSync[V])&&(B?(this._record[V]=c.desc.getter(this.gl),this._leafSync[V]=!0):(c.desc.setter(this.gl,this._record[V]),this._leafSync[V]=!0)):this._branches[V].sync(B,p)}},G.prototype.syncLoss=function(){for(var $=this._struct.children,E=$.length;E--;){var u=$[E];u.isLeaf?this._leafSync[u.name]=!1:this._branches[u.name].syncLoss()}},G.prototype.apply=function(Z){for(var m=this._struct.children,e=m.length;e--;){var y=m[e],W=y.name;W in Z&&(y.isLeaf?this[W]=Z[W]:this._branches[W].apply(Z[W]))}},G.prototype.append=function(r){var C=this._struct.childMap;for(var i in r){var e=C[i];e&&(e.isLeaf?this[i]=r[i]:this._branches[i].append(r[i]))}};var D=b(v);return function(c){var p=c._state;return p||(c._state=p=new D(c)),p}}(),qf=function(){function Z(Z,P,A,e){if(Z){var V=Z.length;if(V!=W)for(var l=0;e>l;++l)P[A+l]=Z[l];else Z.toArray&&Z.toArray(P,A)}else for(var l=0;e>l;++l)P[A+l]=0}function J(D,F,k){var y=D[0];if(0>=y||y>0)return D;var h=F*k,v=S[h];if(v==W&&(S[h]=v=new Float32Array(h)),0!==F){Z(y,v,0,k);for(var t=1,Y=0;t!==F;++t)Y+=k,Z(D[t],v,Y,k)}return v}function I(n,L){n.uniform1f(this.addr,L)}function $(e,K){e.uniform1fv(this.addr,K)}function M(A,M){if(M.x!=W)A.uniform2f(this.addr,M.x,M.y);else{var Y=S[2];Y.set(M,0),A.uniform2fv(this.addr,Y)}}function t(Z,x){Z.uniform2fv(this.addr,J(x,this.size,2))}function B(a,A){if(A.x!=W)a.uniform3f(this.addr,A.x,A.y,A.z);else if(A.r!=W)a.uniform3f(this.addr,A.r,A.g,A.b);else if(A.red!=W)a.uniform3f(this.addr,A.red,A.green,A.blue);else{var i=S[3];i.set(A,0),a.uniform3fv(this.addr,i)}}function f(g,F){g.uniform3fv(this.addr,J(F,this.size,3))}function E(d,e){if("string"==typeof e&&(e=Bp(e)),e.x!=W)d.uniform4f(this.addr,e.x,e.y,e.z,e.w);else if(e.r!=W)d.uniform4f(this.addr,e.r,e.g,e.b,e.a);else if(e.red!=W)d.uniform4f(this.addr,e.red,e.green,e.blue,e.alpha);else{var A=S[4];A.set(e,0),d.uniform4fv(this.addr,A)}}function C(P,m){P.uniform4fv(this.addr,J(m,this.size,4))}function L(O,Q){O.uniform1i(this.addr,Q)}function A(b,x){b.uniform1iv(this.addr,x)}function c(v,c){v.uniform2iv(this.addr,c)}function U(W,u){W.uniform3iv(this.addr,u)}function x(u,t){u.uniform4iv(this.addr,t)}function e(C,j){C.uniform1i(this.addr,T[j?1:0])}function y(X,p){var r=S[4];r.set(p,0),X.uniformMatrix2fv(this.addr,!1,r)}function h(P,f){P.uniformMatrix2fv(this.addr,!1,J(f,this.size,4))}function u(m,D){var C=S[9];C.set(D,0),m.uniformMatrix3fv(this.addr,!1,C)}function D(T,c){T.uniformMatrix3fv(this.addr,!1,J(c,this.size,9))}function z(K,o){var X=S[16];X.set(o,0),K.uniformMatrix4fv(this.addr,!1,X)}function P(z,u){z.uniformMatrix4fv(this.addr,!1,J(u,this.size,16))}function X(V,$){V.uniform1i(this.addr,this.slots[0]),V.activeTexture(V.TEXTURE0+this.slots[0]),V.bindTexture(V.TEXTURE_2D,$||V._emptyTexture)}function _(X,P){X.uniform1iv(this.addr,this.slots);for(var I=this.slots.length;I--;)X.activeTexture(X.TEXTURE0+this.slots[I]),X.bindTexture(X.TEXTURE_2D,P[I]||X._emptyTexture)}function j(f,w){f.uniform1i(this.addr,this.slots[0]),f.activeTexture(f.TEXTURE0+this.slots[0]),f.bindTexture(f.TEXTURE_CUBE_MAP,w||f._emptyCubeTexture)}function r(l,k){l.uniform1iv(this.addr,this.slots);for(var G=this.slots.length;G--;)l.activeTexture(l.TEXTURE0+this.slots[G]),l.bindTexture(l.TEXTURE_CUBE_MAP,k[G]||l._emptyCubeTexture)}function g(B,R,L){K[B]=[R,L]}function s(n,l,a){switch(n.type){case 35678:case 35680:if("uSampler"===a)return[0];if("uBlendSampler"===a)return[1];for(var F=n.size,G=new Int32Array(F),V=0;F>V;++V)G[V]=l.usedTextureSlot++;return G}return W}function l(m,B,N,j,C){this.name=m,this.addr=B,this.size=j?N.size:0,this.activeInfo=N,this.setter=K[N.type][j?1:0],this.slots=s(N,C,m),cj(this)}function p(A,x,h,t){var n=A.name,q=n.length;for(m.lastIndex=0;;){var J=m.exec(n),B=m.lastIndex,c=J[1],Z="]"===J[2],N=J[3];if(Z&&(c=0|c),N===W||"["===N&&B+2===q){h[c]=new l(c,x,A,N!==W,t);break}var S=h[c];S==W&&(h[c]=S={}),h=S}}function d(i,D,K){this.gl=D,this._program=K,this._leaves={},this._branches={},this._struct=i}function k(_){function q(x,y){d.call(this,_,x,y);for(var b=s.length;b--;){var X=s[b];this._branches[X._name]=new X._type(x,y)}this.uuid=Po.generateUUID()}function t(w,U){var J=w.name;if(w.isLeaf){var N=Y("d.setter(this.gl, v);",["v"],["d"],[w.desc]);o.defineProperty(U,J,{configurable:!1,enumerable:!0,get:function(){return N},set:N})}else s.push({_name:J,_type:k(w)}),o.defineProperty(U,J,{configurable:!1,enumerable:!0,get:function(){return this._branches[J]},set:function(z){this._branches[J].apply(z)}})}var s=[];return Q(q,d),_.forEach(t,q.prototype),q}function N(a,V){for(var y=a.getProgramParameter(V,a.ACTIVE_UNIFORMS),h={},b={usedTextureSlot:2};y--;){var R=a.getActiveUniform(V,y),l=R.name,P=a.getUniformLocation(V,l);p(R,P,h,b)}var I=Xb.create(h,function(M){return"addr"in M}),F=k(I);return o.defineProperty(F.prototype,"textureCount",{configurable:!1,enumerable:!1,writable:!1,value:b.usedTextureSlot}),new F(a,V)}var S=[];if("function"==typeof Float32Array)for(var q=1;17>q;++q)S[q]=new Float32Array(q);var T=[0,1],K=[];g(Of.FLOAT,I,$),g(Of.FLOAT_VEC2,M,t),g(Of.FLOAT_VEC3,B,f),g(Of.FLOAT_VEC4,E,C),g(Of.INT,L,A),g(Of.INT_VEC2,c,c),g(Of.INT_VEC3,U,U),g(Of.INT_VEC4,x,x),g(Of.BOOL,e,A),g(Of.BOOL_VEC2,c,c),g(Of.BOOL_VEC3,U,U),g(Of.BOOL_VEC4,x,x),g(Of.FLOAT_MAT2,y,h),g(Of.FLOAT_MAT3,u,D),g(Of.FLOAT_MAT4,z,P),g(Of.SAMPLER_2D,X,_),g(Of.SAMPLER_CUBE,j,r);var m=/([\w\d_]+)(\])?(\[|\.)?/g;return d.prototype.apply=function(y){for(var K=this._struct.children,$=K.length;$--;){var S=K[$],Q=S.name;Q in y&&(S.isLeaf?this[Q]=y[Q]:this._branches[Q].apply(y[Q]))}},d.prototype.append=function(g){var p=this._struct.childMap;for(var j in g){var Q=p[j];Q&&(Q.isLeaf?this[j]=g[j]:this._branches[j].append(g[j]))}},function(L,P){var g=P._uniforms;return g||(P._uniforms=g=N(L,P)),g}}(),fq=function(){function K(v,W,r){W.vertexAttrib1f(v.addr,r)}function P(E,y,k){if(k.x!=W)y.vertexAttrib2f(E.addr,k.x,k.y);else{var t=M[2];t.set(k,0),y.vertexAttrib2fv(E.addr,t)}}function p(H,w,U){if(U.x!=W)w.vertexAttrib3f(H.addr,U.x,U.y,U.z);else if(U.r!=W)w.vertexAttrib3f(H.addr,U.r,U.g,U.b);else if(U.red!=W)w.vertexAttrib3f(H.addr,U.red,U.green,U.blue);else{var J=M[3];J.set(U,0),w.vertexAttrib3fv(H.addr,J)}}function V(R,r,E){if("string"==typeof E&&(E=Bp(E)),E.x!=W)r.vertexAttrib4f(R.addr,E.x,E.y,E.z,E.w);else if(E.r!=W)r.vertexAttrib4f(R.addr,E.r,E.g,E.b,E.a);else if(E.red!=W)r.vertexAttrib4f(R.addr,E.red,E.green,E.blue,E.alpha);else{var I=M[4];I.set(E,0),r.vertexAttrib4fv(R.addr,I)}}function H($,B,i){i=i.el||i;for(var G=0,h=0;2>G;++G)B.vertexAttrib2f($.addr,i[h++],i[h++])}function E(x,l,i){i=i.el||i;for(var j=0,g=0;3>j;++j)l.vertexAttrib3f(x.addr,i[g++],i[g++],i[g++])}function z(e,V,A){A=A.el||A;for(var G=0,R=0;4>G;++G)V.vertexAttrib4f(e.addr,A[R++],A[R++],A[R++],A[R++])}function u(b,x,h,n){for(var F,D=h?1:0,v=x.addr,B=b._divisorState,q=0;n>q;q++)F=B[v+q]||0,F!==D&&(B[v+q]=D,b.vertexAttribDivisor(v+q,D))}function c(A,e,y,j,S,m,k){e.bindBuffer(e.ARRAY_BUFFER,y);var g=A.addr;e.enableVertexAttribArray(g),u(e,A,y.instanced,1),e.vertexAttribPointer(g,1,j||e.FLOAT,!!S,m||0,k||0),e.bindBuffer(e.ARRAY_BUFFER,null)}function $(_,U,E,K,Y,N,f){U.bindBuffer(U.ARRAY_BUFFER,E);var Q=_.addr;U.enableVertexAttribArray(Q),u(U,_,E.instanced,1),U.vertexAttribPointer(Q,2,K||U.FLOAT,!!Y,N||0,f||0),U.bindBuffer(U.ARRAY_BUFFER,null)}function r(H,m,b,x,P,K,r){m.bindBuffer(m.ARRAY_BUFFER,b);var U=H.addr;m.enableVertexAttribArray(U),u(m,H,b.instanced,1),m.vertexAttribPointer(U,3,x||m.FLOAT,!!P,K||0,r||0),m.bindBuffer(m.ARRAY_BUFFER,null)}function a(d,T,J,q,A,c,X){T.bindBuffer(T.ARRAY_BUFFER,J);var R=d.addr;T.enableVertexAttribArray(R),u(T,d,J.instanced,1),T.vertexAttribPointer(R,4,q||T.FLOAT,!!A,c||0,X||0),T.bindBuffer(T.ARRAY_BUFFER,null)}function X(S,G,Q,d,V,J,R){var J=J||16,R=R||0,r=S.addr;G.bindBuffer(G.ARRAY_BUFFER,Q),G.enableVertexAttribArray(r),G.vertexAttribPointer(r,2,d||G.FLOAT,!!V,J,R),G.enableVertexAttribArray(r+1),G.vertexAttribPointer(r+1,2,d||G.FLOAT,!!V,J,R+8),u(G,S,Q.instanced,2),G.bindBuffer(G.ARRAY_BUFFER,null)}function b(C,z,G,v,Q,W,m){var W=W||36,m=m||0,s=C.addr;z.bindBuffer(z.ARRAY_BUFFER,G);for(var X=0;3>X;X++)z.enableVertexAttribArray(s+X),z.vertexAttribPointer(s+X,3,v||z.FLOAT,!!Q,W,m+12*X);u(z,C,G.instanced,3),z.bindBuffer(z.ARRAY_BUFFER,null)}function x(f,H,v,T,N,t,n){var t=t||64,n=n||0,O=f.addr;H.bindBuffer(H.ARRAY_BUFFER,v);for(var h=0;4>h;h++)H.enableVertexAttribArray(O+h),H.vertexAttribPointer(O+h,4,T||H.FLOAT,!!N,t,n+16*h);u(H,f,v.instanced,4),H.bindBuffer(H.ARRAY_BUFFER,null)}function I(F,D,f,Y){R[F]=function(r,Q,I,x,m,u){this.addr==W||this.addr<0||(Q==W||Q===!1?Y(r,this.addr):Tq(Q)===t?f(this,r,Q,I,x,m,u):(Y(r,this.addr),D(this,r,Q)))}}function S(F,J){F.disableVertexAttribArray(J)}function B(j,w){j.disableVertexAttribArray(w),j.disableVertexAttribArray(w+1)}function A(S,q){S.disableVertexAttribArray(q),S.disableVertexAttribArray(q+1),S.disableVertexAttribArray(q+2)}function L(b,W){b.disableVertexAttribArray(W),b.disableVertexAttribArray(W+1),b.disableVertexAttribArray(W+2),b.disableVertexAttribArray(W+3)}function C(V,K,x){this.name=V,this.addr=K,this.activeInfo=x,this.setter=R[x.type],cj(this)}function Z(V,o,p){this.gl=o,this.program=p,this._branches={},this._struct=V}function w(A){function e(e,Y){Z.call(this,A,e,Y);for(var l=$.length;l--;){var D=$[l];this._branches[D._name]=new D._type(e,Y)}}function j(v,k){var O=v.name;if(v.isLeaf){var l=Y("d.setter(this.gl, v);",["v"],["d"],[v.desc]);o.defineProperty(k,O,{configurable:!1,enumerable:!0,get:function(){return l},set:l})}else $.push({_name:O,_type:w(v)}),o.defineProperty(k,O,{configurable:!1,enumerable:!0,get:function(){return this._branches[O]},set:function(w){this._branches[O].apply(w)}})}var $=[];return Q(e,Z),A.forEach(j,e.prototype),e}function i(i,b){for(var r=i.getProgramParameter(b,i.ACTIVE_ATTRIBUTES),K={};r--;){var W=i.getActiveAttrib(b,r),f=W.name,O=i.getAttribLocation(b,f);K[f]=new C(f,O,W)}var E=Xb.create(K,function(H){return"addr"in H}),z=w(E);return new z(i,b)}for(var M=[],U=1;17>U;++U)M[U]=new mo(U);var R=[],t="undefined"!=typeof WebGLBuffer&&WebGLBuffer.prototype;return I(Of.FLOAT,K,c,S),I(Of.FLOAT_VEC2,P,$,S),I(Of.FLOAT_VEC3,p,r,S),I(Of.FLOAT_VEC4,V,a,S),I(Of.FLOAT_MAT2,H,X,B),I(Of.FLOAT_MAT3,E,b,A),I(Of.FLOAT_MAT4,z,x,L),Z.prototype.disable=function(){for(var J=this._struct.children,h=J.length;h--;){var O=J[h],c=O.name;O.isLeaf?this[c]=W:this._branches[c].disable()}},Z.prototype.apply=function(b){for(var t=this._struct.children,G=t.length;G--;){var $=t[G],p=$.name;p in b&&($.isLeaf?this[p]=b[p]:this._branches[p].apply(b[p]))}},Z.prototype.append=function(C){var f=this._struct.childMap;for(var F in C){var d=f[F];d&&(d.isLeaf?this[F]=C[F]:this._branches[F].append(C[F]))}},function(K,o){var S=o._attribs;return S||(o._attribs=S=i(K,o)),S}}(),el=function(J){var t=this;o.defineProperties(this,{gl:{configurable:!1,enumerable:!1,value:J,writable:!1},glState:{configurable:!1,enumerable:!1,value:gh(J),writable:!1}}),t._currProgram=W,t._currUniforms=W,t._currAttribs=W,t._sync=!0};o.defineProperties(el.prototype,{program:{configurable:!1,enumerable:!1,get:function(){return this._currProgram},set:function(B){var J=this;J._sync&&B===J._currProgram||(J.gl.useProgram(B),J._currProgram=B,J._currUniforms=qf(J.gl,B),J._currAttribs=fq(J.gl,B),J._sync=!0)}},uniforms:{configurable:!1,enumerable:!1,get:function(){var k=this;return k._currProgram&&!k._sync&&(k.gl.useProgram(k._currProgram),k._sync=!0),k._currUniforms},set:function(u){var X=this;X._currUniforms&&(X._currProgram&&!X._sync&&(X.gl.useProgram(X._currProgram),this._sync=!0),X._currUniforms.apply(u))}},attribs:{configurable:!1,enumerable:!1,get:function(){var q=this;return q._currProgram&&!q._sync&&(q.gl.useProgram(q._currProgram),q._sync=!0),q._currAttribs},set:function(L){var S=this;S._currUniforms&&(S._currProgram&&!S._sync&&(S.gl.useProgram(S._currProgram),this._sync=!0),S._currAttribs.apply(L))}}}),el.prototype.useProgram=function(m){var A=this;A._sync&&m===A._currProgram||(A.gl.useProgram(m),A._currProgram=m,A._currUniforms=qf(A.gl,m),A._currAttribs=fq(A.gl,m),A._sync=!0)},el.prototype.directState=function(){return this.glState},el.prototype.directUniforms=function(){return this._currUniforms},el.prototype.directAttribs=function(){return this._currAttribs},el.prototype.syncLoss=function(){this._sync=!1,this.glState.syncLoss()},el.for=function(j){var Z=j._renderState;return Z||(j._renderState=Z=new el(j)),Z};var ys="directional",mk="point",Bs="spot",og="light.color",Oi=4294967295,Hp=0,lb={},ep=[],Fm=0,Km=function(I,x){xd(x)&&zs.test(x)?Ff(I,x):Il(x)&&x.modelType?Pn(I,x):x===W?delete yh[I]:yh[I]=x},yo=function(Q){return Q},Wq=function(V){V=H.convertShape3dModelName(V);var E;if(Il(V)){if(V.modelType){if(V.uuid){if(E=yh[V.uuid])return E}else V.uuid=n.Math.generateUUID();return E===W&&(Nm&&Nm[V.uuid]||Pn(V.uuid,V)),W}return V}return E=yh[V],V&&E===W&&zs.test(V)&&(Nm&&Nm[V]||Ff(V,V)),E},Mn=function(G,i){G.frameStack?G.frameStack.push(i):G.frameStack=[i],G.bindFramebuffer(G.FRAMEBUFFER,i)},Uq=function(Z){var Q=Z.frameStack;if(Q){if(Q.pop(),Q.length)return Z.bindFramebuffer(Z.FRAMEBUFFER,Q[Q.length-1]),void 0;Z.frameStack=null}Z.bindFramebuffer(Z.FRAMEBUFFER,null)};kk(H,{graph3dViewAttributes:S,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:X/60,graph3dViewSortable:!1,graph3dViewBlockSelectable:!0,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:ig,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewRotateMaxPhi:X,graph3dViewRotateMinPhi:0,graph3dViewShadowDisabled:!0,graph3dViewShadowQuality:"high",graph3dViewShadowIntensity:.3,graph3dViewShadowBias:-.005,graph3dViewShadowRadius:.1,graph3dViewShadowType:"hard",graph3dViewShadowDegreeX:30,graph3dViewShadowDegreeZ:-10,graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewSyncEyeWithOrthoWidth:!1,graph3dViewFovy:X/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewDataNumWarningLine:1e4,graph3dViewHeadlightDirection:"camera",graph3dViewHeadlightRange:0,graph3dViewHeadlightGroup:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewHeadlightAmbientIntensity:.7,graph3dViewFogDisabled:!0,graph3dViewFogMode:"linear",graph3dViewFogDensity:5e-4,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewPickerResolution:.5,graph3dViewDashDisabled:!0,graph3dViewUvClipEnabled:!1,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dViewBatchInstancedDisabled:!0,graph3dViewFlowBlendMode:"addRGB",graph3dViewEnvmapType:"legacy",graph3dMaxVectorCacheTime:50,graph3dEnvmapCapabilityRequire:8,setShape3dModel:Km,getShape3dModel:Wq,convertShape3dModelName:yo,getShape3dModelMap:function(){return yh},getCachedShape3dModelMap:function(){return Uo},createMatrix:function(Z,d){Td(Z)||(Z=[Z]);for(var F=Z.length-1;F>=0;F--){var M=Z[F];d=um(M.mat,M.s3,M.r3,M.rotationMode,M.t3,d)}return d},transformVec:function(_,y){return ak(_,y)},glBindFrame:Mn,glUnbindFrame:Uq,createBoxModel:function(){return{vs:Ar,ns:wo,uv:Xp,is:Ph}},createRoundRectModel:function(q,m){return vj.roundRect(q,m)},createStarModel:function(q,F){return vj.star(q,F)},createRectModel:function(l,H){return vj.rect(l,H)},createTriangleModel:function(o,U){return vj.triangle(o,U)},createRightTriangleModel:function(x,N){return vj.rightTriangle(x,N)},createParallelogramModel:function(W,O){return vj.parallelogram(W,O)},createTrapezoidModel:function(n,J){return vj.trapezoid(n,J)},createSmoothSphereModel:function(w,o,L,M,D,n,N){return no(new pc(w,o,L,M,D,n,N))},createSphereModel:function(B,W,x,Q,d,D,b){return B?Ul(B,W,x,Q,d,D,b):H.createSmoothSphereModel()},createSmoothConeModel:function(p,r,I,v,z){return vq(p,r,I,v,z)},createConeModel:function(m,y,W,c,D,F,Y,k){return m?hc(m,y,W,c,D,F,Y,k):vq(F)},createSmoothCylinderModel:function(l,S,u,t,A,C,n,w){return no(new ch(l,S,u,t,A,C,n,w))},createCylinderModel:function(l,t,g,X,F,N,W,O){return l?zp(l,t,g,X,F,N,W,O):dq(N,W)},createSmoothTorusModel:function(Z,p,O,n,B,s){return no(new mi(Z,p,O,n,B,s))},createTorusModel:function(E,p,h,c,$,Y,I,Q){return E?Mb(E,p,h,c,$,Y,I,Q):xp(Y,I)},createExtrusionModel:function(b,u,$,i,v,e,R,O){return wq(b,u,$,i,v,e,R,O)},createSmoothRingModel:function(N,X,V,x,T,J){for(var P=[],n=0;n<N.length-1;n+=2)P.push({x:N[n],y:N[n+1]});for(N=Wo(P,X,V)[0],P=[],n=0;n<N.length;n++){var m=N[n];P.push(new er(m.x,0,m.y))}return no(new tf(P,J,x,T))},createTextGeometry:function(c,X){var V=no(new Mf(c,X));if(X.cube)for(var z=Nf(V),N=z.min,l=z.max,P=N.x,s=N.y,t=N.z,S=l.x-P||1,u=l.y-s||1,W=l.z-t||1,Z=["vs","top_vs","bottom_vs"],x=0,O=Z.length;O>x;x++){var p=V[Z[x]];if(p)for(var w=0,Y=p.length;Y>w;w+=3)p[w]=(p[w]-P)/S-.5,p[w+1]=(p[w+1]-s)/u-.5,p[w+2]=(p[w+2]-t)/W-.5}return V},loadFontFace:function(m,L){H.xhrLoad(m,function(E){if(!E)return L();var I;try{I=JSON.parse(E)}catch(C){I=JSON.parse(E.substring(65,E.length-2))}xh.loadFace(I),L&&L(I.familyName.toLowerCase())},L?null:{sync:!0})},getShaderErrorLog:function(){return ep.join("\n")},createRingModel:function(r,t,L,c,v,y,h,m,T,f){for(var _=[],F=0;F<r.length-1;F+=2)_.push({x:r[F],y:r[F+1]});y=y||H.shapeSide,h=h||0,m=m||y;var A,Q,z,n,l,i,d,w,P,D,F,U,C,p,Y,k,e,o,M=[],$=[],B=T?[]:S,j=T?[]:S,X=f?[]:S,g=f?[]:S,a=c?[]:S,E=c?[]:S,b=v?[]:S,V=v?[]:S,r=Wo(_,t,L),N=Ke(r),W=0,K=2*Math.PI/y;return r.forEach(function(H){if(z=H.length,z>1){if(n=H[0],c)for(i=n.x,w=n.y,F=h;m>F;F++)U=F+1,C=F*K,p=U*K,Y=s(C),k=R(C),e=s(p),o=R(p),a.push(Y*i,w,-k*i,e*i,w,-o*i,0,w,0),E.push(.5-.5*Y,.5-.5*k,.5-.5*e,.5-.5*o,.5,.5);for(D=0;z>D;D++){for(l=H[D],i=n.x,d=l.x,w=n.y,P=l.y,A=W/N,W+=_h(n,l),Q=W/N,F=h;m>F;F++)U=F+1,C=F*K,p=U*K,Y=s(C),k=R(C),e=s(p),o=R(p),M.push(Y*d,P,-k*d,e*d,P,-o*d,Y*i,w,-k*i,e*d,P,-o*d,e*i,w,-o*i,Y*i,w,-k*i),$.push(F/y,Q,U/y,Q,F/y,A,U/y,Q,U/y,A,F/y,A),T&&F===h&&(B.push(0,w,0,0,P,0,Y*d,P,-k*d,Y*d,P,-k*d,Y*i,w,-k*i,0,w,0),j.push(0,.5-w,0,.5-P,2*d,.5-P,2*d,.5-P,2*i,.5-w,0,.5-w)),f&&U===m&&(X.push(0,w,0,e*d,P,-o*d,0,P,0,e*d,P,-o*d,0,w,0,e*i,w,-o*i),g.push(1,.5-w,1-2*d,.5-P,1,.5-P,1-2*d,.5-P,1,.5-w,1-2*i,.5-w));n=l}if(v)for(i=n.x,w=n.y,F=h;m>F;F++)U=F+1,C=F*K,p=U*K,Y=s(C),k=R(C),e=s(p),o=R(p),b.push(e*i,w,-o*i,Y*i,w,-k*i,0,w,0),V.push(.5-.5*e,.5+.5*o,.5-.5*Y,.5+.5*k,.5,.5)}}),{vs:M,uv:$,bottom_vs:b,bottom_uv:V,top_vs:a,top_uv:E,from_vs:B,from_uv:j,to_vs:X,to_uv:g}}},!0),kk(D,{"3d.move.mode":W,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"3d.clip.direction":null,"3d.clip.percentage":1,"3d.reflectable":!0,"shape.border.gradient.color":W,"edge.gradient.color":W,"edge.source.t3":W,"edge.target.t3":W,"light.type":mk,"light.group":0,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":X/4,"light.range":0,"light.exponent":1,"light.intensity":1,"light.mask":Oi,"headlight.ambientIntensity":W,"wf.visible":!1,"wf.width":1,"wf.fog":!0,"wf.color":Sh,"wf.short":!1,"wf.mat":W,"wf.boundingBox":!1,"wf.geometry":!1,"wf.loadQuadWireframe":!1,"wf.combineTriangle":!0,batch:W,"transparent.mask":!1,brightness:W,"select.brightness":.7,"repeat.uv.length":W,"shadow.cast":!0,"shadow.receive":!0,"3d.clipbox":W,"3d.clipbox.mask":Oi,"3d.clipbox.group":0,"3d.clipbox.shape":"cube","effect.flow":!1,"effect.flow.gradient":"spread.horizontal","effect.flow.uvshape":"rect","effect.flow.size":512,"effect.flow.group":0,"effect.flow.intensity":1,"effect.flow.blend":W,"effect.flow.mask":Oi,bloom:!1,envmap:0,"envmap.probe":0,roughness:0,renderTextureSamples:4,alphaTest:.4,autorotate:!1,fixSizeOnScreen:!1,"texture.cache":!1,"hide.overlapping.group":W,"vector.dynamic":!1,"vector.dynamic.maxsize":2048,"texture.scale":1,"geometry.cache":!1,"highlight.mode":!1,"highlight.type":"hard","highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","highlight.glow":.8,"highlight.strength":2,"color.empty":[0,0,0,0],"label.face":sl,"label.t3":W,"label.r3":W,"label.texture.scale":2,"label.rotationMode":Tp,"label.light":!1,"label.blend":W,"label.reverse.flip":!1,"label.reverse.color":il,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":sl,"label2.t3":W,"label2.r3":W,"label2.texture.scale":2,"label2.rotationMode":Tp,"label2.light":!1,"label2.blend":W,"label2.reverse.flip":!1,"label2.reverse.color":il,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":sl,"note.t3":W,"note.r3":W,"note.texture.scale":2,"note.rotationMode":Tp,"note.light":!1,"note.blend":W,"note.reverse.flip":!1,"note.reverse.color":il,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":sl,"note2.t3":W,"note2.r3":W,"note2.texture.scale":2,"note2.rotationMode":Tp,"note2.light":!1,"note2.blend":W,"note2.reverse.flip":!1,"note2.reverse.color":il,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:W,"shape3d.color":sr,"shape3d.top.color":W,"shape3d.bottom.color":W,"shape3d.from.color":W,"shape3d.to.color":W,"shape3d.image":W,"shape3d.image.projection":W,"shape3d.top.image":W,"shape3d.bottom.image":W,"shape3d.from.image":W,"shape3d.to.image":W,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":W,"shape3d.side.to":W,"shape3d.smooth":W,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":W,"shape3d.opacity":W,"shape3d.reverse.flip":!1,"shape3d.reverse.color":il,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":W,"shape3d.uv.scale":W,"shape3d.uv.rotation":W,"shape3d.uv.anchor":W,"shape3d.uv.union":W,"shape3d.top.uv.offset":W,"shape3d.top.uv.scale":W,"shape3d.top.uv.rotation":W,"shape3d.top.uv.anchor":W,"shape3d.bottom.uv.offset":W,"shape3d.bottom.uv.scale":W,"shape3d.bottom.uv.rotation":W,"shape3d.bottom.uv.anchor":W,"shape3d.from.uv.offset":W,"shape3d.from.uv.scale":W,"shape3d.from.uv.rotation":W,"shape3d.from.uv.anchor":W,"shape3d.to.uv.offset":W,"shape3d.to.uv.scale":W,"shape3d.to.uv.rotation":W,"shape3d.to.uv.anchor":W,"shape3d.top.cap":W,"shape3d.bottom.cap":W,"shape3d.start.angle":0,"shape3d.sweep.angle":z,"shape3d.point.epsilon":1e-6,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.reflector":!1,"shape3d.reflector.color":"rgb(128,128,128)","shape3d.reflector.blur":0,"shape3d.reflector.blur.iterations":1,"shape3d.reflector.background":null,"shape3d.reflector.clip":.003,"shape3d.reflector.shadow":"scene","camera.type":"perspective","camera.aspect":1,"camera.fovy":W,"camera.ortho.width":W,"camera.near":W,"camera.far":W,"camera.background":0,"camera.renderSky":!0,"camera.renderAxis":!1,"camera.renderGrid":!1,"camera.renderEdit":!1,"camera.onlySky":!1,"texture.mipmap.max":W,"texture.filter":W,"texture.filter.min":W,"texture.filter.mag":W,"texture.wrap":W,"points.image":"rect","points.color":"white","points.transparent":!1,"points.size":20,"points.opacity":1,"points.uv.scale":[1,1],"points.uv.offset":[0,0],"points.discard.selectable":!1,"all.light":!0,"all.visible":!0,"all.color":sr,"all.image":W,"all.blend":W,"all.opacity":W,"all.reverse.flip":!1,"all.reverse.color":il,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":W,"all.uv.offset":W,"all.uv.scale":W,"all.uv.rotation":W,"all.uv.anchor":W,"all.uv.union":W,"all.discard.selectable":!0,mat:W,"left.mat":W,"right.mat":W,"top.mat":W,"bottom.mat":W,"front.mat":W,"back.mat":W,"edge.source.anchor.elevation":W,"edge.target.anchor.elevation":W,"edge.source.offset.elevation":0,"edge.target.offset.elevation":0},!0);
var Qn,tq=!1,oq=[0,0,0,0],lr=function(i){return i instanceof Zr},Ol=function(g){return[g.x,g.e||0,g.y]},Rk=function($,B,i){for(var B=Bp(B||0),H=B[0],R=B[1],T=B[2];i--;)$.push(H,R,T)},Oo=function(H,M,J){for(var M=Bp(M||0),U=M[0],n=M[1],S=M[2],$=M[3];J--;)H.push(U,n,S,$)},ah=function(e,z,T){if(z)for(var L,O,X,t=z[0],p=z[1],v=z[2],f=z[4],w=z[5],V=z[6],o=z[8],N=z[9],Y=z[10],k=z[12],Q=z[13],E=z[14],g=T.length,W=0,W=0;g>W;W+=3)L=T[W],O=T[W+1],X=T[W+2],e.push(t*L+f*O+o*X+k,p*L+w*O+N*X+Q,v*L+V*O+Y*X+E);else Qb(e,T);return e},qe=function(A,S,r){var b=S.s("light.intensity"),x=Bp(S.s(og)),m=x[0],u=x[1],R=x[2];1!==b&&(m*=b,u*=b,R*=b);var W=S.s("light.disabled");A.push(m,u,R,W?1:0),r.c.push(m,u,R),r.g.push(W?-1:S.s("light.group")),r.e.push(W?1:0)},Cg=function(r,_){var d,A=el.for(_),L=A.directUniforms(),Q=r._lastLightUploadInfo={c:[],g:[],e:[]},S=r._headlightDirection;S&&3===S.length?d=S:"shadow"===S&&(d=r.shadowMap.getDirection()),d=d?se.normalizeArray(r._transformDirectionToViewSpace(null,d)):[0,0,0],L.uHeadlightDirection=d,L.uHeadlightRange=r._headlightRange;var Z=L.uHeadlightAmbientIntensity=r._headlightAmbientIntensity,x=r._headlightIntensity,g=Bp(r._headlightColor);1!==x&&(g=[g[0]*x,g[1]*x,g[2]*x]);var B;L.uHeadlightColor=[g[0],g[1],g[2],(B=r._headlightDisabled)?1:0],Q.c.push(g[0],g[1],g[2]),Q.g.push(B?-1:r._headlightGroup),Q.e.push(B?1:0);var W=r._59O,U=r._spots,u=r._dirs;if(W.length){var o=[],C=[],T=[];W.forEach(function(c){qe(o,c,Q),Qb(C,r._transformPointToViewSpace(c.p3())),T.push(c.s("light.range"))}),L.uPointColor=o,L.uPointRange=T,L.uPointPosition=C}if(U.length){var z=[],y=[],V=[],i=[],P=[],w=[];U.forEach(function(I){qe(z,I,Q),Qb(y,r._transformPointToViewSpace(I.p3())),Qb(P,r._transformDirectionToViewSpace(I.p3(),I.s("light.center"))),V.push(I.s("light.range")),i.push(s(I.s("light.angle")/2)),w.push(I.s("light.exponent"))}),L.uSpotColor=z,L.uSpotRange=V,L.uSpotAngle=i,L.uSpotExponent=w,L.uSpotPosition=y,L.uSpotDirection=P}if(u.length){var l=[],h=[];u.forEach(function(f){qe(l,f,Q),Qb(h,r._transformDirectionToViewSpace(f.p3()))}),L.uDirColor=l,L.uDirDirection=h}r._lastLightMask=Oi,r._lastHeadlightAmbientIntensity=Z},Wr=function(J,i,n,L){if(L===W&&(L=J._headlightAmbientIntensity),L!==J._lastHeadlightAmbientIntensity&&(i.uHeadlightAmbientIntensity=J._lastHeadlightAmbientIntensity=L),n!==J._lastLightMask){J._lastLightMask=n;var q=J._lastLightUploadInfo;if(q){var A,e,O,Q=q.g,H=q.e,V=Q.length,U=new Array(V),s=!1;for(e=0;V>e;e++)A=Q[e],O=0>A||A>=32?1:n&1<<A?0:1,U[e]=O,O!==H[e]&&(s=!0);if(s){q.e=H=U;var I=q.c;i.uHeadlightColor=[I[0],I[1],I[2],H[0]];var c,g=J._59O,y=J._spots,Z=J._dirs,D=3,X=1;if(V=g.length){for(e=0,c=[];V>e;e++)c.push(I[D++],I[D++],I[D++],H[X++]);i.uPointColor=c}if(V=y.length){for(e=0,c=[];V>e;e++)c.push(I[D++],I[D++],I[D++],H[X++]);i.uSpotColor=c}if(V=Z.length){for(e=0,c=[];V>e;e++)c.push(I[D++],I[D++],I[D++],H[X++]);i.uDirColor=c}}}}},go=function(k,q){return Math.max(k.getRotateMinPhi()+Gq,Math.min(k.getRotateMaxPhi()-Gq,q))},$o=function(){return.05+kj()/2},fr=function(t,w,q,L){var F,K=t.getEye();return t.isOrtho()?(F=Od(t.getCenter(),K),F[0]+=L[0],F[1]+=L[1],F[2]+=L[2]):F=K,Iq(w,q,L,F)},Iq=function(e,A,o,c){var L=wr(e,A),q=Od(c,o,!0),D=wr(q,A);if(v(D)<Gq)return S;var m=(L-wr(o,A))/D;return[o[0]+q[0]*m,o[1]+q[1]*m,o[2]+q[2]*m]},Wj=function(h,H){return{x:2*h.x-H.x,y:2*h.y-H.y}},Mo=function(m,f,B,e){var P,l;if(!m)return P=db(f.y-B.y,B.x-f.x),{x:f.x+e*R(P),y:f.y+e*s(P)};if(!B)return P=db(m.y-f.y,f.x-m.x),{x:f.x+e*R(P),y:f.y+e*s(P)};var u=Od([m.x,m.y,0],[f.x,f.y,0],!0),_=Od([B.x,B.y,0],[f.x,f.y,0],!0),U=-(u[0]+_[0])/2,J=-(u[1]+_[1])/2,i=x(U*U+J*J);if(Gq>i)return P=db(m.y-f.y,f.x-m.x),{x:f.x+e*R(P),y:f.y+e*s(P)};var T=m.x-f.x,y=m.y-f.y,p=B.x-f.x,F=B.y-f.y,L=x(T*T+y*y),E=x(p*p+F*F);P=d(wr(u,_))/2,l=u[1]*_[0]-u[0]*_[1]>0?-1:1,U/=i,J/=i;var X=e/R(P),S=g(L,E)/s(P);i=Math.min(X,S);var H={x:f.x+l*i*U,y:f.y+l*i*J};return B.b&&X>E/s(P)&&(H.adjust=!0),H},wh=function(B){var o=B[1],C=B[2],X=B[3],D=B[6],h=B[7],H=B[11];B[1]=B[4],B[2]=B[8],B[3]=B[12],B[4]=o,B[6]=B[9],B[7]=B[13],B[8]=C,B[9]=D,B[11]=B[14],B[12]=X,B[13]=h,B[14]=H},qq=function(o){var J=o[0],x=o[1],Y=o[2],B=o[3],H=o[4],Q=o[5],T=o[6],g=o[7],n=o[8],j=o[9],c=o[10],s=o[11],U=o[12],e=o[13],l=o[14],m=o[15],W=J*Q-x*H,w=J*T-Y*H,L=J*g-B*H,N=x*T-Y*Q,v=x*g-B*Q,F=Y*g-B*T,d=n*e-j*U,t=n*l-c*U,A=n*m-s*U,b=j*l-c*e,$=j*m-s*e,P=c*m-s*l,X=W*P-w*$+L*b+N*A-v*t+F*d;return X?(X=1/X,o[0]=(Q*P-T*$+g*b)*X,o[1]=(Y*$-x*P-B*b)*X,o[2]=(e*F-l*v+m*N)*X,o[3]=(c*v-j*F-s*N)*X,o[4]=(T*A-H*P-g*t)*X,o[5]=(J*P-Y*A+B*t)*X,o[6]=(l*L-U*F-m*w)*X,o[7]=(n*F-c*L+s*w)*X,o[8]=(H*$-Q*A+g*d)*X,o[9]=(x*A-J*$-B*d)*X,o[10]=(U*v-e*L+m*W)*X,o[11]=(j*L-n*v-s*W)*X,o[12]=(Q*t-H*b-T*d)*X,o[13]=(J*b-x*t+Y*d)*X,o[14]=(e*w-U*N-l*W)*X,o[15]=(n*N-j*w+c*W)*X,void 0):S},Je=function(U,D){if(D){var K=D[0],u=D[1],r=D[2];U[12]=U[0]*K+U[4]*u+U[8]*r+U[12],U[13]=U[1]*K+U[5]*u+U[9]*r+U[13],U[14]=U[2]*K+U[6]*u+U[10]*r+U[14],U[15]=U[3]*K+U[7]*u+U[11]*r+U[15]}},Hr=function(j,Z){if(Z){var M=Z[0],O=Z[1],w=Z[2];j[0]=j[0]*M,j[1]=j[1]*M,j[2]=j[2]*M,j[3]=j[3]*M,j[4]=j[4]*O,j[5]=j[5]*O,j[6]=j[6]*O,j[7]=j[7]*O,j[8]=j[8]*w,j[9]=j[9]*w,j[10]=j[10]*w,j[11]=j[11]*w}},Jc=function(K,m,G){var Q=m[0],g=m[1],c=m[2],w=m[3],X=m[4],U=m[5],L=m[6],J=m[7],z=m[8],_=m[9],f=m[10],h=m[11],d=m[12],V=m[13],j=m[14],H=m[15],b=G[0],T=G[1],r=G[2],D=G[3];return K[0]=b*Q+T*X+r*z+D*d,K[1]=b*g+T*U+r*_+D*V,K[2]=b*c+T*L+r*f+D*j,K[3]=b*w+T*J+r*h+D*H,b=G[4],T=G[5],r=G[6],D=G[7],K[4]=b*Q+T*X+r*z+D*d,K[5]=b*g+T*U+r*_+D*V,K[6]=b*c+T*L+r*f+D*j,K[7]=b*w+T*J+r*h+D*H,b=G[8],T=G[9],r=G[10],D=G[11],K[8]=b*Q+T*X+r*z+D*d,K[9]=b*g+T*U+r*_+D*V,K[10]=b*c+T*L+r*f+D*j,K[11]=b*w+T*J+r*h+D*H,b=G[12],T=G[13],r=G[14],D=G[15],K[12]=b*Q+T*X+r*z+D*d,K[13]=b*g+T*U+r*_+D*V,K[14]=b*c+T*L+r*f+D*j,K[15]=b*w+T*J+r*h+D*H,K},Wf=function(f,H,u,i){var b,L,C,D,V,M,P,Q,y,z,T=H[0],h=H[1],R=H[2],K=i[0],o=i[1],S=i[2],U=u[0],I=u[1],d=u[2];return v(T-U)<Gq&&v(h-I)<Gq&&v(R-d)<Gq?Md(f):(P=T-U,Q=h-I,y=R-d,z=1/x(P*P+Q*Q+y*y),P*=z,Q*=z,y*=z,b=o*y-S*Q,L=S*P-K*y,C=K*Q-o*P,z=x(b*b+L*L+C*C),z?(z=1/z,b*=z,L*=z,C*=z):(b=0,L=0,C=0),D=Q*C-y*L,V=y*b-P*C,M=P*L-Q*b,z=x(D*D+V*V+M*M),z?(z=1/z,D*=z,V*=z,M*=z):(D=0,V=0,M=0),f[0]=b,f[1]=D,f[2]=P,f[3]=0,f[4]=L,f[5]=V,f[6]=Q,f[7]=0,f[8]=C,f[9]=M,f[10]=y,f[11]=0,f[12]=-(b*T+L*h+C*R),f[13]=-(D*T+V*h+M*R),f[14]=-(P*T+Q*h+y*R),f[15]=1,f)},Vo=function(J,G,S,$,c){var g=1/Wi(G/2),l=1/($-c);return J[0]=g/S,J[1]=0,J[2]=0,J[3]=0,J[4]=0,J[5]=g,J[6]=0,J[7]=0,J[8]=0,J[9]=0,J[10]=(c+$)*l,J[11]=-1,J[12]=0,J[13]=0,J[14]=2*c*$*l,J[15]=0,J},Jh=function(G,I,p,B,M,y,n){var d=1/(I-p),Z=1/(B-M),K=1/(y-n);return G[0]=-2*d,G[1]=0,G[2]=0,G[3]=0,G[4]=0,G[5]=-2*Z,G[6]=0,G[7]=0,G[8]=0,G[9]=0,G[10]=2*K,G[11]=0,G[12]=(I+p)*d,G[13]=(M+B)*Z,G[14]=(n+y)*K,G[15]=1,G},Mh=function(R,i){var Z=i[0],q=i[1],S=i[2],G=i[3],k=Z*Z+q*q+S*S+G*G,u=k?1/k:0;return R[0]=-Z*u,R[1]=-q*u,R[2]=-S*u,R[3]=G*u,R},ls=function(C,E){var H=E[0]+E[5]+E[10],i=0;return H>0?(i=2*Math.sqrt(H+1),C[3]=.25*i,C[0]=(E[6]-E[9])/i,C[1]=(E[8]-E[2])/i,C[2]=(E[1]-E[4])/i):E[0]>E[5]&E[0]>E[10]?(i=2*Math.sqrt(1+E[0]-E[5]-E[10]),C[3]=(E[6]-E[9])/i,C[0]=.25*i,C[1]=(E[1]+E[4])/i,C[2]=(E[8]+E[2])/i):E[5]>E[10]?(i=2*Math.sqrt(1+E[5]-E[0]-E[10]),C[3]=(E[8]-E[2])/i,C[0]=(E[1]+E[4])/i,C[1]=.25*i,C[2]=(E[6]+E[9])/i):(i=2*Math.sqrt(1+E[10]-E[0]-E[5]),C[3]=(E[1]-E[4])/i,C[0]=(E[8]+E[2])/i,C[1]=(E[6]+E[9])/i,C[2]=.25*i),C},yb=function(N,m,R){var C=m[0],f=m[1],D=m[2],k=m[3],r=C+C,c=f+f,H=D+D,x=C*r,I=C*c,W=C*H,F=f*c,y=f*H,Z=D*H,Y=k*r,g=k*c,Q=k*H;return N[0]=1-(F+Z),N[1]=I+Q,N[2]=W-g,N[3]=0,N[4]=I-Q,N[5]=1-(x+Z),N[6]=y+Y,N[7]=0,N[8]=W+g,N[9]=y-Y,N[10]=1-(x+F),N[11]=0,N[12]=R[0],N[13]=R[1],N[14]=R[2],N[15]=1,N},om=function(O,Q){if(O.isVREnabled()){var W=O.vr.getViewMatrix(Q);if(W)return W}return O._camera?O._camera.getViewMatrix(Q):Wf(Q?Q:Pb(),O._eye,O._center,O._up)},zo=function(d,Y){if(d.isVREnabled()){var I=d.vr.getProjectMatrix();if(I)return I}if(d._camera)return d._camera.getProjectMatrix();if(!Y&&d._computedProjectMatrix)return sp(d._computedProjectMatrix);var L=d.getAspect(),m=d._near,b=d._far,U=Pb();if(d._ortho){var w=d._orthoWidth/2,s=w/L;Jh(U,-w,w,-s,s,m,b)}else Vo(U,d._fovy,L,m,b);return U},pn=function(O,U){if(!O)return S;var H=0,p=1,_=2,w=[],J=0,Q=O.length,D=Q/3;if(U){for(;Q>J;J++)w[J]=0;for(J=0;J<U.length;J+=3){var T=[],Z=[],c=[];T[H]=O[3*U[J+1]+H]-O[3*U[J]+H],T[p]=O[3*U[J+1]+p]-O[3*U[J]+p],T[_]=O[3*U[J+1]+_]-O[3*U[J]+_],Z[H]=O[3*U[J+2]+H]-O[3*U[J+1]+H],Z[p]=O[3*U[J+2]+p]-O[3*U[J+1]+p],Z[_]=O[3*U[J+2]+_]-O[3*U[J+1]+_],c[H]=T[p]*Z[_]-T[_]*Z[p],c[p]=T[_]*Z[H]-T[H]*Z[_],c[_]=T[H]*Z[p]-T[p]*Z[H];for(var s=0;3>s;s++)w[3*U[J+s]+H]+=c[H],w[3*U[J+s]+p]+=c[p],w[3*U[J+s]+_]+=c[_]}}else for(J=0;D>J;J+=3){var T=[],Z=[],c=[];T[H]=O[3*(J+1)+H]-O[3*J+H],T[p]=O[3*(J+1)+p]-O[3*J+p],T[_]=O[3*(J+1)+_]-O[3*J+_],Z[H]=O[3*(J+2)+H]-O[3*(J+1)+H],Z[p]=O[3*(J+2)+p]-O[3*(J+1)+p],Z[_]=O[3*(J+2)+_]-O[3*(J+1)+_],c[H]=T[p]*Z[_]-T[_]*Z[p],c[p]=T[_]*Z[H]-T[H]*Z[_],c[_]=T[H]*Z[p]-T[p]*Z[H];for(var s=0;3>s;s++)w[3*(J+s)+H]=c[H],w[3*(J+s)+p]=c[p],w[3*(J+s)+_]=c[_]}for(J=0;Q>J;J+=3){var o=[];o[H]=w[J+H],o[p]=w[J+p],o[_]=w[J+_];var X=x(o[H]*o[H]+o[p]*o[p]+o[_]*o[_]);0===X&&(X=Gq),o[H]=o[H]/X,o[p]=o[p]/X,o[_]=o[_]/X,w[J+H]=o[H],w[J+p]=o[p],w[J+_]=o[_]}return new mo(w)},ad=function(t,g,J,s){if(J||(J=t.createTexture()),g){var f=t.TEXTURE_2D,a=t.REPEAT,E=t.CLAMP_TO_EDGE,Z=t.TEXTURE_MIN_FILTER;s=s||Zc;var H=s.minFilter||s.filter||t.LINEAR,k=s.magFilter||s.filter||t.LINEAR;t.activeTexture(t.TEXTURE0),fd(t,J),t.texImage2D(f,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,g),yr(t,t.TEXTURE_MAG_FILTER,k);var z=g.naturalWidth||g.width,i=g.naturalHeight||g.height;Po.isPOT(z)&&Po.isPOT(i)&&!s.clampToEdge&&!g.clampToEdge?(yr(t,t.TEXTURE_WRAP_S,a),yr(t,t.TEXTURE_WRAP_T,a),yr(t,Z,H===t.NEAREST?t.NEAREST_MIPMAP_NEAREST:t.LINEAR_MIPMAP_LINEAR),s.mipmapMaxLevel!==W&&yr(t,t.TEXTURE_MAX_LEVEL,s.mipmapMaxLevel),t.generateMipmap(f)):(yr(t,t.TEXTURE_WRAP_S,E),yr(t,t.TEXTURE_WRAP_T,E),yr(t,Z,H)),fd(t,S)}return J},oo=function(C,X,P){var J=new Uint8Array(P||4);return X=X||C.createTexture(),C.activeTexture(C.TEXTURE0),fd(C,X),yr(C,C.TEXTURE_MIN_FILTER,C.LINEAR),C.texImage2D(C.TEXTURE_2D,0,C.RGBA,1,1,0,C.RGBA,C.UNSIGNED_BYTE,J),X},ek=function(V,k,M){var y=new Uint8Array(M||4);return k=k||V.createTexture(),V.activeTexture(V.TEXTURE0),V.bindTexture(V.TEXTURE_CUBE_MAP,k),V.texParameteri(V.TEXTURE_CUBE_MAP,V.TEXTURE_MAG_FILTER,V.LINEAR),V.texParameteri(V.TEXTURE_CUBE_MAP,V.TEXTURE_MIN_FILTER,V.LINEAR),V.texImage2D(V.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,V.RGBA,1,1,0,V.RGBA,V.UNSIGNED_BYTE,y),V.texImage2D(V.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,V.RGBA,1,1,0,V.RGBA,V.UNSIGNED_BYTE,y),V.texImage2D(V.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,V.RGBA,1,1,0,V.RGBA,V.UNSIGNED_BYTE,y),V.texImage2D(V.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,V.RGBA,1,1,0,V.RGBA,V.UNSIGNED_BYTE,y),V.texImage2D(V.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,V.RGBA,1,1,0,V.RGBA,V.UNSIGNED_BYTE,y),V.texImage2D(V.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,V.RGBA,1,1,0,V.RGBA,V.UNSIGNED_BYTE,y),k},ms=function(_){_._26I&&_._prg&&(_._26I.deleteProgram(_._prg),_._prg=S)},sn=function(){function R(I){if(I.match(B))return fl(I);var q=J[I];if(q)return q;var W=new RegExp("#define\\s+"+I+"\\s+(\\d+)"),f=v.match(W);return J[I]=f?fl(f[1]):0}function x(O){J={},v=O;var b=O.replace(p,E).replace(W,m);return v=null,J=null,b}function E(t,z,S){S=R(S);for(var Y="",L=0;S>L;L++)Y+=z+L+";";return Y}function m(Q,E,W,L){for(var B="",i=R(E);i<R(W);i++)B+=L.replace(/\[\s*i\s*\]/g,"["+i+"]").replace(/\[\s*I\s*\]/g,i);return B}var J,v,p=/(uniform\s+sampler2D\s+\w+)\[([\S\d]+)\];/g,W=/#UNROLL_LOOP_START\s+for\s*\(\s*int\s+i\s*=\s*([\S\d]+)\s*;\s*i\s*<\s*([\S\d]+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#UNROLL_LOOP_END/g,B=/^\d+$/;return function(Z){return x(Z)}}(),ee=function(c,$,d,Q){var _=c.createShader(d);return c.shaderSource(_,sn(Q)),c.compileShader(_),c.attachShader($,_),_},ds=function(c){return c.createBuffer()},fd=function(j,W){j.bindTexture(j.TEXTURE_2D,W||j._emptyTexture)},yr=function(C,l,r){C.texParameteri(C.TEXTURE_2D,l,r)},bd=function(q,G){var D=el.for(q).directState();D.polygonOffset.enabled=!0,D.polygonOffset.value=G},Vh=function(R){var m=el.for(R).directState();m.polygonOffset.enabled=!1},uq=function(F,r){if(r){var v=el.for(F).directState();v.color.clear=Bp(r)}},dc=function(v,T,z){if(z!==T._lastClipboxEnabled){var o=v._boxClipperGroups,K=v._boxClipperShape,s=o?o.length:0,N=new Array(s);if(z)for(var n=0;s>n;n++)N[n]=z&1<<o[n]?K[n]:0;T._lastClipboxEnabled=z,T.uClipperShape=N}},ri=dc,Rp=function(O){var s=el.for(O),k=s.directUniforms(),e=s.directAttribs();k.uFix=!0,e.aNormal=!1},Hb=function(Y){var S=el.for(Y),A=S.directUniforms();A.uFix=!1},Vf=function(m,o,B,H,n,a,l,z){var X=el.for(m),f=X.directState(),w=X.directUniforms();m._picking||(B?(w.uBlend=!0,w.uBlendColor=B):w.uBlend=!1,w.uLight=w.uFog=H==S?!0:H,ff(n)&&1!==n&&(w.uPartOpacity=n),w.uReverseFlip=a==S?!1:a,w.uFixPickReverseColor=l||il),f.cullFace.enabled=z?!0:!1},op=function(Y){if(!Y._picking){var n=el.for(Y),p=n.directUniforms();p.uPartOpacity=1}},jo=function(){var Z=new n.Math.Matrix2d,P=[1,0,0,0,1,0,0,0,0];return function(N,B,W,m,z,b,_,n,I,O,h){var X=el.for(N),c=X.directUniforms(),M=X.directAttribs();return W?(c.uTexture=!0,c.uDiscardSelectable=an(m)?m:!0,M.aUv=Lo(N,z,b,S,2),h?(c.uBlendTexture=!0,c.uBlendSampler=h):(c.uBlendTexture=!1,c.uBlendSampler=N._emptyBlendTexture),c.uSampler=W,c.uUvMatrix=_||n||I||O?Wg(I,_,n,O,Z).toArray9():P,void 0):(c.uSampler=N._emptyTexture,c.uBlendSampler=N._emptyBlendTexture,void 0)}}(),xj=function(e,K,v){var W=el.for(e),x=W.directUniforms(),U=W.directAttribs();e.activeTexture(e.TEXTURE0),fd(e,S),e.activeTexture(e.TEXTURE1),fd(e,S),v&&(U.aUv=!1,x.uTexture=!1,x.uSampler=e._emptyTexture,x.uBlendTexture=!1,x.uBlendSampler=e._emptyBlendTexture)},Ig=function(J,U,p,e,Z,V){var l=el.for(J),A=l.directUniforms(),B=l.directAttribs();!p||Ni||Lg||J.lineWidth(p),e&&!J._picking&&(A.uFixPickReverseColor=e),Z&&(B.aPosition=Lo(J,Z,V,S))},Oe=function(p,d,r,D,c){Qn&&(D=p[Qn]),c?p.drawArraysInstanced(D==S?p.TRIANGLES:D,d,r,c):p.drawArrays(D==S?p.TRIANGLES:D,d,r);var b=p._renderInfo;b&&(b.calls++,c&&(r*=c),b.vertices+=r,(D==S||D===p.TRIANGLES)&&(b.faces+=r/3),D===p.LINES&&(b.lines+=r/2),D===p.POINTS&&(b.points+=r))},Yi=function(q,l,G,i,H,Z){Qn&&(i=q[Qn]),Z?q.drawElementsInstanced(i==S?q.TRIANGLES:i,G,H==S?q.UNSIGNED_SHORT:H,l==S?0:2*l,Z):q.drawElements(i==S?q.TRIANGLES:i,G,H==S?q.UNSIGNED_SHORT:H,l==S?0:2*l);var x=q._renderInfo;x&&(x.calls++,Z&&(G*=Z),x.vertices+=G,(i==S||i===q.TRIANGLES)&&(x.faces+=G/3),i===q.LINES&&(x.lines+=G/2),i===q.POINTS&&(x.points+=G))},bm=function(s,k,R){var D=s.ARRAY_BUFFER;return s.bindBuffer(D,k),R&&s.bufferData(D,R,s.STATIC_DRAW),k},$c=function(O,k,T,S,x){var k=Lo(O,k,T,S,x);return k.instanced=!0,k},Lo=function(i,x,t,e,K){return t?Em(i,i.ARRAY_BUFFER,x,t):bm(i,x,t,e,K)},Jq=function(J,c,f){var N=J.ELEMENT_ARRAY_BUFFER;J.bindBuffer(N,c),f&&J.bufferData(N,f,J.STATIC_DRAW)},gl=function(i,q,d){Em(i,i.ELEMENT_ARRAY_BUFFER,q,d)},Em=function(A,M,L,v){var u=v._bufId;u||(u=v._bufId=n.Math.generateIncreasingID());var L,B=A._bufPool;return(L=B[u])&&L._buf?A.bindBuffer(M,L._buf):(L=B[u]={_buf:ds(A)},A.bindBuffer(M,L._buf),A.bufferData(M,v,A.STATIC_DRAW)),L._fid=A._renderInfo.frame,L._buf},gd=function(R,X){X!=S&&X>=0&&R.enableVertexAttribArray(X)},Gi=function(r,D){D!=S&&D>=0&&r.disableVertexAttribArray(D)},fn=function(n,y){var f=n.getGL(),i=el.for(f),R=i.directUniforms();n._7O=n._8O.pop(),y&&(R.uMVMatrix=n._7O,n._6O=y,R.uNMatrix=y)},Zo=function(m,F){return F||(F=Pb()),Vc(F,m),qq(F),wh(F),F},Ac=function(n,i){var H=n.getGL(),B=n._7O,J=el.for(H),k=J.directUniforms();i?(n._8O.push(sp(B)),k.uMMatrix=i,Jc(B,B,i),n._7O=B):k.uMMatrix=js,k.uMVMatrix=B,k.uNMatrix=Zo(B,n._6O)},Te={body:0,label:1,label2:2,note:3,note2:4,symbol:5},ac=10,di=function(d,O,I,R,t,c){var o;if(I){var r=R._pickId;r||(r=R._pickId=O._pickIdUsed,O._pickIdUsed+=ac);var e,L=Te[t];if(null!=L)e=r+L;else{var f=R._pickExtraPartMap;f||(f=R._pickExtraPartMap={}),(e=f[t])||(e=f[t]=O._pickIdUsed++)}O[e]||(O[e]={data:R.data,part:t}),o=Us(e)}else o=oq;if(!c){var y=el.for(d),C=y.directUniforms();C.uFixPickReverseColor=o}return o},dk=di,Bd=function(I,m,k){"target"!==k&&(k="source");var Z="target"===k?m.getTargetAgent():m.getSourceAgent(),$="edge."+k+".";if(af(Z)){var C=m.s($+"anchor.x"),A=m.s($+"anchor.elevation"),g=m.s($+"anchor.y"),j=tp(Z,I.getMat(Z)),Y=Z.getAnchor3d(),R=ak([(C===W?.5:C)-Y.x,(A===W?.5:A)-Y.y,(g===W?.5:g)-Y.z],j);return R[1]+=m.s($+"offset.elevation"),R}var t=m.s($+"index"),K=I.getData3dUI(Z);if(!K.info||!K.info.list)return!1;if(t>=0){var h,_,w,z,s,U=K.info._lastPointsSegments,E=U.points,O=U.segments,T=-1,f=-1;for(w=0,z=O?O.length:E.length;z>w;w++){if(_=O?O.get(w):1,3===_)s=2;else if(4===_)s=3;else{if(5===_)continue;s=1}if(T+=s,f++,f===t){h=E.get(T);break}}return h||(h=E.get(E.length-1)),[h.x,(h.e||0)+m.s($+"offset.elevation"),h.y]}var i=m.s($+"percent")||.5;if(i=Math.max(0,Math.min(i,1)),!K||!K.getCache)return!1;var p=K.getCache(),z=p[p.length-1].length,U=I.getLineOffset(Z,i*z),R=U.point;return[R.x,R.y+m.s($+"offset.elevation"),R.z]},Zd=function(){var l={center:function(Z,v,l,q,E){var r=-v[1]/2,B={x:-v[0]/2,y:r,width:v[0],height:v[1]},K=Cs(Z,B,l);return[K.x+q,-K.y-E,H.getPosition3dGap()]},front:function(L,F,b,R,I){var m=-F[1]/2,Z={x:-F[0]/2,y:m,width:F[0],height:F[1]},s=Cs(L,Z,b);return[s.x+R,-s.y-I,F[2]/2+H.getPosition3dGap()]},back:function(h,S,Q,i,U){var B=-S[0]/2,p=-S[1]/2,$={x:B,y:p,width:S[0],height:S[1]},r=Cs(h,$,Q);return[-r.x-i,-r.y-U,-S[2]/2-H.getPosition3dGap()]},left:function(x,P,k,o,T){var _=-P[1]/2,B={x:-P[2]/2,y:_,width:P[2],height:P[1]},t=Cs(x,B,k);return[-P[0]/2-H.getPosition3dGap(),-t.y-T,t.x+o]},right:function(n,r,b,y,p){var v=-r[2]/2,$=-r[1]/2,u={x:v,y:$,width:r[2],height:r[1]},K=Cs(n,u,b);return[r[0]/2+H.getPosition3dGap(),-K.y-p,-K.x-y]},top:function(k,p,g,e,W){var r={x:-p[0]/2,y:-p[2]/2,width:p[0],height:p[2]},c=Cs(k,r,g);return[c.x+e,p[1]/2+H.getPosition3dGap(),c.y+W]},bottom:function(O,z,h,R,y){var s=-z[2]/2,d={x:-z[0]/2,y:s,width:z[0],height:z[2]},C=Cs(O,d,h);return[C.x+R,-z[1]/2-H.getPosition3dGap(),-C.y-y]}};return function(Y,G,n,E,R,w){return l[E](Y,G,n,R||0,w||0)}}(),Be=function(P,R,Z,D,G,u,m,v,i,Y){if(G&&(R[0]+=G[0],R[1]+=G[1],R[2]+=G[2]),Je(P,Z),v){var a=Pb();if(fs(a,i,Y),ak(R,a),Je(P,R),P.auto=v,P.pos=ak([0,0,0],P),u){var E=P.mat2=Pb();fs(E,u,m)}}else fs(P,i,Y),Je(P,R),D===Vn?pj(P,-Rr):D===_k?pj(P,Rr):D===Dr?gr(P,-Rr):D===Er?gr(P,Rr):D===$i&&pj(P,X),fs(P,u,m);return P},sb=function(C,Z){var d=Z.auto,w=Z.mat2,l=C.gv;if(d){var Y,e=Pb(),V=[0,0,0,0];Y="string"==typeof d?[d.indexOf("x")<0?l._eye[0]:l._center[0],d.indexOf("y")<0?l._eye[1]:l._center[1],d.indexOf("z")<0?l._eye[2]:l._center[2]]:l._eye,ls(V,Wf(Pb(),Y,l._center,l._up)),yb(e,Mh(V,V),Z.pos),w&&Jc(e,e,w),Ac(l,e)}else Ac(l,Z)},Jg=function(H,y,Z,E,O){var b=H.s,A=H.gv,r=A.getGL(),f=A._prg,i=A._buffer,x=A._1O,d=el.for(r),u=d.directAttribs();ad(r,Qe,x),sb(H,Z),Vf(r,f,b(y+".blend"),b(y+".light"),b(y+".opacity"),b(y+".reverse.flip"),b(y+".reverse.color"),b(y+".reverse.cull")),jo(r,f,x,O,i.uv,mr),u.aPosition=Lo(r,i.vs,E,S),u.aNormal=Lo(r,i.ns,ss,S),gl(r,i.is,wj),Yi(r,0,wj.length),xj(r,f,x),op(r,f),fn(A)},Bf=function(g,z,c){var U=g.gv,Q=g.data,i=g[z]={blend:U.getBodyColor(Q)||U.getFaceBlend(Q,z),light:U.getFaceLight(Q,z),color:U.getFaceColor(Q,z),opacity:U.getFaceOpacity(Q,z),transparent:U.getFaceTransparent(Q,z),reverseFlip:U.getFaceReverseFlip(Q,z),reverseColor:U.getFaceReverseColor(Q,z),reverseCull:U.getFaceReverseCull(Q,z),texture:U.getFaceImage(Q,z),blendTexture:U.getFaceBlendImage(Q,z),discardSelectable:U.getFaceDiscardSelectable(Q,z)};if("csg"!==z){i.uv=U.getFaceUv(Q,z)||c&&c[z+"Uv"],i.uvScale=U.getFaceUvScale(Q,z)||c&&c[z+"UvScale"],i.uvOffset=U.getFaceUvOffset(Q,z)||c&&c[z+"UvOffset"],i.uvRotation=U.getFaceUvRotation(Q,z)||c&&c[z+"uvRotation"],i.uvAnchor=U.getFaceUvAnchor(Q,z)||c&&c[z+"uvAnchor"];var G=U.getFaceMat(Q,z);if(G){var m=tp(Q,G);Q.appendAnchorMatrix3d(m),i.mat=m}}return i},Mi=function(u,F,f,R,Q){var A=u[R];if(A){if(!Q(A.transparent))return;var n=u.data,L=u.gv,Y=L._buffer,U=L.getTexture(A.texture,n,R),c=L.getTexture(A.blendTexture,n),y=el.for(F),N=y.directUniforms(),J=y.directAttribs();jo(F,f,U,A.discardSelectable,Y.uv,A.tuv,A.uvOffset,A.uvScale,A.uvRotation,A.uvAnchor,c),Vf(F,f,A.blend,A.light,A.opacity,A.reverseFlip,A.reverseColor,A.reverseCull),A.cs&&!L._batchColorDisabled?(N.uBatchColor=!0,J.aBatchColor=Lo(F,Y.batchColor,A.cs,f.aBatchColor,4)):N.uDiffuse=A.color||D["color.empty"],J.aPosition=Lo(F,Y.vs,A.vs,S),J.aNormal=Lo(F,Y.ns,A.ns,S),Oe(F,0,A.vs.length/3),A.cs&&!L._batchColorDisabled&&(N.uBatchColor=!1,Gi(F,f.aBatchColor)),op(F,f),xj(F,f,U)}},Qi=function(o,y,L){Td(o)?o.forEach(function(g){Qi(g,y,L)}):xd(o)?Qi(ze(y,o),y,L):Il(o)?o.shape3d?Qi(o.shape3d,y,L):L.push(o):L.push(o)},vk=function(){for(var d=50,O=arguments.length,b=[],Z=0;O>Z;Z++)b[Z]=arguments[Z];ep[Fm]="Time : "+(new Date).toLocaleString()+", Info :"+b.join(", "),Fm=(Fm+1)%d,console.error("Failed to create shader.")},Wg=function(){var s=new Po.Matrix2d;return function(P,J,F,G,I){return I||(I=s),I.identity(),G&&I.translate(-G[0],-G[1]),F&&I.scale(F[0],F[1]),P&&I.rotate(P),G&&I.translate(G[0],G[1]),J&&I.translate(J[0],J[1]),I}}(),Ng=function(U,x,J,O,L,H){var i,b,D,R,W,p,w,a,q,P,E,$=[O-x,L-J],u=U?U.length:0;for(D=0;u>D;D++){for(R=2,i=U[D],W=i[0],p=i[1];R+1<i.length;){if(w=i[R],a=i[R+1],b=xf(x,J,O,L,W,p,w,a,!0)){q=[w-W,a-p],P=_h(q),q[0]/=P,q[1]/=P,P=wr($,q),P=P>0?H:-H,E=[q[0]*P,q[1]*P];break}W=w,p=a,R+=2}if(E)break}if(E)for(O=x+E[0],L=J+E[1],D=0;u>D;D++)for(R=2,i=U[D],W=i[0],p=i[1];R+1<i.length;){if(w=i[R],a=i[R+1],b=xf(x,J,O,L,W,p,w,a,!0))return[0,0];W=w,p=a,R+=2}return E?E:[O-x,L-J]},tm=function(I){return"nearest"===I?Of.NEAREST:"linear"===I?Of.LINEAR:I},ko=n.graph3d={WebGLConstants:Of},so=function(F,j,B){Dh(V+".graph3d."+F,j,B)},ao="!~!<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~!<6/1!,!*{/mbdpMwVxpmg!,!z/mbdpMwVxpmg!-y/mbdpMwVxpmg)3dfw!>!^j]wVxpmg!<{zy/*enspgtobsu!+!yjsubNNv!+!^j]yjsubNxpmg)!>!mbdpMwVxpmg!|!*,,j!<UDFKCP`XPMG`YBN!=!j!<1!>!j!uoj)!spg!<mbdpMwVxpmg!4dfw!1!?!UDFKCP`XPMG`YBN!gj$!gjeof$!<enspgtobsu!+!yjsubNNv!+!yjsubNxpebit!>!esppDxpebit!QBNXPEBIT`FTV!gfegj$!gjeof$!~!<fdobutjEfojMb!>!fdobutjEfojMw!|!*itbEv)!gj!ITBE!gfegj$!gjeof$!~!<ttfouihjsCidubCb!>!ttfouihjsCidubCw!|!*ttfouihjsCidubCv)!gj!TTFOUIHJSCIDUBC!gfegj$!gjeof$!~!<eofmCidubCb!>!eofmCidubCw!|!*eofmCidubCv)!gj!EOFMCIDUBC!gfegj$!gjeof$!~!<spmpDidubCb!>!spmpDidubCw!|!*spmpDidubCv)!gj!SPMPDIDUBC!gfegj$!gjeof$!~!<**1/2!-wVb)4dfw!+!yjsubNwVv)3dfw!>!wVw!|!*fsvuyfUv)!gj!ftmf$!<*y/wVb!-**1/2!-wVb)4dfw!+!yjsubNwVv)3dfw)4dfw!>!wVw!QJMD`WV!gfegj$!<*enspgtobsu)4dfw!>!opjujtpQw!gjeof$!~!1!>>!SFQQJMD`YPC`YBN!gj$!<*enspgtobsu!+!yjsubNNv)4dfw!>!emspXw!<*yfusfw)4dfw!>!yfusfWw!gjeof$!<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw!ftmf$!<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw!ftmf!~!<**1/2!-mbnspOw!+!n)5dfw!+!yjsubNOv)4dfw!>!mbnspOw!<**^3]n!-^3]n)upe!-*^2]n!-^2]n)upe!-*^1]n!-^1]n)upe)4dfw!0!mbnspOb!>!mbnspOw!<*!efdobutoJyjsubNb!)4ubn!>!n!4ubn!|!*fdobutoJftVv)!gj!FDOBUTOJIDUBC!gfegj$!gjeof$!|!*ldjQva)!gj!1!>>!SFQQJMD`YPC`YBN!gj$!<enspgtobsu!+!yjsubNWNv!>!yfusfw!5dfw!gjeof$!~!<enspgtobsu!+!efdobutoJyjsubNb!>!enspgtobsu!|!*fdobutoJftVv)!gj!FDOBUTOJIDUBC!gfegj$!<*1/2!-opjujtpQb)5dfw!>!enspgtobsu!5dfw!|!*ejpw)ojbn!ejpw!gjeof$!<^UDFKCP`XPMG`YBN]wVxpmg!3dfw!hojzsbw!<^UDFKCP`XPMG`YBN]yjsubNxpmg!5ubn!nspgjov!1!?!UDFKCP`XPMG`YBN!gj$!gjeof$!<esppDxpebit!5dfw!hojzsbw!<yjsubNxpebit!5ubn!nspgjov!QBNXPEBIT`FTV!gfegj$!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw!<fdobutjEfojMb!ubpmg!fuvcjsuub!<itbEv!mppc!nspgjov!ITBE!gfegj$!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov!<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov!<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov!<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov!<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!gjeof$!<eofmCidubCw!4dfw!hojzsbw!<eofmCidubCb!4dfw!fuvcjsuub!<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw!<ttfouihjsCidubCb!ubpmg!fuvcjsuub!<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!gjeof$!<spmpDidubCw!5dfw!hojzsbw!<spmpDidubCb!5dfw!fuvcjsuub!<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<opjujtpQw!4dfw!hojzsbw!<emspXw!4dfw!hojzsbw!<yfusfWw!4dfw!hojzsbw!<mbnspOw!4dfw!hojzsbw!<yjGv!mppc!nspgjov!<ldjQv!mppc!nspgjov!<yjsubNxfjWv!5ubn!nspgjov!<yjsubNOv!5ubn!nspgjov!<yjsubNQv!5ubn!nspgjov!<yjsubNNv!5ubn!nspgjov!<yjsubNWNv!5ubn!nspgjov!<opjujtpQb!4dfw!fuvcjsuub!gjeof$!~!<*{zy/**1/1!-sje)5dfw!+!yjsubn))f{jmbnspo!osvufs!|!*yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsu!4dfw!<efdobutoJyjsubNb!5ubn!fuvcjsuub!<fdobutoJftVv!mppc!nspgjov!FDOBUTOJIDUBC!gfegj$!<mbnspOb!4dfw!fuvcjsuub!gjeof$!<wVw!3dfw!hojzsbw!ftmf$!<wVw!4dfw!hojzsbw!QJMD`WV!gfegj$!<wVb!3dfw!fuvcjsuub!<yjsubNwVv!4ubn!nspgjov!<fsvuyfUeofmCv!mppc!nspgjov!<fsvuyfUv!mppc!nspgjov!YJGFSQ$!^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",Ji="!~!~!<eJ!>!spmpDhbsG`mh!~!<spmpDsfmqnbTwv!>+!eJ!<*zy/wVw!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw!|!*fsvuyfUeofmCv)!gj!gjeof$!~!<ttfouihjsCidubCw!>+!chs/eJ!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~!<ttfouihjsCv!>+!chs/eJ!|*1/2!>a!ttfouihjsCv)gj!gjeof$!~!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ!gjeof$!<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg!ftmf$!<*iuqfe!+!iuqfe!+!zujtofEhpGv!+!zujtofEhpGv!.)qyf!.!1/2!>!spudbGhpg!ubpmg!3QYF`HPG!gfegj$!<{/yfusfWw.!>!iuqfe!ubpmg!|!*hpGv)!gj!HPG!gfegj$!~!~!<zujdbqPusbQv!>+!b/eJ!|*1/2!>a!zujdbqPusbQv)gj!~!gjeof$!~!<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ!gjeof$!<*spmpDwof)sbfojMpUmfyfUqbNwof!>!spmpDwof!<**{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv)fcvDfsvuyfu!>!spmpDwof!5dfw!ftmf$!<**ttfoihvps!-*{z/dfWudfmgfs!-y/dfWudfmgfs.)4dfw!-qbNwoFv)WVfcvDfsvuyfu)CHStpUsbfojM!>!spmpDwof!5dfw!WV`FCVD`FQZU`QBNWOF!gfegj$!gjeof$!<*mbnspOemspx!-yfusfWpUbsfnbd)udfmgfs!>!dfWudfmgfs!4dfw!ftmf$!<***mbnspOemspx!-yfusfWpUbsfnbd)udfmgfs!-ubvRqbnwoFv)spudfWfubups)f{jmbnspo!>!dfWudfmgfs!4dfw!FUBUPS`QBNWOF!gfegj$!<*yjsubNxfjWv!-O)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw!<*opjujtpQbsfnbDv!.!emspXw)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw!|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!gjeof$!~!~!~!~!<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ!<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt!|*^j]fmhoBupqTv!?!udfggFupqt)gj!<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg!<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw!|*1/1!?!fhobSm)!gj!~!<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm!|*1/1!?!^j]fhobSupqTv)!gj!<1/2!>!fhobSm!ubpmg!<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw!|*1/1!>>!x/^j]spmpDupqTv)gj!|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!gjeof$!~!~!~!<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ!|*1/1!?!fhobSm)!gj!~!<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm!|*1/1!?!^j]fhobSuojpQv)!gj!<1/2!>!fhobSm!ubpmg!<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw!|*1/1!>>!x/^j]spmpDuojpQv)gj!|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!gjeof$!~!~!<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ!|*1/1!>>!x/^j]spmpDsjEv)gj!|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~!<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ!gjeof$!~!<fvmbWxpebit!+!zujtofuoJxpebit!.!1/2!>+!nsfUusfcnbm!~!<osvufs!<esbdtje!|!*1/1!>>!fvmbWxpebit!%%!mmvDxpebit)!gj!<*esppDxpebit!-tvjebSxpebit!-tbjCxpebit!-f{jTxpebit!-qbNxpebit)xpebiTufh!.!1/2!>!fvmbWxpebit!ubpmg!|!*fwjfdfSxpebit)!gj!QBNXPEBIT`FTV!gfegj$!~!<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!>+!nsfUusfcnbm!|*1/1!?!fhobSuihjmebfIv)gj!<*1/1!-zujtofuoJuofjcnBuihjmebfIv!,!*zujtofuoJuofjcnBuihjmebfIv!.!1/2)!+!nsfUusfcnbm)ybn!>!nsfUusfcnbm!<*opjudfsjEuihjmebfIv.!-O)upe!>!nsfUusfcnbm!ftmf!<*M.!-O)upe!>!nsfUusfcnbm!*1/1!>>!{/opjudfsjEuihjmebfIv!%%!1/1!>>!z/opjudfsjEuihjmebfIv!%%!1/1!>>!y/opjudfsjEuihjmebfIv)!gj!<nsfUusfcnbm!ubpmg!|*1/1!>>!x/spmpDuihjmebfIv)gj!gjeof$!EOF`QPPM`MMPSOV$!~!gjeof$!<chs/mfyfUxpmg!>,!chs/eJ!ftmf$!<bchs/mfyfUxpmg!>,!bchs/eJ!*!BCHS`EEB`FEPN`EOFMC`XPMG!)efojgfe!gjmf$!<bchs/mfyfUxpmg!>!bchs/eJ!*!BCHS`FEJSSFWP`FEPN`EOFMC`XPMG!)efojgfe!gjmf$!<b/mfyfUxpmg!>!b/eJ!*!B`FEJSSFWP`FEPN`EOFMC`XPMG!)efojgfe!gjmf$!<chs/mfyfUxpmg!>!chs/eJ!*!CHS`FEJSSFWP`FEPN`EOFMC`XPMG!)efojgfe!gjmf$!<bchs/mfyfUxpmg!>+!bchs/eJ!*!BCHS`ZMQJUMVN`FEPN`EOFMC`XPMG!)efojgfe!gjmf$!<chs/mfyfUxpmg!>+!chs/eJ!*!CHS`ZMQJUMVN`FEPN`EOFMC`XPMG!)efojgfe!gj$!****1/1)3dfw!-^j]wVxpmg)obiUsfubfsh)mmb!%%!***1/2)3dfw!-^j]wVxpmg)obiUttfm)mmb!%%!^j]efmcboFxpmg)!gj!<*^j]wVxpmg!-^J]fsvuyfUxpmg)E3fsvuyfu!>!mfyfUxpmg!|!*,,j!<UDFKCP`XPMG`YBN!=!j!<1>j!uoj)!spg!USBUT`QPPM`MMPSOV$!<mfyfUxpmg!5dfw!1!?!UDFKCP`XPMG`YBN!gj$!|!*uihjMv)!gj!~!gjeof$!~!<spmpDeofmCv!>+!eJ!|*eofmCv)gj!ftmf$!~!<spmpDeofmCv!>+!eJ!|*eofmCv)gj!ftmf!~!<eofmCidubCw!>+!chs/eJ!|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~!~!<esbdtje!|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~!<ftvggjEv!>!eJ!|ftmf~!<spmpDidubCw!>!eJ!|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|!ftmf!~!<spmpDwv!>!eJ!|*fsvuyfUv)gj!|!ftmf!~!<spmpDftsfwfSldjQyjGv!>!eJ!|*qjmGftsfwfSva!%%!ldbCtj)gj!~!<fvsu!>!ldbCtj!<O.!>!O!|*1/1!=!*O!-F)upe)gj!<ftmbg!>!ldbCtj!mppc!<F.!>!M!4dfw!gjeof$!<*yfusfWw.)f{jmbnspo!>!F!4dfw!ftmf$!<*2!-1!-1)4dfw!>!F!4dfw!DJIQBSHPIUSP!gfegj$!<*mbnspOw)f{jmbnspo!>!O!4dfw!|!ftmf!~!gjeof$!~!~!<ftvggjEv!>!eJ!|ftmf!~!<esbdtje!|*1/1!>>!x/ftvggjEv)gj!|!*fdobutjEitbEv!?!*fdobutjEqbHitbEv!-fdobutjEfojMw)epn!%%!itbEv)!gj!ITBE!gfegj$!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~!<spmpDftsfwfSldjQyjGv!>!eJ!|!ftmf!~!<spmpDidubCw!>!eJ!|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|!*yjGv)!gj!<eJ!5dfw!|!ftmf!~!~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!|!ftmf!~!<spmpDidubCw!>!spmpDhbsG`mh!|!*spmpDidubCv)!gj!SPMPDIDUBC!gfegj$!|!*ldjQv)!gj!~!<osvufs!<*1/2!-1/1!-1/1!-1/1)5dfw!>!spmpDhbsG`mh!|!*uvpldbmc)!gj!gjeof$!~!~!<osvufs!<esbdtje!|!**6/1!=!*mbdpMw)iuhofm)!>a!^j]sfooJqjmDsfqqjmDv!%%!3!>>!^j]fqbiTsfqqjmDv!}}!***ojNqjmd!-mbdpMw)obiUsfubfsh)mmb!%%!**ybNqjmd!-mbdpMw)obiUttfm)mmb)!>a!^j]sfooJqjmDsfqqjmDv!%%!2!>>!^j]fqbiTsfqqjmDv)!gj!<**1/2!-emspXw)5dfw!+!^j]yjsubNsfqqjmDv)4dfw!>!mbdpMw!|!*,,j!<SFQQJMD`YPC`YBN!=!j!<1!>!j!uoj)!spg!<mbdpMw!4dfw!1!?!SFQQJMD`YPC`YBN!gj$!~!gjeof$!~!<esbdtje!|!**sje!-*uofdsfQqjmDv)4dfw)upe!?!*opjujtpQw!-sje)upe)!gj!ftmf$!~!<esbdtje!|!**sje!-*uofdsfQqjmDv)4dfw)upe!?!*opjujtpQqjmd!-sje)upe)!gj!~!<*1/1!-1/1!-{/wVw)4dfw!>!opjujtpQqjmd!<1/2.!>!y/sje!|!*:!=!opjudfsjEqjmDv)!gj!ftmf!~!<*1/1!-1/1!-{/wVw)4dfw!>!opjujtpQqjmd!<1/2!>!y/sje!|!*9!=!opjudfsjEqjmDv)!gj!ftmf!QJMD`WV!gfegj$!~!<1/2.!>!{/sje!|!*8!=!opjudfsjEqjmDv)!gj!ftmf!~!<1/2!>!{/sje!|!*7!=!opjudfsjEqjmDv)!gj!ftmf!~!<1/2.!>!z/sje!|!*6!=!opjudfsjEqjmDv)!gj!ftmf!~!<1/2!>!z/sje!|!*5!=!opjudfsjEqjmDv)!gj!ftmf!~!<1/2.!>!y/sje!|!*4!=!opjudfsjEqjmDv)!gj!ftmf!~!<1/2!>!y/sje!|!*3!=!opjudfsjEqjmDv)!gj!gjeof$!<opjujtpQw!>!opjujtpQqjmd!4dfw!QJMD`WV!gfegj$!<*1/1!-1/1!-1/1)4dfw!>!sje!4dfw!|!*1!?!opjudfsjEqjmDv)!gj!~!~!~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!|!ftmf!~!~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!|!*uofsbqtobsUv)!gj!gjeof$!<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv!ftmf$!<*zy/wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv!QJMD`WV!gfegj$!|!**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)!gj!<spmpDwv!5dfw!|!*ejpw)ojbn!ejpw!<uvpldbmc!mppc!nspgjov!gjeof$!<^UDFKCP`XPMG`YBN]wVxpmg!3dfw!hojzsbw!<^UDFKCP`XPMG`YBN]efmcboFxpmg!mppc!nspgjov!<^UDFKCP`XPMG`YBN]fsvuyfUxpmg!E3sfmqnbt!nspgjov!1!?!UDFKCP`XPMG`YBN!gj$!gjeof$!gjeof$!~!~!<*1/2!-*Gqjn!-2spmpd!-1spmpd)yjn)5dfw!osvufs!<*1/2!,!uoJqjn!-sjEfmqnbt!-qbNwof)WVfcvDsbfojmjc!>!2spmpd!4dfw!|!ftmf!~!<*1/2!-1spmpd)5dfw!osvufs!|!*1/1!>>!Gqjn)!gj!<*uoJqjn!-sjEfmqnbt!-qbNwof)WVfcvDsbfojmjc!>!1spmpd!4dfw!<*qjn)sppmg!>!uoJqjn!ubpmg!<*qjn)udbsg!>!Gqjn!ubpmg!<*mfwfMqjNybn`WVfcvd!-1n!-*ttfoihvps)qjNpUttfoihvps)qnbmd!>!qjn!ubpmg!|!*ttfoihvps!ubpmg!-sjEfmqnbt!4dfw!-qbNwof!E3sfmqnbt)WVfcvDfsvuyfu!5dfw!~!<qjn!osvufs!~!<*ttfoihvps!+!72/2)3hpm!+!1/3!.!>!qjn!|!ftmf!~!<6n!,!*7s!.!6s)!0!*6n!.!7n)!+!*ttfoihvps!.!6s)!>!qjn!|!*7s!>?!ttfoihvps)!gj!ftmf!~!<5n!,!*6s!.!5s)!0!*5n!.!6n)!+!*ttfoihvps!.!5s)!>!qjn!|!*6s!>?!ttfoihvps)!gj!ftmf!~!<2n!,!*5s!.!2s)!0!*2n!.!5n)!+!*ttfoihvps!.!2s)!>!qjn!|!*5s!>?!ttfoihvps)!gj!ftmf!~!<1n!,!*2s!.!1s)!0!*1n!.!2n)!+!*ttfoihvps!.!1s)!>!qjn!|!*2s!>?!ttfoihvps)!gj!<1/1!>!qjn!ubpmg!|!*ttfoihvps!ubpmg)qjNpUttfoihvps!ubpmg!1/5!7n!fojgfe$!9411/1!7w!fojgfe$!23/1!7s!fojgfe$!1/4!6n!fojgfe$!721/1!6w!fojgfe$!614/1!6s!fojgfe$!1/3!5n!fojgfe$!751/1!5w!fojgfe$!5/1!5s!fojgfe$!1/2!.!2n!fojgfe$!783/1!2w!fojgfe$!9/1!2s!fojgfe$!1/3!.!1n!fojgfe$!:44/1!1w!fojgfe$!1/2!1s!fojgfe$!~!<*z/g!-nc!-nu)yjn!osvufs!<*y/g!-sc!-mc)yjn!>!nc!4dfw!<*y/g!-su!-mu)yjn!>!nu!4dfw!<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!mc!4dfw!<f{jTmfyfu!>.!y/wv!<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!sc!4dfw!<f{jTmfyfu!>,!z/wv!<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!su!4dfw!<f{jTmfyfu!>,!y/wv!<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!mu!4dfw!<f{jTmfyfu!>+!wv!<*f{jTfdbg!+!1/3!.!f{jTfmjUybn`WVfcvd!-1/1)ybn!+!1/4!>,!y/wv!<f{jTfmjUojn`WVfcvd!+!1/3!+!uoJsfumjg!>,!z/wv!~!<f{jTfmjUybn`WVfcvd!+!1/3!>,!z/wv!|!*mfwfMqjNybn`WVfcvd!=!uoJqjn)!gj!<f{jTfdbg!+!fdbg!>,!y/wv!~!<1/4!>.!fdbg!<f{jTfdbg!>,!z/wv!|!*1/3!?!fdbg)!gj!<g!.!6/1!>,!wv!<*wv)udbsg!>!g!3dfw!<*1/2!.!f{jTfdbg)!+!*fdbg!-opjudfsje)WVufh!>!wv!3dfw!<*f{jTfmjUybn`WVfcvd!+!1/4)!0!1/2!>!f{jTmfyfu!ubpmg!<*uoJqjn)3qyf!>!f{jTfdbg!ubpmg!<*mfwfMqjNojn`WVfcvd!-uoJqjn)ybn!>!uoJqjn!<*1/1!-uoJqjn!.!mfwfMqjNojn`WVfcvd)ybn!>!uoJsfumjg!ubpmg!<*opjudfsje)fdbGufh!>!fdbg!ubpmg!|!*uoJqjn!ubpmg!-opjudfsje!4dfw!-qbNwof!E3sfmqnbt)WVfcvDsbfojmjc!4dfw!~!<*1/2!,!wv)!+!6/1!osvufs!~!<*{/opjudfsje)tcb!0!*z/opjudfsje!-y/opjudfsje)3dfw!>!wv!|!ftmf!~!<*z/opjudfsje)tcb!0!*{/opjudfsje!-y/opjudfsje!.)3dfw!>!wv!|!*1/5!>>!fdbg)!gj!ftmf!~!<*y/opjudfsje)tcb!0!*z/opjudfsje!-{/opjudfsje!.)3dfw!>!wv!|!*1/4!>>!fdbg)!gj!ftmf!~!<*{/opjudfsje)tcb!0!*z/opjudfsje!-y/opjudfsje!.)3dfw!>!wv!|!*1/3!>>!fdbg)!gj!ftmf!~!<*z/opjudfsje)tcb!0!*{/opjudfsje!.!-y/opjudfsje!.)3dfw!>!wv!|!*1/2!>>!fdbg)!gj!ftmf!~!<*y/opjudfsje)tcb!0!*z/opjudfsje!-{/opjudfsje)3dfw!>!wv!|!*1/1!>>!fdbg)!gj!<wv!3dfw!|!*fdbg!ubpmg!-opjudfsje!4dfw)WVufh!3dfw!~!<fdbg!osvufs!~!<1/5!;!1/2!@!1/1!?!z/opjudfsje!>!fdbg!ftmf!<1/6!;!1/3!@!1/1!?!{/opjudfsje!>!fdbg!*z/opjudfsjEtcb!?!{/opjudfsjEtcb)!gj!|!ftmf!~!<1/5!;!1/2!@!1/1!?!z/opjudfsje!>!fdbg!ftmf!<1/4!;!1/1!@!1/1!?!y/opjudfsje!>!fdbg!*z/opjudfsjEtcb!?!y/opjudfsjEtcb)!gj!|!*{/opjudfsjEtcb!?!y/opjudfsjEtcb)!gj!<1/2!.!>!fdbg!ubpmg!<*opjudfsje)tcb!>!opjudfsjEtcb!4dfw!|!*opjudfsje!4dfw)fdbGufh!ubpmg!1/72!f{jTfmjUojn`WVfcvd!fojgfe$!1/763!f{jTfmjUybn`WVfcvd!fojgfe$!1/5!mfwfMqjNojn`WVfcvd!fojgfe$!1/9!mfwfMqjNybn`WVfcvd!fojgfe$!WV`FCVD`FQZU`QBNWOF!gfegj$!~!<*{zy/*yjsubn!+!*1/1!-sje)5dfw))f{jmbnspo!osvufs!|!*yjsubn!5ubn!oj!-sje!4dfw!oj)opjudfsjEnspgtobsUftsfwoj!4dfw!gjeof$!~!<*x/fvmbw!-**SPUDBG`BNNBH)4dfw!-{zy/fvmbw)xpq)5dfw!osvufs!|!*fvmbw!5dfw)sbfojMpUmfyfUqbNwof!5dfw!ftmf$!~<*!b/fvmbw!-*!*!*!*!9142411/1!)4dfw!-chs/fvmbw!)mbvrFobiUttfm!)4dfw!-3:/32!+!chs/fvmbw!-*!661/1!)4dfw!.!661/2!+!*!*!77725/1!)4dfw!-chs/fvmbw!)xpq!)yjn!)5dfw!osvufs!|!*!fvmbw!5dfw!oj!)CHStpUsbfojM!5dfw!~!<*b/fvmbw!-****65151/1)4dfw!-chs/fvmbw)mbvrFobiUttfm)4dfw!-9194::4881/1!+!chs/fvmbw!-**5/3)4dfw!-*5218342361/1)4dfw!,!79:387985:/1!+!chs/fvmbw)xpq)yjn)5dfw!osvufs!|!*fvmbw!5dfw)sbfojMpUmfyfUqbNwof!5dfw!WV`FCVD`FQZU`QBNWOF!gfegj$!gjeof$!~!<{zy/*!*x/ubvr!-{/ubvr.!-z/ubvr.!-y/ubvr.)5dfw!-wr!)ubvRumvn!osvufs!<*!*1/1!-dfw)5dfw!-ubvr!)ubvRumvn!>!wr!5dfw!|!*!dfw!4dfw!-ubvr!5dfw!)spudfWfubups!4dfw!~!<*!{/3r!+!{/2r!.!z/3r!+!z/2r!.!y/3r!+!y/2r!.!x/3r!+!x/2r!-z/3r!+!y/2r!.!y/3r!+!z/2r!,!x/3r!+!{/2r!,!{/3r!+!x/2r!-y/3r!+!{/2r!.!{/3r!+!y/2r!,!x/3r!+!z/2r!,!z/3r!+!x/2r!-{/3r!+!z/2r!.!z/3r!+!{/2r!,!x/3r!+!y/2r!,!y/3r!+!x/2r)5dfw!osvufs!|!*3r!5dfw!-2r!5dfw)ubvRumvn!5dfw!<ubvRqbnwoFv!5dfw!nspgjov!FUBUPS`QBNWOF!gfegj$!<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!QBNWOF`FTV!gfegj$!gjeof$!~!gjeof$!<*qe!-*z/f{jTmfyfu!-E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!osvufs!ftmf$!<*1/:!0!1/2)!+!*!*qe!-*z/f{jTmfyfu!-yyz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-yyy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-zyz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-zyy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-yzz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-yzy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-zzz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-zzy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!)!osvufs!<z/f{jTmfyfu!+!tvjebSxpebit!+!*2!-2!.)3dfw!>!uftggp!3dfw!*UGPT`GDQ`FQZU`QBNXPEBIT)efojgfe!}}!*GDQ`FQZU`QBNXPEBIT)efojgfe!gj$!<*opjujtpQpUuihjm)f{jmbnspo!>!E4ec!4dfw!<tbjCxpebit!>,!qe!<*sbfObsfnbDxpebit!.!sbGbsfnbDxpebit)!0!*sbfObsfnbDxpebit!.!*opjujtpQpUuihjm)iuhofm)!>!qe!ubpmg!<{zy/esppDxpebit!>!opjujtpQpUuihjm!4dfw!<**1/3!-1/5)3dfw!+!f{jTqbNxpebit)!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!|!*sbGbsfnbDxpebit!ubpmg!-sbfObsfnbDxpebit!ubpmg!-esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt)xpebiTuojpQufh!ubpmg!~!<*68/1!-684/1)3dfw!,!sbobmq!+!*63/1!-632/1)3dfw!osvufs!~!<1/3!.!Zohjt!+!{/w!>!z/sbobmq!<1/3!,!Zohjt!+!1/3!,!y/w!>!y/sbobmq!<*z/w)ohjt!>!Zohjt!ubpmg!|!*foPutpnmb!>?!z/Wtcb)!gj!ftmf!~!<Yohjt!+!1/3!,!Yohjt!+!{/w!>!y/sbobmq!<*y/w)ohjt!>!Yohjt!ubpmg!|!*foPutpnmb!>?!y/Wtcb)!gj!ftmf!~!<y/w!.!1/5!>!y/sbobmq!*1/1!?!{/w)!gj!|!*foPutpnmb!>?!{/Wtcb)!gj!<mfyfUButpnmb!.!1/2!>!foPutpnmb!ubpmg!<Zf{jTmfyfu!+!6/2!>!mfyfUButpnmb!ubpmg!<zy/w!>!sbobmq!3dfw!<*Zf{jTmfyfu!+!1/3!.!1/2)!+!fcvDpUfmbdt!>+!w!<fcvDpUfmbdt!>+!Wtcb!<**{/Wtcb!-z/Wtcb)ybn!-y/Wtcb)ybn!0!1/2!>!fcvDpUfmbdt!ubpmg!<*w)tcb!>!Wtcb!4dfw!|!*Zf{jTmfyfu!ubpmg!-w!4dfw)WVpUfcvd!3dfw!~!<xpebit!osvufs!~!gjeof$!<*{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!>!xpebit!ftmf$!<*1/:!0!1/2)!+!*!*{/esppDxpebit!-*2ze!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*2ze!-1/1)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*2ze!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*1/1!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*1/1!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*1ze!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*1ze!-1/1)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*1ze!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!)!>!xpebit!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!<f{jTqbNxpebit!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!*UGPT`GDQ`FQZU`QBNXPEBIT)efojgfe!gjmf$!<*1/:!0!1/2)!+!*!*{/esppDxpebit!-*2ze!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*2ze!-1/1)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*2ze!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*1/1!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*1/1!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*1ze!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*1ze!-1/1)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*1ze!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!)!>!xpebit!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!<f{jTqbNxpebit!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!*GDQ`FQZU`QBNXPEBIT)efojgfe!gj$!|!*utfUnvutvsg)!gj!<*dfWutfUnvutvsg)mmb!>!utfUnvutvsg!mppc!<*1/2!>=!{/esppDxpebit!-nvutvsGoj)3dfwc!>!dfWutfUnvutvsg!3dfwc!<*dfWnvutvsGoj)mmb!>!nvutvsGoj!mppc!<*1/2!>=!z/esppDxpebit!-1/1!>?!z/esppDxpebit!-1/2!>=!y/esppDxpebit!-1/1!>?!y/esppDxpebit)!5dfwc!>!dfWnvutvsGoj!5dfwc!<tbjCxpebit!>,!{/esppDxpebit!<x/esppDxpebit!>0!{zy/esppDxpebit!<1/2!>!xpebit!ubpmg!|!*esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt)xpebiTufh!ubpmg!~!<d!osvufs!<*y/g!-c!-b)yjn!>!d!ubpmg!<*z/g!-us!-cs)yjn!>!c!ubpmg!<*z/g!-um!-cm)yjn!>!b!ubpmg!<*6/1!,!f{jt!+!wv)udbsg!>!g!3dfw!<*fsbqnpd!-zz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!us!ubpmg!<*fsbqnpd!-yz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!cs!ubpmg!<*fsbqnpd!-zy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!um!ubpmg!<*fsbqnpd!-yy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!cm!ubpmg!<f{jt!0!*6/1!,!f{jt!+!wv)sppmg!>!WVejpsuofd!3dfw!<f{jt!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!<*1/2!-1/1)3dfw!>!uftggp!3dfw!utopd!|!*fsbqnpd!ubpmg!-wv!3dfw!-f{jt!3dfw!-tiuqfe!E3sfmqnbt)qsfMxpebiTE3fsvuyfu!ubpmg!~!<***wv!-tiuqfe)E3fsvuyfu)iuqfEpUBCHSldbqov!-fsbqnpd)qfut!osvufs!|!*fsbqnpd!ubpmg!-wv!3dfw!-tiuqfe!E3sfmqnbt)fsbqnpDE3fsvuyfu!ubpmg!~!<*tspudbGldbqoV!-w)upe!osvufs!|!*w!5dfw!oj!utopd)iuqfEpUBCHSldbqov!ubpmg!<*/2!-tspudbGldbQ)5dfw!0!fmbdtoxpEldbqoV!>!tspudbGldbqoV!5dfw!utopd!<*/763!-/763!+!/763!-/763!+!/763!+!/763)4dfw!>!tspudbGldbQ!4dfw!utopd!</763!0!/663!>!fmbdtoxpEldbqoV!ubpmg!utopd!</663!0!/763!>!fmbdtqVldbQ!ubpmg!utopd!<esppDxpebit!5dfw!hojzsbw!<fwjfdfSxpebit!mppc!nspgjov!<tvjebSxpebit!ubpmg!nspgjov!<tbjCxpebit!ubpmg!nspgjov!<zujtofuoJxpebit!ubpmg!nspgjov!<f{jTxpebit!3dfw!nspgjov!<qbNxpebit!E3sfmqnbt!nspgjov!<mmvDxpebit!mppc!nspgjov!QBNXPEBIT`FTV!gfegj$!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw!<fdobutjEqbHitbEv!ubpmg!nspgjov!<fdobutjEitbEv!ubpmg!nspgjov!<itbEv!mppc!nspgjov!ITBE!gfegj$!gjeof$!gjeof$!<sbGhpGv!ubpmg!nspgjov!<sbfOhpGv!ubpmg!nspgjov!ftmf$!<zujtofEhpGv!ubpmg!nspgjov!3QYF`HPG!gfegj$!<hpGv!mppc!nspgjov!<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!gjeof$!<*6/1!-6/1!-6/1)4dfw!>!ybNqjmd!4dfw!utopd!<*6/1.!-6/1.!-6/1.)4dfw!>!ojNqjmd!4dfw!utopd!<^SFQQJMD`YPC`YBN]yjsubNsfqqjmDv!5ubn!nspgjov!<^SFQQJMD`YPC`YBN]sfooJqjmDsfqqjmDv!mppc!nspgjov!<^SFQQJMD`YPC`YBN]fqbiTsfqqjmDv!uoj!nspgjov!1!?!SFQQJMD`YPC`YBN!gj$!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov!<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov!<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov!<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov!<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov!<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov!<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov!<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov!<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!gjeof$!<eofmCidubCw!4dfw!hojzsbw!<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw!<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!gjeof$!<spmpDidubCw!5dfw!hojzsbw!<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<opjudfsjEuihjmebfIv!4dfw!nspgjov!<spmpDuihjmebfIv!5dfw!nspgjov!<zujtofuoJuofjcnBuihjmebfIv!ubpmg!nspgjov!<fhobSuihjmebfIv!ubpmg!nspgjov!<emspXw!4dfw!hojzsbw!<opjujtpQbsfnbDv!4dfw!nspgjov!<yjsubNxfjWv!5ubn!nspgjov!gjeof$!gjeof$!<qbNwoFv!fcvDsfmqnbt!nspgjov!ftmf$!<ttfoihvps!ubpmg!nspgjov!<qbNwoFv!E3sfmqnbt!nspgjov!WV`FCVD`FQZU`QBNWOF!gfegj$!<zujwjudfmgfSv!ubpmg!nspgjov!<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<opjujtpQw!4dfw!hojzsbw!<yfusfWw!4dfw!hojzsbw!<mbnspOw!4dfw!hojzsbw!<ftvggjEv!5dfw!nspgjov!<zujdbqPusbQv!ubpmg!nspgjov!<ttfouihjsCv!ubpmg!nspgjov!<uihjMv!mppc!nspgjov!<spmpDeofmCv!5dfw!nspgjov!<eofmCv!mppc!nspgjov!<uofdsfQqjmDv!ubpmg!nspgjov!<opjudfsjEqjmDv!uoj!nspgjov!<sfmqnbTeofmCv!E3sfmqnbt!nspgjov!<sfmqnbTv!E3sfmqnbt!nspgjov!gjeof$!<wVw!3dfw!hojzsbw!ftmf$!<wVw!4dfw!hojzsbw!QJMD`WV!gfegj$!<fsvuyfUeofmCv!mppc!nspgjov!<fsvuyfUv!mppc!nspgjov!<uofsbqtobsUv!mppc!nspgjov!<utfUbiqmBv!ubpmg!nspgjov!<spmpDftsfwfSldjQyjGv!5dfw!nspgjov!<qjmGftsfwfSv!mppc!nspgjov!<ldjQv!mppc!nspgjov!<yjGv!mppc!nspgjov!<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ$!gjeof$!gjeof$!<ubpmg!qnvjefn!opjtjdfsq!ftmf$!<ubpmg!qihji!opjtjdfsq!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!TF`MH!gfegj$!";
kk(H,{setBatchInfo:function(u,W){Hd[u]=W},getBatchInfo:function(m){return Hd[m]},getBatchInfoMap:function(){return Hd},setBatchInfoMap:function(U){Hd=U}},!0);var rq=[1,1,1],cm=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],On=[1,0,0,0,0,1,0,1,1,1,1,0],Eo=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],Ij=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],Zi=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],Rq=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],sh=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],ok=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],xg=function(y,P){var x=y._40Q;x.each(function(g){g.ivBatch(P)})},Dm=function(A,o,V){var s=V._id,v=o[s];if(v){var S=v.batch,$=A[S],M=$.ds,C=v.index;if($.invalidate=!0,delete o[s],M.splice(C,1),bg(M))return delete A[S],void 0;for(var n=C,d=v.begin,Z=v.size;C<M.length;C++)v=o[M[C]._id],v.index--,v.begin-=Z;if($.ms&&$.ms.length)return $.ms.splice(16*n,16),$.ics&&$.ics.splice(4*n,4),$.ps&&$.ps.splice(4*n,4),void 0;var U=3*d,I=3*Z,u=4*d,q=4*Z,X=$.vs,l=$.ps,j=$.uv,N=$.cs,Y=$.bs,H=$.rs,t=$.ns,K=$.ls;X.splice(U,I),l.splice(u,q),j&&j.splice(2*d,2*Z),N&&N.splice(u,q),Y&&Y.splice(U,I),H&&H.splice(d,Z),t&&t.splice(U,I),K&&K.splice(d,Z)}},ip=function(J,r,c,P,x){if(!P)return S;var t=r[P];if(!t){var D=x.getBatchInfo(P)||Zc,e=D.image?[]:S;t=r[P]={vs:[],ns:[],uv:e,cs:e?S:D.color?S:[],bs:D.blend?[]:S,ps:[],rs:D.brightness?[]:S,ds:[],ms:D.instanced?[]:S,ics:e?S:D.color||!D.instanced?S:[]}}return t.invalidate=!0,J[c._id]={index:t.ds.length,begin:t.vs.length/3,batch:P},t.ds.push(c),t},hr=function(K,j){return j!=S&&1!==j?[K[0]*j,K[1]*j,K[2]*j,K[3]]:K},_g=function(A){var X=A.shapeModel;X||(X=ze(A)),X&&(X._ctlineModel=[],X._lineModel=W)},_m=function(){var D;return function(V,E,g){var U=V.getData3dUI(E),w=U.shapeModel;if(w||(w=ze(U)),w||!U.shapeName){var h,r=E.s("wf.combineTriangle");if(g.geometry){if(!w&&(E instanceof n.Node&&!(E instanceof n.Shape)?(D||(D={vs:Ar,is:Ph,uv:Xp}),w=D):w=[U.left,U.front,U.right,U.back,U.top,U.bottom],!w))return W;if(r){var Z=E.s("wf.normEpsilon");isNaN(Z)&&(Z=2),r=0|Math.min(3,Math.max(1,isNaN(r)?1:r)),h=Im[r-1](w,U,180/(Math.PI*Z))}else h=Jm(w,U);if(!h||0===h.length)return}else if(h=g.short?Si:ol,E.s("wf.boundingBox")){var t=U.getBoundingBox();if(t){var s=(new xn).scale(t.max.clone().sub(t.min)).setPosition(t.max.clone().add(t.min).divideScalar(2)).toArray();h=ah([],s,h)}}var o,k,J,B=V.getBrightness(E),f=E.s("bloom"),X=E.s("3d.reflectable"),N=Bp(g.color||"white"),Q=N[3]<1,I=Math.ceil(g.width)||1,i=E.s("3d.clipbox")?Hp:E.s("3d.clipbox.mask"),K=E.s("wf.fog"),z=E.getRenderLayer(),A=V._40Q.get(z),u=A.wireframeIndexMap,c=A.wireframeModelMap,b=E.s("batch"),C=E.s("3d.clip.direction");if(C){if(k=E.s("3d.clip.percentage"),0===k)return;o="_"+E._id,J=U._formatClipUniforms(C,k,E)}else o=b?(Q?"T":"O")+b:(Q?"T":"O")+(f?"_1":"_0")+(X?"1_":"0_")+i+"_"+I+(K?"1_":"0_");var j=c[o];j||(j=c[o]={vs:[],cs:[],ps:[],ds:[],T:Q,B:f,clipboxMask:i,reflectable:!!X,W:I,batch:b,fog:K}),j.invalidate=!0;var m=j.vs,p=j.cs,F=j.ds,R=u[E._id]={index:F.length,begin:m.length/3,batch:o};F.push(E);var d,_=U.mat;g.geometry&&E instanceof n.Shape&&(H.extractShapeTranslation||H.extractPolylineTranslation||H.extractVerticesTranslation)&&(d=U._vsTranslation)&&_&&(_=(new Po.Matrix4).fromArray(_).multiply(d).toArray()),E instanceof n.Edge||!(!_||!g.geometry&&E instanceof n.Shape)||(_=tp(E,g.mat),E.appendAnchorMatrix3d(_)),J?(j.mat=sp(_),j.clipDirection=J[0],j.clipPercent=J[1],ah(m,null,h)):ah(m,_,h);var P=R.size=m.length/3-R.begin;Oo(p,hr(N,B),P)}}}(),uf=function(O,s,U,Z,i,A,C,F,N){var v=O.getBrightness(s);v==S&&(v=1);var b=hr(Bp(Z),v),o=b[3]<1;A=Math.ceil(A)||1;var K=(o?"T":"O")+A;if(C){var h=C[0],T=(C[1]||h)+h;K+="-"+h+"-"+T,N&&(K+="-"+dr(N)+"-"+v,N=hr(Bp(N),v))}var t=s.getRenderLayer(),X=O._40Q.get(t),u=X.polylineIndexMap,Y=X.polylineModelMap,r=Y[K];r||(r=Y[K]={vs:[],cs:[],ps:[],ds:[],ls:C?[]:S,T:o,W:A},C&&(r.D=h,r.G=T,r.A=N)),r.invalidate=!0;var x,y=r.vs,w=r.cs,a=r.ds,f=r.ls,q=u[s._id]={index:a.length,begin:y.length/3,batch:K};a.push(s),Qb(y,U);var n,P=q.size=y.length/3-q.begin,W=U.length,L=0,Q=[];if(C||i)for(x=0;W>x;x+=6)n=_h([U[x],U[x+1],U[x+2]],[U[x+3],U[x+4],U[x+5]]),Q.push(n),L+=n;if(L&&i){var B,I=hr(Bp(i),v),G=[I[0]-b[0],I[1]-b[1],I[2]-b[2],I[3]-b[3]],l=0;for(x=0;W>x;x+=6)B=l/L,Oo(w,[b[0]+G[0]*B,b[1]+G[1]*B,b[2]+G[2]*B,b[3]+G[3]*B],1),l+=Q[x/6],B=l/L,Oo(w,[b[0]+G[0]*B,b[1]+G[1]*B,b[2]+G[2]*B,b[3]+G[3]*B],1)}else Oo(w,b,P);if(C)for(l=F||0,x=0;W>x;x+=6)f.push(l),l+=Q[x/6],f.push(l)},ai=function(e,O,L){if(O){var V=L[O.batch],m=V.ps,Q=V.ms&&V.ms.length,c=Q?4*O.index:4*O.begin,G=Q?1:O.size;if(m[c]!==e[0]||m[c+1]!==e[1]||m[c+2]!==e[2]||m[c+3]!==e[3]){for(var s=0;G>s;s++)m[c++]=e[0],m[c++]=e[1],m[c++]=e[2],m[c++]=e[3];m._invalidateThisFrame=!0}}},Wd=function(){var J=new n.Math.Vector3,W=new n.Math.Vector3;return function(B,y){var o=y+["32"],Z=B[y],i=B[o];if(Z){if((H.extractBatchTranslation||H.extractVerticesTranslation)&&"vs"===y){W.set(0,0,0);for(var m=Z.length,N=0;m>N;N+=3)W.add(J.fromArray(Z,N));W.divideScalar(m/3);for(var p=W.x,h=W.y,D=W.z,E=new Array(m),N=0;m>N;N+=3)E[N]=Z[N]-p,E[N+1]=Z[N+1]-h,E[N+2]=Z[N+2]-D;Z=E,B.translate=[p,h,D]}i&&i.length===Z.length?(i.set(Z),i._bufId=null):B[o]=new mo(Z)}else delete B[o]}}(),Hl=function(t,g,d,N,u,_,h,a){var m=g instanceof n.Shape,A=_[0],s=_.length;if(s>1){A=sp(A);for(var F=1;s>F;F++)Jc(A,A,_[F])}if(m){var W=g.p3();Je(A,W)}Qb(h.ms,A);var q;if(h.ics&&(q=g.s("shape3d.color"))&&Oo(h.ics,q,1),!h.vs.length){var V=sp(cm);m&&Je(V,Sn(W)),Ud(t,g,d,N,u,[V],h,a)}},Ud=function(n,u,z,t,w,C,j,h){if(Td(z))z.forEach(function(Y){Ud(n,u,Y,t,w,C,j,h)});else if(xd(z))Ud(n,u,ze(t,z),t,w,C,j,h);else if(Il(z)){var D,Q=dd(z.mat,u,n),F=dd(z.s3,u,n),P=dd(z.t3,u,n),W=dd(z.r3,u,n);if((F||W||P||Q)&&(D=um(Q,F,W,dd(z.rotationMode,u,n),P),C.push(D)),z.shape3d)Ud(n,u,z.shape3d,t,w,C,j,z);else{var f=t.s;h=h||Zc;var R=C[0],H=C.length,x=f("shape3d.color",z.color,h.color);if(w||(w=f("shape3d.blend",z.blend,h.blend)),H>1){R=sp(R);for(var a=1;H>a;a++)Jc(R,R,C[a])}var v=R?Zo(R):S;z.vs&&f(zb,z.visible,h.visible)&&mm(R,j,z.vs,z.uv,z.is,z.ns,v,w,x),z.top_vs&&f(ob,z.topVisible,h.topVisible)&&mm(R,j,z.top_vs,z.top_uv,z.top_is,z.top_ns,v,w,f("shape3d.top.color",z.topColor,h.topColor)||x),z.bottom_vs&&f(_l,z.bottomVisible,h.bottomVisible)&&mm(R,j,z.bottom_vs,z.bottom_uv,z.bottom_is,z.bottom_ns,v,w,f("shape3d.bottom.color",z.bottomColor,h.bottomColor)||x),z.from_vs&&f(kn,z.fromVisible,h.fromVisible)&&mm(R,j,z.from_vs,z.from_uv,z.from_is,z.from_ns,v,w,f("shape3d.from.color",z.fromColor,h.fromColor)||x),z.to_vs&&f(qh,z.toVisible,h.toVisible)&&mm(R,j,z.to_vs,z.to_uv,z.to_is,z.to_ns,v,w,f("shape3d.to.color",z.toColor,h.toColor)||x)}D&&C.pop()}},mm=function(b,J,l,y,x,c,e,n,h){var B,v=J.cs,L=J.uv,O=J.bs,Z=J.ns,D=J.vs;if(c&&0!==c.length||(c=pn(l,x)),x){B=x.length;for(var Q=0;B>Q;Q++){var M=x[Q],K=3*M;ah(D,b,[l[K],l[K+1],l[K+2]]),ah(Z,e,[c[K],c[K+1],c[K+2]]),L&&Qb(L,[y[2*M],y[2*M+1]])}}else B=l.length/3,ah(D,b,l),ah(Z,e,c),L&&Qb(L,y);v&&Oo(v,h,B),O&&(n?Rk(O,n,B):Qb(O,rq,B))},Yl=function(o,D,p){var _=o.data.p3();if(D=sp(D),Je(D,_),Qb(p.ms,D),!p.vs.length){var K=sp(cm);Je(K,Sn(_)),fo(o,K,p)}},fo=function(N,R,A){Xg(N,Vn,R,A),Xg(N,_k,R,A),Xg(N,sl,R,A),Xg(N,$i,R,A),Xg(N,Dr,R,A),Xg(N,Er,R,A),Xg(N,"csg",R,A)},$h=function(L,R,$,T,A,s){Qb($.ms,A);var Z;$.ics&&(Z=R.s("all.color"))&&Oo($.ics,Z,1),$.vs.length||Fj(L,R,$,T,sp(cm),s)},Fj=function(M,a,G,C,e,W){sf(M,a,G,C,e,W,Vn,Eo),sf(M,a,G,C,e,W,_k,Ij),sf(M,a,G,C,e,W,Dr,Zi),sf(M,a,G,C,e,W,Er,Rq),sf(M,a,G,C,e,W,sl,sh),sf(M,a,G,C,e,W,$i,ok)},oj=function(C,p,X,x,u){x?u.instanced?C.gv.batchInstancedModel(C.data,x,C,C.getBodyColor(),[p],X):Ud(C.gv,C.data,x,C,C.getBodyColor(),[p],X):u.instanced?C.gv.batchInstancedShapeFace(C,p,X):fo(C,p,X)},Xg=function($,M,G,e){var Q=$[M];if(Q){var L=Q.tuv;if(L){var u=Q.uvScale,Y=Q.uvOffset,g=Q.uvRotation,J=Q.uvAnchor;if(u||Y||g){var h,v,N,I=Wg(g,Y,u,J),c=I.a,R=I.b,n=I.c,t=I.d,d=I.tx,q=I.ty,F=L.length;for(N=0;F>N;N+=2)h=L[N],v=L[N+1],L[N]=c*h+n*v+d,L[N+1]=R*h+t*v+q}}mm(G,e,Q.vs,L,S,S,G?Zo(G):S,Q.blend,Q.color)}},sf=function(N,H,Y,T,g,z,F,k){var b,h=Y.cs,O=Y.uv,R=Y.bs,r=Y.vs,S=Y.ns,G=pn(k);if(N.getFaceVisible(H,F)){var i=N.getFaceMat(H,F);if(i&&(g=tp(H,i),z=Zo(g)),ah(r,g,k),ah(S,z,G),h&&Oo(h,N.getFaceColor(H,F),6),O){var j=N.getFaceUv(H,F)||T[F+"Uv"],A=N.getFaceUvScale(H,F)||T[F+"UvScale"],s=N.getFaceUvOffset(H,F)||T[F+"UvOffset"],y=N.getFaceUvRotation(H,F)||T[F+"UvRotation"],K=N.getFaceUvAnchor(H,F)||T[F+"UvAnchor"];j=j?[j[6],j[7],j[0],j[1],j[2],j[3],j[2],j[3],j[4],j[5],j[6],j[7]]:On;var Z=j[0],B=j[1],o=j[2],d=j[3],Q=j[4],e=j[5],W=j[6],c=j[7],w=j[8],D=j[9],x=j[10],l=j[11];if(A||s||y||K){var I=Wg(y,s,A,K),q=I.a,m=I.b,V=I.c,J=I.d,P=I.tx,v=I.ty;Z=q*Z+V*B+P,B=m*Z+J*B+v,o=q*o+V*d+P,d=m*o+J*d+v,Q=q*Q+V*e+P,e=m*Q+J*e+v,W=q*W+V*c+P,c=m*W+J*c+v,w=q*w+V*D+P,D=m*w+J*D+v,x=q*x+V*l+P,l=m*x+J*l+v}O.push(Z,B,o,d,Q,e,W,c,w,D,x,l)}R&&(b=N.getBodyColor(H)||N.getFaceBlend(H,F),b?Rk(R,b,6):Qb(R,rq,6))}},lf=function(X,L,I,Y){var I=X._picking?X.pickColorMap:null,$=X.getGL(),C=X._prg,y=X._buffer;if(!to(L)){Ac(X,cm),Rp($);var B,t,e,b;for(var h in L){var l,x,d,s,c=L[h];if(c.batch){var z=X.getBatchInfo(c.batch)||Zc;l=z.wfBloom===W?z.bloom:z.wfBloom,x=z.wfReflectable===W?z.reflectable:z.wfReflectable,d=z.wfClipboxMask===W?z.clipboxMask:z.wfClipboxMask,s=z.width}else l=c.B,x=c.reflectable,d=c.clipboxMask,s=c.W;if(!(Y&&!c.T||!Y&&c.T||X.isReflecting($)&&x===!1)){c.invalidate?(c.invalidate=!1,Wd(c,"vs"),Wd(c,"cs"),Wd(c,"ls"),Wd(c,"ps")):I&&c.ps&&c.ps._invalidateThisFrame&&(c.ps._invalidateThisFrame=!1,Wd(c,"ps")),B=c.translate,t=c.clipDirection,B||t?(e=t?sp(c.mat):[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],B&&Je(e,B),b=sp(X._6O),Ac(X,e)):e=null;var j=c.vs32,k=I?c.ps32:c.cs32;Ig($,C,s,S,y.vs,j);var n=el.for($),U=n.directUniforms(),p=n.directAttribs(),g=c.D,K=!X._dashDisabled&&g;U.uAlphaTest=D.alphaTest,$._blooming&&!l&&(U.blackout=!0),t&&(U.uClipPercent=c.clipPercent,U.uClipDirection=t),ri(X,U,d===W?Oi:d),K&&(U.uDash=!0,U.uDashDistance=g,U.uDashGapDistance=c.G,U.uDiffuse=c.A||D["color.empty"],p.aLineDistance=Lo($,y.lineDistance,c.ls32,S,1));var Q=!X._batchColorDisabled;Q&&k.length?(U.uBatchColor=!0,p.aBatchColor=Lo($,y.batchColor,k,S,4)):(U.uBatchColor=!1,p.aBatchColor=!1);var o=c.fog!==!1;o||(U.uFog=!1),jo($),Oe($,0,j.length/3,$.LINES),xj($),o||(U.uFog=!0),Q&&(U.uBatchColor=!1,p.aBatchColor=!1),K&&(U.uDash=!1,p.aLineDistance=!1),$._blooming&&!l&&(U.blackout=!1),e&&(t&&(U.uClipDirection=0),fn(X,b))}}Hb($),fn(X)}},pg=function(p){p.invalidate=!1,Wd(p,"vs"),Wd(p,"ns"),Wd(p,"cs"),Wd(p,"rs"),Wd(p,"ps"),Wd(p,"bs"),Wd(p,"uv"),Wd(p,"ms"),Wd(p,"ics")},Wl=function(b,T,x,R,O){var Y,k,P,v,m,o,g,i,M,p,y,$,V,x=b._picking?b.pickColorMap:null,r=b.getGL(),t=b._prg,Q=el.for(r),h=Q.directUniforms(),c=Q.directAttribs(),f=b._buffer;if(!to(T)&&!b.drawFilter){var I=b._flowObjects.length?b.flowMap:null;Ac(b,cm);for(k in T)if(P=b.getBatchInfo(k)||Zc,P.visible!==!1&&!(R&&!P.transparent||!R&&P.transparent||b.isReflecting(r)&&P.reflectable===!1)){var H=P.renderLayerMask;if(H==S&&(H=mn),O==S&&(O=mn),Lr(O,H)&&(v=T[k],x||!P.transparentMask)){var J=R&&P.autoSort===!0&&(b._33Q||v.invalidate);v.invalidate?pg(v):x&&v.ps&&v.ps._invalidateThisFrame&&(v.ps._invalidateThisFrame=!1,Wd(v,"ps"));var U=v.ms32,N=U&&U.length;if(o=v.vs32,g=x?v.ps32:N?v.ics32:v.cs32,p=v.uv32,i=v.bs32,M=v.rs32,$=o.length/3,J){var X=hg(o,b.getEye(),b);X?(v.is=X.is,v.elementTypeUint=X.useUint32):(v.is=null,v.elementTypeUint=null)}if($){V=v.translate,V&&Ac(b,[1,0,0,0,0,1,0,0,0,0,1,0,V[0],V[1],V[2],1]),m=P.light,y=b.getTexture(P.image),Vf(r,t,S,P.light,P.opacity,P.reverseFlip,P.reverseColor,P.reverseCull),Y=P.polygonOffset,Y&&bd(r,Y),g?b._batchColorDisabled?(h.uBatchColor=!1,c.aBatchColor=!1):(h.uBatchColor=!0,c.aBatchColor=N?$c(r,f.instancedBatchColor,g,S,4):Lo(r,f.batchColor,g,S,4)):(h.uBatchColor=!1,h.uDiffuse=P.color||D["color.empty"]);var E=P.alphaTest;h.uAlphaTest=E===W?D.alphaTest:E,h.shadowReceive=!x&&P.shadowReceive!==!1,ri(b,h,P.clipboxMask===W?Oi:P.clipboxMask),Wr(b,h,P.lightMask===W?Oi:P.lightMask,P.headlightAmbientIntensity),I&&I.resetFlowUniform(P.effectFlowMask===W?Oi:P.effectFlowMask,h),r._blooming&&!P.bloom&&(h.blackout=!0),P.envmap!==W?(h.uUseEnvMap=!0,h.uReflectivity=P.envmap,h.roughness=P.roughness||0,b._setEnvmapByProbeId(h,P.envmapProbe||0)):(h.uUseEnvMap=!1,h.uReflectivity=0);var w=i&&!b._batchBlendDisabled;w&&(h.uBatchBlend=!0,c.aBatchBlend=Lo(r,f.batchBlend,i,S));var u=M&&!b._batchBrightnessDisabled;u&&(h.uBatchBrightness=!0,c.aBatchBrightness=Lo(r,f.batchBrightness,M,S,1)),p?jo(r,t,y,P.discardSelectable,f.uv,p,P.uvOffset,P.uvScale,P.uvRotation,P.uvAnchor):jo(r),c.aPosition=Lo(r,f.vs,o,S),c.aNormal=Lo(r,f.ns,v.ns32,S),N&&(h.uUseInstance=!0,c.aMatrixInstanced=$c(r,f.ms,U,S)),v.is?(Jq(r,f.is,v.is),Yi(r,0,$,null,v.elementTypeUint?r.UNSIGNED_INT:null,null,N?v.ms32.length/16:0)):Oe(r,0,$,null,N?v.ms32.length/16:0),p?xj(r,t,y):xj(r),g&&!b._batchColorDisabled&&(h.uBatchColor=!1,c.aBatchColor=!1),w&&(h.uBatchBlend=!1,c.aBatchBlend=!1),u&&(h.uBatchBrightness=!1,c.aBatchBrightness=!1),r._blooming&&!P.bloom&&(h.blackout=!1),N&&(h.uUseInstance=!1,c.aMatrixInstanced=W),Y&&Vh(r),op(r,t),V&&fn(b)}}}fn(b)}},hg=function(v,g,t){var q=v.length/3,M=q>65535,L=t._glCapabilities.elementTypeUint&&M;if(!L&&M)return null;for(var u=new Array(q),c=q/3,x=new Array(c),$=0;c>$;$++)x[$]=$;x.sort(function(K,y){var N=9*K,A=[(v[N]+v[N+3]+2*v[N+6])/4,(v[N+1]+v[N+4]+2*v[N+7])/4,(v[N+2]+v[N+5]+2*v[N+8])/4];N=9*y;var G=[(v[N]+v[N+3]+2*v[N+6])/4,(v[N+1]+v[N+4]+2*v[N+7])/4,(v[N+2]+v[N+5]+2*v[N+8])/4],r=_h(g,A)-_h(g,G);return r>0?-1:0>r?1:0});for(var $=0;c>$;$++){var n=3*$,T=3*x[$];u[n]=T,u[n+1]=T+1,u[n+2]=T+2}return{useUint32:L,is:L?new Uint32Array(u):new rr(u)}},Ir={obj:function(w,f){var j={mat:w.mat,s3:w.s3,r3:w.r3,rotationMode:w.rotationMode,t3:w.t3,cube:w.cube==S?!0:w.cube,center:w.center==S?!0:w.center,ignoreMtls:w.ignoreMtls,ignoreTransparent:w.ignoreTransparent,ignoreColor:w.ignoreColor,ignoreImage:w.ignoreImage,ignoreNormal:w.ignoreNormal,prefix:w.prefix,flipY:w.flipY,flipFace:w.flipFace,reverseFlipMtls:w.reverseFlipMtls,finishFunc:function(W,z){if(W){var z=[];for(var a in W){var r=W[a];z.rawS3=r.rawS3,r.center&&(z.center=r.center),z.push(r),w.eachModel&&w.eachModel(a,r)}z.json=w,f(z)}else f()}};H.loadObj(w.obj,w.mtl,j)},bin:function(x,X){var I={finishFunc:function(b){b?X(b):X()}};H.loadBin(x.url,I)}};H.getModelTypeHandlers=function(){return Ir},H.setModelTypeHandler=function(y,x){Ir[y]=x},H.getModelTypeHandler=function(H){return Ir[H]},H.handleModelLoaded=function(){},H.handleUnfoundModel=function(){};var Nm=S,Cf=S,nq=function(g){Nm&&!g._loadingModelView_&&(Cf||(Cf={}),Cf[g._loadingModelView_=_j()]=g)},Ff=function(m,c){Nm||(Nm={});var n=Nm[m];if(n){if(n.url===c)return;n.request.onload=wi,n.request.onerror=wi}if(c.indexOf(".bin")===c.length-4)return Pn(m,{modelType:"bin",url:c},c);if(c=H.beforeLoadURL(c),c.data){var r=H.parse(c.data);Pn(m,r,c)}else{var R=new xc;Nm[m]={request:R,url:c},R.onload=function(){if(200===this.status||0===this.status){delete Nm[m];var y=H.parse(R.getResponseText());Pn(m,y,c)}else Kn(m,H.handleUnfoundModel(m,c)||S)},R.onerror=function(){Kn(m,H.handleUnfoundModel(m,c)||S)};var U={};U.url=encodeURI(c),U.sync=!1,R.send(U)}},Pn=function(o,d,V){var Q=d.modelType;if(!Q)return Kn(o,d),H.handleModelLoaded(o,d),void 0;var U=H.getModelTypeHandler(Q);if(U){if(Nm||(Nm={}),Nm[o])return;Nm[o]=!0;var r=function(z){z?(Kn(o,z),H.handleModelLoaded(o,z)):Kn(o,H.handleUnfoundModel(o,V,d)||S)};U(d,r)}else Kn(o,H.handleUnfoundModel(o,V,d)||S)},Kn=function(O,i){if(delete Nm[O],xd(i)&&zs.test(i))return Ff(O,i),void 0;if(yh[O]=i,to(Nm)&&(Nm=S,Cf)){for(var G in Cf){var V=Cf[G];V.invalidateAll&&V.invalidateAll(W,"modelLoaded",O),V.redraw&&V.redraw(),V.iv(),delete V._loadingModelView_}Cf=S}if(i&&Cf)for(var G in Cf){var V=Cf[G];V.invalidateAll&&V.invalidateAll(W,"modelLoading",O),V.redraw&&V.redraw(),V.iv()}},mr=new mo([0,0,0,1,1,1,1,0]),ss=new mo([0,0,1,0,0,1,0,0,1,0,0,1]),wj=new rr([0,1,2,2,3,0]),Ar=new mo([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),Ph=new rr([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),Xp=new mo([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),wo=pn(Ar,Ph),bi=(new mo([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new rr([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[Vn,sl,_k,$i,Dr,Er]),ol=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],Si=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],Ul=function(O,$,i,W,H,B,k){B=B||16,O=O||16,$=$||0,i=i||O;var r,F,d,D,y,m,g,E,L,j=.5,T=[],N=[],Q=z/O,a=X/B;for(r=0;B>r;r++)for(m=r+1,D=r*a,L=m*a,F=$;i>F;F++)g=F+1,d=F*Q,E=g*Q,T.push(j*R(D)*s(d),j*s(D),-j*R(D)*R(d),j*R(L)*s(E),j*s(L),-j*R(L)*R(E),j*R(D)*s(E),j*s(D),-j*R(D)*R(E),j*R(D)*s(d),j*s(D),-j*R(D)*R(d),j*R(L)*s(d),j*s(L),-j*R(L)*R(d),j*R(L)*s(E),j*s(L),-j*R(L)*R(E)),N.push(F/O,r/B,g/O,m/B,g/O,r/B,F/O,r/B,F/O,m/B,g/O,m/B);if(k){var M=[];for(r=0,y=T.length;y>r;r+=3)M.push(2*T[r],2*T[r+1],2*T[r+2])}if(W){var I=[],v=[];for(d=$*Q,r=0;B>r;r++)m=r+1,D=r*a,L=m*a,I.push(0,0,0,j*R(L)*s(d),j*s(L),-j*R(L)*R(d),j*R(D)*s(d),j*s(D),-j*R(D)*R(d)),v.push(0,.5,$/O,m/B,$/O,r/B)}if(H){var w=[],Z=[];for(d=i*Q,r=0;B>r;r++)m=r+1,D=r*a,L=m*a,w.push(0,0,0,j*R(D)*s(d),j*s(D),-j*R(D)*R(d),j*R(L)*s(d),j*s(L),-j*R(L)*R(d)),Z.push(1,.5,i/O,r/B,i/O,m/B)}var b={vs:T,uv:N,from_vs:I,from_uv:v,to_vs:w,to_uv:Z};return k&&(b.ns=M),b},xp=function(A,f,q){A=A||.17,f=f||12,q=q||18,0>A?A=0:A>.25&&(A=.25);var K,g,y,t,V,S,L,d=.5,F=[],$=[],b=[],r=z/q,j=z/f,n=d-A;for(g=0;f>=g;g++)for(t=-X+g*j,S=s(t),V=R(t),K=0;q>=K;K++)y=K*r,L=n+A*S,F.push(s(y)*L,V*A,-R(y)*L),$.push(K/q,1-g/f);for(g=0;f>g;g++){var Y=g*(q+1),M=(g+1)*(q+1);for(K=0;q>K;K++)b.push(Y+K,M+K+1,M+K,Y+K,Y+K+1,M+K+1)}return{vs:F,uv:$,is:b}},Mb=function(u,B,f,L,J,v,l,H){l=l||12,u=u||18,B=B||0,f=f||u,v=v||.17,0>v?v=0:v>.25&&(v=.25);var Y,$,E,Q,e,S,O,k,Z,U,n=.5,G=[],b=[],y=z/u,P=z/l,p=n-v,C=H?[]:W;for(E=0;l>E;E++)for(Q=E+1,O=-X+E*P,k=-X+Q*P,Y=B;f>Y;Y++)$=Y+1,e=Y*y,S=$*y,Z=p+v*s(O),U=p+v*s(k),G.push(s(e)*Z,R(O)*v,-R(e)*Z,s(S)*Z,R(O)*v,-R(S)*Z,s(S)*U,R(k)*v,-R(S)*U,s(e)*Z,R(O)*v,-R(e)*Z,s(S)*U,R(k)*v,-R(S)*U,s(e)*U,R(k)*v,-R(e)*U),b.push(Y/u,1-E/l,$/u,1-E/l,$/u,1-Q/l,Y/u,1-E/l,$/u,1-Q/l,Y/u,1-Q/l),H&&C.push(s(e)*s(O),R(O),-R(e)*s(O),s(S)*s(O),R(O),-R(S)*s(O),s(S)*s(k),R(k),-R(S)*s(k),s(e)*s(O),R(O),-R(e)*s(O),s(S)*s(k),R(k),-R(S)*s(k),s(e)*s(k),R(k),-R(e)*s(k));if(L){var F=[],A=[];for(E=0;l>E;E++)Q=E+1,O=-X+E*P,k=-X+Q*P,e=B*y,Z=p+v*s(O),U=p+v*s(k),F.push(s(e)*Z,R(O)*v,-R(e)*Z,s(e)*U,R(k)*v,-R(e)*U,s(e)*p,0,-R(e)*p),A.push(.5+.5*s(O),.5-.5*R(O),.5+.5*s(k),.5-.5*R(k),.5,.5)}if(J){var w=[],_=[];for(E=0;l>E;E++)Q=E+1,O=-X+E*P,k=-X+Q*P,e=f*y,Z=p+v*s(O),U=p+v*s(k),w.push(s(e)*Z,R(O)*v,-R(e)*Z,s(e)*p,0,-R(e)*p,s(e)*U,R(k)*v,-R(e)*U),_.push(.5-.5*s(O),.5-.5*R(O),.5,.5,.5-.5*s(k),.5-.5*R(k))}var M={vs:G,uv:b,from_vs:F,from_uv:A,to_vs:w,to_uv:_};return H&&(M.ns=C),M},dq=function(n,F){for(var S,K,m,c,P,f=.5,d=16,i=[],l=[],D=[],B=[],Z=z/d,G=0;d>=G;G++)S=G*Z,K=s(S),c=K*f,m=R(S),P=m*f,i.push(c,-f,P,c,f,P),D.push(K,0,m,K,0,m),l.push(1-G/d,1,1-G/d,0);for(G=0;d>G;G++)B.push(2*G,2*G+1,2*G+3,2*G,2*G+3,2*G+2);if(F){var r=[],q=[],w=[];for(r.push(0,-f,0),q.push(.5,.5),G=0;d>=G;G++)S=G*Z,K=s(S),m=R(S),r.push(K*f,-f,-m*f),q.push(.5+.5*K,.5+.5*m);for(G=0;d>G;G++)w.push(0,G+2,G+1)}if(n){var V=[],E=[],p=[];for(V.push(0,f,0),E.push(.5,.5),G=0;d>=G;G++)S=G*Z,K=s(S),m=R(S),V.push(K*f,f,-m*f),E.push(.5+.5*K,.5-.5*m);for(G=0;d>G;G++)p.push(0,G+1,G+2)}return{vs:i,uv:l,is:B,ns:D,bottom_vs:r,bottom_uv:q,bottom_is:w,top_vs:V,top_uv:E,top_is:p}},zp=function(g,I,v,F,d,h,V,o){g=g||12,I=I||0,v=v||g;for(var $,k,G,P,u,e,p,K,A,W=.5,r=[],Y=[],n=z/g,M=I;v>M;M++)$=M+1,k=M*n,G=$*n,P=s(k)*W,u=R(k)*W,e=s(G)*W,p=R(G)*W,r.push(P,-W,-u,e,-W,-p,P,W,-u,e,-W,-p,e,W,-p,P,W,-u),Y.push(M/g,1,$/g,1,M/g,0,$/g,1,$/g,0,M/g,0);if(o){var L=[];for(M=0,A=r.length;A>M;M+=3)L.push(2*r[M],0,2*r[M+2])}if(V){var b=[],D=[];for(M=I;v>M;M++)k=n*M,G=n*(M+1),P=s(k),u=R(k),e=s(G),p=R(G),b.push(P*W,-W,-u*W,0,-W,0,e*W,-W,-p*W),D.push(.5+.5*P,.5+.5*u,.5,.5,.5+.5*e,.5+.5*p)}if(h){var B=[],H=[];for(M=I;v>M;M++)k=n*M,G=n*(M+1),P=s(k),u=R(k),e=s(G),p=R(G),B.push(P*W,W,-u*W,e*W,W,-p*W,0,W,0),H.push(.5+.5*P,.5-.5*u,.5+.5*e,.5-.5*p,.5,.5)}if(F){var Z=[],q=[];k=n*I,P=s(k)*W,u=R(k)*W,K=I/g,Z.push(0,W,0,0,-W,0,P,-W,-u,P,-W,-u,P,W,-u,0,W,0),q.push(0,0,0,1,K,1,K,1,K,0,0,0)}if(d){var w=[],m=[];k=n*v,P=s(k)*W,u=R(k)*W,K=v/g,w.push(0,-W,0,0,W,0,P,W,-u,P,W,-u,P,-W,-u,0,-W,0),m.push(1,1,1,0,K,0,K,0,K,1,1,1)}var U={vs:r,uv:Y,bottom_vs:b,bottom_uv:D,top_vs:B,top_uv:H,from_vs:Z,from_uv:q,to_vs:w,to_uv:m};return o&&(U.ns=L),U},vq=function(a,$,W,_,g){$=$||18,W=W||0,_=_==S?z:_,g=g==S?.5:g;for(var T,t,y,j,c,k,x=[0,.5,.75,.875,.9375],Q=[],I=[],e=[],V=_/$,n=0;n<x.length;n++){var p=0===n%2?0:.5;for(T=0;$>=T;T++)t=(T+p)*V+W,y=1-x[n],Q.push(s(t)*g*y,-g+2*x[n]*g,-R(t)*g*y),I.push((T+p)/$,y)}for(n=0;n<x.length-1;n++){var o=n*($+1),w=(n+1)*($+1);for(T=0;$>T;T++)e.push(o+T,w+T+1,w+T,o+T,o+T+1,w+T+1)}for(k=Q.length/3-($+1),T=0;$>T;T++)Q.push(0,g,0),I.push((T+.5)/$,0);for(T=0;$>T;T++)e.push(k+T,k+T+1,k+($+1)+T);if(a){var N=[],X=[],l=[];for(N.push(0,-g,0),X.push(.5,.5),T=0;$>=T;T++)t=T*V+W,j=s(t),c=R(t),N.push(j*g,-g,-c*g),X.push(.5+.5*j,.5+.5*c);for(T=0;$>T;T++)l.push(0,T+2,T+1)}return{vs:Q,uv:I,is:e,bottom_vs:N,bottom_uv:X,bottom_is:l}},hc=function(X,d,G,y,m,q,h,r){X=X||16,d=d||0,G=G||X,h=h||1;var J,E,L,N,$,b,t,v=.5,A=[],a=[],B=z/X,Q=d,T=1/h,E=new se,L=new se,x=new se,f=new se,D=new se,o=new se,F=new se;for(r&&(J=[],$=new se,b=new se,t=new se);G>Q;Q++){var S=Q+1,u=B*Q,U=B*S;for(E.set(s(u)*v,-v,-R(u)*v),L.set(s(U)*v,-v,-R(U)*v),x.set(0,v,0),r&&($.set(s(u),.5,-R(u)).normalize(),b.set(s(U),.5,-R(U)).normalize(),t.copy($).add(b).normalize()),f.lerpVectors(x,E,T),D.lerpVectors(x,L,T),A.push(f.x,f.y,f.z,D.x,D.y,D.z,x.x,x.y,x.z),a.push(Q/X,T,S/X,T,(Q+S)/2/X,0),r&&J.push($.x,$.y,$.z,b.x,b.y,b.z,t.x,t.y,t.z),N=1;h>N;N++)f.lerpVectors(x,E,T*(N+1)),D.lerpVectors(x,L,T*(N+1)),o.lerpVectors(x,E,T*N),F.lerpVectors(x,L,T*N),A.push(f.x,f.y,f.z,D.x,D.y,D.z,o.x,o.y,o.z,o.x,o.y,o.z,D.x,D.y,D.z,F.x,F.y,F.z),a.push(Q/X,T*(N+1),S/X,T*(N+1),Q/X,T*N,Q/X,T*N,S/X,T*(N+1),S/X,T*N),r&&J.push($.x,$.y,$.z,b.x,b.y,b.z,$.x,$.y,$.z,$.x,$.y,$.z,b.x,b.y,b.z,b.x,b.y,b.z)}if(q){var V=[],g=[];for(Q=d;G>Q;Q++){u=B*Q,U=B*(Q+1);var K=s(u),p=R(u),_=s(U),M=R(U);V.push(K*v,-v,-p*v,0,-v,0,_*v,-v,-M*v),g.push(.5+.5*K,.5+.5*p,.5,.5,.5+.5*_,.5+.5*M)}}if(y){var W=[],k=[];u=B*d,W.push(0,v,0,0,-v,0,s(u)*v,-v,-R(u)*v),k.push(0,0,0,1,d/X,1)}if(m){var l=[],w=[];u=B*G,l.push(0,-v,0,0,v,0,s(u)*v,-v,-R(u)*v),w.push(1,1,1,0,G/X,1)}var H={vs:A,uv:a,bottom_vs:V,bottom_uv:g,from_vs:W,from_uv:k,to_vs:l,to_uv:w};return r&&(H.ns=J),H},wq=function(g,s,v,J,d,W,o,c){for(var w=[],E=0;E<g.length-1;E+=2)w.push({x:g[E],y:g[E+1]});return Go(w,s,v,J,d,W,o,c,!1)},vj={roundRect:function(i,X){return wq([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],i,X,3)},star:function(o,J){return wq([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],o,J)},rect:function(s,o){return wq([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],s,o)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(B,f){return wq([0,-.5,.5,.5,-.5,.5],[1,2,2,5],B,f)},rightTriangle:function(X,p){return wq([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],X,p)},parallelogram:function(c,Z){return wq([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],c,Z)},trapezoid:function(q,f){return wq([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],q,f)}},Yp={sphere:1,cylinder:1,cone:1,torus:1},mg={torus:1,sphere:1,cone:1},kg=kk(Dl(vj),{cylinder:1}),rk=kk(Dl(vj),{cylinder:1,cone:1}),yn=function(G,L,S){var C,A=dd(G.anchor3d,S,L),r=dd(G.mat,S,L),e=dd(G.s3,S,L),H=dd(G.t3,S,L),E=dd(G.r3,S,L),N=e||E||H||r;if(A||N){C=sp(L._6O);var c=N?um(r,e,E,dd(G.rotationMode,S,L),H):Pb();A&&Je(c,[.5-A[0],.5-A[1],.5-A[2]]),Ac(L,c)}return C},Wc=function(m,$,r,u,x,y,z){if(Td(r))r.forEach(function(p){Wc(m,$,p,u,x,y,z)});else if(xd(r))Wc(m,$,ze(u,r),u,x,y,z);else if(Il(r))if(r.shape3d){var e=yn(r,m,$);Wc(m,$,r.shape3d,u,x,y,r),e&&fn(m,e)}else El(m,$,r,u.s,x,y,z)},El=function(l,G,N,U,k,o,y){if(y=y||Zc,!o||o(U("shape3d.transparent",N.transparent,y.transparent))){var t=yn(N,l,G);if(Sm(N)){var E=l.getData3dUI(G);E.dispatchBoundingBoxChanged()}var Y=l._26I,L=l._prg,d=l._buffer,I=U("shape3d.color",N.color,y.color);k||(k=U("shape3d.blend",N.blend,y.blend));var D,x=N.opacity==S?y.opacity:N.opacity,b=U("shape3d.opacity");D=b!=S&&x!=S?x*b:x!=S?x:b,Vf(Y,L,k,U("shape3d.light",N.light,y.light),D,U("shape3d.reverse.flip",N.reverseFlip,y.reverseFlip),U("shape3d.reverse.color",N.reverseColor,y.reverseColor),U("shape3d.reverse.cull",N.reverseCull,y.reverseCull));var m=U("polygonOffset",N.polygonOffset,y.polygonOffset);N.vs&&U(zb,N.visible,y.visible)&&Pd(Y,L,d,I,l.getTexture(U("shape3d.image",N.image,y.image),G),U("shape3d.discard.selectable",N.discardSelectable,y.discardSelectable),N.vs,N.uv,N.ns,N.is,U("shape3d.uv.offset",N.uvOffset,y.uvOffset),U("shape3d.uv.scale",N.uvScale,y.uvScale),U("shape3d.uv.rotation",N.uvRotation,y.uvRotation),U("shape3d.uv.anchor",N.uvAnchor,y.uvAnchor),m),N.top_vs&&U(ob,N.topVisible,y.topVisible)&&Pd(Y,L,d,U("shape3d.top.color",N.topColor,y.topColor)||I,l.getTexture(U("shape3d.top.image",N.topImage,y.topImage),G,"top"),U("shape3d.top.discard.selectable",N.topDiscardSelectable,y.topDiscardSelectable),N.top_vs,N.top_uv,N.top_ns,N.top_is,U("shape3d.top.uv.offset",N.topUvOffset,y.topUvOffset),U("shape3d.top.uv.scale",N.topUvScale,y.topUvScale),U("shape3d.top.uv.rotation",N.topUvRotation,y.topUvRotation),U("shape3d.top.uv.anchor",N.topUvAnchor,y.topUvAnchor),m),N.bottom_vs&&U(_l,N.bottomVisible,y.bottomVisible)&&Pd(Y,L,d,U("shape3d.bottom.color",N.bottomColor,y.bottomColor)||I,l.getTexture(U("shape3d.bottom.image",N.bottomImage,y.bottomImage),G,"bottom"),U("shape3d.bottom.discard.selectable",N.bottomDiscardSelectable,y.bottomDiscardSelectable),N.bottom_vs,N.bottom_uv,N.bottom_ns,N.bottom_is,U("shape3d.bottom.uv.offset",N.bottomUvOffset,y.bottomUvOffset),U("shape3d.bottom.uv.scale",N.bottomUvScale,y.bottomUvScale),U("shape3d.bottom.uv.rotation",N.bottomUvRotation,y.bottomUvRotation),U("shape3d.bottom.uv.anchor",N.bottomUvAnchor,y.bottomUvAnchor),m),N.from_vs&&U(kn,N.fromVisible,y.fromVisible)&&Pd(Y,L,d,U("shape3d.from.color",N.fromColor,y.fromColor)||I,l.getTexture(U("shape3d.from.image",N.fromImage,y.fromImage),G,"from"),U("shape3d.from.discard.selectable",N.fromDiscardSelectable,y.fromDiscardSelectable),N.from_vs,N.from_uv,N.from_ns,N.from_is,U("shape3d.from.uv.offset",N.fromUvOffset,y.fromUvOffset),U("shape3d.from.uv.scale",N.fromUvScale,y.fromUvScale),U("shape3d.from.uv.rotation",N.fromUvRotation,y.fromUvRotation),U("shape3d.from.uv.anchor",N.fromUvAnchor,y.fromUvAnchor),m),N.to_vs&&U(qh,N.toVisible,y.toVisible)&&Pd(Y,L,d,U("shape3d.to.color",N.toColor,y.toColor)||I,l.getTexture(U("shape3d.to.image",N.toImage,y.toImage),G,"to"),U("shape3d.to.discard.selectable",N.toDiscardSelectable,y.toDiscardSelectable),N.to_vs,N.to_uv,N.to_ns,N.to_is,U("shape3d.to.uv.offset",N.toUvOffset,y.toUvOffset),U("shape3d.to.uv.scale",N.toUvScale,y.toUvScale),U("shape3d.to.uv.rotation",N.toUvRotation,y.toUvRotation),U("shape3d.to.uv.anchor",N.toUvAnchor,y.toUvAnchor),m),op(Y,L),t&&fn(l,t)}},Pd=function(W,M,U,J,T,R,x,I,X,d,Z,Q,n,m,i){if(x){i&&bd(W,i);var h=el.for(W),K=h.directUniforms(),$=h.directAttribs();K.uDiffuse=J||D["color.empty"],I?jo(W,M,T,R,U.uv,I,Z,Q,n,m):jo(W),$.aPosition=Lo(W,U.vs,x,S),$.aNormal=Lo(W,U.ns,X,S),d?(gl(W,U.is,d),Yi(W,0,d.length,null,d instanceof Uint32Array?W.UNSIGNED_INT:null)):Oe(W,0,x.length/3),I?xj(W,M,T):xj(W),i&&Vh(W)}},ze=function(V,E){var c=V.s;if(E||(E=c(Cd)),!E)return S;var i=Wq(E);if(i)return i;if("text"===E){var v={amount:c("shape3d.text.amount"),size:c("shape3d.text.size"),font:c("shape3d.text.font"),style:c("shape3d.text.style"),weight:c("shape3d.text.weight"),fill:c("shape3d.text.fill"),curveSegments:c("shape3d.text.curveSegments"),spacing:c("shape3d.text.spacing"),cube:c("shape3d.text.cube")},B=V.gv.getShape3dText(V.data),h=B;for(var Q in v)h+="_"+(v[Q]===W?"U":v[Q]);return V._cachedTextKey===h?V._cachedTextGeometry:(V._cachedTextKey=h,V._cachedTextGeometry=H.createTextGeometry(B,v))}var Q=E;if(Yp[E]){var p=c("shape3d.side"),F=c("shape3d.side.from"),Z=c("shape3d.side.to"),K=c(kn),A=c(qh);3>p?(p=0,F=0,Z=0,K=!1,A=!1):((F==S||0>F)&&(F=0),(Z==S||Z>p)&&(Z=p),0===F&&Z===p&&(K=!1,A=!1));var f=c("shape3d.smooth");Q+="-"+p+"-"+F+"-"+Z+"-"+K+"-"+A+(f?1:0)}if(kg[E]){var N=c(ob);Q+="-"+N}if(rk[E]){var g=c(_l);Q+="-"+g}if("torus"===E){var l=c("shape3d.torus.radius");0>l?l=0:l>.25&&(l=.25),Q+="-"+l}if(mg[E]){var y=c(Kc);Q+="-"+y}return i=Uo[Q],i||("box"===E?i=H.createBoxModel():vj[E]?i=vj[E](N,g):"sphere"===E?i=H.createSphereModel(p,F,Z,K,A,y,f):E===gs?i=H.createCylinderModel(p,F,Z,K,A,N,g,f):"cone"===E?i=H.createConeModel(p,F,Z,K,A,g,y,f):"torus"===E&&(i=H.createTorusModel(p,F,Z,K,A,l,y,f)),Uo[Q]=i),i},Sm=function(){var k=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],d=["is","top_is","bottom_is","from_is","to_is"];return u=fi(ao.substr(ao.indexOf("^#")+2)),Ze(H[lc(Ql+k[15]+"n"+k[16])]())&&Ik()?function(v){return v&&!v._complete_?(v._complete_=!0,v.vs&&bg(v.ns)&&(v.ns=pn(v.vs,v.is),v.boundingBox=W),v.top_vs&&bg(v.top_ns)&&(v.top_ns=pn(v.top_vs,v.top_is),v.top_boundingBox=W),v.bottom_vs&&bg(v.bottom_ns)&&(v.bottom_ns=pn(v.bottom_vs,v.bottom_is),v.bottom_boundingBox=W),v.from_vs&&bg(v.from_ns)&&(v.from_ns=pn(v.from_vs,v.from_is),v.from_boundingBox=W),v.to_vs&&bg(v.to_ns)&&(v.to_ns=pn(v.to_vs,v.to_is),v.to_boundingBox=W),k.forEach(function(H){var V=v[H];Td(V)&&(v[H]=new mo(V))}),d.forEach(function(W){var n=v[W];Td(n)&&(v[W]=new rr(n))}),!0):!1}:void 0}(),Nk=function(q,x){var w=q[x];Td(w)&&(q[x]=new mo(w))};kk(Ep,{_25Q:function($){var B=new se;$._16O=function(j,w,n,S,u,C,v,f,Q){var a=this.info;if(a){var H,M,p,d,N,k,e=Pb();Th[w]?(H=a.p3,M=a.c1,p=a.c2):ug[w]?(M=a.s1||a.c1,p=a.s2||a.c2):(M=a.t1||a.c1,p=a.t2||a.c2);var J=this.data;if(J instanceof qb&&this.shapeModel){var g=J.getPointsMatrix3d();H&&(H=B.copy(H).applyMatrix4(g).toArray()),M&&(M=B.copy(M).applyMatrix4(g).toArray()),p&&(p=B.copy(p).applyMatrix4(g).toArray())}var s=0;if(M&&p){var E=Od(p,M);s=_h(M,p),d=[0,-db(E[2],E[0]),U(E[1]/s)],N="zyx",H||(H=[(M[0]+p[0])/2,(M[1]+p[1])/2,(M[2]+p[2])/2])}return k=Zd(w,[s,0,0],n,S,f,Q),Be(e,k,H,S,u,C,v,j,d,N)}return js},$._80o=function(W,r,u){var l=this,I=l.shapeModel;if(I){var i=l.gv;Ac(i),Wc(i,l.data,I,l,l.getBodyColor(),u)}},$.createLineModel=function(I,n,L,d,b){var x=this,H=x.s,Q=Ne(I,n,H(Kc)),w=H(d+".color");
if(w){for(var m=[],p=0;p<Q.length;p++){var f=Q[p],X=f.length;if(X>1){var r=f[0];m.push(r.x,r.y,r.z);for(var j=1;X-1>j;j++)r=f[j],m.push(r.x,r.y,r.z),m.push(r.x,r.y,r.z);r=f[X-1],m.push(r.x,r.y,r.z)}}var J,l,_,s=H(b),N=0;s&&(l=H(b+".color"),J=H(b+".pattern"),N=H(b+".offset"),_=w),uf(x.gv,x.data,m,l||w,_?S:H(d+".gradient.color"),L,J||H(d+".pattern"),N,_)}return Q},$.createTubeModel=function(H,o,W,j){for(var I=this,e=I.s,X=e("shape3d.side")||pb,t=e("shape3d.start.angle"),G=e("shape3d.sweep.angle"),k=e(ob)?e("shape3d.top.cap"):S,R=e(_l)?e("shape3d.bottom.cap"):S,P=e("3d.clip.direction"),m="flat"===k,z="flat"===R,s=m&&(j?j.uv:e("shape3d.top.image")),_=z&&(j?j.uv:e("shape3d.bottom.image")),O=j?j.uv:e("shape3d.image")||"uv.left"===P||"uv.right"===P,U=e("shape3d.smooth"),r={vs:[],uv:O?[]:S,ns:U?[]:S,top_vs:m?[]:S,top_uv:s?[]:S,bottom_vs:z?[]:S,bottom_uv:_?[]:S},c=Ne(H,o,e(Kc),W),J=0,E=c.length,D=0,Y=e("shape3d.uv.union");E>J;J++)Y!==!0&&(D=0),D=gf(r,c[J],e(cp),W,X,t,G,k,R,D);if(j){var V=I._matWithExtraction||I.mat;Ud(I.gv,I.data,r,I,I.getBodyColor(),V?[V]:[],j)}else I.shapeModel=r;I.lineShapeModel=r;var x=I._vsTranslation;if(x)for(var J=0,h=c.length;h>J;J++)for(var w=0,v=c[J].length;v>w;w++)c[J][w]=c[J][w].clone().applyMatrix4(x);return c},$.getCache=function(){var H=this.info;if(H){var V=H.list;if(V){var Z=H.cache;return Z||(Z=H.cache=Mp(V)),Z}}return S}}});var Nb=function(V,G){for(var H,K=0,E=V.length,s=0,e=E-1;e>=s;)if(K=j(s+(e-s)/2),H=V[K].length-G,0>H)s=K+1;else{if(!(H>0)){e=K;break}e=K-1}K=e;var v=V[K],b=v.point;return K===E-1||v.length===G||(b=(new er).subVectors(V[K+1].point,b).normalize().multiplyScalar(G-v.length).add(b)),{point:b,tangent:v.tangent}},Mp=function(V){for(var y,K,g=[],i=0,L=0;L<V.length;L++){for(var Z=V[L],P=0;P<Z.length;P++){y=Z[P],K&&(i+=K.distanceTo(y));var x=new er,N=Z[P+1];N?x.subVectors(N,y):K?x.subVectors(y,K):x.x=1,x.normalize(),g.push({point:y,length:i,tangent:x}),K=y}K=null}return g},Ne=function(y,u,m,o){m=m||Rc;for(var I=[],e=0,p=y.size();p>e;e++){var z=y.get(e);I.push(new er(z.x,z.e||0,z.y))}u&&(No(u)&&(u=u._as),u.length||(u=null));for(var q,G,N,s,F,j=[],$=[],K=0,h=0,E=u?u.length:p;E>h;h++){if(F=u?u[h]:0===h?1:2,1===F)j.push(N=[]),N.push(I[K++]);else if(2===F||5===F)if(s=2===F?I[K++]:N[0],o){var V=u?u[h+1]:E>h+1?2:S;if(2===V||5===V){var d=N[N.length-1],U=2===V?I[K]:N[0],J=(new er).subVectors(d,s),Z=(new er).subVectors(U,s),D=J.length(),Y=Z.length();if(D&&Y)if(o>D/2&&o>Y/2)N.push(s);else for(J.multiplyScalar(_(o,D/2)/D).add(s),Z.multiplyScalar(_(o,Y/2)/Y).add(s),q=new vn(J,s,Z).getPoints(m),G=0;m>=G;G++)N.push(q[G])}else N.push(s)}else N.push(s);else if(3===F)for(q=new vn(N[N.length-1],I[K++],I[K++]).getPoints(m),G=1;m>=G;G++)N.push(q[G]);else if(4===F)for(q=new ab(N[N.length-1],I[K++],I[K++],I[K++]).getPoints(m),G=1;m>=G;G++)N.push(q[G]);$.push(j.length,N.length)}return j.indexMark=$,j},im=function(y){for(var j,k,w=new er,s=[],G=[],W=[],V=0,X=y.length;X>V;V++)j=y[V],k=y[V+1],k?w.subVectors(k,j):w.subVectors(j,y[V-1]),s.push(w.normalize().clone());var t,M=new er,P=new er,J=new xn,Q=1e-4,R=s[0],T=G[0]=new er,Y=W[0]=new er;for(Math.abs(Math.abs(R.y)-1)<Q?M.set(1,0,0):M.set(0,1,0),P.crossVectors(R,M).normalize(),T.crossVectors(R,P),Y.crossVectors(R,T),V=1;X>V;V++)G[V]=G[V-1].clone(),W[V]=W[V-1].clone(),P.crossVectors(s[V-1],s[V]),P.length()>Q&&(P.normalize(),t=d(Ki(s[V-1].dot(s[V]),-1,1)),G[V].applyMatrix4(J.makeRotationAxis(P,t))),W[V].crossVectors(s[V],G[V]);return{B:W,T:s,N:G}},gf=function(){var N=function(M){for(var L=1;L<arguments.length;L++){var t=arguments[L];M.push(t.x,t.y,t.z)}},$=function(a){for(var x=1;x<arguments.length;x++){var D=arguments[x].uv;a.push(D[0],D[1])}},H=function(g){for(var x=1;x<arguments.length;x++){var R=arguments[x].ns;g.push(R[0],R[1],R[2])}},Y=function(c,y,v,Q,K){var m=-Q*s(K),C=Q*R(K);return new er(c.x+m*v.x+C*y.x,c.y+m*v.y+C*y.y,c.z+m*v.z+C*y.z)},F=function(P,i,B,s,r,O,n,N,p){n=n||z;for(var v,f=[],M=n/r,v=p?new se:S,W=0;r>=W;W++){var g=Y(P,i,B,s,W*M+O);f.push(g),N!=S&&(g.uv=[N,1-W/r]),p&&(g.ns=v.subVectors(g,P).normalize().toArray())}return f},U=function(J,w,M,Z,B,r,c,I,a){a=a||z;var K=w?J.top_vs:J.bottom_vs;if(K)for(var v=w?J.top_uv:J.bottom_uv,n=a/c,V=0;c>V;V++){var m,h;w?(m=V*n+I,h=(V+1)*n+I):(h=V*n+I,m=(V+1)*n+I),N(K,Y(M,Z,B,r,m),Y(M,Z,B,r,h),M),v&&v.push(.5-.5*s(m),.5-.5*R(m),.5-.5*s(h),.5-.5*R(h),.5,.5)}};return function(h,j,n,A,i,C,r,B,P,p){var R=j.length;if(R>1){var Z,e,Y,o,I,O,z,M=im(j),T=M.T,v=M.N,t=M.B;"flat"===B&&U(h,!0,j[0],t[0],v[0],A,i,C,r),"flat"===P&&U(h,!1,j[R-1],t[R-1],v[R-1],A,i,C,r);var f,V,L=[],w=k(i/2),y="round"===B,a="round"===P,s=j[0],X=T[0],K=t[0],q=v[0],E=j[R-1],b=T[R-1],d=t[R-1],g=v[R-1];if(y){for(Y=1;w>=Y;Y++)v.splice(0,0,q),t.splice(0,0,K),T.splice(0,0,X),V=-Y/w*A,j.splice(0,0,X.clone().multiplyScalar(V).add(s)),L[w-Y]=x(A*A-V*V);R+=w}if(a){for(Y=1;w>=Y;Y++)v.push(g),t.push(d),T.push(b),V=Y/w*A,j.push(b.clone().multiplyScalar(V).add(E)),L[j.length-1]=x(A*A-V*V);R+=w}if(h.uv){var l=0,u=p,_=[];for(n&&(l=n),I=j[0],_[0]=0,Y=1;R>Y;Y++)o=j[Y],_[Y]=I.distanceTo(o),I=o,n||(l+=_[Y]);for(f=[],Y=0;R>Y;Y++)u+=_[Y],f[Y]=l?u/l:0;p=u}var J=h.ns?!0:!1;for(Y=0;R>Y;Y++){if(o=j[Y],O=t[Y],z=v[Y],Z=F(o,O,z,L[Y]===W?A:L[Y],i,C,r,f?f[Y]:S,J),e)for(var D=0;i>D;D++){var c=e[D],Q=e[D+1]||e[0],G=Z[D],m=Z[D+1]||Z[0];N(h.vs,Q,c,G,G,m,Q),h.uv&&$(h.uv,Q,c,G,G,m,Q),J&&H(h.ns,Q,c,G,G,m,Q)}e=Z}}return p}}();kk(H,{getLineLength:function(a){return a[a.length-1].length},getLineOffset:function(P,y){return Nb(P,y)},getLineCacheInfo:function(_,U,F,m){return Mp(Ne(_,U,F,m))}});var co=n.graph3d.RenderLite={},Vq=new Array(0),Mm=co.Buffer=function(H,x,s,R){this.gl=H,this.buffer=H.createBuffer(),this.type=x||H.ARRAY_BUFFER,this.drawType=R||H.STATIC_DRAW,this.data=Vq,s&&this.upload(s)};Mm.prototype.upload=function(Q,B,z){z||this.bind();var Z=this.gl;Q=Q||this.data,B=B||0,this.data.byteLength>=Q.byteLength?Z.bufferSubData(this.type,B,Q):Z.bufferData(this.type,Q,this.drawType),this.data=Q},Mm.prototype.bind=function(){var k=this.gl;k.bindBuffer(this.type,this.buffer)},Mm.createVertexBuffer=function(u,x,J){return new Mm(u,u.ARRAY_BUFFER,x,J)},Mm.createIndexBuffer=function(z,u,y){return new Mm(z,z.ELEMENT_ARRAY_BUFFER,u,y)},Mm.create=function(Q,e,x,v){return new Mm(Q,e,v)},Mm.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var gb=co.Shader=function(A,p,K){this.gl=A,this.program=ud(A,p,K),this.attributes=Cn(A,this.program);var J=Gg(A,this.program);this.uniforms=Eb(A,J)};gb.prototype.bind=function(){this.gl.useProgram(this.program)},gb.prototype.destroy=function(){this.gl};var ud=function(Q,q,D){var C=Cj(Q,Q.VERTEX_SHADER,q),m=Cj(Q,Q.FRAGMENT_SHADER,D),P=Q.createProgram();return Q.attachShader(P,C),Q.attachShader(P,m),Q.linkProgram(P),Q.getProgramParameter(P,Q.LINK_STATUS)||(vk("LINK","LITE",Q.getProgramParameter(P,Q.VALIDATE_STATUS),Q.getError(),Q.getProgramInfoLog(P)),Q.deleteProgram(P),P=null),Q.deleteShader(C),Q.deleteShader(m),P},Cj=function(O,R,S){var l=O.createShader(R);return O.shaderSource(l,S),O.compileShader(l),O.getShaderParameter(l,O.COMPILE_STATUS)?l:(vk("COMPILE","LITE",R,O.getError(),O.getShaderInfoLog(l)),null)},Gg=function(g,n){for(var b={},u=g.getProgramParameter(n,g.ACTIVE_UNIFORMS),F=0;u>F;F++){var C=g.getActiveUniform(n,F),M=C.name.replace(/\[.*?\]/,""),U=ec(g,C.type);b[M]={type:U,size:C.size,location:g.getUniformLocation(n,M),value:xb(U,C.size)}}return b},Cn=function(E,c){for(var X={},t=E.getProgramParameter(c,E.ACTIVE_ATTRIBUTES),H=0;t>H;H++){var s=E.getActiveAttrib(c,H),S=ec(E,s.type);X[s.name]={type:S,size:md(S),gl:E,location:E.getAttribLocation(c,s.name),pointer:Zp}}return X},Zp=function(K,Y,z,l,f){var R=this.gl;R.enableVertexAttribArray(this.location),K instanceof co.Buffer||(K=co.Buffer.createVertexBuffer(R,K)),R.bindBuffer(K.type,K.buffer),R.vertexAttribPointer(this.location,this.size,Y||R.FLOAT,z||!1,l||0,f||0)},md=function(P){return xm[P]},xm={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},ec=function(O,m){if(!$r){var N=o.keys(Nj);$r={};for(var K=0;K<N.length;++K){var $=N[K];$r[O[$]]=Nj[$]}}return $r[m]},$r=null,Nj={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},xb=function(Y,c){switch(Y){case"float":return 0;case"vec2":return new Float32Array(2*c);case"vec3":return new Float32Array(3*c);case"vec4":return new Float32Array(4*c);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*c);case"ivec3":return new Int32Array(3*c);case"ivec4":return new Int32Array(4*c);case"bool":return!1;case"bvec2":return Xq(2*c);case"bvec3":return Xq(3*c);case"bvec4":return Xq(4*c);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},Xq=function(I){for(var S=new Array(I),z=0;z<S.length;z++)S[z]=!1;return S},Eb=function(r,I){var F={data:{}};F.gl=r;for(var f=o.keys(I),Y=0;Y<f.length;Y++){var C=f[Y],x=C.split("."),O=x[x.length-1],G=Co(x,F),Z=I[C];G.data[O]=Z,G.gl=r,o.defineProperty(G,O,{get:Ab(O),set:nj(O,Z)})}return F},Ab=function(N){var l=ws.replace("%%",N);return new Function(l)},nj=function(Y,H){var l,j=br.replace(/%%/g,Y);return l=1===H.size?Pq[H.type]:Cm[H.type],l&&(j+="\nthis.gl."+l+";"),new Function("value",j)},Co=function(V,C){for(var K=C,J=0;J<V.length-1;J++){var i=K[V[J]]||{data:{}};K[V[J]]=i,K=i}return K},ws=["return this.data.%%.value;"].join("\n"),br=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),Pq={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},Cm={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},ln=function(Q){function t(_){if("string"!=typeof _)return 0|_;switch(_){case"low":return 512;case"medium":return 1024;case"ultra":return 4096;default:return 2048}}function v(){z.enable=!H.graph3dViewShadowDisabled,k=H.graph3dViewShadowType,P=H.graph3dViewShadowIntensity,F=H.graph3dViewShadowBias,Y=H.graph3dViewShadowQuality,c=H.graph3dViewShadowRadius,f=H.graph3dViewShadowDegreeX,$=H.graph3dViewShadowDegreeZ}var z=this;z.enable=!1;var k,P,F,Y,c,f,$;v();var Z,e,r,g,j=1,R=t(Y),I=!1,N=new n.Math.Matrix4,m=new n.Math.Matrix4,O=z.pvMatrix=new n.Math.Matrix4,V=0;z.contextLost=function(){z.mapForReflector=null,z.map=null;var Y=Q.getGL();Y&&(Y._shadowShader=null)},z.render=function(){if(!Q._picking&&z.enable){var S=Q.getGL();if(S){if(I&&z.setupShadowCamera(),Q._glCapabilities&&(R=Math.min(R,Q._glCapabilities.maxTextureSize)),g=Q.isReflecting(S)){if(V===S._renderInfo.frame)return;V=S._renderInfo.frame}var w=g?"mapForReflector":"map";if((Z=z[w])?Z.setSize(R,R):Z=z[w]=new Ms(Q,Q.getGL(),0,0,{samples:1,minFilter:Of.NEAREST,magFilter:Of.NEAREST,width:R,height:R}),!S._shadowShader){var P="#define MAX_BOX_CLIPPER "+Q._boxClippers.length;S._shadowShader=new co.Shader(S,ln.shaderSrc.vs.replace("$DEFINE",P),ln.shaderSrc.fs.replace("$DEFINE",P))}var x=Q._frameState,_=x.renderState.glState;_.blend.enabled=!1,_.depth.enabled=!0,_.depth.mask=!0;var k=_.color.clear.slice(0);uq(S,[1,1,1,1]),x.renderState.useProgram(S._shadowShader.program),D(),uq(S,k)}}},z.deleteShadowProgram=function(){var v=Q.getGL();v&&v._shadowShader&&(v.deleteProgram(v._shadowShader.program),v._shadowShader=null)},z.getShadow=function(){var v={degreeX:f,degreeZ:$,intensity:P,quality:Y,type:k,radius:c,bias:F};return 1!==j&&(v.boundExtend=j),v},z.setShadow=function(T,V){T=!!T;var u=z.enable!==T;z.enable=T,"object"==typeof V&&(V.intensity!==W&&(P=V.intensity),V.bias!==W&&(F=V.bias),V.radius!==W&&(c=V.radius),V.degreeX!==W&&(f=V.degreeX),V.degreeZ!==W&&($=V.degreeZ),V.quality!==W&&(Y=V.quality),V.type!==W&&k!==V.type&&(k=V.type,u=!0),R=t(Y),V.boundExtend!==W&&(j=V.boundExtend)),T&&z.setupShadowCamera(),u&&ms(Q),Q.iv()};var J=null;z.tryInvalidateLater=function(j,B){"modelLoaded"===B&&(J&&sd(J,!0),J=Pm(function(){J=null,z.refresh()},z,W,200))},z.refresh=function(){this.enable&&(this.setupShadowCamera(),Q.iv())},z.tryUpdateBounding=function(X){var I=this.boundingSphere;if(I){var R=(new xn).fromArray(tp(X,Q.getMat(X))),c=X.getAnchor3d(),_=new se;I.containsPoint(_.set(0-c.x,0-c.y,0-c.z).applyMatrix4(R))&&I.containsPoint(_.set(0-c.x,0-c.y,1-c.z).applyMatrix4(R))&&I.containsPoint(_.set(0-c.x,1-c.y,0-c.z).applyMatrix4(R))&&I.containsPoint(_.set(0-c.x,1-c.y,1-c.z).applyMatrix4(R))&&I.containsPoint(_.set(1-c.x,0-c.y,0-c.z).applyMatrix4(R))&&I.containsPoint(_.set(1-c.x,0-c.y,1-c.z).applyMatrix4(R))&&I.containsPoint(_.set(1-c.x,1-c.y,0-c.z).applyMatrix4(R))&&I.containsPoint(_.set(1-c.x,1-c.y,1-c.z).applyMatrix4(R))||z.setupShadowCamera()}},z.createShadow=function(T){if(T||(T=Q._frameState.renderState.directUniforms()),T.shadowMatrix=O.toArray(),Q._getFrameRenderOptions("renderShadow")===!1){var D,M=Q.getGL();(D=M._emptyShadowTexture)||(D=M._emptyShadowTexture=oo(M,null,[255,255,255,255])),T.shadowMap=D}else{var H=Q._getFrameRenderOptions("useReflectorSelfShadowMap")&&z.mapForReflector;T.shadowMap=H?z.mapForReflector.texture:z.map.texture}T.shadowSize=[Z.width,Z.height],T.shadowIntensity=P,T.shadowBias=F,T.shadowRadius=c},z.genShaderDefine=function(){var O="#define USE_SHADOWMAP\n";return"hard"===k?O+="#define SHADOWMAP_TYPE_PCF\n":"soft"===k&&(O+=Q.isGLTempRegisterLimited()?"#define SHADOWMAP_TYPE_PCF\n":"#define SHADOWMAP_TYPE_PCF_SOFT\n"),O};var w;z.setupShadowCamera=function(){e||(e=z.boundingSphere=new n.Math.Sphere),I=!1;var r,h,S=Q.getBoundingBox(Q.dm().toDatas(function(X){return X.s("shadow.cast")&&Q.isVisible(X)}));S?(r=new se(S.min),h=new se(S.max)):(r=new se(-256,-256,-256),h=new se(256,256,256),I=!0),e.set(r.clone().add(h).multiplyScalar(.5),.5*r.distanceTo(h)*j);var J,q=e.radius,K=Q.getBoundingBox(Q.dm().toDatas(function(X){return(X.s("shadow.cast")||X.s("shadow.receive"))&&Q.isVisible(X)}));if(K){r.copy(K.min),h.copy(K.max);var g=.5*r.distanceTo(h);J=g+Math.min(g,q+e.center.distanceTo(r.add(h).multiplyScalar(.5)))}else J=2*q;w=Jh(Pb(),-q,q,-q,q,J/1e3,J),O.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),O.multiply(N.fromArray(w));var D=Math.tan(-f*Math.PI/180),d=Math.tan(-$*Math.PI/180),l=q/Math.sqrt(D*D+d*d+1),u=new se(l*D,l,l*d);z.direction=se.normalizeArray(u.clone().multiplyScalar(-1)),N.lookAt(u,new se(0,0,0),new se(0,1,0)).setPosition(u.add(e.center)),N.getInverse(N),O.multiply(N)},z.getDirection=function(){return z.enable?z.direction:void 0};var D=function(){var O=Q.getGL(),K=R,p=R;Z.setSize(O,K,p),Z.bind(O),O.clear(Of.COLOR_BUFFER_BIT|Of.DEPTH_BUFFER_BIT);var b=Q._frameState,q=b.renderState,L=q.directUniforms(),P=q.directAttribs(),a=q.directState();L.projectionMatrix=w,(r=Q._boxClippers.length>0)&&(ri(Q,L,Hp),L.uClipperMatrix=Q._boxClipperMatrixes,L.uClipperClipInner=Q._boxClipperClipInner);var V=Q._viewport;Q.setViewport(O,0,0,K,p);var x,G,T,s;for(x=0,G=hn.length;G>x;x++)if(T=hn[x],!ej[T].ignore&&(s=Q._40Q.get(T))){var _=s.batchIndexMap;z.renderItems(O,L,P,a,s.opaque,_),z.renderItems(O,L,P,a,s.transparent,_),z.renderBatch(O,L,P,a,s.batchModelMap,_)}Z.unbind(O),Q.setViewport(O,V[0],V[1],V[2],V[3])};z._renderDirect=function(s,_,U,C){U&&U.length&&(_.position=Lo(s,Q._buffer.vs,U,S),C?(gl(s,Q._buffer.is,C),Yi(s,0,C.length,null,C instanceof Uint32Array?s.UNSIGNED_INT:null)):Oe(s,0,U.length/3))},z.renderShapeModel=function(O,K,W,v){var n,D,S;if(Td(W))for(D=0,S=W.length;S>D;D++)n=W[D],n&&z.renderShapeModel(O,K,n,v);else xd(W)?z.renderShapeModel(O,K,ze(v,W),v):Il(W)&&(W.shape3d?z.renderShapeModel(O,K,W.shape3d,v):z.renderShapeModelImpl(O,K,W))},z.renderShapeModelImpl=function(s,K,q){Sm(q),z._renderDirect(s,K,q.vs,q.is),z._renderDirect(s,K,q.top_vs,q.top_is),z._renderDirect(s,K,q.bottom_vs,q.bottom_is),z._renderDirect(s,K,q.from_vs,q.from_is),z._renderDirect(s,K,q.to_vs,q.to_is)},z.renderBatch=function(C,k,I,B,s){if(!to(s)&&!Q.drawFilter){k.modelViewMatrix=m.identity().premultiply(N).toArray();var E,U,q;for(E in s)q=Q.getBatchInfo(E)||Zc,q.visible!==!1&&q.shadowCast!==!1&&(g&&q.reflectable===!1||(U=s[E],U.invalidate&&pg(U),r&&(k.modelMatrix=cm,ri(Q,k,q.clipboxMask===W?Oi:q.clipboxMask)),z._renderDirect(C,I,U.vs32,U.is)))}},z.renderItems=function(i,A,W,y,G,k){var V,X,f,h,d,s,M=G.length;for(V=0;M>V;V++)if(X=G[V],h=X.ui,f=X.data,!(lr(f)||!f.s("shadow.cast")||f instanceof sq||f.s("effect.flow")||!Q.isVisible(f)||k[f._id]||g&&f.s("3d.reflectable")===!1)){var l=h.s("3d.clip.direction");if(l){var L=h.s("3d.clip.percentage");if(0===L)continue;var _=h._formatClipUniforms(l,L,f);A.uClipPercent=_[1],A.uClipDirection=_[0]}else A.uClipDirection=0;d=h.shapeModel||ze(h),d||(d=f instanceof n.Node&&!(f instanceof n.Shape)?{vs:Ar,is:Ph}:[h.left,h.front,h.right,h.back,h.top,h.bottom]),s=h.mat?m.fromArray(h.mat):m.identity();var Z=h._vsTranslation;Z&&(H.extractShapeTranslation||H.extractPolylineTranslation||H.extractVerticesTranslation)&&s.multiply(Z),r&&(A.modelMatrix=s.toArray(),ri(Q,A,f.s("3d.clipbox")?Hp:f.s("3d.clipbox.mask"))),A.modelViewMatrix=s.premultiply(N).toArray(),y.cullFace.enabled=!!f.s("shape3d.reverse.cull"),z.renderShapeModel(i,W,d,h)}},z.resetProperties=v};ln.shaderSrc={vs:["$DEFINE","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","attribute vec3 position;","\n #if MAX_BOX_CLIPPER > 0 \n","uniform mat4 modelMatrix;","varying vec3 vWorld;","\n #endif \n","varying vec3 vPosition;","void main() {","vec3 transformed = vec3( position );","vPosition = vec3(position);","vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );","\n #if MAX_BOX_CLIPPER > 0 \n","vWorld = vec3(modelMatrix * vec4(transformed, 1.0));","\n #endif \n","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fs:["$DEFINE","precision highp float;","const float PackUpscale = 256. / 255.;","const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );","const float ShiftRight8 = 1. / 256.;","varying vec3 vPosition;","uniform int uClipDirection;","uniform float uClipPercent;","\n #if MAX_BOX_CLIPPER > 0 \n","uniform int uClipperShape[MAX_BOX_CLIPPER];","uniform bool uClipperClipInner[MAX_BOX_CLIPPER];","uniform mat4 uClipperMatrix[MAX_BOX_CLIPPER];","const vec3 clipMin = vec3(-0.5, -0.5, -0.5);","const vec3 clipMax = vec3(0.5, 0.5, 0.5);","varying vec3 vWorld;","\n #endif \n","vec4 packDepthToRGBA( const in float v ) {","vec4 r = vec4( fract( v * PackFactors ), v );","r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;","}","void main() {","if (uClipDirection > 0) {","vec3 dir = vec3(0.0, 0.0, 0.0);","if (uClipDirection < 2) { dir.x = 1.0; }","else if (uClipDirection < 3) { dir.x = -1.0; }","else if (uClipDirection < 4) { dir.y = 1.0; }","else if (uClipDirection < 5) { dir.y = -1.0; }","else if (uClipDirection < 6) { dir.z = 1.0; }","else if (uClipDirection < 7) { dir.z = -1.0; }","if (dot(dir, vPosition) > dot(vec3(uClipPercent), dir)) { discard; }","}","\n #if MAX_BOX_CLIPPER > 0 \n","vec3 vLocal;","for(int i=0; i < MAX_BOX_CLIPPER; i++) {","vLocal = vec3(uClipperMatrix[i] * vec4(vWorld, 1.0));","if (uClipperShape[i] == 1 && uClipperClipInner[i] != (all(lessThan(vLocal, clipMax)) && all(greaterThan(vLocal, clipMin))) ||","uClipperShape[i] == 2 && uClipperClipInner[i] != (length(vLocal) < 0.5)) { ","discard; return;","}","}","\n #endif \n","gl_FragColor = packDepthToRGBA( gl_FragCoord.z );","}"].join("\n")},ln.PARAMS=["quality","intensity","bias","radius","type","degree.x","degree.z"],Ep.ms_shadow=function(q){ln.PARAMS.forEach(function(V){var u=V.replace(/(^|\.)[a-z]/g,function($){return $[$.length-1].toUpperCase()}),l=u.charAt(0).toLowerCase()+u.substr(1);q["getShadow"+u]=function(){return this._getShadowParam(l)},q["setShadow"+u]=function(U){this._setShadowParam(l,U)}}),q.enableShadow=function(u){this.shadowMap.setShadow(!0,u)},q.disableShadow=function(){this.shadowMap.setShadow(!1)},q._getShadowParam=function(h){return this.shadowMap.getShadow()[h]},q._setShadowParam=function(Z,E){var d=this._getShadowParam(Z),X={};X[Z]=E;var M=this.shadowMap;M.setShadow(M.enable,X),this.firePropertyChange("shadow"+Z.charAt(0).toUpperCase()+Z.substr(1),d,E)}};var ui=function(G){function H(l,x,K,t,w){var q=G.getData3dUI(K),d=q.s("shape3d");if("billboard"===d||"plane"===d){var T;(T=j[x])||(T=j[x]=new Ms(G));var k=K.s("effect.flow.size"),Q=K.s("effect.flow.uvshape"),I=K.getFinalScale3d(),L=I[0],P="billboard"===d?I[1]:I[2];L>P?(P=P/L*k,L=k):(L=L/P*k,P=k),L=Math.max(128,Math.round(L)),P=Math.max(128,Math.round(P)),T.setSize(l,L,P),T.bind(l);var A=G.getViewport(l);G.setViewport(l,0,0,L,P),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT);var J,q=G.getData3dUI(K),h=ze(q,d);if(!h)return!1;!h.ns&&h.length&&(h=h[0]),Sm(h),J=h.vs;var _,u=K.s("effect.flow.gradient");if(u){if(_="Flow3d.Cached."+u,!n.Default.getImageMap()[_]){var W=100;n.Default.setImage(_,n.Default.toCanvas({width:W,height:W,comps:[{type:"rect",background:"rgb(0,0,0)",gradient:u,rect:[0,0,W,W]}]},W,W))}}else _=K.s("shape3d.image");t.useXZ="plane"===d,t.image=G.getTexture(_,K),t.blend=K.s("effect.flow.blend")||c,t.uvMatrix=Wg(q.s("shape3d.uv.rotation"),q.s("shape3d.uv.offset"),q.s("shape3d.uv.scale"),q.s("shape3d.uv.anchor"),f).toArray9(),t.intensity=K.s("effect.flow.intensity");var U=m.indexOf(Q);-1===U&&0===Q.indexOf("polygon")&&(U=_p(1*Q.substring(7),3,1024)-1),t.shape=U,w.position=Lo(l,null,J,S,3),Oe(l,0,J.length/3),T.unbind(l),G.setViewport(l,A[0],A[1],A[2],A[3]);var Z=K.getMatrix4();Z.getInverse(Z);var D=Z.getElements();"plane"===d?D[1]=D[5]=D[9]=D[13]=0:D[2]=D[6]=D[10]=D[14]=0,E[x]={matrix:Z,group:K.s("effect.flow.group")}}}var f,$=this,j=this.renderTargetPool=[],E=[],m=["rect","circle","polygon"];$.render=function(){if(!G._picking){var U=G._flowObjects;if(U.length){var Q=G.getGL();if(Q){var z;(z=Q._flowShader)||(z=Q._flowShader=new co.Shader(Q,ui.shaderSrc.vs,ui.shaderSrc.fs));var N=G._frameState.renderState,I=N.glState;I.blend.enabled=!1,I.depth.enabled=!1,I.cullFace.enabled=!1;var n=I.color.clear.slice(0);uq(Q,[0,0,0,1]),N.useProgram(z.program);var f,E,Z=N.directUniforms(),i=N.directAttribs();for(f=0,E=U.length;E>f;f++)H(Q,f,U[f],Z,i);uq(Q,n),j.length!==E&&j.splice(E,j.length-E)}}}},$.contextLost=function(){var W=G.getGL();W&&(W._flowShader=null,j=this.renderTargetPool=[])},$.createFlow=function(L){var S;if(S=j.length){L||(L=G._frameState.renderState.directUniforms());for(var r=[],H=[],a=[],Y=0;S>Y;Y++)r[Y]=E[Y].matrix.toArray(),H[Y]=j[Y].texture,a[Y]=!1;L.flowMatrix=r;for(var Y=0;S>Y;Y++)L["flowTexture"+Y]=H[Y];L.flowEnabled=a}},$.disableFlow=function(m){var l;if(l=j.length){m||(m=G._frameState.renderState.directUniforms());for(var n=[],r=0;l>r;r++)n[r]=!1;m.flowEnabled=n}},$.resetDataFlowEnabld=function(T,X){return $.resetFlowUniform(T.s("effect.flow.mask"),X)},$.resetFlowUniform=function(_,L){var e=j.length,A=new Array(e);if(_)for(var h=0;e>h;h++)_&1<<E[h].group&&(A[h]=!0);L.flowEnabled=A};var c="white"};ui.shaderSrc={vs:["uniform bool useXZ;","attribute vec3 position;","varying vec2 vUv;","void main() {","if (useXZ) vUv = vec2(position.x, position.z);","else vUv = vec2(position.x, position.y);","gl_Position = vec4(vUv * 2.0, 0.0, 1.0);","}"].join("\n"),fs:["precision highp float;","const float pi2 = 6.2831853;","uniform sampler2D image;","uniform mat3 uvMatrix;","uniform int shape;","uniform vec4 blend;","uniform float intensity;","varying vec2 vUv;","void main() {","vec2 uv;","float angle = atan(vUv.y, vUv.x) / pi2 + 0.5;","if (shape == 0) {","uv = vUv + 0.5;","}","else if (shape == 1) {","uv = vec2(length(vUv) * 2.0, angle);","}","else {","float step = 1.0 / float(shape + 1);","float modAngle = mod(angle, step) - step * 0.5;","uv = vec2(length(vUv) * 2.0 * cos(modAngle * pi2) , angle);","}","vec4 color = texture2D(image, vec2((uvMatrix * vec3(uv, 1.0)).xy)) * blend;","gl_FragColor = color * color.a * intensity;","}"].join("\n")};var hq=function(k){this.gv=k,this.onMouseOver=this.onMouseOver.bind(this),this.resetProperties()};hq.Mode={Disable:0,Selection:1,MouseOver:2,Style:3},Ep.ms_highlight=function(S){S.setHighlightMode=function(j){var i;i="selection"===j||"selected"===j?hq.Mode.Selection:"mouseover"===j||"hover"===j?hq.Mode.MouseOver:"style"===j?hq.Mode.Style:hq.Mode.Disable;var E=this.getHighlightMode();this._highlightHelper.mode=i,this.firePropertyChange("highlightMode",E,j)},S.getHighlightMode=function(){var m=this._highlightHelper.mode;return m===hq.Mode.Selection?"selected":m===hq.Mode.MouseOver?"hover":m===hq.Mode.Style?"style":"disabled"},["type","color","width","glow","strength"].forEach(function(f){var i=f.replace(/(^|\.)[a-z]/g,function(W){return W[W.length-1].toUpperCase()});S["getHighlight"+i]=function(){return this._highlightHelper[f]},S["setHighlight"+i]=function(Y){var G=this._highlightHelper,y=G[f];Y!==y&&(G[f]=Y,this.firePropertyChange("highlight"+i,y,Y))}})},Dh(hq,o,{onMouseOver:function(r){H.preventDefault(r);var D=this.gv;if(!D._48Q){var I=D.getDataAt(r);I!==this.mouseOverData&&(this.mouseOverData=I,D.iv())}},setFetchTargetFunc:function(_){this.fetchTargetFunc=_},_42:function($,K){var d,k,t=this,W=t._mode,Y=t.gv;if(!$._renderInfo.reflectDepth&&W!==hq.Mode.Disable){if(W===hq.Mode.Selection?d=Y.sm().getSelection().toArray(function(I){return I.s("highlight.visible")}):W===hq.Mode.MouseOver&&t.mouseOverData&&t.mouseOverData.s("highlight.visible")&&(d=[t.mouseOverData]),t.fetchTargetFunc&&(d=t.fetchTargetFunc(d)),W===hq.Mode.Style)d=d||[],k=function(c){if(d.indexOf(c)>=0)return!1;var i=Y.getDataHighlightMode(c);return i===!1?!0:i===!0?!1:"selected"===i?Y.isSelected(c)?!1:!0:"hover"===i?c===t.mouseOverData?!1:!0:!0};else{if(!d||!d.length)return;k=function(e){return d.indexOf(e)<0?!0:void 0}}var f=Y.isVRPresenting(),z=Y.getWidth();if(f){var e=Y.getWidth;z/=2,Y.getWidth=function(){return z};var O=Y.getViewport()}var A,v=Y.getDevicePixelRatio(),y=Math.floor(z*v),m=Math.floor(Y.getHeight()*v);(A=t._renderTarget)?A.setSize($,y,m):t._renderTarget=A=new ko.RenderTarget(Y,$,y,m);var b="soft"===t.type;if(A.bind($),b){var I=$.getParameter($.COLOR_CLEAR_VALUE);uq($,[1,1,1,1]),$.clear($.COLOR_BUFFER_BIT),uq($,I)}else $.clear($.COLOR_BUFFER_BIT);Y.setViewport($,0,0,y,m),Y.drawFilter=k,di=function(A,k,J,Y,G,b){var $=[J?0:1,1,1,1];return b||(el.for(A).directUniforms().uFixPickReverseColor=$),$},Y.renderPickScene(),di=dk,Y.drawFilter=null,A.unbind($),Ni&&Gi($,K.aPosition),Gi($,K.aNormal),f&&(Y.getWidth=e,Y.setViewport($,O[0],O[1],O[2],O[3]));var c=Y.getHighlightColor();if(t._lastHighlightColor!==c){var _=dr(t._lastHighlightColor=c);t._highlightColorData=[_[0]/255,_[1]/255,_[2]/255,_[3]/255]}return b?t.renderSoftOutline($,y,m):t.renderHardOutline($,y,m),$.useProgram(K=Y._prg),Ni&&gd($,K.aPosition),!0}},_assureShader:function(c,N){var l=c._compiledShader[N];return l||(l=c._compiledShader[N]=new co.Shader(c,hq.CommonShaderVs,hq[N].fs)),l},renderHardOutline:function(d,E,P){var o=this,V=o.gv,A=V._postProcessing,O=el.for(d),i=O.directState();i.blend.enabled=!0,i.depth.enabled=!1,A.blitScreen(null,o._renderTarget.texture,o._assureShader(d,"HighlightHard"),{textureSize:[E,P],edgeWidth:V.getHighlightWidth(),edgeColor:o._highlightColorData},{clear:!1}),i.blend.enabled=!1,i.depth.enabled=!0},renderSoftOutline:function(m,r,Y){var l,Q,D,_,V,O=this,U=O.gv,R=U._postProcessing,x=Math.floor(r/2),E=Math.floor(Y/2),f=Math.floor(r/4),w=Math.floor(Y/4),d=O._downSampleRenderTarget;d?(l=O._edgeDetectionRenderTarget,Q=O._blurV2,D=O._blurH2,_=O._blurV4,V=O._blurH4,(d.width!==x||d.height!==E)&&(d.setSize(x,E),l.setSize(x,E),Q.setSize(x,E),D.setSize(x,E),_.setSize(f,w),V.setSize(f,w))):(d=O._downSampleRenderTarget=new ko.RenderTarget(U,m,x,E),l=O._edgeDetectionRenderTarget=new ko.RenderTarget(U,m,x,E),Q=O._blurV2=new ko.RenderTarget(U,m,x,E),D=O._blurH2=new ko.RenderTarget(U,m,x,E),_=O._blurV4=new ko.RenderTarget(U,m,f,w),V=O._blurH4=new ko.RenderTarget(U,m,f,w));var J=m.getParameter(m.COLOR_CLEAR_VALUE),s=U.getViewport(),S=O.width,K=O.strength,q=O.glow,C=el.for(m).glState,b=C.depth,N=C.blend,o=b.enabled;uq(m,[1,1,1,1]),b.enabled=!1,N.apply({func:[m.SRC_ALPHA,m.ONE]}),R.blitScreen(d,O._renderTarget.texture),R.blitScreen(l,d.texture,O._assureShader(m,"EdgeDetection"),{texSize:[x,E],color:O._highlightColorData}),R.blitScreen(D,l.texture,O._assureShader(m,"Blur"),{direction:[1,0],texSize:[x,E],radius:S}),R.blitScreen(Q,D.texture,O._assureShader(m,"Blur"),{direction:[0,1],texSize:[x,E],radius:S}),R.blitScreen(V,Q.texture,O._assureShader(m,"Blur"),{direction:[1,0],texSize:[f,w],radius:S}),R.blitScreen(_,V.texture,O._assureShader(m,"Blur"),{direction:[0,1],texSize:[f,w],radius:S}),N.apply({enabled:!0}),U.setViewport(m,s[0],s[1],s[2],s[3]),R.blitScreen(null,O._renderTarget.texture,O._assureShader(m,"BlendTogether"),{edgeTexture1:Q.texture,edgeTexture2:_.texture,edgeStrength:K*S,edgeGlow:q},{clear:!1}),N.apply({func:[m.SRC_ALPHA,m.ONE_MINUS_SRC_ALPHA,m.ONE,m.ONE_MINUS_SRC_ALPHA]}),b.enabled=o,uq(m,J)},resetProperties:function(){this.mode=hq.Mode.Style,this.type=D["highlight.type"],this.color=D["highlight.color"],this.width=D["highlight.width"],this.glow=D["highlight.glow"],this.strength=D["highlight.strength"]},contextLost:function(){this._renderTarget=null}}),o.defineProperties(hq.prototype,{mode:{get:function(){return this._mode},set:function(R){var d=this._mode;if(R!==d){this._mode=R;var r=d===hq.Mode.MouseOver||d===hq.Mode.Style,Y=R===hq.Mode.MouseOver||R===hq.Mode.Style;Y&&r||(r&&N(this.gv.getView(),"mousemove",this.onMouseOver),Y&&Z(this.gv.getView(),"mousemove",this.onMouseOver))}}}}),hq.CommonShaderVs=["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),hq.HighlightHard={fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},hq.EdgeDetection={fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","uniform vec2 texSize;","uniform vec4 color;","void main() {","vec2 invSize = 1.0 / texSize;","vec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);","vec4 c1 = texture2D( image, vUv + uvOffset.xy);","vec4 c2 = texture2D( image, vUv - uvOffset.xy);","vec4 c3 = texture2D( image, vUv + uvOffset.yw);","vec4 c4 = texture2D( image, vUv - uvOffset.yw);","float diff1 = (c1.r - c2.r)*0.5;","float diff2 = (c3.r - c4.r)*0.5;","float d = length( vec2(diff1, diff2) );","gl_FragColor = color * vec4(d);","}"].join("\n")},hq.Blur={fs:["#define MAX_RADIUS 4","precision highp float;","varying vec2 vUv;","uniform sampler2D image;","uniform vec2 texSize;","uniform vec2 direction;","uniform float radius;","float gaussianPdf(in float x, in float sigma) {","return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;","}","void main() {","vec2 invSize = 1.0 / texSize;","float weightSum = gaussianPdf(0.0, radius);","vec4 diffuseSum = texture2D( image, vUv) * weightSum;","vec2 delta = direction * invSize * radius/float(MAX_RADIUS);","vec2 uvOffset = delta;","for( int i = 1; i <= MAX_RADIUS; i ++ ) {","float w = gaussianPdf(uvOffset.x, radius);","vec4 sample1 = texture2D( image, vUv + uvOffset);","vec4 sample2 = texture2D( image, vUv - uvOffset);","diffuseSum += ((sample1 + sample2) * w);","weightSum += (2.0 * w);","uvOffset += delta;","}","gl_FragColor = diffuseSum/weightSum;","}"].join("\n")},hq.BlendTogether={fs:["precision highp float;","varying vec2 vUv;","uniform sampler2D image;","uniform sampler2D edgeTexture1;","uniform sampler2D edgeTexture2;","uniform float edgeStrength;","uniform float edgeGlow;","void main() {","vec4 edgeValue1 = texture2D(edgeTexture1, vUv);","vec4 edgeValue2 = texture2D(edgeTexture2, vUv);","vec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;","float vv = texture2D(image, vUv).r;","vec4 finalColor = edgeStrength * vv * edgeValue;","gl_FragColor = finalColor;","}"].join("\n")};
var Zr=n.Light=function(){fb(Zr,this),this.s(og,D[og]),this.s(Cd,"sphere"),this.s("shape3d.reverse.cull",!0),this.s3(20,20,20)};jj("Light",ci,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(j,T,K){Zr.superClass.onStyleChanged.apply(this,arguments),j===og&&this.s("shape3d.color",K)}});var Ds=ko.FrameState=function(j,x){this.renderState=el.for(x),this.picking=!1,this.envmapReflectivity=.5,this.cameraPosition=W,this.projectMatrix=W,this.viewMatrix=W,this.view=j,this.defaultProgram=W,this.pickColorMap=W,this._pvStack=[],this._renderStateStack=[]};Ds.prototype.savePV=function(){var Z=this.view;this._pvStack.push([sp(this.projectMatrix),sp(this.viewMatrix),Z._18Q,sp(Z._7O)])},Ds.prototype.restorePV=function(){var G=this._pvStack.pop();if(G){var Q=this.view;this.projectMatrix=Q._projectMatrix=G[0],this.viewMatrix=Q._viewMatrix=G[1],Q._18Q=G[2],Q._7O=G[3]}},Ds.prototype.setPV=function(f,S){var t=this.view,D=!1;if(f&&(this.projectMatrix=t._projectMatrix=f,D=!0),S&&(this.viewMatrix=t._viewMatrix=S,t._7O=sp(S),D=!0),D){var X=t.getWidth(),q=t.getHeight(),j=sp(this.projectMatrix);t._18Q=Jc(j,j,S),t._18Q._wh=X/q}},Ds.prototype.syncEnv=function(k){var y=this,I=y.view;y.envmapReflectivity=I._envmapReflectivity||.5,y.cameraPosition=I.getEye(),y.projectMatrix=I._projectMatrix,y.viewMatrix=I._viewMatrix,y.pickColorMap=k,y.picking=I.getGL()._picking},Ds.prototype.setGLState=function(){var J=[0,0,0,0],j=[!0,!0,!0,!0],L=[-1,1],d=[Of.FUNC_ADD,Of.FUNC_ADD],U=[Of.SRC_ALPHA,Of.ONE_MINUS_SRC_ALPHA,Of.ONE,Of.ONE_MINUS_SRC_ALPHA];return function(N,K){var q=this,u=q.renderState.gl,Y=q.renderState.glState;Y.dither=!1,K?Y.color.mask=j:Y.color.reset(),Y.pixelStore.reset(),Y.blend.color=J,Y.blend.equation=d,Y.blend.func=U,Y.cullFace.enabled=!1,Y.scissor.enabled=!1,Y.depth.enabled=!0,Y.depth.clear=1,Y.depth.func=u.LEQUAL,Y.depth.range=L,Y.stencil.enabled=!1,Y.polygonOffset.enabled=!1,N?(Y.depth.mask=!1,Y.blend.enabled=!0):(Y.depth.mask=!0,Y.blend.enabled=!1)}}(),Ds.prototype.setUniforms=function(A){var P=this,l=P.view,G=P.renderState,j=G.gl,Y=G.uniforms;Y.uBrightness=1,Y.uOpacity=1,Y.uPartOpacity=1,Y.uPick=P.picking,Y.uUseInstance=!1,Y.uTexture=!1,Y.uBlendTexture=!1,Y.uAlphaTest=D.alphaTest,Y.uTransparent=!!A,Y.uFix=!1,Y.uBatchColor=!1,Y.uBatchBlend=!1,Y.uBatchBrightness=!1,Y.uReflectivity=P.envmapReflectivity||.5,Y.uCameraPosition=P.cameraPosition,Y.uPMatrix=P.projectMatrix,Y.uViewMatrix=P.viewMatrix,Y.uEnvMap=null,ri(l,Y,Hp),Y.uClipperMatrix=l._boxClipperMatrixes,Y.uClipperClipInner=l._boxClipperClipInner,Y.uEnvmapQuat=l._envmapExtraQuaternion,l._envmapRenderer.resetUniformCache(),P.picking||(Cg(l,j,W),l._fogDisabled||(Y.uFogColor=l._fogColor,Y.uFogDensity=l._fogDensity,Y.uFogNear=l._fogNear,Y.uFogFar=l._fogFar))},Ds.prototype.drawLayer=function(d){return this.view.renderLayers(d,!0)},Ds.prototype.drawData=function(F,j,G){var y=this.view;if(y.isVisible(F)){var o=this.renderState,X=o.uniforms,M=y.getData3dUI(F);if(M){var K=o.gl,U=K._picking,i=y._picking,p=M._pickId;G&&(M._pickId=G),X.uPick=K._picking=y._picking=!!G,X.uTransparent=!!j,M._42(o.gl,o.program,j?a:L),X.uPick=K._picking=U,y._picking=i,M._pickId=p}}};var Es=ko.Graph3dView=function(X,W){var d=this;d.resetHeadlightProperties(),d.resetFogProperties(),d._webGLVersion=1,d._attributes=W||H.graph3dViewAttributes,d._25I={},d._view=Xk(1,d);var z;d._attributes&&(z=d._attributes.canvas)||(z=Zj(d._view)),d._canvas=z,Z(z,"webglcontextlost",function(a){a.preventDefault(),ms(d),d._26I&&(d._doBufferGC(d._26I,!0),Vj(d._canvas,0,0),["_highlightHelper","shadowMap","flowMap","_envmapRenderer","_postProcessing"].forEach(function(O){d[O].contextLost()}),d.dm().each(function($){var W=d.getData3dUI($);W.contextLost()})),d._26I=S,d._1o.onContextLost(),d._35O=!0}),Z(z,"webglcontextrestored",function(){d._35O=!1,d.iv()}),d._40Q=new Ls(d),d._43Q={},d._44Q=-1,d._batchIndexMap={},d._batchModelMap={},d._wireframeIndexMap={},d._wireframeModelMap={},d._wireframeIndexMapSwap={},d._wireframeModelMapSwap={},d._polylineIndexMap={},d._polylineIndexMap={},d._polylineIndexMapSwap={},d._polylineIndexMapSwap={},d._8O=[],d._7O=Pb(),d._6O=Pb(),d._1o=new Vs(d),d._30O=new Ys(d),d._31O=new Ws(d),d._32O=new Xs(d),d._raycaster=new ht(d),d._highlightHelper=new hq(d),d._postProcessing=new rt(d),d._41Q=[],d._42Q=0,d._frameRenderOptionStack=[],ko.VR?(d.vr=new ko.VR(d),d.isVREnabled=function(){return this.vr.enable},d.isVRPresenting=function(){return this.vr.isPresenting()}):(d.vr={enable:!1,isPresenting:y},d.isVREnabled=y,d.isVRPresenting=y),d.shadowMap=new ln(d),d.flowMap=new ui(d),d._33Q=!0,d._eye=Dl(H.graph3dViewEye),d._center=Dl(H.graph3dViewCenter),d._up=Dl(H.graph3dViewUp),d._lightChanged=!1,d._59O=[],d._spots=[],d._dirs=[],d._boxClippers=[],d._flowObjects=[],d._frameId=0,d._picking=!1,d._batchInfoMap={},d.overlappingBox=new Dd(d),d.dm(X?X:new es),d._coreInteractor=new oe(this),d._envmapRenderer=new ko.EnvmapRenderer(this),d.setInteractors([new Os(d)]),d._initView(),d._genBatchInstancedArrayFunc()},Fs={fogDisabled:1,fogMode:1,dashDisabled:1,batchColorDisabled:1,batchInstancedDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1,flowBlendMode:1,uvClipEnabled:1,ortho:1},Gs={box:1,sphere:2},Hs={addRGB:"FLOW_BLEND_MODE_ADD_RGB",addRGBA:"FLOW_BLEND_MODE_ADD_RGBA",overrideRGBA:"FLOW_BLEND_MODE_OVERRIDE_RGBA",overrideRGB:"FLOW_BLEND_MODE_OVERRIDE_RGB",overrideA:"FLOW_BLEND_MODE_OVERRIDE_A",multiplyRGB:"FLOW_BLEND_MODE_MULTIPLY_RGB",multiplyRGBA:"FLOW_BLEND_MODE_MULTIPLY_RGBA"},Is=0;so("Graph3dView",o,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_shadow:1,ms_highlight:1,ms_quickVisible:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","blockSelectable","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable","zoomToCenter",nh,ib,"firstPersonMode",_n,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightDirection","headlightColor","headlightIntensity","headlightAmbientIntensity","headlightDisabled","headlightGroup","ortho","orthoWidth","syncEyeWithOrthoWidth","fovy","near","far",Xj,al,"up","aspect","fogDisabled","fogMode","fogDensity","fogColor","fogNear","fogFar","pickerResolution","dashDisabled","uvClipEnabled","batchColorDisabled","batchInstancedDisabled","batchBlendDisabled","batchBrightnessDisabled","flowBlendMode","hoverDelay","batchInfoMap","rotateMinPhi","rotateMaxPhi","sortable","sortFunc"],_editable:!1,_sortable:H.graph3dViewSortable,_editHelperDisabled:H.graph3dViewEditHelperDisabled,_blockSelectable:H.graph3dViewBlockSelectable,_devicePixelRatio:W,_boundaries:W,_moveStep:H.graph3dViewMoveStep,_rotateStep:H.graph3dViewRotateStep,_rotateMinPhi:H.graph3dViewMinPhi===W?H.graph3dViewRotateMinPhi:H.graph3dViewMinPhi,_rotateMaxPhi:H.graph3dViewMaxPhi===W?H.graph3dViewRotateMaxPhi:H.graph3dViewMaxPhi,_pannable:H.graph3dViewPannable,_rotatable:H.graph3dViewRotatable,_walkable:H.graph3dViewWalkable,_resettable:H.graph3dViewResettable,_zoomable:H.graph3dViewZoomable,_zoomToCenter:!0,_firstPersonMode:H.graph3dViewFirstPersonMode,_mouseRoamable:H.graph3dViewMouseRoamable,_gridVisible:H.graph3dViewGridVisible,_gridSize:H.graph3dViewGridSize,_gridGap:H.graph3dViewGridGap,_gridColor:H.graph3dViewGridColor,_originAxisVisible:H.graph3dViewOriginAxisVisible,_centerAxisVisible:H.graph3dViewCenterAxisVisible,_axisXColor:H.graph3dViewAxisXColor,_axisYColor:H.graph3dViewAxisYColor,_axisZColor:H.graph3dViewAxisZColor,_ortho:H.graph3dViewOrtho,_orthoWidth:H.graph3dViewOrthoWidth,_syncEyeWithOrthoWidth:H.graph3dViewSyncEyeWithOrthoWidth,_fovy:H.graph3dViewFovy,_near:H.graph3dViewNear,_far:H.graph3dViewFar,_rectSelectable:H.graph3dViewRectSelectable,_rectSelectBackground:H.graph3dViewRectSelectBackground,_editSizeColor:H.graph3dViewEditSizeColor,_autoMakeVisible:Oq,_pickerResolution:H.graph3dViewPickerResolution,_dashDisabled:H.graph3dViewDashDisabled,_uvClipEnabled:H.graph3dViewUvClipEnabled,_batchColorDisabled:H.graph3dViewBatchColorDisabled,_batchInstancedDisabled:H.graph3dViewBatchInstancedDisabled,_batchBlendDisabled:H.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:H.graph3dViewBatchBrightnessDisabled,_flowBlendMode:H.graph3dViewFlowBlendMode,addCamera:function(b){var X=this,L=o.freeze({id:X._42Q++,priority:b.priority||0,ignoreInPick:!!b.ignoreInPick,render:b.render});b.switch3DStatus&&(X._43Q[L.id]=!0),X._41Q.push(L),X._41Q.sort(function(k,d){return k.priority!==d.priority?k.priority-d.priority:k.id-d.id})},setEye:function(N,V,k){1===arguments.length&&(V=N[1],k=N[2],N=N[0]);var G=this._eye;G[0]=N,G[1]=V,G[2]=k,this.fp(Xj,S,G)},setCenter:function(N,s,D){1===arguments.length&&(s=N[1],D=N[2],N=N[0]);var W=this._center;W[0]=N,W[1]=s,W[2]=D,this.fp(al,S,W)},setUp:function(q,D,w){1===arguments.length&&(D=q[1],w=q[2],q=q[0]);var G=this._up;G[0]=q,G[1]=D,G[2]=w,this.fp("up",S,G)},getDevicePixelRatio:function(){return this._picking?this._1o._resolution:this._devicePixelRatio||mf},isTransparentMask:function(d){return d.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var v=this,i=v._aspect;return i?i:(i=v.getWidth()/v.getHeight(),i||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(S){var k=this,F=k._dataModel,h=k._selectionModel;F!==S&&(F&&(F.ump(k.handleDataModelPropertyChange,k),F.umm(k.handleDataModelChange,k),F.umd(k.handleDataPropertyChange,k),h||F.sm().ums(k.handleSelectionChange,k)),k._dataModel=S,S.mp(k.handleDataModelPropertyChange,k),S.mm(k.handleDataModelChange,k),S.md(k.handleDataPropertyChange,k),h?h._21I(S):S.sm().ms(k.handleSelectionChange,k),k._postProcessing.handleDataModleChange(F,S),k._tryInvalidateEnvmap(),k.invalidateAll(!0),k.invalidateLight(),k.invalidateboxClipper(),k.invalidateFlowObjects(),k._49Q(),k.fp(hb,F,S),k._canvas.style.background=S.getBackground()||"")},handleDataModelPropertyChange:function(g){var o=g.property;if("background"===o){var c=this._canvas.style.background,v=g.newValue||"";this._canvas.style.background=v,this.fp("canvasBackground",c,v)}else if("envmapType"===o)this._tryInvalidateEnvmap();else if("envmap"===o){var c=this._shaderUseEnvmapFlag,v=!(!g.newValue||!g.newValue.length);c!==v&&ms(this),this.iv()}},handleDataPropertyChange:function(h){var f=h.data;this.invalidateData(f);var Y=h.property;lr(f)&&"s:light.type"===Y?this.invalidateLight():"s:3d.clipbox"===Y?this.invalidateboxClipper(f,!0):"s:effect.flow"===Y?this.invalidateFlowObjects(f,!0):"s:shadow.cast"===Y?this.shadowMap.tryUpdateBounding(f):"s:3d.visible"===Y&&this.invalidateQuickVisible(f)},invalidateboxClipper:function(n,o){var L=this._boxClippers,w=L.length;if(n){var Y=!!n.s("3d.clipbox");if(o=!!o,Y===o)L.indexOf(n)<0&&L.push(n);else{var z=L.indexOf(n);z>=0&&L.splice(z,1)}}else L=this._boxClippers=[],this.dm().each(function(V){V.s("3d.clipbox")&&L.push(V)});var J=L.length;w!==J&&(ms(this),this.shadowMap.deleteShadowProgram(),this._updateBoxClipperMatrix(),ri=J?dc:wi),this.iv()},_updateBoxClipperMatrix:function(){for(var r,K,x=this._boxClippers,m=this._boxClipperMatrixes=[],q=this._boxClipperClipInner=[],D=this._boxClipperGroups=[],Z=this._boxClipperShape=[],E=new xn,w=0,y=x.length;y>w;w++)r=x[w],r.appendAnchorMatrix3d(K=tp(r,this.getMat(r))),m.push(E.getInverse(E.fromArray(K)).toArray()),q.push("inner"===r.s("3d.clipbox")),D.push(r.s("3d.clipbox.group")),Z.push(Gs[r.s("3d.clipbox.shape")]||1)},_49Q:function(){this._4AQ||this._48Q||this.dm().size()<H.graph3dViewDataNumWarningLine||(this._48Q=!0,console.log("Too many datas so than disable some feature to speed up.\nYou can set global Default.graph3dViewDataNumWarningLine to largeEnoughNum to avoid this, or call graph3dView.quitDataNumWarning() to quit.\n"),this.enableQuickVisibleMode(),this.getHighlightHelper().mouseOverData=null)},quitDataNumWarning:function(){this.disableQuickVisibleMode(),this._48Q=!1,this._4AQ=!0},invalidateFlowObjects:function(H,x){var u=this._flowObjects,S=u.length;if(H){var U=!!H.s("effect.flow");if(x=!!x,U===x)u.indexOf(H)<0&&u.push(H);else{var M=u.indexOf(H);M>=0&&u.splice(M,1)}}else u=this._flowObjects=[],this.dm().each(function(Q){Q.s("effect.flow")&&u.push(Q)});S!==u.length&&ms(this),this.iv()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(n){var m=this,K=n.property;if(m.iv(),m._18Q=S,"eye"===K)m._33Q=!0;else if("devicePixelRatio"===K)m._42(m.getDevicePixelRatio());else if(Fs[K]&&(ms(m),"batchInstancedDisabled"===K)){m._genBatchInstancedArrayFunc();var N,C=H.getBatchInfoMap();for(N in C)C[N]&&C[N].instanced&&m.invalidateBatch(N);C=m._batchInfoMap;for(N in C)C[N]&&C[N].instanced&&m.invalidateBatch(N)}},_5O:function(L){var a=L._22Q();return a?new a(this,L):S},getData3dUI:function(G){var t=this._25I[G._id];return t===W&&(t=this._5O(G),this._25I[G._id]=t),t},invalidateAll:function(b,G){var D=this;if(b){for(var x in D._25I){var f=D._25I[x];f&&f.dispose()}D._25I={},D.iv(),xg(D)}else xg(D),D.dm().each(function(V){D.invalidateData(V)});D.shadowMap.tryInvalidateLater(b,G)},invalidateSelection:function(){var Z=this;Z.sm().each(function(z){Z.invalidateData(z)})},invalidateData:function(K){var k=this,V=k.getData3dUI(K);V&&(V.iv(),k.iv()),xg(k,K)},getShape3dText:function(A){return A.getStyle("shape3d.text")||this.getLabel(A)},invalidateBatch:function(U){var i=this,V=i._40Q;V.each(function($){i._invalidateBatch(U,$.batchModelMap,$.batchIndexMap),i._invalidateBatch("T"+U,$.wireframeModelMap,$.wireframeIndexMap),i._invalidateBatch("O"+U,$.wireframeModelMap,$.wireframeIndexMap),$.markBatchInvalid()}),i.iv()},_invalidateBatch:function(W,U,e){var V=this,G=U[W];G&&(G.ds.forEach(function(H){var U=V.getData3dUI(H);U&&U.iv(),delete e[H._id]}),delete U[W])},handleDataModelChange:function(c){var Z=this,e=c.kind,k=c.data;if("add"===e)Z.invalidateData(k),zl(k)&&k.getEdgeGroup()&&k.getEdgeGroup().eachSiblingEdge(Z.invalidateData,Z),lr(k)&&Z.invalidateLight(),k.s("3d.clipbox")&&Z.invalidateboxClipper(k,!0),k.s("effect.flow")&&Z.invalidateFlowObjects(k,!0),Z._49Q();else if(e===Wh){var x=k._id,H=Z._25I[x];H&&(H.dispose(),delete Z._25I[x],Z.iv()),k===Z._currentSubGraph&&Z.setCurrentSubGraph(S),xg(Z,k),lr(k)&&Z.invalidateLight(),k.s("3d.clipbox")&&Z.invalidateboxClipper(k,!1),k.s("effect.flow")&&Z.invalidateFlowObjects(k,!1)}else e===rs&&(Z.invalidateAll(!0),Z.setCurrentSubGraph(S),xg(Z),Z.invalidateLight(),Z.invalidateboxClipper(),Z.invalidateFlowObjects())},toCanvas:function(v,g,A){var c=this,L=c.getGL();if(c.validate(),v){var u=L.getParameter(L.COLOR_CLEAR_VALUE);uq(L,v)}c._42(1,{renderAxis:!1,renderEdit:!1,renderGrid:!1});var p=c.getWidth()||1,Z=c.getHeight()||1,P=new Uint8Array(4*p*Z),V=Zj(),T=V.getContext("2d");L.readPixels(0,0,p,Z,L.RGBA,L.UNSIGNED_BYTE,P),Vj(V,p,Z,1);for(var y=T.getImageData(0,0,p,Z),_=y.data,o=0;o<_.length;o+=4){var U=o/4,E=j(U/p),R=U-E*p;U=4*((Z-1-E)*p+R),_[U]=P[o],_[U+1]=P[o+1],_[U+2]=P[o+2],_[U+3]=P[o+3]}if(T.putImageData(y,0,0),v&&uq(L,u),c._42(c.getDevicePixelRatio()),g&&A){var x=Zj(),e=x.getContext("2d");return Vj(x,g,A,1),H.drawImage(e,V,0,0,g,A),x}return V},toDataURL:function(v,V){var U=this,a=U.getGL();if(U.validate(),v){var B=a.getParameter(a.COLOR_CLEAR_VALUE);uq(a,v)}U._42(1,{renderAxis:!1,renderEdit:!1,renderGrid:!1});var R=U._canvas.toDataURL(V||"image/png",1);return v&&uq(a,B),U._42(U.getDevicePixelRatio()),R},isWebGL2:function(){return 2===this._webGLVersion},getGL:function(){var Z=this._26I;if(Z)return this.acquireProgram(),Z;if(!this._35O){var e=this,Q=e._canvas,g=e._attributes;if(!g||g.requestWebGL2!==!1)try{Z=Q.getContext("webgl2",g)||Q.getContext("experimental-webgl2",g),Z&&(e._webGLVersion=2,e._26I=Z)}catch(u){}if(!Z)try{Z=Q.getContext("webgl",g)||Q.getContext("experimental-webgl",g)}catch(u){throw new Error("WebGL not supported")}if(!Z)throw new Error("WebGL not supported");e._26I=Z;var M=e._frameState=new Ds(this,Z);e._glExtensions=new c(Z),e._glCapabilities=new F(Z,e._glExtensions),e._2O={},Z._emptyCubeTexture=ek(Z),Z._compiledShader={},Z._emptyTexture=oo(Z),Z._emptyBlendTexture=oo(Z),Z._bufPool={},Z._id=++Is,Z._divisorState=[],M.setGLState(),e._buffer={vs:ds(Z),ns:ds(Z),is:ds(Z),uv:ds(Z),batchColor:ds(Z),batchBlend:ds(Z),batchBrightness:ds(Z),lineDistance:ds(Z)},e._1O=ad(Z);var s=e._cube={vs:ds(Z),ns:ds(Z),is:ds(Z),uv:ds(Z)};return bm(Z,s.vs,Ar),bm(Z,s.ns,wo),bm(Z,s.uv,Xp),Jq(Z,s.is,Ph),e.acquireProgram(),e._genBatchInstancedArrayFunc(),Z._renderInfo={calls:0,vertices:0,faces:0,lines:0,points:0,textureCache:{time:0,count:0,pixels:0},frame:0,cacheTimeCost:0,reflectDepth:0},Z}},getGLCapabilities:function(){var W=this.getGL();return W?this._glCapabilities:void 0},getGLExtensions:function(){var Y=this.getGL();return Y?this._glExtensions:void 0},getEnvmap:function(){return this._glCapabilities&&this._glCapabilities.maxVertexTextures<H.graph3dEnvmapCapabilityRequire?null:this.dm().getEnvmap()},getEnvmapType:function(){var S,t=this.dm();return t&&(S=t.getEnvmapType()),S||"legacy"},setEnvmapExtraQuaternion:function(_){var Z=this._envmapExtraQuaternion;this._envmapExtraQuaternion=_ instanceof Po.Quaternion?_.clone().inverse().toArray():null,null==Z!=(null==_)&&ms(this)},invalidateEnvmap:function(C){return this._envmapRenderer.invalidateEnvmap(C)},_setEnvmapByProbeId:function(w,A){return this._envmapRenderer.setEnvmapByProbeId(w,A)},_tryInvalidateEnvmap:function(){var i=this.getEnvmapType();i!==this._lastProgramEnvmapType&&(ms(this),this.iv())},acquireProgram:function(){var a=this,o=a._26I;if(o&&!a._prg){var u=a._prg=o.createProgram();if(!u)return S;var w=a._dirs.length,B=a._spots.length,m=a._59O.length,N=a._boxClippers.length,L=a._flowObjects.length,k=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uUvMatrix","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uClipDirection","uClipPercent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightAmbientIntensity","uHeadlightColor","uFogColor","uFogDensity","uFogNear","uFogFar"];w&&k.push("uDirColor","uDirDirection"),B&&k.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),m&&k.push("uPointColor","uPointRange","uPointPosition"),tq||(ao=fi(ao.substring(0,ao.indexOf("^#"))),Ji=fi(Ji),tq=!0);var Z=a.getEnvmap(),G=Z&&Z.length,p=a.getEnvmapType(),l=["#define MAX_DIR "+w,"#define MAX_SPOT "+B,"#define MAX_POINT "+m,"#define MAX_BOX_CLIPPER "+N,"#define MAX_FLOW_OBJECT "+L,a._fogDisabled?"":"#define FOG","exp2"===a.getFogMode()?"#define FOG_EXP2":"",a._dashDisabled?"":"#define DASH",a._uvClipEnabled?"#define UV_CLIP":"",null==a._envmapExtraQuaternion?"":"#define ENVMAP_ROTATE",G?"#define USE_ENVMAP":"","legacy"!==p?"#define ENVMAP_TYPE_CUBE_UV":"",a.isOrtho()?"#define ORTHOGRAPHIC":"",a._batchColorDisabled?"":"#define BATCHCOLOR",a._batchInstancedDisabled?"":"#define BATCHINSTANCE",a._batchBlendDisabled?"":"#define BATCHBLEND",a._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS","#define "+(Hs[a.getFlowBlendMode()]||Hs[H.graph3dViewFlowBlendMode]),a.shadowMap.enable?a.shadowMap.genShaderDefine():"",""].join("\n"),f=ee(o,u,o.VERTEX_SHADER,ao.replace("#PREFIX",l));o.getShaderParameter(f,o.COMPILE_STATUS)||vk("COMPILE",o.VERTEX_SHADER,o.getError(),o.getShaderInfoLog(f));var D=ee(o,u,o.FRAGMENT_SHADER,Ji.replace("#PREFIX",l));if(o.getShaderParameter(D,o.COMPILE_STATUS)||vk("COMPILE",o.FRAGMENT_SHADER,o.getError(),o.getShaderInfoLog(D)),Ni?k.push("aPosition"):(u.aPosition=0,o.bindAttribLocation(u,0,"aPosition")),o.linkProgram(u),!o.getProgramParameter(u,o.LINK_STATUS)){var c=o.getProgramInfoLog(u);return a._prg=S,c.indexOf("maximum temp register")>=0&&!a._glTempRegisterLimited?(a._glTempRegisterLimited=!0,o.deleteProgram(u),a.acquireProgram()):(vk("LINK",o.getProgramParameter(u,o.VALIDATE_STATUS),o.getError(),c),o.deleteProgram(u),S)}k.forEach(function(I){u[I]=/^u/.test(I)?o.getUniformLocation(u,I):o.getAttribLocation(u,I)});var O=a._frameState;O.renderState.program=O.defaultProgram=u,a._envmapRenderer.changeEnvmapType(a._lastProgramEnvmapType=p),a._shaderUseEnvmapFlag=G,o.deleteShader(f),o.deleteShader(D)}},isGLTempRegisterLimited:function(){return this._glTempRegisterLimited},getBrightness:function(r){var W=r.s("brightness"),j=this.isSelected(r)?r.s("select.brightness"):S;return W==S?j:j==S?W:W*j},getDataHighlightMode:function(B){return B.s("highlight.mode")},getWireframe:function(o){var Q=o.s("wf.visible"),v=o.s("wf.width");return Q===!0||v>0&&"selected"===Q&&this.isSelected(o)?{color:o.s("wf.color"),width:v,"short":o.s("wf.short"),mat:o.s("wf.mat")}:void 0},_transformPointToViewSpace:function(U){var N=[U[0],U[1],U[2]];return ak(N,this._viewMatrix),N},_transformDirectionToViewSpace:function(z,x){var O=z?[z[0],z[1],z[2]]:[0,0,0];ak(O,this._viewMatrix);var g=x?[x[0],x[1],x[2]]:[0,0,0];ak(g,this._viewMatrix);var X=g[0]-O[0],I=g[1]-O[1],D=g[2]-O[2],j=Math.sqrt(X*X+I*I+D*D);return j?[X/j,I/j,D/j]:[X,I,D]},getWireframeGeometry:function(Y){return Y.s("wf.geometry")?{color:Y.s("wf.color"),width:Y.s("wf.width"),mat:Y.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(C){return C.s("body.color")},getMat:function(N){return N.getMat?N.getMat():N.s("mat")},getFaceMat:function(N,k){return N.getFaceMat?N.getFaceMat(k):N.s(k+".mat")},getFaceBlend:function(P,y){return P.s(y+".blend")||P.s("all.blend")},getFaceColor:function(h,m){return h.s(m+".color")||h.s("all.color")},getFaceImage:function(o,J){return o.s(J+".image")||o.s("all.image")},getFaceBlendImage:function(p,F){return p.s(F+".blend.image")||p.s("all.blend.image")},getFaceDiscardSelectable:function(G,D){var b=G.s(D+".discard.selectable");return b==S?G.s("all.discard.selectable"):b},getFaceUv:function(I,u){return I.s(u+".uv")||I.s("all.uv")},getFaceUvOffset:function(m,D){return m.s(D+".uv.offset")||m.s("all.uv.offset")},getFaceUvScale:function($,D){return $.s(D+".uv.scale")||$.s("all.uv.scale")},getFaceUvRotation:function(r,c){return r.s(c+".uv.rotation")||r.s("all.uv.rotation")},getFaceUvAnchor:function(x,K){return x.s(K+".uv.anchor")||x.s("all.uv.anchor")},getFaceLight:function(J,b){var q=J.s(b+".light");return q==S?J.s("all.light"):q},getFaceVisible:function(d,D){var w=d.s(D+".visible");return w==S?d.s("all.visible"):w},getFaceOpacity:function(d,D){var P=d.s(D+".opacity");return P==S?d.s("all.opacity"):P},getFaceTransparent:function(X,P){var B=X.s(P+".transparent");return B==S?X.s("all.transparent"):B},getFaceReverseColor:function(p,y){return p.s(y+".reverse.color")||p.s("all.reverse.color")},getFaceReverseFlip:function(A,u){var k=A.s(u+".reverse.flip");return k==S?A.s("all.reverse.flip"):k},getFaceReverseCull:function($,N){var I=$.s(N+".reverse.cull");return I==S?$.s("all.reverse.cull"):I},getTextureMap:function(){return this._2O},_2Oi:function(N,q,I){I=I||"";var c;(c=this._2O[N])||(c=this._2O[N]={}),c[I]=q},deleteTexture:function(P){var c=this;if(c._2O){var z=c._2O[P];if(z){delete c._2O[P];var Z=c.getGL();for(var H in z)Z.deleteTexture(z[H])}}},renderPickScene:function(){var v=this.getGL();this.syncRenderState(),this._picking=v._picking=!0,this.renderScene(),this._picking=v._picking=!1},invalidateCachedTexture:function(H){var D=this.getData3dUI(H);D.invalidateCachedTexture(this.getGL()),this.invalidateData(H)},invalidateShape3dCachedImage:function(G){this.invalidateCachedTexture(G)},invalidateCachedGeometry:function(p){var o=this.getData3dUI(p);o.invalidateCachedGeometry(),this.invalidateData(p)},isInteractive:function(g){return g.s("interactive")},getTexture:function(i,B,$,w){if(!i)return S;var M,C,V=this,y=V.getGL(),d=V._2O[i];if(d&&(B&&(C=B.s("texture.mipmap.max")),M=d[C||""]||d.default),!M){var L=Fr(i);if(w||(w={}),!L)return y._emptyTexture;if(B){w.mipmapMaxLevel=C=B.s("texture.mipmap.max");var p=B.s("texture.wrap");w.clampToEdge="clampToEdge"===p?!0:"repeat"===p?!1:W}if(L.uuid||(L.uuid=n.Math.generateUUID()),L.tagName){if(L.dynamic)return ad(y,L,V._1O,w);M=ad(y,L,W,w),V._2Oi(i,M,C)}else{var j,e=B&&(B.s("texture.cache")||B.s("shape3d.image.cache")||L.textureCache),I=V.isVRPresenting();if(I&&(B._textureUpdateFrame===y._renderInfo.frame?e=!0:B._textureUpdateFrame=y._renderInfo.frame),e&&(j=V.getData3dUI(B),M=j.getCachedTexture($),M&&j.interactiveInfo&&M.interactiveInfo&&(j.interactiveInfo[M.interactiveInfo.key]=M.interactiveInfo.info)),!M){var P=y._renderInfo.textureCache;if(e){if(P.time>H.graph3dMaxVectorCacheTime)return V.redraw(),y._emptyTexture;if(!Bo(L,B))return y._emptyTexture}var R;B&&(1!==B.s("texture.scale")?R=B.s("texture.scale"):1!==B.s("shape3d.texture.scale")&&(R=B.s("shape3d.texture.scale"))),R||(R=1);var D=B&&(B.s("fixSizeOnScreen")||B.s("shape3d.fixSizeOnScreen")),m=D?y.NEAREST:y.LINEAR;D?"number"==typeof D&&(R*=0>D?1:D):B&&(B.s("vector.dynamic")||B.s("shape3d.vector.dynamic"))&&(j||(j=V.getData3dUI(B)),D=j.getVectorDynamicSize());var b,u,J,N=B&&B.s("shape3d");"billboard"===N?J=B.getTall()/B.getWidth():"plane"===N&&(J=B.getHeight()/B.getWidth());var k=lm(L,B);if(D){var G;G=e?V._devicePixelRatio||mf:V.getDevicePixelRatio(),b=D[0]>0?D[0]*G:R*k*G,u=D[1]>0?D[1]*G:R*(J?qj(L,B,V,Math.min(4096,k*J)):qj(L,B))*G}else b=R*k,u=R*(J?qj(L,B,V,Math.min(4096,k*J)):qj(L,B));if(b>=1&&u>=1){var f=0;(e||I)&&(f=Date.now());var q=V._glCapabilities.maxTextureSize;b=Math.min(b,q),u=Math.min(u,q);var Q=mp(b,u);if(!j&&B&&(j=V.getData3dUI(B)),j&&j.interactiveInfo){var F=i;"object"==typeof F&&(F=F.uuid||(F.uuid=n.Math.generateUUID()));var T=j.interactiveInfo[F]={};Q.interactiveInfo=T.bodyInfo={compInfos:[],matrix:new Vb,rect:{x:0,y:0,width:b,height:u}}}hl(Q,L,0,0,b,u,B,V),Q.interactiveInfo&&(Q.interactiveInfo=null),Q.restore(),P.count++,P.pixels+=b*u,B?(w.minFilter=tm(B.s("texture.filter.min")||B.s("texture.filter"))||m,w.magFilter=tm(B.s("texture.filter.mag")||B.s("texture.filter"))||m):w.minFilter=w.magFilter=m,e||I?(M=ad(y,Qe,null,w),j.setCachedTexture(M,$),P.time+=Date.now()-f,T&&(M.interactiveInfo={key:F,info:T}),Qe=null):M=ad(y,Qe,V._1O,w)}}}}return M},redraw:function(){this.iv()},validateImpl:function(){var d=this;if(d._lightChanged){d._lightChanged=!1;var l=[],R=[],r=[];d.dm().each(function(Z){if(lr(Z)){var j=Z.s("light.type");j===mk?l.push(Z):j===Bs?R.push(Z):j===ys&&r.push(Z)}}),(l.length!==d._59O.length||R.length!==d._spots.length||r.length!==d._dirs.length)&&ms(d),d._59O=l,d._spots=R,d._dirs=r}var e=d.getAspect();e!==d.__cachedAspect__&&(d._updateSkybox({property:"asceptChanged"}),d.__cachedAspect__=e),d._42(),d._1o.iv()},getRenderInfo:function(){var m=this.getGL();return m?m._renderInfo:void 0},getDebugTip:function(){var Y=this,P=Y.getRenderInfo();if(P){var $=Y.getGL()._validBufCount||0,q="Draw Calls: "+P.calls+"<br/>"+"Vertices: "+P.vertices+"<br/>"+"Faces: "+P.faces+"<br/>"+"Lines: "+P.lines+"<br/>"+(P.points?"Points: "+P.points+"<br/>":"")+"Buffers: "+$+"<br/>"+"Cache Models: "+o.keys(Uo).length+"<br/>"+"Shape3d Models: "+o.keys(yh).length;if(Y.isVRPresenting()&&(q+="<br/>VR fps: "+Y.vr.getFps()),P.textureCache){var N=P.textureCache.count;if(q+="<br/>2D Dynamic Textures: "+P.textureCache.count,N>0){var V,c=P.textureCache.pixels;V=c>1e6?Math.round(c/1e6)+"M":c>1e3?Math.round(c/1e3)+"K":Math.round(c),q+="<br/>2D Dynamic pixels: "+V}}return q}},getFrameState:function(){return this._frameState},isBoundingBoxInView:function(){var W=new n.Math.Box3,K=new n.Math.Matrix4;return function(e){var R=e;if(R instanceof n.Data&&(R=this.getData3dUI(R)),!R.mat)return!0;var C=R.getBoundingBox();W.copy(C).applyMatrix4(K.fromArray(R.mat));var J=this.getFrustum();return J.intersectsBox(W)}}(),updateScene:function(){var K=this;K._81O=S,K.overlappingBox.clear();var h=K._40Q;h.init();var l=K.getGL(),k=K.dm();if(k.isHierarchicalRendering())k.eachByHierarchical(function(g){var N=K.getData3dUI(g);N&&N.update(K,l,h)});else{var W,r,H,p=k.getDatas().getArray(),M=p.length;for(W=0;M>W;W++)r=p[W],H=K.getData3dUI(r),H&&H.update(K,l,h)}this._updateBoxClipperMatrix(),h.onUpdated()},_pushFrameRenderOptions:function(N){this._frameRenderOptionStack.push(this._currentFrameRenderOptions),this._currentFrameRenderOptions=N},_popFrameRenderOptions:function(){this._currentFrameRenderOptions=this._frameRenderOptionStack.pop()},_getFrameRenderOptions:function(j){var b=this._currentFrameRenderOptions;return b&&b[j]},getRenderLists:function(){return this._40Q},renderScene:function(J){function z(C,q){U.setGLState(C,q),U.setUniforms(C),U.renderState.attribs.disable(),d=V.directUniforms(),$=V.directAttribs(),$.disable()}function y(H){for(var Q=!1;C>c;c++){var y=x[c];if(!p||!y.ignoreInPick){if(y.priority>=H)break;(!N._43Q[N._44Q=y.id]||Gc[bp.length])&&(y.render(s,N,U),z(),Q=!0)}}return Q}var N=this;N._pushFrameRenderOptions(J),N._getFrameRenderOptions("createShadowMap")!==!1&&N.shadowMap.render(),N.flowMap.render();var s=N.getGL();N._envmapRenderer.onBeforeRender(s),N._44Q=-1;var d,$,U=N._frameState,V=U.renderState,l=V.glState,E=N._prg;N._projectMatrix=zo(N),om(N,N._7O),N._viewMatrix=sp(N._7O),N.isReflecting(s)||Jc(N._projScreenMatrix=Pb(),N._projectMatrix,N._viewMatrix),U.syncEnv(this._picking?this.pickColorMap:W),V.useProgram(E),z(!1,!0),s.clear(s.DEPTH_BUFFER_BIT);var p=N._picking,x=this._41Q,c=0,C=x.length;if(y(H.cameraPriority.skybox),p){var Y=l.color.clear.slice(0);uq(s,[0,0,0,0])}else uq(s,[0,0,0,0]),l.blend.enabled=!1,l.depth.enabled=!1,l.depth.mask=!1,N._camera&&N._camera.s("camera.renderSky")===!1||N.drawSky(s,E),N._getFrameRenderOptions("renderReflector")!==!1&&N.drawReflectors(s)&&(N._projectMatrix=zo(N),om(N,N._7O),N._viewMatrix=sp(N._7O),U.syncEnv(),z()),l.blend.enabled=!1,l.depth.enabled=!0,l.depth.mask=!0,d.uTransparent=!1,N._getFrameRenderOptions("renderGrid")!==!1&&N._31O._42(s,E);if(!s.textureBatch||Gc[(ONE_FRAME_TIME-6)/2]){p||(N.shadowMap.enable&&N.shadowMap.createShadow(d),N.flowMap.createFlow(d));for(var F=0,v=hn.length;v>F;F++){var Z=hn[F],f=ej[Z];if(!(!N._camera&&f.ignore||N._camera&&!N._camera.isLayerVisible(Z))){var i=f.priority;y(i)&&(p||(N.shadowMap.enable&&N.shadowMap.createShadow(d),N.flowMap.createFlow(d))),this.renderLayer(Z)}}y(H.cameraPriority.infinity),p||N.flowMap.disableFlow(d),Wr(N,d,0,H.graph3dViewHeadlightAmbientIntensity),d.uHeadlightColor=[1,1,1,0],d.uUseEnvMap=!1,d.uHeadlightDirection=[0,0,0],d.uHeadlightRange=0,l.depth.enabled=!1,d.uTransparent=!1,d.shadowReceive=!1,ri(N,d,Hp),p?N.drawFilter||N._30O._42(s,E):(N._highlightHelper._42(s,E),this._renderAxisAndEditHelper(N._getFrameRenderOptions("renderAxis")!==!1,N._getFrameRenderOptions("renderEdit")!==!1),l.blend.enabled=!1,l.depth.mask=!0),l.depth.enabled=!0,p&&uq(s,Y),bm(s,S),Jq(s,S),N._44Q=-1,N._popFrameRenderOptions(null)}},_renderAxisAndEditHelper:function(O,_){if(O||_){var D=this,x=D.getGL(),A=D._prg,o=D._frameState,G=o.renderState,i=G.glState,E=G.directUniforms();o.renderState.attribs.disable(),i.depth.enabled=!1,E.uTransparent=!1,E.shadowReceive=!1,i.blend.enabled=!1,i.depth.mask=!0,E.uPick=D._picking;var v=!D._fogDisabled;v&&(E.uFog=!1),O&&D._32O._42(x,A),_&&D._30O._42(x,A),v&&(E.uFog=!0),bm(x,S),Jq(x,S)}},renderLayers:function(I,z){z&&(I=wd(I));for(var R=0,X=I.length;X>R;R++)this.renderLayer(I[R])},renderSky:function(){var y=this,m=y._frameState,d=m.renderState,G=d.glState,s=y.getGL(),g=y._prg;y._projectMatrix=zo(y),om(y,y._7O),y._viewMatrix=sp(y._7O),Jc(y._projScreenMatrix=Pb(),y._projectMatrix,y._viewMatrix),m.syncEnv(),d.useProgram(g),m.setGLState(!1,!0),m.setUniforms(!1),m.renderState.attribs.disable(),s.clear(s.DEPTH_BUFFER_BIT),uq(s,[0,0,0,0]),G.blend.enabled=!1,G.depth.enabled=!1,G.depth.mask=!1,y.drawSky(s,g),G.depth.mask=!0,G.depth.enabled=!0,bm(s,S),Jq(s,S)
},addRenderLayerListener:function(W,c,P){var Z=this;Z._renderLayerNotifier||(Z._renderLayerNotifier=new Kd),Z._renderLayerNotifier.add(W,c,P)},removeRenderLayerListener:function(q,o){this._renderLayerNotifier&&this._renderLayerNotifier.remove(q,o)},fireRenderLayerEvent:function(k,P){var I=this._renderLayerNotifier;I&&I.fire({layer:k,phase:P})},renderLayer:function(Y){var v=this,C=v._picking,$=v._40Q.get(Y);if($){v.fireRenderLayerEvent(Y,"prepare");var c=v.getGL(),Q=ej[Y],p=v._frameState,h=p.renderState,N=h.glState,H=h.directUniforms();!C&&v.isSortable()&&$.sort(v._sortFunc,v._projScreenMatrix);var S,V,t,K=$.opaque,n=$.transparent,D=$.batchModelMap,U=$.polylineModelMap,q=$.wireframeModelMap,c=v.getGL(),u=v._prg;C||(N.blend.enabled=!1,N.depth.enabled=!0,N.depth.mask=!0),H.uTransparent=!1,Q.clearDepth!==!1&&c.clear(c.DEPTH_BUFFER_BIT);var W=this.drawFilter;if(W)for(t=K,S=0,V=t.length;V>S;S++)W(t[S].data)!==!0&&t[S].ui._42(c,u,L);else{for(t=K,S=0,V=t.length;V>S;S++)t[S].ui._42(c,u,L);if(C)for(t=n,S=0,V=t.length;V>S;S++)t[S].ui._46Q(c);Wl(v,D),lf(v,U),lf(v,q)}if(C||(N.blend.enabled=!0,N.depth.mask=!1),v._45Q=H.uTransparent=!0,W)for(t=n,S=0,V=t.length;V>S;S++)W(t[S].data)!==!0&&t[S].ui._42(c,u,a);else{for(t=n,S=0,V=t.length;V>S;S++)t[S].ui._42(c,u,a);Wl(v,D,null,!0),lf(v,U,null,!0),lf(v,q,null,!0)}v._45Q=null,v.fireRenderLayerEvent(Y,"post")}},_42:function(h,P){var C=this;if(!C._35O&&(!jc||Gc(jc))){var T=C.getWidth(),x=C.getHeight();if(T&&x){var D=C.getGL();if(D){var r,W=C._canvas;if(h?r=!0:h=C.getDevicePixelRatio(),!C._picking&&(r||T!==W.clientWidth||x!==W.clientHeight)){Vj(W,T,x,h);var l=h;T&&Math.abs(D.drawingBufferWidth-T*h)>1&&(l=Math.min(l,D.drawingBufferWidth/T)),x&&Math.abs(D.drawingBufferHeight-x*h)>1&&(l=Math.min(l,D.drawingBufferHeight/x)),l!==h&&(C.setDevicePixelRatio(h=l),Vj(W,T,x,h)),C._18Q=null}D.clear(D.COLOR_BUFFER_BIT);var y=D._renderInfo;y.calls=0,y.vertices=0,y.faces=0,y.lines=0,y.points=0,y.textureCache={time:0,count:0,pixels:0},y.frame=++C._frameId,y.cacheTimeCost=0,y.reflectDepth=0,T*=h,x*=h,this.syncRenderState();do{if(C.isVREnabled()&&C.vr.render(D,T,x,P))break;if(C.updateScene(),C._postProcessing.render(D,T,x,P))break;C.setViewport(D,0,0,T,x),C.renderScene(P)}while(!1);C._33Q=!1,C.countFrame(),C._doBufferGC(D)}}}},syncRenderState:function(){var b,I;(b=this._frameState)&&(I=b.renderState)&&I.syncLoss()},drawReflectors:function(m){m._renderInfo.reflectDepth++;var S,Q,U,f=this,q=f._dataModel.getReflectors(),O=!1;for(S in q)Q=q[S],f.isVisible(Q)&&(U=f.getData3dUI(Q),U&&U.drawReflector&&U.drawReflector(m)&&(O=!0));return m._renderInfo.reflectDepth--,O},isReflecting:function(f){return f._renderInfo.reflectDepth},getPostProcessing:function(){return this._postProcessing},enablePostProcessing:function(i,m){return this._postProcessing.enableModule(i,m)},getPostProcessingModule:function(i){return this._postProcessing.getModule(i)},getPostProcessingValue:function(V,S){var x=this._postProcessing.getModule(V);return x?x[S]:W},setPostProcessingValue:function(w,c,M){var d=this.getPostProcessingValue(w,c),C=this._postProcessing.getModule(w);C&&d!==M&&("enable"===c?this.enablePostProcessing(w,M):C[c]=M,this.firePropertyChange("postProcessing."+w+"."+c,d,M))},setDofImageFromGraphView:function(W,J,N){return this._postProcessing.getModule("Dof").setImageFromGraphView(W,J,N)},setViewport:function(E,I,T,S,Z){this._viewport=[I,T,S,Z],el.for(E).directState().viewport=this._viewport},getRenderState:function(){return el.for(this._26I)},getViewport:function(){return this._viewport},setBufferGCInterval:function(B){this._bufferGCInterval=B},_doBufferGC:function(R,G){var D,K,f=R._bufPool,Z=0,L=0,J=R._renderInfo.frame,I=this._bufferGCInterval||10;for(D in f)Z++,K=f[D],K&&(G||J-K._fid>I?(R.deleteBuffer(K._buf),K._buf=null,f[D]=null):L++);if(Z/2>L&&Z>128){var g={};for(D in f)f[D]&&(g[D]=f[D]);R._bufPool=g}R._validBufCount=L},_swapLineMap:function(){var V=this;ik=V._polylineModelMap,V._polylineModelMap=V._polylineModelMapSwap,V._polylineModelMapSwap=ik,ik=V._wireframeModelMap,V._wireframeModelMap=V._wireframeModelMapSwap,V._wireframeModelMapSwap=ik,ik=V._polylineIndexMap,V._polylineIndexMap=V._polylineIndexMapSwap,V._polylineIndexMapSwap=ik,ik=V._wireframeIndexMap,V._wireframeIndexMap=V._wireframeIndexMapSwap,V._wireframeIndexMapSwap=ik},_updateSkybox:function(R){if(this._skybox&&R){var W=R.property,F=!1,J=this._skybox;if("eye"===W||"forceUpdate"===W){var o=this._eye;J.p3(o[0],o[1],o[2]),F=!0}if("near"===W||"far"===W||"forceUpdate"===W||"asceptChanged"===W){var I=J.__cachedS3__;I||(I=J.__cachedS3__=J.getFinalScale3d());var s=Math.sqrt(3),E=1/0,b=-1/0;I.forEach(function(t){t/=2,E=_(t,E),b=g(t,b)}),b*=s;var N=this._near,Y=this._far,T=Math.tan(this.getFovy()/2)*N,u=this.getAspect()*T,D=1.1*Math.sqrt(u*u+T*T+N*N),S=1;if(D>E)S=D/E;else if(b>=Y){var x=Y*Y/(N+Y);S=x/b}if(1!==S){J.__updatingSkybox__=!0;var a=I.map(function(V){return S*V});J.s3(a),J.setScale3d(1,1,1),F=!0,delete J.__updatingSkybox__}}F&&this.invalidateData(J)}},getSkyBox:function(){return this.getSkybox()},setSkyBox:function(G){return this.setSkybox(G)},getSkybox:function(){return this._skybox},setSkybox:function(E){var w=this._skybox;if(w===E)return E&&this._updateSkybox({property:"forceUpdate"}),void 0;if(w&&(this._skyboxStyleMap&&w.setStyleMap(this._skyboxStyleMap),this._skyboxStyleMap=null,this._skyboxAnchor3d&&w.setAnchor3d(this._skyboxAnchor3d),this._skyboxAnchor3d=null,this._skyboxP3&&w.p3(this._skyboxP3),this._skyboxP3=null,this.handleDataModelChange({kind:Wh,data:w})),this._skybox=E,this.ump(this._updateSkybox,this),E){E.dm()&&E.dm().remove(E),this._skyboxStyleMap=n.Default.clone(E.getStyleMap()),this._skyboxAnchor3d=E.getAnchor3d(),E.setAnchor3d(.5,.5,.5),this._skyboxP3=E.p3().slice(0),E.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1});var $=E.onPropertyChanged;E.onPropertyChanged=function(P){$.call(E,P),!E.__updatingSkybox__&&["width","height","tall","scale","scaleTall"].indexOf(P.property)>=0&&(E.__cachedS3__=W)},this.mp(this._updateSkybox,this),this._updateSkybox({property:"forceUpdate"})}this.fp("skybox",w,E)},drawSky:function(w,H){var t=this,M=t._skybox;if(M){var G=el.for(w).directUniforms(),R=t._headlightIntensity,Z=Bp(t._headlightColor),H=t._prg;1!==R&&(Z=[Z[0]*R,Z[1]*R,Z[2]*R]),G.uHeadlightColor=[Z[0],Z[1],Z[2],1];var $=t.getData3dUI(M);if($){var l=t.isOrtho(),O=l||this._computedProjectMatrix;if(O){var T=t._projectMatrix;l&&(t._ortho=!1),G.uPMatrix=t._projectMatrix=zo(t,!0)}var I=M.p3(),B=this.getEye();(I[0]!==B[0]||I[1]!==B[1]||I[2]!==B[2])&&(M._position.x=B[0],M._54O=B[1],M._position.y=B[2]),$.validate(),$._42(w,H,C),O&&(l&&(t._ortho=!0),G.uPMatrix=t._projectMatrix=T)}w.clear(w.DEPTH_BUFFER_BIT),G.uHeadlightColor=[Z[0],Z[1],Z[2],t._headlightDisabled?1:0]}},getLogicalPoint:function(T){return Ib(T,this._canvas)},isRectOverlapping:function(c){var R=this.getData3dUI(c);return R._rectOverlapping},getHitFaceInfo:function(v){v.target&&(v=this.lp(v));var A=this.getDataInfoAt(v);if(A){var s=this.intersectObject(v,A.data);if(s)return{data:A.data,face:s.part}}return S},unproject:function(Z,q){var h=this,p=h.getWidth(),A=h.getHeight(),b=Z.target?h.lp(Z):Z,I=b.x-p/2,i=b.y-A/2,n=2*(I/p),F=2*(-1*i/A);q=q||0;var O=Pb(),W=zo(h),s=om(h);Jc(O,W,s),qq(O);var U=en([n,F,q,1],O);return[U[0]/U[3],U[1]/U[3],U[2]/U[3]]},getDataAt:function(q){var k=this.getDataInfoAt(q);return k?k.data:S},getDataInfoAt:function(w,N,d){return w.target&&(w=this.lp(w)),this._1o.get(cd(w.x,w.y,N),!0,d)},getDatasInRect:function(t,z){return this._1o.get(t,!1,z)},setEditable:function(U){var $=this,x=$._editable;$._editable=U,this.fp(xq,x,U)},isEditable:function(O){var S=this;return O?S._editable?af(O)?O.s("3d.editable")?S._editableFunc?S._editableFunc(O):!0:!1:!1:!1:S._editable},isSelectable:function(g){return g.s("3d.selectable")&&this.sm().isSelectable(g)},isMovable:function(T){var L=this;return zl(T)&&T.getStyle(bk)!==We?!1:T.s("3d.movable")?L._movableFunc?L._movableFunc(T):!0:!1},isSizeEditable:function(q){return af(q)?this._sizeEditableFunc?this._sizeEditableFunc(q):!0:!1},isRotationEditable:function(q){return af(q)&&q.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(q):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(j){this.setZoom(_c,j)},zoomOut:function(p){this.setZoom(1/_c,p)},setZoom:function(){var d=new se,y=new se,t=new se,l=new se;return function(O,e){if(1!==O){var H=this;H._14o&&H._14o.stop(!0);var V,f=1/O;d.copy(H.getCenter()),y.copy(H.getEye());var u=H._ortho;if(u){if(V=H._orthoWidth,V<H._moveStep&&O>1)return}else if(d.distanceTo(y)<H._moveStep&&1>f)return;var I=!1;return H._zoomToCenter===!1&&H._lastZoomLP&&(t.copy(y).sub(d).normalize(),H._81O=null,l.copy(H.getHitPosition(H._lastZoomLP,d.toArray(),t.toArray())),I=!0,H._lastZoomHit=l),(e=qd(e))?(e.action=function(n){H.fi({kind:H._zooming?"betweenZoom":"beginZoom"}),H._zooming=1;var J=(f-1)*n+1;u&&H.setOrthoWidth(V*J),I?(H.setEye(t.lerpVectors(l,y,J).toArray()),H.setCenter(t.lerpVectors(l,d,J).toArray())):u||H.setEye(t.lerpVectors(d,y,J).toArray())},e._37o=function(){delete H._14o,delete H._zooming,H.fi({kind:"endZoom"}),H.onZoomEnded()},H._14o=Xm(e)):(u&&H.setOrthoWidth(V*f),I?(H.setEye(t.lerpVectors(l,y,f).toArray()),H.setCenter(t.lerpVectors(l,d,f).toArray())):u||H.setEye(t.lerpVectors(d,y,f).toArray()),void 0)}}}(),setOrthoZoom:function(O,f){return this.setZoom(O,f)},getPositionInfo:function(P){var I=this,G=I._eye,f=I._center,w=I.getAspect(),B=P?wr(Od(f,G,!0),Od(P,G)):_h(G,f);if(I._ortho){var Z=I._orthoWidth;return{length:B,height:Z/w,width:Z}}var X=2*Wi(I._fovy/2)*B;return{length:B,height:X,width:X*w}},getCenterInfo:function(){var q=this;return q._81O||(q._81O=q.getPositionInfo()),Dl(q._81O)},rotate:function(v,b,K,T){var j=this;if(v||b){T==S&&(T=j._firstPersonMode),j._88O&&j._88O.stop(!0);var f=j._center,D=j._eye,O=j.getCenterInfo().length,U=T?f:D,y=T?D:f,o=Od(U,y),d=db(o[0],o[2]),P=db(x(o[0]*o[0]+o[2]*o[2]),o[1]),l=T?al:Xj;return T&&(b=-b),(K=qd(K))?(K.action=function(Z){j.fi({kind:j._rotating?"betweenRotate":"beginRotate"}),j._rotating=1;var $=d+v*Z,q=P+b*Z;q=T?X-go(j,X-q):go(j,q),o[0]=O*R(q)*R($),o[1]=O*s(q),o[2]=O*R(q)*s($),U[0]=y[0]+o[0],U[1]=y[1]+o[1],U[2]=y[2]+o[2],j.fp(l,S,U)},K._37o=function(){delete j._88O,delete j._rotating,j.fi({kind:"endRotate"}),j.onRotateEnded()},j._88O=Xm(K)):(d+=v,P+=b,P=T?X-go(j,X-P):go(j,P),o[0]=O*R(P)*R(d),o[1]=O*s(P),o[2]=O*R(P)*s(d),U[0]=y[0]+o[0],U[1]=y[1]+o[1],U[2]=y[2]+o[2],j.fp(l,S,U),void 0)}},pan:function(w,o,Z,v){if(w||o){var J=this;v==S&&(v=J._firstPersonMode),J._89O&&J._89O.stop(!0);var F=om(J),n=[F[0]*w,F[4]*w,F[8]*w],f=[F[1]*o,F[5]*o,F[9]*o],k=n[0]+f[0],r=n[1]+f[1],i=n[2]+f[2],b=J._center,t=J._eye;if(v){var m=Ng(J.getBoundaries(),t[0],t[2],t[0]+k,t[2]+i,x(k*k+i*i));k=m[0],i=m[1]}if(Z=qd(Z)){var a=Dl(t),$=Dl(b);return Z.action=function(w){J.fi({kind:J._panning?"betweenPan":"beginPan"}),J._panning=1,b[0]=$[0]+k*w,b[1]=$[1]+r*w,b[2]=$[2]+i*w,t[0]=a[0]+k*w,t[1]=a[1]+r*w,t[2]=a[2]+i*w,J.fp(Xj,S,t),J.fp(al,S,b)},Z._37o=function(){delete J._89O,delete J._panning,J.fi({kind:"endPan"}),J.onPanEnded()},J._89O=Xm(Z)}b[0]+=k,b[1]+=r,b[2]+=i,t[0]+=k,t[1]+=r,t[2]+=i,J.fp(Xj,S,t),J.fp(al,S,b)}},walk:function(m,O,w){if(m){var E=this;w==S&&(w=E._firstPersonMode),E._90O&&E._90O.stop(!0);var D=E._center,Y=E._eye,r=Od(D,Y,!0);if(w){var A=Ng(E.getBoundaries(),Y[0],Y[2],Y[0]+r[0]*m,Y[2]+r[2]*m,v(m));if(m=_h(A),!m)return;r=[A[0]/m,0,A[1]/m]}if(O=qd(O)){var z=Dl(Y),X=Dl(D);return O.action=function(l){E.fi({kind:E._walking?"betweenWalk":"beginWalk"}),E._walking=1;var x=m*l;Y[0]=z[0]+r[0]*x,Y[1]=z[1]+r[1]*x,Y[2]=z[2]+r[2]*x,D[0]=X[0]+r[0]*x,D[1]=X[1]+r[1]*x,D[2]=X[2]+r[2]*x,E.fp(Xj,S,Y),E.fp(al,S,D)},O._37o=function(){delete E._90O,delete E._walking,E.fi({kind:"endWalk"}),E.onWalkEnded()},E._90O=Xm(O)}Y[0]+=r[0]*m,Y[1]+=r[1]*m,Y[2]+=r[2]*m,D[0]+=r[0]*m,D[1]+=r[1]*m,D[2]+=r[2]*m,E.fp(Xj,S,Y),E.fp(al,S,D)}},handleScroll:function(g,e){as(g);var K=this,a=K._moveStep,V=K.getDataInfoAt(g);if(V){var G=V.data;if(G&&K.isInteractive(G)){var _=K.intersectObject(g,G);if(_){var m=_.part,E=Fr(G.s(m+".image")||G.s("shape3d."+m+".image")||G.s("all.image")||G.s("shape3d.image"));if(E&&dd(E.scrollable,G,K))return}}}return K.isFirstPersonMode()?(K.isPannable()&&K.pan(0,e>0?a:-a),void 0):(K.isZoomable()&&(K._lastZoomLP=K.lp(g),K.setZoom(0>e?1/Ie:Ie),K._lastZoomLP=K._lastZoomHit=null),void 0)},handlePinch:function($,U){if(this.isZoomable()){if(Math.abs($-U)<H.pinchZoomThreshold)return;this.setZoom(U>$?1/Xe:Xe)}},reset:function(t){this.setUp(H.graph3dViewUp),this.moveCamera(H.graph3dViewEye,H.graph3dViewCenter,t)},moveSelection:function(J,M,j){var D=this;D.dm().beginTransaction(),Qk(this.sm().toSelection(this.isMovable,this),J,M,j),D.dm().endTransaction()},getMoveMode:function(Q,G){var X=G.s("3d.move.mode");if(X)return X;var V="88",M="89",C="90";return nr(Q)||$f[V]&&$f[M]&&$f[C]?"xyz":$f[V]&&$f[M]?"xy":$f[V]&&$f[C]?"xz":$f[M]&&$f[C]?"yz":$f[V]?"x":$f[M]?"y":$f[C]?"z":"xz"},handleTick:function(){var U=this,d=!1,i=U._moveStep,e=i,g=!1,H=!0,V=U._rotateStep*(H?-1:1);if(U.isWalkable()||(e=0),U.isPannable()||(i=0),U.isRotatable()||(V=0),U._32Q){var k=(Gm()-U._32Q)/50;e*=k,i*=k,V*=k}U._31Q&&(sd(U._31Q),delete U._31Q,delete U._32Q),Qc()&&(d=!0,U.pan(-i,0,g,H)),jm()&&(d=!0,U.pan(i,0,g,H)),or()&&(d=!0,nr()?U.pan(0,i,g,H):U.walk(e,g,H)),Nq()&&(d=!0,nr()?U.pan(0,-i,g,H):U.walk(-e,g,H)),Lp()&&(d=!0,U.rotate(-V,0,g,H)),Nr()&&(d=!0,U.rotate(V,0,g,H)),dl()&&(d=!0,U.rotate(0,-V/2,g,H)),Se()&&(d=!0,U.rotate(0,V/2,g,H)),d&&(U._32Q=Gm(),U._31Q=Pm(U.handleTick,U))},handleKeyDown:function(E){var M=this;!Uj(E)&&Vi[E.keyCode]?M.handleTick():xo(E)?M.selectAll():zn(E)?M.handleDelete(E):vr(E)&&this.isResettable()&&M.reset()},checkDoubleClickOnNote:function(w,i,p){var x=this;if(p===Ml){if(i.s("note.toggleable"))return i.s(Rg,!i.s(Rg)),x.fi({kind:"toggleNote",event:w,data:i,part:p}),!0}else if(p===Eg&&i.s("note2.toggleable"))return i.s(li,!i.s(li)),x.fi({kind:"toggleNote2",event:w,data:i,part:p}),!0;return!1},checkDoubleClickOnRotation:function(Y,H,h){return h===at?(H.setRotationX(0),!0):h===bt?(H.setRotationY(0),!0):h===ct?(H.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(r){var W=this;if(W.isOrtho())return W.getWidth()/W.getOrthoWidth();var N=W.getCenter(),S=W.getHeight(),U=W.getEye(),s=[N[0]-U[0],N[1]-U[1],N[2]-U[2]],T=[r[0]-U[0],r[1]-U[1],r[2]-U[2]],C=Math.sqrt(s[0]*s[0]+s[1]*s[1]+s[2]*s[2]),D=1/Math.tan(W.getFovy()/2);return S*C*D/(T[0]*s[0]+T[1]*s[1]+T[2]*s[2])},inViewSpace:function(s){var B,w=this,Y=w._transformPointToViewSpace(s),H=w.getAspect(),r=w.getNear(),F=w.getFar();return-Y[2]<r||-Y[2]>F?!1:w.isOrtho()?(B=w.getOrthoWidth()/2,Math.abs(Y[0])<=B&&Math.abs(Y[1]*H)<=B):(B=Math.sqrt(Y[0]*Y[0]+Y[1]*Y[1]+Y[2]*Y[2])*Math.tan(w.getFovy()/2),Math.abs(Y[1]<=B)&&Math.abs(Y[0])<=B*H)},getPVMatrix:function(){var m,T=this;return(m=T._18Q)||(m=zo(T),T._18Q=Jc(m,m,om(T)),T._18Q._wh=T.getWidth()/2/T.getHeight()),m},getFrustum:function(){var f=new xn,n=new bf,y=new Array(16);return function(){for(var x=this.getPVMatrix(),s=!1,b=0;16>b;b++)x[b]!==y[b]&&(s=!0,y[b]=x[b]);return s&&n.setFromMatrix(f.fromArray(x)),n}}(),toViewPosition:function(X){var j=this,l=j.getWidth()/2,V=j.getHeight()/2,g=j.getPVMatrix();return X=en([X[0],X[1],X[2],1],g),{x:l+l*X[0]/X[3],y:V-V*X[1]/X[3],z:X[2]/X[3]}},getHitPosition:function(E,s,$){var U=this,M=U.getWidth(),h=U.getHeight(),w=E.target?U.lp(E):E,X=w.x-M/2,N=w.y-h/2,G=U.getCenterInfo(),Y=om(U);s=s?s:[0,0,0],$=$?$:[0,1,0],X=X/M*G.width,N=-1*N/h*G.height;var i=[Y[0]*X,Y[4]*X,Y[8]*X],I=[Y[1]*N,Y[5]*N,Y[9]*N],u=[i[0]+I[0],i[1]+I[1],i[2]+I[2]],j=U.getCenter(),T=fr(U,s,$,[u[0]+j[0],u[1]+j[1],u[2]+j[2]]);return T?T:[0,0,0]},intersectObject:function(g,J){return this._raycaster.intersectObject(g,J)},intersectObjects:function(u,J,W){return this._raycaster.intersectObjects(u,J,W)},getLineLength:function(K){this.validate();var W=this.getData3dUI(K);if(W&&W.getCache){var x=W.getCache();if(x)return x[x.length-1].length}return 0},getLineOffset:function(l,G){var O=this.getData3dUI(l);if(O&&O.getCache){var s=O.getCache();if(s){var Z=Nb(s,G);if(l.s("shape3d")!==gs)return Z;var x,P;if(l.getScale3d&&(x=l.getScale3d(),1===x[0]&&1===x[1]&&1===x[2]&&(x=null)),l.r3&&(P=l.r3(),0===P[0]&&0===P[1]&&0===P[2]&&(P=null)),!P&&!x)return Z;var $=new se(l.p3()),X=new se(Z.point).sub($),T=new se(Z.tangent).add(X);if(x&&(x=new se(x),X.multiply(x),T.multiply(x)),P){var C=(new Mq).setFromEuler(new pq(P,l.getRotationMode(),!0));X.applyQuaternion(C),T.applyQuaternion(C)}return{point:X.clone().add($),tangent:T.sub(X).normalize()}}}return S},_genBatchInstancedArrayFunc:function(){var h=this._glCapabilities&&this._glCapabilities.instancedArray&&!this._batchInstancedDisabled,R=h?Hl:Ud;this.batchInstancedModel=function(H,g,F,m,P,W,l){R(this,H,g,F,m,P,W,l)};var U=h?Yl:fo;this.batchInstancedShapeFace=function(k,p,g){U(k,p,g)};var S=h?$h:Fj;this.batchInstancedFace=function(i,j,E,T,u){S(this,i,j,E,T,u)}},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(V,i,w){var b=this,t=b.getEye();t=[t[0],t[1],t[2]];var R=b.getCenter();if(R=[R[0],R[1],R[2]],V||(V=t),i||(i=R),b._flyAnim&&b._flyAnim.stop(!0),w=qd(w),!w)return b.setEye(V[0],V[1],V[2]),b.setCenter(i[0],i[1],i[2]),delete b._flyAnim,!0;var E=[V[0]-t[0],V[1]-t[1],V[2]-t[2]],g=[i[0]-R[0],i[1]-R[1],i[2]-R[2]];return w.action=function(p){b.setCenter(R[0]+g[0]*p,R[1]+g[1]*p,R[2]+g[2]*p),b.setEye(t[0]+E[0]*p,t[1]+E[1]*p,t[2]+E[2]*p)},w._37o=function(){delete b._flyAnim},b._flyAnim=Xm(w)},flyTo:function(){function P(h,o,s){if(s instanceof n.Node){Y.fromArray(tp(s,o.getMat(s)));var i=s.getAnchor3d();h.push((new se).set(0-i.x,0-i.y,0-i.z).applyMatrix4(Y)),h.push((new se).set(0-i.x,0-i.y,1-i.z).applyMatrix4(Y)),h.push((new se).set(0-i.x,1-i.y,0-i.z).applyMatrix4(Y)),h.push((new se).set(0-i.x,1-i.y,1-i.z).applyMatrix4(Y)),h.push((new se).set(1-i.x,0-i.y,0-i.z).applyMatrix4(Y)),h.push((new se).set(1-i.x,0-i.y,1-i.z).applyMatrix4(Y)),h.push((new se).set(1-i.x,1-i.y,0-i.z).applyMatrix4(Y)),h.push((new se).set(1-i.x,1-i.y,1-i.z).applyMatrix4(Y))}}var g=new se,E=new se,d=new se,G=new se,S=new se,Y=new xn,$=new n.Math.Quaternion,X=new pq,p=new Pf;return function(y,e,M){var O=this;"boolean"==typeof e&&(e={animation:e}),e=e||{};var V=e.center,r=e.distance,Y=e.direction,D=e.worldDirection,Q=M||e.ratio||.8,N=e.xRatio||Q,B=e.yRatio||Q;(M!==W||e.duration||e.frames)&&(e={animation:e});var a,i,L=[],Z=r===W;if(V&&d.fromArray(V),!V||Z)if(y||(y=O.dm().getDatas()),1===y.length&&(y=No(y)?y.get(0):y[0]),y instanceof n.Node)V||d.fromArray(y.p3()),Z&&(P(L,O,y),a=L.length);else{if(!y.length)return;if((Z||!V)&&(L=[],y.forEach(function(F){P(L,O,F)}),a=L.length,!a))return;V||(p.setFromPoints(L),d.copy(p.min).add(p.max).multiplyScalar(.5))}if(O._flyAnim&&O._flyAnim.stop(!0),g.fromArray(O.getEye()),E.fromArray(O.getCenter()),O.setCenter(d.x,d.y,d.z),G.subVectors(g,E),Y||D){!D&&y instanceof n.Node?$.setFromEuler(X.set(y.r3(),y.getRotationMode(),!0)):$.set(0,0,0,1);var _=G.length();G.fromArray(D||Y).applyQuaternion($).setLength(_)}var h=new se(O.getUp()),A=Po.fequal(h.x,0,1e-5)&&Po.fequal(h.z,0,1e-5);if(A&&0===G.x&&0===G.z){var C=.001,I=G.y;G.y=I*(1-C),G.z=Math.sign(I)*C}var v=0;if(Z){var w,j,t,s=N,J=B;if(S.copy(G),O.isOrtho()){var o=-1/0;for(O._eye[0]=G.x+d.x,O._eye[1]=G.y+d.y,O._eye[2]=G.z+d.z,w=zo(O),Jc(w,w,om(O)),i=0;a>i;i++)t=L[i],j=en([t.x,t.y,t.z,1],w),o=Math.max(o,Math.max(Math.abs(j[0])/s,Math.abs(j[1])/J));v=O.getOrthoWidth()*o}else{for(var f,c,x=O.getNear(),u=10;u--;){for(O._eye[0]=G.x+d.x,O._eye[1]=G.y+d.y,O._eye[2]=G.z+d.z,w=zo(O),Jc(w,w,om(O)),f=!0,c=-1/0,i=0;a>i;i++){if(t=L[i],j=en([t.x,t.y,t.z,1],w),j[3]<x&&u){G.multiplyScalar(2),f=!1;break}c=Math.max(c,Math.max(Math.abs(j[0])/s,Math.abs(j[1])/J)-j[3])}if(f)break}G.setLength(c+G.length())}G.manhattanLength()<1e-6&&G.copy(S)}else G.setLength(r);var z=G.add(d),q=qd(e.animation);if(q){O.setEye(g.x,g.y,g.z),O.setCenter(E.x,E.y,E.z);var T=z.clone().sub(d),R=T.length();R&&T.multiplyScalar(1/R);var K=g.clone().sub(E),m=K.length();m&&K.multiplyScalar(1/m);var U=(new xn).lookAtDirection(K,h),k=(new xn).lookAtDirection(T,h),b=(new Mq).setFromRotationMatrix(U),F=(new Mq).setFromRotationMatrix(k),l=(new se).subVectors(d,E);if(v)var Tf=O.getOrthoWidth();var cl=new se,wo=new se,Wq=new se,bp=q.action,Uc=q._37o,hd=E.clone();return q.action=function(g,S){wo.copy(hd).addScaledVector(l,g);var f=b.clone().slerp(F,g);cl.set(0,0,1).applyQuaternion(f).setLength(m+(R-m)*g).add(wo),Wq.set(0,1,0).applyQuaternion(f),O.setCenter(wo.x,wo.y,wo.z),O.setEye(cl.x,cl.y,cl.z),O.setUp(Wq.x,Wq.y,Wq.z),v&&O.setOrthoWidth((v-Tf)*g+Tf),bp&&bp(g,S)},q._37o=function(){delete O._flyAnim;var D=O.getUp(),i=A?H.graph3dViewUp:h.toArray();(D[0]!==i[0]||D[1]!==i[1]||D[2]!==i[2])&&O.setUp(i),Uc&&Uc()},{lastEye:g,lastCenter:E,eye:z,center:d,orthoWidth:v,animation:O._flyAnim=Xm(q)}}return O.setEye(z.x,z.y,z.z),O.setCenter(d.x,d.y,d.z),v&&O.setOrthoWidth(v),delete O._flyAnim,{lastEye:g,lastCenter:E,eye:z,center:d,orthoWidth:v}}}(),getBoundingBox:function(){function c(K,B,u){j.fromArray(tp(u,B.getMat(u)));var x=u.getAnchor3d();K.push((new se).set(0-x.x,0-x.y,0-x.z).applyMatrix4(j)),K.push((new se).set(0-x.x,0-x.y,1-x.z).applyMatrix4(j)),K.push((new se).set(0-x.x,1-x.y,0-x.z).applyMatrix4(j)),K.push((new se).set(0-x.x,1-x.y,1-x.z).applyMatrix4(j)),K.push((new se).set(1-x.x,0-x.y,0-x.z).applyMatrix4(j)),K.push((new se).set(1-x.x,0-x.y,1-x.z).applyMatrix4(j)),K.push((new se).set(1-x.x,1-x.y,0-x.z).applyMatrix4(j)),K.push((new se).set(1-x.x,1-x.y,1-x.z).applyMatrix4(j))}var j=new xn;return function(j){if(j=j||this.sm().getSelection(),j instanceof n.Node&&(j=[j]),0===j.length)return S;var $=[];j.forEach(function(w){af(w)&&c($,this,w)},this);var l=[1/0,1/0,1/0],B=[-1/0,-1/0,-1/0];return $.forEach(function(O){l[0]=Math.min(O.x,l[0]),l[1]=Math.min(O.y,l[1]),l[2]=Math.min(O.z,l[2]),B[0]=Math.max(O.x,B[0]),B[1]=Math.max(O.y,B[1]),B[2]=Math.max(O.z,B[2])}),{min:l,max:B}}}(),setBatchInfo:function(I,s){var V=this._batchInfoMap[I];this._batchInfoMap[I]=s,this.fp("batchInfo",V,s)},getBatchInfo:function(a){return this._batchInfoMap[a]||Hd[a]},setOrthoWidth:function(i){var z=this._orthoWidth;if(this._orthoWidth=i,this._syncEyeWithOrthoWidth){var P=i/this.getAspect(),k=P/2/Wi(this.getFovy()/2),Q=(new se).fromArray(this.getEye()),g=(new se).fromArray(this.getCenter());Q.sub(g).setLength(k).add(g),this.setEye(Q.toArray())}this.fp("orthoWidth",z,i)},getCamera:function(g){var r=this;g||(g=r._mainCamera,g||(g=r._mainCamera=new n.Camera)),g.s({"camera.type":r.isOrtho()?"ortho":"perspective","camera.aspect":r.getAspect(),"camera.fovy":r.getFovy(),"camera.ortho.width":r.getOrthoWidth(),"camera.near":r.getNear(),"camera.far":r.getFar()});var $=r.getEye();return g.p3($.slice()),g.lookAt(r.getCenter(),r.getUp()),g},resetHeadlightProperties:function(){this._headlightColor=H.graph3dViewHeadlightColor,this._headlightIntensity=H.graph3dViewHeadlightIntensity,this._headlightRange=H.graph3dViewHeadlightRange,this._headlightDirection=H.graph3dViewHeadlightDirection,this._headlightGroup=H.graph3dViewHeadlightGroup,this._headlightAmbientIntensity=H.graph3dViewHeadlightAmbientIntensity,this._headlightDisabled=H.graph3dViewHeadlightDisabled},resetFogProperties:function(){this._fogDisabled=H.graph3dViewFogDisabled,this._fogMode=H.graph3dViewFogMode,this._fogDensity=H.graph3dViewFogDensity,this._fogColor=H.graph3dViewFogColor,this._fogNear=H.graph3dViewFogNear,this._fogFar=H.graph3dViewFogFar}}),function(){function j(E,A,g){var x=E[A];x&&x.releaseTexture(),E[A]=g}function s(){return["\n #ifdef ENVMAP_TYPE_CUBE_UV \n","#define cubeUV_maxMipLevel 8.0 \n","#define cubeUV_minMipLevel 4.0 \n","#define cubeUV_maxTileSize 256.0 \n","#define cubeUV_minTileSize 16.0 \n","float getFace(vec3 direction) {","vec3 absDirection = abs(direction);","float face = - 1.0;","if (absDirection.x > absDirection.z) {","if (absDirection.x > absDirection.y)","face = direction.x > 0.0 ? 0.0 : 3.0;"," else ","face = direction.y > 0.0 ? 1.0 : 4.0;","} else {","if (absDirection.z > absDirection.y) ","face = direction.z > 0.0 ? 2.0 : 5.0;"," else ","face = direction.y > 0.0 ? 1.0 : 4.0;","}","return face;","} ","vec2 getUV(vec3 direction, float face) {","vec2 uv;","if (face == 0.0) {","uv = vec2(direction.z, direction.y) / abs(direction.x);","} else if (face == 1.0) {","uv = vec2(- direction.x, - direction.z) / abs(direction.y);","} else if (face == 2.0) {","uv = vec2(- direction.x, direction.y) / abs(direction.z);","} else if (face == 3.0) {","uv = vec2(- direction.z, direction.y) / abs(direction.x);","} else if (face == 4.0) {","uv = vec2(- direction.x, direction.z) / abs(direction.y);","} else {","uv = vec2(direction.x, direction.y) / abs(direction.z);","}","return 0.5 * (uv + 1.0);","} ","vec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {","float face = getFace(direction);","float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);","mipInt = max(mipInt, cubeUV_minMipLevel);","float faceSize = exp2(mipInt);","float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);","vec2 uv = getUV(direction, face) * (faceSize - 1.0);","vec2 f = fract(uv);","uv += 0.5 - f;","if (face > 2.0) {","uv.y += faceSize;","face -= 3.0;","}","uv.x += face * faceSize;","if (mipInt < cubeUV_maxMipLevel) {","uv.y += 2.0 * cubeUV_maxTileSize;","}","uv.y += filterInt * 2.0 * cubeUV_minTileSize;","uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);","uv *= texelSize;","vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.x += texelSize;","vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.y += texelSize;","vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.x -= texelSize;","vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","vec3 tm = mix(tl, tr, f.x);","vec3 bm = mix(bl, br, f.x);","return mix(tm, bm, f.y);","}","\n #define r0 1.0 \n","#define v0 0.339 \n","#define m0 - 2.0 \n","#define r1 0.8 \n","#define v1 0.276 \n","#define m1 - 1.0 \n","#define r4 0.4 \n","#define v4 0.046 \n","#define m4 2.0 \n","#define r5 0.305 \n","#define v5 0.016 \n","#define m5 3.0 \n","#define r6 0.21 \n","#define v6 0.0038 \n","#define m6 4.0 \n","float roughnessToMip(float roughness) {","float mip = 0.0;","if (roughness >= r1) {","mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;","} else if (roughness >= r4) {","mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;","} else if (roughness >= r5) {","mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;","} else if (roughness >= r6) {","mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;","} else {","mip = - 2.0 * log2(1.16 * roughness);","}","return mip;","} ","vec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {","float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);","float mipF = fract(mip);","float mipInt = floor(mip);","vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);","if (mipF == 0.0) {","return vec4(color0, 1.0);","} else {","vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);","return vec4(mix(color0, color1, mipF), 1.0);","}","} ","\n #endif \n"].join("")}function b(){return["vec4 sRGBToLinear( in vec4 value ) {","return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );","}","vec4 LinearTosRGB( in vec4 value ) {","return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );","}","vec4 inputTexelToLinear( vec4 value ) { return sRGBToLinear( value ); }","vec4 linearToOutputTexel( vec4 value ) { return LinearTosRGB( value ); }","vec4 envMapTexelToLinear( vec4 color ) { return inputTexelToLinear( color ); }"].join("")}function m(){return["precision mediump float;\n","precision mediump int;\n","attribute vec3 position;","attribute vec2 uv;","attribute float faceIndex;","varying vec3 vOutputDirection;","vec3 getDirection( vec2 uv, float face ) {","uv = 2.0 * uv - 1.0;","vec3 direction = vec3( uv, 1.0 );","if ( face == 0.0 ) { direction = direction.zyx; } ","else if ( face == 1.0 ) { direction = direction.xzy; direction.xz *= -1.0; } ","else if ( face == 2.0 ) { direction.x *= -1.0; }","else if ( face == 3.0 ) { direction = direction.zyx; direction.xz *= -1.0; } ","else if ( face == 4.0 ) { direction = direction.xzy; direction.xy *= -1.0; } ","else if ( face == 5.0 ) { direction.z *= -1.0; }","return direction;","}","void main() {","vOutputDirection = getDirection( uv, faceIndex );","gl_Position = vec4( position, 1.0 );","}"].join("")}function B(){return{vs:m(),fs:["precision mediump float;\n","precision mediump int;\n","varying vec3 vOutputDirection;","uniform samplerCube envMap;\n",b(),"\n void main() {","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","gl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3(- vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")}}function U(){return{vs:m(),fs:["precision mediump float;\n","precision mediump int;\n","varying vec3 vOutputDirection;","uniform sampler2D envMap;","uniform vec2 texelSize;\n",b(),"\n #define RECIPROCAL_PI 0.3183098861837907 \n","\n #define RECIPROCAL_PI2 0.15915494309189535 \n","vec2 equirectUv( in vec3 dir ) {","float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;","float v = 0.5 - asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI;","return vec2( u, v );","}","void main() {","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","vec3 outputDirection = normalize( vOutputDirection );","vec2 uv = equirectUv( outputDirection );","vec2 f = fract( uv / texelSize - 0.5 );","uv -= f * texelSize;","vec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.x += texelSize.x;","vec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.y += texelSize.y;","vec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.x -= texelSize.x;","vec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","vec3 tm = mix( tl, tr, f.x );","vec3 bm = mix( bl, br, f.x );","gl_FragColor.rgb = mix( tm, bm, f.y );","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")}}function d(U){return{vs:m(),fs:["precision mediump float;\n","precision mediump int;\n","#define n "+U+"\n","varying vec3 vOutputDirection;","uniform sampler2D envMap;","uniform int samples;","uniform float weights[ n ];","uniform bool latitudinal;","uniform float dTheta;","uniform float mipInt;","uniform vec3 poleAxis; \n",b(),"\n #define ENVMAP_TYPE_CUBE_UV \n",s(),"\n vec3 getSample( float theta, vec3 axis ) {","float cosTheta = cos( theta );","vec3 sampleDirection = vOutputDirection * cosTheta + cross(axis, vOutputDirection) * sin(theta) + axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);","return bilinearCubeUV( envMap, sampleDirection, mipInt );","}","void main() {","vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );","if ( all( equal( axis, vec3( 0.0 ) ) ) ) {","axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );","}","axis = normalize( axis );","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );","for ( int i = 1; i < n; i++ ) {","if ( i >= samples ) { break; }","float theta = dTheta * float( i );","gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );","gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );","}","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")}}var $=ko.EnvmapRenderer=function(v){this.gv=v,this._envmaps={},this._envmapHash={},this._probeCaptureTime={},this._pingPongRenderTarget=null,this._equirectShader=null,this._cubemapShader=null,this._blurMaterial=null,this._lastCaptureFrame=0
};$.prototype={},$.prototype.constructor=$,$.prototype.changeEnvmapType=function(x){"legacy"===x?(this.setEnvmapByProbeId=this.setEnvmapLegacy,this.onBeforeRender=this.onBeforeRenderLegacy):(this.setEnvmapByProbeId=this.setEnvmap,this.onBeforeRender=this.onBeforeRenderNew)},$.prototype.invalidateEnvmap=function(Y){var W=this.gv;if("legacy"!==W.getEnvmapType()){var $=W.getGL();$&&(Y?(delete this._envmapHash[Y],delete this._probeCaptureTime[Y]):(this._envmapHash={},this._probeCaptureTime={}),W.iv())}},$.prototype.contextLost=function(){var l=this;l._envmaps={},l._envmapHash={},l._pingPongRenderTarget=null,l._equirectShader=l._cubemapShader=l._blurMaterial=null,l._envmapLegacy=null,l._lastLegacyImage=null},$.prototype.onBeforeRenderLegacy=function(J){this.assureTextureLegacy(J)},$.prototype.assureTextureLegacy=function(F){var T=this,O=T.gv,v=O.getEnvmap();if(v!==T._lastLegacyImage){if(T._envmapLegacy&&(F.deleteTexture(T._envmapLegacy),T._envmapLegacy=null),!v)return T._lastLegacyImage=v,void 0;var $=H.getImage(v);if($&&$.tagName){$=H.resizeImagePOT($,!0);var o=T._envmapLegacy=F.createTexture();F.activeTexture(F.TEXTURE0),F.bindTexture(F.TEXTURE_CUBE_MAP,o),F.texParameteri(F.TEXTURE_CUBE_MAP,F.TEXTURE_MAG_FILTER,F.LINEAR),F.texParameteri(F.TEXTURE_CUBE_MAP,F.TEXTURE_MIN_FILTER,F.LINEAR),F.texImage2D(F.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,F.RGBA,F.RGBA,F.UNSIGNED_BYTE,$),F.texImage2D(F.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,F.RGBA,F.RGBA,F.UNSIGNED_BYTE,$),F.texImage2D(F.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,F.RGBA,F.RGBA,F.UNSIGNED_BYTE,$),F.texImage2D(F.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,F.RGBA,F.RGBA,F.UNSIGNED_BYTE,$),F.texImage2D(F.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,F.RGBA,F.RGBA,F.UNSIGNED_BYTE,$),F.texImage2D(F.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,F.RGBA,F.RGBA,F.UNSIGNED_BYTE,$),F.bindTexture(F.TEXTURE_CUBE_MAP,F._emptyCubeTexture),T._lastLegacyImage=v}}},$.prototype.setEnvmapLegacy=function(g){g.uEnvMap=this._envmapLegacy},$.prototype.onBeforeRenderNew=function(z){this.assureTextureNew(z),this.resetUniformCache()},$.prototype.assureTextureNew=function(s){var B=this,T=B.gv,h=T.getEnvmap(),O=B._envmapHash,g=B._envmaps,p=s._renderInfo.frame;if(!(this._lastCaptureFrame>=p||T._picking))for(var Q in h){var o,S=h[Q],a=S.type;switch(a){case"sphere":o=S.image,o!==O[Q]&&(eo=H.getImage(o),eo&&(O[Q]=o,j(g,Q,B.fromEquirectangular(o))));break;case"cube":var A=S.images;if(A&&6===A.length&&(o=A.join(","),o!==O[Q])){for(var d=!0,Z=0;6>Z;Z++)if(!H.getImage(A[Z])){d=!1;break}d&&(O[Q]=o,j(g,Q,B.fromCubemap(A)))}break;case"skybox":var y=T.getSkybox();if(y){var P=y.s("shape3d");if(o="sphere"===P?y._id+"_"+y.s("shape3d.image"):y._id+"_"+y.s("front.image"),o!==O[Q]){var d;if("sphere"===P)d=H.getImage(y.s("shape3d.image"));else{d=!0;for(var z=["front","back","left","right","top","bottom"],Z=0;6>Z;Z++)if(!H.getImage(y.s(z[Z]+".image"))){d=!1;break}}d&&(O[Q]=o,j(g,Q,B.fromSkybox()))}}break;case"probe":var i=S.pos,l=S.size;if(o=i[0]+"_"+i[1]+"_"+i[2]+"_"+l,o!==O[Q]){var v=this._probeCaptureTime[o],r=Date.now();v||(this._probeCaptureTime[o]=v=r),r-v>H.envmapProbeMinWaitTime&&!Qr&&!Nm||r-v>H.envmapProbeMaxWaitTime?(delete this._probeCaptureTime[o],O[Q]=o,j(g,Q,B.fromSceneProbe(i,l,S.filter))):T.iv()}}}},$.prototype.resetUniformCache=function(){this._frameUniformCache={}},$.prototype.setEnvmap=function(Z,O){var f=Z.uuid,M=this._frameUniformCache,Q=this._envmaps[O];Q&&(Q=Q.texture),M[f]!==Q&&(M[f]=Q,Z.uEnvMap=Q)},$.prototype.fromEquirectangular=function(T){var K=n.Default.getImage(T);return this.rectSize=[1/K.width,1/K.height],T=this.gv.getTexture(T),this.fromTexture(T)},$.prototype.fromCubemap=function(y){var d=this.gv.getGL(),P=d.createTexture();d.activeTexture(d.TEXTURE0),d.bindTexture(d.TEXTURE_CUBE_MAP,P),d.texParameteri(d.TEXTURE_CUBE_MAP,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_CUBE_MAP,d.TEXTURE_MIN_FILTER,d.LINEAR);for(var w=[],D=N/3,G=0;6>G;G++)w[G]=H.resizeImage(n.Default.getImage(y[G]),D);return d.texImage2D(d.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,w[0]),d.texImage2D(d.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,w[1]),d.texImage2D(d.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,w[2]),d.texImage2D(d.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,w[3]),d.texImage2D(d.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,w[4]),d.texImage2D(d.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,w[5]),d.bindTexture(d.TEXTURE_CUBE_MAP,d._emptyCubeTexture),this.fromTexture(P,!0)},$.prototype.fromTexture=function(P,J){var Q=this._allocateTargets();this._pingPongRenderTarget||(this._pingPongRenderTarget=this._allocateTargets());var n=this.gv,Y=n.getGL(),t=el.for(Y).directState(),y=t.depth.enabled;t.scissor.enabled=!0,t.depth.enabled=!1;var d=n.getViewport(Y);return this._textureToCubeUV(P,Q,J),this._applyPMREM(Q),Q.unbind(Y),n.setViewport(Y,d[0],d[1],d[2],d[3]),t.depth.enabled=y,t.scissor.enabled=!1,Q},$.prototype.fromSkybox=function(){return this._fromCamera(function(V){V.s({"camera.onlySky":!0})})},$.prototype.fromScene=function(W){return this._fromCamera(function(X){X.s({"camera.onlySky":!1}),W&&W(X)})},$.prototype.fromNode=function(z){var w=this.gv.getData3dUI(z),H=w._42;w._42=wi;var b=this.gv.getSkybox(),d=z.p3();if(b){var o=b.p3();b.p3(d)}var M=this.fromScene(function(c){c.p3(d)});return w._42=H,b&&b.p3(o),M},$.prototype.fromSceneProbe=function(E,G,q){var J=this.gv,M=J.getSkybox();if(M){var K=M.p3();M.p3(E)}if(q){var A=J.isVisible;J.isVisible=function(n){var O=q(n);return O!==W?O:A.call(J,n)}}var d=this.fromScene(function(h){h.p3(E),h.s("camera.near",G)});return q&&(J.isVisible=A),M&&M.p3(K),d},$.prototype._fromCamera=function(O){var p=this.gv,$=p.getCamera();O&&O($);var v=new Ms(p,N,N,{cube:!0}),w=p.getGL(),j=p.getViewport(w),L=this.setEnvmapByProbeId,D=this.onBeforeRender;this.setEnvmapByProbeId=function(a){a.envMap=w._emptyTexture},this.onBeforeRender=wi,$.attachRenderTarget(v),$.render(p),$.detachRenderTarget(),this.setEnvmapByProbeId=L,this.onBeforeRender=D,p.setViewport(w,j[0],j[1],j[2],j[3]);var B=this.fromTexture(v.texture,!0);return v.releaseTexture(),B},$.prototype._allocateTargets=function(){return new Ms(this.gv,3*F,3*F,{magFilter:Of.NEAREST,minFilter:Of.NEAREST})},$.prototype._textureToCubeUV=function(r,v,y){var A,w=this.gv;y?null==(A=this._cubemapShader)&&(this._cubemapShader=A=this.createShader(B())):null==(A=this._equirectShader)&&(this._equirectShader=A=this.createShader(U()));var K=w.getGL();v.bind(K),this._setViewport(v,0,0,3*F,2*F);var s=w.getRenderState();s.useProgram(A);var c=s.directUniforms(),o=s.directAttribs();c.envMap=r,y||(c.texelSize=this.rectSize);var j=p[0];o.position=Lo(K,null,j.vs,S,3),o.uv=Lo(K,null,j.uv,S,2),o.faceIndex=Lo(K,null,j.faceIs,S,1),Oe(K,0,j.vs.length/3)},$.prototype._applyPMREM=function(n){for(var F,E,b,F=1;L>F;F++)E=Math.sqrt(P[F]*P[F]-P[F-1]*P[F-1]),b=V[(F-1)%V.length],this._blur(n,F-1,F,E,b)},$.prototype._setViewport=function(n,V,o,x,S){var Y=this.gv;Y.setViewport(Y.getGL(),V,o,x,S),Y.getRenderState().directState().scissor.box=[V,o,x,S]},$.prototype._blur=function(h,x,t,v,m){var X=this._pingPongRenderTarget;this._halfBlur(h,X,x,t,v,"latitudinal",m),this._halfBlur(X,h,t,t,v,"longitudinal",m)},$.prototype.createShader=function(L){var p=this.gv;return p.getPostProcessing().createShader(p.getGL(),L).program},$.prototype._halfBlur=function(Q,b,i,J,M,Y,L){var _=this.gv,q=this._blurMaterial;if("latitudinal"===Y||"longitudinal"===Y){q||(this._blurMaterial=q=this.createShader(d(c)));var O=_.getGL();b.bind(O);var E=3,T=_.getRenderState();T.useProgram(q);var s,m,g,W=T.directUniforms(),t=T.directAttribs(),v=I[i]-1,$=isFinite(M)?Math.PI/(2*v):2*Math.PI/(2*c-1),B=M/$,j=isFinite(M)?1+Math.floor(E*B):c,n=[],Z=0;for(s=0;c>s;++s)m=s/B,g=Math.exp(-m*m/2),n.push(g),0==s?Z+=g:j>s&&(Z+=2*g);for(s=0;s<n.length;s++)n[s]=n[s]/Z;W.envMap=Q.texture,W.samples=j,W.weights=n,W.latitudinal="latitudinal"===Y,L&&(W.poleAxis=L),W.dTheta=$,W.mipInt=z-i;var h=I[J],m=3*Math.max(0,F-2*h),X=(0===J?0:2*F)+2*h*(J>z-A?J-z+A:0);this._setViewport(b,m,X,3*h,2*h);var P=p[J];t.position=Lo(O,null,P.vs,S,3),t.uv=Lo(O,null,P.uv,S,2),t.faceIndex=Lo(O,null,P.faceIs,S,1),Oe(O,0,P.vs.length/3),b.unbind(O)}};var A=4,z=8,F=Math.pow(2,z),w=[.125,.215,.35,.446,.526,.582],L=z-A+1+w.length,c=20,D=(1+Math.sqrt(5))/2,Z=1/D,V=[new se(1,1,1),new se(-1,1,1),new se(1,1,-1),new se(-1,1,-1),new se(0,D,Z),new se(0,D,-Z),new se(Z,0,D),new se(-Z,0,D),new se(D,Z,0),new se(-D,Z,0)],Y=function(){for(var r=[],c=[],m=[],u=z,h=0;L>h;h++){var d=Math.pow(2,u);c.push(d);var P=1/d;h>z-A?P=w[h-z+A-1]:0==h&&(P=0),m.push(P);for(var n=1/(d-1),D=-n/2,G=1+n/2,U=6,T=[],S=[],a=[],x=0;U>x;x++){var Q=2*(x%3)/3-1,$=x>2?0:-1;T.push(Q,$,0,Q+2/3,$,0,Q+2/3,$+1,0,Q,$,0,Q+2/3,$+1,0,Q,$+1,0),S.push(D,D,G,D,G,G,D,D,G,G,D,G),a.push(x,x,x,x,x,x)}r.push({vs:new mo(T),uv:new mo(S),faceIs:new mo(a)}),u>A&&u--}return{_lodPlanes:r,_sizeLods:c,_sigmas:m}}(),p=Y._lodPlanes,I=Y._sizeLods,P=Y._sigmas,N=H.EnvmapTextureSize}();var Js=["left","front","right","back","top","bottom"],Ks=ko._RenderList=function(V){function t(){M.length=0,s.length=0,Q={}}function G(X){var D,k,L,J,V=X.gv,o=X.data,A=X.shapeModel;if(A){var r,C,T,Q=o.s("shape3d.transparent")||o.s("points.transparent");for(Td(A)||(r=dd(A.transparent,o,V),A=[A]),L=0,J=A.length;J>L;L++)T=A[L],C=dd(T.transparent,o,V),C===W&&(C=r),C===W&&(C=Q),C?k=!0:D=!0}for(L=0,J=Js.length;J>L;L++){var s=X[Js[L]];s&&(s.transparent?k=!0:D=!0)}V.isLabelVisible(o)&&(X.labelInfo&&(o.s(Jo+".transparent")?k=!0:D=!0),X.label2Info&&(o.s(tj+".transparent")?k=!0:D=!0)),V.isNoteVisible(o)&&(X.noteInfo&&(o.s(Ml+".transparent")?k=!0:D=!0),X.note2Info&&(o.s(Eg+".transparent")?k=!0:D=!0)),X._38o&&(k=D=!0),k||(D=!0),X._renderParams={opaque:D,transparent:k}}function R(y,B){B&&G(y);var t=y.data,b=t._id;if(!Q[b]){Q[b]=!0;var l=y._renderParams;l&&l.visible!==!1&&(y={ui:y,data:t,z:0,id:b},l.opaque&&M.push(y),l.transparent&&s.push(y))}}function Y(m,F){if(s.length>1){for(var Q,C,Z=[0,0,0,0],w=0,q=s.length;q>w;w++)Q=s[w].data,(C=Q._position)?(Z[0]=C.x,Z[1]=Q._54O,Z[2]=C.y,Z[3]=1,en(Z,F),s[w].z=Z[2]/Z[3]):s[w].z=0;s.sort(m||$)}}function T(B){B?(Dm(i,C,B,V),Dm(E,U,B,V),Dm(u,I,B,V)):(i=this.batchModelMap={},C=this.batchIndexMap={},E=this.polylineModelMap={},U=this.polylineIndexMap={},u=this.wireframeModelMap={},I=this.wireframeIndexMap={}),this.markBatchInvalid()}function X(R){R?Dm(i,C,R,V):(i=this.batchModelMap={},C=this.batchIndexMap={}),this.markBatchInvalid()}function n(N){N?Dm(E,U,N,V):(E=this.polylineModelMap={},U=this.polylineIndexMap={}),this.markBatchInvalid()}function P(L){L?Dm(u,I,L,V):(u=this.wireframeModelMap={},I=this.wireframeIndexMap={}),this.markBatchInvalid()}function o(){return this._batchInvalid}function B(){this._batchInvalid=!0}function K(){this._batchInvalid=null}var M=[],s=[],i={},C={},E={},U={},u={},I={},Q={};return{opaque:M,transparent:s,init:t,push:R,batchModelMap:i,batchIndexMap:C,polylineModelMap:E,polylineIndexMap:U,wireframeModelMap:u,wireframeIndexMap:I,ivBatch:T,ivModelBatch:X,ivPolylineBatch:n,ivWireframeBatch:P,markBatchInvalid:B,isBatchInvalid:o,onUpdated:K,sort:Y}},Ls=ko._RenderLists=function(S){function T(){for(var o in J)J[o].init()}function O(){for(var L in J)J[L].onUpdated()}function b(Z,G){Z=Z||"main";var C=J[Z];return!C&&G&&(C=J[Z]=new Ks(S)),C}function V(p,a){var f=p.data.getRenderLayer(),z=b(f,!0);z.push(p,a)}function U(v){for(var O in J)v(J[O])}var J={};return{init:T,onUpdated:O,get:b,push:V,each:U,lists:J}},Ms=ko.RenderTarget=function(C,$,r,M){var W,s=this;null!=$&&$.canvas?(W=$,$=r,r=M,M=arguments[4]):W=C.getGL(),M=M||{},M.cube===!!M.cube,M.samples=M.cube?0:Math.min(C._glCapabilities.maxSamples,M.samples&&M.samples>1&&2===C._webGLVersion?M.samples:0),s.options=M,s.uuid=n.Math.generateUUID(),s.gv=C,s.init(C,W,M),s.format=M.format||Of.RGBA,s.generateMipmaps=!!M.generateMipmaps,M.samples&&!C._glCapabilities._maxSamplesChecked?s.setSize(W,$||1,r||1):s.setSize(W,$,r)};o.assign(ko.RenderTarget.prototype,{bind:function(P,R){var h=this.options;if(h.autoSize){var A=this.gv,b=A.getDevicePixelRatio(),c=A.getWidth()*b,W=A.getHeight()*b;this.setSize(P,c,W)}h.cube?Mn(P,this.frame[R]):Mn(P,this.options.samples?this._MSAAFbo:this.frame)},unbind:function(A){Uq(A),this.options.samples&&(A.bindFramebuffer(A.READ_FRAMEBUFFER,this._MSAAFbo),A.bindFramebuffer(A.DRAW_FRAMEBUFFER,this.frame),A.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,A.COLOR_BUFFER_BIT,A.NEAREST),A.bindFramebuffer(A.READ_FRAMEBUFFER,null),A.bindFramebuffer(A.DRAW_FRAMEBUFFER,null))},isCube:function(){return this.options.cube},init:function(e,v,B){var D=this,I=B.samples,d=B.cube,P=D.texture=v.createTexture(),n=d?Of.TEXTURE_CUBE_MAP:Of.TEXTURE_2D;v.activeTexture(v.TEXTURE0),v.bindTexture(n,P),v.texParameteri(n,v.TEXTURE_WRAP_S,B.wrapS||v.CLAMP_TO_EDGE),v.texParameteri(n,v.TEXTURE_WRAP_T,B.wrapT||v.CLAMP_TO_EDGE);var S=I?v.NEAREST:v.LINEAR;if(v.texParameteri(n,v.TEXTURE_MIN_FILTER,B.minFilter||S),v.texParameteri(n,v.TEXTURE_MAG_FILTER,B.magFilter||S),v.bindTexture(n,null),d){D.depth=[],D.frame=[];for(var y=0;6>y;y++)D.depth[y]=v.createRenderbuffer(),D.frame[y]=v.createFramebuffer()}else D.depth=v.createRenderbuffer(),D.frame=v.createFramebuffer();D.assureTexture()},assureTexture:function(){var P=this;P.gv._2Oi(P.uuid,P.texture,"default"),n.Default.setImage(P.uuid,null)},releaseTexture:function(){this.gv.deleteTexture(this.uuid)},setSize:function(V,o,E){var e=this;if(o=Math.round(o),E=Math.round(E),o&&E&&(e.width!==o||e.height!==E)){e.width=o,e.height=E;var R=V.RENDERBUFFER,$=V.FRAMEBUFFER,T=e.options.samples,s=e.options.cube,j=s?Of.TEXTURE_CUBE_MAP:Of.TEXTURE_2D;if(T){var G=e.gv._glCapabilities;if(!G._maxSamplesChecked){for(V.bindRenderbuffer(R,e.depth),V.getError();T>1&&(V.renderbufferStorageMultisample(R,T,V.DEPTH_COMPONENT16,o,E),V.getError());)T=Math.floor(T>>1);1>=T&&(T=0,V.texParameteri(j,V.TEXTURE_MIN_FILTER,e.options.minFilter||V.LINEAR),V.texParameteri(j,V.TEXTURE_MAG_FILTER,e.options.magFilter||V.LINEAR),V.renderbufferStorage(R,V.DEPTH_COMPONENT16,o,E)),G._maxSamplesChecked=!0,G.maxSamples=e.options.samples=T,V.bindRenderbuffer(R,S)}}if(T&&(e._MSAAFbo||(e._MSAAFbo=V.createFramebuffer(),e._MSAARbO=V.createRenderbuffer()),V.bindRenderbuffer(R,e._MSAARbO),V.renderbufferStorageMultisample(V.RENDERBUFFER,T,V.RGBA8,o,E),V.bindFramebuffer($,e._MSAAFbo),V.framebufferRenderbuffer($,V.COLOR_ATTACHMENT0,R,e._MSAARbO),V.framebufferRenderbuffer($,V.DEPTH_ATTACHMENT,R,e.depth),V.bindFramebuffer($,null),V.bindRenderbuffer(R,null)),V.activeTexture(V.TEXTURE0),V.bindTexture(j,e.texture),s)for(var z=V.TEXTURE_CUBE_MAP_POSITIVE_X,h=0;6>h;h++)e.setupFrameBufferTextureAndDepth(V,e.frame[h],e.depth[h],z+h);else e.setupFrameBufferTextureAndDepth(V,e.frame,e.depth,V.TEXTURE_2D);if(e.generateMipmaps&&(2===gv._webGLVersion||Po.isPOT(o)&&Po.isPOT(E))){V.generateMipmap(j);var A=e.options.minFilter||(T?V.NEAREST:V.LINEAR);V.texParameteri(j,V.TEXTURE_MIN_FILTER,A===V.NEAREST?V.NEAREST_MIPMAP_NEAREST:V.LINEAR_MIPMAP_LINEAR)}V.bindTexture(j,null)}},setupFrameBufferTextureAndDepth:function(V,Q,N,s){var a=this,K=a.format;V.texImage2D(s,0,K,this.width,this.height,0,K,V.UNSIGNED_BYTE,null),V.bindFramebuffer(V.FRAMEBUFFER,Q),V.framebufferTexture2D(V.FRAMEBUFFER,V.COLOR_ATTACHMENT0,s,a.texture,0),this.setupRenderBufferStorage(V,N),V.bindFramebuffer(V.FRAMEBUFFER,null)},setupRenderBufferStorage:function(f,R){var K=this,L=f.RENDERBUFFER;f.bindRenderbuffer(L,R);var $=K.options.samples;$?f.renderbufferStorageMultisample(L,$,f.DEPTH_COMPONENT16,K.width,K.height):(f.renderbufferStorage(L,f.DEPTH_COMPONENT16,K.width,K.height),f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_ATTACHMENT,L,R)),f.bindRenderbuffer(f.RENDERBUFFER,null)},toCanvas:function(){var L=this,j=L.gv.getGL();Mn(j,L.frame);var s=L.width,B=L.height,I=new Uint8Array(4*s*B);j.readPixels(0,0,s,B,L.format,j.UNSIGNED_BYTE,I),Uq(j);var w=m.createElement("canvas");w.width=s,w.height=B;var $=w.getContext("2d"),H=$.createImageData(s,B);return H.data.set(I),$.putImageData(H,0,0),w}});var Ns=ko.Interactor=function(s){this.gv=this.g3d=s};so("Interactor",o,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()},fi:function(g){this.gv.fi(g)},startDragging:function(T){xl(this,T)}});var Os=ko.DefaultInteractor=function(o){fb(Os,this,[o])};so("DefaultInteractor",Ns,{getState:function(){return this._62O},setState:function(i){this._62O=i},getDataInfoAt:function(e,t){var J=this.gv,B=J.getDataInfoAt(e);if(!J.isBlockSelectable()||!B||!B.data)return B;if(!t&&J.isSelected(B.data))return B;for(var b=B.data;(b=b.getParent())&&b instanceof n.Block&&J.isSelectable(b);){var i=J.isSelected(b);if(i&&t)break;if(B={data:b,part:B.part},i&&!t)break}return B},handle_contextmenu:function(y){as(y)},handle_mousewheel:function(L){this.gv.handleScroll(L,L.wheelDelta/40)},handle_DOMMouseScroll:function(m){2===m.axis&&this.gv.handleScroll(m,-m.detail)},handle_keydown:function(C){this.gv.handleKeyDown(C)},handle_mousedown:function(z){this.handle_touchstart(z)},handle_touchstart:function(f){as(f);var i=this,u=i.gv,T=yp(f),K=i.getDataInfoAt(f),N=K?K.data:S,W=K?K.part:S,j=u.sm(),m=Bn(f),v=Nc(f);u.setFocus(f)&&(i._62O=S,i._57I=S,i.pendingClickThrough=S,i.__lastClientPoint__=Rh(f),N?Uj(f)?j.co(N)?j.rs(N):j.as(N):j.co(N)?N instanceof $n&&N.isClickThroughEnabled()&&yp(f)&&(i.pendingClickThrough=Rh(f)):j.ss(N):T&&(Uj(f)?u.isRectSelectable()&&(i._62O=jk):i._57I=Rh(f)),i._31Q&&(sd(i._31Q),delete i._31Q,delete i._32Q),i._62O||(u.isFirstPersonMode()&&(nr(f)||sc(f)||v>2?i._62O="pan":u.isMouseRoamable()||Aq(f)?(i._62O="roaming",i.foward=m&&yp(f),i._32Q=Gm(),i._31Q=Pm(i.tick,i)):T||(i._62O="roaming")),i._62O||(T&&m&&gt[W]?(i._62O=W,i.p3=N.p3()):T&&m&&af(N)&&u.isSelected(N)?u.isMovable(N)?(i._62O="move",i.p3=N.p3(),i.movedata=N):u._39Q(N)&&(i._62O="none"):Aq(f)&&(v>2?i._62O="pan":2===v&&(i.dist=Ur(f),i._62O="pinch")))),i.point=u.lp(f),xl(i,f),tg(f)?u.handleDoubleClick(f,N,W):u.handleClick(f,N,W))},tick:function(){var c=this,b=c.gv,s=b._moveStep;c.point&&b.isWalkable()&&(c._32Q&&(s*=(Gm()-c._32Q)/50),b.walk(c.foward?s:-s),c._32Q=Gm(),c._31Q=Pm(c.tick,c))},handle_mouseup:function(q){this.handle_touchend(q)},handle_touchend:function(e){var V=this._57I;if(V&&(_h(V,Rh(e))<=1&&this.gv.sm().cs(),this._57I=S),V=this.pendingClickThrough){if(_h(V,Rh(e))<=1){var G=this.getDataInfoAt(e);G&&G.data instanceof $n&&G.data.isClickThroughEnabled()&&(G=this.getDataInfoAt(e,!0),G&&(e.clickThrough=!0,this.gv.sm().ss(G.data)))}this.pendingClickThrough=null}},handleWindowMouseMove:function(H){this.handleWindowTouchMove(H)},handleWindowTouchMove:function(W){var F,p,e=this,t=e.gv,k=e._62O,f=e.point,Q=t.dm(),j=t.lp(W),L=j.x-f.x,X=j.y-f.y,D=t.getWidth(),I=t.getHeight();if(D&&I){var P=Rh(W),h=Lf(t,P,e.__lastClientPoint__),G=_h({x:0,y:0},h),K=-z*L/D,_=-z*X/I;if("roaming"===k)e.rotate(W,K/2,_/2);else if(k===at||k===bt||k===ct)t._86O||Q.beginTransaction(),t.fi({kind:t._86O?"betweenEditRotation":"beginEditRotation",event:W}),t._86O=1,t.sm().each(function(R){if(af(R)&&t.isRotationEditable(R)){var j=v(K)>v(_)?K:_;k===at?R.setRotationX(R.getRotationX()+j):k===bt?R.setRotationY(R.getRotationY()+j):k===ct&&R.setRotationZ(R.getRotationZ()+j)}});else if("move"===k||gt[k]){if(k===dt||k===et||k===ft)t._87O||Q.beginTransaction(),t.fi({kind:t._87O?"betweenEditScale":"beginEditScale",event:W}),t._87O=1;else{if(!t._moving){if(G<H.touchMoveThreshold)return;Q.beginTransaction()}t.fi({kind:t._moving?"betweenMove":"beginMove",event:W}),t._moving=1}var Z,s=e.p3,y=t.getPositionInfo(s),d=om(t);Z=k===Zs?"x":k===$s?"y":k===_s?"z":k===dt?"sx":k===et?"sy":k===ft?"sz":t.getMoveMode(W,e.movedata),L=L/D*y.width,X=-1*X/I*y.height;var c,b,A=[d[0]*L,d[4]*L,d[8]*L],x=[d[1]*X,d[5]*X,d[9]*X],i=A[0]+x[0],J=A[1]+x[1],g=A[2]+x[2],R=[s[0]+i,s[1]+J,s[2]+g],$=Od(t.getEye(),R,!0);if("xyz"===Z?(c=R,t.moveSelection(i,J,g)):"xz"===Z?(c=fr(t,s,[0,1,0],R),c&&t.moveSelection(c[0]-s[0],0,c[2]-s[2])):"xy"===Z?(c=fr(t,s,[0,0,1],R),c&&t.moveSelection(c[0]-s[0],c[1]-s[1],0)):"yz"===Z?(c=fr(t,s,[1,0,0],R),c&&t.moveSelection(0,c[1]-s[1],c[2]-s[2])):"x"===Z||"sx"===Z?($[0]=0,c=fr(t,s,$,R),c&&(b=c[0]-s[0],"x"===Z?t.moveSelection(b,0,0):t.sm().each(function(n){af(n)&&t.isSizeEditable(n)&&(F=n.getScaleX()+b/100,p=F/n.getScaleX(),n.setScaleX(F),nr(W)&&(n.setScaleY(n.getScaleY()*p),n.setScaleTall(n.getScaleTall()*p)))}))):"y"===Z||"sy"===Z?($[1]=0,c=fr(t,s,$,R),c&&(b=c[1]-s[1],"y"===Z?t.moveSelection(0,b,0):t.sm().each(function(e){af(e)&&t.isSizeEditable(e)&&(F=e.getScaleTall()+b/100,p=F/e.getScaleTall(),e.setScaleTall(F),nr(W)&&(e.setScaleY(e.getScaleY()*p),e.setScaleX(e.getScaleX()*p)))}))):("z"===Z||"sz"===Z)&&($[2]=0,c=fr(t,s,$,R),c&&(b=c[2]-s[2],"z"===Z?t.moveSelection(0,0,b):t.sm().each(function(O){af(O)&&t.isSizeEditable(O)&&(F=O.getScaleY()+b/100,p=F/O.getScaleY(),O.setScaleY(F),nr(W)&&(O.setScaleX(O.getScaleX()*p),O.setScaleTall(O.getScaleTall()*p)))}))),!c)return;e.p3=c}else if(k===jk){var V=e.div;V||(V=e.div=ue(),wf(e.getView(),V),V.op=f,V.style.background=t.getRectSelectBackground()),t.fi({kind:t._rectSelecting?"betweenRectSelect":"beginRectSelect",event:W}),t._rectSelecting=1,V.rect=Wk(V.op,j),Pg(V,V.rect)}else if("pinch"===k&&2===Nc(W)){t.fi({kind:t._pinching?"betweenPinch":"beginPinch",event:W}),t._pinching=1;var b=Ur(W);t._lastZoomLP||(t._lastZoomLP=Ii(W)),t.handlePinch(b,e.dist),e.dist=b}else"pan"===k||nr(W)||sc(W)?e.pan(W,L,X):"none"===k||t.isFirstPersonMode()||e.rotate(W,K,_);e.point=j}},pan:function($,y,r){var F=this.gv;if(F.isPannable()){var T=F.getWidth(),G=F.getHeight();if(!T||!G)return;var I=F.getCenterInfo(),V=y/T*I.width,B=-1*r/G*I.height;F.fi({kind:F._panning?"betweenPan":"beginPan",event:$}),F._panning=1,F.pan(-V,-B)}},rotate:function(e,Q,I){var j=this.gv;j.isRotatable()&&(j.fi({kind:j._rotating?"betweenRotate":"beginRotate",event:e}),j._rotating=1,j.rotate(Q,I))},handleWindowMouseUp:function(I){this.handleWindowTouchEnd(I)},handleWindowTouchEnd:function(o){var n=this,x=n.gv,L=x.dm(),u=n.div;if(u){var l=x.getDatasInRect(u.rect);if(!l.isEmpty()){var Q=x.sm(),b=Q.toSelection(),B=nr(o),d=o.altKey;l.each(function(g){Q.co(g)?(!B||B&&d)&&b.remove(g):(!d||B&&d)&&b.add(g)}),Q.ss(b)}re(u)}x._moving&&(delete x._moving,x.fi({kind:"endMove",event:o}),x.onMoveEnded(),L.endTransaction()),x._panning&&(delete x._panning,x.fi({kind:"endPan",event:o}),x.onPanEnded()),x._rotating&&(delete x._rotating,x.fi({kind:"endRotate",event:o}),x.onRotateEnded()),x._86O&&(delete x._86O,x.fi({kind:"endEditRotation",event:o}),L.endTransaction()),x._87O&&(delete x._87O,x.fi({kind:"endEditScale",event:o}),L.endTransaction()),x._pinching&&(delete x._pinching,x.fi({kind:"endPinch",event:o}),x.onPinchEnded()),x._rectSelecting&&(delete x._rectSelecting,x.fi({kind:"endRectSelect",event:o}),x.onRectSelectEnded()),x._walking&&(delete x._walking,x.fi({kind:"endWalk",event:o}),x.onWalkEnded()),x._lastZoomLP=x._lastZoomHit=null,n.dist=n.point=n._62O=n.p3=n.movedata=n.div=n._57I=n.pendingClickThrough=n._32Q=n._31Q=n.foward=S,n.__lastClientPoint__=S}});var Ps=ko.MapInteractor=function(Y){fb(Ps,this,[Y]),this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right",this._minPhi=0,this._maxPhi=5*Math.PI/12};so("MapInteractor",Ns,{setUp:function(){Ps.superClass.setUp.call(this);var z=this.gv;this.__oldMinPhi__=z.getRotateMinPhi(),this.__oldMaxPhi__=z.getRotateMaxPhi(),z.setRotateMinPhi(this._minPhi),z.setRotateMaxPhi(this._maxPhi)},tearDown:function(){Ps.superClass.tearDown.call(this);var W=this.gv;W.setRotateMinPhi(this.__oldMinPhi__),W.setRotateMaxPhi(this.__oldMaxPhi__),delete this.__oldMinPhi__,delete this.__oldMaxPhi__},handle_contextmenu:function(i){as(i)},handle_mousewheel:function(Z){this.gv.handleScroll(Z,Z.wheelDelta/40)},handle_DOMMouseScroll:function(B){2===B.axis&&this.gv.handleScroll(B,-B.detail)},handle_keydown:function(w){this.gv.handleKeyDown(w)},handle_mousedown:function(e){this.handle_touchstart(e)},handle_touchstart:function(X){as(X);var V=this,T=V.gv;if(T.setFocus(X)){var h=T.getDataInfoAt(X),j=h?h.data:S,B=h?h.part:S;V.__lastClientPoint__=Rh(X);var F=V.editing={point:T.lp(X),data:j,part:B};Aq(X)?F.touch=!0:(F.touch=!1,F.clickLeft=yp(X),F.pan=sc(X)?!0:"left"===this.panButton===F.clickLeft),j&&T._39Q(j)&&(F.preventDefault=!0),xl(V,X),tg(X)?T.handleDoubleClick(X,j,B):T.handleClick(X,j,B)}},handle_mouseup:function(c){this.handle_touchend(c)},handle_touchend:function(){},handleWindowMouseMove:function(d){this.handleWindowTouchMove(d)},handleWindowTouchMove:function(Y){var D=this,t=D.gv,G=D.editing;if(G){var T=t.lp(Y),i=G.point,K=T.x-i.x,y=T.y-i.y;if(!G.moved){if(Math.abs(K)<D.threshold&&Math.abs(y)<D.threshold&&!(Y.touches&&Y.touches.length>1))return;G.moved=!0}if(!G.preventDefault){G.point=T;var l=G.part;if(gt[l]){var f=G.data,B=t.dm(),h=t.getWidth(),o=t.getHeight(),P=-z*K/h,s=-z*y/o;if(l===at||l===bt||l===ct){t._86O||B.beginTransaction(),t.fi({kind:t._86O?"betweenEditRotation":"beginEditRotation",event:Y}),t._86O=1;var m=v(P)>v(s)?P:s;t.sm().each(function(e){af(e)&&t.isRotationEditable(e)&&(l===at?e.setRotationX(e.getRotationX()+m):l===bt?e.setRotationY(e.getRotationY()+m):l===ct&&e.setRotationZ(e.getRotationZ()+m))})}else{var J=f.p3(),R=t.getPositionInfo(J);K=K/h*R.width,y=-1*y/o*R.height;var p,a=om(t),d=[a[0]*K,a[4]*K,a[8]*K],w=[a[1]*y,a[5]*y,a[9]*y],q=d[0]+w[0],N=d[1]+w[1],U=d[2]+w[2],I=[J[0]+q,J[1]+N,J[2]+U],F=Od(t.getEye(),I,!0);if(l===dt||l===et||l===ft){if(t._87O||B.beginTransaction(),t.fi({kind:t._87O?"betweenEditScale":"beginEditScale",event:Y}),t._87O=1,p=fr(t,J,F,I)){var c,g=0,E=["X","Y","Tall"];l===dt?c="X":l===et?(c="Tall",g=1):l===ft&&(c="Y",g=2),E.splice(E.indexOf(c),1);var x=nr(Y),Z=(p[g]-J[g])/100;t.sm().each(function(X){if(af(X)&&t.isSizeEditable(X)){var _=X["getScale"+c](),z=_+Z;if(X["setScale"+c](z),x){var O=z/_;E.forEach(function(e){X["setScale"+e](X["getScale"+e]()*O)})}}})}}else if(l===Zs||l===$s||l===_s){if(!t._moving){var k=Rh(Y),r=Lf(t,k,D.__lastClientPoint__),O=_h({x:0,y:0},r);if(O<H.touchMoveThreshold)return;B.beginTransaction()}t.fi({kind:t._moving?"betweenMove":"beginMove",event:Y}),t._moving=1;var g=0;if(l===Zs?g=0:l===$s?g=1:l===_s&&(g=2),F[g]=0,p=fr(t,J,F,I)){var Z=p[g]-J[g],$=[0,0,0];$[g]=Z,t.moveSelection.apply(t,$)}}}}else if(G.touch){var L=Y.touches.length;if(2!==L)D.pan(Y,K,y);else{if(1>=L)return;var j=Y.touches,W={x:j[0].clientX,y:j[0].clientY},Q={x:j[1].clientX,y:j[1].clientY},u={x:Q.x-W.x,y:Q.y-W.y},C=G.lastCenter,M=Math.atan2(u.y,u.x),e=G.theta,A=0;e==S?e=G.theta=M:(A=M-e,G.thetaStarted||Math.abs(A)>D.touchRotateThreshold?(G.thetaStarted=!0,G.theta=M):A=0);var _=X*(W.y+Q.y)/2/t.getHeight(),n=G.phi,V=0;n==S?n=G.phi=_:(V=_-n,G.phiStarted||Math.abs(V)>D.touchRotateThreshold?(G.phiStarted=!0,G.phi=_):V=0);var b,Hg=Math.sqrt(u.x*u.x+u.y*u.y),Jc=G.vlen;if(Jc){var Sk=W.x-C.x,Wj=W.y-C.y,lp=Q.x-C.x,Ki=Q.y-C.y,_f=Math.sqrt(Sk*Sk+Wj*Wj),cp=Math.sqrt(lp*lp+Ki*Ki),xg=Jc/2,to=D._sign2(_f-xg),mn=D._sign2(cp-xg);0>to*mn||0===to&&0===mn?(b=1,G.vlen=Hg):(b||(b=Hg/Jc),G.scaleStarted||Math.abs(b-1)>D.touchScaleThreshold?(G.vlen=Hg,G.scaleStarted=!0):b=1)}else Jc=G.vlen=Hg,b=1;1!==b&&t.setZoom(b),(V||A)&&D.rotate(Y,A,-V),G.lastCenter={x:(Q.x+W.x)/2,y:(Q.y+W.y)/2}}}else if(G.pan)D.pan(Y,K,y);else{var h=t.getWidth(),o=t.getHeight();if(!h||!o)return;var P=-z*K/h,s=-z*y/o;D.rotate(Y,P,s)}}}},_sign2:function(m){return Math.abs(m)<this._touchScaleCheckAccuracy?0:m>0?1:-1},handleWindowMouseUp:function(x){this.handleWindowTouchEnd(x)},getDataInfoAt:function(p,o){var c=this.gv,V=c.getDataInfoAt(p);if(!c.isBlockSelectable()||!V||!V.data)return V;if(!o&&c.isSelected(V.data))return V;for(var R=V.data,H=V.part;(R=R.getParent())&&R instanceof n.Block&&c.isSelectable(R);){var v=c.isSelected(R);if(v&&o)break;if(V={data:R,part:H},v&&!o)break}return V},handleWindowTouchEnd:function(s){var g=this,p=g.editing;if(g.editing=null,p){var k=g.gv;if(p.moved||!p.clickLeft&&!p.touch)k._panning=null,k._rotating=null,k.fi({kind:p.pan?"endPan":"endRotate",event:s});else{var I=g.getDataInfoAt(s),h=I&&I.data;h instanceof $n&&h.isClickThroughEnabled()&&(I=g.getDataInfoAt(s,!0),I&&(h=I.data)),h?k.sm().setSelection([h]):k.sm().clearSelection()}var z=k.dm();k._moving&&(delete k._moving,k.fi({kind:"endMove",event:s}),k.onMoveEnded(),z.endTransaction()),k._86O&&(delete k._86O,k.fi({kind:"endEditRotation",event:s}),z.endTransaction()),k._87O&&(delete k._87O,k.fi({kind:"endEditScale",event:s}),z.endTransaction())}},pan:function(y,Y,B){var j=this,T=j.gv;if(T.isPannable()){var G=T.getWidth(),r=T.getHeight();if(G&&r){var h=T.getCenterInfo(),$=-Y/G*h.width,E=1*B/r*h.height;T.fi({kind:T._panning?"betweenPan":"beginPan",event:y}),T._panning=1;var t=j.keepHorizon,i=j.editing.touch;if((i&&y.touches&&y.touches.length>1||!i&&nr(y))&&(t=!t),!t)return T.pan($,E);if($||E){var K=om(T),c=[K[0]*$,K[4]*$,K[8]*$],w=[K[1],0,K[9]],H=Math.sqrt(w[0]*w[0]+w[2]*w[2]);H&&(w=[w[0]/H*E,0,w[2]/H*E]);var b=c[0]+w[0],W=c[1]+w[1],X=c[2]+w[2],J=T._center,x=T._eye;J[0]+=b,J[1]+=W,J[2]+=X,x[0]+=b,x[1]+=W,x[2]+=X,T.fp(Xj,S,x),T.fp(al,S,J)}}}},rotate:function($,I,j){var v=this,O=v.gv;if(O.isRotatable()){var h=O._center,F=O._eye,q=Od(F,h),C=db(x(q[0]*q[0]+q[2]*q[2]),q[1]),L=go(O,C+j);j=L-C,O.fi({kind:O._rotating?"betweenRotate":"beginRotate",event:$}),O._rotating=1,O.rotate(I,j)}}}),o.defineProperties(Ps.prototype,{panButton:{get:function(){return this._panButton},set:function(K){this._panButton=K}},minPhi:{get:function(){return this._minPhi},set:function(t){this.gv.setRotateMinPhi(this._minPhi=t)}},maxPhi:{get:function(){return this._maxPhi},set:function(P){this.gv.setRotateMaxPhi(this._maxPhi=P)}},keepHorizon:{get:function(){return this._keepHorizon},set:function(n){this._keepHorizon=n}},threshold:{get:function(){return this._threshold},set:function(Q){this._threshold=Q}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(w){this._touchScaleThreshold=w}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(T){this._touchRotateThreshold=T}}});var Qs,Rs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEyUlEQVRYR62XW0xcVRSG/58cmIG2HmstE9N4SX2xtVqBCISoFS/RmDSpKQSvTWNixUStQSqVyBQYJUGttrQVtYkPatuQPmhivMUHqbUBZ2itl1qjTzZpImNUZhDLsUeWWXgOOd2cgcGyk3mYs/de69trr70uxP8YIlJKMi0i9wIgyf0iEiM5PFdxzGeDiBQAuB7AjQBuALCN5NcGQDmANgBfeL8UyYnZ5M8KICJ3AXgAwAlfOMl/VHAQwPtveYAKuQLA2yQ/ngliRgAR2QogA2AvSdcUZAIE50VEYR4BsIDkC7kgQgFE5GIAuwDsJnkk1+aZAPw9IqLX1gjgcZK/m7KmAXjK4wBaSf4ZplxEIgCuA3Cz3gSAfgDHSf6dY/0FAJ4D0G5ChAEcAPBwmHIRqXNd90nLsiocx/k+k8n8oK/Atu2rIpHIStd1v7QsawfJd0Ouywawh6T609Q4B8C788NhZnddt29sbGxBd3f39q6urtNhJ43H48uam5u3lJSUjFiWdV8IxE0Aqki+6M9NAXjefjnJXsOZogBGBgYGttbU1Hw427PS+cHBwbVVVVUJAItJOoa8xwD8RPIT/T4J4L3zfQAeNL1dRMZra2ur+/v7/8pHub+mvr7+wr6+vs8KCgoWGABFAN4EsEHjhA9QBeA2ks8HF6vZk8nkQL4nNwGTyeTa8vLycsuy7jcg1Mk/IpnyAZoBaOQ6FHg+ddlsdqNt201zObm5NpvN7ly0aNHrJN8LyL4FwGqSr/gAOrnej3C60HXdw/F4PJ7L4fKFSiQSl7W0tLQVFRWtCQDoNRwguZ6aWABcorE9sEDf+QjJ1fkqmmmdiHwHoCToXyKiceR0rkhY5TjOq9FoVLPdeY/x8fG+SCSySe/cFKYWCFOyPJ1Or4zFYh3nrR3A8PBwe2lp6TcAfg4DmBYwAFyRTqdXxWKx9nkE+DYUIEyBiFQ6jvNaNBq9Zz4AZruCGIBlJI8ZXpolee18AORwwgoAp/xnqMmjPuilZ8+ePZRIJNo7OztD436+YB0dHZe2trY+W1hYWGsccD/JOh/gKQBHSWpanRwicnc2m91k2/bmfJWFrRsdHd29cOHCXSTfD8i+FcA1JHcEQ/HtJDVnTw3XdfcPDQ0dra6unto8F5hUKrWurKxslWVZG4L7RGQbgA9IDgWT0VsANprJaGJi4kxDQ8OagwcPjsxFeWNj49Le3l6N91qMTA2vmNnr6fovGXkmvxPAlST3hGz4LZVKbausrMzLEnryioqKNpJLzCpJRJ4AcJLkp6rHLEieBjBA8rB5Wtd1942NjS3p6el5qa2t7VSYNdThmpqaWoqLi38xze4dUku4CpLb/f1hJZnWBY+SzJpKRGSdV5LVOI5zIpPJnNQ1tm2viEQiV7uue8SyrJeDDhew8GIAO0me4w9hABdp8ahNBkktyacNr+Qu84pSndfX81VY6e6dXJV3AoiT/CMoMFcyUogeAG+Q/DyX8+VZlqvZHwKw2VQ+zQdCTL4FwBkPZFrJPUtjoildG5PC4J2bOvJpze7QWhHAj4HWbBImpDXTQsPvH5cDeMf39lxWnBXAU6TNqcZu7fn0lyB53GhOdf6ZQHN6bF6a0xxOuJTkrwbA5LdcJ831/V8SOUYQxYGhRwAAAABJRU5ErkJggg==",Ss=32,Ts=ko.GlobeInteractor=function(d,G){fb(Ts,this,[d]);var j,V=G.radius||6378137,n=this,T=null;Qs||(Qs=ue(),Qs.style.border="",Qs.style.backgroundImage="url("+Rs+")");
var b=new Mq,z=new se,L=new se,p=new se,x=new df,h="number"==typeof V?{x:V,y:V,z:V}:V,A={center:new se(0,0,0),radius:h},Q=function(e){d._81O=null;var V=d.getHitPosition(e,d.getCenter(),z.copy(d.getEye()).sub(L.copy(d.getCenter())).toArray());return x.origin.copy(d.getEye()),x.direction.copy(V).sub(x.origin).normalize(),x.intersectEllipsoid(A)},m=function(W,D){d._81O=null,x.origin.copy(d.getEye());for(var q,l,r=d.getCenter(),w=z.copy(d.getEye()).sub(L.copy(d.getCenter())).toArray(),v=1,k=16,b=0,T=1,f={x:0,y:0};k--;){if(f.x=D.x+(W.x-D.x)*v,f.y=D.y+(W.y-D.y)*v,q=d.getHitPosition(f,r,w),x.direction.copy(q).sub(x.origin).normalize(),l=x.intersectEllipsoid(A),l&&1===v)return{hit:l};l?b=v:T=v,v=(b+T)/2}return{hit:l,out:1>v}},B=function(M,h){if(T){var V=Date.now();T.deltaTime=T.lastTime?V-T.lastTime:1e3,T.lastTime=V,T.lastAxis=M,T.lastAngle=h}h&&(b.setFromAxisAngle(M,h),d.setEye(z.copy(d.getEye()).applyQuaternion(b).toArray()),d.setCenter(z.copy(d.getCenter()).applyQuaternion(b).toArray()),d.setUp(z.copy(d.getUp()).applyQuaternion(b).toArray()))};n._showCrossIcon=function(V){wf(n.getView(),Qs),Pg(Qs,{x:V.clientX-Ss/2,y:V.clientY-Ss/2,width:Ss,height:Ss})},n._hideCrossIcon=function(){re(Qs)},n._scrollImpl=function(h,U){T={point:d.lp(h),screen:Rh(h),hit:Q(h),type:"right"},T.hitNormalize=T.hit?T.hit.clone().normalize():new se;var Y={clientX:T.screen.x,clientY:T.screen.y+10*U};n._handleMoveImpl(Y),n._endMoveImpl(Y)},n._startMoveImpl=function(m){j&&(j.stop(!0),j=null),T={point:d.lp(m),screen:Rh(m),hit:Q(m)},T.hitNormalize=T.hit?T.hit.clone().normalize():new se,Aq(m)?1===m.touches.length?T.hit&&(T.type="left"):2===m.touches.length&&(T.type="touch2"):(yp(m)?T.hit&&(T.type="left"):Bq(m)?T.type="right":sc(m)&&T.hit&&(T.type="middle"),!T.hit||"right"!==T.type&&"middle"!==T.type||n._showCrossIcon(m)),T.type&&xl(n,m)},n._handleMoveImpl=function(v){if(T)switch(T.type){case"left":return n._handleLeft(v);case"right":return n._handleRight(v);case"middle":return n._handleMiddle(v);case"touch2":return n._handleTouch2(v)}},n._endMoveImpl=function(){if(T){if(this._hideCrossIcon(),"left"===T.type||"middle"===T.type){var t=1e3*(T.lastAngle/(T.deltaTime||30)),N=T.lastAxis,i=T.lastTime,E=function(){var T=Date.now(),l=(T-i)/1e3;return i=T,t*=Math.pow(Math.abs(n.decelerationRate),3*l),Math.abs(t)<.01?(t=0,j&&j.stop(),void 0):(B(N,t*l),void 0)};j=Xm({action:function(){E(arguments)},duration:5e3})}T=null}},n._handleLeft=function(I){if(!T.finished){var E=Rh(I),V=m(E,T.lastScreen||T.screen);if(T.lastScreen=E,!V.hit)return T.finished=!0,n._endMoveImpl(I),void 0;var w=V.hit;w.normalize();var k=T.hitNormalize,Y=Math.acos(w.dot(k)),L=w.cross(k).normalize();B(L,Y),V.out&&(T.finished=!0,n._endMoveImpl(I))}},n._handleRight=function(Z){var m=T.lastScreen||T.screen,e=m.y;m=T.lastScreen=Rh(Z);var G=m.y,$=G-e;if($){var U=Math.min(.5,$*n.scaleSpeed);z.copy(d.getEye());var u=T.hit;u||(u=z.clone().divide(h).normalize().multiply(h)),L.copy(z).lerp(u,U),d.setEye(L.toArray()),z.copy(d.getUp()),L.normalize();var q=z.clone().cross(L).normalize();if(p.copy(d.getCenter()),p.sub(q.multiplyScalar(p.dot(q))),d.setCenter(p.toArray()),T.hit){var D=Q(T.screen),P=T.hitNormalize;if(D){D.normalize();var S=Math.acos(D.dot(P)),s=D.cross(P).normalize();S&&B(s,S)}}}};var l=function(o){return Math.abs(o)<.01?0:o>0?1:-1};n._handleTouch2=function(r){var i=r.touches.length;if(2===i){var M=r.touches,n={x:M[0].clientX,y:M[0].clientY},G={x:M[1].clientX,y:M[1].clientY},t={x:G.x-n.x,y:G.y-n.y},p=T.lastCenter,E=Math.atan2(t.y,t.x),Z=T.theta,K=0;Z==S?Z=T.theta=E:(K=E-Z,T.thetaStarted||Math.abs(K)>.03?(T.thetaStarted=!0,T.theta=E):K=0);var x,u=Math.sqrt(t.x*t.x+t.y*t.y),Y=T.vlen;if(Y){var $=n.x-p.x,N=n.y-p.y,f=G.x-p.x,A=G.y-p.y,v=Math.sqrt($*$+N*N),a=Math.sqrt(f*f+A*A),U=Y/2,j=l(v-U),H=l(a-U);0>j*H||0===j&&0===H?(x=1,T.vlen=u):(x||(x=u/Y),T.scaleStarted||Math.abs(x-1)>.05?(T.vlen=u,T.scaleStarted=!0):x=1)}else Y=T.vlen=u,x=1;var t=L.copy(d.getEye()).clone();1!==x&&d.setEye(t.setLength((t.length()-V)/x+V).toArray()),K&&B(t.normalize(),K),T.lastCenter={x:(G.x+n.x)/2,y:(G.y+n.y)/2}}},n._handleMiddle=function(r){var v=Rh(r),Q=T.screen;T.screen=v;var e=(v.y-Q.y)/180*Math.PI*n.rollSpeed;L.copy(d.getCenter()).sub(z.copy(d.getEye())).normalize(),z.copy(d.getUp()).cross(L).normalize(),L.copy(d.getEye()).sub(T.hit).applyAxisAngle(z,e).add(T.hit);var H=L.clone();L.copy(d.getCenter()).sub(T.hit).applyAxisAngle(z,e).add(T.hit);var l=L.clone(),O=L.copy(d.getUp()).applyAxisAngle(z,e).clone(),S=!1;e>0&&(p.copy(O),L.copy(l).sub(H).normalize(),z.copy(H).multiplyScalar(-1).normalize(),z.dot(p)-L.dot(p)>0&&(S=!0)),S||p.copy(T.hit).sub(H).dot(T.hitNormalize)>=0&&(S=!0),S||(d.setEye(H.toArray()),d.setCenter(l.toArray()),d.setUp(O.toArray()));var k=-(v.x-Q.x)/180*Math.PI*n.rotateSpeed;B(T.hitNormalize,k)}};so("GlobeInteractor",Ns,{handle_contextmenu:function(x){as(x)},handle_mousewheel:function(q){this._scrollImpl(q,q.wheelDelta/40)},handle_DOMMouseScroll:function(v){2===v.axis&&this._scrollImpl(v,-v.detail)},handle_keydown:function(H){this.gv.handleKeyDown(H)},handle_mousedown:function(I){this.handle_touchstart(I)},handle_touchstart:function(r){as(r);var U=this.gv;if(U.setFocus(r)){var J=U.getDataInfoAt(r),D=J?J.data:S;D&&U.isInteractive(D)||this._startMoveImpl(r);var d=J?J.part:S;tg(r)?U.handleDoubleClick(r,D,d):U.handleClick(r,D,d)}},handle_mouseup:function(h){this.handle_touchend(h)},handle_touchend:function(){},handleWindowMouseMove:function(v){this.handleWindowTouchMove(v)},handleWindowTouchMove:function(R){this._handleMoveImpl(R)},handleWindowMouseUp:function(w){this.handleWindowTouchEnd(w)},handleWindowTouchEnd:function(S){this._endMoveImpl(S)}}),o.defineProperties(Ts.prototype,{rotateSpeed:{get:function(){return this._rotateSpeed||.3},set:function(B){this._rotateSpeed=B}},rollSpeed:{get:function(){return this._rollSpeed||.1},set:function($){this._rollSpeed=$}},scaleSpeed:{get:function(){return this._scaleSpeed||.002},set:function(w){this._scaleSpeed=w}},decelerationRate:{get:function(){return this._decelerationRate||.04},set:function(s){this._decelerationRate=s}}});var Us=function(Y){var C=2147483648|Y;return[(255&C>>16)/255,(255&C>>8)/255,(255&C)/255,(255&C>>24)/255]},Vs=function(X){this.gv=X,this.gv.pickColorMap={_pickIdUsed:2e3}};Dh(Vs,o,{_iv:!0,iv:function(){this._iv=!0},get:function(P,X,i){this.validate();var m=this,w=m.gv.getGL();if(!w)return S;var Z,b,H=m._resolution,g=Math.round(P.x*H),e=Math.ceil(P.width*H),A=Math.ceil(P.height*H),I=m.height-Math.round(P.y*H)-A,E=j(e/2),F=new Uint8Array(4*e*A),r=0,B=F.length,$=X?S:new Xd,l=X?S:{};if(Mn(w,m.frame),w.readPixels(g,I,e,A,w.RGBA,w.UNSIGNED_BYTE,F),Uq(w),X){for(;E>=r;r++)for(var O=E-r,k=E+r,t=O;k>=t;t++)for(var M=O;k>=M;M++)if((t===O||t===k||M===O||M===k)&&(Z=m.info(F,4*(t*e+M)))){if(i&&i(Z)===!1)continue;return Z}}else for(;B>r;r+=4)if(Z=m.info(F,r)){if(i&&i(Z)===!1)continue;b=Z.data,l[b._id]||($.add(b),l[b._id]=b)}return $},info:function(W,j){return this.gv.pickColorMap[(W[j]<<16)+(W[j+1]<<8)+W[j+2]+((127&W[j+3])<<24)]},getResolution:function(){return this._resolution},onContextLost:function(){this.texture=null,this.width=this.height=-1},validate:function(){var p=this,q=p.gv,n=q.getGL();if(n){var d=p._resolution=q._pickerResolution*q.getDevicePixelRatio(),f=Math.round(d*q.getWidth()),w=Math.round(d*q.getHeight()),c=n.RGBA,$=n.TEXTURE_2D,b=n.RENDERBUFFER,X=n.FRAMEBUFFER;if(p.texture||(p.texture=ad(n),p.render=n.createRenderbuffer(),p.frame=n.createFramebuffer()),(p.width!==f||p.height!==w)&&(n.activeTexture(n.TEXTURE0),fd(n,p.texture),n.texImage2D($,0,c,f,w,0,c,n.UNSIGNED_BYTE,S),yr(n,n.TEXTURE_MIN_FILTER,n.LINEAR),n.bindRenderbuffer(b,p.render),n.renderbufferStorage(b,n.DEPTH_COMPONENT16,f,w),Mn(n,p.frame),n.framebufferTexture2D(X,n.COLOR_ATTACHMENT0,$,p.texture,0),n.framebufferRenderbuffer(X,n.DEPTH_ATTACHMENT,b,p.render),fd(n,S),n.bindRenderbuffer(b,S),Uq(n),p.width=f,p.height=w),p._iv){p._iv=!1;var J=!1;q._40Q.each(function(m){!J&&m.isBatchInvalid()&&(J=!0)}),J&&q.updateScene(),Mn(n,p.frame),n.clear(n.COLOR_BUFFER_BIT),q.overlappingBox.clear(),q.setViewport(n,0,0,f,w),q.renderPickScene(),Uq(n)}}}});var Ws=function(s){this.gv=s};Dh(Ws,o,{gap:0,size:0,_42:function(K,$){var f=this,U=f.gv,N=U._gridGap,t=U._gridSize;if(U._gridVisible){if(f.gap!==N||f.size!==t){for(var k=[],T=U._gridSize/2,d=N*T,_=0;2*T+1>_;_++){var m=6*_,Z=6*(2*T+1)+m;k[m]=-d,k[m+1]=0,k[m+2]=-d+_*N,k[m+3]=d,k[m+4]=0,k[m+5]=-d+_*N,k[Z]=-d+_*N,k[Z+1]=0,k[Z+2]=-d,k[Z+3]=-d+_*N,k[Z+4]=0,k[Z+5]=d}f.vs=new mo(k),f.gap=N,f.size=t}Ac(U),Rp(K),jo(K);var u=!U._fogDisabled;if(u){var z=el.for(K).directUniforms();z.uFog=!1}Ig(K,$,1,U._gridColor,U._buffer.vs,f.vs),Oe(K,0,f.vs.length/3,K.LINES),u&&(z.uFog=!0),xj(K),Hb(K)}else f.vs=f.gap=f.size=S}});var Xs=function(s){this.gv=s};Dh(Xs,o,{_42:function(T,w){var C=this.gv,G=C._buffer.vs,Z=C._axisXColor,g=C._axisYColor,t=C._axisZColor,Q=C._originAxisVisible,q=C._centerAxisVisible;if(Q||q){var i=Ni?T.TRIANGLES:T.TRIANGLE_FAN,N=T.LINES;if(Ac(C),Rp(T),jo(T),Q){var Y=C.getCenterInfo(),O=_(Y.width,Y.height)/5,j=.8*O,D=.05*O;Ig(T,w,1.5,Z,G,new mo([0,0,0,O,0,0,j,D,0,j,0,D,j,-D,0,j,0,-D,j,D,0,0,0,0,0,O,0,D,j,0,0,j,D,-D,j,0,0,j,-D,D,j,0,0,0,0,0,0,O,D,0,j,0,D,j,-D,0,j,0,-D,j,D,0,j])),Oe(T,0,2,N),Oe(T,1,6,i),Ig(T,w,S,g),Oe(T,7,2,N),Oe(T,8,6,i),Ig(T,w,S,t),Oe(T,14,2,N),Oe(T,15,6,i)}if(q){var u=C._center,$=u[0],f=u[1],b=u[2],Y=C.getPositionInfo(u);O=_(Y.width,Y.height)/20,Ig(T,w,1.5,Z,G,new mo([$,f,b,$+O,f,b,$,f,b,$,f+O,b,$,f,b,$,f,b+O])),Oe(T,0,2,N),Ig(T,w,S,g),Oe(T,2,2,N),Ig(T,w,S,t),Oe(T,4,2,N)}xj(T),Hb(T)}}});var Ys=function(E){this.gv=E},Zs="edit_tx",$s="edit_ty",_s="edit_tz",at="edit_rx",bt="edit_ry",ct="edit_rz",dt="edit_sx",et="edit_sy",ft="edit_sz",gt={};gt[Zs]=101,gt[$s]=102,gt[_s]=103,gt[at]=104,gt[bt]=105,gt[ct]=106,gt[dt]=107,gt[et]=108,gt[ft]=109,Dh(Ys,o,{_42:function(C,g,h){var d=this,B=d.gv,b=B.sm().ld();if(b&&B.isEditable(b)&&!B.isEditHelperDisabled()&&af(b)&&(!B.isFirstPersonMode()||!B.isMouseRoamable()&&!bc)){Ac(B);var R,p=B.isMovable(b),W=B.isRotationEditable(b),D=B.isSizeEditable(b),Z=B._axisXColor,q=B._axisYColor,x=B._axisZColor,u=B._editSizeColor,c=b.p3();if(B.isOrtho()){var n=B.getCenterInfo();R=_(n.width,n.height)/8}else R=_h(B.getEye(),c)/10;var X,s,w=R/(h?5:10),o=.7*R,M=.4*o,t=c[0],m=c[1],r=c[2];X=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],p&&d._17O(C,g,b,h,Zs,Z,X,[t,m-w,r,t+o,m-w,r,t+o,m,r,t+o,m,r,t,m,r,t,m-w,r,t,m-w,r+w,t+o,m-w,r+w,t+o,m-w,r,t+o,m-w,r,t,m-w,r,t,m-w,r+w]),s=t+o,D&&d._17O(C,g,b,h,dt,u,X,[s,m-w,r,s+M,m-w,r,s+M,m,r,s+M,m,r,s,m,r,s,m-w,r,s,m-w,r+w,s+M,m-w,r+w,s+M,m-w,r,s+M,m-w,r,s,m-w,r,s,m-w,r+w]),s+=M,W&&d._17O(C,g,b,h,at,Z,X,[s,m-w,r,s+M,m-w,r,s+M,m,r,s+M,m,r,s,m,r,s,m-w,r,s,m-w,r+w,s+M,m-w,r+w,s+M,m-w,r,s+M,m-w,r,s,m-w,r,s,m-w,r+w]),X=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],p&&d._17O(C,g,b,h,$s,q,X,[t,m,r,t,m+o,r,t-w,m+o,r,t-w,m+o,r,t-w,m,r,t,m,r,t,m,r,t,m,r-w,t,m+o,r-w,t,m+o,r-w,t,m+o,r,t,m,r]),s=m+o,D&&d._17O(C,g,b,h,et,u,X,[t,s,r,t,s+M,r,t-w,s+M,r,t-w,s+M,r,t-w,s,r,t,s,r,t,s,r,t,s,r-w,t,s+M,r-w,t,s+M,r-w,t,s+M,r,t,s,r]),s+=M,W&&d._17O(C,g,b,h,bt,q,X,[t,s,r,t,s+M,r,t-w,s+M,r,t-w,s+M,r,t-w,s,r,t,s,r,t,s,r,t,s,r-w,t,s+M,r-w,t,s+M,r-w,t,s+M,r,t,s,r]),X=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],p&&d._17O(C,g,b,h,_s,x,X,[t,m,r,t,m,r+o,t,m-w,r+o,t,m-w,r+o,t,m-w,r,t,m,r,t,m-w,r,t-w,m-w,r,t-w,m-w,r+o,t-w,m-w,r+o,t,m-w,r+o,t,m-w,r]),s=r+o,D&&d._17O(C,g,b,h,ft,u,X,[t,m,s,t,m,s+M,t,m-w,s+M,t,m-w,s+M,t,m-w,s,t,m,s,t,m-w,s,t-w,m-w,s,t-w,m-w,s+M,t-w,m-w,s+M,t,m-w,s+M,t,m-w,s]),s+=M,W&&d._17O(C,g,b,h,ct,x,X,[t,m,s,t,m,s+M,t,m-w,s+M,t,m-w,s+M,t,m-w,s,t,m,s,t,m-w,s,t-w,m-w,s,t-w,m-w,s+M,t-w,m-w,s+M,t,m-w,s+M,t,m-w,s])}},_17O:function(T,H,g,t,$,M,v,l){var R=this.gv,E=R._buffer,a=el.for(T),G=a.directUniforms(),z=a.directAttribs();if(R._picking){t=R.pickColorMap;var B=gt[$];t[B]={data:g,part:$},G.uFixPickReverseColor=Us(B)}Vf(T,H,S,!0,S,!0,S,!1),G.uDiffuse=M,z.aPosition=bm(T,E.vs,new mo(l),S),z.aNormal=bm(T,E.ns,new mo(v),S),jo(T),Oe(T,0,12),xj(T),op(T,H)}});var ht=n.Raycaster=function(z){this.gv=z,this.maxTriangleTest=1/0,this.backfaceCulling=!0};jj("Raycaster",o,{intersect:function(Q){var N=this,P=N.gv,y=P.getDataAt(Q);return y?N.intersectObject(Q,y):null},intersectObjects:function(Y,i,N){var D,R,q,L,j=this,X=1/0,Q=Y.origin||(new se).fromArray(j.gv.getEye()),M=j.maxTriangleTest,b=[];i.forEach(function(c){N&&N(c)===!1||c.s("intersect")!==!1&&b.push(c)});var H=Q.distanceToSquared2([0,0,0]);return b.sort(function(u,t){return(u.p3?Q.distanceToSquared2(u.p3()):H)-(t.p3?Q.distanceToSquared2(t.p3()):H)}),j.countTriangles=0,b.forEach(function(C){j.countTriangles>M||(D=j.intersectObject(Y,C),D&&(R=Q.distanceToSquared(D.world),X>R&&(q=C,L=D,X=R)))}),j.countTriangles=0,{data:q,intersect:L}},intersectObjectAndRecordTriangle:function(L,q){this._4GQ=!0;var G=this.intersectObject(L,q);return this._4GQ=!1,G},intersectLastTriangle:function(Z,t){var p=this.getRay(Z);p.applyMatrix4(t.inverseMatrix);var l=p.intersectPlane(t.plane);if(!l)return null;var M=Oj.uvIntersection(l,t.p1,t.p2,t.p3,t.uv1.clone(),t.uv2.clone(),t.uv3.clone());return{world:l.clone().applyMatrix4(t.matrixWorld),local:l.clone(),uv:M}},getRay:function(k){if(k instanceof df)return k;var m=this,U=m.gv,Q=U.unproject(k),G=new se,O=U.getEye(),K=new se;if(U.isOrtho()){var c=new se(O);K.copy(U.getCenter()).sub(c).normalize();var z=G.copy(Q).sub(c).dot(K);G.copy(K).setLength(-z).add(c.copy(Q))}else G.copy(O),K.copy(Q).sub(G).normalize();return new n.Math.Ray(G,K)},intersectObject:function(M,p){return this._intersectObjectImpl(this.getRay(M),p)},_intersectObjectImpl:function(){function z(){var Z=new se;return Z.subVectors(s,p),g.subVectors(M,p),Z.cross(g).normalize(),Z}var F=new xn,U=new xn,C=new df,Z=new se,G=new se,w=new se,_=new se,d=new se,M=new se,p=new se,s=new se,j=new Ai,f=new Ai,c=new Ai,g=new se,Y={vs:Ar,is:Ph,uv:Xp},O=bi.slice(0);return O.push("csg"),function(Q,g){var l=this.gv.getData3dUI(g),V=g.mat||l.mat;V?F.fromArray(V):F.identity(),U.getInverse(F),C.copy(Q).applyMatrix4(U);var J,o,X,B="body",S=l.shapeModel;if(!S&&(g instanceof n.Polyline||g instanceof n.Edge)&&l.lineShapeModel&&(S=l.lineShapeModel),S||(S=ze(l)),S||(n.CSGNode&&g instanceof n.CSGNode||n.CSGShape&&g instanceof n.CSGShape?(X=!0,S=[l.left,l.front,l.right,l.back,l.top,l.bottom,l.csg]):g instanceof n.Node&&!(g instanceof n.Shape)?(J=!0,S=Y):(o=!0,S=[l.left,l.front,l.right,l.back,l.top,l.bottom])),!S)return console.log("Can not find shape model."),null;Td(S)||(S=[S]);var v,R,N,i,K,b,A,I,x,y,t,u,H,E,T,k,e=1/0,h=["","top_","bottom_"],r=!1,m=this.backfaceCulling,a=[];for(Qi(S,l,a),v=0,R=a.length;R>v;v++)if(H=a[v])for(N=0,i=h.length;i>N;N++)if(E=h[N],A=H[E+"vs"],I=H[E+"is"],x=H[E+"uv"]||H[E+"tuv"],A){if(T=H[E+"boundingBox"]){var t=C.intersectBox(T);if(!t)continue;if(C.origin.distanceTo(t)>e)continue;k=!1}else H[E+"boundingBox"]=T=new n.Math.Box3,k=!0;for(K=0,b=I?I.length:A.length/3;b>K;K+=3)this.countTriangles++,I?(G.fromArray(A,3*I[K]),w.fromArray(A,3*I[K+1]),_.fromArray(A,3*I[K+2])):(G.fromArray(A,3*K),w.fromArray(A,3*(K+1)),_.fromArray(A,3*(K+2))),k&&(T.expandByPoint(G),T.expandByPoint(w),T.expandByPoint(_)),y=C.intersectTriangle(G,w,_,m,Z),y&&(u=C.origin.distanceTo(y),e>u&&(e=u,d.copy(y),M.copy(G),p.copy(w),s.copy(_),""!==E?B=E.slice(0,-1):J?B=bi[Math.floor(K/6)]:o?B=bi[v]:X&&(B=O[v]),x&&(r=!0,I?(j.fromArray(x,2*I[K]),f.fromArray(x,2*I[K+1]),c.fromArray(x,2*I[K+2])):(j.fromArray(x,2*K),f.fromArray(x,2*(K+1)),c.fromArray(x,2*(K+2))))))}if(!isFinite(e))return null;var L,q,$=d.clone().applyMatrix4(F),P=this._4GQ;r&&(P&&(q={inverseMatrix:U.clone(),matrixWorld:F.clone(),p1:M.clone(),p2:p.clone(),p3:s.clone(),uv1:j.clone(),uv2:f.clone(),uv3:c.clone(),plane:(new n.Math.Plane).setFromCoplanarPoints(M,p,s)}),L=Oj.uvIntersection(d,M,p,s,j,f,c));var W=z(M,p,s),D=z(M.applyMatrix4(F),p.applyMatrix4(F),s.applyMatrix4(F)),mf=C.direction.dot(W);mf>0&&(W.multiplyScalar(-1),D.multiplyScalar(-1));var Xl={world:$,local:d.clone(),worldNormal:D,normal:W,uv:L,part:B};return q&&(Xl.triangleInfo=q),Xl}}()});var it=function(x,R){this.gv=x,this.s=function(L,G,f){return G==S&&(G=f),G==S?R.getStyle(L):dd(G,R,x)},this.data=R};Dh(it,o,{I3d:!0,ms_icons:1,_iv:!0,_cacheBoundingBox:W,iv:function(){this._iv=!0},update:function(l,t,L){var D=this,Q=D.data;if(l||(l=D.gv,t=l.getGL(),L=l._40Q),!D.needValidate(t)||!l.isVisible(Q))return L.push(this,!1),void 0;var m,K,T,M,u,w=Q._id,E=Q._47Q?null:D.s("batch"),Z=Q.getRenderLayer(),Y=L.get(Z,!0),d=Y.batchIndexMap,k=Y.batchModelMap,g=l.getBrightness(Q),c=g!=S&&1!==g;m=ip(d,k,Q,E,l);var a=E?l.getBatchInfo(E)||Zc:S,G=D.validate(m,a);if(m&&(!a.ms||!a.ms.length)&&(K=d[w],T=K.size=m.vs.length/3-K.begin,u=m.rs))for(g=c?g:1,M=0;T>M;M++)u.push(g);var o=l.getWireframeGeometry(Q);if(o)_m(l,Q,o);else if(af(Q)){var H=l.getWireframe(Q);H&&_m(l,Q,H)}D.labelInfo=D.label2Info=D.noteInfo=D.note2Info=D._38o=S,D._24O(Jo,"getLabel"),D._24O(tj,"getLabel2"),D._26O(Ml,"getNote"),D._26O(Eg,"getNote2"),D._15O(),D.interactiveInfo=l.isInteractive(Q)?{}:S,Y.push(this,!0),G!==!1&&(D._iv=!1)},clearWireframeGeometryCache:function(){var Y=this;_g(Y),Y.data.iv()},_46Q:function(e){var X=this,N=X.data,I=X.gv;if(I.isVisible(N)){var U=N._id,c=I._40Q.get(N._renderLayer,!0),k=c.batchIndexMap[U],o=c.polylineIndexMap[U],S=c.wireframeIndexMap[U];if(k||o||S){var $=di(e,I.pickColorMap,I.isSelectable(N),X,rb,!0);$&&(ai($,k,c.batchModelMap,I),ai($,o,c.polylineModelMap,I),ai($,S,c.wireframeModelMap,I))}}},_42:function(q,l,D){function C(y,Z,l){var r=Z.getBrightness(l),U=l.s("alphaTest"),M=l.s("envmap"),n=el.for(y),F=n.directUniforms();r!=S&&1!==r&&(F.uBrightness=r),F.uAlphaTest=U,F.uUseEnvMap=M?!0:!1,F.uReflectivity=M||.01,F.roughness=l.s("roughness"),Z._setEnvmapByProbeId(F,l.s("envmap.probe")),F.shadowReceive=!G&&l.s("shadow.receive"),F.shadowCull=!G&&!!l.s("shadow.cull"),ri(Z,F,l.s("3d.clipbox")?Hp:l.s("3d.clipbox.mask"));var I=o.s("3d.clip.direction");if(I){var j=o.s("3d.clip.percentage");0===j&&(X=!1);var u=o._formatClipUniforms(I,j,l);F.uClipPercent=u[1],F.uClipDirection=u[0]}else F.uClipDirection=0;y._blooming&&!l.s("bloom")&&(F.blackout=!0),G||(Z._flowObjects.length&&Z.flowMap.resetDataFlowEnabld(l,F),Wr(Z,F,l.s("light.mask"),l.s("headlight.ambientIntensity")))}var o=this,M=o.data,r=o.gv;if(r.isVisible(M)){var b,G=r._picking;if(G)b=r.pickColorMap;else{if(r.isTransparentMask(M)||r.isReflecting(q)&&M.s("3d.reflectable")===!1)return;b=W}if(it.getTitle===W){it.getTitle=0;for(var R in H)if(R.length===tj.length+1&&R[tj.length]===Kf[4].toUpperCase()&&R[tj.length-1]===Kf[tj.length+1].toUpperCase()){it.getTitle=yi;break}}if(!it.getTitle||Gc[tj.length+2]){if(it.getHead===W){it.getHead=0;for(var R in O){var L="box-sizing";6===R.length&&R[0]===Kf[4]&&R[3]===L[0]&&R[4]===L[1]&&R[5]===L[2]&&(it.getHead=aj)}}if(!it.getHead||Gc[tj.length]){if(it.getTitle2===W){it.getTitle2=0;for(var R in O){var U="uv";6===R.length&&R[0]===cr[1].toUpperCase()&&R[1]===U[0]&&(it.getTitle2=Yr)}}if(!it.getTitle2||Gc[Zm.length]){var v,g,T=M._id,y=r._40Q.get(M._renderLayer,!0),i=y.batchIndexMap,P=y.batchModelMap,Q=r.isSelectable(M),$=!1,X=!0,p=i[T];if(G&&(g=di(q,b,Q,o,rb,p),g&&!r._45Q&&(ai(g,p,P,r),ai(g,y.polylineIndexMap[T],y.polylineModelMap,r),ai(g,y.wireframeIndexMap[T],y.wireframeModelMap,r))),p||($||($=!0,C(q,r,M)),X&&o._80o(q,l,D)),r.isLabelVisible(M)&&((v=o.labelInfo)&&(G&&di(q,b,Q,o,Jo),$||($=!0,C(q,r,M)),o._28O(v,Jo,D)),(v=o.label2Info)&&(G&&di(q,b,Q,o,tj),$||($=!0,C(q,r,M)),o._28O(v,tj,D))),r.isNoteVisible(M)&&((v=o.noteInfo)&&(G&&di(q,b,Q,o,Ml),$||($=!0,C(q,r,M)),o._29O(v,Ml,D)),(v=o.note2Info)&&(G&&di(q,b,Q,o,Eg),$||($=!0,C(q,r,M)),o._29O(v,Eg,D))),(v=o._38o)&&($||($=!0,C(q,r,M)),o._99O(q,l,v,b,Q,D)),$){var V=el.for(q).directUniforms();V.uBrightness=1,V.uClipDirection=0,q._blooming&&(V.blackout=!1)}}}}}},_formatClipUniforms:function(o,U,Q){switch(o){case"uv.right":o=7;break;case"uv.left":o=8;break;case"left":o=2;break;case"top":o=3;break;case"bottom":o=4;break;case"front":o=5;break;case"back":o=6;break;case"right":default:o=1}if(0===o%2&&(U=1-U),7!==o&&8!==o)if(Q instanceof n.Shape){var W=Q.s3(),s=Q.p3(),l=Q.getAnchor3d();U=3>o?(U-l.x)*W[0]+s[0]:5>o?(U-l.y)*W[1]+s[1]:(U-l.z)*W[2]+s[2]}else U-=.5;return[o,U]},prepare:function(){var e=this,d=e.data;if(!(d instanceof $n)){var u,L,x,U,Z,J=e.gv,Q=J.getGL(),X=d._id,P=e.s("batch"),o=J._batchIndexMap,R=J._batchModelMap,n=J.getBrightness(d),w=n!=S&&1!==n;if(e.needValidate(Q)){u=ip(o,R,d,P,J);var K=P?J.getBatchInfo(P)||Zc:S;if(e.validate(u,K),u&&(!K.ms||!K.ms.length)&&(L=o[X],x=L.size=u.vs.length/3-L.begin,Z=u.rs))for(n=w?n:1,U=0;x>U;U++)Z.push(n);if(af(d)){var G=J.getWireframeGeometry(d);if(G)_m(J,d,G);else{var T=J.getWireframe(d);T&&_m(J,d,T)}}e.labelInfo=e.label2Info=e.noteInfo=e.note2Info=e._38o=S,e._24O(Jo,"getLabel"),e._24O(tj,"getLabel2"),e._26O(Ml,"getNote"),e._26O(Eg,"getNote2"),e._15O(),e.interactiveInfo=J.isInteractive(d)?{}:S,e._iv=!1}}},dispatchBoundingBoxChanged:function(){this._cacheBoundingBox=W},getBoundingBox:function(){var b,_,U,L,h,y;return function(){if(this._cacheBoundingBox)return this._cacheBoundingBox;b||(b={vs:Ar,is:Ph,uv:Xp},_=new se,U=new se,L=new se,h=new se,y=new se);var i=this,u=i.data,M=i.shapeModel;if(!M&&(u instanceof n.Polyline||u instanceof n.Edge)&&i.lineShapeModel&&(M=i.lineShapeModel),M||(M=ze(i)),M||(n.CSGNode&&u instanceof n.CSGNode||n.CSGShape&&u instanceof n.CSGShape?(isCSG=!0,M=[i.left,i.front,i.right,i.back,i.top,i.bottom,i.csg]):u instanceof n.Node&&!(u instanceof n.Shape)?M=b:(i.left||i.front||i.right||i.back||i.top||i.bottom)&&(M=[i.left,i.front,i.right,i.back,i.top,i.bottom])),!M)return W;Td(M)||(M=[M]);var K,S,j,J,X,A,d,D,g,f,B,R,Q=["","top_","bottom_"],z=new n.Math.Box3,l=!1;if(i._needRecoverPosition){h.set.apply(h,u.p3());var x=u.s3();y.set(1/(x[0]||1),1/(x[1]||1),1/(x[2]||1))}else h.set(0,0,0),y.set(1,1,1);var G=[];for(Qi(M,i,G),K=0,S=G.length;S>K;K++)if(g=G[K])for(j=0,J=Q.length;J>j;j++)if(f=Q[j],d=g[f+"vs"],D=g[f+"is"],d){if(R=f+"boundingBox",B=g[R],!B)for(g[R]=B=new n.Math.Box3,X=0,A=D?D.length:d.length/3;A>X;X+=3)D?(_.fromArray(d,3*D[X]).sub(h).multiply(y),U.fromArray(d,3*D[X+1]).sub(h).multiply(y),L.fromArray(d,3*D[X+2]).sub(h).multiply(y)):(_.fromArray(d,3*X).sub(h).multiply(y),U.fromArray(d,3*(X+1)).sub(h).multiply(y),L.fromArray(d,3*(X+2)).sub(h).multiply(y)),!_.isNaN()&&B.expandByPoint(_),!U.isNaN()&&B.expandByPoint(U),!L.isNaN()&&B.expandByPoint(L);z.expandByBox(B),l=!0}return l?(this._cacheBoundingBox=z,o.freeze(z),o.freeze(z.min),o.freeze(z.max),xg(i.gv,u),z):W}}(),needValidate:function(){return this._iv},validate:function(){},_16O:function(){return js},_80o:function(){},dispose:function(){var L=this,T=L._pickId;if(T){var k=L.gv.pickColorMap;k[T]&&delete k[T]}},getBodyColor:function(T){var L=this.data,O=this.gv.getBodyColor(L);return O?O:T?L.getStyle(T):S},contextLost:function(){this._cachedTextures&&this.gv.invalidateCachedTexture(this.data)},getCachedTexture:function(t){var $=this._cachedTextures;return $?$[t||"main"]:null},setCachedTexture:function(h,M){var H=this._cachedTextures;return H||(H=this._cachedTextures={}),H[M||"main"]=h,h},invalidateCachedTexture:function(G){var O=this._cachedTextures;if(O){for(var m in O)G.deleteTexture(O[m]);this._cachedTextures={}}},invalidateCachedGeometry:function(){},_24O:function(o,V){var J=this,n=J.data,E=J.gv,g=J.s,b=E[V](n);if(b!=S){var p=g(o+".scale"),u=g(o+".max"),f=J[o+"Info"]={label:b,textureScale:g(o+".texture.scale"),color:E[V+"Color"](n),font:g(o+".font"),align:g(o+".align"),background:E[V+"Background"](n)},P=f.rect=yf(f,b);u>0&&u<P.width&&(f.labelWidth=P.width,P.width=u),P.x=P.y=0,P.width*=p,P.height*=p,f.mat=J._16O(g(o+".autorotate"),g(o+".position"),P,g(o+".face"),g(o+".t3"),g(o+".r3"),g(o+".rotationMode"));var v=P.width/2,r=P.height/2;f.vs=new mo([-v,r,0,-v,-r,0,v,-r,0,v,r,0]),P.width/=p,P.height/=p}},_26O:function(x,j){var O=this,w=O.data,n=O.gv,P=O.s,r=n[j](w);if(r!=S){var I=P(x+".scale"),q=this[x+"Info"]={note:r,textureScale:P(x+".texture.scale"),expanded:P(x+".expanded"),font:P(x+".font"),color:P(x+".color"),align:P(x+".align"),borderWidth:P(x+".border.width"),borderColor:P(x+".border.color"),background:n[j+"Background"](w)};if(q.expanded){var G=P(x+".max"),H=yf(q,r);H.width+=6,H.height+=2,G>0&&G<H.width&&(q.labelWidth=H.width,H.width=G);var Q={x:-H.width/2,y:-8-H.height,width:H.width,height:H.height+8}}else Q={x:-6,y:-18,width:12,height:18};q.mat=O._16O(P(x+".autorotate"),P(x+".position"),S,P(x+".face"),P(x+".t3"),P(x+".r3"),P(x+".rotationMode")),q.rect=Q,1!==I&&(Q=Dl(Q),Q.x*=I,Q.height*=I,Q.y=-Q.height,Q.width*=I);var y=Q.x,E=Q.y,f=Q.width,W=Q.height;q.vs=new mo([y,-E,0,y,-E-W,0,y+f,-E-W,0,y+f,-E,0])}},eachShapeModel:function(I,j){function k(x){Sm(x),x.vs&&I(x.vs,x.is,x.ns,x.uv),x.top_vs&&I(x.top_vs,x.top_is,x.top_ns,x.top_uv),x.bottom_vs&&I(x.bottom_vs,x.bottom_is,x.bottom_ns,x.bottom_uv),x.from_vs&&I(x.from_vs,x.from_is,x.from_ns,x.from_uv),x.to_vs&&I(x.to_vs,x.to_is,x.to_ns,x.to_uv)}function T(V){var c,M,w;if(Td(V))for(M=0,w=V.length;w>M;M++)c=V[M],c&&T(c);else xd(V)?T(ze(U,V),U):Il(V)&&(V.shape3d?T(V.shape3d):k(V))}var U=this,m=U.data,j=j||U.shapeModel||ze(U);j||(j=m instanceof n.Node&&!(m instanceof n.Shape)?{vs:Ar,is:Ph}:[U.left,U.front,U.right,U.back,U.top,U.bottom]),T(j)},_28O:function(b,S,Y){if(Y(this.s(S+".transparent"))){var E=b.rect,U=b.textureScale,q=E.width*U,h=E.height*U;if(q>=1&&h>=1){var i=mp(q,h);1!==U&&(i.translate(E.x,E.y),i.scale(U,U),i.translate(-E.x,-E.y)),Ro(i,b),i.restore(),Jg(this,S,b.mat,b.vs,!0)}}},_29O:function(Q,C,R){if(R(this.s(C+".transparent"))){var d=Q.rect,i=Q.textureScale,m=d.x,y=d.y,b=d.width*i,j=d.height*i;if(b>=1&&j>=1){d.x=d.y=0;var I=mp(b,j);1!==i&&I.scale(i,i),Am(I,Q),I.restore(),d.x=m,d.y=y,Jg(this,C,Q.mat,Q.vs,!1)}}},_99O:function(q,h,g,V,F,b){if(g){var N=this,s=N.gv,c=N.data,H=s._buffer,I=s._1O,J=g.icons,x=el.for(q),l=x.directAttribs();for(var X in J){var j=J[X],z=g.rects[X];if(z&&b(dd(j.transparent,c,s))){s._picking&&di(q,V,F,N,X);var u=dd(j.shape3d,c,s),D=u?[u]:dd(j.names,c,s),w=D?D.length:0,e=dd(j.textureScale,c,s)||1,B=dd(j.light,c,s);B==S&&(B=u?!0:!1),Vf(q,h,dd(j.blend,c,s),B,dd(j.opacity,c,s),dd(j.reverseFlip,c,s),dd(j.reverseColor,c,s),dd(j.reverseCull,c,s));for(var k=0;w>k;k++){var $=D[k],G=z[k];if(sb(N,G.mat),u)Wc(s,c,ze(N,u),N);else{var R=Fr($);if(R){var M=G.width*e,p=G.height*e;if(M>=1&&p>=1){var y=mp(M,p);xe(y,R,dd(j.stretch,c,s),0,0,M,p,c,s),y.restore(),ad(q,Qe,I),jo(q,h,I,dd(j.discardSelectable,c,s),H.uv,mr),l.aPosition=bm(q,H.vs,G.vs,S),l.aNormal=Lo(q,H.ns,ss,S),gl(q,H.is,wj),Yi(q,0,wj.length),xj(q,h,I)}}}fn(s)}op(q,h)}}}}});var jt=function(y,d){fb(jt,this,[y,d])};Dh(jt,it,{_16O:function(U,K,b,m,$,M,V,j,f){var D=this.data,Y=D.getFinalScale3d(),r=Zd(K,Y,b,m,j,f);if(D.hasOwnProperty("_anchor")||D.hasOwnProperty("_anchorElevation")){var q=D.getAnchor3d();r[0]-=(q.x-.5)*Y[0],r[1]-=(q.y-.5)*Y[1],r[2]-=(q.z-.5)*Y[2]}return Be(Pb(),r,D.p3(),m,$,M,V,U,D.getFinalRotation3d(),D.getRotationMode())},clear:function(){var b=this;b.faceMat=b.mat=b.shapeModel=b.left=b.right=b.front=b.back=b.top=b.bottom=b.csg=S},needValidate:function(D){if(this._iv)return this._validateFrameId=D._renderInfo.frame,!0;if(this.data._47Q){var c=D._renderInfo.frame;if(this._validateFrameId!==c)return this._validateFrameId=c,!0}return!1},validate:function(t,H){var R=this,Y=R.gv,b=R.data,r=R.shapeName=R.s(Cd),N=ze(R,r);if(R._updateAutoRotation(),R._updateFixSize2d(),R._updateOverlapping(),R.dispatchBoundingBoxChanged(),b._47Q){var g=b.getRenderLayer(),n=Y._40Q.get(g);n&&n.ivWireframeBatch(b)}var k=tp(b,Y.getMat(b),N?R.s("shape3d.scaleable"):!0);if(b.appendAnchorMatrix3d(k),R.clear(),R.mat=b.mat=k,N||!r)if(R.shapeModel=N,t)if(N)H.instanced?Y.batchInstancedModel(b,N,R,R.getBodyColor(),[k],t):Ud(Y,b,N,R,R.getBodyColor(),[k],t);else{var F=Zo(k);H.instanced?Y.batchInstancedFace(b,t,H,k,F):Fj(Y,b,t,H,k,F)}else N||(R._cubeUvs=null,R.vf(Vn,0),R.vf(_k,16),R.vf(sl,8),R.vf($i,24),R.vf(Dr,32),R.vf(Er,40))},_updateAutoRotation:function(){var S=new pq,H=new xn,V=new se,E=new se,J=new se;return function(){var $=this,v=$.data,w=$.s("autorotate")||$.s("shape3d.autorotate");if(!w)return v._dynamicRotation&&delete v._dynamicRotation,void 0;var U=$.gv;J.copy($.s("shape3d.autorotate.up")||U._up);var c;c="string"==typeof w?[w.indexOf("x")<0?U._eye[0]:U._center[0],w.indexOf("y")<0?U._eye[1]:U._center[1],w.indexOf("z")<0?U._eye[2]:U._center[2]]:U._eye;var u=U._center,Q=v.p3();V.copy(Q),E.set(c[0]-u[0],c[1]-u[1],c[2]-u[2]).add(V),H.lookAt(E,V,J),S.set(0,0,0,v.getRotationMode(),!0).setFromRotationMatrix(H);var m=v._dynamicRotation;m&&Math.abs(m[0]-S.x)<1e-5&&Math.abs(m[1]-S.y)<1e-5&&Math.abs(m[2]-S.z)<1e-5||(v._dynamicRotation=[S.x,S.y,S.z])}}(),_updateFixSize2d:function(){var T=this,S=T.data,w=T.s("fixSizeOnScreen")||T.s("shape3d.fixSizeOnScreen");if(!w)return S._dynamicScale3d&&delete S._dynamicScale3d,void 0;var R=T.gv,e=tp(S,R.getMat(S)),E=ak([0,0,0],e),l=R.toViewPosition(E);if(!isNaN(l.x)&&!isNaN(l.y)){var K=ak([1,0,0],e),L=R.toViewPosition(K),y=ak([0,1,0],e),d=R.toViewPosition(y),B=L.x-l.x,t=d.y-l.y;if(B&&t){var U,j,F=S._dynamicScale3d||[1,1,1],G=Fr(S.s("shape3d.image"));if(w[0]>0&&(U=w[0]),w[1]>0&&(j=w[1]),!U||!j){var r=w>0?w:1;U||(U=(lm(G,S)||S.getWidth())*r),j||(j=(qj(G,S)||S.getTall())*r)}var M=Math.abs(B/U),g=Math.abs(t/j);Math.abs(M-1)<.001&&Math.abs(g-1)<.001||(S._dynamicScale3d=[F[0]/M,F[1]/g,F[2]])}}},_updateOverlapping:function(){var V=this,$=V.s("hide.overlapping.group");if(!$)return V._rectOverlapping&&(V._rectOverlapping=W),void 0;var o,L,Z,p=V.gv,D=V.data,m=tp(D,p.getMat(D)),q=1/0,S=1/0,R=-1/0,w=-1/0,F=D.getAnchor3d(),u=F.x,X=F.y,Q=F.z;for(o=0;8>o;o++){if(L=ak([(o>>2)-u,(1&o>>1)-X,(1&o)-Q],m),Z=p.toViewPosition(L),isNaN(Z.x)||isNaN(Z.y))return;q=Math.min(q,Z.x),R=Math.max(R,Z.x),S=Math.min(S,Z.y),w=Math.max(w,Z.y)}var E={x:q,y:S,w:R-q,h:w-S};V._rectOverlapping=p.overlappingBox.isOverlapping($,E)},getVectorDynamicSize:function(){var X,R=this,M=R.s("shape3d"),d=R.data;if("billboard"===M||"plane"===M||(X=d._currentCubeElementId)!=S){var W,C,_=R.gv,j=tp(d,_.getMat(d)),w=d.getAnchor3d(),n=.5-w.x,K=.5-w.y,p=.5-w.z,U=Math.min(R.s("vector.dynamic.maxsize"),_._glCapabilities.maxTextureSize)/_.getDevicePixelRatio(),H=function(Y,b){Y[0]+=n,Y[1]+=K,Y[2]+=p,b[0]+=n,b[1]+=K,b[2]+=p;var D=_.toViewPosition(ak(Y,j)),Q=_.toViewPosition(ak(b,j)),g=D.x-Q.x,h=D.y-Q.y;return Math.min(U,Math.sqrt(g*g+h*h))};if("billboard"===M)W=H([-.5,0,0],[.5,0,0]),C=H([0,-.5,0],[0,.5,0]);else if("plane"===M)W=H([-.5,0,0],[.5,0,0]),C=H([0,0,-.5],[0,0,.5]);else if(d._currentCubeElementId!=S){var P=3*Ph[X+1],u=3*Ph[X],V=3*Ph[X+2];W=H([Ar[P],Ar[P+1],Ar[P+2]],[Ar[V],Ar[V+1],Ar[V+2]]),C=H([Ar[P],Ar[P+1],Ar[P+2]],[Ar[u],Ar[u+1],Ar[u+2]])}return[W,C]}},vf:function(E,_){var k=this;if(k.gv.getFaceVisible(k.data,E)){var t=Bf(k,E);t.mat&&(k.faceMat=!0);var X=t.uv;if(X){var L=k._cubeUvs;L||(L=k._cubeUvs=new mo([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var M=0;8>M;M++)L[_+M]=X[M]}return t}},_billboardInView:function(){var f=[-.5,-.5,0,-.5,.5,0,.5,-.5,0,.5,.5,0],Z=[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,.5],A=new Pf,T=new se,J=new xn;return function(Q){var M=this;if(!M.mat)return!0;var K=M.gv.getFrustum(),v="billboard"===Q?f:Z;A.makeEmpty(),J.fromArray(M.mat);for(var G=0,p=v.length;p>G;G+=3)A.expandByPoint(T.fromArray(v,G).applyMatrix4(J));return K.intersectsBox(A)}}(),_80o:function(I,Q,K){var X=this;if(X._rectOverlapping)return!0;var P=X.shapeModel;if(P||!X.shapeName){var N=X.s("shape3d");if(("billboard"===N||"plane"===N)&&!X._billboardInView(N))return!0;var y=X.gv,J=X.data,t=y._cube,V=el.for(I),Z=V.directAttribs();if(Pk&&!Lc){var w=X.mat;if(w)for(var j=0;j<w.length;j++)X.mat[j]=w[w.length-j-1]}Ac(y,X.mat),!I._picking&&X.s("shape3d.reflector")||X.s("effect.flow")||(P?Wc(y,J,P,X,X.getBodyColor(),K):(Z.aPosition=bm(I,t.vs,S,S),Z.aNormal=bm(I,t.ns,S,S),Jq(I,t.is),X._18O(I,Q,"left",0,K),X._18O(I,Q,"front",6,K),X._18O(I,Q,"right",12,K),X._18O(I,Q,"back",18,K),X._18O(I,Q,"top",24,K),X._18O(I,Q,"bottom",30,K))),fn(y),X.faceMat&&(X._18O(I,Q,"left",0,K,!0),X._18O(I,Q,"front",6,K,!0),X._18O(I,Q,"right",12,K,!0),X._18O(I,Q,"back",18,K,!0),X._18O(I,Q,"top",24,K,!0),X._18O(I,Q,"bottom",30,K,!0))
}},_18O:function(x,u,t,Z,_,i){var Q=this[t];if(Q){if(!_(Q.transparent))return;if(i&&!Q.mat||!i&&Q.mat)return;var h=this.data.s("polygonOffset");h&&bd(x,h),i&&Ac(this.gv,Q.mat);var C=this,A=C.data,n=el.for(x),U=n.directUniforms();A._currentCubeElementId=Z;var O=C.gv,s=O.getTexture(Q.texture,A,t),k=Q.uv,a=Q.uvScale,H=Q.uvOffset,N=Q.uvRotation,J=Q.uvAnchor,d=Q.discardSelectable;s?k?jo(x,u,s,d,O._buffer.uv,C._cubeUvs,H,a,N,J):jo(x,u,s,d,O._cube.uv,S,H,a,N,J):jo(x),Vf(x,u,Q.blend,Q.light,Q.opacity,Q.reverseFlip,Q.reverseColor,Q.reverseCull),U.uDiffuse=Q.color||D["color.empty"],Yi(x,Z,6),op(x,u),xj(x,u,s),i&&fn(O),h&&Vh(x),A._currentCubeElementId=null}},contextLost:function(){jt.superClass.contextLost.apply(this,arguments),this.data.s("shape3d.reflector")&&(this._reflectorRenderTarget=null,this._reflectNormal=null)},drawReflector:function(){var z=new se,K=new se,m=new pq,j=new xn,N=new se,G=new se,u=new se,D=new se,h=new xn,v=new xn,l=new Dk,e=new lq,I=new lq,f=function($,Z,y){$[y]=Z[0],$[y+1]=Z[1],$[y+2]=Z[2]},F=function(C,F,P){P=P||0,C[0]=F[P],C[1]=F[P+1],C[2]=F[P+2]},k=function(p,O){f(p,O.getEye(),0),f(p,O.getCenter(),3),f(p,O.getUp(),6)},i=function(q,y){F(y._eye,q,0),F(y._center,q,3),F(y._up,q,6),y._18Q=S;var s=y._skybox;s&&(s.p3([q[0],q[1],q[2]]),y.getData3dUI(s).iv())};return function(L){var E=this;E._reflectorInfo=null;var b=E.data;if(b._reflecting)return!1;var y=E.gv;if(y._picking)return!1;var p=b instanceof Fb,Z=E._reflectorRenderTarget,J=y._canvas.width,U=y._canvas.height;if(Z?Z.setSize(L,J,U):Z=E._reflectorRenderTarget=new ko.RenderTarget(y,L,J,U),p){var x=b.getPointsMatrix3d().getElements(),H=b.p3();H[1]+=(1-b.getAnchorElevation())*b.getTall(),z.copy(ak(H,x))}else z.copy(b.p3());if(K.copy(y.getEye()),j.makeRotationFromEuler(m.set(b.r3(),b.getRotationMode(),!0)),!E._reflectNormal){var C;if(p&&b.getThickness()<0){if(!E.shapeModel||!E.shapeModel.top_vs)return!1;C={vs:E.shapeModel.top_vs,ns:E.shapeModel.top_ns}}else{if(C=ze(E,E.s("shape3d")),!C)return!1;!C.ns&&C.length&&(C=C[0])}if(!C.ns||!C.vs)return!1;E._reflectNormal=[C.ns[0],C.ns[1],C.ns[2]],E._reflectorVbuffer=co.Buffer.createVertexBuffer(L,new Float32Array(C.vs))}if(N.copy(E._reflectNormal),N.applyMatrix4(j),G.subVectors(z,K),G.dot(N)>0)return!1;G.reflect(N).negate(),G.add(z),u.copy(y.getCenter()).negate().add(z),u.reflect(N).negate(),u.add(z),D.copy(y.getUp()),D.reflect(N);var T=[0,0,0,0,0,0,0,0,0];k(T,y),F(y._eye,G.toArray()),F(y._center,u.toArray()),F(y._up,D.toArray()),y._18Q=S;var s=y._skybox;s&&(s.p3(y._eye),y.getData3dUI(s).iv()),Mn(L,Z.frame),y.setViewport(L,0,0,Z.width,Z.height);var A=b.s("shape3d.reflector.background");if(A){var M=L.getParameter(L.COLOR_CLEAR_VALUE);uq(L,A)}else uq(L,[0,0,0,1]);el.for(L).glState.depth.mask=!0,L.clear(L.COLOR_BUFFER_BIT|L.DEPTH_BUFFER_BIT);var V=b.s("shape3d.reflector.clip"),Q=V===W?.003:V,_=zo(y),$=om(y);l.setFromNormalAndCoplanarPoint(N,z.add(N.clone().multiplyScalar(Q))),l.applyMatrix4(v.fromArray($)),e.set(l.normal.x,l.normal.y,l.normal.z,l.constant),v.fromArray(_).getInverse(v),I.set(Math.sign(e.x),Math.sign(e.y),1,1).applyMatrix4(v),e.multiplyScalar(2/e.dot(I)),_[2]=e.x-_[3],_[6]=e.y-_[7],_[10]=e.z-_[11],_[14]=e.w-_[15];var R=y._computedProjectMatrix;y._computedProjectMatrix=_,b._reflecting=!0;var a=b.s("shape3d.reflector.shadow"),n={renderAxis:!1,renderEdit:!1,renderGrid:!1};"disabled"===a?(n.createShadowMap=!1,n.renderShadow=!1):"scene"===a?n.createShadowMap=!1:n.useReflectorSelfShadowMap=!0,y.renderScene(n),y._computedProjectMatrix=R,h.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),h.multiply(v.fromArray(y._projectMatrix)),h.multiply(v.fromArray(y._viewMatrix)),A&&uq(L,M),Uq(L),i(T,y);var t=b.s("shape3d.reflector.blur");if(t){var f=y.getPostProcessingModule("Blur");f&&f.drawImpl(L,Z,t,t>=3,b.s("shape3d.reflector.blur.iterations"))}var o=y.getPostProcessingModule("Glitch");o&&o.enable&&o.onlyReflector&&(Z=o._42(L,Z));var d=L._compiledShader.reflector;d||(d=L._compiledShader.reflector=new co.Shader(L,lb.Reflector.vs,lb.Reflector.fs)),d.bind(),L.activeTexture(L.TEXTURE0),fd(L,Z.texture),d.uniforms.tDiffuse=0,d.uniforms.color=Bp(b.s("shape3d.reflector.color")||"rgb(128,128,128)"),d.uniforms.textureMatrix=h.toArray(),d.uniforms.modelMatrix=p?x:tp(b),d.uniforms.viewMatrix=om(y),d.uniforms.projectionMatrix=zo(y);var g=E._reflectorVbuffer;g.upload(),d.attributes.pos.pointer(g);var r=this.s("shape3d.transparent");if(r){var P=el.for(L).glState,w=P.depth.mask;P.depth.mask=!1}return L.drawArrays(L.TRIANGLES,0,g.data.length/3),r&&(P.depth.mask=w),b._reflecting=!1,L.useProgram(y._prg),fd(L,S),!0}}()}),lb.Reflector={vs:["attribute vec3 pos;","uniform mat4 textureMatrix;","uniform mat4 modelMatrix;","uniform mat4 viewMatrix;","uniform mat4 projectionMatrix;","varying vec4 vUv;","void main() {","	vUv = textureMatrix * modelMatrix * vec4( pos, 1.0 );","	gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( pos, 1.0 );","}"].join("\n"),fs:["precision highp float;","uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","	return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","	return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","	vec4 base = texture2DProj( tDiffuse, vUv );","   vec2 tUv = vUv.xy / vUv.w;","   if (tUv.x < .0 || tUv.y < .0 || tUv.x > 1. || tUv.y > 1.) discard;","	gl_FragColor = vec4( blendOverlay( base.rgb, color ), base.a );","}"].join("\n")};var kt=function(D,c){fb(kt,this,[D,c])};Dh(kt,jt,{_80o:function(){}});var lt=function(y,W){fb(lt,this,[y,W])};Dh(lt,it,{_25Q:1,validate:function(v){var K=this;if(!K.s("geometry.cache")||!K.info){var V=K.gv,B=K.data,Y=K.s,k=Y("edge.width"),F=B._40I,g=B._41I;if(K.shapeModel=K.info=K.lineShapeModel=S,F&&g){var o,l,L,U,u,r,m,n,W,y,Z=B.isLooped(),T=Y(bk),z=H.getEdgeType(T);if(z){var f=z(B,us(K,V,B,Z,T),V,K._19Q);if(!f.points||f.points.isEmpty())return;r=K.info={},m=f.segments,u=f.points,n=u.size();for(var X=F.getElevation(),e=g.getElevation(),C=0;n>C;C++){var P=u.get(C);P.e==S&&(P.e=X+(e-X)*C/(n-1))}W=Ol(u.get(0)),y=Ol(u.get(n-1));var $=n%2,s=(n-$)/2;r.c1=Ol(u.get(s-1)),r.c2=Ol(u.get(s)),0!==$&&(r.p3=r.c2),r.s1=W,r.s2=Ol(u.get(1)),r.t1=Ol(u.get(n-2)),r.t2=y}else{u=new Xd,r=K.info={};var a=Y("edge.offset"),G=Y("edge.center"),I=Y("edge.source.t3"),q=Y("edge.target.t3"),d=Bd(V,B,"source"),O=Bd(V,B,"target");if(!d||!O)return V.invalidateData(B),delete K.info,!1;if(I&&(d[0]+=I[0],d[1]+=I[1],d[2]+=I[2]),q&&(O[0]+=q[0],O[1]+=q[1],O[2]+=q[2]),T===We){m=Y("edge.segments");var b=r.points=Y(Fd)||Ve;if(n=b.size()){if(W=Ol(b.get(0)),y=Ol(b.get(n-1)),!G&&a){var j=a;L=Od(W,d,!0),a=_(j,_h(d,W)),d=[d[0]+L[0]*a,d[1]+L[1]*a,d[2]+L[2]*a],L=Od(O,y,!0),a=_(j,_h(y,O)),O=[O[0]-L[0]*a,O[1]-L[1]*a,O[2]-L[2]*a]}if(1===n)r.p3=W;else{var $=n%2,s=(n-$)/2;o=Ol(b.get(s-1)),l=Ol(b.get(s)),0!==$&&(r.p3=l),r.s1=d,r.s2=W,r.t1=y,r.t2=O}}else!G&&a&&(L=Od(O,d,!0),U=_h(d,O),a=Wn(a,U),d=[d[0]+L[0]*a,d[1]+L[1]*a,d[2]+L[2]*a],O=[O[0]-L[0]*a,O[1]-L[1]*a,O[2]-L[2]*a]),o=d,l=O;u.add({x:d[0],y:d[2],e:d[1]}),u.addAll(b),u.add({x:O[0],y:O[2],e:O[1]})}else{var R=us(K,V,B,Z,T);if(K._19Q||(R=-R),Z){var w=d[0],h=d[1],i=d[2],M=F.getTall()/2+R;o=[w-R,h+M,i],l=[w+R,h+M,i],u.add({x:w-R,y:i,e:h}),u.add({x:w-R,y:i,e:h+M}),u.add({x:w+R,y:i,e:h+M}),u.add({x:w+R,y:i,e:h})}else{L=Od(O,d,!0),U=_h(d,O);var E={x:d[0],y:d[2]},x={x:O[0],y:O[2]},p=Mo(S,E,x,R),t=p.x-E.x,c=p.y-E.y;a=Wn(a,U),L[0]*=a,L[1]*=a,L[2]*=a,o=[d[0]+L[0]+t,d[1]+L[1],d[2]+L[2]+c],l=[O[0]-L[0]+t,O[1]-L[1],O[2]-L[2]+c],G?(u.add({x:d[0],y:d[2],e:d[1]}),u.add({x:o[0],y:o[2],e:o[1]}),u.add({x:l[0],y:l[2],e:l[1]}),u.add({x:O[0],y:O[2],e:O[1]})):(u.add({x:o[0],y:o[2],e:o[1]}),u.add({x:l[0],y:l[2],e:l[1]}))}}r.c1=o,r.c2=l}r._lastPointsSegments={points:u,segments:m},r.list=Y(Cd)===gs?K.createTubeModel(u,m,k/2,v):K.createLineModel(u,m,k,"edge","edge.dash")}}},invalidateCachedGeometry:function(){this.info=S}});var mt=function(h,z){fb(mt,this,[h,z]),this._needRecoverPosition=!0};Dh(mt,jt,{_80o:function(k,O,h){var a=this,Z=a._matWithExtraction||a.mat;if(Z&&(!a.s("shape3d.reflector")||k._picking)){var g=a.gv,U=a.shapeModel;Ac(g,Z),U?Wc(g,a.data,U,a,a.getBodyColor(),h):(Mi(a,k,O,"left",h),Mi(a,k,O,"front",h),Mi(a,k,O,"right",h),Mi(a,k,O,"back",h),Mi(a,k,O,"top",h),Mi(a,k,O,"bottom",h)),fn(g)}},validate:function(r,Y){var C,Z,x=this,l=x.s,o=x.data,$=o._thickness/2,j=o.isClosePath(),b=o.getPoints(),J=o.getSegments(),M=l(Kc),K=r&&r.uv;if(x.clear(),x.dispatchBoundingBoxChanged(),H.extractShapeTranslation||H.extractVerticesTranslation){var R=new Po.Vector3(o.p3());b=Dl(b),b.forEach(function(X){X.x-=R.x,X.y-=R.z}),x._vsTranslation=(new Po.Matrix4).setPosition(R);var F=o.getShapeElevation;o.getShapeElevation=function(){return-(this.getTall()||0)*(this._anchorElevation-.5)}}else x._vsTranslation=null;if(0>$){x.s("shape3d.reflector")&&(x._reflectNormal=null);try{var t=l("shape3d.image.projection");if(t&&t[4]){var O=o.p3(),Q=O[0],i=O[2];t=[Q+t[0],t[1]+i,Q+t[2],t[3]+i]}Z=x.shapeModel=Go(b,J,l(ob),l(_l),M,l(cp),o.getTall(),o.getShapeElevation(),j,t)}catch(a){Z=x.shapeModel={}}l(zb)?l("shape3d.image")||delete Z.uv:(delete Z.vs,delete Z.ns,delete Z.uv),l("shape3d.top.image")||delete Z.top_uv,l("shape3d.bottom.image")||delete Z.bottom_uv}else if(l(Cd)===gs)C=Wo(b,J,M,j),Z=x.shapeModel={vs:[]},l("shape3d.image")&&(Z.uv=[],Z.sum=l(cp)||Ke(C)||1,Z.len=0),l(ob)&&!j&&(Z.top_vs=[],l("shape3d.top.image")&&(Z.top_uv=[])),l(_l)&&!j&&(Z.bottom_vs=[],l("shape3d.bottom.image")&&(Z.bottom_uv=[])),x._12O(C,$);else{var N,f,v,e,g,U,q,n,V,G;if(C=Wo(b,J,M,j),g=x.vf(sl,K,!1,Y),$&&(U=x.vf($i,K,!1,Y),q=j?S:x.vf(Vn,K,!1,Y),n=j?S:x.vf(_k,K,!1,Y),V=x.vf(Dr,K,!1,Y),G=x.vf(Er,K,!1,Y)),$){for(var I=0,T=C.length;T>I;I++)C[I]=x._tryRemoveBezierPoints(C[I],$);x._12O(C,$)}else g&&C.forEach(function(O){if(e=O.length,e>0)for(N=O[0],v=1;e>v;v++)f=O[v],x.addV(g.vs,N,f),N=f});x._20Q(C),r||(g&&(g.ns=pn(g.vs),Nk(g,"vs"),Nk(g,Ei)),$&&(U&&(U.ns=pn(U.vs),Nk(U,"vs"),Nk(U,Ei)),q&&(q.ns=pn(q.vs),Nk(q,"vs"),Nk(q,Ei)),n&&(n.ns=pn(n.vs),Nk(n,"vs"),Nk(n,Ei)),V&&(V.ns=pn(V.vs),Nk(V,"vs"),Nk(V,Ei)),G&&(G.ns=pn(G.vs),Nk(G,"vs"),Nk(G,Ei))))}var z=x.mat=o.getPointsMatrix3d().getElements();x._vsTranslation?z=x._matWithExtraction=(new Po.Matrix4).fromArray(z).multiply(x._vsTranslation).toArray():x._matWithExtraction=null,r&&(oj(x,z,r,Z,Y),x.clear()),F!=S&&(o.getShapeElevation=F)},_20Q:function(l){var J,$,O,Q,v,k,f,W,E,R,d,V,q,Y=this,M=Y.front,i=Y.back,r=Y.top,U=Y.bottom,H=M?M.tuv:S,B=i?i.tuv:S,a=r?r.tuv:S,I=U?U.tuv:S,m=0,T={front:0,back:0,top:0,bottom:0};(H||B||a||I)&&(q=Y.s(cp),J=q||Ke(l)||1,d=Y.s("all.uv.union"),l.forEach(function(G){if($=G.length,$>0){for(R in T)V=Y.s(R+".uv.union"),(V===!1||V==S&&d===!1)&&(T[R]=0,q||(J=Ke([G])));for(k=G[0],O=1;$>O;O++){f=G[O],W=_h(k,f);for(R in T)m=T[R],Q=m/J,T[R]=m+=W,v=m/J,"back"===R&&(E=Q,Q=1-v,v=1-E),Y._14O(Y[R],Q,v);k=f}}}))},_14O:function(d,g,w){if(d){var s=d.uv,H=d.tuv;if(H){if(s)var O=s[0]+(s[6]-s[0])*g,B=s[1]+(s[7]-s[1])*g,Y=s[2]+(s[4]-s[2])*g,K=s[3]+(s[5]-s[3])*g,P=s[2]+(s[4]-s[2])*w,M=s[3]+(s[5]-s[3])*w,F=s[0]+(s[6]-s[0])*w,o=s[1]+(s[7]-s[1])*w;else O=g,B=0,Y=g,K=1,P=w,M=1,F=w,o=0;H.push(Y,K,P,M,F,o,F,o,O,B,Y,K)}}},_13O:function(E){var B=E.uv,s=E.tuv;s&&(B?s.push(B[2],B[3],B[4],B[5],B[6],B[7],B[6],B[7],B[0],B[1],B[2],B[3]):s.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(N,G){var g=N.length;if(4>g)return N;var $,J,i,h,k,n,w=!1,E=function(n){return N[n]},H=function(P){return N[g-1-P]};for(k=0;1>=k;k++)for(n=k?H:E,J=n(0),i=n(1),$=2;g-1>$;$++)if(h=n($),!h.remove)if(h.b){var e=Mo(J,i,h,G);e.adjust?(h.remove=!0,w=!0):(J=i,i=h)}else J=i,i=h;if(!w)return N;var u=[];for($=0;g>$;$++)N[$].remove||u.push(N[$]);return u},_12O:function(C,U){var z,o,j,t,f,J=this.s("shape3d.point.epsilon"),i=this;C.forEach(function(D){if(f=D.length,f>0)for(z={p:D[0],n:!0},t=1;f>t;t++)o=D[t],j=f-1>t?D[t+1]:S,j&&Math.abs(o.x-j.x)<J&&Math.abs(o.y-j.y)<J||i.addPoint(z,o,j,U,D)})},addPoint:function(W,v,R,h,D){var X,Y,t,y,n,g,N,e,a,x=this,J=W.p,E=W.f,u=W.b,z=x.s("shape3d.side")||pb,M=x.s("shape3d.start.angle"),w=x.s("shape3d.sweep.angle"),Q=x.shapeModel,P=x.data.isClosePath();if(W.n&&(W.n=!1,E=P&&D.length>2?Mo(D[D.length-2],J,v,h):Mo(S,J,v,h),u=Wj(J,E),Q?Q.top_vs&&x._10O(u,E,z,M,w,Q.top_vs,Q.top_uv):(X=x.left)&&(x.addV(X.vs,u,E),x._13O(X))),Y=R?Mo(J,v,R,h):P&&D.length>2?Mo(J,v,D[1],h):Mo(J,v,S,h),t=Wj(v,Y),Q){var c,G,C=Q.vs,$=Q.uv,B=Q.sum;for($&&(c=Q.len/B,Q.len+=_h(J,v),G=Q.len/B),g=x._9O(u,E,z,M,w),N=x._9O(t,Y,z,M,w),e=0;z>e;e++)a=e+1,Qb(C,g[a]),Qb(C,N[e]),Qb(C,g[e]),Qb(C,N[e]),Qb(C,g[a]),Qb(C,N[a]),$&&(y=e/z,n=a/z,$.push(c,n,G,y,c,y,G,y,c,n,G,n));!R&&Q.bottom_vs&&x._10O(t,Y,z,M,w,Q.bottom_vs,Q.bottom_uv,!0)}else!R&&(X=x.right)&&(x.addV(X.vs,Y,t),x._13O(X)),(X=x.front)&&x.addV(X.vs,E,Y),(X=x.back)&&x.addV(X.vs,t,u),(X=x.top)&&x.addH(X.vs,E,Y,t,u,!0),(X=x.bottom)&&x.addH(X.vs,u,t,Y,E);W.p=v,W.f=Y,W.b=t},_10O:function(b,O,m,h,T,C,q,j){var H,k,u=this,i=u.data,w=u._9O(b,O,m,h,T),v=(b.x+O.x)/2,J=(b.y+O.y)/2,n=i.getShapeElevation(),U=0;for(U=0;m>U;U++)j?(Qb(C,w[U]),Qb(C,w[U+1])):(Qb(C,w[U+1]),Qb(C,w[U])),Qb(C,[v,n,J]),q&&(j?(H=z*(U+1)/m+h,k=z*U/m+h):(H=z*U/m+h,k=z*(U+1)/m+h),q.push(.5-.5*s(k),.5-.5*R(k),.5-.5*s(H),.5-.5*R(H),.5,.5))},_9O:function(X,a,c,g,_){var k,d,A=this,H=A.data,T=[],Q=(X.x+a.x)/2,Y=(X.y+a.y)/2,i=H.getTall()/2,v=H.getShapeElevation(),q=0;for(_==S&&(_=z);c>=q;q++)k=_*q/c+g,d=s(k),T.push([Q+(X.x-Q)*d,v+i*R(k),Y+(X.y-Y)*d]);return T},addV:function(C,V,L){var d=V.x,z=V.y,i=L.x,O=L.y,Z=this.data,l=Z.getShapeElevation(),I=Z.getTall()/2;C.push(d,l-I,z,i,l-I,O,i,l+I,O,i,l+I,O,d,l+I,z,d,l-I,z)},addH:function(l,J,C,U,K,f){var W=this.data,Z=W.getTall()/2,n=W.getShapeElevation()+(f?Z:-Z);l.push(J.x,n,J.y,C.x,n,C.y,U.x,n,U.y,U.x,n,U.y,K.x,n,K.y,J.x,n,J.y)},vf:function(P,r,$,J){var A,Z=this,B=Z.gv.getFaceVisible(Z.data,P);return($||B)&&(A=Bf(Z,P,J),A.vs=[],A.tuv=B&&(A.texture||r)?[]:S,A.visible=B),A}});var nt=function(L,e){fb(nt,this,[L,e])},ot={},pt=function(u){return/\.(png|jpg|gif|jpeg|bmp|svg)$/i.test(u)};Dh(nt,jt,{validate:function(){var g=this,N=g.gv,l=g.data,A=g.s,v=Bp(A("points.color")),U=A("points.size"),G=A("points.uv.offset"),e=A("points.image");!e||pt(e)||dp.test(e)||(ot[e]||(ot[e]=g._createCachedImage(e)),e=ot[e]);var J,$,Q=l._modelDirty,x=A("points.model");if(x){if(g._lastShapeModel!==x||!g.shapeModel){var F=ze(g,x);if(!F)return;var X=[],z={};g.eachShapeModel(function(b){for(var u=0,s=b.length;s>u;u+=3){var p=b[u],k=b[u+1],h=b[u+2],C=""+p+"_"+k+"_"+h;z[C]||(z[C]=!0,X.push(p,k,h))}},F),g._setShapeModelPoints(new mo(X)),g._lastShapeModel=x,Q=!0}J=g.shapeModel.vs.length,$=J/3}else{var j=l.getPoints();if($=J=j.length,Q||l._pointsDirty||!g.shapeModel){for(var i=[],w=0;$>w;w++){var E=j[w];E&&i.push(E.x,E.e,E.y)}g._setShapeModelPoints(new mo(i)),l._pointsDirty=!1,g._lastShapeModel=null,Q=!0}}if(g.info={mat:tp(l),size:U,diffuse:v,opacity:A("points.opacity"),texture:e,alphaTest:A("points.transparent")?0:A("alphaTest"),uvScale:A("points.uv.scale"),uvOffset:G,discardSelectable:A("points.discard.selectable")},Q||l._colorsDirty){var m=!1,n=l.getColors();if(n&&n.length>0)for(var V=[],w=0;$>w;w++)for(var k=n[w],I=k?(m=!0,Bp(k)):v,f=4*w,t=0;4>t;t++)V[f+t]=I[t];g.shapeModel.cs=m?new mo(V):null,l._colorsDirty=!1}if(Q||l._sizesDirty){var T=!1,p=l.getSizes();if(p&&p.length>0)for(var H,y=[],w=0;$>w;w++)H=p[w],H>=0?(y.push(H),T=!0):y.push(U);g.shapeModel.ss=T?new mo(y):null,l._sizesDirty=!1}if(Q||l._offsetsDirty){var b=!1,r=l.getUvoffsets();if(r&&r.length>0)for(var q,C,B,Z=[],w=0;$>w;w++)q=2*w,C=r[q],B=r[q+1],C!=W&&B!=W?(Z.push(C,B),b=!0):Z.push(G[0],G[1]);g.shapeModel.os=b?new mo(Z):null,l._offsetsDirty=!1}if(Q||g._lastPointNumber!==$){this.dispose();var Y=N.pickColorMap,d=g._startPickId=Y._pickIdUsed;Y._pickIdUsed=d+$;for(var i=[],w=0;$>w;w++){var K=d+w,o=Us(K);i.push(o[0],o[1],o[2],o[3]),Y[K]||(Y[K]={data:l,part:w})}g.shapeModel.ps=new mo(i),g._lastPointNumber=$}l._modelDirty=!1,this.dispatchBoundingBoxChanged()},_setShapeModelPoints:function(L){var Z=this,s=Z.shapeModel,P=Z.shapeModel={vs:L};if(!s)return P;var W=L.length,j=Math.round(W/3);return s.cs&&s.cs.length==4*j&&(P.cs=s.cs),s.ss&&s.ss.length==j&&(P.ss=s.ss),s.os&&s.os.length==2*j&&(P.os=s.os),s.ps&&s.ps.length==4*j&&(P.ps=s.ps),P},_createCachedImage:function(e){var l=128,E=Zj(),v=E.getContext("2d");Vj(E,l,l,1),hl(v,{width:l,height:l,comps:[{type:e,background:"white",borderWidth:0,rect:[0,0,l,l]}]},0,0,l,l);var b=n.Math.generateUUID();return pp[b]=E,b},_80o:function(i,N){var h=this,v=h.gv,W=v._picking;if(!W||v.isSelectable(h.data)){var j=h.shapeModel,F=h.info;if(j&&j.vs&&j.vs.length){var p=el.for(i);p.useProgram(h._asureProgram(i));var O=p.directUniforms(),C=p.directAttribs();O.modelMatrix=F.mat,O.modelViewMatrix=Jc([],v._viewMatrix,F.mat),O.projectionMatrix=v._projectMatrix,O.viewMatrix=v._viewMatrix,O.scale=v.getHeight()/2,O.size=F.size,O.diffuse=F.diffuse,O.opacity=F.opacity,O.map=v.getTexture(F.texture,h.data),O.alphaTest=F.alphaTest,O.resolution=v.getDevicePixelRatio(),O.discardSelectable=F.discardSelectable,O.uvScale=F.uvScale,C.uvOffset=!W&&j.os?Lo(i,v._buffer.os,j.os,S):F.uvOffset,O.blackout=i._blooming&&!h.data.s("bloom"),C.position=Lo(i,v._buffer.vs,j.vs,S),W?(O.picking=!0,C.pickColor=Lo(i,v._buffer.ps,j.ps,S),O.useColor=!1,C.color=null):(O.picking=!1,C.pickColor=null,j.cs?(O.useColor=!0,C.color=Lo(i,v._buffer.cs,j.cs,S)):(O.useColor=!1,C.color=null)),j.ss?(O.useSizeArray=!0,C.sizeArray=Lo(i,v._buffer.ss,j.ss,S)):(O.useSizeArray=!1,C.sizeArray=null),Oe(i,0,j.vs.length/3,i.POINTS),p.useProgram(N),C.disable(),v.shadowMap.enable&&v.shadowMap.createShadow(),v.flowMap.createFlow(O)}}},_asureProgram:function(m){return m._pointsShader||(m._pointsShader=this.gv._postProcessing.createShader(m,nt.shaderSrc)),m._pointsShader.program},dispose:function(){nt.superClass.dispose.call(this);var V=this._startPickId,v=this._lastPointNumber;if(V&&v){for(var A=this.gv.pickColorMap,N=0;v>N;N++){var t=V+N;A[t]&&delete A[t]}delete this._startPickId,delete this._lastPointNumber}}}),nt.shaderSrc="!!~v!oj<g*p!s{n/!onpbjuu5j!tnppQewfnm!N.b!u0s!jfym<bd!tv!o)j!g>p+s!nf!{njbTuu5o!jnppQe`fmmhW!j*f!xfNwbjuusdjfyq<ts!fvQotjjg!p)s!ng!jn!bu<5*!!q1s/p2k!f.d!u>j>p!o^N!b4u!s]j^y!<3!!]vyojjsgupbsNno!pnjbuud5f!kwpjsfqx!N)b!u>s!jfyw<ju!dvfoqjtgspfsQnt!jg!mmppbpuc!!tdbm~f!<<o!pbjuuuvsmjpctvfusf!!+w!ffd{4j!tq!p>t!jfu{jjpTou<ojp!Qv`omjhg!ps|n!!fctpmpfm!!~v!tf<Doppmjpusv<mp!tbfusu!s+j!czvbusfs!Bwff{dj5t!!d>p!mfp{sj<Tu!owjbpsQz`jmohh!!w|f!d*5z!bwsDspBmfp{sj<Tft!vb)u!ugsjj!cv<uofp!jwufjdt3p!QvwwnP!g+g!tyfjus<ub!Nwobpsjzujdofhk!pwsfqd!3>!!woPpgjgutjftup<Q`m!hv!oj<goppsjnu!jctpppQmw!nq!j+d!lyjjoshu<bN!xbfujuWsmjfcevpunf!!>w!fodp5j!uqjjtdplQDwpnm!ps<<*!1!/v2o!j-gepfsnns!pggmtpobbus!ut!j){5fd<fw!!v>o!jogppjsunj!tgpmQpwbnu!!5sdfftwp!mv<u*j!poop<ju!jvtopjqg!p)s4nd!fcwp!p>m!!evftnfsTpjg{tfoBbsssub!z4<df!wb!uu<s*jucfvtugfg!Pgwmvp)b3ud!ftwj!{>f!Busfstbgzg<Pw!!c~p!pm<!sjptmQpfds!t>q!fsdpumjpwDfwN!bu|s!j*ys)p!mnpbDuf5t!vn)!!*g!j|!f!tsmffu!vs~o!!n<]s!p3m!p^D]l!d4j!q^!!>>!>s!p.m!p2D/w1!<|!!~*ho!jwlpdjjeq!)n!bgjjo!)*|!^#!!~qs~f!dj<tsjppmop!Difjthvigqg!jgem!p>b!us<pm!p$DehfbgsjGo`fm!hV!TF|`!NfBtQmf!!v~o!jg<psspnm!pwDfwd!5>!!esjpgmgpvDthfb<sG!`vmohj!gp<sens!bgdmtpjbeu!!*p1q/b1d!j>u>z!<b/!svpomjpgDpfstnv!gggmjpeb)u!!gbjm!qi|b!U*fhtouj<ldj!qv)o!jggjp!sn<!ecspbpdmt!jvet!f*DuptmfpUsb<iq!mwbb!s=z!jbo/hs!pwmfpdD5f!twvDgpgmjpes)<!gj!!vogjjgeposfn$!!cp~p!m!<q*jwdvl!j-oqhb<n!!)vEo3jfgspvsuny!fcup!p>m+!!esjptmdpbDsfetTvfgmgfjdeu!bc<muff<tgg!Pvwo!j>g,p!swnv!!cp<pfmm!bcdmTbwdvl!p+v!ue<spp!DvuoojjgppQs`nm!hw!f>d!3w!vv!w3Tddfbwm!f<|!!*wfbmsczbjuodhf!mwffTde3s!bwdPtgjgetaf!u}<}!h$ojjgl!dejfqgaj)o!fgej)!!V*T!FQ`BNNB`QF!T*V!!)veofjogjpgsfne!!tgbjn$q!mf~s!3E<!*n!bzqu<jd$bfqope!j+g!b/wfptjveg!gnjbej!o-){*z!y|/f!tjvgg!g)jcem!b)d5ldpfvwu!*>!!|s!phmmp`DGfstbvhgDgpjmep!s!|>!!fwtfmdf5!)~1!/1<-*!!1z/u1j-d!b1q/p1!-+!!2b//1s*p<m!psDfwu!v-s{oz<y!/~spm!pwDfwd!5)!5edjfgwg!v>t!fsDppmmppDsf<tv!gjggj!e)!aq|j!d*lsjpomhp!D%f%t!v";var qt=function(k,l){fb(qt,this,[k,l]),this._needRecoverPosition=!0};Dh(qt,it,{_25Q:1,validate:function(W){var o=this,t=o.data,X=o.s,w=t.getPoints(),j=w.size();o.dispatchBoundingBoxChanged();var s=t.p3(),m=o.mat=Pb();Je(m,s),fs(m,t.getFinalRotation3d(),t.getRotationMode());var R=t.getScale3d(),q=t._dynamicScale3d;if(q&&(R[0]*=q[0],R[1]*=q[1],R[2]*=q[2]),Hr(m,R),Je(m,Sn(s)),(!o.s("geometry.cache")||!o.shapeModel)&&(o.shapeModel=o.info=o.lineShapeModel=S,j>1)){var B=o.info={},T=t.getSegments(),Q=t.getThickness(),Z=Ol(w.get(0)),$=Ol(w.get(j-1)),v=j%2,E=(j-v)/2;if(B.c1=Ol(w.get(E-1)),B.c2=Ol(w.get(E)),0!==v&&(B.p3=B.c2),B.s1=Z,B.s2=Ol(w.get(1)),B.t1=Ol(w.get(j-2)),B.t2=$,X(Cd)===gs){if(H.extractPolylineTranslation||H.extractVerticesTranslation){var s=new Po.Vector3(t.p3());w=Dl(w),w.forEach(function(p){p.x-=s.x,p.e-=s.y,p.y-=s.z}),o._vsTranslation=(new Po.Matrix4).setPosition(s),o._matWithExtraction=(new Po.Matrix4).fromArray(m).multiply(o._vsTranslation).toArray()}else o._vsTranslation=null,o._matWithExtraction=null;B.list=o.createTubeModel(w,T,Q/2,W)}else B.list=o.createLineModel(w,T,Q,"shape.border","shape.dash")}},invalidateCachedGeometry:function(){this.shapeModel=this.info=this.lineShapeModel=S},_80o:function(V,j,K){var X=this,l=X.shapeModel;if(l){var J=X.mat;(H.extractPolylineTranslation||H.extractVerticesTranslation)&&X._matWithExtraction&&(J=X._matWithExtraction);var L=X.gv;Ac(L,J);var z,N=X.s("3d.clip.direction");if(L._uvClipEnabled&&("uv.left"===N||"uv.right"===N)&&(z=X.s("3d.clip.percentage"))<1){var u=!0,c=!0;Sm(l);var M=l.top_vs,w=l.bottom_vs,U=l.vs,m=el.for(V),s=m.directUniforms(),R=m.directAttribs();"uv.left"==N?(1>z&&(u=!1),0>=z&&(c=!1)):(1>z&&(c=!1),0>=z&&(u=!1)),l.top_vs=l.bottom_vs=W,R.aUv=Lo(V,L._buffer.uv,l.uv,S,2),Wc(L,X.data,l,X,X.getBodyColor(),K),R.aUv=!1,s.uClipDirection=0,l.vs=W,u&&(l.top_vs=M),c&&(l.bottom_vs=w),Wc(L,X.data,l,X,X.getBodyColor(),K),l.vs=U,l.top_vs=M,l.bottom_vs=w}else Wc(L,X.data,l,X,X.getBodyColor(),K);fn(L)}}});var rt=n.graph3d.PostProcessing=function(c){var B,F,V,I,w=this,U={},P=!1,u=!1;!function(){o.keys(rt).forEach(function(H){U[H]=new rt[H](c)})}(),w.getModule=function(s){return s?U[s]:w},w.getModuleList=function(){return o.keys(U)},w._serializable=!0,w.handleDataModleChange=function(T,q){T&&(w._serializable&&T.setPostProcessingData(w.serialize()),T.removeSerializeListener(w.onDataModelSerialize,w)),q&&(q.addSerializeListener(w.onDataModelSerialize,w),w.deserialize(q))},w.onDataModelSerialize=function(p){"serialize"===p.type?w._serializable&&(c.dm()._postProcessingData=w.serialize()):"deserialize"===p.type&&w.deserialize(c.dm())},w.isDeserializeDisabled=function(F){return!w._serializable||F.a("sceneBloom")!==W},w.isSerializable=function(){return w._serializable},w.setSerializable=function(l){w._serializable=l,l||c.dm().setPostProcessingData(W)},w.serialize=function(){var a,G,O,X,w={};for(G in U)if(O=U[G],X=O.serializeProperties){a={},O.enable&&(a.enable=!0);for(var Z in X){var N=O[Z];N!=X[Z]&&(a[Z]=N)}o.keys(a).length&&(w[G.toLowerCase()]=a)}return w},w.deserialize=function(I){var p,L,d,G,S,r={},D={};for(p in U){d=U[p],G=d.serializeProperties;var $={},O="scene"+p,h=I.a(O);h!==W&&($.enable=h);for(var S in G)h=I.a(O+S[0].toUpperCase()+S.slice(1)),h!==W&&h!==G[S]&&($[S]=h);to($)||(D[p[0].toLowerCase()+p.slice(1)]=$)}if(to(D)&&(D=I.getPostProcessingData()),D)for(L in D)if(L&&(p=L[0].toUpperCase()+L.slice(1),d=U[p])){r[p]=!0,G=D[L];var B=!!G.enable;w.enableModule(p,B),p="scene"+p,I.a(p,B),d.resetProperties&&d.resetProperties();for(S in G)if("enable"!==S){var h=G[S];d[S]=h,I.a(p+S[0].toUpperCase()+S.slice(1),h)}}for(p in U)r[p]||(d=U[p],d.enable=!1,d.resetProperties&&d.resetProperties())},w.getRenderTarget=function(){return B},w.blitScreen=function(v,T,o,Z,M){var z=c.getGL();if(z&&(u||r())){v&&(v.bind(z),c.setViewport(z,0,0,v.width,v.height)),M&&M.clear===!1||z.clear(z.COLOR_BUFFER_BIT|z.DEPTH_BUFFER_BIT),o||(o=F),o.bind(),z.activeTexture(z.TEXTURE0+0),fd(z,T||z._emptyTexture);var p=o.uniforms;p.image=0;var e=1;if(Z)for(var h in Z){var t=Z[h];t instanceof WebGLTexture&&(z.activeTexture(z.TEXTURE0+e),fd(z,t),t=e,e++),p[h]=t}if(V.upload(),I.upload(),o.attributes.pos.pointer(I),z.drawElements(z.TRIANGLES,6,z.UNSIGNED_SHORT,0),e>1)for(;--e>=0;)z.activeTexture(z.TEXTURE0+e),fd(z,null);else fd(z,null);v&&v.unbind(z)}},w.decodeShader=function(K){var j,B,W,X="",r="";for(W=0;W<K.length;W++)j=K[W],"%"===j?j="'":"a"===j?j='"':"]"===j&&(j="\\"),B=String.fromCharCode(j.charCodeAt(0)-1),W%2?r+=B:X=B+X;return r+X},w.createShader=function(V,O,u){var q,t;if("string"==typeof O){var r=O.indexOf("^#");q=w.decodeShader(O.substr(0,r)),t=w.decodeShader(O.substr(r+2))}else q=O.vs,t=O.fs;if(u){var p=u(q,t);p&&p.vs&&(q=p.vs),p&&p.fs&&(t=p.fs)}return new co.Shader(V,q,t)},w.enableModule=function(S,Z){var A,J,Y,z=S.split(",");for(A=0,J=z.length;J>A;A++)Y=z[A].trim(),U[Y]&&(U[Y].enable=Z);P=!1;for(Y in U)if(U[Y].enable){P=!0;break}};var r=function(){if(u)return!1;var w=c.getGL();return w?(B=new ko.RenderTarget(c,w,null,null,{samples:D.renderTextureSamples||1,minFilter:w.LINEAR,magFilter:w.LINEAR}),F=new co.Shader(w,N.vs,N.fs),V=co.Buffer.createIndexBuffer(w,new Uint16Array([0,2,1,1,2,3])),I=co.Buffer.createVertexBuffer(w,new Float32Array([0,0,1,0,0,1,1,1])),u=!0):!1},N=w.blitScreenShaderSrc={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};w.contextLost=function(){u=!1;for(var e in U)U[e].contextLost&&U[e].contextLost()},w.render=function(k,O,I,o){if(P&&(u||r())){B.setSize(k,O,I),B.bind(k);var e=k.getParameter(k.COLOR_CLEAR_VALUE);e&&0===e[0]&&0===e[1]&&0===e[2]&&0===e[3]?e=null:uq(k,[0,0,0,0]),k.clear(k.COLOR_BUFFER_BIT|k.DEPTH_BUFFER_BIT),c.setViewport(k,0,0,O,I),o=o||{};var H=o.renderAxis!==!1,s=o.renderEdit!==!1;o.renderAxis=o.renderEdit=!1,c.renderScene(o),B.unbind(k);for(var A=0,z=c._glCapabilities.maxAttributes;z>A;A++)k.disableVertexAttribArray(A);var l,X=B;for(l in U)X=U[l]._42(k,X)||X;c.setViewport(k,0,0,O,I),e&&uq(k,e);var V=w.getModule("Fxaa");return V&&V.enable?w.blitScreen(null,X.texture,V.getShader(k),{resolution:[1/O,1/I]}):w.blitScreen(null,X.texture),k.useProgram(c._prg),c._renderAxisAndEditHelper(H,s),!0}}},st=n.graph3d.PostProcessing.HueSaturation=function(i){function n(){var z=i.getGL();return z?(V=new ko.RenderTarget(i,z),F=i._postProcessing.createShader(z,st.hueSaturationShader),D=co.Buffer.createIndexBuffer(z,new Uint16Array([0,2,1,1,2,3])),M=co.Buffer.createVertexBuffer(z,new Float32Array([0,0,1,0,0,1,1,1])),A=!0):!1}var D,M,F,V,m=this,u=!1,A=!1,s=[],E=[],t=[];this.serializeProperties={hue:[0,0,0,0,0,0,0],saturation:[0,0,0,0,0,0,0],lightness:[0,0,0,0,0,0,0]},this.resetProperties=function(){var s=this.serializeProperties;for(var M in s)this[M]=s[M]},this.resetProperties(),o.defineProperties(m,{enable:{get:function(){return u},set:function(d){!!u!=!!d&&(u=d,i.iv())}},hue:{get:function(){return s.map(function(h){return j(180*h)})},set:function(y){if(s!==y&&7===y.length){for(var R=0;7>R;R++)s[R]=y[R]/180;i.iv()}}},saturation:{get:function(){return E.map(function(Y){return j(100*Y)})},set:function(Q){if(E!==Q&&7===Q.length){for(var j=0;7>j;j++)E[j]=Q[j]/100;i.iv()}}},lightness:{get:function(){return t.map(function(i){return j(100*i)})},set:function(j){if(t!==j&&7===j.length){for(var s=0;7>s;s++)t[s]=j[s]/100;i.iv()}}}}),m.contextLost=function(){A=!1},m._42=function(l,Z){if(u&&(A||n())){var U=Z.width,R=Z.height;if(U&&R){V.setSize(l,U,R),Mn(l,V.frame),i.setViewport(l,0,0,V.width,V.height),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),F.bind(),l.activeTexture(l.TEXTURE0+0),fd(l,Z.texture);var d=F.uniforms;return d.image=0,d.hue=s,d.saturation=E,d.lightness=t,D.upload(),M.upload(),F.attributes.pos.pointer(M),l.drawElements(l.TRIANGLES,6,l.UNSIGNED_SHORT,0),fd(l,null),Uq(l),V}}}};st.hueSaturationShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<j*txj/psop!mipjdh!i-q*!mgtmip)bcuh<s3!mvtoij)g5pdsfnw!!t>b!nsqpmmfpsD3hEb!sjGn`bmhhf!<<!*w!bs*zfjhoohb!Swtftdf3o!uwiVhwj<m!-!^$1e]ftgtjfoofu!iNhBjYm`!S-B{O/HmFt!i8)t!t$feofugijhojfm!`SqBbOnH!F`-B*MfMh!o1bSo!pvjoujbgspvsunb!tg!m-p^b1u]!oipvjfu]bNsBvYu`bStB!O-HzF/^m<ti!)voopjjgupbssnv!ugbmtp`bqub!nt!bu-v*sfbhuojbpSof]vNiB!Y-`^S1B]OfHvFi^!<-y!/vmotjig)pfsvni!`gqmbpnb!u!)m4jdhfiwu!o>f!tmtt]iN!BY`~S!BO~H!F^<<lbf!sgcm!pb<u^!snfbuqo`vipvdf`)fgvmip]btut!fjoouWibhmjvmf!->!!gfmhpobbuS!titvffoBumimh-j!mg!mp<b^us!fiuvofvSpbdo`hffv*i!]|op!jgumbpsbvuu!bwtb!m>v!ff!h>o!bjSooWpbjmuvbfs!v,u!b)ti!vf<B^msmf!u,o!vipvdf`Sfbvoih]ff*v!i0!!>3!/f1h<obS!fjvgi!!)w|b!m*vffh!o=b!s1!/>1>*!!ssffuuovvspod!`wfbvmiv)f!!g,j!!2/|1!<*,!,fsmftufo!vjpgd!`)fwvbim!v<fF!H?O!B2S/`1Y*B!Ns!f=u!vssfou!owvbpmdv`ff!v.i!!2</11!<>!!sffmutofv!psdf`ufvvsio!!uwobjm)v!fs<pg!!~<!2g!m,p!bfuh!onbbsq!`>t!bfuhvosbbsu!jp<o1)!g>m!pfbhuo!bjso!W*b7m!v>f?-!!fghmopbbsu)!!tgbju!vs~b!uj~p!oB<mlmb-f!sgcm!pb<us!ftubouvvpsdb`ufjvpio!S>b!ofhhfo*b!s|!!|g!m*p6b/u1!!w,b!m*vsff!u>o!vjpodW`bfmvvif)!u+b!p)m2g/!1=!!,i!)t!bgujv!sb|u!j*p,o,Bsmfmu!o,v!ptdb`ufvvsib!u<jFpHoOSBbSo`hYfB*N<!=!!ssffuuvosvop!dd`mfbvniq!)<w1b!m>v!fs-f!u1o/v1p-d!`2f/v1i*!<uo!j~)!!sgpmgp!bu!<nfbhqo`bmSjthtifuooufithtj)mg!m-pfbhuo!bjSooWpbjmuvbfs-v!ugbmtp!b-uf!hmojbhSifuvoif!tutbBpmmmg-!!g<m1p!b>u!!fmhjohbisu!oufotjt!Sb<oehmfp*i!t|fs!igum`pfbvui!!wu!b>p!mmgj!hi<u1o/f7t!t+B!mym/!m,t!im!j>h!iiu!oufbtptmSgb!oh<f*<{z!yj/gs!p)mwp!d=)!m1t/i13*ch!ss!f>u!vmstoi!!j4odWfbwm!vf<!*+w!V)ww!!-,f!h2b/n1j*)<E3!ffsmvtufyf!us!f>u!vsspom!pjdo!W5bdmfvwf!!,|!!)*w)!o+j!b)n2!/e1j!p.w!!joW~b!mv<f**m*!<-t!!~-i!)g4mdpfbwu!!oisvvfu3fssh!c)~g!mp<b1u/!7g!20-!!ig!m>p!biu!!g~3!-!<g1m/p7b!u>!,i!vif!*!||!*!1j/g1!!)=i!vif)!!=g!j1!/1*~!!i<vbfu!m,f>E!d2!/01!<*h!!f.m!tsf)!!j,g!!1)/i5v!f>!!?i!!2/|1!*ft!mifv!f~!!.><!b2u/m1f<Ed!!g0m!p*bsu!!.s!fct)<!,!!j1g/!3)!)>7!/i1!!+|!!i*vyfb*N!d=!!>2>/!1h*)!!gsjf!tf!t>m!fg!2~!!,!<)bgu3m!f.E!dg!20*!!*+c!!7./!1h!)+!!>i!vif!<|!!f*mytbfN!dj!g>!>)!)s3)/!1g!j+!!iv<f***!o=j!N2d/!1,*!y!bsNfdt)!!>.!!g13/<3)!!f0m!tbfu!mjfgE!d)!);4!/*1o!j+N!di!v,f!*y!b=N!d3)/!10*!b!usmfftE!d>!!@g!26!/,1!!)=g!3m!!.>!!gt2!*!+<!o)j)N3d/!1.!!0y!b4N/d1!*>!!.b!uimvffE*d!!+u!b7p/m1g<!!|f!m*tofjN!ds!f?t!!y>b!Ngd2)<!g!js!fuv<s1o/!3s!f0t!<*o!j~Nd!!,w!fydb4N!di)t!m>3!smh!c)w<f*d*4c!!i-thm)*y!b|n!!-wsf)dy4b!ns!h>c!<ybN!dj!gu!b)pimtgm!/z<!*>*>c!!1-/h1)*o!j|n!!-ssh)co!j>n!!w>f!do4j)Nidt!mu/b{p*m<g!!~<!cf/mdt!f>!!|c!!ugbmppmbgu!!g<3h</d!!>j!gh!!)uibtpmm/g{!!=<!s1//d6!*>!!sg!3u!b>p!migt!m/<{1!/+1!!)>2!/m1!!u,b!pimtgm!/z<*1</1!!f>m!ttf!u!bgp3m!g>!!i<t1m//2{.!!,>!!iit!mu/bzp!m.g!!it|m!/*zd!!+4!diftwm)/m{t<i3c!hgsm!p4bduf!wg!2!>~!!3/<1c!h+s!!iotsmv/u{f!s.!!g~3!<<*!*s1h/c4/0s1!/>2!)i!v.f!3ys/hmct)ig!2--3!gg!3--2!gi)tcmh/sy3!f,v!i)!2>/!1c0/4c/h1s*!*<<*!ys/hmct/ih!!->3!gi!v-f23gs)hc";var tt=n.graph3d.PostProcessing.Bloom=function(z){function V(){var i=z.getGL();if(i)for(var D=z._postProcessing,q=0;L>q;q++)b[q]=D.createShader(i,tt._35Q,function(R,k){return{fs:k.replace(/DEFINE_VALUE/g,F[q]).replace("%OVERRIDE_ALPHA_DEFINE%",B?"#define OVERRIDE_ALPHA":"")}})}function k(){var F=z.getWidth(),A=z.getHeight();if(!F||!A)return!1;var m=z.getGL();if(!m)return!1;D=[F,A];var Z,S=Math.round(D[0]/2),R=Math.round(D[1]/2);for(n=new ko.RenderTarget(z,m,S,R),x=[],i=[],Z=0;L>Z;Z++)x.push(new ko.RenderTarget(z,m,S,R)),i.push(new ko.RenderTarget(z,m,S,R)),S=Math.round(S/2),R=Math.round(R/2);var K=z._postProcessing;return U=K.createShader(m,tt._34Q),V(),P=K.createShader(m,tt._36Q,function(U,y){return{fs:y.replace(/NUM_MIPS/g,L)}
}),T=K.createShader(m,tt.finalShader),$=co.Buffer.createIndexBuffer(m,new Uint16Array([0,2,1,1,2,3])),s=co.Buffer.createVertexBuffer(m,new Float32Array([0,0,1,0,0,1,1,1])),g=!0}var G,Z,W,B,r,$,s,I,Q=this,t=!1,g=!1;this.serializeProperties={strength:1.5,threshold:.55,radius:.4,overrideAlpha:!0,selective:!1},this.resetProperties=function(){var H=this.serializeProperties;for(var $ in H)this[$]=H[$]},o.defineProperties(Q,{enable:{get:function(){return t},set:function(l){!!t!=!!l&&(t=l,z.iv())}},strength:{get:function(){return G},set:function(M){G!==M&&(G=M,z.iv())}},threshold:{get:function(){return Z},set:function(U){Z!==U&&(Z=U,z.iv())}},radius:{get:function(){return W},set:function(S){W!==S&&(W=S,z.iv())}},overrideAlpha:{get:function(){return B},set:function(X){!!B!=!!X&&(B=X,g&&V(),z.iv())}},selective:{get:function(){return r},set:function(D){!!r!=!!D&&(r=!!D,z.iv())}}}),this.resetProperties();var n,U,P,T,D=[256,256],x=[],i=[],L=5,F=[3,5,7,9,11],b=[];Q.contextLost=function(){g=!1,I=null},Q._42=function(A,N){function v(H,V,_,Y){Mn(A,V.frame),z.setViewport(A,0,0,V.width,V.height),Y?Y(A):A.clear(A.COLOR_BUFFER_BIT|A.DEPTH_BUFFER_BIT),e!==H&&H.bind();var h=0;for(var d in _){var c=_[d];c instanceof WebGLTexture&&(A.activeTexture(A.TEXTURE0+h),fd(A,c),c=h,h++),H.uniforms[d]=c}for(e!==H&&($.upload(),s.upload(),H.attributes.pos.pointer(s),e=H),A.drawElements(A.TRIANGLES,6,A.UNSIGNED_SHORT,0);h--;)A.activeTexture(A.TEXTURE0+h),fd(A,null);Uq(A)}if(t&&(g||k())){var e;if(r){I||(I=new ko.RenderTarget(z,A)),I.setSize(A,N.width,N.height),I.bind(A);var B=A.getParameter(A.COLOR_CLEAR_VALUE);B&&0===B[0]&&0===B[1]&&0===B[2]&&1===B[3]?B=null:uq(A,[0,0,0,1]),A.clear(A.COLOR_BUFFER_BIT|A.DEPTH_BUFFER_BIT),z.setViewport(A,0,0,N.width,N.height),A._blooming=!0,z.syncRenderState(),z.renderScene({renderAxis:!1,renderGrid:!1,renderEdit:!1}),A._blooming=!1,B&&uq(A,B),I.unbind(A)}v(U,n,{smoothWidth:.01,luminosityThreshold:Z,tDiffuse:r?I.texture:N.texture});var q,y=n,p=Math.round(D[0]/2),H=Math.round(D[1]/2);for(q=0;L>q;q++)v(b[q],x[q],{colorTexture:y.texture,direction:[1,0],texSize:[p,H]}),v(b[q],i[q],{colorTexture:x[q].texture,direction:[0,1],texSize:[p,H]}),p=Math.round(p/2),H=Math.round(H/2),y=i[q];return v(P,x[0],{blurTexture1:i[0].texture,blurTexture2:i[1].texture,blurTexture3:i[2].texture,blurTexture4:i[3].texture,blurTexture5:i[4].texture,bloomStrength:G,bloomRadius:W,bloomTintColor:[1,1,1]}),v(T,N,{image:x[0].texture},function(h){el.for(h).glState.blend.apply({enabled:!0,equation:h.FUNC_ADD,func:[h.SRC_ALPHA,h.ONE]})}),el.for(A).glState.blend.apply({equation:A.FUNC_ADD,func:[A.SRC_ALPHA,A.ONE_MINUS_SRC_ALPHA,A.ONE,A.ONE_MINUS_SRC_ALPHA]}),N}}};tt._34Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522",tt._35Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qsgfjdejotfj$po<!*ibj/hyijqQ!fgsmvpubyuf<u!w-bnsvzTjuoihh!jwffxd03n!vwTVfwt<vgvgojjeg)p5sdnf!wt!b>n!qsmpfmsp3DEh!bdspGm`pmshUffytumvfs$f<<*v1o/j2g!p-snnv!Twufidh3j!fuxf0ynTvjT{fft<vgvgojjeg)p5sdnf!ww!f>d!3s!pemjpsDfhdbusjGp`om<h$BeIfQgMjBo`fF!ELJFSSSOFFWMP`!SgBfEeJgVjT$!E~FG<JxO!F+`!W1B/M3V!F>,$!enfvgTjuoifh!jTfJxHN<Bx!!E+F!G*J3OfFm`qWnBbMtV!F,!&2PfWmFqSnSbJtE)F!`>B,M!QnIvBT`fEtFvGgJgOjFe&<gcmhpsb/u*!uhfbtvgtgtPjwbvo!Q.e!gw)Vjwo!!-gfmspvbuuy!fyU-s!pjmop!dg!m)pEb3uf!stvjuhynfbu*!!>|!3sffmuqvnsbot!!14/d4f:w9:<5c!h+s!/f*yuqf)t!g.g1P/w6v!!+,!!yw!V+w!!y-0f)s!vtujyhfnUbs!p+m!ptdj!h)nEb3*f*s0vtujyhfnub!<>!~2fwmpqjneb!tn!b4jdof)w*!<|y!w+f!df3{!jjTowwoTjj!{+f!!o>p!j2u/d1f!s0j!eu!f>y!Tujf{tfg<gPgwmvp!b3ud!fgwTj<h*nbbn!h>j!Tggm!p-byu))gTeJQHoNbBj*t<tvgbmhp!b>u!!xx!fujbhpimugTv<n*!j>)!uhbbpvmtgt!j>b!oyQ!eugb)p1m/g1-|!!g*T!j,h,n!bj*!<<TwVfJdE5B!Su`fMyFuOvSsFfLQ!j=y!!j>!!<u2f!y>u!vjs!fu3oEj)!!)dsppmgps<UnfvyTuuvishfj-f!xw!V+w!*c<hsw/fydj4Q!fesjvgugyvftuf!T>v!n",tt._36Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj",tt.finalShader="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";var ut=n.graph3d.PostProcessing.Dof=function(M){function l(){var r=M.getGL();return r?(j=new ko.RenderTarget(M,r),L=M._postProcessing.createShader(r,ut._38Q),x=co.Buffer.createIndexBuffer(r,new Uint16Array([0,2,1,1,2,3])),p=co.Buffer.createVertexBuffer(r,new Float32Array([0,0,1,0,0,1,1,1])),h=!0):!1}function O(s,x,R,V){J=null;var $=s.getCanvas(),v=$.width,j=$.height;if(R=R||1024,v>R||j>R){var F=R/Math.max(v,j);v=Math.round(v*F),j=Math.round(j*F),Z||(Z=Zj()),$=H.resizeImage($,v,j,Z)}var B=M.getGL();if(e||(e=B.createTexture()),d=ad(B,$,e),i=x||.01,X=!0,M.iv(),V--){if(J)return;J=H.callLater(function(){O(s,x,R,V)})}}var j,L,x,p,d,r,_,q,Z,e,J,v=this,C=!1,h=!1,i=0,X=!1,Y=Po.generateUUID();this.serializeProperties={aperture:.025,maxblur:1,image:null},this.resetProperties=function(){var M=this.serializeProperties;for(var C in M)this[C]=M[C]},o.defineProperties(v,{enable:{get:function(){return C},set:function(T){!!C!=!!T&&(C=T,T||(X=!1),M.iv())}},image:{get:function(){return r},set:function(f){r!==f&&(r=f,X=!1,d&&(M.deleteTexture(Y),d=null),M.iv())}},maxblur:{get:function(){return _},set:function(H){_!==H&&(_=H,M.iv())}},aperture:{get:function(){return q},set:function(L){q!==L&&(q=L,M.iv())}}}),this.resetProperties(),v.contextLost=function(){h=!1,d&&(M.deleteTexture(Y),d=null)},v.setImageFromGraphView=function(t,k,E){this.image=null,O(t,k,E,2)},v._42=function(f,E){function e(a,e,q,W){Mn(f,e.frame),M.setViewport(f,0,0,e.width,e.height),W?W(f):f.clear(f.COLOR_BUFFER_BIT|f.DEPTH_BUFFER_BIT),H!==a&&a.bind();var w=0;for(var B in q){var v=q[B];v instanceof WebGLTexture&&(f.activeTexture(f.TEXTURE0+w),fd(f,v),v=w,w++),a.uniforms[B]=v}for(H!==a&&(x.upload(),p.upload(),a.attributes.pos.pointer(p),H=a),f.drawElements(f.TRIANGLES,6,f.UNSIGNED_SHORT,0);w--;)f.activeTexture(f.TEXTURE0+w),fd(f,null);Uq(f)}if(C&&(h||l())){var H;if(!d){var P=Fr(this.image);if(!P||!P.comps&&!P.tagName)return E;n.Default.setImage(Y,P),d=M.getTexture(Y)}var v=E.width,V=E.height;if(v&&V)return j.setSize(f,v,V),e(L,j,{tColor:E.texture,tDepth:d,aspect:v/V,aperture:this.aperture,maxblur:this.maxblur,useG2d:X,threshold:i}),j}}};ut._38Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vcupypfmu!!v>t,f!Hm3ped<<v*o!j5gspvsmnc!ggpmep!b+u!!*u!iusdfftsisppmdeu<dfvqotjbg!p+s!n*!!g:m3p/b1u.!!n-b:y3c/m1v.s!<)3vdofjwg!p)s!n,!!gzmyp/bwuV!wb!q-fsspumvpsDfu<!)vEo3jfgspvsuny!fgum!p>b,u!!mopfdbs<D*m!j5qs<vmvcogjpgep!s+n!!*g!mupdbfus!sgpbdsuDdmfjqqt<b!v+o!j*g!p1s/n1!!g-m5p/b1u.!!g)p3ddvftw<!)v!o,j!gzpys/nw!Vgwm!p-bsup!mbptDquf!d)uE<3fdspvoutyuf!ug!m>p,b!um!pVdoq<b*d!l5Espvxmoctgdpbem!f+!!>*!!3u6d6f/s!s0p!d3u6d7f/q<t!b0!0+!!1*/!/:23!/.1?!!-g:s3b/d1u.j!p)o3!d)ffwy!d)m!v,e!jzoyh/!w2V*w!d-psoptmup!Dwuf!d)4E!3QfbsdvluGybfduu!p>s,t!!m>p!dwf<d*4!)5!s3v6m7c/g!p+e!!3+6!7*/!!u+d!f3s6s7p/d-u!d3f6q7t/b!!++!!3*6!75//-1!.3!6-71//!1*!<)3ddpfowt!u)!!w,f!dz5y!/VwoVqwb!d-lsGpbmdpuDpus!t)!E>3!fVsovqubydfluE!p>x,o!tmdpbdmf<!*0!!5wsfvdm5c)g!pQeb!d+l!G*b!duudpfssts-p!d2u/d!f*q<tbg!m+p!b*u!!:v3o/q1b.d!l-S:H3C/B1U!p)E3fdqfuwi!))!!d,p!oztyu/!wjVow!!w-fsdp5m!pwD!u*!!)|E3!fssfvuuvysfou!!e>p,u!)m!pwd-!<V*o!q5bsdvlmGcbgdpuep!s+t!!**!<ud~fsgsmppdbuud!fhqftubE!f+q!u*i!)1!/d1p!o-t5u/!1j!o)!3wdffdw3!!)t!d,s!fzfyo/QwpVtwj!u-jsppom!p*D!u|!)\nEs3ffusvvsuoy!fvuo!q>b,d!lmSpHdCB<U*p!E5fsqvumic)g!puef!y+u!v*s!fu3dEf)s!supEdfuqdufiq-t!bt!d+s!f*f!o:Q3p/t1j!u-j:p3o/!1*!!)*3<df~w!g)m!p,b!uz!yq/fwsVtwq!f-dsupjmwpfDEuf!q)uEi3UfpsWvjufyxf[u)!!>d,p!omtpud!j<o*!!g8mspvbmuc!gjpoew!D+m!j*q![u-d!fdspsoptduu!djfoq!tgbm!p+b!u*!!o5f/b1s!--!1d/p1o!t)u3!djfow!!g)m!p,b!uz!yg/bwsV!w*!!-|sp!mspfDuuv!s)oE!3)f!sovfubysf!u+!!>g,b!sm!p*d!0<!*)!!8)s!vgmbcsg!p.e!!o+f!b*s!!u*d!f+s!sjpodwuDdmfjqqt[b!!.+!!g*b!s:!3*/<1.~!-g:m3p/b1u.!!h)f3udWfjwf!x)[!),!!dzpyo/twuV!wj!o-!sgpmmppbDuu!!e)fEq3ufis!v*u!y|fu\n!s>f,u!vmspod!q<f*s!t8qsfvdmucjgwpfeE!f+q!u*i!UupdWfjsfsxp[d)u!deffqqtubi!-+!!o*f!b1s/D1m!j-q5-/!1g.b!s)D3mdjfqw!!*)<!,~!zwyp/jweV!wn!b-jsop)m*p!D|u!w)fEd33f!sevpugycfmuv!s><,!wmfpdd3!<b*t!q8fsdvumdcpgspsef!d+u!!*>!!uwdffds3s)p!d2u/d1f-q!tbbt!q+f!d*u!!:*3</1j!g-!:)3v/t1f.E!f)q3udif*w!!|)!!,g!mzpyb/uw!Vwwj!f-xs[p!m>p!Dhuf!u)WEj3ffxs[v)u!yhffuu!E>f,q!umip)d!w<V*w!!8*s!v*m<cg!pgem!p+b!u*!!gubddfuspssp!d>u!d)f!qgtpbd!v+t!!*,!!5w/j1f.x![-!1*/<1!!)e3pdgfcwm!v)s!!,>!!zwyf/dw3V!w)!!-dsmpbmnpqD)u!!g)bEd3ufpssv!u+y!fbuq!f>s,u!vmspfd-!<.*n!b8yscvmmvcsg-p!en!b+y!c*m!vusd!f*s!s*p<du~dffqmttbf!!+|!*w!f:d35/!1u.f!y-f:m3!/>1!!u)f3ydufvws!f)3!E,)!!zuyE/fwqVuwi!--!swpfmdp3D)uw!V)wE/3yf-s!v2u/y1f!u.!!>w,V!wm/pzd*!<**<!8gsmvpmbcug!pbem!q+i!b*<!ujdgf!s)svptdfuHd3feq*t!b|!+b!m*q!i1b/!1>!!-t1n5p/p1u!i)t3udffqw)!!)u!i,s!fztyi/pwmVew-!!-usipsmfptDiup!m)eE!3,f!s1v/u1y2f-u!!u>f,y!fmmp/db!<**<!8~s!vfmmctgfp!e|!!+b!m*q!iubd!f>s!supfdyufdmf/qbt<b!!~+!!*e!p:g3c/m1v!s-!:>3!/w1f!d)33!d)f!wd!m)b!n,q!)z!yb/mwqViwb!!-+s!pbmqpfDsuu!v)sEf3-f!s.vnubyyfcum!v>s,-!!mnpbdyc<m*v!s:!s*v!m*c<gp~e!w+f!d*3!!uedpfgscsmpvdsu:d!f>q!tebp!g+c!m*v!s8!4+/!11./!:-<62w/f1d!3)!3edpfgwc!m)v!s,8!!z>y!/ewpVgwc!m-vssp!m+p!D1u/!8)<E3wffsdv3u!yefpug!c>m,v!sm5p!d>!<e*p!g:csmvvmsc!g+p!e1!/+5!<*!wufddf5s!sdppdmu!d>f!qwtfbd!5+)!!*1!/612!/*1<.!d-p8m4!/,1>.!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!16/25/!1*!!-+8!4b/t1q!f)d3uddfpws!s)f!d,u!!z*y!/+w!Vewp!g-csmpvmsp!D*u<!)dEp3mf!s,v>u!yuffuy!u>v,s!fm3pEd)!<u*D!p:mspvsm-c!gwpVew!/+y!z*!!,u!d)f!swsfpdd3u)d!f1q/t2b6!-+!!1*/!4884!/*1!!+-!6b2t/q1f.d!u)d3pdsfswf!d)u!!,*!!z+y!/ewpVgwc!m-vssp!m*p<Dud!p)mE!3,f>s!vuufyyfuuv!s>f,3!Em)p!duD<p*m!p:ss-v!mwcVgwp/ey!z+!!,*!!)u!dwffsds3p)d!u1d/f3q:t-b!!1+/!3*:!!8*4!/+1!.b!t-q6f2d/u1d.p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!6+2!/b1t.q!f-d8u4d/p1s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b6t2q/f1d!u-d8p4s/s1f.d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfssfv3uEy)f!uu!D>p,m!pmsp-d!w<V*w!/:yszv!m,c!g)p!ew!f+d!3*)!!u1d/f4s8s-p!d.u1d/f2q6t!b*!!++!!*b!t8q4f/d1u!d-p6s2s/f1d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfssfv3uEy)f!uu!D>p,m!pmsp-d!w<V*w!/syvzm!c,g!p)e!!w+f!d*3!)u!d1f/s3s:p-d!u.d1f/q3t:b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfssfv3uEy)f!uu!D>p,m!pmsp-d!w<V*w!/syvzm!c,g!p)e!!w+f!d*3!)u!d.f1s/s2p6d-u!d.f1q/t4b8!!+*!!*+!!:b3t/q1f.d!u-d:p3s/s1f.d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfssfv3uEy)f!uu!D>p,m!pmsp-d!w<V*w!/syvzm!c,g!p)e!!w+f!d*3!)u!d1f/s1s-p!d.u1d/f5q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!s,v!m)c!gwpfed!3+)!!*.!1u/d2f6s-s!p1d/u4d8f!q*t!b+!!+b!t*q!f1d/u1d!p-s5s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!yszv!m,c!g)p!ew!f+d!3*)!!u.d1f/s3s:p-d!u1d/f3q:t!b*!!++!!*b!t6q2f/d1u!d-p8s4s/f1d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfs";var vt=n.graph3d.PostProcessing.Blur=function(h){function _(){var e=h.getGL();return e?(v=new ko.RenderTarget(h,e),z=h._postProcessing.createShader(e,vt.hBlurShader),j=h._postProcessing.createShader(e,vt.vBlurShader),B=!0):!1}var z,j,v,D,w,C,g,P,p,b=this,M=!1,B=!1;this.serializeProperties={value:0,downSample:!1,iterations:1,layer:"main"},this.resetProperties=function(){var X=this.serializeProperties;for(var n in X)this[n]=X[n]},o.defineProperties(b,{enable:{get:function(){return M},set:function(w){!!M!=!!w&&(M=w,w?h.addRenderLayerListener(F,this):h.removeRenderLayerListener(F,this),h.iv())}},downSample:{get:function(){return g},set:function(R){g!==R&&(g=R,h.iv)}},value:{get:function(){return C},set:function(O){C!==O&&(C=O,h.iv())}},iterations:{get:function(){return P},set:function(m){P!==m&&(P=m,h.iv())}},layer:{get:function(){return p},set:function(t){p!==t&&(p=t,h.iv())}}}),this.resetProperties();var F=function(H){if(M&&H.layer===p&&"post"===H.phase){var g=h.getGL();if(!h._picking&&!h.isReflecting(g)){var N=h._postProcessing.getRenderTarget();N.unbind(g);for(var Z=0,z=h._glCapabilities.maxAttributes;z>Z;Z++)g.disableVertexAttribArray(Z);b.drawImpl(g,N),N.bind(g),g.useProgram(h._prg)}}};b._42=function(){},b.contextLost=function(){B=!1,D=null},b.drawImpl=function(I,f,X,$,r){if(B||_()){var U,p;if(f?(U=f.width,p=f.height):(U=h._viewport[2],p=h._viewport[3]),U&&p){var b=h._postProcessing;"boolean"!=typeof $&&($=g),X==S&&(X=C),r==S&&(r=P),r=Math.max(1,Math.round(r));var e=el.for(I).glState.depth,d=e.enabled;if(e.enabled=!1,$){X/=2;var K=[U,p];U/=2,p/=2,D||(D=new ko.RenderTarget(h,I),w=b.createShader(I,vt.downSampleShader)),D.setSize(I,U,p),b.blitScreen(D,f.texture,w,{texelSize:[1/K[0],1/K[1]]}),f.setSize(I,U,p)}else D&&D.setSize(0,0);v.setSize(I,U,p);for(var n=[],o=0;r>o;o++)n.push(X),X=Math.max(1,Math.floor(X/2));for(var o=0;r>o;o++){var m=n[r-o-1],F=$&&0===o?D.texture:f.texture;b.blitScreen(v,F,z,{value:m/U}),$&&o===r-1&&f.setSize(I,K[0],K[1]),b.blitScreen(f,v.texture,j,{value:m/p})}return e.enabled=d,f}}}};vt.hBlurShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sz3/Ew!Vjwn!b-hffv<mb!ww!b+s!z1j/o5h!!,w!fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!zt/vwnV!w>!!-wffvdm5b)w!!1+/!11!/*4<!,!!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!!.<!655/313!2+/!1w!b+m!v*f!-*!!wzV/ww/Vzw!!*-!f*v!m+b!w1!/+1!612/<3!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!4</214!6+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*f!v+m!b1w/!1+:!219/<2!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!3</414!7+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!!*.!!z2//w1V!w+!!-wfbvm",vt.vBlurShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sf3vEm!bjwn!b+h!f1</5!!w,b!szz/jwoVhw!!w-fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!ftvvmnb!w>!!+w!f1d/54)!!,1!/z1/!w*V<w!-!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!-!<w6V5w3/3z2!/.1!!5+/!1*!!+*!!wfbvmmvbfw!!*+!!*1!/+3!!1,/!1z6/2w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w2/4z6!2./!14!/+1!!*+!!*w!bfmvvmfb!w*!!+*!!1+/!21!/,1!:z2/9w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w4/4z7!2./!13!/+1!!*+!!*w!bzm/vwfV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!-*!!wfVvwm/bzw!!.+!!21/",vt.downSampleShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<j1t/j5p!o0!!i*j*h*i1q/!2g!m-p1b/u1<)3!dvfowj!g+p!sfn{!jtTbmnfqymffus!3,E!!wjVnwb!h-ff<hb!nwjb)sEz3jfoshv!uwyffdu3!!w,V!w*<*1!/v2o.j!g-p1s/n1!)w3fddf3w!!u+f!yff{mjTTjm{ffy<fu!!,w!pwjVew!!n-bfjhob)n*j)!E|3f!shvmu`yGfsub!hD,p!m*p*s1!/>1!!)-u1f/y2u.v)s3fd3fEw)!j+n!bfh{fj-T!mwfVywf!u,!!,u!fwyVfwm!T-jf{hfb!n+j!)wEf3df3s)v2u/y1f-u!!1/,1!**";var wt=n.graph3d.PostProcessing.Glitch=function(M){function Q(){if(m&&Y){r=Date.now(),G=0,A=1e3*d(Y[0],Y[1]),N=[];for(var K=1,W=m.length;W>K;K+=2)N.push((K>1?N[N.length-1]:0)+A*m[K]/J)}}function F(){M.redraw()}function i(){var e=M.getGL();if(!e)return!1;O=new ko.RenderTarget(M,e),D=M._postProcessing.createShader(e,wt.Shader);for(var R=I*I,z=mp(I,I),i=z.getImageData(0,0,I,I),u=i.data,X=0;R>X;X++)u[3*X+0]=p(256),u[3*X+1]=p(256),u[3*X+2]=p(256),u[3*X+3]=p(256);return z.putImageData(i,0,0),U=ad(e,Qe),a=!0}var O,D,A,r,G,N,U,w,Y,m,H=this,t=!1,a=!1,d=Po.randomFloat,p=Po.randomInt,J=0,I=64;this.serializeProperties={onlyReflector:!1,period:[2,3],intensity:[3,.3,1,.1,0,.4]},this.resetProperties=function(){var l=this.serializeProperties;for(var H in l)this[H]=l[H]},o.defineProperties(H,{enable:{get:function(){return t},set:function(c){!!t!=!!c&&(t=c,c&&Q(),M.iv())}},onlyReflector:{get:function(){return w},set:function(l){!!w!=!!l&&(w=l,M.iv())}},period:{get:function(){return Y},set:function(T){Y=T,Q(),M.iv()}},intensity:{get:function(){return m},set:function(U){U||(U=[1,1]),m=U,J=0;for(var s=1,N=U.length;N>s;s+=2)J+=U[s];Q(),M.iv()}}}),this.resetProperties(),H.contextLost=function(){a=!1},H._42=function(Z,I){if(t&&(a||i())){var X=!!M.isReflecting(Z);if(X===!!w){var J=I.width,B=I.height;if(J&&B){var _=M._postProcessing,V=el.for(Z).glState.depth,j=V.enabled;V.enabled=!1,O.setSize(Z,J,B);var o,e=Date.now();e-r>N[G]&&(G++,G>=N.length&&Q()),o=m[2*G];var H={seed:Math.random(),byp:o?0:1,tDisp:U};return o&&(H.angle=d(-Math.PI,Math.PI),H.distortion_x=d(0,1),H.distortion_y=d(0,1),H.amount=Math.random()/30*o,H.seed_x=d(-1,1)*o,H.seed_y=d(-1,1)*o),_.blitScreen(O,I.texture,D,H),V.enabled=j,requestAnimationFrame(F),O}}}}};wt.Shader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd~j!tj<p*ow!Viwj!h-ifqh!bgnmjp)b!uE<3f!svvoujygfpus>ns!pjmopuD!hcbzsqG<`m!hv!oj|g!pfstnm!ft!bn~q!mf<sx3pEo!tj!n,bshpfm<pD!hvbosjGg`pmshn!!>t!bsnpqmmpfDsh3bEs!Gu`Emjht!q<<*3!/v1o+j*g*p/s1n6!+gemfpfbtu!!+b!ntpzv-oeuf<ft!!v+o!jtgyp)s3nd!fgwm)peboub!sb)o5hdmffw<+u!ovvopjngbp+s/n1!1g3m!p>b!ux!ptoftf!e5<df!wv!ojfgtpjspno!!gemepbb0u0!!tf<f*eb`/yb<hd!!v-ocj/gcpds!n-!hg/mbphbdu!!-tsf/fsed`)z5<df!wv!o>j!gsppsmnp!DghmbpsbGu`!mehj!tu<p*suufjtpgog`py!<.!!qv!o-jfghpbsnnj!)gEm3pfbsuv!ueyjftuu!p>s!ucjdp!o5`dzf<w!!v<o*jqg!p-sfnh!bgnmjp)bEu3!fdspvmu`ytf<u!>!!wbbhsdz!j5odhf!ww!fd<3*!uwfVtwg<gp!!,d!pqo!t-uf!hgbmnpjb)uE!3VfosqvbudylfEup!x>o!tsddb!m5fd!f>w!!36<6*/*!f0m!h3o6b7)/o<jt!!d-p*oftmuh!owbf)dt4p!dQ)b3ddlfGwb!d+u!pusotv!p>n!bw!f>d!4u)f!t3g6g7p/!!3+d!f3w6!7/s!f+e!b3i6t7!/u-g!j3i6t7!/C!H+S!!3n6p7s/g-!!f3t6b7c/0!0*!<<!*d/p6o0teuf!fwtf)d+5z!`Veofqfbtd+lmGbbndsuppos>t,!z>/!qV!oq<b*d/l6E0pexfofttd)b+myf`!e0f!fwtf+dm5b)n!sQpbod>l,Gyb/dqu!ps~t!-!~2!/!<**<y`!ogpmjpubsup!uvtojqeb!d,l!SyH/CqB)U!p.E!f/q2u!i>)!!yd/pqo!tu|!!jfot!mwff!d5~!!w!<*y!`|op!jsufsupvustoj!ee>pyu/)q!!w-|!*V/o1q?bzd`leGfbfdtu)pgsjt!!*|<!*!e~fft!+gtm`pmbpud!.szb`ooep)jwufsdp3u!tdjpe*?|y/!qs!f%u%v!sto`!mgpsdb,dzu`)otpjjou)seppuut)jdep=/yy/zq!)-gwjf!d3~)!23~/!:9<:z9`-o8p9j/u3s4p4u*t*j*e!!+>!!5z4/8q6!9/|6!5f6t4m*f<!!~~!<!*wzp`joep!jnubsjpou)t*j!e|!,!!jzg/)qc)z!q.=!2/*2!!|>!!zw/fqd!3!|q*!/>1!?wyV`we<ff!tg)mgpjb!u!|y!t*!e>f!fgtm+ptp`sm)phdm.`yG`sobphjDupsppsuet/jye!?0z!/1q/!6%*%<!t!`gmmppdb,uy!`zotp!j>u!sgpmuptpjse)=hzm/`qG)sgbjh!Dp<p*s*ee/fzf!t0+!e1f/f6t*+<q!!-gqmtpjbEuu!)o!pEs3nfbsmv!u>y!fvuo)qibudqlfSEHpCUB";var xt=n.graph3d.PostProcessing.Fxaa=function(m){var P,q=this,I=!1;o.defineProperties(q,{enable:{get:function(){return I},set:function(H){!!I!=!!H&&(I=H,m.iv())}}}),q.contextLost=function(){P=null},q.getShader=function(B){if(P)return P;var Z=m.getPostProcessingModule();return P=Z.createShader(B,{vs:Z.blitScreenShaderSrc.vs,fs:Z.decodeShader(xt.ShaderSourceFs)})},q._42=function(){}};xt.ShaderSourceFs="~!!q<sbf/d*jwtVjwp!o-!fihjbhnijq)!Eg3mfpsbvuu<yf!uv>obj/gsppsmnp!DthbbnsqGm`fmsh3!E!<j*n!bh*f1</1!)v5odjfgwp!sn-!1w/f1d!3!-s1f/t1p!mv-u1j/p1o!<-!4w4b9s1z/j1o!h!-w7f7d23/!1w!Vw-<68/!1$!ef-g*j1o/f1!)G5YdBfBw`!RV-B*M1J/U1Z)`5Qd1f!w2!/1-*!1$/e1f)g5jdoffw!!GY-BoBp`jRuVvBmMpJtUfZs`!Q2-!f2h/b6nj!!$e-ffghjbonfj!!GY-BfBh`bRnVjB!MJ-U*Z1`/Q13)!53d/f1w!!$-ewfVgwj!of)!sGfYeBbBi`TRmVfByMjJQUbZb`yQG4>!s5p/m1pD!h$besfGg`jmohf!!G|Y!B*B)`oRjVbBnM!JeUjZp`wQ!5!~2!3/<1*N!b$nevfmg!j-o{fz!yG/y*bNbtCppqp!m-!ycfpup)mqpU!y$feUfbgbjyoGf)!5GuybbpbmGGmbpbbyuG!!gomspvbuufs!!$e<foghjjoTfi!uGhyobfbmG!m+p!byuj3q!cwvfTdu3ft!g$gePfmgfjyojfq!>G,yzb/bNGtmppqb!u*4o!bwqfTd{4sp!i$!e)fggjj!of<!oGhyjbTbiGumhpobfum5!!+w!fydj5qcv!T$uefftggjgoPfm!fGyyjbqb>T,byu/)Nyt*p!qd!m*bonbqq)Ty{-s!p1i/a1)-g!j2!/1<**I!y$jeqfcgvjto!f-!eGpypbHbuUfftyg!gtPbmnfqymjfqs)3yEbn!>$yejfqgcjvoTfu!fGtygbgbPUmffyyUjpqq!)uub-p!mqG*b!buyfGy!uv<s1f/31E!);u!-u!fqt-g!g1P/m1f*yj!q$!e@f!gojboqfT!eGpypbhb>UefpypPHgugf)tug-g!Pqm-f!ypj-q!!su*b!pumfGybubvysGf!3E<)yuj-q!cqv,T)zpu!j+m!bsv*R-b!b1y/g1!*+!!HGyyjbqbcGvmtp>bIuy!jGqycbvbtM!vunbbp)mGGybbbbyGGm!pb<u65/!1s,h*c*bq*d!S|i!ushfoufvMsoob!qsth.c)b!/+z!<u!t~e)!>GuyfbtbgGgmPpmbfuy5j!qG!yubbbpQmjGybfbmyTGi!be<fGsy)jq!cGvytb!b+G!mGpybjuq3c!vqtp>tH-yj!qGcyvbtb!GumbppbmuG5b!bgyyGb!bD<pQootbpqmTfeQpppthQ!p;t!-Oo!bGqyTbebpUpfhy!!@u!fOyo-pj!uGdyfbsbjUef>yo!bgqyTbebpDppho!tmppmpfC4b7b1yUGf!yF<y*qQCujtbet!O-fOhuPtoef)-oj!nG>yubtbeU!fuyb!pgmyGbbbbDypGo!tp<mQfu4t7e1!U=f!yOFuytqeC>jObotpOjfuhdUfxspj-e!!mGpypbCbbGbmypGb!u3<!iguyhbobfRMvobbmqjtu0z1S/d2q>GqsdbSnifu-ho!fGMyobbbqGtm!pubbup5m!GgbybbybGD!po<tppsmff[SUdMqNGbsnbvnmf!P>qau!-*1!/G1y!b=b!GQmepobFub5n!vgmy)b>bQDopboqtTpempfpShd!qmGpspbCnbfbPyqGu!3-<*!OGuytbeb,GQmuptbeu)5>!iguyhbobfDMpoobtqptm!fu4b7p1mSGdbqbGysGb!nf<Ppqsuf3[-UM!NGbynbvbmG!m>pab!u*!1g/y1b!b=R!vObemojFubznTvvmc)q>jOyo-bq!TGeypbpbhG!mmppbpuC!bgbyybGb!Rv<bzm/jNutzpFqe.hzf/UQitspfqt>iQpumtee-!*!oGbyqbTb{Gsmppibau)!ggjy!bb<Rzv/bOmtjpuqz.Fze/hNftUpiqs>fOtuitpem!e*Nojboq-T{!sGpyibab)Ggmjp!bu<!yg/yNbtbpDqp.oyt/pQmtfpFqe>hQfuTtieb!suqbopfmtGtb-by!GG!yb<byG/mOptbpuq!.gyy/bNbtDppqo>tOpumtfeF!euhbfpUmiGsbfbtyiGp!me~-!!~G!yb~b!Gm<p5bQu`!ZgUyJbMbBDVpRo`tBpBmYfGF!e+h!fzU/iQsOfgtgipp>m,ezN/jQot-pq!!G*yQbfboGpmepab)ug5j!!gy<b5bQD`pZoUtJpMmBfV4R7`1BDBpYoGt!u+E!jys/Q!O*g!g|p>!,Gyy/bQbtGpmqp!b*uQ3f!oqppetaN)<gj!!qp<t*NQ/fyo>pqepat)/!y}<}!!*qOpftoNp/eza>)q>pQtO/fzo<pe!!Gy<b5bQG`mZpUbJuM5B!VsRh`cBzBNY>GG!y+b!bzU/fQyOUgpgqp)>u.fzy/-O!tqppqt!N**O<fo!p$eeaf)ggjjo!f!<m5vQn`bZNU!JsMhBcVzRN`/BzBY!GG!y+b!byG/mQpObgug!pm>v.nyb/TO>tGpyqb!b*MOvfnobp)eGay)bgbjU!fy<Pegfgm)budfTyu-o!fqjpetbNs-h!!G>y?b!b*GQmepobFub3n)v!m1)/t1c-b!>2Q/f1o*p-e!!gy<bebfRmvbbdmTjuuozfSjdeqbGsshb!n>f?/!y*zO*e*o<Fb!nGvymb)btGcmbp>bOuf!ompven!bF<>6G/y1b!b+M!vOnObb)nGvymb.bQUefoyFPbgngv)mu>fQye-o!FqbpntvNm-!!*GQyfbobpGemap)bguj3!)!<26//11-!!+1!/O1O*b-n!vgmy.bObeRovFbbmnjvumz>SOdeqoGFsbbnnvfm/!y*zO*f*o<pe!aG)ygbjb!Gm<p*b*uz!ym/vQntbpOq>!G-yybfbuM)vqnpbU)yGfyUbbbbUyfGy)Pbgngv)Mubfbyy-G!>qQpetoNF-b!nGvymb!b*GQmfpobpue3a))!g1j/!1-<.*2*/z1y*/-O!tgpyqb!b-Ryvfbum)jqupzUSydfqUGbsbbynGf)/bynzv*M*b<by!GG>yObeboGFmbpnbvum!!m*vOnfboXp>eGay)bgbjM!vn|b!)*GQyObfboUpfey)Pggjg!)u<f4yQ-`!ZqUpJtMNB-V!RG`yBbBbYGGm!p+b!uz3/)Q.O2g/g1p->!,1z//1Q*t-p!qg!y*bQbfRovpbemaj)ugzjS!dq<G4sQb`nZfU/JyMzB*V*R<`B!BGYyGb!b+G!myp/bQuO!gngbpy>T,Ny>/nQbtyp)qm!v*nQbfTo-p!emav)ngbjN!*<<*!QGfyobpbeGam)p!b}u}!!n*jOofToNp>enaj)o>)QmOvfnobpTe-!!m<v4nQb`NZ*U<JM!BGVyRb`bBGBmYpGb!u+!!nzb/yQFOTgNg>pn>b.yz)/mOvtnpbqF!-*!OnfboypTeNa*)<gj!!Gy<b4bQG`mZpUbJuM!BnVjRo`FBTBNY>Gn!j+o!)ym/vQnObgFg-p!>n.jyo/TONt*p<q!!*GOyfbobpGemap)bguj!!nb<yeXfOm>bndbTyu)omfvjnebbOs-h!!m>v?n!b*XQ*e<oF!bGnyvbmb)Gtmcpbb>uQ!fnojpoeX!O><nejfom)bmdvTnuboOf-j!embvsnhb!X>*?<!*!OGeyobFbbGnmvpmb)ut!csbb>oOhffoNpbey!>n<b6y/)1n!b+y!XOOO-b!nnvbmy.FQTeNo*F<bn!vGmy>bQbeGomFpbbnuv!ms!b*oQhffoNpjeoa>)ngjjo!)n<j6o/X1O!-+!!nOjOobFnTvNm*.<Oe!oGFybbnbvGmm>pObeuo!Fsbbnovhmf!N*bOyfTodpbemaf)eg>js!bo<h*f*Nzbyy/!Q+t!pgqy!b-byRfvub)mqjpuUzyFfeUhbfbUyiGs)fbtnivpMmbeb<yG!>GQyebobFGbmnpvbmu!!*sQbfoohpfe>as)bgojh!fN<b*y*.zsyb/oOhtfpNqj!o-<yf!uG)yqbpbUGymfpUbbub!ysGb)obhnfvNMbbybDymGb>nOqefoeF>bnnbvym)!g*yObfboRpvebam)jgujz!Fe|h!f*UQiOsffotpiep)mgejN!jo<-3!Qs`bZoUhJfMNBbVyRT`dBbBmYfGe!*+<!z!/GQyObgbgCpp>p,mz!/fQbtspmqz!F*yQjfuo>psebao)hgfj!!=!<s3bQo`hZfUNJbMyBDVmRb`nBqBfYeG<!+!!jyg/)QfObgsgmpz>F,yyj/uQ*tp!qs!f*uQvfsoop!esah)cgzjN!<<!*GQyfbobpGemap)b!u}!}m!v*nObfOoXp>eGay)b>bQMOvfnobp)eG!yb<b3UQf`yZPUgJgM)BuVfRy`-B!BqYpGt!N+-!!zG/yQbObgGgmpp>b.uz3/)O.t2p/q1!-*.O2f/o1p*e-a!)ggyjb!bR<v3bQm`jZuUzJSMdBqVGRs`bBnBfY/Gy!z+*!*y</Q!OGgygbpb>G.myp/bOut!pmqv!n*bOTfFo>pGeyab)bgMjv!nb<)eGfymbbbdUTfuyoPfgjge)busfhy!->!?q!p*tQNe-o!FGbynbvbmG)mtpcbbu>3Q)f!o2p/e1!-!<2e/f1m*b-d!TguyobfbjRevbbsmhj!u>z?S!d*qOGesobFnbfn/vymz)*t*c<b>!OGfyobpbeG!mp<b6u/!1m!v+n!bOOOFb>nGvymb.bQMevonFbb)nGvymb>bQUefoyFPbgngv)mu!f*yQ-f!oqppetaN)-g!jG!yb<b6G/m1p!b+u!3O)O!b2n/v1m-..O2e/o1F*b-n!vgmy>bObeRovFbbmnjvumz!S*dOqfGospbenaf)/gyjz!**<<**!zGyy/bQbtGpmqp!b-uy!fmuv)nqbpTUXy>fGUybbbbyMGv)nbbn)vGMybbbbyUGf>yQPegogF)bunfvym-!!*qQpftoNp-e!aG)ygbjb!Gm<p*b*uz3y)/.O2t/p1q-!!-2y/f1u*)-q!pgUyybfbURbvbbymGj)ubznSvdMqbGbsybGn>fO/eyozF*b*n<vm!!G*yObfboGpmepab)ug!jm!vn|b!O*TQ>OmfvonpbeO),gmjv!nb<T2<Q`!ZGUyJbMbBGVmRp`bBuB!YmGv!n+b!XzF/>QmOvgngbpX>,,mzv/nQbtFp<q!!*GQyfbobpGemap)bguj!!tv<c2qQj`yZSUdJqMSBbVoRh`fB>B2Y/G1!0+s!byo/hQfO<gg!pG>y,byb/GQmtppbqu!!*tQvfcoqpjeyaO)TgXjF!>m<v*nQbfOoTp,emav)n!b}X}F!<*O!fGoypbebaG)m>pQbOuf!ofpeeh!fmIpppsC{b2b>y)G.!3/<12!Q+`!ZmUvJnMbBNV*R,`mBvBnYbGO!T+<!z!/GQyObgbgGpm>p.bzu/!Oftephqf!W*fOsfuo2p>e)a.)3g/j1!!+<!2mQv`nZbUNJ*M,BmVvRn`bBXBFY<G!!+G!yyb/bQGOmgpgbpu>!.myv/nObtOpFqT!F*>OmfvonpbeOaF),gmjv!nb<TeFf<mb!dGTyubobfGjmepbbsuh!!m>v?n!b*OQXeOoFF>bmnvvnmb)OtXc,bm>vQnfboOpFe<!m!pGpyCbbbbGymGp!bu<!effemhbfdITpuso{f3j>e)b.s3h/!1>!?+!!*mOvenobFFb*n,vmmv)ntbcObF>TOFf<op!eG!ymbpbpGCmbpbbyuG!!fe<h6f/W1f!s+u!3O>O)b.n3v/m1>!.+Q!emovFnbbnOv*m,!mv<n6b/O1X!O+F!<OO!bGnyvbmb>G.mOpebouF!bmnvvnmb!OX<T1X/>1m!v=n!bNONXb,nmvvmn>bpTsXf<[U!MGNybbnbvGmm!pmbpup!CmbvbnybGT!XT<FF>ymjvqncbvTtX!,+m!vEnybjTqFc<vt!>GGyybjbqGcmvptb!uu!bfpemhGfbIbpysG{!5><)6b/c1t!)+f!eOhOfbInpvsm{.2N*b!n+v!m3>/N1N*b,nbvcmt!)ufbephmfGIbpbsy{G3!*<<1!/G5y0b1b/G2m!p+b!uu!offejhefbWsfhs>ue5f>m)bbdcTtu)offejhefbWsfhs!uu2b*p!m+G!b3b/y1G*!,b<cTtT)bfnevhmf>WOfOsbun3v*m<!*!OGsyjbbbqGam)pgbju!!f<e*h*fQItppsq{!4->y)f.u3)/q1p!U+y!fmUvbnbbyXG*),bmnvvnMbbObXyTGX><Qe!oGFybbnbvGmm!pubbup!mfGebhbfyWGf!su<4D>y)j.q3c/v1t!!++!!mDvynjbqTc*v,tm>vFnybjTqXcTvFt<!u!bGpymbGbbGbmypGb!u!<f*e*hOftIppqs!{->ybfcut))qfpeUhyffIUpbsb{y4G*),bfnevhMfbIbpysG{>5O<eo!FGbynbvbmG!mupbbpum!GfbebhyfGW!fs<u1>/b4c,t*)DfyejhqfcWvfts+u*41*/,3f.e)h)f>WEfysjuq5c<vt!!GuybbpbmGGmbpbbyuG!!tv<c1qQj`yZOUXJTMXBOVFRT`FB>BmYvGn!b+O!XzT/XQ,Omgvgnpb,OzF/TCFt<pq!>Gzy/bQbtGpmqp!bu<!1mQf`oZhUuJiMTBjVhRo`>BgByYbGb!R+v!bym/jQuOzgSgdpq,Gys/bCntfp/qy><y/!QGtypbqb!Cp<pQmt!piqp!s3{uTbqpbmoG>bfbeyhGf!Ip<s1{Q!`?Z>U!JfMeBhVfRW`fBsBuY<G!!+G!yzb/bQGOmgpgbpu.!zt/vCctqpjqy>Bz>/tOvtcpqqj!yO<T1XQF`!Z+U!J3M/B1V,Rt`vBcBqYjGy!O+X!TyX/OQFOTgFg<p.!yj/gC)tapiqp>sy{/TOqtbpoq*!!m<vOntbpOq>!m3vunbbpXm<Gb!bjygG)!ai<p6s/{1T!q+b!oo*h!jmTvinubhTo>fmmv>n,bzF/<Ct!pjqg!)*iopbsq{TT{qsbpoi*!!)mgfjo!hu<i6T/j1h!o+>!goyhbjbTRivubhmojfumz>S,dyq/GCstbpnqf!/*zo<bq!TG{ysbpbiGam)pgbju!!t<vzc/qfjnybCs>G)qtdvSczqujjymBb!v+R!b)b2y/g1!0;2!31//11*!*@.!m*vonbbqNT<{s!pGiy!b)b>Gzm/pQbOug!ghps!be<jyf/ofunOb>smGvqndbSOz.umjvmnbbvNR<bb!yGgy!b;b!G1m/p1b!u@!!h*sobbeqjTf{osupTi>am)v>nyb/TQ.Omgvgnpb!N<<Q!OGgygbpb!G3mupbbpum!GmbvbnybGO!O><mzv/nNbtOp,qm>vzn/bCNt<pq!!Gy<byb/GNmtppbqu>!ym/vCntbpTqT!>m<vCntbpTq,!m3vunbbpNm<Gb!bGyyGb!bC<p*pfmh!oqbbSjqsdOS>ybjcqtc)vhts!b+e!j*fCoyujOq*c!v?t>)!tbccbt))uhbsTbbebjyfGo>uDTy*j<qc!vGty!bubbGpmmpGbbub!yhGs!be<jofhojuT>inubhyo)fbmc.t>)ohhsjbTeijufhooufOm*!-*!Obscjtb)qh)sgbje!jf<o*u*T",kk(H,{accordionViewExpandIcon:aj(ti),accordionViewCollapseIcon:aj(ti,!0),accordionViewLabelColor:Rl,accordionViewLabelFont:Mr,accordionViewTitleBackground:Kj,accordionViewSelectBackground:Sh,accordionViewSelectWidth:3,accordionViewSeparatorColor:W,splitViewDividerSize:1,splitViewDividerBackground:Kj,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:Fc,rect:[2,2,12,12],background:ti}]},propertyViewLabelColor:Ub,propertyViewLabelSelectColor:Rl,propertyViewLabelFont:Mr,propertyViewExpandIcon:aj(Ao),propertyViewCollapseIcon:aj(Ao,!0),propertyViewBackground:Kg,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:ki,propertyViewColumnLineColor:ki,propertyViewSelectBackground:Sh,listViewLabelColor:Ub,listViewLabelSelectColor:Rl,listViewLabelFont:Mr,listViewRowLineVisible:!1,listViewRowLineColor:ki,listViewSelectBackground:Sh,treeViewLabelColor:Ub,treeViewLabelSelectColor:Rl,treeViewLabelFont:Mr,treeViewExpandIcon:aj(eh),treeViewCollapseIcon:aj(eh,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:ki,treeViewSelectBackground:Sh,treeViewDoubleClickToToggle:!0,tableViewLabelColor:Ub,tableViewLabelSelectColor:Rl,tableViewLabelFont:Mr,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:ki,tableViewColumnLineColor:ki,tableViewSelectBackground:Sh,treeTableViewLabelColor:Ub,treeTableViewLabelSelectColor:Rl,treeTableViewLabelFont:Mr,treeTableViewExpandIcon:aj(eh),treeTableViewCollapseIcon:aj(eh,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:ki,treeTableViewColumnLineColor:ki,treeTableViewSelectBackground:Sh,tableHeaderLabelColor:Ub,tableHeaderLabelFont:Mr,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:po,tableHeaderBackground:Kg,tableHeaderMoveBackground:Qo,tableHeaderInsertColor:Sh,tableHeaderSortDescIcon:Eq(Ao,!0),tableHeaderSortAscIcon:Eq(Ao),tabViewTabGap:1,tabViewLabelColor:Rl,tabViewLabelFont:Mr,tabViewTabBackground:Kj,tabViewSelectWidth:3,tabViewSelectBackground:Sh,tabViewMoveBackground:Qo,tabViewInsertColor:Sh,toolbarLabelColor:Ub,toolbarLabelSelectColor:Rl,toolbarLabelFont:Mr,toolbarBackground:Kg,toolbarSelectBackground:Sh,toolbarItemGap:8,toolbarSeparatorColor:Mg},!0);var yt={translateX:1,sortColumn:1},zt={sortable:1,sortOrder:1,sortFunc:1},At={focusData:1},Bt={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},Ct={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},Dt=function(q,E){E.add(q),q.hasChildren()&&q.eachChild(function(G){Dt(G,E)
})},Et=function(q,l,x,R,h,i,O,B,I,P,c){var N,C=x.getValueType(P),g=x.getAlign(P);if(x.getEnumValues(P)){var b=x.toEnumLabel(l,P),v=bq||0,F=0,Z=i,G=H.getTextSize(R,b).width;return N=Fr(x.toEnumIcon(l,P)),N&&(F=i+bq/2,"center"===g?F+=(B-(v+G))/2:"right"===g&&(F=F+B-(v+G)),Qp(q,N,F,O+I/2,P,c),Z=F+bq/2),b!=S&&(N?Qh(q,b,R,h,Z,O,B-(Z-i),I):Qh(q,b,R,h,i,O,B,I,g)),void 0}return l=x.formatValue(l),l!=S?C===kp?(Xf(q,i,O,B,I,l),void 0):C===Ak||!C&&an(l)?(N=Fr(l?os:ub),Qp(q,N,i+B/2,O+I/2,P,c),void 0):(Qh(q,l,R,h,i,O,B,I,g),void 0):void 0},Ft=function(p,j){var H=j.view,I=Nn(p),$=j.column||j.property;H.getDataModel().beginTransaction(),j.editor=p,p.info=j,H.setCurrentEditor(p),H.getView().insertBefore(I,H._79O),Pg(p,j.editorRect),p.setFocus?p.setFocus():cg(p),p.commitValue=function(B,Z){p._17Q&&(p=p._17Q),Z||H.setValue(j.data,$,p.getValue?p.getValue():p.value),p.close&&p.close(),re(I)},$.onEditorCreated&&$.onEditorCreated(j)},Gt=function(v,s,U,$,c){var g=mh(v,U),e=s.value,L=s.view,O=c.getValueType(s.data);return g.onblur=g.onchange=function(){L.endEditing()},"input"===v?(e=c.formatValue(e),e!=S&&(g.value=e),g.onkeydown=function(R){Db(R)?L.endEditing():Jr(R)&&L.endEditing(!0)},(O===Ql||O===Jd)&&Z(g,wn,H.numberListener)):v===jk&&$.forEach(function(D){var C=m.createElement("option");C.innerHTML=c.toEnumLabel(D),C.value=D,c.isEnumEqual(e,D)&&(C.selected=!0),wf(g,C)}),Ft(g,s),g},Ht=n.widget={},It=function(u,i,G){Dh(V+".widget."+u,i,G)};kk(Ep,{ms_value:function(I){I.getValue=function(m){var h=this.getItemById(m),H=h.element;return xd(H)?H:H?H.getValue?H.getValue():H.value:h.selected},I.setValue=function(E,t){var o=this.getItemById(E);if(o){var b=o.element;b&&!xd(b)?b.setValue?b.setValue(t):b.value=t:an(t)?(o.selected=t,this.iv()):(o.element=t,this.iv())}},I.v=function(h,J){var P=this;if(2===arguments.length)P.setValue(h,J);else{if(!Il(h))return P.getValue(h);for(var g in h)P.setValue(g,h[g])}return P}},_46o:function(G){G._icon=S,G._accessType=S,G._valueType=S,G._editable=!1,G._batchEditable=!0,G._align=Vn,G._nullable=!0,G._emptiable=!1,G.setParent=vg,G.formatValue=function(c){var z=this,O=z._valueType;return z.getEnumValues()?z.toEnumLabel(c):O===Ak?!!c:c!=S&&O===Ql?b(c):c},G.setEnum=function(O,i,t,p,o,a,H){var c=this;O&&!Td(O)&&O.values&&(p=O.editable,t=O.icons,i=O.labels,o=O.strict,a=O.maxHeight,H=O.dropDownWidth,O=O.values),No(O)&&(O=O._as),No(i)&&(i=i._as),No(t)&&(t=t._as),c._enumValues=O,c._enumLabels=i,c._enumIcons=t,c._enumEditable=p,c._enumStrict=o==S?!0:o,c._enumMaxHeight=a,c._enumDropDownWidth=H,O&&O.length&&ff(O[0])&&(c._valueType=Jd),c.fp("enum",!1,!0)},G.getEnumDropDownWidth=function(){return this._enumDropDownWidth},G.getEnumMaxHeight=function(){return this._enumMaxHeight},G.isEnumEditable=function(){return this._enumEditable},G.getEnumValues=function(){return this._enumValues},G.getEnumLabels=function(){return this._enumLabels},G.getEnumIcons=function(){return this._enumIcons},G.isEnumStrict=function(){return this._enumStrict},G.isEnumEqual=function(M,N){return this._enumStrict?M===N:M==N},G.toEnumLabel=function(V,Q){var W=this,m=W.getEnumValues(Q),l=W.getEnumLabels(Q);if(m&&l)for(var I=0;I<m.length;I++)if(W.isEnumEqual(V,m[I]))return l[I];return V},G.toEnumIcon=function(I,Y){var O=this,d=O.getEnumValues(Y),X=O.getEnumIcons(Y);if(d&&X)for(var w=0;w<d.length;w++)if(O.isEnumEqual(I,d[w]))return X[w];return W}},_45o:function(c){c._87o=function(p,K,o,I,O,r){if(p){var u=this,s=u._90I,D=ue(1);u._columnLineVisible&&(O-=1),u._rowLineVisible&&(r-=1),0>=O||0>=r||(u._90I||(s=u._90I={}),s[K]||(s[K]=new Xd),Pg(D,u.tx()+o,u.ty()+I,O,r),wf(D,p),u._view.insertBefore(D,u._79O),p.onParentAdded&&p.onParentAdded(D),s[K].add(D))}},c._76o=function(){var I=this,d=I._90I;if(d){for(var H in d)d[H].each(function(V){re(V)});delete I._90I}},c._77o=function(Q){var P=this;if(P._90I){var N=P._90I[Q];N&&(N.each(function(B){re(B)}),delete P._90I[Q])}}},_47o:function(t){t.getValue=function(D,z){return z.getValue?z.getValue(D,z,this):yi(D,z.getAccessType(),z.getName())},t.setValue=function($,z,F){if(z.isEmptiable($)||""!==F||(F=W),z.isNullable($)||F!=S){var E=this,j=z.getName($),Z=z.getAccessType($),Y=z.getValueType($);Y===Ql&&xd(F)?F=fl(F):Y===Jd&&xd(F)?F=parseFloat(F):Y===Ak&&xd(F)&&(F="true"===F),E._batchEditable&&z._batchEditable&&E.isSelected($)?E.sm().each(function(G){z.setValue?z.setValue(G,z,F,E):ae(G,Z,j,F)}):z.setValue?z.setValue($,z,F,E):ae($,Z,j,F)}},t.setCurrentEditor=function(z){this.endEditing(),this._currentEditor=z,this.redraw()},t.isEditing=function(d,Q){var R=this,X=R._currentEditor;if(!X)return!1;if(Q){var v=X.info;return v?(v.column||v.property)===Q&&v.data===d:!1}return!0},t.endEditing=function(E){var L=this,k=L._currentEditor;k&&(delete L._currentEditor,k.commitValue&&k.commitValue(k.info,E),L.redraw(),L.getDataModel().endTransaction())},t.beginEditing=function(_){this.endEditing();var g=this,U=_.column||_.property;if(U.beginEditing)U.beginEditing(_);else{var w=_.data,Q=_.value,e=g.getSelectBackground(w),v=U.getEnumValues(w),m=U.getSlider(w),Z=U.getColorPicker(w);if(m){var A=zr(Ht.Slider,m);return A.setValue(Q),A.getView().onblur=function(){g.endEditing()},A.isInstant()&&(A.onValueChanged=function(){g.setValue(w,U,A.getValue())}),Ft(A,_),void 0}if(Z||U.getValueType(w)===kp){var d=zr(Ht.ColorPicker,Z);return d.setValue(Q),d.onClosed=function(){g.endEditing()},d.isInstant()&&(d.onValueChanged=function(O,n){g.setValue(w,U,n)}),Ft(d,_),d.open(),void 0}if(v){if(Ht.ComboBox){var P=new Ht.ComboBox;P.setValue(Q),P.setValues(v),P.setLabels(U.getEnumLabels(w)),P.setIcons(U.getEnumIcons(w)),P.setEditable(U.isEnumEditable(w)),P.setStrict(U.isEnumStrict(w)),P.setMaxHeight(U.getEnumMaxHeight(w)),P.setDropDownWidth(U.getEnumDropDownWidth(w)),P.onClosed=function(){g.endEditing()},Ft(P,_),P.open()}else Gt(jk,_,e,v,U);return}var K=U.getValueType(w);if(K===Ak||an(Q))return g.setValue(w,U,!Q),void 0;if(U.getItemEditor(w)){var M=td(U.getItemEditor(w)),H=new M(w,U,g,_),j=H.getView();return j._17Q=H,H.setValue(Q),vp(j),Ft(j,_),H.editBeginning&&H.editBeginning(),void 0}Gt("input",_,e,S,U)}}},_44o:function(p){p.init=function(u){var P=this,O=P.th=new Xt(u),D=P._view=Xk(1,P);P.tv=P._tableView=u,wf(D,O.getView()),wf(D,u.getView()),O.mp(function(q){q.property===yg&&P.iv()}),P.iv()},p.getTableView=function(){return this.tv},p.getTableHeader=function(){return this.th},p.getDataModel=function(){return this.tv.dm()},p.getColumnModel=function(){return this.tv.getColumnModel()},p.setColumns=function(J){this.tv.setColumns(J)},p.addColumns=function(K){this.tv.addColumns(K)},p.endEditing=function(){this.tv.endEditing()},p.validateImpl=function(){var C=this,z=C.th,X=be(z),n={x:0,y:0,width:C.getWidth(),height:X};Pg(z,n),n.y=X,n.height=g(0,C.getHeight()-X),Pg(C.tv,n)}},ms_vs:function(K){K._41o=function(){return this._29I.height<this._59I},K._43o=function(){var k=this;k._41o()&&(k._58I||(Yk(function(){k._94O()},Op),k.iv()),k._58I=new Date)},K._94O=function(){var K=this;if(K._58I){var v=new Date;v.getTime()-K._58I.getTime()>=Op?(delete K._58I,K.iv()):Yk(function(){K._94O()},Op)}},K._93I=function(){var X=this,l=X._27I;if(X._58I||!X._autoHideScrollBar){l||wf(X._79O,l=X._27I=ue());var g=X._29I,s=g.height,A=X._59I,p=X.getScrollBarSize(),e=g.width-p-2,u=s*(-X.ty()/A),t=s*(s/A),r=l.style;A>s?(ie>t&&(u=u+t/2-ie/2,0>u&&(u=0),u+ie>s&&(u=s-ie),t=ie),r.visibility=jh,r.background=X.getScrollBarColor(),r.borderRadius=p/2+Kl,Pg(l,e,u,p,t)):r.visibility=Ef}else l&&(l.style.visibility=Ef)}},ms_hs:function(b){b._40o=function(){return this._29I.width<this._91I},b._42o=function(){var Q=this;Q._40o()&&(Q._95O||(Yk(function(){Q._94I()},Op),Q.iv()),Q._95O=new Date)},b._94I=function(){var d=this;if(d._95O){var u=new Date;u.getTime()-d._95O.getTime()>=Op?(delete d._95O,d.iv()):Yk(function(){d._94I()},Op)}},b._92I=function(){var A=this,W=A._28I;if(A._95O||!A._autoHideScrollBar){W||wf(A._79O,W=A._28I=ue());var M=A._29I,D=M.width,V=A._91I,B=A.getScrollBarSize(),j=M.height-B-2,$=D*(-A.tx()/V),L=D*(D/V),I=W.style;V>D?(ie>L&&($=$+L/2-ie/2,0>$&&($=0),$+ie>D&&($=D-ie),L=ie),I.visibility=jh,I.background=A.getScrollBarColor(),I.borderRadius=B/2+Kl,Pg(W,$,j,L,B)):I.visibility=Ef}else W&&(W.style.visibility=Ef)}}}),oi(os,Rn(16,16,[{type:Fi,rect:[1,1,14,14],background:Sh},{type:tk,rect:[1,1,14,14],width:1,color:me},{type:Zb,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),oi(ub,Rn(16,16,{type:tk,rect:[1,1,14,14],width:1,color:me})),oi(eb,Rn(16,16,[{type:mj,rect:[2,2,12,12],borderWidth:1,borderColor:me,background:"#FFF"},{type:mj,rect:[4,4,8,8],background:Sh}])),oi(Bl,Rn(16,16,{type:mj,rect:[2,2,12,12],borderWidth:1,borderColor:me})),Ep._15Q=function(F){F._29I=kq,F._59I=0,F._91I=0,F._5o=function(i){var S=this;S._30I=new Xd,S._rows=new Xd,S._rowMap={},S._31I=0,S._14I=0,S._view=Xk(1,S),S._canvas=Zj(S._view),wf(S._view,S._79O=ue()),S.dm(i?i:new es)},F.getCheckIcon=function(N){var G=this.sm(),l=G.co(N);return G.sg()?Fr(l?eb:Bl):Fr(l?os:ub)},F.checkData=function(A){var T=this.sm(),s=T.co(A);T.sg()&&s||(this._32o=1,s?T.rs(A):T.as(A),delete this._32o)},F.getDataAt=function(J){J.target&&(J=this.lp(J));var R=j(J.y/this._rowHeight),Y=this._rows;return 0>R||R>=Y.size()?S:Y.get(R)},F.onDataDoubleClicked=function(){},F.onDataClicked=function(){},F.adjustTranslateX=function(){return 0},F.adjustTranslateY=function(e){var o=this.getHeight()-this._59I;return o>e&&(e=o),e>0?0:b(e)},F.onPropertyChanged=function(m){var K=this,L=m.property;Bt[L]?K.ivm():At[L]||K.redraw(),L===Ih?K._42o():L===xi&&K._43o()},F.getLabel=function(i){return i.toLabel()},F.getLabelFont=function(){return this._labelFont},F.getLabelColor=function(n){var C=this;if(C.isCheckMode()){if(C._focusData===n)return C._labelSelectColor}else if(C.isSelected(n))return C._labelSelectColor;return C._labelColor},F.getStartRowIndex=function(){return this._31I},F.getEndRowIndex=function(){return this._14I},F.getRowDatas=function(){return this._rows},F.getRowIndex=function(y){return this._rowMap[y._id]},F.getRowSize=function(){return this._rows.size()},F.getViewRect=function(){return Dl(this._29I)},F.isVisible=function(S){return this._visibleFunc?this._visibleFunc(S):!0},F.getCurrentSortFunc=function(){return this._sortFunc},F.setDataModel=function(O){var R=this,Y=R._dataModel,W=R._selectionModel;Y!==O&&(Y&&(Y.umm(R.handleDataModelChange,R),Y.umd(R.handleDataPropertyChange,R),Y.umh(R.handleHierarchyChange,R),W||Y.sm().ums(R.handleSelectionChange,R)),R._dataModel=O,O.mm(R.handleDataModelChange,R),O.md(R.handleDataPropertyChange,R),O.mh(R.handleHierarchyChange,R),W?W._21I(O):O.sm().ms(R.handleSelectionChange,R),R.fp("dataModel",Y,O))},F.validateModel=function(){var q=this;q._rows.clear(),q._rowMap={},q.buildChildren(q._dataModel._roots);var y=q._rows=q._rows.toList(q.isVisible,q),k=0,S=q.getCurrentSortFunc(),W=y.size();for(S&&y.sort(S);W>k;k++)q._rowMap[y.get(k)._id]=k},F.buildChildren=function(R){var X=this;R.each(function(r){X._rows.add(r),X.buildChildren(r._children)})},F.handleDataModelChange=function(){this.ivm()},F.handleDataPropertyChange=function(T){"parent"===T.property?this.ivm():this.invalidateData(T.data)},F.handleHierarchyChange=function(){this.ivm()},F.handleSelectionChange=function(K){K.datas.each(this.invalidateData,this),this.onSelectionChanged(K)},F.onSelectionChanged=function(e){var K=this,w=K.sm();!K.isAutoMakeVisible()||1!==w.size()||"set"!==e.kind&&"append"!==e.kind||K._32o||K.makeVisible(w.ld())},F.handleBackgroundClick=function(k){yp(k)&&!this.isCheckMode()&&this.sm().cs()},F.makeVisible=function(x){x&&(this._23I=x,this.iv())},F.scrollToIndex=function(r){var U=this,b=U._29I,Z=b.height,D=U._rowHeight,g=D*r;r>=0&&r<U._rows.size()&&Z>0&&(g+D>b.y+Z?U.ty(-g+Z-D):g<b.y&&U.ty(-g))},F.autoScroll=function(M,c){var Q=this,O=Q._rowHeight,N=O,g=O/4,h=Q._29I,x=Q.lp(M),L={x:Q.tx(),y:Q.ty()};return O>0&&h&&(x.x-h.x<N?Q.translate(g,0):h.x+h.width-x.x<N&&Q.translate(-g,0),x.y-h.y<N?Q.translate(0,g):h.y+h.height-x.y<N&&Q.translate(0,-g)),L.x=Q.tx()-L.x,L.y=Q.ty()-L.y,c&&(c.x+=L.x,c.y+=L.y),L},F.getTopRowOrderSelection=function(){var C=this.sm().getTopSelection(),q={},Y=new Xd;return C.each(function(y){q[y._id]=y}),this._rows.each(function(y){q[y._id]&&Y.add(y)}),Y},F.getRowOrderSelection=function(){var F=new Xd;return this._rows.each(function(B){this.isSelected(B)&&F.add(B)},this),F},F.ivm=function(){this.invalidateModel()},F.invalidateModel=function(){var G=this;G._96I||(G._96I=1,G._32I=1,delete G._24I),G.iv()},F.redraw=function(){var M=this;M._32I||(M._32I=1,delete M._24I,M.iv())},F.invalidateData=function(D){var B=this;$k?B.redraw():B._32I||(B._24I||(B._24I={}),B._24I[D._id]=D,B.iv())},F.getFocusData=function(){return this._focusData},F.setFocusDataById=function(_){this.setFocusData(this.dm().getDataById(_))},F.setFocusData=function(I){var D=this,J=D._focusData;J!==I&&(D._focusData=I,D.fp("focusData",J,I),J&&D.invalidateData(J),I&&(D.invalidateData(I),D.isAutoMakeVisible()&&D.makeVisible(I)))},F.drawRowBackground=function(w,y,D,Z,t,k,d){var i=this,W=i.isCheckMode();(y===i._focusData&&W||D&&!W)&&Xf(w,Z,t,k,d,i.getSelectBackground(y))},F.drawData=function(B,n,m){var s=this,y=s._rowHeight,P=y*m,L=s._29I,J=L.x,u=L.width;B.save(),B.beginPath(),B.rect(J,P,u,y),B.clip(),s._87o(s.drawRow(B,n,s.isSelected(n),J,P,u,y),m,J,P,u,y),B.restore(),s._rowLineVisible&&Xf(B,J,P+y-1,u,1,s._rowLineColor)},F._12I=function(b){var g=this,Q=g._31I,t=g._29I,f=t.x,Y=t.y,C=t.width,V=t.height;for(b.beginPath(),b.rect(f,Y,C,V),b.clip(),b.clearRect(f,Y,C,V),g._76o(),g._93db(b);Q<g._14I;Q++)g.drawData(b,g._rows.get(Q),Q);g._92db(b)},F._13I=function($){for(var N,k=this,E=k._rowHeight,O=k._29I,Q=O.x,R=O.width,e=k._31I,W=k._30I;e<k._14I;e++)N=k._rows.get(e),k._24I[N._id]&&W.add({data:N,index:e});W.isEmpty()||($.beginPath(),W.each(function(s){$.rect(Q,s.index*E,R,E)}),$.clip(),W.each(function(A){$.clearRect(Q,A.index*E,R,E)}),W.each(function(p){k._77o(p.index)}),k._93db($),W.each(function(a){k.drawData($,a.data,a.index)}),k._92db($),W.clear())},F.preValidateModel=function(){this.endEditing&&this.endEditing()},F.validateImpl=function(){var E=this,$=E._canvas,Q=E.getWidth(),d=E.getHeight(),N=E._rowHeight,X=E._32I;(Q!==$.clientWidth||d!==$.clientHeight)&&(Vj($,Q,d),X=1),E._96I&&(E.preValidateModel(),E.validateModel());var Z=E._29I,r={x:-E.tx(),y:-E.ty(),width:Q,height:d},G=E._rows.size(),Y=ed($),K=E._23I;X||hf(r,Z)||(X=1),E._29I=r,E._59I=G*N,E._31I=j(r.y/N),E._14I=k((r.y+r.height)/N),E._31I<0&&(E._31I=0),E._14I>G&&(E._14I=G),E._99I&&X&&E._99I();var w=E.tx(),t=E.ty();(E._40o()||E._41o())&&(E._59I+=E.getScrollBarSize(),E._99I&&X&&(E._91I+=E.getScrollBarSize())),Pk&&!Lc&&(Y.save(),of(Y,Q/gs.length,d/gs.length,1)),of(Y,w,t,1),X?E._12I(Y):E._24I&&E._13I(Y),E._93I(),E._92I(),Y.restore(),E._32I=E._24I=E._96I=S,K&&(E.scrollToIndex(E.getRowIndex(K)),delete E._23I),E.tx(E.tx()),E.ty(E.ty())},F.canHandleSelectMode=function(){return!0}},Ep._48o=function(H){H._rootVisible=!0,H._rootData=S,H._35o=function(){this._expandMap={},this._levelMap={}},H.validateModel=function(){var o=this,T=o._rootData;o._rows.clear(),o._levelMap={},o._rowMap={},o._currentLevel=0,T?o._rootVisible?o.isVisible(T)&&o.buildData(T):o.buildChildren(T):o.buildChildren(),delete o._currentLevel},H.buildData=function(o){var b=this,w=o._id,V=b._rows;b._rowMap[w]=V.size(),V.add(o),b._levelMap[w]=b._currentLevel,b.isExpanded(o)&&(b._currentLevel++,b.buildChildren(o),b._currentLevel--)},H.buildChildren=function(r){var M=this,F=r?r._children:M._dataModel._roots,w=M.getCurrentSortFunc();w&&M.isChildrenSortable(r)?F.toList(M.isVisible,M).sort(w).each(M.buildData,M):F.each(function(G){M.isVisible(G)&&M.buildData(G)})},H.getLevel=function(i){return this._levelMap[i._id]},H.getToggleIcon=function(n){var B=this,m=B._loader,G=B._collapseIcon;return m&&!m.isLoaded(n)?G:n.hasChildren()?B.isExpanded(n)?B._expandIcon:G:S},H.isCheckMode=function(){return this._checkMode!=S},H.isChildrenSortable=function(){return!0},H.handleDataModelChange=function(w){var C=this;w.kind===Wh?delete C._expandMap[w.data._id]:w.kind===rs&&(C._expandMap={}),C.ivm()},H.toggle=function(o){var K=this;K.isExpanded(o)?K.collapse(o):K.expand(o)},H.isExpanded=function(k){return 1===this._expandMap[k._id]},H.expand=function(I){var Q=this,z=Q._loader;Q.isExpanded(I)||(z&&!z.isLoaded(I)&&z.load(I),Q._expandMap[I._id]=1,Q.ivm(),Q.onExpanded(I))},H.onExpanded=function(){},H.collapse=function(k){var Z=this;Z.isExpanded(k)&&(delete Z._expandMap[k._id],Z.ivm(),Z.onCollapsed(k))},H.onCollapsed=function(){},H.expandAll=function(u){if(u)this.expand(u),u.eachChild(function(m){this.expandAll(m)},this);else{var d=this;d._dataModel.each(function(i){i.hasChildren()&&(d._expandMap[i._id]=1)}),d.ivm()}},H.collapseAll=function(){this._expandMap={},this.ivm()},H.makeVisible=function(D){if(D){var o=this;if(!o._rootData||D.isDescendantOf(o._rootData)){for(var j=D._parent;j;)o.expand(j),j=j._parent;o._23I=D,o.iv()}}},H.checkData=function(o){var x,m=this,Z=m._checkMode,V=m.sm(),q=V.co(o);if(!V.sg()||!q){if(m._32o=1,Z===Bg)q?V.rs(o):V.as(o);else if(Z===Ue)x=new Xd(o),x.addAll(o._children);else if("descendant"===Z)x=new Xd,Dt(o,x);else if("all"===Z&&(x=new Xd,Dt(o,x),!q))for(var f=o._parent;f;)x.add(f),f=f._parent;x&&(q?V.rs(x):V.as(x)),delete m._32o}},H.drawTree=function(d,h,f,u,P,G,s){var p=this,I=p._indent,c=p._levelMap[h._id],A=p.getIconWidth(h),y=Fr(p.getToggleIcon(h));y?(u+=I*c,Qp(d,y,u+I/2,P+s/2,h,p),u+=I):u+=I*(c+1),p._checkMode&&(Qp(d,p.getCheckIcon(h),u+I/2,P+s/2,h,p),u+=I),p.drawIcon(d,h,u,P,A,s),p.drawLabel(d,h,u+A,P,s)}},Ep._14Q=function(B){B.getIcon=function(N){return N.getIcon()},B.getIconWidth=function(j){return this.getIcon(j)?this._indent:0},B.drawIcon=function(N,u,F,M,o,a){if(o){var t=this,X=t.getBodyColor(u),E=Fr(t.getIcon(u),X);E&&(a-=t.isRowLineVisible()?1:0,xe(N,E,Eh,F,M,o,a,u,t,X),Qd(N,t.getBorderColor(u),F,M,o,a))}},B.drawLabel=function(x,v,y,R,o){var j=this;Qh(x,j.getLabel(v),j.getLabelFont(v),j.getLabelColor(v),y,R,0,o)}},Ep._50o=function(y){y._98I=function(){var N=this,z=N._39o=new es;N._60I=new Xd,z.mm(N._17o,N),z.md(N._18o,N),z.mh(N._19o,N)},y.setColumns=function(t){this._39o.clear(),this.addColumns(t)},y.addColumns=function(V){var h=this._39o;V.forEach(function(q){if(!(q instanceof Kt)){var s=td(q.className);q=zr(s?s:Kt,q)}h.add(q)})},y.onColumnClicked=function(){},y.onCheckColumnClicked=function(){},y._3Q=function(n){for(var X,J=0,R=this._60I,j=R.size();j>J;J++)if(X=R.get(J),X.column===n)return X;return S},y.getColumnAt=function(L){var R=this._4Q(L);return R?R.column:S},y._4Q=function(n){for(var V=this,W=n.target?V.lp(n).x:n.x,$=V._60I,i=0;i<$.size();i++){var H=$.get(i),Z=H.startX;if(W>=Z&&W<Z+H.column.getWidth())return H}return S},y.getToolTip=function(m){var V=this,G=V.getDataAt(m),i=V.getColumnAt(m);return G&&i?i.getToolTip(G,V):S},y.adjustTranslateX=function(Z){var p=this.getWidth()-this._91I;return p>Z&&(Z=p),Z>0?0:b(Z)},y._99I=function(){var E=this,o=E._29I,C=E._60I;C.clear(),E._91I=0,E._39o._roots.each(function(h){if(h.isVisible()){var L=E._91I+h.getWidth();E._91I<=o.x+o.width&&L>=o.x&&C.add({column:h,startX:E._91I}),E._91I=L}})},y.drawData=function(W,g,$){var Y=this,l=Y._rowHeight,n=l*$,O=Y.isSelected(g),D=Y._29I,y=D.x,U=D.width;Y.drawRowBackground(W,g,O,y,n,U,l),Y._60I.each(function(k){var G=k.column,R=k.startX,V=G.getWidth();V>0&&!Y.isEditing(g,G)&&(W.save(),W.beginPath(),W.rect(R,n,V,l),W.clip(),Y._87o(Y.drawCell(W,g,O,G,R,n,V,l),$,R,n,V,l),Y._columnLineVisible&&Xf(W,R+V-1,n,1,l,Y._columnLineColor),W.restore())}),Y._rowLineVisible&&Xf(W,y,n+l-1,U,1,Y._rowLineColor)},y.drawCell=function(C,c,e,a,D,O,w,v){var M=this;if(a.drawCell)return a.drawCell(C,c,e,a,D,O,w,v,M);var j=M.getValue(c,a);Et(C,j,a,M.getLabelFont(c,a,j),M.getLabelColor(c,a,j),D,O,w,v,c,M)},y.getColumnModel=function(){return this._39o},y._17o=function(){this.redraw()},y._18o=function(B){var T=this;B.data===T._sortColumn&&zt[B.property]?T.ivm():(T._42o(),T.redraw())},y._19o=function(){this.redraw()},y.getCurrentSortFunc=function(){var R=this,b=R._sortColumn;if(b&&b.isSortable()){var d=b.getSortFunc(),n=hd===b.getSortOrder()?1:-1;return d||(d=ck),function(H,Q){return d.call(R,R.getValue(H,b),R.getValue(Q,b),H,Q)*n}}return R._sortFunc},y.isCellEditable=function(g,q,H){return q.isEditable()&&this.isEditable()?q.isCellEditable?q.isCellEditable(g,q,H,this):!0:!1},y._37O=function(V,w){if(yp(w))for(var g=this,O=g.lp(w),u=g._60I,e=g._rowHeight,C=g._29I,n=C.x,a=C.y,b=C.width,D=C.height,H=0;H<u.size();H++){var X=u.get(H),K=X.startX,d=X.column,P=d.getWidth();if(d!==g._31o&&d!==g._4o&&O.x>=K&&O.x<K+P&&g.isCellEditable(V,d,w)){var p={x:K,y:g.getRowIndex(V)*e,width:P,height:e},t={x:p.x+g.tx(),y:p.y+g.ty(),width:p.width,height:p.height},M=0,L=0;return p.x<n?M=p.x-n:p.x+p.width>n+b&&(M=p.x+p.width-n-b),M&&(g.tx(g.tx()-M),t.x-=M),p.y<a?L=p.y-a:p.y+e>a+D&&(L=p.y+e-a-D),L&&(g.ty(g.ty()-L),t.y-=L),g.beginEditing({data:V,column:d,value:g.getValue(V,d),event:w,rect:p,editorRect:t,view:g}),void 0}}}},Ht.BaseItemEditor=function(S,L,K,G){this._data=S,this._column=L,this._master=K,this._editInfo=G},It("BaseItemEditor",o,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var Jt=n.Tab=function(){fb(Jt,this)};jj("Tab",gi,{ms_ac:["view","closable","disabled","visible"],_icon:S,_closable:!1,_disabled:!1,_visible:!0,setParent:vg});var Kt=n.Column=function(){fb(Kt,this)};jj("Column",gi,{_46o:1,ms_ac:["accessType","valueType",jh,xq,Oc,ye,"align",kp,"sortOrder",Rd,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:hd,_sortFunc:S,_sortable:!0,_clickable:!0,setWidth:function(h){16>h&&(h=16);var n=this._width;this._width=h,this.fp(ye,n,h)},getToolTip:function(q,U){return this.formatValue(U.getValue(q,this))}});var Lt=n.Property=function(){fb(Lt,this)};jj("Property",gi,{_46o:1,ms_ac:["accessType","valueType",xq,Oc,"categoryName",kp,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:S,getToolTip:function(S,H,W){var X=this;return H?X.formatValue(W.getValue(S,X)):W.getPropertyName(X)}}),Ht.AccordionView=function(){var K=this;K._20o={},K._21o=new Xd,K._10o=S,K._9o=S,K._11o=S,K._view=Xk(0,K),K.iv()},It("AccordionView",o,{ms_v:1,ms_fire:1,ms_ac:[Yb,Bh,"titleHeight",Pc,Gj,"titleBackground","selectWidth",od,"orientation","separatorColor"],_expandIcon:H.accordionViewExpandIcon,_collapseIcon:H.accordionViewCollapseIcon,_titleHeight:mb,_labelColor:H.accordionViewLabelColor,_labelFont:H.accordionViewLabelFont,_titleBackground:H.accordionViewTitleBackground,_selectBackground:H.accordionViewSelectBackground,_selectWidth:H.accordionViewSelectWidth,_orientation:"v",_separatorColor:H.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(J,A,G,z){var p=this,b=ue(),T={content:A,div:b,canvas:Zj(b),icon:z};if(p._20o[J])throw J+" already exists";var F=T.downEventFunc=function(r){as(r)},$=T.upEventFunc=function(d){as(d),yp(d)&&(p._10o===J?p.collapse():p.expand(J))};[Fh,Lb].forEach(function(x){Z(b,x,F)}),[hs,Cp].forEach(function(d){Z(b,d,$)}),b.style.cursor=Fq,wf(p._view,b),p._20o[J]=T,p._21o.add(J),G&&p.expand(J),p.iv()},remove:function(x){var E=this,w=E._20o[x];if(w){var n=w.div;re(n),[Fh,Lb].forEach(function(t){N(n,t,w.downEventFunc)}),[hs,Cp].forEach(function(W){N(n,W,w.upEventFunc)}),delete E._20o[x],E._21o.remove(x),E.iv()}},clear:function(){var k=this;k._21o.toArray().forEach(k.remove,k),k._20o={},k._21o.clear(),k.iv()},isExpanded:function(b){return this._10o===b},expand:function(K){var g=this;g._20o[K]&&g._10o!==K&&(g._10o=K,g.onExpanded(K),g.iv())},onExpanded:function(){},collapse:function(){var u=this;u._10o&&(u.onCollapsed(u._10o),delete u._10o,u.iv())},onCollapsed:function(){},initCanvas:function(E,u,Y){Vj(E,u,Y);var x=ed(E);return of(x,0,0,1),x.clearRect(0,0,u,Y),x},drawTitle:function(j,r,I,q,v){var i=this,y=Fr(v.icon),K=i.isExpanded(r),t=i._titleHeight,$=i._titleBackground,A=i._selectWidth,Z=i._separatorColor,R=Fr(K?i._expandIcon:i._collapseIcon),D=A+4;Xf(j,0,0,I,q,$),K&&A&&Xf(j,0,0,A,q,i._selectBackground),(K||i._21o.get(i._21o.size()-1)!==r)&&Xf(j,0,q-1,I,1,Z?Z:Vd($)),y&&(Qp(j,y,D+lm(y)/2,t/2),D+=lm(y)+2),Qh(j,r,i.getLabelFont(r),i.getLabelColor(r),D,0,0,t),R&&Qp(j,R,I-lm(R)/2-4,t/2)},validateImpl:function(){var b=this,E=b._view,I=0,z=0,q=b.getWidth(),U=b.getHeight(),l=b._titleHeight,e=b._21o.size()*l,J=b._11o,u=b._9o;delete b._11o,delete b._9o,b._21o.each(function(Q){var t,x,v=b._20o[Q],c=v.content,r=b._10o===Q;Nl(b)?(Pg(v.div,I,0,l,U),t=b.initCanvas(v.canvas,l,U),Tc(t,0,U),ef(t,-Rr),b.drawTitle(t,Q,U,l,v),t.restore(),r?(x=g(0,q-e),c&&(b._11o=c,b._9o=Nn(c),Pg(c,I+l,0,x,U)),I+=l+x):I+=l):(Pg(v.div,0,z,q,l),t=b.initCanvas(v.canvas,q,l),b.drawTitle(t,Q,q,l,v),t.restore(),r?(x=g(0,U-e),c&&(b._11o=c,b._9o=Nn(c),Pg(c,0,z+l,q,x)),z+=l+x):z+=l)});var O=b._9o;J&&J!==b._11o&&J.endEditing&&J.endEditing(),O&&O!==u&&wf(E,O),u&&u!==O&&re(u)}}),Ht.SplitView=function(X,o,F,C){var z=this,D=z._dividerDiv=ue(),Y=z._60O=Zj(),u=z._61O=Zj(),N=Y.style,p=u.style;z._view=Xk(1,z),wf(z._view,D),N.msTouchAction=yd,N.pointerEvents=yd,N.cursor=Fq,p.msTouchAction=yd,p.pointerEvents=yd,p.cursor=Fq,X&&z.setLeftView(X),o&&z.setRightView(o),F&&z.setOrientation(F),C!=S&&z.setPosition(C),z.setStatus(si),new Mt(z)},It("SplitView",o,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:H.splitViewDividerSize,_dividerBackground:H.splitViewDividerBackground,_dragOpacity:H.splitViewDragOpacity,_toggleIcon:H.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(V,L){var r=this,u=r._position;isNaN(V)||(L||(r._82O=0>V?-1:V>1?1:0),r._position=V,r.fp(ks,u,V))},getLeftView:function(){return this._leftView},setLeftView:function(O){var t=this,I=t._leftView,D=t._view;if(t._leftView!==O){if(I&&I!==t._rightView){var Y=Nn(I);Y.parentNode===D&&re(Y)}if(t._leftView=O,O){var k=Nn(O);k.parentNode!==D&&D.insertBefore(k,t._dividerDiv)}t.fp("leftView",I,O)}},getRightView:function(){return this._rightView},setRightView:function(W){var f=this,N=f._rightView,d=f._view;if(f._rightView!==W){if(N&&N!==f._leftView){var T=Nn(N);T.parentNode===d&&re(T)}if(f._rightView=W,W){var A=Nn(W);A.parentNode!==d&&d.insertBefore(A,f._dividerDiv)}f.fp("rightView",N,W)}},validateImpl:function(){var v=this,l=v._draggable,t=v._position,I=v.getWidth(),M=v.getHeight(),O=v._dividerSize,D=v._dividerBackground,C=bc?18:8,F=v._dividerDiv,H=v._82O,d=v._60O,L=v._61O,m=v._toggleIcon,q=v._status,n=F.style,K=null,G=bc?20:4,w=m.comps[0];O>=C||0===O?v._coverDiv&&(re(v._coverDiv),delete v._coverDiv):v._coverDiv||(v._coverDiv=ue(),Ni&&(v._coverDiv.style.background=te),wf(F,v._coverDiv)),v._togglable?d.parentNode||(wf(F,d),wf(F,L)):(re(d),re(L));var p=v._coverDiv,i=v._leftView,T=v._rightView;if(Nl(v)){if(O>I&&(O=I),q===si)if(1===H)var c=_(t,I),h=g(0,I-O-c);else-1===H?(h=_(-t,I),c=g(0,I-O-h)):(c=b((I-O)*t),h=g(0,I-O-c));else"cl"===q?(c=0,h=g(0,I-O)):"cr"===q&&(h=0,c=g(0,I-O));i&&Pg(i,0,0,c,M),T&&Pg(T,c+O,0,h,M),Pg(F,c,0,O,M),v._22o=c,p&&(Pg(p,O/2-C/2,0,C,M),p.style.cursor=l?Yf:""),F.style.cursor=l?Yf:"";var R=F.clientHeight/2,s=F.clientWidth;Vj(d,s,s),Pg(d,0,R-s-G,s,s),K=ed(d),of(K,0,0,1),w.rotation=-Rr,hl(K,m,0,0,s,s),K.restore(),Vj(L,s,s),Pg(L,0,R+G,s,s),K=ed(L),of(K,0,0,1),w.rotation=Rr,hl(K,m,0,0,s,s),K.restore()}else{if(O>M&&(O=M),q===si)if(1===H)var S=_(t,M),z=g(0,M-O-S);else-1===H?(z=_(-t,M),S=g(0,M-O-z)):(S=b((M-O)*t),z=g(0,M-O-S));else"cl"===q?(S=0,z=g(0,M-O)):"cr"===q&&(z=0,S=g(0,M-O));i&&Pg(i,0,0,I,S),T&&Pg(T,0,S+O,I,z),Pg(F,0,S,I,O),v._22o=S,p&&(Pg(p,0,O/2-C/2,I,C),p.style.cursor=l?Gn:""),n.cursor=l?Gn:"";var e=F.clientWidth/2,s=F.clientHeight;Vj(d,s,s),Pg(d,e-s-G,0,s,s),K=ed(d),of(K,0,0,1),w.rotation=0,hl(K,m,0,0,s,s),K.restore(),Vj(L,s,s),Pg(L,e+G,0,s,s),K=ed(L),of(K,0,0,1),w.rotation=X,hl(K,m,0,0,s,s),K.restore()}n.background=D}});var Mt=function(C){this.sv=C,this.addListeners()};Dh(Mt,o,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(E){var q=this,$=q.sv,P=$._dividerDiv,b=$._60O,H=$._61O,d=$._status,s=E.target;if(s===b)d===si?$.setStatus("cl"):"cr"===d&&$.setStatus(si);else if(s===H)d===si?$.setStatus("cr"):"cl"===d&&$.setStatus(si);else if(Bn(E)&&(s===P||s===$._coverDiv)&&(as(E),$.isDraggable())){$.getLeftView(),$.getRightView();var R=q.maskDiv=ue();if(R.style.left=0,R.style.top=0,R.style.width=$.getWidth()+"px",R.style.height=$.getHeight()+"px",$.getView().appendChild(R),!$.isContinuousLayout()){var i=q.resizeDiv=ue();i.style.left=P.style.left,i.style.top=P.style.top,i.style.width=P.style.width,i.style.height=P.style.height,i.style.opacity=$.getDragOpacity(),i.style.background=$.getDividerBackground(),wf(q.getView(),i)}q._lastAbsPosition=$._22o,q._86o=Nl($)?Rh(E).x:Rh(E).y,xl(q,E)}},handleWindowTouchMove:function($){Bn($)&&this.update($,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(s){var E=this;E.update(s,!0),E.sv.setStatus(si),E.maskDiv&&re(E.maskDiv),E.resizeDiv&&re(E.resizeDiv),E.maskDiv=E.resizeDiv=S},handle_mousedown:function(U){yp(U)&&this.handle_touchstart(U)},handleWindowMouseMove:function(M){this.handleWindowTouchMove(M)},handleWindowMouseUp:function(m){this.handleWindowTouchEnd(m)},update:function(O,g){var W=this,u=W.sv,m=Nl(u)?u.getWidth():u.getHeight(),U=u._dividerSize,Q=W._lastAbsPosition-W._86o;Nl(u)?(Q+=Rh(O).x,Q>m-U&&(Q=m-U),0>Q&&(Q=0),W.resizeDiv&&(W.resizeDiv.style.left=Q+Kl)):(Q+=Rh(O).y,Q>m-U&&(Q=m-U),0>Q&&(Q=0),W.resizeDiv&&(W.resizeDiv.style.top=Q+Kl)),g&&m!==U&&(1===u._82O?u.setPosition(Q,1):-1===u._82O?u.setPosition(Q-m+U,1):u.setPosition(Q/(m-U),1))}}),Ht.TabView=function(){var T=this,O=T._view=Xk(1,T),D=T._91O=ue(1),A=T._tabModel=new es,h=A.sm(),q=T.invalidate;T._7o=new Xd,T._canvas=Zj(D),wf(O,D),wf(O,T._92O=ue(1)),h.setSelectionMode(lg),h.ms(T.handleSelectionChange,T),A.mm(q,T),A.mh(q,T),A.md(q,T),T._interactor=new Nt(T),T.iv()},It("TabView",o,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",Pc,Gj,"tabHPadding","tabBackground","selectWidth",od,"moveBackground","insertColor"],_tabHPadding:0,_tabPosition:Dr,_tabHeight:mb,_tabGap:H.tabViewTabGap,_labelColor:H.tabViewLabelColor,_labelFont:H.tabViewLabelFont,_tabBackground:H.tabViewTabBackground,_selectWidth:H.tabViewSelectWidth,_selectBackground:H.tabViewSelectBackground,_moveBackground:H.tabViewMoveBackground,_insertColor:H.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(v,k,u){var D,c=this._tabModel;return v instanceof Jt?(D=v,k&&D.setView(k)):(D=new Jt,D.setName(v),D.setView(k)),c.add(D),u&&c.sm().ss(D),D},getLabel:function(G){return G.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(i){this._23o=i,this.iv()},get:function(f){var x=this,q=x._tabModel;if(ff(f))return q._roots.get(f);if(xd(f)){var T;return q.each(function(u){f===x.getLabel(u)&&(T=u)}),T}return f instanceof Jt?f:S},select:function(e){this._tabModel.sm().ss(this.get(e))},remove:function(e){var F=this;if(e=F.get(e)){var R=F._tabModel,C=R._roots.indexOf(e);F._tabModel.remove(e),F.selectByIndex(--C)}},getCurrentTab:function(){return this._8o},hideTabView:function(N,y){y.parentNode===this._92O&&(pf(y)?(y.style.display=Uh,y._tab_=N):re(y),Qm())},showTabView:function(S,y){pf(y)&&(y.style.display="block",y._tab_=S),y.parentNode!==this._92O&&(wf(this._92O,y),Qm())},_24o:function(){var S,k=this,G=k._8o,b=k._9o,L=k._tabModel.sm().ld();L&&(S=Nn(L.getView())),S!==b&&(b&&(G.getView()&&G.getView().endEditing&&G.getView().endEditing(),k.hideTabView(G,b)),S&&k.showTabView(L,S)),k._8o=L,k._9o=S,G!==L&&k.onTabChanged(G,L)
},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(t,d){this.selectByIndex(--d)},selectByIndex:function(N){var o=this,Q=o._tabModel,X=Q.size();if(X&&!Q.sm().ld()){N==S&&(N=0),N>=X&&(N=X-1),0>N&&(N=0);for(var Y=N;Y>=0;Y--){var g=o.get(Y);if(!g.isDisabled())return o.select(g),g}for(Y=N+1;X>Y;Y++)if(g=o.get(Y),!g.isDisabled())return o.select(g),g}},getTabWidth:function(x){var D=this.getTabHPadding(),R=4+2*D,q=Fr(x.getIcon());q&&(R+=lm(q,x)+4);var N=this.getLabel(x);return N&&(R+=xs(this.getLabelFont(x),N).width+4),x.isClosable()&&(R+=10),R},drawTab:function(F,U,j,z,A,S,v){var b,R=this,y=R._tabPosition,I=this.getTabHPadding(),d=j+4+I,r=R._selectWidth,n=Fr(U.getIcon()),s=U.isDisabled(),t=R.getLabelColor(U),f=R.getLabelFont(U),P=R.getLabel(U),x=R._selectBackground,Q=y===Vn+"-vertical",h=y===_k+"-vertical";(Q||h)&&(d=z+4+I),s&&(F.globalAlpha=Af),Xf(F,j,z,A,S,v),U===R._8o&&r&&(y===Dr?Xf(F,j,z+S-r,A,r,x):y===Vn?Xf(F,j+A-r,z,r,S,x):y===_k?Xf(F,j,z,r,S,x):Q?Xf(F,j+A-r,z,r,S,x):h?Xf(F,j,z,r,S,x):Xf(F,j,z,A,r,x));var G=A/2;if(Q&&(Tc(F,G,z+S/2),ef(F,X),Tc(F,-G,-z-S/2)),n){var m=qj(n,U),B=lm(n,U);if(Q||h){var o=j+A/2,Z=d+m/2;Tc(F,o,Z),ef(F,Rr),Tc(F,-o,-Z),Qp(F,n,j+A/2,d+m/2,U,R),Tc(F,o,Z),ef(F,-Rr),Tc(F,-o,-Z),d+=m+4}else Qp(F,n,d+B/2,z+S/2,U,R),d+=B+4}return Q||h?(Tc(F,A/2,d+A/2),ef(F,Rr),Tc(F,-A/2,-d-A/2),Qh(F,P,f,t,j,d,S,A),Tc(F,A/2,d+A/2),ef(F,-Rr),Tc(F,-A/2,-d-A/2)):Qh(F,P,f,t,d,z,A,S),Q&&(Tc(F,G,z+S/2),ef(F,-X),Tc(F,-G,-z-S/2)),U.isClosable()&&(b=h?{x:j+A-12,y:z+S-12,width:12,height:12}:{x:j+A-12,y:z+2,width:12,height:12},this.drawCloseIcon(U,F,t,b)),s&&(F.globalAlpha=1),b},drawCloseIcon:function(g,L,C,k){var z=k.x,c=k.y;L.strokeStyle=C,L.lineWidth=1,L.beginPath(),L.moveTo(z+2,c+8),L.lineTo(z+8,c+2),L.moveTo(z+8,c+8),L.lineTo(z+2,c+2),L.stroke()},getTabAt:function(l){var k=this._interactor._8Q(l);return k?k.tab:null},validateImpl:function(){var N=this;N._24o();var S,E=N._canvas,s=N._tabPosition,u=N._91O,t=N._92O,L=N._tabModel,T=N.getWidth(),U=N.getHeight(),p=N._tabHeight,X=N._7o,G=N._tabGap,q=s===Dr,k=s===Vn,l=s===_k,e=s===Vn+"-vertical",c=s===_k+"-vertical",Y=N._23o,a=0;if((k||l)&&L._roots.each(function(b){a=g(N.getTabWidth(b),a)}),q?(Pg(u,0,0,T,p),S={x:0,y:p,width:T,height:g(0,U-p)}):k?(Pg(u,0,0,a,U),S={x:a,y:0,width:g(0,T-a),height:U}):l?(Pg(u,T-a,0,a,U),S={x:0,y:0,width:g(0,T-a),height:U}):e?(Pg(u,0,0,p,U),S={x:p,y:0,width:g(0,T-p),height:U}):c?(Pg(u,T-p,0,p,U),S={x:0,y:0,width:g(0,T-p),height:U}):(Pg(u,0,U-p,T,p),S={x:0,y:0,width:T,height:g(0,U-p)}),Pg(t,S),e||c){N._9o&&(S.x=0,Pg(N._8o.getView(),S)),Vj(E,p,U);var m=ed(E),Q=0;if(of(m,0,N.ty(),1),m.clearRect(0,0,p,U),X.clear(),L._roots.each(function(r){if(r.isVisible()){var y,h=N.getTabWidth(r);if(!Y||Y.tab!==r){var R=N.getTabBackground(r);y=N.drawTab(m,r,0,Q,p,h,R)}X.add({_75o:y,tab:r,startY:Q,endY:Q+h,height:h}),Q+=h+G}}),N._23Q=g(0,Q-G),Y){var y=Y.position;N.drawTab(m,Y.tab,0,Y.startY,p,Y.height,N._moveBackground),Xf(m,0,y,p,1,N._insertColor)}if(m.restore(),N._selectionChanged){N._selectionChanged=!1;for(var j=N.ty(),C=0;C<X.size();C++){var r=X.get(C);if(r.tab===N._8o){if(r.endY+j<0){N.ty(-r.startY);break}if(r.startY+j>U){N.ty(U-r.endY);break}}}}N.ty(N.ty())}else if(k||l){N._9o&&(S.x=0,Pg(N._8o.getView(),S)),Vj(E,a,U);var m=ed(E),Q=0;if(of(m,0,N.ty(),1),m.clearRect(0,0,a,U),X.clear(),L._roots.each(function(t){if(t.isVisible()){var f;if(!Y||Y.tab!==t){var h=N.getTabBackground(t);f=N.drawTab(m,t,0,Q,a,p,h)}X.add({_75o:f,tab:t,startY:Q,endY:Q+p,height:p}),Q+=p+G}}),N._23Q=g(0,Q-G),Y){var y=Y.position;N.drawTab(m,Y.tab,0,Y.startY,a,Y.height,N._moveBackground),Xf(m,0,y,a,1,N._insertColor)}if(m.restore(),N._selectionChanged){N._selectionChanged=!1;for(var j=N.ty(),C=0;C<X.size();C++){var r=X.get(C);if(r.tab===N._8o){if(r.endY+j<0){N.ty(-r.startY);break}if(r.startY+j>U){N.ty(U-r.endY);break}}}}N.ty(N.ty())}else{N._9o&&(S.y=0,Pg(N._8o.getView(),S)),Vj(E,T,p);var m=ed(E),J=0;if(of(m,N.tx(),0,1),m.clearRect(0,0,T,p),X.clear(),L._roots.each(function(E){if(E.isVisible()){var U,F=N.getTabWidth(E);if(!Y||Y.tab!==E){var V=N.getTabBackground(E);U=N.drawTab(m,E,J,0,F,p,V)}X.add({_75o:U,tab:E,startX:J,endX:J+F,width:F}),J+=F+G}}),N._64I=g(0,J-G),Y){var y=Y.position;N.drawTab(m,Y.tab,Y.startX,0,Y.width,p,N._moveBackground),Bk(m,N._insertColor,y,0,p)}if(m.restore(),N._selectionChanged){N._selectionChanged=!1;for(var P=N.tx(),C=0;C<X.size();C++){var r=X.get(C);if(r.tab===N._8o){if(r.endX+P<0){N.tx(-r.startX);break}if(r.startX+P>T){N.tx(T-r.endX);break}}}}N.tx(N.tx())}for(var x=[],_=t.children,C=0;C<_.length;C++){var n=_[C],w=n._tab_;w&&!L.contains(w)&&x.push(n)}x.forEach(function(C){t.removeChild(C)})}});var Nt=function(l){this.tv=l,this.addListeners()};Dh(Nt,o,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(p){this.handleScroll(p,10*(p.wheelDelta/40))},handle_DOMMouseScroll:function(t){this.handleScroll(t,10*-t.detail)},handleScroll:function(m,V){as(m);var q=this.tv,Z=q._tabPosition;!q._40o()||Z!==Dr&&Z!==Er||q.tx(this.tv.tx()+V),!q._41o()||Z!==Vn&&Z!==_k&&Z!==Vn+"-vertical"&&Z!==_k+"-vertical"||q.ty(this.tv.ty()+V)},_8Q:function(R){var b,X,v=this.tv,$=v._tabPosition,B=v._7o;if($===Dr||$===Er){var g=v.lp(R).x;for(b=0;b<B.size();b++)if(X=B.get(b),X.startX<=g&&g<=X.endX)return X}else if($===Vn||$===_k||$===Vn+"-vertical"||$===_k+"-vertical"){var J=v.lp(R).y;for(b=0;b<B.size();b++)if(X=B.get(b),X.startY<=J&&J<=X.endY)return X}return S},isClickable:function(p){var O=this.tv,q=O._tabPosition,h=this._73o=this._8Q(p);return!O._40o()||q!==Dr&&q!==Er?!O._41o()||q!==Vn&&q!==_k&&q!==Vn+"-vertical"&&q!==_k+"-vertical"?h&&(!h.tab.isDisabled()||O.isMovable()):!0:!0},handle_mousemove:function(f){var A=this;nm?A._74o=A._8Q(f):A.getView().style.cursor=A.isClickable(f)?Fq:""},handle_mousedown:function(L){this.handle_mousemove(L),this.handle_touchstart(L)},handle_touchstart:function(M){var f=this,w=f.tv,Z=w._tabPosition;as(M),yp(M)&&f.isClickable(M)&&(Z===Dr||Z===Er?(f.x=Rh(M).x,f.lp=w.lp(M),f.tx=w.tx()):(f.y=Rh(M).y,f.lp=w.lp(M),f.ty=w.ty()),xl(f,M))},handle_mouseup:function(T){this.handle_touchend(T)},handle_touchend:function(T){if(sc(T)){var k=this._73o;if(!k)return;var s=this.tv,P=s.getTabModel(),c=k.tab;if(!c.isDisabled()&&c.isClosable()){var V=function(){var D=P._roots.indexOf(c);P.remove(c),s.onTabClosed(c,D)};s.onTabClosing(c,V)&&V()}}},handleWindowMouseMove:function(X){this.handleWindowTouchMove(X)},handleWindowTouchMove:function(f){var O,J=this,Z=J.tv,q=Z._tabPosition,X=J._73o;if(q===Dr||q===Er){if(O=Rh(f).x-J.x,!J._25o&&!J.moving&&v(O)>2&&(Z._40o()&&!Uj(f)?J._25o=1:X&&Z.isMovable()&&(J.moving=1)),J._25o)Z.tx(J.tx+O);else if(J.moving){var l=J.lp.x+O,M=Z._tabGap/2;Z._7o.each(function(y){var u=y.endX,v=l-y.startX<u-l;l>=y.startX&&u>=l&&Z._7Q({tab:X.tab,startX:X.startX+O,width:X.width,front:v,insertTab:y.tab,position:v?g(0,y.startX-M):_(Z._64I,u+M)})})}}else if(O=Rh(f).y-J.y,!J._25o&&!J.moving&&v(O)>2&&(Z._41o()&&!Uj(f)?J._25o=1:X&&Z.isMovable()&&(J.moving=1)),J._25o)Z.ty(J.ty+O);else if(J.moving){var d=J.lp.y+O,M=Z._tabGap/2;Z._7o.each(function(y){var I=y.endY,H=d-y.startY<I-d;d>=y.startY&&I>=d&&Z._7Q({tab:X.tab,startY:X.startY+O,height:X.height,front:H,insertTab:y.tab,position:H?g(0,y.startY-M):_(Z._23Q,I+M)})})}},handleWindowMouseUp:function(J){this.handleWindowTouchEnd(J)},handleWindowTouchEnd:function(){var G=this,R=G.tv,H=R._tabPosition,F=R.getTabModel(),Z=F._roots,T=G._73o;if(G.moving){var w=R._23o;if(w&&w.insertTab!==w.tab){var A=w.tab,j=Z.remove(A),J=Z.indexOf(w.insertTab);J>=0&&(w.front||J++,J<=Z.size()&&(Z.add(A,J),F._38I(A,j,J)))}R._7Q(S),delete G.moving}else if(!G._25o&&T){A=T.tab;var O=G._74o;if(!O||O.tab===A)if(!A.isDisabled()&&Zk(T._75o,G.lp)){var x=function(){var C=Z.indexOf(A);F.remove(A),R.onTabClosed(A,C)};R.onTabClosing(A,x)&&x()}else A.isDisabled()||R._8o===A||F.sm().ss(A)}G._25o=G._73o=G._74o=H===Dr||H===Er?G.x=G.lp=G.tx=S:G.y=G.lp=G.ty=S}}),Ht.PropertyView=function(Q){var d=this;d._view=Xk(1,d),d._canvas=Zj(d._view),wf(d._view,d._79O=ue()),d._rows=new Xd,d._28o=new Xd,d._26o={},d._26Q={};var o=d._propertyModel=new es,c=d.ivm;o.mm(c,d),o.md(c,d),o.mh(c,d),d.dm(Q?Q:new es),new Ot(d)},It("PropertyView",o,{ms_ac:[Pc,up,Gj,xq,Oc,"categorizable",zg,Rd,_n,Yb,Bh,Kq,qc,Gh,"selectRowIndex",od,"background",pm,pi,Lm,Jn,Kf],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:kq,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:bq,_background:H.propertyViewBackground,_expandIcon:H.propertyViewExpandIcon,_collapseIcon:H.propertyViewCollapseIcon,_scrollBarColor:ar,_scrollBarSize:lj,_autoHideScrollBar:Rb,_selectBackground:H.propertyViewSelectBackground,_rowHeight:kd,_rowLineVisible:H.propertyViewRowLineVisible,_rowLineColor:H.propertyViewRowLineColor,_10I:.5,_columnLineVisible:H.propertyViewColumnLineVisible,_columnLineColor:H.propertyViewColumnLineColor,_labelColor:H.propertyViewLabelColor,_labelSelectColor:H.propertyViewLabelSelectColor,_labelFont:H.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(D){0>D&&(D=0),D>1&&(D=1);var W=this,a=W._10I;W._10I=D,W.fp("columnPosition",a,D)},getPropertyName:function(a){return a.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(C,j,q){return q===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(t,S){return S===this._selectRowIndex?this._labelSelectColor:t.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(G){var O=this.getHeight()-this._59I;return O>G&&(G=O),G>0?0:b(G)},isExpanded:function(e){if(!e)return!0;var f=this._26o[e];return f?f.isExpanded:!(this._26Q[e]===!1)},toggle:function(F){var C=this;C.isExpanded(F)?C.collapse(F):C.expand(F)},expandAll:function(){this.validate();for(var T in this._26o)this.expand(T)},expand:function(g){if(g&&g!==Uh){var n=this,F=n._26o[g];F&&!F.isExpanded&&(F.isExpanded=!0,n.onExpanded(g),n.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var l in this._26o)this.collapse(l)},collapse:function(i){if(i&&i!==Uh){var G=this,f=G._26o[i];f&&f.isExpanded&&(f.isExpanded=!1,G.onCollapsed(i),G.ivm())}},onCollapsed:function(){},getCategoryName:function(G){if(!this.isCategorizable())return Uh;var q=G.getCategoryName();return q?q:Uh},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(Z){var Q=this,B=Q._dataModel;B!==Z&&(B&&(B.umd(Q.handlePropertyChange,Q),Q._selectionModel||B.sm().ums(Q.handleSelectionChange,Q)),Q._dataModel=Z,Z.md(Q.handlePropertyChange,Q),Q._selectionModel?Q._selectionModel._21I(Z):Z.sm().ms(Q.handleSelectionChange,Q),Q.fp(hb,B,Z))},isVisible:function(q){return this._visibleFunc?this._visibleFunc(q):!0},onPropertyChanged:function(E){var r=this,K=E.property;Ct[K]?r.ivm():r.iv(),K===xi&&r._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:Ve},handlePropertyChange:function(H){this._27o===H.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var z=this;z._96I||(z.setSelectRowIndex(-1),z._96I=1,z.iv())},redraw:function(){this.iv()},validateModel:function(){var C=this,U=C._rows,u=C._28o,t={},z=new Xd,I=C._27o;C.updateCurrentData(),I!==C._27o&&C.endEditing(),U.clear(),u.clear(),C.getRawProperties().each(function(l){if(C.isVisible(l)){z.add(l);var h=C.getCategoryName(l);t[h]||(u.add(h,h===Uh?0:W),t[h]={isExpanded:C.isExpanded(h),properties:new Xd})}}),C._sortFunc&&z.sort(C._sortFunc);for(var B in C._26o)C._26Q[B]=C.isExpanded(B);C._26o=t,u.each(function(W){W!==Uh&&U.add(W);var O=t[W];O.isExpanded&&z.each(function(q){C.getCategoryName(q)===W&&(O.properties.add(q),U.add({property:q,data:C._27o}))},C)})},validateImpl:function(){var F=this;F._76o(),F._96I&&(F.validateModel(),delete F._96I);var D=F._canvas,u=F.getWidth(),s=F.getHeight(),K=-F.ty(),O=F._rowHeight,o=F._indent,g=u-o,a=F._rows,$=a.size(),d=F._9I=o+g*F._10I,I=F._59I=$*O;Vj(D,u,s),F._29I={x:0,y:K,width:u,height:s},F._31I=j(K/O),F._14I=k((K+s)/O),F._31I<0&&(F._31I=0),F._14I>$&&(F._14I=$);var z,m=ed(D),M=F._background;of(m,0,-K,1),m.beginPath(),m.rect(0,K,u,s),m.clip(),m.clearRect(0,K,u,s),F._93db(m),M&&Xf(m,0,0,o,I,M);for(var J=F._31I;J<F._14I;J++){var V=a.get(J),K=O*J;if(xd(V))M&&Xf(m,o,K,g,O,M),z=Fr(F.isExpanded(V)?F._expandIcon:F._collapseIcon),z&&xe(m,z,Eh,0,K,o,O),m.save(),m.beginPath(),m.rect(o,K,g,O),m.clip(),F.drawCategoryName(m,V,J,o,K,g,O),m.restore();else{var T=V.property,W=V.data,z=Fr(T.getIcon()),Q=F._selectRowIndex===J?F.getSelectBackground():S;if(z&&xe(m,z,Eh,0,K,o,O),Q&&Xf(m,o,K,g,O,Q),m.save(),m.beginPath(),m.rect(o,K,d-o,O),m.clip(),F.drawPropertyName(m,T,J,o,K,d-o,O),m.restore(),!F.isEditing(W,T)){var n=d+1,L=u-d-1;m.save(),m.beginPath(),m.rect(n,K,L,O),m.clip(),F._87o(F.drawPropertyValue(m,T,F.getValue(W,T),J,n,K,L,O,W),J,n,K,L,O),m.restore()}}F._rowLineVisible&&Xf(m,o,K+O-1,g,1,F._rowLineColor)}F._columnLineVisible&&(Xf(m,d,0,1,I,F._columnLineColor),Xf(m,u-1,0,1,I)),F._92db(m),F._93I(),m.restore(),F.ty(F.ty())},drawCategoryName:function(c,e,v,R,N,l,w){Qh(c,e,this.getCategoryFont(e),this.getCategoryColor(e),R,N,l,w)},drawPropertyName:function(z,g,V,J,v,K,b){return g.drawPropertyName?(g.drawPropertyName(z,g,V,J,v,K,b,this),void 0):(Qh(z,this.getPropertyName(g),this.getPropertyFont(g,V),this.getPropertyColor(g,V),J,v,K,b),void 0)},drawPropertyValue:function(m,b,W,$,O,X,e,I,J){return b.drawPropertyValue?b.drawPropertyValue(m,b,W,$,O,X,e,I,J,this):(Et(m,W,b,this.getLabelFont(b,W,$),this.getLabelColor(b,W,$),O,X,e,I,J,this),void 0)},isPropertyEditable:function(O){return O.isEditable()&&this.isEditable()},setProperties:function(R){this._propertyModel.clear(),this.addProperties(R)},addProperties:function(b){if(b){var H=this._propertyModel;b.forEach(function(j){if(!(j instanceof Lt)){var F=td(j.className);j=zr(F?F:Lt,j)}H.add(j)})}},getRowIndexAt:function(l){var H=this,c=j(H.lp(l).y/H._rowHeight);return c>=0&&c<H._rows.size()?c:-1},getPropertyAt:function(l){var s=this,y=s.getRowIndexAt(l);return y>=0?s._rows.get(y).property:S},getToolTip:function(U){var D=this,b=D.getPropertyAt(U),g=D._27o;return b&&g?b.getToolTip(g,D._9I<D.lp(U).x,D):S}});var Ot=function(p){this.pv=p,this.addListeners()};Dh(Ot,o,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(Q){this.getView().style.cursor=Q},clear:function(){var M=this;M._62O=M.cp=M.ty=M.p=S,M.setCursor(Bg)},handle_mousedown:function(O){this.handle_touchstart(O)},handle_touchstart:function(k){var F=this,c=F.pv;as(k),c.setFocus(k)&&(yp(k)?(F.cp=Rh(k),F.ty=c.ty(),F.p=c.getColumnPosition(),F.handle_touchmove(k)):c.setSelectRowIndex(c.getRowIndexAt(k)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(o){this.handle_touchend(o)},handle_touchend:function(Q){var L=this;if(L.cp&&!L._62O){var n=L.pv,W=n.lp(Q),X=W.x,u=W.y,T=n._indent,V=n.getRowIndexAt(Q),w=n._9I;if(V>=0){var h=n._rowHeight,g=h*V,N=n._rows.get(V),C=N.property;if(xd(N))Fr(n.isExpanded(N)?n._expandIcon:n._collapseIcon)&&X>=0&&T>=X&&u>=g&&g+h>=u?n.toggle(N):tg(Q)&&n.toggle(N);else if(X>w&&n.isPropertyEditable(C,Q)){var U={x:w+1,y:g,width:n.getWidth()-w-1,height:h},f={x:U.x+n.tx(),y:U.y+n.ty(),width:U.width,height:U.height},t=0,S=n._29I;U.y<S.y?t=U.y-S.y:U.y+h>S.y+S.height&&(t=U.y+h-S.y-S.height),t&&(n.ty(n.ty()-t),f.y-=t),n.beginEditing({data:N.data,property:C,value:n.getValue(N.data,C),event:Q,rect:U,editorRect:f,view:n})}}n.setSelectRowIndex(V)}L.clear()},handleWindowMouseMove:function(w){this.handleWindowTouchMove(w)},handleWindowTouchMove:function(K){var M=this,c=M.pv,Z=M.ty,F=M.cp,f=Rh(K),I=M._62O;if("p"===I)c.setTranslateY(Z+f.y-F.y);else if("c"===I){var g=c.getWidth()-c._indent;if(g>16){var C=M.p-(F.x-f.x)/g,V=16/g;V>C&&(C=V),C>1-V&&(C=1-V),c.setColumnPosition(C)}}else"s"===I&&c.setTranslateY(Z+(F.y-f.y)*c._59I/c._29I.height)},handle_mousemove:function(s){this.handle_touchmove(s)},handle_touchmove:function(S){if(!nm&&yp(S)){var R=this,g=R.pv,L=v(g.lp(S).x-g._9I)<=(bc?8:3);R.cp?R._62O||(L?(R._62O="c",xl(R,S)):v(Rh(S).y-R.cp.y)>=2&&(R._62O=R.isV(S)?"s":"p",xl(R,S))):(L?R.setCursor(Yf):R.setCursor(Bg),R.isV(S)&&g._43o())}},isV:function(U){var E=this.pv,x=E._29I;return E._41o()&&x.x+x.width-E.lp(U).x<ii},handle_mousewheel:function(j){this.handleScroll(j,j.wheelDelta/40)},handle_DOMMouseScroll:function(n){2===n.axis&&this.handleScroll(n,-n.detail)},handleScroll:function(g,G){var E=this.pv;as(g),E.endEditing(),E.translate(0,G*E.getRowHeight())},handle_keydown:function(A){var y=this.pv,r=y._rows.size(),f=y._selectRowIndex+(dl(A)?-1:1);(dl(A)||Se(A))&&(0>f&&(f=0),f>=r&&(f=r-1),y.setSelectRowIndex(f))}}),Ht.ListView=function(A){this._5o(A),new Pt(this)},It("ListView",o,{ms_ac:[Pc,up,Gj,pm,zg,pi,Lm,Rd,_n,Kq,qc,Gh,ib,od],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:bq,_rowHeight:kd,_rowLineVisible:H.listViewRowLineVisible,_rowLineColor:H.listViewRowLineColor,_scrollBarColor:ar,_scrollBarSize:lj,_autoMakeVisible:Oq,_autoHideScrollBar:Rb,_selectBackground:H.listViewSelectBackground,_labelColor:H.listViewLabelColor,_labelSelectColor:H.listViewLabelSelectColor,_labelFont:H.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(P){var t=this,k=t._checkMode;t._checkMode=P,t.fp(Zm,k,P)},drawRow:function(_,N,e,j,I,F,y){var u=this,C=0,P=u._indent,Z=u.getIconWidth(N);u.drawRowBackground(_,N,e,j,I,F,y),u._checkMode&&(Qp(_,Fr(u.getCheckIcon(N)),C+P/2,I+y/2,N,u),C+=P),u.drawIcon(_,N,C,I,Z,y),u.drawLabel(_,N,C+Z,I,y)}});var Pt=function(f){this.list=f,this.addListeners()};Dh(Pt,o,{ms_listener:1,getView:function(){return this.list._view},clear:function(d){var h=this,y=h.list;d&&"d"===h._62O&&!h.dragCancel&&y.handleDragAndDrop(d,"end"),y.draggingData&&(y.draggingData=null,y.redraw()),h.dragCancel=h._62O=h._isV=h._isH=h.cp=h.tx=h.ty=S},handle_mousedown:function(L){this.handle_touchstart(L)},handle_touchstart:function(w){var x=this,q=x.list;if(as(w),q.setFocus(w)){var l=q.getDataAt(w);x.cp=Rh(w),x.tx=q.tx(),x.ty=q.ty(),yp(w)?l&&q.handleDragAndDrop&&!x.isV(w)&&!x.isH(w)&&(q.draggingData=l,q.redraw(),q.handleDragAndDrop(w,"prepare")):(l?x._33o(w,l):this._cancelDataDoubleSelect(),x.clear(w))}},handleWindowMouseUp:function(O){this.clear(O)},handleWindowTouchEnd:function(c){this.clear(c)},handle_mouseup:function(z){this.handle_touchend(z)},handle_touchend:function(Q){var w=this,d=w.list;if(!w._isV&&!w._isH&&w.cp&&!w._62O){var m=d.getDataAt(Q);m?(d.isCheckMode()?w._34o(Q,m):w._33o(Q,m),tg(Q)?d.onDataDoubleClicked(m,Q):d.onDataClicked(m,Q)):(w._cancelDataDoubleSelect(),d.handleBackgroundClick(Q))}w.clear(Q)},handleWindowMouseMove:function(Z){this.handleWindowTouchMove(Z)},handleWindowTouchMove:function(N){var c=this,i=c.list,L=c._62O,n=c.tx,j=c.ty,z=c.cp,d=Rh(N),Z=i._29I;"p"===L?i.setTranslate(n+d.x-z.x,j+d.y-z.y):"v"===L?i.ty(j+(z.y-d.y)*i._59I/Z.height):"h"===L?i.tx(n+(z.x-d.x)*i._91I/Z.width):"d"===L&&(c.dragCancel||i.handleDragAndDrop(N,"between"))},handle_mousemove:function(K){this.handle_touchmove(K)},handle_touchmove:function(u){if(!nm&&yp(u)){var H=this,y=H.list;if(H._isV=H.isV(u),H._isH=H.isH(u),H.cp){if(!H._62O){if(_h(Rh(u),H.cp)<2)return;H._isV?H._62O="v":H._isH?H._62O="h":y.draggingData&&!this.dragCancel?(H._62O="d",y.handleDragAndDrop(u,"begin")):H._62O="p",H._62O&&"d"!==H._62O&&y.draggingData&&(y.draggingData=null,y.redraw()),xl(H,u)}}else H._isV&&y._43o(),H._isH&&y._42o()}},isV:function(i){var v=this.list,y=v._29I;return v._41o()&&y.x+y.width-v.lp(i).x<ii},isH:function(V){var N=this.list,t=N._29I;return N._40o()&&t.y+t.height-N.lp(V).y<ii},handle_mousewheel:function(P){this.handleScroll(P,P.wheelDelta/40,P.wheelDelta!==P.wheelDeltaX)},handle_DOMMouseScroll:function(F){this.handleScroll(F,-F.detail,1)},handleScroll:function(n,U,r){var o=this.list;as(n),o.endEditing&&o.endEditing(),r&&o._41o()?o.translate(0,U*o.getRowHeight()):o._40o()&&o.translate(10*U,0)},handle_keydown:function(V){if(!H.isInput(V.target)){var m,q=this.list,x=q.sm(),e=q._rows,Z=e.size();if(xo(V))q.selectAll();else if(zn(V))q.handleDelete&&q.handleDelete(V);else if(Jr(V))"d"!==this._62O||this.dragCancel||(q.handleDragAndDrop(V,"cancel"),this.dragCancel=!0);else if(vr(V))q.isCheckMode()&&(m=q.getFocusData(),m&&q.checkData(m));else if(dl(V)||Se(V)){var k=q.isCheckMode();if(m=k?q.getFocusData():x.ld()){var N=q.getRowIndex(m);N>=0&&(dl(V)?0!==N&&(m=e.get(N-1),k?q.setFocusData(m):x.ss(m)):N!==Z-1&&(m=e.get(N+1),k?q.setFocusData(m):x.ss(m)))}else Z>0&&(m=e.get(0),k?q.setFocusData(m):x.ss(m))}}},_34o:function(u,E){var y=this.list,o=y.lp(u).x;return o>=0&&o<=y._indent?(y.checkData(E),void 0):(y.setFocusData(E),void 0)},_33o:function(E,x){var X=this.list,y=X.sm(),G=y.ld();if(!X.canHandleSelectMode(E,x))return this._cancelDataDoubleSelect(),void 0;if(Uj(E))X.isSelected(x)?y.rs(x):y.as(x);else if(nr(E))if(G)for(var K=X.getRowIndex(G),i=X.getRowIndex(x);K!==i;)K+=i>K?1:-1,y.as(X._rows.get(K));else y.ss(x);else yp(E)?(y.contains(x)?X.handleDataDoubleSelect&&(this._handleDataDoubleSelect(E,x),tg(E)&&this._cancelDataDoubleSelect()):this._cancelDataDoubleSelect(),y.ss(x)):y.contains(x)||y.ss(x)},_handleDataDoubleSelect:function(M,E){this._cancelDataDoubleSelect(),this._doubleSelectTimer=Yk(function(){this.list.handleDataDoubleSelect(M,E),this._doubleSelectTimer=W}.bind(this),H.doubleClickSpeed)},_cancelDataDoubleSelect:function(){this._doubleSelectTimer&&(gp(this._doubleSelectTimer),this._doubleSelectTimer=W)}}),Ht.TreeView=function(W){var a=this;a._35o(),a._5o(W),new Qt(a)},It("TreeView",o,{ms_ac:[Pc,up,Gj,"rootVisible",Zm,"rootData",Rd,_n,Kq,qc,Gh,zg,pm,pi,Lm,Yb,Bh,ib,od,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:S,_indent:bq,_rowHeight:kd,_rowLineVisible:H.treeViewRowLineVisible,_rowLineColor:H.treeViewRowLineColor,_scrollBarColor:ar,_scrollBarSize:lj,_autoHideScrollBar:Rb,_expandIcon:H.treeViewExpandIcon,_collapseIcon:H.treeViewCollapseIcon,_autoMakeVisible:Oq,_selectBackground:H.treeViewSelectBackground,_labelColor:H.treeViewLabelColor,_labelSelectColor:H.treeViewLabelSelectColor,_labelFont:H.treeViewLabelFont,_doubleClickToToggle:H.treeViewDoubleClickToToggle,drawRow:function(t,r,h,W,Z,M,N){var O=this;O.drawRowBackground(t,r,h,W,Z,M,N),O.drawTree(t,r,h,0,Z,M,N)},isOnToggleIcon:function(m){var n=this.getDataAt(m);if(n){var w=this.getIndent(),o=this.lp(m).x;if(Fr(this.getToggleIcon(n))){var g=w*this.getLevel(n);if(o>=g&&g+w>=o)return!0}}return!1}});var Qt=function(Q){fb(Qt,this,[Q])};Dh(Qt,Pt,{toggle:function(f,u,R,G){var J=this.list,M=J.lp(f).x;if(Fr(J.getToggleIcon(u))){var n=R*G;if(M>=n&&n+R>=M)return J.toggle(u),!0}return J.isDoubleClickToToggle()&&tg(f)?(J.toggle(u),!0):!1},_34o:function(E,l){var f=this.list,K=f.lp(E).x,X=f._levelMap[l._id],F=f._indent,Z=F*(X+1);return K>=Z&&Z+F>=K?(f.checkData(l),void 0):(this.toggle(E,l,F,X)||f.setFocusData(l),void 0)},_33o:function(X,a){var $=this,f=$.list;if(!$.toggle(X,a,f._indent,f.getLevel(a)))if(nr(X)){var i=f.sm();if(i.size()>0){for(var q=f._rows,p=null,M=0,D=q.size();D>M;M++)if(f.isSelected(q.get(M))){p=M;break}for(var x=null,M=q.size()-1;M>=0;M--)if(f.isSelected(q.get(M))){x=M;break}var W,v,S=f.getRowIndex(a);for(p>S?(W=S-1,v=p):S>x?(W=x,v=S):(W=p,v=x);W!==v;)W++,i.as(f._rows.get(W))}else i.ss(a)}else Qt.superClass._33o.call($,X,a)},handle_keydown:function(Z){if(Lp(Z)||Nr(Z)){var r=this.list,E=r._rows,g=r.isCheckMode(),B=r.sm(),s=g?r.getFocusData():B.ld();s?s.hasChildren()&&(Lp(Z)?r.collapse(s):r.expand(s)):E.size()>0&&(s=E.get(0),g?r.setFocusData(s):B.ss(s))}else Qt.superClass.handle_keydown.call(this,Z)}});var Rt=Ht.TableView=function(D){this._98I(),this._5o(D),new St(this)};It("TableView",o,{ms_ac:[Pc,up,Gj,"sortMode",xq,Oc,pm,pi,Lm,Jn,Kf,"sortColumn",Rd,_n,Kq,qc,Gh,ib,od],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:hm,_editable:!0,_batchEditable:!1,_rowHeight:kd,_rowLineVisible:H.tableViewRowLineVisible,_rowLineColor:H.tableViewRowLineColor,_columnLineVisible:H.tableViewColumnLineVisible,_columnLineColor:H.tableViewColumnLineColor,_scrollBarColor:ar,_scrollBarSize:lj,_autoHideScrollBar:Rb,_autoMakeVisible:Oq,_selectBackground:H.tableViewSelectBackground,_labelColor:H.tableViewLabelColor,_labelSelectColor:H.tableViewLabelSelectColor,_labelFont:H.tableViewLabelFont,getCheckColumn:function(){var O=this;if(!O._31o){var q=O._31o=new Kt;q.setEditable(!0),q.setWidth(40),q.getValue=O.getCheckColumValue,q.drawCell=O.drawCheckColumnCell}return O._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(s){var I=this,L=I._39o,x=I.getCheckColumn();s!==I.isCheckMode()&&(s?L.add(x,0):L.remove(x),I.fp(Zm,!s,s))},getCheckColumValue:function(U,s,N){return N.isSelected(U)},drawCheckColumnCell:function(J,r,W,Z,D,Q,U,i,S){Qp(J,S.getCheckIcon(r),D+U/2,Q+i/2,r,S)}});var St=function(Z){fb(St,this,[Z])};Dh(St,Pt,{_34o:function(h,_){var c=this.list,V=c._31o;if(c.isCellEditable(_,V,h)){var E=c._3Q(V),o=c.lp(h).x;if(E&&o>=E.startX&&o<E.startX+V.getWidth())return c.checkData(_),void 0}c._37O(_,h),c.setFocusData(_)},_33o:function(h,s){this.list._37O(s,h),St.superClass._33o.apply(this,arguments)}});var Tt=Ht.TreeTableView=function(S){var m=this,K=m._4o=new Kt;m._35o(),m._98I(),m._5o(S),K.setDisplayName("Name"),K.setEditable(!0),K.setWidth(180),K.drawCell=Ut,K.getValue=Vt,m._39o.add(K),new Wt(m)},Ut=function(b,j,O,B,l,f,i,W,I){I.drawTree(b,j,O,l,f,i,W)},Vt=function(W,p,o){return o.getLabel(W)};It("TreeTableView",o,{ms_ac:[Pc,up,Gj,"sortMode",xq,Oc,zg,Zm,"rootData","rootVisible",Rd,_n,"sortColumn",Yb,Bh,Kq,qc,Gh,ib,Lm,pm,pi,Jn,Kf,od,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:hm,_checkMode:S,_editable:!0,_batchEditable:!1,_indent:bq,_rowHeight:kd,_rowLineVisible:H.treeTableViewRowLineVisible,_rowLineColor:H.treeTableViewRowLineColor,_columnLineVisible:H.treeTableViewColumnLineVisible,_columnLineColor:H.treeTableViewColumnLineColor,_expandIcon:H.treeTableViewExpandIcon,_collapseIcon:H.treeTableViewCollapseIcon,_scrollBarColor:ar,_scrollBarSize:lj,_autoHideScrollBar:Rb,_autoMakeVisible:Oq,_selectBackground:H.treeTableViewSelectBackground,_labelColor:H.treeTableViewLabelColor,_labelSelectColor:H.treeTableViewLabelSelectColor,_labelFont:H.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var Wt=function(v){fb(Wt,this,[v])};Dh(Wt,Pt,{_34o:function(F,j){var i=this.list,b=i._4o,P=i._3Q(b),L=i.lp(F).x;if(P){var f=i._indent,E=P.startX+f*i.getLevel(j);if(Fr(i.getToggleIcon(j))&&L>=E&&E+f>=L)return i.toggle(j),void 0;if(i.isCellEditable(j,b)&&(E+=f,L>=E&&E+f>=L))return i.checkData(j),void 0}i._37O(j,F),i.setFocusData(j)},_33o:function(b,f){var i=this.list,G=i.lp(b).x;if(Fr(i.getToggleIcon(f))){var g=i._3Q(i._4o);if(g){var R=i._indent,L=g.startX+R*i.getLevel(f);if(G>=L&&L+R>=G)return i.toggle(f),void 0}}i._37O(f,b),Wt.superClass._33o.apply(this,arguments)}});var Xt=Ht.TableHeader=function(M){var C=this,W=C._view=Xk(1,C),c=C._39o=M.getColumnModel(),Q=C.iv;C.tv=C._tableView=M,C._60I=new Xd,C._canvas=Zj(W),W.style.background=H.tableHeaderBackground||"",W.style.height=yl+Kl,c.mm(Q,C),c.md(Q,C),c.mh(Q,C),M.mp(function(t){yt[t.property]&&C.iv()},C),new Yt(C),C.iv()};It("TableHeader",o,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",Pc,Gj,zg,"moveBackground","insertColor",Jn,Kf,"resizable","movable"],_checkIcon:ub,_movable:!0,_resizable:!0,_labelColor:H.tableHeaderLabelColor,_labelFont:H.tableHeaderLabelFont,_columnLineColor:H.tableHeaderColumnLineColor,_columnLineVisible:H.tableHeaderColumnLineVisible,_sortDescIcon:H.tableHeaderSortDescIcon,_sortAscIcon:H.tableHeaderSortAscIcon,_moveBackground:H.tableHeaderMoveBackground,_insertColor:H.tableHeaderInsertColor,_indent:bq,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(H){return H.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(v){return v.getColor()||this._labelColor},getLabelAlign:function(i){return i._align},onPropertyChanged:function(){this.iv()},_5Q:function(O){this._61I=O,this.iv()},getLogicalPoint:function(G){return Ib(G,this._canvas,this.tv.tx())},validateImpl:function(){var Y=this,g=Y._canvas,l=Y.getWidth(),o=Y.getHeight(),k=Y.tv,y=Y._60I,u=Y._61I,d=-k.tx(),p=0;(l!==g.clientWidth||o!==g.clientHeight)&&Vj(g,l,o),y.clear(),Y._39o._roots.each(function(b){if(b.isVisible()){var C=p+b.getWidth();d+l>=p&&C>=d&&y.add({column:b,startX:p}),p=C}});var V=ed(g);if(of(V,-d,0,1),V.beginPath(),V.rect(d,0,l,o),V.clip(),V.clearRect(d,0,l,o),y.each(function(J){var d=J.column,R=J.startX,P=d.getWidth();P>0&&(V.save(),V.beginPath(),V.rect(R,0,P,o),V.clip(),u&&u.column===d||Y.drawColumn(V,d,R,0,P,o),Y._columnLineVisible&&Xf(V,R+P-1,0,1,o,Y._columnLineColor),V.restore())}),u){var O=u.column,p=u.startX,R=u.position,F=O.getWidth();V.save(),V.beginPath(),V.rect(p,0,F,o),V.clip(),V.fillStyle=Y._moveBackground,V.fill(),Y.drawColumn(V,O,p,0,F,o),V.restore(),Bk(V,Y._insertColor,R,0,o)}V.restore()},_6Q:function(S){var y=this.tv;return y._31o===S&&y.sm().getSelectionMode()===Rm},drawColumn:function(M,L,C,u,o,H){var J=this,I=J.tv,E=Fr(L.getIcon()),D=J.getLabelAlign(L);if(J._6Q(L)){var Y=Fr(J._checkIcon);Qp(M,Y,C+o/2,u+H/2,L,J)}else{var s=J.getLabel(L),e=J.getLabelFont(L),A=J.getLabelColor(L),c=xs(e,s).width,g=E?J._indent:0;D===Vn?(E&&xe(M,E,Eh,C,u,g,H),Qh(M,s,e,A,C+g,u,o,H,Vn)):D===_k?(E&&xe(M,E,Eh,C+o-c-g,u,g,H),Qh(M,s,e,A,C,u,o,H,_k)):(E&&xe(M,E,Eh,C+(o-c-g)/2,u,g,H),Qh(M,s,e,A,C+(o-c+g)/2,u,0,H,Vn))}if(L.isSortable()&&I.getSortColumn()===L&&(E=Fr(L.getSortOrder()===hd?J._sortAscIcon:J._sortDescIcon))){var i=lm(E,L)/2+2;Qp(M,E,D===_k?C+i:C+o-i,u+H/2,L,I)}}});var Yt=function(k){var M=this;M.th=k,M.tv=k._tableView,M.addListeners()};Dh(Yt,o,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(w){this.getView().style.cursor=w},handle_mousemove:function(n){if(!nm){var G=this;delete G._29o,G.setCursor(Bg);for(var I=G.th,j=I._60I,M=I.lp(n).x,i=j.size()-1;i>=0;i--){var s=j.get(i),w=s.column,U=s.startX+w.getWidth();if(I.isResizable()&&v(U-M)<=(bc?10:3))return G._29o=s,G.setCursor(Yf),void 0;M>s.startX&&U>M&&(G._29o=s),(w.isClickable()||w.isSortable()||I.isMovable()||G.tv.getCheckColumn&&w===G.tv.getCheckColumn())&&M>s.startX&&U>M&&G.setCursor(Fq)}}},handle_mousedown:function(q){this.handle_touchstart(q)},handle_touchstart:function(n){var $=this;as(n),$.tv.endEditing(),$.handle_mousemove(n),$._29o&&($.x=Rh(n).x,$.lx=$.th.lp(n).x,$.w=$._29o.column.getWidth(),xl($,n))},handleWindowMouseMove:function(p){this.handleWindowTouchMove(p)},handleWindowTouchMove:function(L){var D=this,_=D.th,O=D.getView().style.cursor,u=D._29o,z=Rh(L).x-D.x;if(D.resizing||D.moving||(O===Yf?D.resizing=1:_.isMovable()&&O===Fq&&v(z)>2&&(D.moving=1)),D.resizing)u.column.setWidth(D.w+z);else if(D.moving){var x=D.lx+z;_._60I.each(function(F){var j=F.startX,Q=j+F.column.getWidth();if(x>=j&&Q>=x){var r={column:u.column,startX:u.startX+z,front:Q-x>x-j,insertColumn:F.column};r.position=r.front?j:Q,_._5Q(r)}})}},_16Q:function(b,U){var j=this,y=j.tv,i=j.th,K=i._checkIcon;if(i._6Q(b)){var d=Fr(K),I=j.lx,n=b.getWidth(),W=lm(d,b);if(I>=U+n/2-W&&U+n/2+W>=I){i.setCheckIcon(K===os?ub:os);var u=y.sm(),V=y._rows;return K===os?u.rs(V):u.ss(V),y.onCheckColumnClicked(b),!0}}return!1},handleWindowMouseUp:function(k){this.handleWindowTouchEnd(k)},handleWindowTouchEnd:function(U){var n=this,p=n.tv,e=n.th,Y=n._29o;
if(n.moving){var A=e._61I;if(A&&A.insertColumn!==A.column){var b=A.column,r=p.getColumnModel()._roots,X=r.remove(b),B=r.indexOf(A.insertColumn);B>=0&&(A.front||B++,B<=r.size()&&(r.add(b,B),p.getColumnModel()._38I(b,X,B)))}e._5Q(S),delete n.moving}else if(!n.resizing&&Y){b=Y.column;var W=e.lp(U).x,u=Y.startX,w=!0;if(e.onColumnClicked){var R=e.onColumnClicked(b,U,u);R===!1&&(w=!1)}if(w&&W>=u&&W<=u+b.getWidth()&&!n._16Q(b,u)){if(b.isSortable()){var P=p.getSortMode(),Q=b.getSortOrder();P===hm?p.getSortColumn()===b?(Q===$d&&p.setSortColumn(S),b.setSortOrder(Q===hd?$d:hd)):p.setSortColumn(b):"bistate"===P&&(p.getSortColumn()===b?b.setSortOrder(Q===hd?$d:hd):p.setSortColumn(b))}p.onColumnClicked(b,U,u)}}n._29o=n.resizing=n.x=n.lx=n.w=S}}),Ht.TablePane=function(L){this.init(new Rt(L))},It("TablePane",o,{ms_v:1,_44o:1}),Ht.TreeTablePane=function(e){this.init(new Tt(e))},It("TreeTablePane",o,{ms_v:1,_44o:1}),Ht.Toolbar=function(_){var d=this,t=d._view=Xk(1,d),b=t.style;b.background=H.toolbarBackground||"",b.height=mb+Kl,d._canvas=Zj(t),d._30o=new Xd,d._90I=new Xd,d.setItems(_||[]),t.handleGroupSelectedChanged=function(z){if(z.isSelected()){var f=z.getGroupId();null!=f&&d._items.forEach(function(S){var q=S.element;q&&q!==z&&q.setSelected&&q.getGroupId&&q.getGroupId()===f&&q.setSelected(!1)})}},new Zt(d)},It("Toolbar",o,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[le,Pc,Gj,up,od,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:H.toolbarLabelColor,_labelSelectColor:H.toolbarLabelSelectColor,_labelFont:H.toolbarLabelFont,_selectBackground:H.toolbarSelectBackground,_itemGap:H.toolbarItemGap,_separatorColor:H.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(H){var p=this.getItemInfoAt(H);return p?p.item.toolTip:S},getLabelColor:function(y){return y&&y.selected&&y.type!==os&&y.type!==Le?this._labelSelectColor:this._labelColor},onPropertyChanged:function(v){this.iv(),v.property===le&&this._items.forEach(function(b){bb(b)})},redraw:function(){this.iv()},addItem:function(_,i){var Y=this._items;i==S?Y.push(_):Y.splice(i,0,_),this.fp(le,S,Y)},removeItem:function(M){if(M)for(var G=this._items,C=0;C<G.length;C++)M===G[C]&&(G.splice(C,1),this.fp(le,S,G))},removeItemById:function(t){if(t!=S)for(var Z=this._items,R=0;R<Z.length;R++)if(t===Z[R].id){var P=Z.splice(R,1)[0];return this.fp(le,S,Z),P}},getItemById:function(B){if(B!=S)for(var F=this._items,Z=0;Z<F.length;Z++){var Q=F[Z];if(B===Q.id)return Q}},setItemVisible:function(D,v){var o=this.getItemById(D);o&&(o.visible=v)},getItemInfos:function(){return this._30o},getItemInfoAt:function(a){var v=this,A=0,h=v._30o,F=v.lp(a),e=F.x,Q=F.y;if(Q>=0&&Q<=v.getHeight())for(;A<h.size();A++){var j=h.get(A);if(j.startX<=e&&e<=j.endX)return j}return S},drawItem:function(r,q,f,d,Z){if(q.visible===!1)return 0;if(Qj(q.visible)&&!q.visible())return 0;var W=this,L=q.disabled;L&&(r.globalAlpha=Af);var H=W.drawItemImpl(r,q,f,d,Z),s=W._itemGap;return L&&(r.globalAlpha=1),this._currentItem!==q||"separator"===q||q.separator===!0||q.unfocusable||Qd(r,W._separatorColor,f-s/2,0,H+s,d),H},drawItemImpl:function(y,u,i,E,v){var J=this,r=J._view,z=J._itemGap,l=E/2,s=u.type,K=u.element,M=u.label;xd(K)&&(M=K,K=S);var n,$=J.getLabelFont(u),_=J.getLabelColor(u),t=u.selected,F=Fr(u.icon),G=lm(F,u),Q=0,C=G+(M?xs($,M).width:0);if("separator"===u||u.separator===!0)return Bk(y,J._separatorColor,i,E/4,l),1;if(K){F&&Qp(y,F,i+G/2,l,u,J),Qh(y,M,$,_,i+G,0,0,E);var p=Nn(K);v||J._90I.add(p),p.parentNode!==r&&wf(r,p),K.iv&&K.iv(),K.validate&&K.validate();var D=p.getBoundingClientRect(),e=D.width,B=p.style;return vp(p),B.left=J.tx()+i+C+Kl,B.top=(E-D.height)/2+Kl,C+e}return s===Le?n=Fr(t?eb:Bl):s===os&&(n=Fr(t?os:ub)),n?(Q=lm(n,u),Qp(y,n,i+Q/2,l,u,J),i+=Q,C+=Q):t&&Xf(y,i-z/2,0,C+z,E,J.getSelectBackground(u)),F&&Qp(y,F,i+G/2,l,u,J),Qh(y,M,$,_,i+G,0,0,E),C},validateImpl:function(){var k=this,F=k._canvas,B=k.getWidth(),_=k.getHeight(),W=k._30o,j=k._items;Vj(F,B,_);var d=ed(F),w=k._itemGap,h=w/2;of(d,k.tx(),0,1),d.clearRect(0,0,B,_);var i=k._90I;k._90I=new Xd,W.clear(),j.forEach(function(Z){var e=k.drawItem(d,Z,h,_);W.add({item:Z,startX:h,endX:h+e,width:e}),e&&(h+=e+w)}),i.each(function(w){k._90I.contains(w)||re(w)});var u=k._64I;k._64I=g(0,h-w/2),d.restore(),k._stickToRight?(k._65O=0,d=ed(F),h=B-k._64I+w/2,of(d,0,0,1),d.clearRect(0,0,B,_),W.clear(),j.forEach(function(x){var I=k.drawItem(d,x,h,_,!0);W.add({item:x,startX:h,endX:h+I,width:I}),I&&(h+=I+w)}),d.restore()):k.tx(k.tx()),u!==k._64I&&k.onSumWidthChanged(u,k._64I)},onSumWidthChanged:function(){},handleClick:function($,m){var g=this,n=$.type,l=$.action,Z=$.groupId,s=$.selected;$.disabled||(Z!=S?s||($.selected=!0,this._items.forEach(function(_){_.groupId===Z&&$!==_&&(_.selected=!1)}),l&&$.action($,g,m)):n===os||"toggle"===n?($.selected=!s,l&&$.action($,g,m)):l&&$.action($,g,m)),Qm(),g.iv()}});var Zt=function($){this.tb=$,this.addListeners()};Dh(Zt,o,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(U){this.handleScroll(U,10*(U.wheelDelta/40))},handle_DOMMouseScroll:function(z){this.handleScroll(z,10*-z.detail)},handleScroll:function(k,T){as(k);var Y=this.tb;Y.isScrollable()&&!Y._stickToRight&&(Y.tx(Y.tx()+T),An())},handle_mousemove:function(c){var s=this;nm||s.setItem(c)},handle_mouseout:function(l){var F=this;l.target===F.getView()?F.tb.setCurrentItem(S):F.handle_mousemove(l)},handle_mousedown:function(P){this.handle_mousemove(P),this.handle_touchstart(P)},handle_touchstart:function(I){var Z=this,N=Z.tb,e=I.target;yp(I)&&(e===Z.getView()||e===N._canvas)&&(as(I),N.setFocus(I)&&(this.setItem(I,!0),(N.isScrollable()||Z.info&&!Z.info.item.disabled)&&(Z.x=Rh(I).x,Z.tx=N.tx(),xl(Z,I))))},handleWindowMouseMove:function(C){this.handleWindowTouchMove(C)},handleWindowTouchMove:function(g){var x=this,l=x.tb;if(!l._stickToRight){var F=Rh(g).x-x.x;!x._25o&&v(F)>2&&l.isScrollable()&&(x._25o=1),x._25o&&l.tx(x.tx+F)}},handleWindowMouseUp:function(x){this.handleWindowTouchEnd(x)},handleWindowTouchEnd:function(N){var i=this,l=i.tb,P=i.info,V=i.tb.getItemInfoAt(N);if(!i._25o&&P){var b=P.item;V&&V.item===b&&l.handleClick(b,N)}i._25o=i.x=i.tx=S,i.setItem()},setItem:function(P,v){var u=this,p=u.tb,X=u.info=P?p.getItemInfoAt(P):S,o=X?X.item:S;p.setCurrentItem(o),v&&o&&Qj(o.onDown)&&o.onDown(P)}}),Ht.BorderPane=function(){this._view=Xk(1,this),this.iv()},It("BorderPane",o,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(T,Y){this._12o("leftView",T),Y!=S&&this.setLeftWidth(Y)},getRightView:function(){return this._rightView},setRightView:function(K,c){this._12o("rightView",K),c!=S&&this.setRightWidth(c)},getTopView:function(){return this._topView},setTopView:function(G,T){this._12o("topView",G),T!=S&&this.setTopHeight(T)},getBottomView:function(){return this._bottomView},setBottomView:function(M,G){this._12o("bottomView",M),G!=S&&this.setBottomHeight(G)},getCenterView:function(){return this._centerView},setCenterView:function(O){this._12o("centerView",O)},_12o:function(g,h){var O=this,E="_"+g,z=O._view,t=O[E];t!==h&&(t&&(t.getView?re(t.getView()):re(t)),O[E]=h,h&&(h.getView?wf(z,h.getView(),1):wf(z,h,1)),O.fp(g,t,h))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var u=this,E=u._topView,y=u._bottomView,o=u._leftView,G=u._rightView,A=u._centerView,t=u.getWidth(),T=u.getHeight(),L=0,e=0,_=t,$=T,h=0,C=0,O=0,P=0;E&&(h=u._topHeight==S?be(E):u._topHeight,e=h),y&&(C=u._bottomHeight==S?be(y):u._bottomHeight,$=T-C),o&&(O=u._leftWidth==S?nf(o):u._leftWidth,L=O),G&&(P=u._rightWidth==S?nf(G):u._rightWidth,_=t-P);var l=g(0,_-L),M=g(0,$-e);E&&Pg(E,0,0,t,h),y&&Pg(y,0,$,t,C),o&&Pg(o,0,e,O,M),G&&Pg(G,_,e,P,M),A&&Pg(A,L,e,l,M)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);